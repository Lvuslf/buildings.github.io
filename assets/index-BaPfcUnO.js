var _6=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var jhe=_6((pa,ma)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const _ of m.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&a(_)}).observe(document,{childList:!0,subtree:!0});function i(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerPolicy&&(m.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?m.credentials="include":d.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function a(d){if(d.ep)return;d.ep=!0;const m=i(d);fetch(d.href,m)}})();/**
* @vue/shared v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function hT(e){const t=Object.create(null);for(const i of e.split(","))t[i]=1;return i=>i in t}const ni={},mp=[],_o=()=>{},y6=()=>!1,Sb=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),fT=e=>e.startsWith("onUpdate:"),Ti=Object.assign,pT=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},b6=Object.prototype.hasOwnProperty,Qr=(e,t)=>b6.call(e,t),on=Array.isArray,gp=e=>qv(e)==="[object Map]",Gp=e=>qv(e)==="[object Set]",Yu=e=>qv(e)==="[object Date]",Fn=e=>typeof e=="function",zn=e=>typeof e=="string",ml=e=>typeof e=="symbol",Tr=e=>e!==null&&typeof e=="object",vv=e=>(Tr(e)||Fn(e))&&Fn(e.then)&&Fn(e.catch),hD=Object.prototype.toString,qv=e=>hD.call(e),x6=e=>qv(e).slice(8,-1),_v=e=>qv(e)==="[object Object]",mT=e=>zn(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,rv=hT(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Tb=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},w6=/-(\w)/g,Xs=Tb(e=>e.replace(w6,(t,i)=>i?i.toUpperCase():"")),S6=/\B([A-Z])/g,Dc=Tb(e=>e.replace(S6,"-$1").toLowerCase()),Kv=Tb(e=>e.charAt(0).toUpperCase()+e.slice(1)),ov=Tb(e=>e?`on${Kv(e)}`:""),Gu=(e,t)=>!Object.is(e,t),T0=(e,...t)=>{for(let i=0;i<e.length;i++)e[i](...t)},fD=(e,t,i,a=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:a,value:i})},G0=e=>{const t=parseFloat(e);return isNaN(t)?e:t},T6=e=>{const t=zn(e)?Number(e):NaN;return isNaN(t)?e:t};let Nk;const Cb=()=>Nk||(Nk=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Nn(e){if(on(e)){const t={};for(let i=0;i<e.length;i++){const a=e[i],d=zn(a)?I6(a):Nn(a);if(d)for(const m in d)t[m]=d[m]}return t}else if(zn(e)||Tr(e))return e}const C6=/;(?![^(]*\))/g,E6=/:([^]+)/,M6=/\/\*[^]*?\*\//g;function I6(e){const t={};return e.replace(M6,"").split(C6).forEach(i=>{if(i){const a=i.split(E6);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function ce(e){let t="";if(zn(e))t=e;else if(on(e))for(let i=0;i<e.length;i++){const a=ce(e[i]);a&&(t+=a+" ")}else if(Tr(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}function ul(e){if(!e)return null;let{class:t,style:i}=e;return t&&!zn(t)&&(e.class=ce(t)),i&&(e.style=Nn(i)),e}const k6="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",A6=hT(k6);function pD(e){return!!e||e===""}function P6(e,t){if(e.length!==t.length)return!1;let i=!0;for(let a=0;i&&a<e.length;a++)i=xh(e[a],t[a]);return i}function xh(e,t){if(e===t)return!0;let i=Yu(e),a=Yu(t);if(i||a)return i&&a?e.getTime()===t.getTime():!1;if(i=ml(e),a=ml(t),i||a)return e===t;if(i=on(e),a=on(t),i||a)return i&&a?P6(e,t):!1;if(i=Tr(e),a=Tr(t),i||a){if(!i||!a)return!1;const d=Object.keys(e).length,m=Object.keys(t).length;if(d!==m)return!1;for(const _ in e){const x=e.hasOwnProperty(_),o=t.hasOwnProperty(_);if(x&&!o||!x&&o||!xh(e[_],t[_]))return!1}}return String(e)===String(t)}function gT(e,t){return e.findIndex(i=>xh(i,t))}const mD=e=>!!(e&&e.__v_isRef===!0),fn=e=>zn(e)?e:e==null?"":on(e)||Tr(e)&&(e.toString===hD||!Fn(e.toString))?mD(e)?fn(e.value):JSON.stringify(e,gD,2):String(e),gD=(e,t)=>mD(t)?gD(e,t.value):gp(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((i,[a,d],m)=>(i[Qx(a,m)+" =>"]=d,i),{})}:Gp(t)?{[`Set(${t.size})`]:[...t.values()].map(i=>Qx(i))}:ml(t)?Qx(t):Tr(t)&&!on(t)&&!_v(t)?String(t):t,Qx=(e,t="")=>{var i;return ml(e)?`Symbol(${(i=e.description)!=null?i:t})`:e};/**
* @vue/reactivity v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ps;class vD{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ps,!t&&Ps&&(this.index=(Ps.scopes||(Ps.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,i;if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].pause();for(t=0,i=this.effects.length;t<i;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,i;if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].resume();for(t=0,i=this.effects.length;t<i;t++)this.effects[t].resume()}}run(t){if(this._active){const i=Ps;try{return Ps=this,t()}finally{Ps=i}}}on(){Ps=this}off(){Ps=this.parent}stop(t){if(this._active){let i,a;for(i=0,a=this.effects.length;i<a;i++)this.effects[i].stop();for(i=0,a=this.cleanups.length;i<a;i++)this.cleanups[i]();if(this.scopes)for(i=0,a=this.scopes.length;i<a;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!t){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.parent=void 0,this._active=!1}}}function R6(e){return new vD(e)}function _D(){return Ps}function yD(e,t=!1){Ps&&Ps.cleanups.push(e)}let si;const ew=new WeakSet;class bD{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ps&&Ps.active&&Ps.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,ew.has(this)&&(ew.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||wD(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,$k(this),SD(this);const t=si,i=fl;si=this,fl=!0;try{return this.fn()}finally{TD(this),si=t,fl=i,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)yT(t);this.deps=this.depsTail=void 0,$k(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?ew.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Vw(this)&&this.run()}get dirty(){return Vw(this)}}let xD=0,iv,sv;function wD(e,t=!1){if(e.flags|=8,t){e.next=sv,sv=e;return}e.next=iv,iv=e}function vT(){xD++}function _T(){if(--xD>0)return;if(sv){let t=sv;for(sv=void 0;t;){const i=t.next;t.next=void 0,t.flags&=-9,t=i}}let e;for(;iv;){let t=iv;for(iv=void 0;t;){const i=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=i}}if(e)throw e}function SD(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function TD(e){let t,i=e.depsTail,a=i;for(;a;){const d=a.prevDep;a.version===-1?(a===i&&(i=d),yT(a),D6(a)):t=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=d}e.deps=t,e.depsTail=i}function Vw(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(CD(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function CD(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===yv))return;e.globalVersion=yv;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!Vw(e)){e.flags&=-3;return}const i=si,a=fl;si=e,fl=!0;try{SD(e);const d=e.fn(e._value);(t.version===0||Gu(d,e._value))&&(e._value=d,t.version++)}catch(d){throw t.version++,d}finally{si=i,fl=a,TD(e),e.flags&=-3}}function yT(e,t=!1){const{dep:i,prevSub:a,nextSub:d}=e;if(a&&(a.nextSub=d,e.prevSub=void 0),d&&(d.prevSub=a,e.nextSub=void 0),i.subs===e&&(i.subs=a,!a&&i.computed)){i.computed.flags&=-5;for(let m=i.computed.deps;m;m=m.nextDep)yT(m,!0)}!t&&!--i.sc&&i.map&&i.map.delete(i.key)}function D6(e){const{prevDep:t,nextDep:i}=e;t&&(t.nextDep=i,e.prevDep=void 0),i&&(i.prevDep=t,e.nextDep=void 0)}let fl=!0;const ED=[];function ad(){ED.push(fl),fl=!1}function ld(){const e=ED.pop();fl=e===void 0?!0:e}function $k(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const i=si;si=void 0;try{t()}finally{si=i}}}let yv=0,L6=class{constructor(t,i){this.sub=t,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class Eb{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!si||!fl||si===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==si)i=this.activeLink=new L6(si,this),si.deps?(i.prevDep=si.depsTail,si.depsTail.nextDep=i,si.depsTail=i):si.deps=si.depsTail=i,MD(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const a=i.nextDep;a.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=a),i.prevDep=si.depsTail,i.nextDep=void 0,si.depsTail.nextDep=i,si.depsTail=i,si.deps===i&&(si.deps=a)}return i}trigger(t){this.version++,yv++,this.notify(t)}notify(t){vT();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{_T()}}}function MD(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let a=t.deps;a;a=a.nextDep)MD(a)}const i=e.dep.subs;i!==e&&(e.prevSub=i,i&&(i.nextSub=e)),e.dep.subs=e}}const W0=new WeakMap,gh=Symbol(""),Uw=Symbol(""),bv=Symbol("");function fs(e,t,i){if(fl&&si){let a=W0.get(e);a||W0.set(e,a=new Map);let d=a.get(i);d||(a.set(i,d=new Eb),d.map=a,d.key=i),d.track()}}function Ec(e,t,i,a,d,m){const _=W0.get(e);if(!_){yv++;return}const x=o=>{o&&o.trigger()};if(vT(),t==="clear")_.forEach(x);else{const o=on(e),C=o&&mT(i);if(o&&i==="length"){const k=Number(a);_.forEach((A,z)=>{(z==="length"||z===bv||!ml(z)&&z>=k)&&x(A)})}else switch((i!==void 0||_.has(void 0))&&x(_.get(i)),C&&x(_.get(bv)),t){case"add":o?C&&x(_.get("length")):(x(_.get(gh)),gp(e)&&x(_.get(Uw)));break;case"delete":o||(x(_.get(gh)),gp(e)&&x(_.get(Uw)));break;case"set":gp(e)&&x(_.get(gh));break}}_T()}function O6(e,t){const i=W0.get(e);return i&&i.get(t)}function ep(e){const t=Eo(e);return t===e?t:(fs(t,"iterate",bv),Ba(e)?t:t.map(ps))}function Mb(e){return fs(e=Eo(e),"iterate",bv),e}const z6={__proto__:null,[Symbol.iterator](){return tw(this,Symbol.iterator,ps)},concat(...e){return ep(this).concat(...e.map(t=>on(t)?ep(t):t))},entries(){return tw(this,"entries",e=>(e[1]=ps(e[1]),e))},every(e,t){return xc(this,"every",e,t,void 0,arguments)},filter(e,t){return xc(this,"filter",e,t,i=>i.map(ps),arguments)},find(e,t){return xc(this,"find",e,t,ps,arguments)},findIndex(e,t){return xc(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return xc(this,"findLast",e,t,ps,arguments)},findLastIndex(e,t){return xc(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return xc(this,"forEach",e,t,void 0,arguments)},includes(...e){return nw(this,"includes",e)},indexOf(...e){return nw(this,"indexOf",e)},join(e){return ep(this).join(e)},lastIndexOf(...e){return nw(this,"lastIndexOf",e)},map(e,t){return xc(this,"map",e,t,void 0,arguments)},pop(){return Gg(this,"pop")},push(...e){return Gg(this,"push",e)},reduce(e,...t){return Vk(this,"reduce",e,t)},reduceRight(e,...t){return Vk(this,"reduceRight",e,t)},shift(){return Gg(this,"shift")},some(e,t){return xc(this,"some",e,t,void 0,arguments)},splice(...e){return Gg(this,"splice",e)},toReversed(){return ep(this).toReversed()},toSorted(e){return ep(this).toSorted(e)},toSpliced(...e){return ep(this).toSpliced(...e)},unshift(...e){return Gg(this,"unshift",e)},values(){return tw(this,"values",ps)}};function tw(e,t,i){const a=Mb(e),d=a[t]();return a!==e&&!Ba(e)&&(d._next=d.next,d.next=()=>{const m=d._next();return m.value&&(m.value=i(m.value)),m}),d}const B6=Array.prototype;function xc(e,t,i,a,d,m){const _=Mb(e),x=_!==e&&!Ba(e),o=_[t];if(o!==B6[t]){const A=o.apply(e,m);return x?ps(A):A}let C=i;_!==e&&(x?C=function(A,z){return i.call(this,ps(A),z,e)}:i.length>2&&(C=function(A,z){return i.call(this,A,z,e)}));const k=o.call(_,C,a);return x&&d?d(k):k}function Vk(e,t,i,a){const d=Mb(e);let m=i;return d!==e&&(Ba(e)?i.length>3&&(m=function(_,x,o){return i.call(this,_,x,o,e)}):m=function(_,x,o){return i.call(this,_,ps(x),o,e)}),d[t](m,...a)}function nw(e,t,i){const a=Eo(e);fs(a,"iterate",bv);const d=a[t](...i);return(d===-1||d===!1)&&wT(i[0])?(i[0]=Eo(i[0]),a[t](...i)):d}function Gg(e,t,i=[]){ad(),vT();const a=Eo(e)[t].apply(e,i);return _T(),ld(),a}const F6=hT("__proto__,__v_isRef,__isVue"),ID=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ml));function N6(e){ml(e)||(e=String(e));const t=Eo(this);return fs(t,"has",e),t.hasOwnProperty(e)}class kD{constructor(t=!1,i=!1){this._isReadonly=t,this._isShallow=i}get(t,i,a){const d=this._isReadonly,m=this._isShallow;if(i==="__v_isReactive")return!d;if(i==="__v_isReadonly")return d;if(i==="__v_isShallow")return m;if(i==="__v_raw")return a===(d?m?Z6:DD:m?RD:PD).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const _=on(t);if(!d){let o;if(_&&(o=z6[i]))return o;if(i==="hasOwnProperty")return N6}const x=Reflect.get(t,i,Fo(t)?t:a);return(ml(i)?ID.has(i):F6(i))||(d||fs(t,"get",i),m)?x:Fo(x)?_&&mT(i)?x:x.value:Tr(x)?d?Wp(x):ao(x):x}}class AD extends kD{constructor(t=!1){super(!1,t)}set(t,i,a,d){let m=t[i];if(!this._isShallow){const o=wh(m);if(!Ba(a)&&!wh(a)&&(m=Eo(m),a=Eo(a)),!on(t)&&Fo(m)&&!Fo(a))return o?!1:(m.value=a,!0)}const _=on(t)&&mT(i)?Number(i)<t.length:Qr(t,i),x=Reflect.set(t,i,a,Fo(t)?t:d);return t===Eo(d)&&(_?Gu(a,m)&&Ec(t,"set",i,a):Ec(t,"add",i,a)),x}deleteProperty(t,i){const a=Qr(t,i);t[i];const d=Reflect.deleteProperty(t,i);return d&&a&&Ec(t,"delete",i,void 0),d}has(t,i){const a=Reflect.has(t,i);return(!ml(i)||!ID.has(i))&&fs(t,"has",i),a}ownKeys(t){return fs(t,"iterate",on(t)?"length":gh),Reflect.ownKeys(t)}}class $6 extends kD{constructor(t=!1){super(!0,t)}set(t,i){return!0}deleteProperty(t,i){return!0}}const V6=new AD,U6=new $6,j6=new AD(!0),jw=e=>e,t0=e=>Reflect.getPrototypeOf(e);function H6(e,t,i){return function(...a){const d=this.__v_raw,m=Eo(d),_=gp(m),x=e==="entries"||e===Symbol.iterator&&_,o=e==="keys"&&_,C=d[e](...a),k=i?jw:t?Hw:ps;return!t&&fs(m,"iterate",o?Uw:gh),{next(){const{value:A,done:z}=C.next();return z?{value:A,done:z}:{value:x?[k(A[0]),k(A[1])]:k(A),done:z}},[Symbol.iterator](){return this}}}}function n0(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function G6(e,t){const i={get(d){const m=this.__v_raw,_=Eo(m),x=Eo(d);e||(Gu(d,x)&&fs(_,"get",d),fs(_,"get",x));const{has:o}=t0(_),C=t?jw:e?Hw:ps;if(o.call(_,d))return C(m.get(d));if(o.call(_,x))return C(m.get(x));m!==_&&m.get(d)},get size(){const d=this.__v_raw;return!e&&fs(Eo(d),"iterate",gh),Reflect.get(d,"size",d)},has(d){const m=this.__v_raw,_=Eo(m),x=Eo(d);return e||(Gu(d,x)&&fs(_,"has",d),fs(_,"has",x)),d===x?m.has(d):m.has(d)||m.has(x)},forEach(d,m){const _=this,x=_.__v_raw,o=Eo(x),C=t?jw:e?Hw:ps;return!e&&fs(o,"iterate",gh),x.forEach((k,A)=>d.call(m,C(k),C(A),_))}};return Ti(i,e?{add:n0("add"),set:n0("set"),delete:n0("delete"),clear:n0("clear")}:{add(d){!t&&!Ba(d)&&!wh(d)&&(d=Eo(d));const m=Eo(this);return t0(m).has.call(m,d)||(m.add(d),Ec(m,"add",d,d)),this},set(d,m){!t&&!Ba(m)&&!wh(m)&&(m=Eo(m));const _=Eo(this),{has:x,get:o}=t0(_);let C=x.call(_,d);C||(d=Eo(d),C=x.call(_,d));const k=o.call(_,d);return _.set(d,m),C?Gu(m,k)&&Ec(_,"set",d,m):Ec(_,"add",d,m),this},delete(d){const m=Eo(this),{has:_,get:x}=t0(m);let o=_.call(m,d);o||(d=Eo(d),o=_.call(m,d)),x&&x.call(m,d);const C=m.delete(d);return o&&Ec(m,"delete",d,void 0),C},clear(){const d=Eo(this),m=d.size!==0,_=d.clear();return m&&Ec(d,"clear",void 0,void 0),_}}),["keys","values","entries",Symbol.iterator].forEach(d=>{i[d]=H6(d,e,t)}),i}function bT(e,t){const i=G6(e,t);return(a,d,m)=>d==="__v_isReactive"?!e:d==="__v_isReadonly"?e:d==="__v_raw"?a:Reflect.get(Qr(i,d)&&d in a?i:a,d,m)}const W6={get:bT(!1,!1)},q6={get:bT(!1,!0)},K6={get:bT(!0,!1)},PD=new WeakMap,RD=new WeakMap,DD=new WeakMap,Z6=new WeakMap;function Y6(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function X6(e){return e.__v_skip||!Object.isExtensible(e)?0:Y6(x6(e))}function ao(e){return wh(e)?e:xT(e,!1,V6,W6,PD)}function LD(e){return xT(e,!1,j6,q6,RD)}function Wp(e){return xT(e,!0,U6,K6,DD)}function xT(e,t,i,a,d){if(!Tr(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const m=d.get(e);if(m)return m;const _=X6(e);if(_===0)return e;const x=new Proxy(e,_===2?a:i);return d.set(e,x),x}function vp(e){return wh(e)?vp(e.__v_raw):!!(e&&e.__v_isReactive)}function wh(e){return!!(e&&e.__v_isReadonly)}function Ba(e){return!!(e&&e.__v_isShallow)}function wT(e){return e?!!e.__v_raw:!1}function Eo(e){const t=e&&e.__v_raw;return t?Eo(t):e}function Wu(e){return!Qr(e,"__v_skip")&&Object.isExtensible(e)&&fD(e,"__v_skip",!0),e}const ps=e=>Tr(e)?ao(e):e,Hw=e=>Tr(e)?Wp(e):e;function Fo(e){return e?e.__v_isRef===!0:!1}function be(e){return OD(e,!1)}function Uo(e){return OD(e,!0)}function OD(e,t){return Fo(e)?e:new J6(e,t)}class J6{constructor(t,i){this.dep=new Eb,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?t:Eo(t),this._value=i?t:ps(t),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(t){const i=this._rawValue,a=this.__v_isShallow||Ba(t)||wh(t);t=a?t:Eo(t),Gu(t,i)&&(this._rawValue=t,this._value=a?t:ps(t),this.dep.trigger())}}function y(e){return Fo(e)?e.value:e}const Q6={get:(e,t,i)=>t==="__v_raw"?e:y(Reflect.get(e,t,i)),set:(e,t,i,a)=>{const d=e[t];return Fo(d)&&!Fo(i)?(d.value=i,!0):Reflect.set(e,t,i,a)}};function zD(e){return vp(e)?e:new Proxy(e,Q6)}class e5{constructor(t){this.__v_isRef=!0,this._value=void 0;const i=this.dep=new Eb,{get:a,set:d}=t(i.track.bind(i),i.trigger.bind(i));this._get=a,this._set=d}get value(){return this._value=this._get()}set value(t){this._set(t)}}function t5(e){return new e5(e)}function Bi(e){const t=on(e)?new Array(e.length):{};for(const i in e)t[i]=BD(e,i);return t}class n5{constructor(t,i,a){this._object=t,this._key=i,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return O6(Eo(this._object),this._key)}}class r5{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function fo(e,t,i){return Fo(e)?e:Fn(e)?new r5(e):Tr(e)&&arguments.length>1?BD(e,t,i):be(e)}function BD(e,t,i){const a=e[t];return Fo(a)?a:new n5(e,t,i)}class o5{constructor(t,i,a){this.fn=t,this.setter=i,this._value=void 0,this.dep=new Eb(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=yv-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&si!==this)return wD(this,!0),!0}get value(){const t=this.dep.track();return CD(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function i5(e,t,i=!1){let a,d;return Fn(e)?a=e:(a=e.get,d=e.set),new o5(a,d,i)}const r0={},q0=new WeakMap;let sh;function s5(e,t=!1,i=sh){if(i){let a=q0.get(i);a||q0.set(i,a=[]),a.push(e)}}function a5(e,t,i=ni){const{immediate:a,deep:d,once:m,scheduler:_,augmentJob:x,call:o}=i,C=q=>d?q:Ba(q)||d===!1||d===0?Mc(q,1):Mc(q);let k,A,z,N,$=!1,F=!1;if(Fo(e)?(A=()=>e.value,$=Ba(e)):vp(e)?(A=()=>C(e),$=!0):on(e)?(F=!0,$=e.some(q=>vp(q)||Ba(q)),A=()=>e.map(q=>{if(Fo(q))return q.value;if(vp(q))return C(q);if(Fn(q))return o?o(q,2):q()})):Fn(e)?t?A=o?()=>o(e,2):e:A=()=>{if(z){ad();try{z()}finally{ld()}}const q=sh;sh=k;try{return o?o(e,3,[N]):e(N)}finally{sh=q}}:A=_o,t&&d){const q=A,X=d===!0?1/0:d;A=()=>Mc(q(),X)}const G=_D(),U=()=>{k.stop(),G&&pT(G.effects,k)};if(m&&t){const q=t;t=(...X)=>{q(...X),U()}}let te=F?new Array(e.length).fill(r0):r0;const Z=q=>{if(!(!(k.flags&1)||!k.dirty&&!q))if(t){const X=k.run();if(d||$||(F?X.some((ie,de)=>Gu(ie,te[de])):Gu(X,te))){z&&z();const ie=sh;sh=k;try{const de=[X,te===r0?void 0:F&&te[0]===r0?[]:te,N];o?o(t,3,de):t(...de),te=X}finally{sh=ie}}}else k.run()};return x&&x(Z),k=new bD(A),k.scheduler=_?()=>_(Z,!1):Z,N=q=>s5(q,!1,k),z=k.onStop=()=>{const q=q0.get(k);if(q){if(o)o(q,4);else for(const X of q)X();q0.delete(k)}},t?a?Z(!0):te=k.run():_?_(Z.bind(null,!0),!0):k.run(),U.pause=k.pause.bind(k),U.resume=k.resume.bind(k),U.stop=U,U}function Mc(e,t=1/0,i){if(t<=0||!Tr(e)||e.__v_skip||(i=i||new Set,i.has(e)))return e;if(i.add(e),t--,Fo(e))Mc(e.value,t,i);else if(on(e))for(let a=0;a<e.length;a++)Mc(e[a],t,i);else if(Gp(e)||gp(e))e.forEach(a=>{Mc(a,t,i)});else if(_v(e)){for(const a in e)Mc(e[a],t,i);for(const a of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,a)&&Mc(e[a],t,i)}return e}/**
* @vue/runtime-core v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Zv(e,t,i,a){try{return a?e(...a):e()}catch(d){Ib(d,t,i)}}function gl(e,t,i,a){if(Fn(e)){const d=Zv(e,t,i,a);return d&&vv(d)&&d.catch(m=>{Ib(m,t,i)}),d}if(on(e)){const d=[];for(let m=0;m<e.length;m++)d.push(gl(e[m],t,i,a));return d}}function Ib(e,t,i,a=!0){const d=t?t.vnode:null,{errorHandler:m,throwUnhandledErrorInProduction:_}=t&&t.appContext.config||ni;if(t){let x=t.parent;const o=t.proxy,C=`https://vuejs.org/error-reference/#runtime-${i}`;for(;x;){const k=x.ec;if(k){for(let A=0;A<k.length;A++)if(k[A](e,o,C)===!1)return}x=x.parent}if(m){ad(),Zv(m,null,10,[e,o,C]),ld();return}}l5(e,i,d,a,_)}function l5(e,t,i,a=!0,d=!1){if(d)throw e;console.error(e)}const Rs=[];let Vl=-1;const _p=[];let Nu=null,ap=0;const FD=Promise.resolve();let K0=null;function Vn(e){const t=K0||FD;return e?t.then(this?e.bind(this):e):t}function c5(e){let t=Vl+1,i=Rs.length;for(;t<i;){const a=t+i>>>1,d=Rs[a],m=xv(d);m<e||m===e&&d.flags&2?t=a+1:i=a}return t}function ST(e){if(!(e.flags&1)){const t=xv(e),i=Rs[Rs.length-1];!i||!(e.flags&2)&&t>=xv(i)?Rs.push(e):Rs.splice(c5(t),0,e),e.flags|=1,ND()}}function ND(){K0||(K0=FD.then(VD))}function u5(e){on(e)?_p.push(...e):Nu&&e.id===-1?Nu.splice(ap+1,0,e):e.flags&1||(_p.push(e),e.flags|=1),ND()}function Uk(e,t,i=Vl+1){for(;i<Rs.length;i++){const a=Rs[i];if(a&&a.flags&2){if(e&&a.id!==e.uid)continue;Rs.splice(i,1),i--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function $D(e){if(_p.length){const t=[...new Set(_p)].sort((i,a)=>xv(i)-xv(a));if(_p.length=0,Nu){Nu.push(...t);return}for(Nu=t,ap=0;ap<Nu.length;ap++){const i=Nu[ap];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}Nu=null,ap=0}}const xv=e=>e.id==null?e.flags&2?-1:1/0:e.id;function VD(e){try{for(Vl=0;Vl<Rs.length;Vl++){const t=Rs[Vl];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Zv(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Vl<Rs.length;Vl++){const t=Rs[Vl];t&&(t.flags&=-2)}Vl=-1,Rs.length=0,$D(),K0=null,(Rs.length||_p.length)&&VD()}}let Hi=null,UD=null;function Z0(e){const t=Hi;return Hi=e,UD=e&&e.type.__scopeId||null,t}function st(e,t=Hi,i){if(!t||e._n)return e;const a=(...d)=>{a._d&&eA(-1);const m=Z0(t);let _;try{_=e(...d)}finally{Z0(m),a._d&&eA(1)}return _};return a._n=!0,a._c=!0,a._d=!0,a}function mr(e,t){if(Hi===null)return e;const i=Lb(Hi),a=e.dirs||(e.dirs=[]);for(let d=0;d<t.length;d++){let[m,_,x,o=ni]=t[d];m&&(Fn(m)&&(m={mounted:m,updated:m}),m.deep&&Mc(_),a.push({dir:m,instance:i,value:_,oldValue:void 0,arg:x,modifiers:o}))}return e}function th(e,t,i,a){const d=e.dirs,m=t&&t.dirs;for(let _=0;_<d.length;_++){const x=d[_];m&&(x.oldValue=m[_].value);let o=x.dir[a];o&&(ad(),gl(o,i,8,[e.el,x,e,t]),ld())}}const jD=Symbol("_vte"),HD=e=>e.__isTeleport,av=e=>e&&(e.disabled||e.disabled===""),d5=e=>e&&(e.defer||e.defer===""),jk=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Hk=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Gw=(e,t)=>{const i=e&&e.to;return zn(i)?t?t(i):null:i},h5={name:"Teleport",__isTeleport:!0,process(e,t,i,a,d,m,_,x,o,C){const{mc:k,pc:A,pbc:z,o:{insert:N,querySelector:$,createText:F,createComment:G}}=C,U=av(t.props);let{shapeFlag:te,children:Z,dynamicChildren:q}=t;if(e==null){const X=t.el=F(""),ie=t.anchor=F("");N(X,i,a),N(ie,i,a);const de=(pe,ge)=>{te&16&&(d&&d.isCE&&(d.ce._teleportTarget=pe),k(Z,pe,ge,d,m,_,x,o))},le=()=>{const pe=t.target=Gw(t.props,$),ge=GD(pe,t,F,N);pe&&(_!=="svg"&&jk(pe)?_="svg":_!=="mathml"&&Hk(pe)&&(_="mathml"),U||(de(pe,ge),C0(t,!1)))};U&&(de(i,ie),C0(t,!0)),d5(t.props)?qs(le,m):le()}else{t.el=e.el,t.targetStart=e.targetStart;const X=t.anchor=e.anchor,ie=t.target=e.target,de=t.targetAnchor=e.targetAnchor,le=av(e.props),pe=le?i:ie,ge=le?X:de;if(_==="svg"||jk(ie)?_="svg":(_==="mathml"||Hk(ie))&&(_="mathml"),q?(z(e.dynamicChildren,q,pe,d,m,_,x),AT(e,t,!0)):o||A(e,t,pe,ge,d,m,_,x,!1),U)le?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):o0(t,i,X,C,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const he=t.target=Gw(t.props,$);he&&o0(t,he,null,C,0)}else le&&o0(t,ie,de,C,1);C0(t,U)}},remove(e,t,i,{um:a,o:{remove:d}},m){const{shapeFlag:_,children:x,anchor:o,targetStart:C,targetAnchor:k,target:A,props:z}=e;if(A&&(d(C),d(k)),m&&d(o),_&16){const N=m||!av(z);for(let $=0;$<x.length;$++){const F=x[$];a(F,t,i,N,!!F.dynamicChildren)}}},move:o0,hydrate:f5};function o0(e,t,i,{o:{insert:a},m:d},m=2){m===0&&a(e.targetAnchor,t,i);const{el:_,anchor:x,shapeFlag:o,children:C,props:k}=e,A=m===2;if(A&&a(_,t,i),(!A||av(k))&&o&16)for(let z=0;z<C.length;z++)d(C[z],t,i,2);A&&a(x,t,i)}function f5(e,t,i,a,d,m,{o:{nextSibling:_,parentNode:x,querySelector:o,insert:C,createText:k}},A){const z=t.target=Gw(t.props,o);if(z){const N=av(t.props),$=z._lpa||z.firstChild;if(t.shapeFlag&16)if(N)t.anchor=A(_(e),t,x(e),i,a,d,m),t.targetStart=$,t.targetAnchor=$&&_($);else{t.anchor=_(e);let F=$;for(;F;){if(F&&F.nodeType===8){if(F.data==="teleport start anchor")t.targetStart=F;else if(F.data==="teleport anchor"){t.targetAnchor=F,z._lpa=t.targetAnchor&&_(t.targetAnchor);break}}F=_(F)}t.targetAnchor||GD(z,t,k,C),A($&&_($),t,z,i,a,d,m)}C0(t,N)}return t.anchor&&_(t.anchor)}const p5=h5;function C0(e,t){const i=e.ctx;if(i&&i.ut){let a,d;for(t?(a=e.el,d=e.anchor):(a=e.targetStart,d=e.targetAnchor);a&&a!==d;)a.nodeType===1&&a.setAttribute("data-v-owner",i.uid),a=a.nextSibling;i.ut()}}function GD(e,t,i,a){const d=t.targetStart=i(""),m=t.targetAnchor=i("");return d[jD]=m,e&&(a(d,e),a(m,e)),m}const $u=Symbol("_leaveCb"),i0=Symbol("_enterCb");function WD(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return vr(()=>{e.isMounted=!0}),Io(()=>{e.isUnmounting=!0}),e}const Pa=[Function,Array],qD={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Pa,onEnter:Pa,onAfterEnter:Pa,onEnterCancelled:Pa,onBeforeLeave:Pa,onLeave:Pa,onAfterLeave:Pa,onLeaveCancelled:Pa,onBeforeAppear:Pa,onAppear:Pa,onAfterAppear:Pa,onAppearCancelled:Pa},KD=e=>{const t=e.subTree;return t.component?KD(t.component):t},m5={name:"BaseTransition",props:qD,setup(e,{slots:t}){const i=Cr(),a=WD();return()=>{const d=t.default&&TT(t.default(),!0);if(!d||!d.length)return;const m=ZD(d),_=Eo(e),{mode:x}=_;if(a.isLeaving)return rw(m);const o=Gk(m);if(!o)return rw(m);let C=wv(o,_,a,i,z=>C=z);o.type!==Oi&&Sh(o,C);const k=i.subTree,A=k&&Gk(k);if(A&&A.type!==Oi&&!ah(o,A)&&KD(i).type!==Oi){const z=wv(A,_,a,i);if(Sh(A,z),x==="out-in"&&o.type!==Oi)return a.isLeaving=!0,z.afterLeave=()=>{a.isLeaving=!1,i.job.flags&8||i.update(),delete z.afterLeave},rw(m);x==="in-out"&&o.type!==Oi&&(z.delayLeave=(N,$,F)=>{const G=YD(a,A);G[String(A.key)]=A,N[$u]=()=>{$(),N[$u]=void 0,delete C.delayedLeave},C.delayedLeave=F})}return m}}};function ZD(e){let t=e[0];if(e.length>1){for(const i of e)if(i.type!==Oi){t=i;break}}return t}const g5=m5;function YD(e,t){const{leavingVNodes:i}=e;let a=i.get(t.type);return a||(a=Object.create(null),i.set(t.type,a)),a}function wv(e,t,i,a,d){const{appear:m,mode:_,persisted:x=!1,onBeforeEnter:o,onEnter:C,onAfterEnter:k,onEnterCancelled:A,onBeforeLeave:z,onLeave:N,onAfterLeave:$,onLeaveCancelled:F,onBeforeAppear:G,onAppear:U,onAfterAppear:te,onAppearCancelled:Z}=t,q=String(e.key),X=YD(i,e),ie=(pe,ge)=>{pe&&gl(pe,a,9,ge)},de=(pe,ge)=>{const he=ge[1];ie(pe,ge),on(pe)?pe.every(ue=>ue.length<=1)&&he():pe.length<=1&&he()},le={mode:_,persisted:x,beforeEnter(pe){let ge=o;if(!i.isMounted)if(m)ge=G||o;else return;pe[$u]&&pe[$u](!0);const he=X[q];he&&ah(e,he)&&he.el[$u]&&he.el[$u](),ie(ge,[pe])},enter(pe){let ge=C,he=k,ue=A;if(!i.isMounted)if(m)ge=U||C,he=te||k,ue=Z||A;else return;let Re=!1;const Ye=pe[i0]=Ie=>{Re||(Re=!0,Ie?ie(ue,[pe]):ie(he,[pe]),le.delayedLeave&&le.delayedLeave(),pe[i0]=void 0)};ge?de(ge,[pe,Ye]):Ye()},leave(pe,ge){const he=String(e.key);if(pe[i0]&&pe[i0](!0),i.isUnmounting)return ge();ie(z,[pe]);let ue=!1;const Re=pe[$u]=Ye=>{ue||(ue=!0,ge(),Ye?ie(F,[pe]):ie($,[pe]),pe[$u]=void 0,X[he]===e&&delete X[he])};X[he]=e,N?de(N,[pe,Re]):Re()},clone(pe){const ge=wv(pe,t,i,a,d);return d&&d(ge),ge}};return le}function rw(e){if(kb(e))return e=Ac(e),e.children=null,e}function Gk(e){if(!kb(e))return HD(e.type)&&e.children?ZD(e.children):e;const{shapeFlag:t,children:i}=e;if(i){if(t&16)return i[0];if(t&32&&Fn(i.default))return i.default()}}function Sh(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Sh(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function TT(e,t=!1,i){let a=[],d=0;for(let m=0;m<e.length;m++){let _=e[m];const x=i==null?_.key:String(i)+String(_.key!=null?_.key:m);_.type===Bn?(_.patchFlag&128&&d++,a=a.concat(TT(_.children,t,x))):(t||_.type!==Oi)&&a.push(x!=null?Ac(_,{key:x}):_)}if(d>1)for(let m=0;m<a.length;m++)a[m].patchFlag=-2;return a}/*! #__NO_SIDE_EFFECTS__ */function Ge(e,t){return Fn(e)?Ti({name:e.name},t,{setup:e}):e}function XD(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Ww(e,t,i,a,d=!1){if(on(e)){e.forEach(($,F)=>Ww($,t&&(on(t)?t[F]:t),i,a,d));return}if(yp(a)&&!d)return;const m=a.shapeFlag&4?Lb(a.component):a.el,_=d?null:m,{i:x,r:o}=e,C=t&&t.r,k=x.refs===ni?x.refs={}:x.refs,A=x.setupState,z=Eo(A),N=A===ni?()=>!1:$=>Qr(z,$);if(C!=null&&C!==o&&(zn(C)?(k[C]=null,N(C)&&(A[C]=null)):Fo(C)&&(C.value=null)),Fn(o))Zv(o,x,12,[_,k]);else{const $=zn(o),F=Fo(o);if($||F){const G=()=>{if(e.f){const U=$?N(o)?A[o]:k[o]:o.value;d?on(U)&&pT(U,m):on(U)?U.includes(m)||U.push(m):$?(k[o]=[m],N(o)&&(A[o]=k[o])):(o.value=[m],e.k&&(k[e.k]=o.value))}else $?(k[o]=_,N(o)&&(A[o]=_)):F&&(o.value=_,e.k&&(k[e.k]=_))};_?(G.id=-1,qs(G,i)):G()}}}Cb().requestIdleCallback;Cb().cancelIdleCallback;const yp=e=>!!e.type.__asyncLoader,kb=e=>e.type.__isKeepAlive;function CT(e,t){QD(e,"a",t)}function JD(e,t){QD(e,"da",t)}function QD(e,t,i=ts){const a=e.__wdc||(e.__wdc=()=>{let d=i;for(;d;){if(d.isDeactivated)return;d=d.parent}return e()});if(Ab(t,a,i),i){let d=i.parent;for(;d&&d.parent;)kb(d.parent.vnode)&&v5(a,t,i,d),d=d.parent}}function v5(e,t,i,a){const d=Ab(t,e,a,!0);cd(()=>{pT(a[t],d)},i)}function Ab(e,t,i=ts,a=!1){if(i){const d=i[e]||(i[e]=[]),m=t.__weh||(t.__weh=(..._)=>{ad();const x=Yv(i),o=gl(t,i,e,_);return x(),ld(),o});return a?d.unshift(m):d.push(m),m}}const Lc=e=>(t,i=ts)=>{(!Tv||e==="sp")&&Ab(e,(...a)=>t(...a),i)},Pb=Lc("bm"),vr=Lc("m"),eL=Lc("bu"),Jl=Lc("u"),Io=Lc("bum"),cd=Lc("um"),_5=Lc("sp"),y5=Lc("rtg"),b5=Lc("rtc");function x5(e,t=ts){Ab("ec",e,t)}const ET="components",w5="directives";function Er(e,t){return MT(ET,e,!0,t)||e}const tL=Symbol.for("v-ndc");function Ir(e){return zn(e)?MT(ET,e,!1)||e:e||tL}function Rb(e){return MT(w5,e)}function MT(e,t,i=!0,a=!1){const d=Hi||ts;if(d){const m=d.type;if(e===ET){const x=s$(m,!1);if(x&&(x===t||x===Xs(t)||x===Kv(Xs(t))))return m}const _=Wk(d[e]||m[e],t)||Wk(d.appContext[e],t);return!_&&a?m:_}}function Wk(e,t){return e&&(e[t]||e[Xs(t)]||e[Kv(Xs(t))])}function Fr(e,t,i,a){let d;const m=i,_=on(e);if(_||zn(e)){const x=_&&vp(e);let o=!1;x&&(o=!Ba(e),e=Mb(e)),d=new Array(e.length);for(let C=0,k=e.length;C<k;C++)d[C]=t(o?ps(e[C]):e[C],C,void 0,m)}else if(typeof e=="number"){d=new Array(e);for(let x=0;x<e;x++)d[x]=t(x+1,x,void 0,m)}else if(Tr(e))if(e[Symbol.iterator])d=Array.from(e,(x,o)=>t(x,o,void 0,m));else{const x=Object.keys(e);d=new Array(x.length);for(let o=0,C=x.length;o<C;o++){const k=x[o];d[o]=t(e[k],k,o,m)}}else d=[];return d}function $a(e,t){for(let i=0;i<t.length;i++){const a=t[i];if(on(a))for(let d=0;d<a.length;d++)e[a[d].name]=a[d].fn;else a&&(e[a.name]=a.key?(...d)=>{const m=a.fn(...d);return m&&(m.key=a.key),m}:a.fn)}return e}function _t(e,t,i={},a,d){if(Hi.ce||Hi.parent&&yp(Hi.parent)&&Hi.parent.ce)return t!=="default"&&(i.name=t),se(),It(Bn,null,[qe("slot",i,a&&a())],64);let m=e[t];m&&m._c&&(m._d=!1),se();const _=m&&nL(m(i)),x=i.key||_&&_.key,o=It(Bn,{key:(x&&!ml(x)?x:`_${t}`)+(!_&&a?"_fb":"")},_||(a?a():[]),_&&e._===1?64:-2);return o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),m&&m._c&&(m._d=!0),o}function nL(e){return e.some(t=>Ho(t)?!(t.type===Oi||t.type===Bn&&!nL(t.children)):!0)?e:null}function S5(e,t){const i={};for(const a in e)i[ov(a)]=e[a];return i}const qw=e=>e?xL(e)?Lb(e):qw(e.parent):null,lv=Ti(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>qw(e.parent),$root:e=>qw(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>IT(e),$forceUpdate:e=>e.f||(e.f=()=>{ST(e.update)}),$nextTick:e=>e.n||(e.n=Vn.bind(e.proxy)),$watch:e=>H5.bind(e)}),ow=(e,t)=>e!==ni&&!e.__isScriptSetup&&Qr(e,t),T5={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:i,setupState:a,data:d,props:m,accessCache:_,type:x,appContext:o}=e;let C;if(t[0]!=="$"){const N=_[t];if(N!==void 0)switch(N){case 1:return a[t];case 2:return d[t];case 4:return i[t];case 3:return m[t]}else{if(ow(a,t))return _[t]=1,a[t];if(d!==ni&&Qr(d,t))return _[t]=2,d[t];if((C=e.propsOptions[0])&&Qr(C,t))return _[t]=3,m[t];if(i!==ni&&Qr(i,t))return _[t]=4,i[t];Kw&&(_[t]=0)}}const k=lv[t];let A,z;if(k)return t==="$attrs"&&fs(e.attrs,"get",""),k(e);if((A=x.__cssModules)&&(A=A[t]))return A;if(i!==ni&&Qr(i,t))return _[t]=4,i[t];if(z=o.config.globalProperties,Qr(z,t))return z[t]},set({_:e},t,i){const{data:a,setupState:d,ctx:m}=e;return ow(d,t)?(d[t]=i,!0):a!==ni&&Qr(a,t)?(a[t]=i,!0):Qr(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(m[t]=i,!0)},has({_:{data:e,setupState:t,accessCache:i,ctx:a,appContext:d,propsOptions:m}},_){let x;return!!i[_]||e!==ni&&Qr(e,_)||ow(t,_)||(x=m[0])&&Qr(x,_)||Qr(a,_)||Qr(lv,_)||Qr(d.config.globalProperties,_)},defineProperty(e,t,i){return i.get!=null?e._.accessCache[t]=0:Qr(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};function Ai(){return rL().slots}function Dh(){return rL().attrs}function rL(){const e=Cr();return e.setupContext||(e.setupContext=SL(e))}function qk(e){return on(e)?e.reduce((t,i)=>(t[i]=null,t),{}):e}let Kw=!0;function C5(e){const t=IT(e),i=e.proxy,a=e.ctx;Kw=!1,t.beforeCreate&&Kk(t.beforeCreate,e,"bc");const{data:d,computed:m,methods:_,watch:x,provide:o,inject:C,created:k,beforeMount:A,mounted:z,beforeUpdate:N,updated:$,activated:F,deactivated:G,beforeDestroy:U,beforeUnmount:te,destroyed:Z,unmounted:q,render:X,renderTracked:ie,renderTriggered:de,errorCaptured:le,serverPrefetch:pe,expose:ge,inheritAttrs:he,components:ue,directives:Re,filters:Ye}=t;if(C&&E5(C,a,null),_)for(const Me in _){const Se=_[Me];Fn(Se)&&(a[Me]=Se.bind(i))}if(d){const Me=d.call(i,i);Tr(Me)&&(e.data=ao(Me))}if(Kw=!0,m)for(const Me in m){const Se=m[Me],ye=Fn(Se)?Se.bind(i,i):Fn(Se.get)?Se.get.bind(i,i):_o,Ce=!Fn(Se)&&Fn(Se.set)?Se.set.bind(i):_o,Fe=Q({get:ye,set:Ce});Object.defineProperty(a,Me,{enumerable:!0,configurable:!0,get:()=>Fe.value,set:it=>Fe.value=it})}if(x)for(const Me in x)oL(x[Me],a,i,Me);if(o){const Me=Fn(o)?o.call(i):o;Reflect.ownKeys(Me).forEach(Se=>{Br(Se,Me[Se])})}k&&Kk(k,e,"c");function fe(Me,Se){on(Se)?Se.forEach(ye=>Me(ye.bind(i))):Se&&Me(Se.bind(i))}if(fe(Pb,A),fe(vr,z),fe(eL,N),fe(Jl,$),fe(CT,F),fe(JD,G),fe(x5,le),fe(b5,ie),fe(y5,de),fe(Io,te),fe(cd,q),fe(_5,pe),on(ge))if(ge.length){const Me=e.exposed||(e.exposed={});ge.forEach(Se=>{Object.defineProperty(Me,Se,{get:()=>i[Se],set:ye=>i[Se]=ye})})}else e.exposed||(e.exposed={});X&&e.render===_o&&(e.render=X),he!=null&&(e.inheritAttrs=he),ue&&(e.components=ue),Re&&(e.directives=Re),pe&&XD(e)}function E5(e,t,i=_o){on(e)&&(e=Zw(e));for(const a in e){const d=e[a];let m;Tr(d)?"default"in d?m=kn(d.from||a,d.default,!0):m=kn(d.from||a):m=kn(d),Fo(m)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>m.value,set:_=>m.value=_}):t[a]=m}}function Kk(e,t,i){gl(on(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,i)}function oL(e,t,i,a){let d=a.includes(".")?gL(i,a):()=>i[a];if(zn(e)){const m=t[e];Fn(m)&&Wt(d,m)}else if(Fn(e))Wt(d,e.bind(i));else if(Tr(e))if(on(e))e.forEach(m=>oL(m,t,i,a));else{const m=Fn(e.handler)?e.handler.bind(i):t[e.handler];Fn(m)&&Wt(d,m,e)}}function IT(e){const t=e.type,{mixins:i,extends:a}=t,{mixins:d,optionsCache:m,config:{optionMergeStrategies:_}}=e.appContext,x=m.get(t);let o;return x?o=x:!d.length&&!i&&!a?o=t:(o={},d.length&&d.forEach(C=>Y0(o,C,_,!0)),Y0(o,t,_)),Tr(t)&&m.set(t,o),o}function Y0(e,t,i,a=!1){const{mixins:d,extends:m}=t;m&&Y0(e,m,i,!0),d&&d.forEach(_=>Y0(e,_,i,!0));for(const _ in t)if(!(a&&_==="expose")){const x=M5[_]||i&&i[_];e[_]=x?x(e[_],t[_]):t[_]}return e}const M5={data:Zk,props:Yk,emits:Yk,methods:Qg,computed:Qg,beforeCreate:As,created:As,beforeMount:As,mounted:As,beforeUpdate:As,updated:As,beforeDestroy:As,beforeUnmount:As,destroyed:As,unmounted:As,activated:As,deactivated:As,errorCaptured:As,serverPrefetch:As,components:Qg,directives:Qg,watch:k5,provide:Zk,inject:I5};function Zk(e,t){return t?e?function(){return Ti(Fn(e)?e.call(this,this):e,Fn(t)?t.call(this,this):t)}:t:e}function I5(e,t){return Qg(Zw(e),Zw(t))}function Zw(e){if(on(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function As(e,t){return e?[...new Set([].concat(e,t))]:t}function Qg(e,t){return e?Ti(Object.create(null),e,t):t}function Yk(e,t){return e?on(e)&&on(t)?[...new Set([...e,...t])]:Ti(Object.create(null),qk(e),qk(t??{})):t}function k5(e,t){if(!e)return t;if(!t)return e;const i=Ti(Object.create(null),e);for(const a in t)i[a]=As(e[a],t[a]);return i}function iL(){return{app:null,config:{isNativeTag:y6,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let A5=0;function P5(e,t){return function(a,d=null){Fn(a)||(a=Ti({},a)),d!=null&&!Tr(d)&&(d=null);const m=iL(),_=new WeakSet,x=[];let o=!1;const C=m.app={_uid:A5++,_component:a,_props:d,_container:null,_context:m,_instance:null,version:l$,get config(){return m.config},set config(k){},use(k,...A){return _.has(k)||(k&&Fn(k.install)?(_.add(k),k.install(C,...A)):Fn(k)&&(_.add(k),k(C,...A))),C},mixin(k){return m.mixins.includes(k)||m.mixins.push(k),C},component(k,A){return A?(m.components[k]=A,C):m.components[k]},directive(k,A){return A?(m.directives[k]=A,C):m.directives[k]},mount(k,A,z){if(!o){const N=C._ceVNode||qe(a,d);return N.appContext=m,z===!0?z="svg":z===!1&&(z=void 0),A&&t?t(N,k):e(N,k,z),o=!0,C._container=k,k.__vue_app__=C,Lb(N.component)}},onUnmount(k){x.push(k)},unmount(){o&&(gl(x,C._instance,16),e(null,C._container),delete C._container.__vue_app__)},provide(k,A){return m.provides[k]=A,C},runWithContext(k){const A=bp;bp=C;try{return k()}finally{bp=A}}};return C}}let bp=null;function Br(e,t){if(ts){let i=ts.provides;const a=ts.parent&&ts.parent.provides;a===i&&(i=ts.provides=Object.create(a)),i[e]=t}}function kn(e,t,i=!1){const a=ts||Hi;if(a||bp){const d=bp?bp._context.provides:a?a.parent==null?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(d&&e in d)return d[e];if(arguments.length>1)return i&&Fn(t)?t.call(a&&a.proxy):t}}const sL={},aL=()=>Object.create(sL),lL=e=>Object.getPrototypeOf(e)===sL;function R5(e,t,i,a=!1){const d={},m=aL();e.propsDefaults=Object.create(null),cL(e,t,d,m);for(const _ in e.propsOptions[0])_ in d||(d[_]=void 0);i?e.props=a?d:LD(d):e.type.props?e.props=d:e.props=m,e.attrs=m}function D5(e,t,i,a){const{props:d,attrs:m,vnode:{patchFlag:_}}=e,x=Eo(d),[o]=e.propsOptions;let C=!1;if((a||_>0)&&!(_&16)){if(_&8){const k=e.vnode.dynamicProps;for(let A=0;A<k.length;A++){let z=k[A];if(Db(e.emitsOptions,z))continue;const N=t[z];if(o)if(Qr(m,z))N!==m[z]&&(m[z]=N,C=!0);else{const $=Xs(z);d[$]=Yw(o,x,$,N,e,!1)}else N!==m[z]&&(m[z]=N,C=!0)}}}else{cL(e,t,d,m)&&(C=!0);let k;for(const A in x)(!t||!Qr(t,A)&&((k=Dc(A))===A||!Qr(t,k)))&&(o?i&&(i[A]!==void 0||i[k]!==void 0)&&(d[A]=Yw(o,x,A,void 0,e,!0)):delete d[A]);if(m!==x)for(const A in m)(!t||!Qr(t,A))&&(delete m[A],C=!0)}C&&Ec(e.attrs,"set","")}function cL(e,t,i,a){const[d,m]=e.propsOptions;let _=!1,x;if(t)for(let o in t){if(rv(o))continue;const C=t[o];let k;d&&Qr(d,k=Xs(o))?!m||!m.includes(k)?i[k]=C:(x||(x={}))[k]=C:Db(e.emitsOptions,o)||(!(o in a)||C!==a[o])&&(a[o]=C,_=!0)}if(m){const o=Eo(i),C=x||ni;for(let k=0;k<m.length;k++){const A=m[k];i[A]=Yw(d,o,A,C[A],e,!Qr(C,A))}}return _}function Yw(e,t,i,a,d,m){const _=e[i];if(_!=null){const x=Qr(_,"default");if(x&&a===void 0){const o=_.default;if(_.type!==Function&&!_.skipFactory&&Fn(o)){const{propsDefaults:C}=d;if(i in C)a=C[i];else{const k=Yv(d);a=C[i]=o.call(null,t),k()}}else a=o;d.ce&&d.ce._setProp(i,a)}_[0]&&(m&&!x?a=!1:_[1]&&(a===""||a===Dc(i))&&(a=!0))}return a}const L5=new WeakMap;function uL(e,t,i=!1){const a=i?L5:t.propsCache,d=a.get(e);if(d)return d;const m=e.props,_={},x=[];let o=!1;if(!Fn(e)){const k=A=>{o=!0;const[z,N]=uL(A,t,!0);Ti(_,z),N&&x.push(...N)};!i&&t.mixins.length&&t.mixins.forEach(k),e.extends&&k(e.extends),e.mixins&&e.mixins.forEach(k)}if(!m&&!o)return Tr(e)&&a.set(e,mp),mp;if(on(m))for(let k=0;k<m.length;k++){const A=Xs(m[k]);Xk(A)&&(_[A]=ni)}else if(m)for(const k in m){const A=Xs(k);if(Xk(A)){const z=m[k],N=_[A]=on(z)||Fn(z)?{type:z}:Ti({},z),$=N.type;let F=!1,G=!0;if(on($))for(let U=0;U<$.length;++U){const te=$[U],Z=Fn(te)&&te.name;if(Z==="Boolean"){F=!0;break}else Z==="String"&&(G=!1)}else F=Fn($)&&$.name==="Boolean";N[0]=F,N[1]=G,(F||Qr(N,"default"))&&x.push(A)}}const C=[_,x];return Tr(e)&&a.set(e,C),C}function Xk(e){return e[0]!=="$"&&!rv(e)}const dL=e=>e[0]==="_"||e==="$stable",kT=e=>on(e)?e.map(Ul):[Ul(e)],O5=(e,t,i)=>{if(t._n)return t;const a=st((...d)=>kT(t(...d)),i);return a._c=!1,a},hL=(e,t,i)=>{const a=e._ctx;for(const d in e){if(dL(d))continue;const m=e[d];if(Fn(m))t[d]=O5(d,m,a);else if(m!=null){const _=kT(m);t[d]=()=>_}}},fL=(e,t)=>{const i=kT(t);e.slots.default=()=>i},pL=(e,t,i)=>{for(const a in t)(i||a!=="_")&&(e[a]=t[a])},z5=(e,t,i)=>{const a=e.slots=aL();if(e.vnode.shapeFlag&32){const d=t._;d?(pL(a,t,i),i&&fD(a,"_",d,!0)):hL(t,a)}else t&&fL(e,t)},B5=(e,t,i)=>{const{vnode:a,slots:d}=e;let m=!0,_=ni;if(a.shapeFlag&32){const x=t._;x?i&&x===1?m=!1:pL(d,t,i):(m=!t.$stable,hL(t,d)),_=t}else t&&(fL(e,t),_={default:1});if(m)for(const x in d)!dL(x)&&_[x]==null&&delete d[x]},qs=X5;function F5(e){return N5(e)}function N5(e,t){const i=Cb();i.__VUE__=!0;const{insert:a,remove:d,patchProp:m,createElement:_,createText:x,createComment:o,setText:C,setElementText:k,parentNode:A,nextSibling:z,setScopeId:N=_o,insertStaticContent:$}=e,F=(He,pt,et,rn=null,kt=null,zt=null,Mt=void 0,en=null,sn=!!pt.dynamicChildren)=>{if(He===pt)return;He&&!ah(He,pt)&&(rn=mt(He),it(He,kt,zt,!0),He=null),pt.patchFlag===-2&&(sn=!1,pt.dynamicChildren=null);const{type:dn,ref:Pn,shapeFlag:Ot}=pt;switch(dn){case qp:G(He,pt,et,rn);break;case Oi:U(He,pt,et,rn);break;case aw:He==null&&te(pt,et,rn,Mt);break;case Bn:ue(He,pt,et,rn,kt,zt,Mt,en,sn);break;default:Ot&1?X(He,pt,et,rn,kt,zt,Mt,en,sn):Ot&6?Re(He,pt,et,rn,kt,zt,Mt,en,sn):(Ot&64||Ot&128)&&dn.process(He,pt,et,rn,kt,zt,Mt,en,sn,Tn)}Pn!=null&&kt&&Ww(Pn,He&&He.ref,zt,pt||He,!pt)},G=(He,pt,et,rn)=>{if(He==null)a(pt.el=x(pt.children),et,rn);else{const kt=pt.el=He.el;pt.children!==He.children&&C(kt,pt.children)}},U=(He,pt,et,rn)=>{He==null?a(pt.el=o(pt.children||""),et,rn):pt.el=He.el},te=(He,pt,et,rn)=>{[He.el,He.anchor]=$(He.children,pt,et,rn,He.el,He.anchor)},Z=({el:He,anchor:pt},et,rn)=>{let kt;for(;He&&He!==pt;)kt=z(He),a(He,et,rn),He=kt;a(pt,et,rn)},q=({el:He,anchor:pt})=>{let et;for(;He&&He!==pt;)et=z(He),d(He),He=et;d(pt)},X=(He,pt,et,rn,kt,zt,Mt,en,sn)=>{pt.type==="svg"?Mt="svg":pt.type==="math"&&(Mt="mathml"),He==null?ie(pt,et,rn,kt,zt,Mt,en,sn):pe(He,pt,kt,zt,Mt,en,sn)},ie=(He,pt,et,rn,kt,zt,Mt,en)=>{let sn,dn;const{props:Pn,shapeFlag:Ot,transition:Zt,dirs:jn}=He;if(sn=He.el=_(He.type,zt,Pn&&Pn.is,Pn),Ot&8?k(sn,He.children):Ot&16&&le(He.children,sn,null,rn,kt,iw(He,zt),Mt,en),jn&&th(He,null,rn,"created"),de(sn,He,He.scopeId,Mt,rn),Pn){for(const ur in Pn)ur!=="value"&&!rv(ur)&&m(sn,ur,null,Pn[ur],zt,rn);"value"in Pn&&m(sn,"value",null,Pn.value,zt),(dn=Pn.onVnodeBeforeMount)&&$l(dn,rn,He)}jn&&th(He,null,rn,"beforeMount");const ir=$5(kt,Zt);ir&&Zt.beforeEnter(sn),a(sn,pt,et),((dn=Pn&&Pn.onVnodeMounted)||ir||jn)&&qs(()=>{dn&&$l(dn,rn,He),ir&&Zt.enter(sn),jn&&th(He,null,rn,"mounted")},kt)},de=(He,pt,et,rn,kt)=>{if(et&&N(He,et),rn)for(let zt=0;zt<rn.length;zt++)N(He,rn[zt]);if(kt){let zt=kt.subTree;if(pt===zt||_L(zt.type)&&(zt.ssContent===pt||zt.ssFallback===pt)){const Mt=kt.vnode;de(He,Mt,Mt.scopeId,Mt.slotScopeIds,kt.parent)}}},le=(He,pt,et,rn,kt,zt,Mt,en,sn=0)=>{for(let dn=sn;dn<He.length;dn++){const Pn=He[dn]=en?Vu(He[dn]):Ul(He[dn]);F(null,Pn,pt,et,rn,kt,zt,Mt,en)}},pe=(He,pt,et,rn,kt,zt,Mt)=>{const en=pt.el=He.el;let{patchFlag:sn,dynamicChildren:dn,dirs:Pn}=pt;sn|=He.patchFlag&16;const Ot=He.props||ni,Zt=pt.props||ni;let jn;if(et&&nh(et,!1),(jn=Zt.onVnodeBeforeUpdate)&&$l(jn,et,pt,He),Pn&&th(pt,He,et,"beforeUpdate"),et&&nh(et,!0),(Ot.innerHTML&&Zt.innerHTML==null||Ot.textContent&&Zt.textContent==null)&&k(en,""),dn?ge(He.dynamicChildren,dn,en,et,rn,iw(pt,kt),zt):Mt||Se(He,pt,en,null,et,rn,iw(pt,kt),zt,!1),sn>0){if(sn&16)he(en,Ot,Zt,et,kt);else if(sn&2&&Ot.class!==Zt.class&&m(en,"class",null,Zt.class,kt),sn&4&&m(en,"style",Ot.style,Zt.style,kt),sn&8){const ir=pt.dynamicProps;for(let ur=0;ur<ir.length;ur++){const ar=ir[ur],wr=Ot[ar],Xr=Zt[ar];(Xr!==wr||ar==="value")&&m(en,ar,wr,Xr,kt,et)}}sn&1&&He.children!==pt.children&&k(en,pt.children)}else!Mt&&dn==null&&he(en,Ot,Zt,et,kt);((jn=Zt.onVnodeUpdated)||Pn)&&qs(()=>{jn&&$l(jn,et,pt,He),Pn&&th(pt,He,et,"updated")},rn)},ge=(He,pt,et,rn,kt,zt,Mt)=>{for(let en=0;en<pt.length;en++){const sn=He[en],dn=pt[en],Pn=sn.el&&(sn.type===Bn||!ah(sn,dn)||sn.shapeFlag&70)?A(sn.el):et;F(sn,dn,Pn,null,rn,kt,zt,Mt,!0)}},he=(He,pt,et,rn,kt)=>{if(pt!==et){if(pt!==ni)for(const zt in pt)!rv(zt)&&!(zt in et)&&m(He,zt,pt[zt],null,kt,rn);for(const zt in et){if(rv(zt))continue;const Mt=et[zt],en=pt[zt];Mt!==en&&zt!=="value"&&m(He,zt,en,Mt,kt,rn)}"value"in et&&m(He,"value",pt.value,et.value,kt)}},ue=(He,pt,et,rn,kt,zt,Mt,en,sn)=>{const dn=pt.el=He?He.el:x(""),Pn=pt.anchor=He?He.anchor:x("");let{patchFlag:Ot,dynamicChildren:Zt,slotScopeIds:jn}=pt;jn&&(en=en?en.concat(jn):jn),He==null?(a(dn,et,rn),a(Pn,et,rn),le(pt.children||[],et,Pn,kt,zt,Mt,en,sn)):Ot>0&&Ot&64&&Zt&&He.dynamicChildren?(ge(He.dynamicChildren,Zt,et,kt,zt,Mt,en),(pt.key!=null||kt&&pt===kt.subTree)&&AT(He,pt,!0)):Se(He,pt,et,Pn,kt,zt,Mt,en,sn)},Re=(He,pt,et,rn,kt,zt,Mt,en,sn)=>{pt.slotScopeIds=en,He==null?pt.shapeFlag&512?kt.ctx.activate(pt,et,rn,Mt,sn):Ye(pt,et,rn,kt,zt,Mt,sn):Ie(He,pt,sn)},Ye=(He,pt,et,rn,kt,zt,Mt)=>{const en=He.component=n$(He,rn,kt);if(kb(He)&&(en.ctx.renderer=Tn),r$(en,!1,Mt),en.asyncDep){if(kt&&kt.registerDep(en,fe,Mt),!He.el){const sn=en.subTree=qe(Oi);U(null,sn,pt,et)}}else fe(en,He,pt,et,kt,zt,Mt)},Ie=(He,pt,et)=>{const rn=pt.component=He.component;if(Z5(He,pt,et))if(rn.asyncDep&&!rn.asyncResolved){Me(rn,pt,et);return}else rn.next=pt,rn.update();else pt.el=He.el,rn.vnode=pt},fe=(He,pt,et,rn,kt,zt,Mt)=>{const en=()=>{if(He.isMounted){let{next:Ot,bu:Zt,u:jn,parent:ir,vnode:ur}=He;{const _n=mL(He);if(_n){Ot&&(Ot.el=ur.el,Me(He,Ot,Mt)),_n.asyncDep.then(()=>{He.isUnmounted||en()});return}}let ar=Ot,wr;nh(He,!1),Ot?(Ot.el=ur.el,Me(He,Ot,Mt)):Ot=ur,Zt&&T0(Zt),(wr=Ot.props&&Ot.props.onVnodeBeforeUpdate)&&$l(wr,ir,Ot,ur),nh(He,!0);const Xr=sw(He),Rt=He.subTree;He.subTree=Xr,F(Rt,Xr,A(Rt.el),mt(Rt),He,kt,zt),Ot.el=Xr.el,ar===null&&Y5(He,Xr.el),jn&&qs(jn,kt),(wr=Ot.props&&Ot.props.onVnodeUpdated)&&qs(()=>$l(wr,ir,Ot,ur),kt)}else{let Ot;const{el:Zt,props:jn}=pt,{bm:ir,m:ur,parent:ar,root:wr,type:Xr}=He,Rt=yp(pt);if(nh(He,!1),ir&&T0(ir),!Rt&&(Ot=jn&&jn.onVnodeBeforeMount)&&$l(Ot,ar,pt),nh(He,!0),Zt&&At){const _n=()=>{He.subTree=sw(He),At(Zt,He.subTree,He,kt,null)};Rt&&Xr.__asyncHydrate?Xr.__asyncHydrate(Zt,He,_n):_n()}else{wr.ce&&wr.ce._injectChildStyle(Xr);const _n=He.subTree=sw(He);F(null,_n,et,rn,He,kt,zt),pt.el=_n.el}if(ur&&qs(ur,kt),!Rt&&(Ot=jn&&jn.onVnodeMounted)){const _n=pt;qs(()=>$l(Ot,ar,_n),kt)}(pt.shapeFlag&256||ar&&yp(ar.vnode)&&ar.vnode.shapeFlag&256)&&He.a&&qs(He.a,kt),He.isMounted=!0,pt=et=rn=null}};He.scope.on();const sn=He.effect=new bD(en);He.scope.off();const dn=He.update=sn.run.bind(sn),Pn=He.job=sn.runIfDirty.bind(sn);Pn.i=He,Pn.id=He.uid,sn.scheduler=()=>ST(Pn),nh(He,!0),dn()},Me=(He,pt,et)=>{pt.component=He;const rn=He.vnode.props;He.vnode=pt,He.next=null,D5(He,pt.props,rn,et),B5(He,pt.children,et),ad(),Uk(He),ld()},Se=(He,pt,et,rn,kt,zt,Mt,en,sn=!1)=>{const dn=He&&He.children,Pn=He?He.shapeFlag:0,Ot=pt.children,{patchFlag:Zt,shapeFlag:jn}=pt;if(Zt>0){if(Zt&128){Ce(dn,Ot,et,rn,kt,zt,Mt,en,sn);return}else if(Zt&256){ye(dn,Ot,et,rn,kt,zt,Mt,en,sn);return}}jn&8?(Pn&16&&Ft(dn,kt,zt),Ot!==dn&&k(et,Ot)):Pn&16?jn&16?Ce(dn,Ot,et,rn,kt,zt,Mt,en,sn):Ft(dn,kt,zt,!0):(Pn&8&&k(et,""),jn&16&&le(Ot,et,rn,kt,zt,Mt,en,sn))},ye=(He,pt,et,rn,kt,zt,Mt,en,sn)=>{He=He||mp,pt=pt||mp;const dn=He.length,Pn=pt.length,Ot=Math.min(dn,Pn);let Zt;for(Zt=0;Zt<Ot;Zt++){const jn=pt[Zt]=sn?Vu(pt[Zt]):Ul(pt[Zt]);F(He[Zt],jn,et,null,kt,zt,Mt,en,sn)}dn>Pn?Ft(He,kt,zt,!0,!1,Ot):le(pt,et,rn,kt,zt,Mt,en,sn,Ot)},Ce=(He,pt,et,rn,kt,zt,Mt,en,sn)=>{let dn=0;const Pn=pt.length;let Ot=He.length-1,Zt=Pn-1;for(;dn<=Ot&&dn<=Zt;){const jn=He[dn],ir=pt[dn]=sn?Vu(pt[dn]):Ul(pt[dn]);if(ah(jn,ir))F(jn,ir,et,null,kt,zt,Mt,en,sn);else break;dn++}for(;dn<=Ot&&dn<=Zt;){const jn=He[Ot],ir=pt[Zt]=sn?Vu(pt[Zt]):Ul(pt[Zt]);if(ah(jn,ir))F(jn,ir,et,null,kt,zt,Mt,en,sn);else break;Ot--,Zt--}if(dn>Ot){if(dn<=Zt){const jn=Zt+1,ir=jn<Pn?pt[jn].el:rn;for(;dn<=Zt;)F(null,pt[dn]=sn?Vu(pt[dn]):Ul(pt[dn]),et,ir,kt,zt,Mt,en,sn),dn++}}else if(dn>Zt)for(;dn<=Ot;)it(He[dn],kt,zt,!0),dn++;else{const jn=dn,ir=dn,ur=new Map;for(dn=ir;dn<=Zt;dn++){const Ze=pt[dn]=sn?Vu(pt[dn]):Ul(pt[dn]);Ze.key!=null&&ur.set(Ze.key,dn)}let ar,wr=0;const Xr=Zt-ir+1;let Rt=!1,_n=0;const dt=new Array(Xr);for(dn=0;dn<Xr;dn++)dt[dn]=0;for(dn=jn;dn<=Ot;dn++){const Ze=He[dn];if(wr>=Xr){it(Ze,kt,zt,!0);continue}let gn;if(Ze.key!=null)gn=ur.get(Ze.key);else for(ar=ir;ar<=Zt;ar++)if(dt[ar-ir]===0&&ah(Ze,pt[ar])){gn=ar;break}gn===void 0?it(Ze,kt,zt,!0):(dt[gn-ir]=dn+1,gn>=_n?_n=gn:Rt=!0,F(Ze,pt[gn],et,null,kt,zt,Mt,en,sn),wr++)}const tn=Rt?V5(dt):mp;for(ar=tn.length-1,dn=Xr-1;dn>=0;dn--){const Ze=ir+dn,gn=pt[Ze],rr=Ze+1<Pn?pt[Ze+1].el:rn;dt[dn]===0?F(null,gn,et,rr,kt,zt,Mt,en,sn):Rt&&(ar<0||dn!==tn[ar]?Fe(gn,et,rr,2):ar--)}}},Fe=(He,pt,et,rn,kt=null)=>{const{el:zt,type:Mt,transition:en,children:sn,shapeFlag:dn}=He;if(dn&6){Fe(He.component.subTree,pt,et,rn);return}if(dn&128){He.suspense.move(pt,et,rn);return}if(dn&64){Mt.move(He,pt,et,Tn);return}if(Mt===Bn){a(zt,pt,et);for(let Ot=0;Ot<sn.length;Ot++)Fe(sn[Ot],pt,et,rn);a(He.anchor,pt,et);return}if(Mt===aw){Z(He,pt,et);return}if(rn!==2&&dn&1&&en)if(rn===0)en.beforeEnter(zt),a(zt,pt,et),qs(()=>en.enter(zt),kt);else{const{leave:Ot,delayLeave:Zt,afterLeave:jn}=en,ir=()=>a(zt,pt,et),ur=()=>{Ot(zt,()=>{ir(),jn&&jn()})};Zt?Zt(zt,ir,ur):ur()}else a(zt,pt,et)},it=(He,pt,et,rn=!1,kt=!1)=>{const{type:zt,props:Mt,ref:en,children:sn,dynamicChildren:dn,shapeFlag:Pn,patchFlag:Ot,dirs:Zt,cacheIndex:jn}=He;if(Ot===-2&&(kt=!1),en!=null&&Ww(en,null,et,He,!0),jn!=null&&(pt.renderCache[jn]=void 0),Pn&256){pt.ctx.deactivate(He);return}const ir=Pn&1&&Zt,ur=!yp(He);let ar;if(ur&&(ar=Mt&&Mt.onVnodeBeforeUnmount)&&$l(ar,pt,He),Pn&6)Lt(He.component,et,rn);else{if(Pn&128){He.suspense.unmount(et,rn);return}ir&&th(He,null,pt,"beforeUnmount"),Pn&64?He.type.remove(He,pt,et,Tn,rn):dn&&!dn.hasOnce&&(zt!==Bn||Ot>0&&Ot&64)?Ft(dn,pt,et,!1,!0):(zt===Bn&&Ot&384||!kt&&Pn&16)&&Ft(sn,pt,et),rn&&We(He)}(ur&&(ar=Mt&&Mt.onVnodeUnmounted)||ir)&&qs(()=>{ar&&$l(ar,pt,He),ir&&th(He,null,pt,"unmounted")},et)},We=He=>{const{type:pt,el:et,anchor:rn,transition:kt}=He;if(pt===Bn){ut(et,rn);return}if(pt===aw){q(He);return}const zt=()=>{d(et),kt&&!kt.persisted&&kt.afterLeave&&kt.afterLeave()};if(He.shapeFlag&1&&kt&&!kt.persisted){const{leave:Mt,delayLeave:en}=kt,sn=()=>Mt(et,zt);en?en(He.el,zt,sn):sn()}else zt()},ut=(He,pt)=>{let et;for(;He!==pt;)et=z(He),d(He),He=et;d(pt)},Lt=(He,pt,et)=>{const{bum:rn,scope:kt,job:zt,subTree:Mt,um:en,m:sn,a:dn}=He;Jk(sn),Jk(dn),rn&&T0(rn),kt.stop(),zt&&(zt.flags|=8,it(Mt,He,pt,et)),en&&qs(en,pt),qs(()=>{He.isUnmounted=!0},pt),pt&&pt.pendingBranch&&!pt.isUnmounted&&He.asyncDep&&!He.asyncResolved&&He.suspenseId===pt.pendingId&&(pt.deps--,pt.deps===0&&pt.resolve())},Ft=(He,pt,et,rn=!1,kt=!1,zt=0)=>{for(let Mt=zt;Mt<He.length;Mt++)it(He[Mt],pt,et,rn,kt)},mt=He=>{if(He.shapeFlag&6)return mt(He.component.subTree);if(He.shapeFlag&128)return He.suspense.next();const pt=z(He.anchor||He.el),et=pt&&pt[jD];return et?z(et):pt};let jt=!1;const Ht=(He,pt,et)=>{He==null?pt._vnode&&it(pt._vnode,null,null,!0):F(pt._vnode||null,He,pt,null,null,null,et),pt._vnode=He,jt||(jt=!0,Uk(),$D(),jt=!1)},Tn={p:F,um:it,m:Fe,r:We,mt:Ye,mc:le,pc:Se,pbc:ge,n:mt,o:e};let Pe,At;return{render:Ht,hydrate:Pe,createApp:P5(Ht,Pe)}}function iw({type:e,props:t},i){return i==="svg"&&e==="foreignObject"||i==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:i}function nh({effect:e,job:t},i){i?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function $5(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function AT(e,t,i=!1){const a=e.children,d=t.children;if(on(a)&&on(d))for(let m=0;m<a.length;m++){const _=a[m];let x=d[m];x.shapeFlag&1&&!x.dynamicChildren&&((x.patchFlag<=0||x.patchFlag===32)&&(x=d[m]=Vu(d[m]),x.el=_.el),!i&&x.patchFlag!==-2&&AT(_,x)),x.type===qp&&(x.el=_.el)}}function V5(e){const t=e.slice(),i=[0];let a,d,m,_,x;const o=e.length;for(a=0;a<o;a++){const C=e[a];if(C!==0){if(d=i[i.length-1],e[d]<C){t[a]=d,i.push(a);continue}for(m=0,_=i.length-1;m<_;)x=m+_>>1,e[i[x]]<C?m=x+1:_=x;C<e[i[m]]&&(m>0&&(t[a]=i[m-1]),i[m]=a)}}for(m=i.length,_=i[m-1];m-- >0;)i[m]=_,_=t[_];return i}function mL(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:mL(t)}function Jk(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const U5=Symbol.for("v-scx"),j5=()=>kn(U5);function ns(e,t){return PT(e,null,t)}function Wt(e,t,i){return PT(e,t,i)}function PT(e,t,i=ni){const{immediate:a,deep:d,flush:m,once:_}=i,x=Ti({},i),o=t&&a||!t&&m!=="post";let C;if(Tv){if(m==="sync"){const N=j5();C=N.__watcherHandles||(N.__watcherHandles=[])}else if(!o){const N=()=>{};return N.stop=_o,N.resume=_o,N.pause=_o,N}}const k=ts;x.call=(N,$,F)=>gl(N,k,$,F);let A=!1;m==="post"?x.scheduler=N=>{qs(N,k&&k.suspense)}:m!=="sync"&&(A=!0,x.scheduler=(N,$)=>{$?N():ST(N)}),x.augmentJob=N=>{t&&(N.flags|=4),A&&(N.flags|=2,k&&(N.id=k.uid,N.i=k))};const z=a5(e,t,x);return Tv&&(C?C.push(z):o&&z()),z}function H5(e,t,i){const a=this.proxy,d=zn(e)?e.includes(".")?gL(a,e):()=>a[e]:e.bind(a,a);let m;Fn(t)?m=t:(m=t.handler,i=t);const _=Yv(this),x=PT(d,m.bind(a),i);return _(),x}function gL(e,t){const i=t.split(".");return()=>{let a=e;for(let d=0;d<i.length&&a;d++)a=a[i[d]];return a}}const G5=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Xs(t)}Modifiers`]||e[`${Dc(t)}Modifiers`];function W5(e,t,...i){if(e.isUnmounted)return;const a=e.vnode.props||ni;let d=i;const m=t.startsWith("update:"),_=m&&G5(a,t.slice(7));_&&(_.trim&&(d=i.map(k=>zn(k)?k.trim():k)),_.number&&(d=i.map(G0)));let x,o=a[x=ov(t)]||a[x=ov(Xs(t))];!o&&m&&(o=a[x=ov(Dc(t))]),o&&gl(o,e,6,d);const C=a[x+"Once"];if(C){if(!e.emitted)e.emitted={};else if(e.emitted[x])return;e.emitted[x]=!0,gl(C,e,6,d)}}function vL(e,t,i=!1){const a=t.emitsCache,d=a.get(e);if(d!==void 0)return d;const m=e.emits;let _={},x=!1;if(!Fn(e)){const o=C=>{const k=vL(C,t,!0);k&&(x=!0,Ti(_,k))};!i&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}return!m&&!x?(Tr(e)&&a.set(e,null),null):(on(m)?m.forEach(o=>_[o]=null):Ti(_,m),Tr(e)&&a.set(e,_),_)}function Db(e,t){return!e||!Sb(t)?!1:(t=t.slice(2).replace(/Once$/,""),Qr(e,t[0].toLowerCase()+t.slice(1))||Qr(e,Dc(t))||Qr(e,t))}function sw(e){const{type:t,vnode:i,proxy:a,withProxy:d,propsOptions:[m],slots:_,attrs:x,emit:o,render:C,renderCache:k,props:A,data:z,setupState:N,ctx:$,inheritAttrs:F}=e,G=Z0(e);let U,te;try{if(i.shapeFlag&4){const q=d||a,X=q;U=Ul(C.call(X,q,k,A,N,z,$)),te=x}else{const q=t;U=Ul(q.length>1?q(A,{attrs:x,slots:_,emit:o}):q(A,null)),te=t.props?x:q5(x)}}catch(q){cv.length=0,Ib(q,e,1),U=qe(Oi)}let Z=U;if(te&&F!==!1){const q=Object.keys(te),{shapeFlag:X}=Z;q.length&&X&7&&(m&&q.some(fT)&&(te=K5(te,m)),Z=Ac(Z,te,!1,!0))}return i.dirs&&(Z=Ac(Z,null,!1,!0),Z.dirs=Z.dirs?Z.dirs.concat(i.dirs):i.dirs),i.transition&&Sh(Z,i.transition),U=Z,Z0(G),U}const q5=e=>{let t;for(const i in e)(i==="class"||i==="style"||Sb(i))&&((t||(t={}))[i]=e[i]);return t},K5=(e,t)=>{const i={};for(const a in e)(!fT(a)||!(a.slice(9)in t))&&(i[a]=e[a]);return i};function Z5(e,t,i){const{props:a,children:d,component:m}=e,{props:_,children:x,patchFlag:o}=t,C=m.emitsOptions;if(t.dirs||t.transition)return!0;if(i&&o>=0){if(o&1024)return!0;if(o&16)return a?Qk(a,_,C):!!_;if(o&8){const k=t.dynamicProps;for(let A=0;A<k.length;A++){const z=k[A];if(_[z]!==a[z]&&!Db(C,z))return!0}}}else return(d||x)&&(!x||!x.$stable)?!0:a===_?!1:a?_?Qk(a,_,C):!0:!!_;return!1}function Qk(e,t,i){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let d=0;d<a.length;d++){const m=a[d];if(t[m]!==e[m]&&!Db(i,m))return!0}return!1}function Y5({vnode:e,parent:t},i){for(;t;){const a=t.subTree;if(a.suspense&&a.suspense.activeBranch===e&&(a.el=e.el),a===e)(e=t.vnode).el=i,t=t.parent;else break}}const _L=e=>e.__isSuspense;function X5(e,t){t&&t.pendingBranch?on(e)?t.effects.push(...e):t.effects.push(e):u5(e)}const Bn=Symbol.for("v-fgt"),qp=Symbol.for("v-txt"),Oi=Symbol.for("v-cmt"),aw=Symbol.for("v-stc"),cv=[];let ha=null;function se(e=!1){cv.push(ha=e?null:[])}function J5(){cv.pop(),ha=cv[cv.length-1]||null}let Sv=1;function eA(e){Sv+=e,e<0&&ha&&(ha.hasOnce=!0)}function yL(e){return e.dynamicChildren=Sv>0?ha||mp:null,J5(),Sv>0&&ha&&ha.push(e),e}function Ae(e,t,i,a,d,m){return yL(Ve(e,t,i,a,d,m,!0))}function It(e,t,i,a,d){return yL(qe(e,t,i,a,d,!0))}function Ho(e){return e?e.__v_isVNode===!0:!1}function ah(e,t){return e.type===t.type&&e.key===t.key}const bL=({key:e})=>e??null,E0=({ref:e,ref_key:t,ref_for:i})=>(typeof e=="number"&&(e=""+e),e!=null?zn(e)||Fo(e)||Fn(e)?{i:Hi,r:e,k:t,f:!!i}:e:null);function Ve(e,t=null,i=null,a=0,d=null,m=e===Bn?0:1,_=!1,x=!1){const o={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&bL(t),ref:t&&E0(t),scopeId:UD,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:m,patchFlag:a,dynamicProps:d,dynamicChildren:null,appContext:null,ctx:Hi};return x?(RT(o,i),m&128&&e.normalize(o)):i&&(o.shapeFlag|=zn(i)?8:16),Sv>0&&!_&&ha&&(o.patchFlag>0||m&6)&&o.patchFlag!==32&&ha.push(o),o}const qe=Q5;function Q5(e,t=null,i=null,a=0,d=null,m=!1){if((!e||e===tL)&&(e=Oi),Ho(e)){const x=Ac(e,t,!0);return i&&RT(x,i),Sv>0&&!m&&ha&&(x.shapeFlag&6?ha[ha.indexOf(e)]=x:ha.push(x)),x.patchFlag=-2,x}if(a$(e)&&(e=e.__vccOpts),t){t=Xu(t);let{class:x,style:o}=t;x&&!zn(x)&&(t.class=ce(x)),Tr(o)&&(wT(o)&&!on(o)&&(o=Ti({},o)),t.style=Nn(o))}const _=zn(e)?1:_L(e)?128:HD(e)?64:Tr(e)?4:Fn(e)?2:0;return Ve(e,t,i,a,d,_,m,!0)}function Xu(e){return e?wT(e)||lL(e)?Ti({},e):e:null}function Ac(e,t,i=!1,a=!1){const{props:d,ref:m,patchFlag:_,children:x,transition:o}=e,C=t?kr(d||{},t):d,k={__v_isVNode:!0,__v_skip:!0,type:e.type,props:C,key:C&&bL(C),ref:t&&t.ref?i&&m?on(m)?m.concat(E0(t)):[m,E0(t)]:E0(t):m,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:x,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Bn?_===-1?16:_|16:_,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:o,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ac(e.ssContent),ssFallback:e.ssFallback&&Ac(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return o&&a&&Sh(k,o.clone(k)),k}function $r(e=" ",t=0){return qe(qp,null,e,t)}function bt(e="",t=!1){return t?(se(),It(Oi,null,e)):qe(Oi,null,e)}function Ul(e){return e==null||typeof e=="boolean"?qe(Oi):on(e)?qe(Bn,null,e.slice()):Ho(e)?Vu(e):qe(qp,null,String(e))}function Vu(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ac(e)}function RT(e,t){let i=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(on(t))i=16;else if(typeof t=="object")if(a&65){const d=t.default;d&&(d._c&&(d._d=!1),RT(e,d()),d._c&&(d._d=!0));return}else{i=32;const d=t._;!d&&!lL(t)?t._ctx=Hi:d===3&&Hi&&(Hi.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Fn(t)?(t={default:t,_ctx:Hi},i=32):(t=String(t),a&64?(i=16,t=[$r(t)]):i=8);e.children=t,e.shapeFlag|=i}function kr(...e){const t={};for(let i=0;i<e.length;i++){const a=e[i];for(const d in a)if(d==="class")t.class!==a.class&&(t.class=ce([t.class,a.class]));else if(d==="style")t.style=Nn([t.style,a.style]);else if(Sb(d)){const m=t[d],_=a[d];_&&m!==_&&!(on(m)&&m.includes(_))&&(t[d]=m?[].concat(m,_):_)}else d!==""&&(t[d]=a[d])}return t}function $l(e,t,i,a=null){gl(e,t,7,[i,a])}const e$=iL();let t$=0;function n$(e,t,i){const a=e.type,d=(t?t.appContext:e.appContext)||e$,m={uid:t$++,vnode:e,type:a,parent:t,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new vD(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(d.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:uL(a,d),emitsOptions:vL(a,d),emit:null,emitted:null,propsDefaults:ni,inheritAttrs:a.inheritAttrs,ctx:ni,data:ni,props:ni,attrs:ni,slots:ni,refs:ni,setupState:ni,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return m.ctx={_:m},m.root=t?t.root:m,m.emit=W5.bind(null,m),e.ce&&e.ce(m),m}let ts=null;const Cr=()=>ts||Hi;let X0,Xw;{const e=Cb(),t=(i,a)=>{let d;return(d=e[i])||(d=e[i]=[]),d.push(a),m=>{d.length>1?d.forEach(_=>_(m)):d[0](m)}};X0=t("__VUE_INSTANCE_SETTERS__",i=>ts=i),Xw=t("__VUE_SSR_SETTERS__",i=>Tv=i)}const Yv=e=>{const t=ts;return X0(e),e.scope.on(),()=>{e.scope.off(),X0(t)}},tA=()=>{ts&&ts.scope.off(),X0(null)};function xL(e){return e.vnode.shapeFlag&4}let Tv=!1;function r$(e,t=!1,i=!1){t&&Xw(t);const{props:a,children:d}=e.vnode,m=xL(e);R5(e,a,m,t),z5(e,d,i);const _=m?o$(e,t):void 0;return t&&Xw(!1),_}function o$(e,t){const i=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,T5);const{setup:a}=i;if(a){ad();const d=e.setupContext=a.length>1?SL(e):null,m=Yv(e),_=Zv(a,e,0,[e.props,d]),x=vv(_);if(ld(),m(),(x||e.sp)&&!yp(e)&&XD(e),x){if(_.then(tA,tA),t)return _.then(o=>{nA(e,o,t)}).catch(o=>{Ib(o,e,0)});e.asyncDep=_}else nA(e,_,t)}else wL(e,t)}function nA(e,t,i){Fn(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Tr(t)&&(e.setupState=zD(t)),wL(e,i)}let rA;function wL(e,t,i){const a=e.type;if(!e.render){if(!t&&rA&&!a.render){const d=a.template||IT(e).template;if(d){const{isCustomElement:m,compilerOptions:_}=e.appContext.config,{delimiters:x,compilerOptions:o}=a,C=Ti(Ti({isCustomElement:m,delimiters:x},_),o);a.render=rA(d,C)}}e.render=a.render||_o}{const d=Yv(e);ad();try{C5(e)}finally{ld(),d()}}}const i$={get(e,t){return fs(e,"get",""),e[t]}};function SL(e){const t=i=>{e.exposed=i||{}};return{attrs:new Proxy(e.attrs,i$),slots:e.slots,emit:e.emit,expose:t}}function Lb(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(zD(Wu(e.exposed)),{get(t,i){if(i in t)return t[i];if(i in lv)return lv[i](e)},has(t,i){return i in t||i in lv}})):e.proxy}function s$(e,t=!0){return Fn(e)?e.displayName||e.name:e.name||t&&e.__name}function a$(e){return Fn(e)&&"__vccOpts"in e}const Q=(e,t)=>i5(e,t,Tv);function Kn(e,t,i){const a=arguments.length;return a===2?Tr(t)&&!on(t)?Ho(t)?qe(e,null,[t]):qe(e,t):qe(e,null,t):(a>3?i=Array.prototype.slice.call(arguments,2):a===3&&Ho(i)&&(i=[i]),qe(e,t,i))}const l$="3.5.12",c$=_o;/**
* @vue/runtime-dom v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Jw;const oA=typeof window<"u"&&window.trustedTypes;if(oA)try{Jw=oA.createPolicy("vue",{createHTML:e=>e})}catch{}const TL=Jw?e=>Jw.createHTML(e):e=>e,u$="http://www.w3.org/2000/svg",d$="http://www.w3.org/1998/Math/MathML",Tc=typeof document<"u"?document:null,iA=Tc&&Tc.createElement("template"),h$={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,a)=>{const d=t==="svg"?Tc.createElementNS(u$,e):t==="mathml"?Tc.createElementNS(d$,e):i?Tc.createElement(e,{is:i}):Tc.createElement(e);return e==="select"&&a&&a.multiple!=null&&d.setAttribute("multiple",a.multiple),d},createText:e=>Tc.createTextNode(e),createComment:e=>Tc.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Tc.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,a,d,m){const _=i?i.previousSibling:t.lastChild;if(d&&(d===m||d.nextSibling))for(;t.insertBefore(d.cloneNode(!0),i),!(d===m||!(d=d.nextSibling)););else{iA.innerHTML=TL(a==="svg"?`<svg>${e}</svg>`:a==="mathml"?`<math>${e}</math>`:e);const x=iA.content;if(a==="svg"||a==="mathml"){const o=x.firstChild;for(;o.firstChild;)x.appendChild(o.firstChild);x.removeChild(o)}t.insertBefore(x,i)}return[_?_.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}},Du="transition",Wg="animation",Mp=Symbol("_vtc"),CL={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},EL=Ti({},qD,CL),f$=e=>(e.displayName="Transition",e.props=EL,e),Fi=f$((e,{slots:t})=>Kn(g5,ML(e),t)),rh=(e,t=[])=>{on(e)?e.forEach(i=>i(...t)):e&&e(...t)},sA=e=>e?on(e)?e.some(t=>t.length>1):e.length>1:!1;function ML(e){const t={};for(const ue in e)ue in CL||(t[ue]=e[ue]);if(e.css===!1)return t;const{name:i="v",type:a,duration:d,enterFromClass:m=`${i}-enter-from`,enterActiveClass:_=`${i}-enter-active`,enterToClass:x=`${i}-enter-to`,appearFromClass:o=m,appearActiveClass:C=_,appearToClass:k=x,leaveFromClass:A=`${i}-leave-from`,leaveActiveClass:z=`${i}-leave-active`,leaveToClass:N=`${i}-leave-to`}=e,$=p$(d),F=$&&$[0],G=$&&$[1],{onBeforeEnter:U,onEnter:te,onEnterCancelled:Z,onLeave:q,onLeaveCancelled:X,onBeforeAppear:ie=U,onAppear:de=te,onAppearCancelled:le=Z}=t,pe=(ue,Re,Ye)=>{Ou(ue,Re?k:x),Ou(ue,Re?C:_),Ye&&Ye()},ge=(ue,Re)=>{ue._isLeaving=!1,Ou(ue,A),Ou(ue,N),Ou(ue,z),Re&&Re()},he=ue=>(Re,Ye)=>{const Ie=ue?de:te,fe=()=>pe(Re,ue,Ye);rh(Ie,[Re,fe]),aA(()=>{Ou(Re,ue?o:m),Sc(Re,ue?k:x),sA(Ie)||lA(Re,a,F,fe)})};return Ti(t,{onBeforeEnter(ue){rh(U,[ue]),Sc(ue,m),Sc(ue,_)},onBeforeAppear(ue){rh(ie,[ue]),Sc(ue,o),Sc(ue,C)},onEnter:he(!1),onAppear:he(!0),onLeave(ue,Re){ue._isLeaving=!0;const Ye=()=>ge(ue,Re);Sc(ue,A),Sc(ue,z),kL(),aA(()=>{ue._isLeaving&&(Ou(ue,A),Sc(ue,N),sA(q)||lA(ue,a,G,Ye))}),rh(q,[ue,Ye])},onEnterCancelled(ue){pe(ue,!1),rh(Z,[ue])},onAppearCancelled(ue){pe(ue,!0),rh(le,[ue])},onLeaveCancelled(ue){ge(ue),rh(X,[ue])}})}function p$(e){if(e==null)return null;if(Tr(e))return[lw(e.enter),lw(e.leave)];{const t=lw(e);return[t,t]}}function lw(e){return T6(e)}function Sc(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.add(i)),(e[Mp]||(e[Mp]=new Set)).add(t)}function Ou(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const i=e[Mp];i&&(i.delete(t),i.size||(e[Mp]=void 0))}function aA(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let m$=0;function lA(e,t,i,a){const d=e._endId=++m$,m=()=>{d===e._endId&&a()};if(i!=null)return setTimeout(m,i);const{type:_,timeout:x,propCount:o}=IL(e,t);if(!_)return a();const C=_+"end";let k=0;const A=()=>{e.removeEventListener(C,z),m()},z=N=>{N.target===e&&++k>=o&&A()};setTimeout(()=>{k<o&&A()},x+1),e.addEventListener(C,z)}function IL(e,t){const i=window.getComputedStyle(e),a=$=>(i[$]||"").split(", "),d=a(`${Du}Delay`),m=a(`${Du}Duration`),_=cA(d,m),x=a(`${Wg}Delay`),o=a(`${Wg}Duration`),C=cA(x,o);let k=null,A=0,z=0;t===Du?_>0&&(k=Du,A=_,z=m.length):t===Wg?C>0&&(k=Wg,A=C,z=o.length):(A=Math.max(_,C),k=A>0?_>C?Du:Wg:null,z=k?k===Du?m.length:o.length:0);const N=k===Du&&/\b(transform|all)(,|$)/.test(a(`${Du}Property`).toString());return{type:k,timeout:A,propCount:z,hasTransform:N}}function cA(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((i,a)=>uA(i)+uA(e[a])))}function uA(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function kL(){return document.body.offsetHeight}function g$(e,t,i){const a=e[Mp];a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}const J0=Symbol("_vod"),AL=Symbol("_vsh"),no={beforeMount(e,{value:t},{transition:i}){e[J0]=e.style.display==="none"?"":e.style.display,i&&t?i.beforeEnter(e):qg(e,t)},mounted(e,{value:t},{transition:i}){i&&t&&i.enter(e)},updated(e,{value:t,oldValue:i},{transition:a}){!t!=!i&&(a?t?(a.beforeEnter(e),qg(e,!0),a.enter(e)):a.leave(e,()=>{qg(e,!1)}):qg(e,t))},beforeUnmount(e,{value:t}){qg(e,t)}};function qg(e,t){e.style.display=t?e[J0]:"none",e[AL]=!t}const v$=Symbol(""),_$=/(^|;)\s*display\s*:/;function y$(e,t,i){const a=e.style,d=zn(i);let m=!1;if(i&&!d){if(t)if(zn(t))for(const _ of t.split(";")){const x=_.slice(0,_.indexOf(":")).trim();i[x]==null&&M0(a,x,"")}else for(const _ in t)i[_]==null&&M0(a,_,"");for(const _ in i)_==="display"&&(m=!0),M0(a,_,i[_])}else if(d){if(t!==i){const _=a[v$];_&&(i+=";"+_),a.cssText=i,m=_$.test(i)}}else t&&e.removeAttribute("style");J0 in e&&(e[J0]=m?a.display:"",e[AL]&&(a.display="none"))}const dA=/\s*!important$/;function M0(e,t,i){if(on(i))i.forEach(a=>M0(e,t,a));else if(i==null&&(i=""),t.startsWith("--"))e.setProperty(t,i);else{const a=b$(e,t);dA.test(i)?e.setProperty(Dc(a),i.replace(dA,""),"important"):e[a]=i}}const hA=["Webkit","Moz","ms"],cw={};function b$(e,t){const i=cw[t];if(i)return i;let a=Xs(t);if(a!=="filter"&&a in e)return cw[t]=a;a=Kv(a);for(let d=0;d<hA.length;d++){const m=hA[d]+a;if(m in e)return cw[t]=m}return t}const fA="http://www.w3.org/1999/xlink";function pA(e,t,i,a,d,m=A6(t)){a&&t.startsWith("xlink:")?i==null?e.removeAttributeNS(fA,t.slice(6,t.length)):e.setAttributeNS(fA,t,i):i==null||m&&!pD(i)?e.removeAttribute(t):e.setAttribute(t,m?"":ml(i)?String(i):i)}function mA(e,t,i,a,d){if(t==="innerHTML"||t==="textContent"){i!=null&&(e[t]=t==="innerHTML"?TL(i):i);return}const m=e.tagName;if(t==="value"&&m!=="PROGRESS"&&!m.includes("-")){const x=m==="OPTION"?e.getAttribute("value")||"":e.value,o=i==null?e.type==="checkbox"?"on":"":String(i);(x!==o||!("_value"in e))&&(e.value=o),i==null&&e.removeAttribute(t),e._value=i;return}let _=!1;if(i===""||i==null){const x=typeof e[t];x==="boolean"?i=pD(i):i==null&&x==="string"?(i="",_=!0):x==="number"&&(i=0,_=!0)}try{e[t]=i}catch{}_&&e.removeAttribute(d||t)}function Ic(e,t,i,a){e.addEventListener(t,i,a)}function x$(e,t,i,a){e.removeEventListener(t,i,a)}const gA=Symbol("_vei");function w$(e,t,i,a,d=null){const m=e[gA]||(e[gA]={}),_=m[t];if(a&&_)_.value=a;else{const[x,o]=S$(t);if(a){const C=m[t]=E$(a,d);Ic(e,x,C,o)}else _&&(x$(e,x,_,o),m[t]=void 0)}}const vA=/(?:Once|Passive|Capture)$/;function S$(e){let t;if(vA.test(e)){t={};let a;for(;a=e.match(vA);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Dc(e.slice(2)),t]}let uw=0;const T$=Promise.resolve(),C$=()=>uw||(T$.then(()=>uw=0),uw=Date.now());function E$(e,t){const i=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=i.attached)return;gl(M$(a,i.value),t,5,[a])};return i.value=e,i.attached=C$(),i}function M$(e,t){if(on(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map(a=>d=>!d._stopped&&a&&a(d))}else return t}const _A=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,I$=(e,t,i,a,d,m)=>{const _=d==="svg";t==="class"?g$(e,a,_):t==="style"?y$(e,i,a):Sb(t)?fT(t)||w$(e,t,i,a,m):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):k$(e,t,a,_))?(mA(e,t,a),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&pA(e,t,a,_,m,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!zn(a))?mA(e,Xs(t),a,m,t):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),pA(e,t,a,_))};function k$(e,t,i,a){if(a)return!!(t==="innerHTML"||t==="textContent"||t in e&&_A(t)&&Fn(i));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const d=e.tagName;if(d==="IMG"||d==="VIDEO"||d==="CANVAS"||d==="SOURCE")return!1}return _A(t)&&zn(i)?!1:t in e}const PL=new WeakMap,RL=new WeakMap,Q0=Symbol("_moveCb"),yA=Symbol("_enterCb"),A$=e=>(delete e.props.mode,e),P$=A$({name:"TransitionGroup",props:Ti({},EL,{tag:String,moveClass:String}),setup(e,{slots:t}){const i=Cr(),a=WD();let d,m;return Jl(()=>{if(!d.length)return;const _=e.moveClass||`${e.name||"v"}-move`;if(!O$(d[0].el,i.vnode.el,_))return;d.forEach(R$),d.forEach(D$);const x=d.filter(L$);kL(),x.forEach(o=>{const C=o.el,k=C.style;Sc(C,_),k.transform=k.webkitTransform=k.transitionDuration="";const A=C[Q0]=z=>{z&&z.target!==C||(!z||/transform$/.test(z.propertyName))&&(C.removeEventListener("transitionend",A),C[Q0]=null,Ou(C,_))};C.addEventListener("transitionend",A)})}),()=>{const _=Eo(e),x=ML(_);let o=_.tag||Bn;if(d=[],m)for(let C=0;C<m.length;C++){const k=m[C];k.el&&k.el instanceof Element&&(d.push(k),Sh(k,wv(k,x,a,i)),PL.set(k,k.el.getBoundingClientRect()))}m=t.default?TT(t.default()):[];for(let C=0;C<m.length;C++){const k=m[C];k.key!=null&&Sh(k,wv(k,x,a,i))}return qe(o,null,m)}}}),DL=P$;function R$(e){const t=e.el;t[Q0]&&t[Q0](),t[yA]&&t[yA]()}function D$(e){RL.set(e,e.el.getBoundingClientRect())}function L$(e){const t=PL.get(e),i=RL.get(e),a=t.left-i.left,d=t.top-i.top;if(a||d){const m=e.el.style;return m.transform=m.webkitTransform=`translate(${a}px,${d}px)`,m.transitionDuration="0s",e}}function O$(e,t,i){const a=e.cloneNode(),d=e[Mp];d&&d.forEach(x=>{x.split(/\s+/).forEach(o=>o&&a.classList.remove(o))}),i.split(/\s+/).forEach(x=>x&&a.classList.add(x)),a.style.display="none";const m=t.nodeType===1?t:t.parentNode;m.appendChild(a);const{hasTransform:_}=IL(a);return m.removeChild(a),_}const Ju=e=>{const t=e.props["onUpdate:modelValue"]||!1;return on(t)?i=>T0(t,i):t};function z$(e){e.target.composing=!0}function bA(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Fa=Symbol("_assign"),DT={created(e,{modifiers:{lazy:t,trim:i,number:a}},d){e[Fa]=Ju(d);const m=a||d.props&&d.props.type==="number";Ic(e,t?"change":"input",_=>{if(_.target.composing)return;let x=e.value;i&&(x=x.trim()),m&&(x=G0(x)),e[Fa](x)}),i&&Ic(e,"change",()=>{e.value=e.value.trim()}),t||(Ic(e,"compositionstart",z$),Ic(e,"compositionend",bA),Ic(e,"change",bA))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:i,modifiers:{lazy:a,trim:d,number:m}},_){if(e[Fa]=Ju(_),e.composing)return;const x=(m||e.type==="number")&&!/^0\d/.test(e.value)?G0(e.value):e.value,o=t??"";x!==o&&(document.activeElement===e&&e.type!=="range"&&(a&&t===i||d&&e.value.trim()===o)||(e.value=o))}},eb={deep:!0,created(e,t,i){e[Fa]=Ju(i),Ic(e,"change",()=>{const a=e._modelValue,d=Ip(e),m=e.checked,_=e[Fa];if(on(a)){const x=gT(a,d),o=x!==-1;if(m&&!o)_(a.concat(d));else if(!m&&o){const C=[...a];C.splice(x,1),_(C)}}else if(Gp(a)){const x=new Set(a);m?x.add(d):x.delete(d),_(x)}else _(OL(e,m))})},mounted:xA,beforeUpdate(e,t,i){e[Fa]=Ju(i),xA(e,t,i)}};function xA(e,{value:t,oldValue:i},a){e._modelValue=t;let d;if(on(t))d=gT(t,a.props.value)>-1;else if(Gp(t))d=t.has(a.props.value);else{if(t===i)return;d=xh(t,OL(e,!0))}e.checked!==d&&(e.checked=d)}const LL={created(e,{value:t},i){e.checked=xh(t,i.props.value),e[Fa]=Ju(i),Ic(e,"change",()=>{e[Fa](Ip(e))})},beforeUpdate(e,{value:t,oldValue:i},a){e[Fa]=Ju(a),t!==i&&(e.checked=xh(t,a.props.value))}},B$={deep:!0,created(e,{value:t,modifiers:{number:i}},a){const d=Gp(t);Ic(e,"change",()=>{const m=Array.prototype.filter.call(e.options,_=>_.selected).map(_=>i?G0(Ip(_)):Ip(_));e[Fa](e.multiple?d?new Set(m):m:m[0]),e._assigning=!0,Vn(()=>{e._assigning=!1})}),e[Fa]=Ju(a)},mounted(e,{value:t}){wA(e,t)},beforeUpdate(e,t,i){e[Fa]=Ju(i)},updated(e,{value:t}){e._assigning||wA(e,t)}};function wA(e,t){const i=e.multiple,a=on(t);if(!(i&&!a&&!Gp(t))){for(let d=0,m=e.options.length;d<m;d++){const _=e.options[d],x=Ip(_);if(i)if(a){const o=typeof x;o==="string"||o==="number"?_.selected=t.some(C=>String(C)===String(x)):_.selected=gT(t,x)>-1}else _.selected=t.has(x);else if(xh(Ip(_),t)){e.selectedIndex!==d&&(e.selectedIndex=d);return}}!i&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Ip(e){return"_value"in e?e._value:e.value}function OL(e,t){const i=t?"_trueValue":"_falseValue";return i in e?e[i]:t}const F$=["ctrl","shift","alt","meta"],N$={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>F$.some(i=>e[`${i}Key`]&&!t.includes(i))},Yn=(e,t)=>{const i=e._withMods||(e._withMods={}),a=t.join(".");return i[a]||(i[a]=(d,...m)=>{for(let _=0;_<t.length;_++){const x=N$[t[_]];if(x&&x(d,t))return}return e(d,...m)})},$$={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Mo=(e,t)=>{const i=e._withKeys||(e._withKeys={}),a=t.join(".");return i[a]||(i[a]=d=>{if(!("key"in d))return;const m=Dc(d.key);if(t.some(_=>_===m||$$[_]===m))return e(d)})},V$=Ti({patchProp:I$},h$);let SA;function zL(){return SA||(SA=F5(V$))}const Qu=(...e)=>{zL().render(...e)},BL=(...e)=>{const t=zL().createApp(...e),{mount:i}=t;return t.mount=a=>{const d=j$(a);if(!d)return;const m=t._component;!Fn(m)&&!m.render&&!m.template&&(m.template=d.innerHTML),d.nodeType===1&&(d.textContent="");const _=i(d,!1,U$(d));return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),_},t};function U$(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function j$(e){return zn(e)?document.querySelector(e):e}var Ql=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ec(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var FL={exports:{}};(function(e,t){var i={};(function(a,d){e.exports=d()})(Ql,function(){var a,d,m;function _(o,C){if(!a)a=C;else if(!d)d=C;else{var k="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+d+")(sharedChunk); self.onerror = null;",A={};a(A),m=C(A),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(m.workerUrl=window.URL.createObjectURL(new Blob([k],{type:"text/javascript"})))}}_(["exports"],function(o){function C(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var k,A={},z={};function N(){if(k)return z;k=1,Object.defineProperty(z,"__esModule",{value:!0}),z.setMatrixArrayType=function(g){z.ARRAY_TYPE=n=g},z.toRadian=function(g){return g*u},z.equals=function(g,h){return Math.abs(g-h)<=c*Math.max(1,Math.abs(g),Math.abs(h))},z.RANDOM=z.ARRAY_TYPE=z.EPSILON=void 0;var c=1e-6;z.EPSILON=c;var n=typeof Float32Array<"u"?Float32Array:Array;z.ARRAY_TYPE=n;var s=Math.random;z.RANDOM=s;var u=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var g=0,h=arguments.length;h--;)g+=arguments[h]*arguments[h];return Math.sqrt(g)}),z}var $,F={};function G(){if($)return F;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}$=1,Object.defineProperty(F,"__esModule",{value:!0}),F.create=function(){var h=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h},F.clone=function(h){var v=new n.ARRAY_TYPE(4);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v},F.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h},F.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h},F.fromValues=function(h,v,T,P){var L=new n.ARRAY_TYPE(4);return L[0]=h,L[1]=v,L[2]=T,L[3]=P,L},F.set=function(h,v,T,P,L){return h[0]=v,h[1]=T,h[2]=P,h[3]=L,h},F.transpose=function(h,v){if(h===v){var T=v[1];h[1]=v[2],h[2]=T}else h[0]=v[0],h[1]=v[2],h[2]=v[1],h[3]=v[3];return h},F.invert=function(h,v){var T=v[0],P=v[1],L=v[2],w=v[3],M=T*w-L*P;return M?(h[0]=w*(M=1/M),h[1]=-P*M,h[2]=-L*M,h[3]=T*M,h):null},F.adjoint=function(h,v){var T=v[0];return h[0]=v[3],h[1]=-v[1],h[2]=-v[2],h[3]=T,h},F.determinant=function(h){return h[0]*h[3]-h[2]*h[1]},F.multiply=u,F.rotate=function(h,v,T){var P=v[0],L=v[1],w=v[2],M=v[3],D=Math.sin(T),I=Math.cos(T);return h[0]=P*I+w*D,h[1]=L*I+M*D,h[2]=P*-D+w*I,h[3]=L*-D+M*I,h},F.scale=function(h,v,T){var P=v[1],L=v[2],w=v[3],M=T[0],D=T[1];return h[0]=v[0]*M,h[1]=P*M,h[2]=L*D,h[3]=w*D,h},F.fromRotation=function(h,v){var T=Math.sin(v),P=Math.cos(v);return h[0]=P,h[1]=T,h[2]=-T,h[3]=P,h},F.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=v[1],h},F.str=function(h){return"mat2("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"},F.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3])},F.LDU=function(h,v,T,P){return h[2]=P[2]/P[0],T[0]=P[0],T[1]=P[1],T[3]=P[3]-h[2]*T[1],[h,v,T]},F.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h},F.subtract=g,F.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]},F.equals=function(h,v){var T=h[0],P=h[1],L=h[2],w=h[3],M=v[0],D=v[1],I=v[2],R=v[3];return Math.abs(T-M)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(M))&&Math.abs(P-D)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(D))&&Math.abs(L-I)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(I))&&Math.abs(w-R)<=n.EPSILON*Math.max(1,Math.abs(w),Math.abs(R))},F.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h},F.multiplyScalarAndAdd=function(h,v,T,P){return h[0]=v[0]+T[0]*P,h[1]=v[1]+T[1]*P,h[2]=v[2]+T[2]*P,h[3]=v[3]+T[3]*P,h},F.sub=F.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=s(void 0);if(T&&T.has(h))return T.get(h);var P={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in h)if(w!=="default"&&Object.prototype.hasOwnProperty.call(h,w)){var M=L?Object.getOwnPropertyDescriptor(h,w):null;M&&(M.get||M.set)?Object.defineProperty(P,w,M):P[w]=h[w]}return P.default=h,T&&T.set(h,P),P}(N());function s(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(s=function(P){return P?T:v})(h)}function u(h,v,T){var P=v[0],L=v[1],w=v[2],M=v[3],D=T[0],I=T[1],R=T[2],B=T[3];return h[0]=P*D+w*I,h[1]=L*D+M*I,h[2]=P*R+w*B,h[3]=L*R+M*B,h}function g(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h}return F.mul=u,F.sub=g,F}var U,te={};function Z(){if(U)return te;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}U=1,Object.defineProperty(te,"__esModule",{value:!0}),te.create=function(){var h=new n.ARRAY_TYPE(6);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[4]=0,h[5]=0),h[0]=1,h[3]=1,h},te.clone=function(h){var v=new n.ARRAY_TYPE(6);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v[4]=h[4],v[5]=h[5],v},te.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h[4]=v[4],h[5]=v[5],h},te.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=0,h[5]=0,h},te.fromValues=function(h,v,T,P,L,w){var M=new n.ARRAY_TYPE(6);return M[0]=h,M[1]=v,M[2]=T,M[3]=P,M[4]=L,M[5]=w,M},te.set=function(h,v,T,P,L,w,M){return h[0]=v,h[1]=T,h[2]=P,h[3]=L,h[4]=w,h[5]=M,h},te.invert=function(h,v){var T=v[0],P=v[1],L=v[2],w=v[3],M=v[4],D=v[5],I=T*w-P*L;return I?(h[0]=w*(I=1/I),h[1]=-P*I,h[2]=-L*I,h[3]=T*I,h[4]=(L*D-w*M)*I,h[5]=(P*M-T*D)*I,h):null},te.determinant=function(h){return h[0]*h[3]-h[1]*h[2]},te.multiply=u,te.rotate=function(h,v,T){var P=v[0],L=v[1],w=v[2],M=v[3],D=v[4],I=v[5],R=Math.sin(T),B=Math.cos(T);return h[0]=P*B+w*R,h[1]=L*B+M*R,h[2]=P*-R+w*B,h[3]=L*-R+M*B,h[4]=D,h[5]=I,h},te.scale=function(h,v,T){var P=v[1],L=v[2],w=v[3],M=v[4],D=v[5],I=T[0],R=T[1];return h[0]=v[0]*I,h[1]=P*I,h[2]=L*R,h[3]=w*R,h[4]=M,h[5]=D,h},te.translate=function(h,v,T){var P=v[0],L=v[1],w=v[2],M=v[3],D=v[4],I=v[5],R=T[0],B=T[1];return h[0]=P,h[1]=L,h[2]=w,h[3]=M,h[4]=P*R+w*B+D,h[5]=L*R+M*B+I,h},te.fromRotation=function(h,v){var T=Math.sin(v),P=Math.cos(v);return h[0]=P,h[1]=T,h[2]=-T,h[3]=P,h[4]=0,h[5]=0,h},te.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=v[1],h[4]=0,h[5]=0,h},te.fromTranslation=function(h,v){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=v[0],h[5]=v[1],h},te.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"},te.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],1)},te.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h[4]=v[4]+T[4],h[5]=v[5]+T[5],h},te.subtract=g,te.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h[4]=v[4]*T,h[5]=v[5]*T,h},te.multiplyScalarAndAdd=function(h,v,T,P){return h[0]=v[0]+T[0]*P,h[1]=v[1]+T[1]*P,h[2]=v[2]+T[2]*P,h[3]=v[3]+T[3]*P,h[4]=v[4]+T[4]*P,h[5]=v[5]+T[5]*P,h},te.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]&&h[4]===v[4]&&h[5]===v[5]},te.equals=function(h,v){var T=h[0],P=h[1],L=h[2],w=h[3],M=h[4],D=h[5],I=v[0],R=v[1],B=v[2],j=v[3],K=v[4],ne=v[5];return Math.abs(T-I)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(I))&&Math.abs(P-R)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(R))&&Math.abs(L-B)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(B))&&Math.abs(w-j)<=n.EPSILON*Math.max(1,Math.abs(w),Math.abs(j))&&Math.abs(M-K)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(K))&&Math.abs(D-ne)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(ne))},te.sub=te.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=s(void 0);if(T&&T.has(h))return T.get(h);var P={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in h)if(w!=="default"&&Object.prototype.hasOwnProperty.call(h,w)){var M=L?Object.getOwnPropertyDescriptor(h,w):null;M&&(M.get||M.set)?Object.defineProperty(P,w,M):P[w]=h[w]}return P.default=h,T&&T.set(h,P),P}(N());function s(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(s=function(P){return P?T:v})(h)}function u(h,v,T){var P=v[0],L=v[1],w=v[2],M=v[3],D=v[4],I=v[5],R=T[0],B=T[1],j=T[2],K=T[3],ne=T[4],oe=T[5];return h[0]=P*R+w*B,h[1]=L*R+M*B,h[2]=P*j+w*K,h[3]=L*j+M*K,h[4]=P*ne+w*oe+D,h[5]=L*ne+M*oe+I,h}function g(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h[4]=v[4]-T[4],h[5]=v[5]-T[5],h}return te.mul=u,te.sub=g,te}var q,X={};function ie(){if(q)return X;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}q=1,Object.defineProperty(X,"__esModule",{value:!0}),X.create=function(){var h=new n.ARRAY_TYPE(9);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h},X.fromMat4=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[4],h[4]=v[5],h[5]=v[6],h[6]=v[8],h[7]=v[9],h[8]=v[10],h},X.clone=function(h){var v=new n.ARRAY_TYPE(9);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v[4]=h[4],v[5]=h[5],v[6]=h[6],v[7]=h[7],v[8]=h[8],v},X.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h[4]=v[4],h[5]=v[5],h[6]=v[6],h[7]=v[7],h[8]=v[8],h},X.fromValues=function(h,v,T,P,L,w,M,D,I){var R=new n.ARRAY_TYPE(9);return R[0]=h,R[1]=v,R[2]=T,R[3]=P,R[4]=L,R[5]=w,R[6]=M,R[7]=D,R[8]=I,R},X.set=function(h,v,T,P,L,w,M,D,I,R){return h[0]=v,h[1]=T,h[2]=P,h[3]=L,h[4]=w,h[5]=M,h[6]=D,h[7]=I,h[8]=R,h},X.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},X.transpose=function(h,v){if(h===v){var T=v[1],P=v[2],L=v[5];h[1]=v[3],h[2]=v[6],h[3]=T,h[5]=v[7],h[6]=P,h[7]=L}else h[0]=v[0],h[1]=v[3],h[2]=v[6],h[3]=v[1],h[4]=v[4],h[5]=v[7],h[6]=v[2],h[7]=v[5],h[8]=v[8];return h},X.invert=function(h,v){var T=v[0],P=v[1],L=v[2],w=v[3],M=v[4],D=v[5],I=v[6],R=v[7],B=v[8],j=B*M-D*R,K=-B*w+D*I,ne=R*w-M*I,oe=T*j+P*K+L*ne;return oe?(h[0]=j*(oe=1/oe),h[1]=(-B*P+L*R)*oe,h[2]=(D*P-L*M)*oe,h[3]=K*oe,h[4]=(B*T-L*I)*oe,h[5]=(-D*T+L*w)*oe,h[6]=ne*oe,h[7]=(-R*T+P*I)*oe,h[8]=(M*T-P*w)*oe,h):null},X.adjoint=function(h,v){var T=v[0],P=v[1],L=v[2],w=v[3],M=v[4],D=v[5],I=v[6],R=v[7],B=v[8];return h[0]=M*B-D*R,h[1]=L*R-P*B,h[2]=P*D-L*M,h[3]=D*I-w*B,h[4]=T*B-L*I,h[5]=L*w-T*D,h[6]=w*R-M*I,h[7]=P*I-T*R,h[8]=T*M-P*w,h},X.determinant=function(h){var v=h[3],T=h[4],P=h[5],L=h[6],w=h[7],M=h[8];return h[0]*(M*T-P*w)+h[1]*(-M*v+P*L)+h[2]*(w*v-T*L)},X.multiply=u,X.translate=function(h,v,T){var P=v[0],L=v[1],w=v[2],M=v[3],D=v[4],I=v[5],R=v[6],B=v[7],j=v[8],K=T[0],ne=T[1];return h[0]=P,h[1]=L,h[2]=w,h[3]=M,h[4]=D,h[5]=I,h[6]=K*P+ne*M+R,h[7]=K*L+ne*D+B,h[8]=K*w+ne*I+j,h},X.rotate=function(h,v,T){var P=v[0],L=v[1],w=v[2],M=v[3],D=v[4],I=v[5],R=v[6],B=v[7],j=v[8],K=Math.sin(T),ne=Math.cos(T);return h[0]=ne*P+K*M,h[1]=ne*L+K*D,h[2]=ne*w+K*I,h[3]=ne*M-K*P,h[4]=ne*D-K*L,h[5]=ne*I-K*w,h[6]=R,h[7]=B,h[8]=j,h},X.scale=function(h,v,T){var P=T[0],L=T[1];return h[0]=P*v[0],h[1]=P*v[1],h[2]=P*v[2],h[3]=L*v[3],h[4]=L*v[4],h[5]=L*v[5],h[6]=v[6],h[7]=v[7],h[8]=v[8],h},X.fromTranslation=function(h,v){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=v[0],h[7]=v[1],h[8]=1,h},X.fromRotation=function(h,v){var T=Math.sin(v),P=Math.cos(v);return h[0]=P,h[1]=T,h[2]=0,h[3]=-T,h[4]=P,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},X.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=0,h[4]=v[1],h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},X.fromMat2d=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=0,h[3]=v[2],h[4]=v[3],h[5]=0,h[6]=v[4],h[7]=v[5],h[8]=1,h},X.fromQuat=function(h,v){var T=v[0],P=v[1],L=v[2],w=v[3],M=T+T,D=P+P,I=L+L,R=T*M,B=P*M,j=P*D,K=L*M,ne=L*D,oe=L*I,Y=w*M,ae=w*D,me=w*I;return h[0]=1-j-oe,h[3]=B-me,h[6]=K+ae,h[1]=B+me,h[4]=1-R-oe,h[7]=ne-Y,h[2]=K-ae,h[5]=ne+Y,h[8]=1-R-j,h},X.normalFromMat4=function(h,v){var T=v[0],P=v[1],L=v[2],w=v[3],M=v[4],D=v[5],I=v[6],R=v[7],B=v[8],j=v[9],K=v[10],ne=v[11],oe=v[12],Y=v[13],ae=v[14],me=v[15],Ee=T*D-P*M,Oe=T*I-L*M,Be=T*R-w*M,De=P*I-L*D,Xe=P*R-w*D,$e=L*R-w*I,tt=B*Y-j*oe,ft=B*ae-K*oe,vt=B*me-ne*oe,yt=j*ae-K*Y,wt=j*me-ne*Y,Bt=K*me-ne*ae,St=Ee*Bt-Oe*wt+Be*yt+De*vt-Xe*ft+$e*tt;return St?(h[0]=(D*Bt-I*wt+R*yt)*(St=1/St),h[1]=(I*vt-M*Bt-R*ft)*St,h[2]=(M*wt-D*vt+R*tt)*St,h[3]=(L*wt-P*Bt-w*yt)*St,h[4]=(T*Bt-L*vt+w*ft)*St,h[5]=(P*vt-T*wt-w*tt)*St,h[6]=(Y*$e-ae*Xe+me*De)*St,h[7]=(ae*Be-oe*$e-me*Oe)*St,h[8]=(oe*Xe-Y*Be+me*Ee)*St,h):null},X.projection=function(h,v,T){return h[0]=2/v,h[1]=0,h[2]=0,h[3]=0,h[4]=-2/T,h[5]=0,h[6]=-1,h[7]=1,h[8]=1,h},X.str=function(h){return"mat3("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+")"},X.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8])},X.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h[4]=v[4]+T[4],h[5]=v[5]+T[5],h[6]=v[6]+T[6],h[7]=v[7]+T[7],h[8]=v[8]+T[8],h},X.subtract=g,X.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h[4]=v[4]*T,h[5]=v[5]*T,h[6]=v[6]*T,h[7]=v[7]*T,h[8]=v[8]*T,h},X.multiplyScalarAndAdd=function(h,v,T,P){return h[0]=v[0]+T[0]*P,h[1]=v[1]+T[1]*P,h[2]=v[2]+T[2]*P,h[3]=v[3]+T[3]*P,h[4]=v[4]+T[4]*P,h[5]=v[5]+T[5]*P,h[6]=v[6]+T[6]*P,h[7]=v[7]+T[7]*P,h[8]=v[8]+T[8]*P,h},X.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]&&h[4]===v[4]&&h[5]===v[5]&&h[6]===v[6]&&h[7]===v[7]&&h[8]===v[8]},X.equals=function(h,v){var T=h[0],P=h[1],L=h[2],w=h[3],M=h[4],D=h[5],I=h[6],R=h[7],B=h[8],j=v[0],K=v[1],ne=v[2],oe=v[3],Y=v[4],ae=v[5],me=v[6],Ee=v[7],Oe=v[8];return Math.abs(T-j)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(j))&&Math.abs(P-K)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(K))&&Math.abs(L-ne)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(ne))&&Math.abs(w-oe)<=n.EPSILON*Math.max(1,Math.abs(w),Math.abs(oe))&&Math.abs(M-Y)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(Y))&&Math.abs(D-ae)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(ae))&&Math.abs(I-me)<=n.EPSILON*Math.max(1,Math.abs(I),Math.abs(me))&&Math.abs(R-Ee)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(Ee))&&Math.abs(B-Oe)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(Oe))},X.sub=X.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=s(void 0);if(T&&T.has(h))return T.get(h);var P={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in h)if(w!=="default"&&Object.prototype.hasOwnProperty.call(h,w)){var M=L?Object.getOwnPropertyDescriptor(h,w):null;M&&(M.get||M.set)?Object.defineProperty(P,w,M):P[w]=h[w]}return P.default=h,T&&T.set(h,P),P}(N());function s(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(s=function(P){return P?T:v})(h)}function u(h,v,T){var P=v[0],L=v[1],w=v[2],M=v[3],D=v[4],I=v[5],R=v[6],B=v[7],j=v[8],K=T[0],ne=T[1],oe=T[2],Y=T[3],ae=T[4],me=T[5],Ee=T[6],Oe=T[7],Be=T[8];return h[0]=K*P+ne*M+oe*R,h[1]=K*L+ne*D+oe*B,h[2]=K*w+ne*I+oe*j,h[3]=Y*P+ae*M+me*R,h[4]=Y*L+ae*D+me*B,h[5]=Y*w+ae*I+me*j,h[6]=Ee*P+Oe*M+Be*R,h[7]=Ee*L+Oe*D+Be*B,h[8]=Ee*w+Oe*I+Be*j,h}function g(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h[4]=v[4]-T[4],h[5]=v[5]-T[5],h[6]=v[6]-T[6],h[7]=v[7]-T[7],h[8]=v[8]-T[8],h}return X.mul=u,X.sub=g,X}var de,le={};function pe(){if(de)return le;function c(w){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},c(w)}de=1,Object.defineProperty(le,"__esModule",{value:!0}),le.create=function(){var w=new n.ARRAY_TYPE(16);return n.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w},le.clone=function(w){var M=new n.ARRAY_TYPE(16);return M[0]=w[0],M[1]=w[1],M[2]=w[2],M[3]=w[3],M[4]=w[4],M[5]=w[5],M[6]=w[6],M[7]=w[7],M[8]=w[8],M[9]=w[9],M[10]=w[10],M[11]=w[11],M[12]=w[12],M[13]=w[13],M[14]=w[14],M[15]=w[15],M},le.copy=function(w,M){return w[0]=M[0],w[1]=M[1],w[2]=M[2],w[3]=M[3],w[4]=M[4],w[5]=M[5],w[6]=M[6],w[7]=M[7],w[8]=M[8],w[9]=M[9],w[10]=M[10],w[11]=M[11],w[12]=M[12],w[13]=M[13],w[14]=M[14],w[15]=M[15],w},le.fromValues=function(w,M,D,I,R,B,j,K,ne,oe,Y,ae,me,Ee,Oe,Be){var De=new n.ARRAY_TYPE(16);return De[0]=w,De[1]=M,De[2]=D,De[3]=I,De[4]=R,De[5]=B,De[6]=j,De[7]=K,De[8]=ne,De[9]=oe,De[10]=Y,De[11]=ae,De[12]=me,De[13]=Ee,De[14]=Oe,De[15]=Be,De},le.set=function(w,M,D,I,R,B,j,K,ne,oe,Y,ae,me,Ee,Oe,Be,De){return w[0]=M,w[1]=D,w[2]=I,w[3]=R,w[4]=B,w[5]=j,w[6]=K,w[7]=ne,w[8]=oe,w[9]=Y,w[10]=ae,w[11]=me,w[12]=Ee,w[13]=Oe,w[14]=Be,w[15]=De,w},le.identity=u,le.transpose=function(w,M){if(w===M){var D=M[1],I=M[2],R=M[3],B=M[6],j=M[7],K=M[11];w[1]=M[4],w[2]=M[8],w[3]=M[12],w[4]=D,w[6]=M[9],w[7]=M[13],w[8]=I,w[9]=B,w[11]=M[14],w[12]=R,w[13]=j,w[14]=K}else w[0]=M[0],w[1]=M[4],w[2]=M[8],w[3]=M[12],w[4]=M[1],w[5]=M[5],w[6]=M[9],w[7]=M[13],w[8]=M[2],w[9]=M[6],w[10]=M[10],w[11]=M[14],w[12]=M[3],w[13]=M[7],w[14]=M[11],w[15]=M[15];return w},le.invert=function(w,M){var D=M[0],I=M[1],R=M[2],B=M[3],j=M[4],K=M[5],ne=M[6],oe=M[7],Y=M[8],ae=M[9],me=M[10],Ee=M[11],Oe=M[12],Be=M[13],De=M[14],Xe=M[15],$e=D*K-I*j,tt=D*ne-R*j,ft=D*oe-B*j,vt=I*ne-R*K,yt=I*oe-B*K,wt=R*oe-B*ne,Bt=Y*Be-ae*Oe,St=Y*De-me*Oe,Xt=Y*Xe-Ee*Oe,un=ae*De-me*Be,Gt=ae*Xe-Ee*Be,On=me*Xe-Ee*De,In=$e*On-tt*Gt+ft*un+vt*Xt-yt*St+wt*Bt;return In?(w[0]=(K*On-ne*Gt+oe*un)*(In=1/In),w[1]=(R*Gt-I*On-B*un)*In,w[2]=(Be*wt-De*yt+Xe*vt)*In,w[3]=(me*yt-ae*wt-Ee*vt)*In,w[4]=(ne*Xt-j*On-oe*St)*In,w[5]=(D*On-R*Xt+B*St)*In,w[6]=(De*ft-Oe*wt-Xe*tt)*In,w[7]=(Y*wt-me*ft+Ee*tt)*In,w[8]=(j*Gt-K*Xt+oe*Bt)*In,w[9]=(I*Xt-D*Gt-B*Bt)*In,w[10]=(Oe*yt-Be*ft+Xe*$e)*In,w[11]=(ae*ft-Y*yt-Ee*$e)*In,w[12]=(K*St-j*un-ne*Bt)*In,w[13]=(D*un-I*St+R*Bt)*In,w[14]=(Be*tt-Oe*vt-De*$e)*In,w[15]=(Y*vt-ae*tt+me*$e)*In,w):null},le.adjoint=function(w,M){var D=M[0],I=M[1],R=M[2],B=M[3],j=M[4],K=M[5],ne=M[6],oe=M[7],Y=M[8],ae=M[9],me=M[10],Ee=M[11],Oe=M[12],Be=M[13],De=M[14],Xe=M[15];return w[0]=K*(me*Xe-Ee*De)-ae*(ne*Xe-oe*De)+Be*(ne*Ee-oe*me),w[1]=-(I*(me*Xe-Ee*De)-ae*(R*Xe-B*De)+Be*(R*Ee-B*me)),w[2]=I*(ne*Xe-oe*De)-K*(R*Xe-B*De)+Be*(R*oe-B*ne),w[3]=-(I*(ne*Ee-oe*me)-K*(R*Ee-B*me)+ae*(R*oe-B*ne)),w[4]=-(j*(me*Xe-Ee*De)-Y*(ne*Xe-oe*De)+Oe*(ne*Ee-oe*me)),w[5]=D*(me*Xe-Ee*De)-Y*(R*Xe-B*De)+Oe*(R*Ee-B*me),w[6]=-(D*(ne*Xe-oe*De)-j*(R*Xe-B*De)+Oe*(R*oe-B*ne)),w[7]=D*(ne*Ee-oe*me)-j*(R*Ee-B*me)+Y*(R*oe-B*ne),w[8]=j*(ae*Xe-Ee*Be)-Y*(K*Xe-oe*Be)+Oe*(K*Ee-oe*ae),w[9]=-(D*(ae*Xe-Ee*Be)-Y*(I*Xe-B*Be)+Oe*(I*Ee-B*ae)),w[10]=D*(K*Xe-oe*Be)-j*(I*Xe-B*Be)+Oe*(I*oe-B*K),w[11]=-(D*(K*Ee-oe*ae)-j*(I*Ee-B*ae)+Y*(I*oe-B*K)),w[12]=-(j*(ae*De-me*Be)-Y*(K*De-ne*Be)+Oe*(K*me-ne*ae)),w[13]=D*(ae*De-me*Be)-Y*(I*De-R*Be)+Oe*(I*me-R*ae),w[14]=-(D*(K*De-ne*Be)-j*(I*De-R*Be)+Oe*(I*ne-R*K)),w[15]=D*(K*me-ne*ae)-j*(I*me-R*ae)+Y*(I*ne-R*K),w},le.determinant=function(w){var M=w[0],D=w[1],I=w[2],R=w[3],B=w[4],j=w[5],K=w[6],ne=w[7],oe=w[8],Y=w[9],ae=w[10],me=w[11],Ee=w[12],Oe=w[13],Be=w[14],De=w[15];return(M*j-D*B)*(ae*De-me*Be)-(M*K-I*B)*(Y*De-me*Oe)+(M*ne-R*B)*(Y*Be-ae*Oe)+(D*K-I*j)*(oe*De-me*Ee)-(D*ne-R*j)*(oe*Be-ae*Ee)+(I*ne-R*K)*(oe*Oe-Y*Ee)},le.multiply=g,le.translate=function(w,M,D){var I,R,B,j,K,ne,oe,Y,ae,me,Ee,Oe,Be=D[0],De=D[1],Xe=D[2];return M===w?(w[12]=M[0]*Be+M[4]*De+M[8]*Xe+M[12],w[13]=M[1]*Be+M[5]*De+M[9]*Xe+M[13],w[14]=M[2]*Be+M[6]*De+M[10]*Xe+M[14],w[15]=M[3]*Be+M[7]*De+M[11]*Xe+M[15]):(R=M[1],B=M[2],j=M[3],K=M[4],ne=M[5],oe=M[6],Y=M[7],ae=M[8],me=M[9],Ee=M[10],Oe=M[11],w[0]=I=M[0],w[1]=R,w[2]=B,w[3]=j,w[4]=K,w[5]=ne,w[6]=oe,w[7]=Y,w[8]=ae,w[9]=me,w[10]=Ee,w[11]=Oe,w[12]=I*Be+K*De+ae*Xe+M[12],w[13]=R*Be+ne*De+me*Xe+M[13],w[14]=B*Be+oe*De+Ee*Xe+M[14],w[15]=j*Be+Y*De+Oe*Xe+M[15]),w},le.scale=function(w,M,D){var I=D[0],R=D[1],B=D[2];return w[0]=M[0]*I,w[1]=M[1]*I,w[2]=M[2]*I,w[3]=M[3]*I,w[4]=M[4]*R,w[5]=M[5]*R,w[6]=M[6]*R,w[7]=M[7]*R,w[8]=M[8]*B,w[9]=M[9]*B,w[10]=M[10]*B,w[11]=M[11]*B,w[12]=M[12],w[13]=M[13],w[14]=M[14],w[15]=M[15],w},le.rotate=function(w,M,D,I){var R,B,j,K,ne,oe,Y,ae,me,Ee,Oe,Be,De,Xe,$e,tt,ft,vt,yt,wt,Bt,St,Xt,un,Gt=I[0],On=I[1],In=I[2],xn=Math.hypot(Gt,On,In);return xn<n.EPSILON?null:(Gt*=xn=1/xn,On*=xn,In*=xn,R=Math.sin(D),B=Math.cos(D),ne=M[1],oe=M[2],Y=M[3],me=M[5],Ee=M[6],Oe=M[7],De=M[9],Xe=M[10],$e=M[11],tt=Gt*Gt*(j=1-B)+B,yt=Gt*On*j-In*R,wt=On*On*j+B,Bt=In*On*j+Gt*R,St=Gt*In*j+On*R,Xt=On*In*j-Gt*R,un=In*In*j+B,w[0]=(K=M[0])*tt+(ae=M[4])*(ft=On*Gt*j+In*R)+(Be=M[8])*(vt=In*Gt*j-On*R),w[1]=ne*tt+me*ft+De*vt,w[2]=oe*tt+Ee*ft+Xe*vt,w[3]=Y*tt+Oe*ft+$e*vt,w[4]=K*yt+ae*wt+Be*Bt,w[5]=ne*yt+me*wt+De*Bt,w[6]=oe*yt+Ee*wt+Xe*Bt,w[7]=Y*yt+Oe*wt+$e*Bt,w[8]=K*St+ae*Xt+Be*un,w[9]=ne*St+me*Xt+De*un,w[10]=oe*St+Ee*Xt+Xe*un,w[11]=Y*St+Oe*Xt+$e*un,M!==w&&(w[12]=M[12],w[13]=M[13],w[14]=M[14],w[15]=M[15]),w)},le.rotateX=function(w,M,D){var I=Math.sin(D),R=Math.cos(D),B=M[4],j=M[5],K=M[6],ne=M[7],oe=M[8],Y=M[9],ae=M[10],me=M[11];return M!==w&&(w[0]=M[0],w[1]=M[1],w[2]=M[2],w[3]=M[3],w[12]=M[12],w[13]=M[13],w[14]=M[14],w[15]=M[15]),w[4]=B*R+oe*I,w[5]=j*R+Y*I,w[6]=K*R+ae*I,w[7]=ne*R+me*I,w[8]=oe*R-B*I,w[9]=Y*R-j*I,w[10]=ae*R-K*I,w[11]=me*R-ne*I,w},le.rotateY=function(w,M,D){var I=Math.sin(D),R=Math.cos(D),B=M[0],j=M[1],K=M[2],ne=M[3],oe=M[8],Y=M[9],ae=M[10],me=M[11];return M!==w&&(w[4]=M[4],w[5]=M[5],w[6]=M[6],w[7]=M[7],w[12]=M[12],w[13]=M[13],w[14]=M[14],w[15]=M[15]),w[0]=B*R-oe*I,w[1]=j*R-Y*I,w[2]=K*R-ae*I,w[3]=ne*R-me*I,w[8]=B*I+oe*R,w[9]=j*I+Y*R,w[10]=K*I+ae*R,w[11]=ne*I+me*R,w},le.rotateZ=function(w,M,D){var I=Math.sin(D),R=Math.cos(D),B=M[0],j=M[1],K=M[2],ne=M[3],oe=M[4],Y=M[5],ae=M[6],me=M[7];return M!==w&&(w[8]=M[8],w[9]=M[9],w[10]=M[10],w[11]=M[11],w[12]=M[12],w[13]=M[13],w[14]=M[14],w[15]=M[15]),w[0]=B*R+oe*I,w[1]=j*R+Y*I,w[2]=K*R+ae*I,w[3]=ne*R+me*I,w[4]=oe*R-B*I,w[5]=Y*R-j*I,w[6]=ae*R-K*I,w[7]=me*R-ne*I,w},le.fromTranslation=function(w,M){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=M[0],w[13]=M[1],w[14]=M[2],w[15]=1,w},le.fromScaling=function(w,M){return w[0]=M[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=M[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=M[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},le.fromRotation=function(w,M,D){var I,R,B,j=D[0],K=D[1],ne=D[2],oe=Math.hypot(j,K,ne);return oe<n.EPSILON?null:(j*=oe=1/oe,K*=oe,ne*=oe,I=Math.sin(M),R=Math.cos(M),w[0]=j*j*(B=1-R)+R,w[1]=K*j*B+ne*I,w[2]=ne*j*B-K*I,w[3]=0,w[4]=j*K*B-ne*I,w[5]=K*K*B+R,w[6]=ne*K*B+j*I,w[7]=0,w[8]=j*ne*B+K*I,w[9]=K*ne*B-j*I,w[10]=ne*ne*B+R,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w)},le.fromXRotation=function(w,M){var D=Math.sin(M),I=Math.cos(M);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=I,w[6]=D,w[7]=0,w[8]=0,w[9]=-D,w[10]=I,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},le.fromYRotation=function(w,M){var D=Math.sin(M),I=Math.cos(M);return w[0]=I,w[1]=0,w[2]=-D,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=D,w[9]=0,w[10]=I,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},le.fromZRotation=function(w,M){var D=Math.sin(M),I=Math.cos(M);return w[0]=I,w[1]=D,w[2]=0,w[3]=0,w[4]=-D,w[5]=I,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},le.fromRotationTranslation=h,le.fromQuat2=function(w,M){var D=new n.ARRAY_TYPE(3),I=-M[0],R=-M[1],B=-M[2],j=M[3],K=M[4],ne=M[5],oe=M[6],Y=M[7],ae=I*I+R*R+B*B+j*j;return ae>0?(D[0]=2*(K*j+Y*I+ne*B-oe*R)/ae,D[1]=2*(ne*j+Y*R+oe*I-K*B)/ae,D[2]=2*(oe*j+Y*B+K*R-ne*I)/ae):(D[0]=2*(K*j+Y*I+ne*B-oe*R),D[1]=2*(ne*j+Y*R+oe*I-K*B),D[2]=2*(oe*j+Y*B+K*R-ne*I)),h(w,M,D),w},le.getTranslation=function(w,M){return w[0]=M[12],w[1]=M[13],w[2]=M[14],w},le.getScaling=v,le.getRotation=function(w,M){var D=new n.ARRAY_TYPE(3);v(D,M);var I=1/D[0],R=1/D[1],B=1/D[2],j=M[0]*I,K=M[1]*R,ne=M[2]*B,oe=M[4]*I,Y=M[5]*R,ae=M[6]*B,me=M[8]*I,Ee=M[9]*R,Oe=M[10]*B,Be=j+Y+Oe,De=0;return Be>0?(De=2*Math.sqrt(Be+1),w[3]=.25*De,w[0]=(ae-Ee)/De,w[1]=(me-ne)/De,w[2]=(K-oe)/De):j>Y&&j>Oe?(De=2*Math.sqrt(1+j-Y-Oe),w[3]=(ae-Ee)/De,w[0]=.25*De,w[1]=(K+oe)/De,w[2]=(me+ne)/De):Y>Oe?(De=2*Math.sqrt(1+Y-j-Oe),w[3]=(me-ne)/De,w[0]=(K+oe)/De,w[1]=.25*De,w[2]=(ae+Ee)/De):(De=2*Math.sqrt(1+Oe-j-Y),w[3]=(K-oe)/De,w[0]=(me+ne)/De,w[1]=(ae+Ee)/De,w[2]=.25*De),w},le.fromRotationTranslationScale=function(w,M,D,I){var R=M[0],B=M[1],j=M[2],K=M[3],ne=R+R,oe=B+B,Y=j+j,ae=R*ne,me=R*oe,Ee=R*Y,Oe=B*oe,Be=B*Y,De=j*Y,Xe=K*ne,$e=K*oe,tt=K*Y,ft=I[0],vt=I[1],yt=I[2];return w[0]=(1-(Oe+De))*ft,w[1]=(me+tt)*ft,w[2]=(Ee-$e)*ft,w[3]=0,w[4]=(me-tt)*vt,w[5]=(1-(ae+De))*vt,w[6]=(Be+Xe)*vt,w[7]=0,w[8]=(Ee+$e)*yt,w[9]=(Be-Xe)*yt,w[10]=(1-(ae+Oe))*yt,w[11]=0,w[12]=D[0],w[13]=D[1],w[14]=D[2],w[15]=1,w},le.fromRotationTranslationScaleOrigin=function(w,M,D,I,R){var B=M[0],j=M[1],K=M[2],ne=M[3],oe=B+B,Y=j+j,ae=K+K,me=B*oe,Ee=B*Y,Oe=B*ae,Be=j*Y,De=j*ae,Xe=K*ae,$e=ne*oe,tt=ne*Y,ft=ne*ae,vt=I[0],yt=I[1],wt=I[2],Bt=R[0],St=R[1],Xt=R[2],un=(1-(Be+Xe))*vt,Gt=(Ee+ft)*vt,On=(Oe-tt)*vt,In=(Ee-ft)*yt,xn=(1-(me+Xe))*yt,mn=(De+$e)*yt,nr=(Oe+tt)*wt,Ln=(De-$e)*wt,Un=(1-(me+Be))*wt;return w[0]=un,w[1]=Gt,w[2]=On,w[3]=0,w[4]=In,w[5]=xn,w[6]=mn,w[7]=0,w[8]=nr,w[9]=Ln,w[10]=Un,w[11]=0,w[12]=D[0]+Bt-(un*Bt+In*St+nr*Xt),w[13]=D[1]+St-(Gt*Bt+xn*St+Ln*Xt),w[14]=D[2]+Xt-(On*Bt+mn*St+Un*Xt),w[15]=1,w},le.fromQuat=function(w,M){var D=M[0],I=M[1],R=M[2],B=M[3],j=D+D,K=I+I,ne=R+R,oe=D*j,Y=I*j,ae=I*K,me=R*j,Ee=R*K,Oe=R*ne,Be=B*j,De=B*K,Xe=B*ne;return w[0]=1-ae-Oe,w[1]=Y+Xe,w[2]=me-De,w[3]=0,w[4]=Y-Xe,w[5]=1-oe-Oe,w[6]=Ee+Be,w[7]=0,w[8]=me+De,w[9]=Ee-Be,w[10]=1-oe-ae,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},le.frustum=function(w,M,D,I,R,B,j){var K=1/(D-M),ne=1/(R-I),oe=1/(B-j);return w[0]=2*B*K,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*B*ne,w[6]=0,w[7]=0,w[8]=(D+M)*K,w[9]=(R+I)*ne,w[10]=(j+B)*oe,w[11]=-1,w[12]=0,w[13]=0,w[14]=j*B*2*oe,w[15]=0,w},le.perspectiveNO=T,le.perspectiveZO=function(w,M,D,I,R){var B,j=1/Math.tan(M/2);return w[0]=j/D,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=j,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,R!=null&&R!==1/0?(w[10]=R*(B=1/(I-R)),w[14]=R*I*B):(w[10]=-1,w[14]=-I),w},le.perspectiveFromFieldOfView=function(w,M,D,I){var R=Math.tan(M.upDegrees*Math.PI/180),B=Math.tan(M.downDegrees*Math.PI/180),j=Math.tan(M.leftDegrees*Math.PI/180),K=Math.tan(M.rightDegrees*Math.PI/180),ne=2/(j+K),oe=2/(R+B);return w[0]=ne,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=oe,w[6]=0,w[7]=0,w[8]=-(j-K)*ne*.5,w[9]=(R-B)*oe*.5,w[10]=I/(D-I),w[11]=-1,w[12]=0,w[13]=0,w[14]=I*D/(D-I),w[15]=0,w},le.orthoNO=P,le.orthoZO=function(w,M,D,I,R,B,j){var K=1/(M-D),ne=1/(I-R),oe=1/(B-j);return w[0]=-2*K,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*ne,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=oe,w[11]=0,w[12]=(M+D)*K,w[13]=(R+I)*ne,w[14]=B*oe,w[15]=1,w},le.lookAt=function(w,M,D,I){var R,B,j,K,ne,oe,Y,ae,me,Ee,Oe=M[0],Be=M[1],De=M[2],Xe=I[0],$e=I[1],tt=I[2],ft=D[0],vt=D[1],yt=D[2];return Math.abs(Oe-ft)<n.EPSILON&&Math.abs(Be-vt)<n.EPSILON&&Math.abs(De-yt)<n.EPSILON?u(w):(Y=Oe-ft,ae=Be-vt,me=De-yt,R=$e*(me*=Ee=1/Math.hypot(Y,ae,me))-tt*(ae*=Ee),B=tt*(Y*=Ee)-Xe*me,j=Xe*ae-$e*Y,(Ee=Math.hypot(R,B,j))?(R*=Ee=1/Ee,B*=Ee,j*=Ee):(R=0,B=0,j=0),K=ae*j-me*B,ne=me*R-Y*j,oe=Y*B-ae*R,(Ee=Math.hypot(K,ne,oe))?(K*=Ee=1/Ee,ne*=Ee,oe*=Ee):(K=0,ne=0,oe=0),w[0]=R,w[1]=K,w[2]=Y,w[3]=0,w[4]=B,w[5]=ne,w[6]=ae,w[7]=0,w[8]=j,w[9]=oe,w[10]=me,w[11]=0,w[12]=-(R*Oe+B*Be+j*De),w[13]=-(K*Oe+ne*Be+oe*De),w[14]=-(Y*Oe+ae*Be+me*De),w[15]=1,w)},le.targetTo=function(w,M,D,I){var R=M[0],B=M[1],j=M[2],K=I[0],ne=I[1],oe=I[2],Y=R-D[0],ae=B-D[1],me=j-D[2],Ee=Y*Y+ae*ae+me*me;Ee>0&&(Y*=Ee=1/Math.sqrt(Ee),ae*=Ee,me*=Ee);var Oe=ne*me-oe*ae,Be=oe*Y-K*me,De=K*ae-ne*Y;return(Ee=Oe*Oe+Be*Be+De*De)>0&&(Oe*=Ee=1/Math.sqrt(Ee),Be*=Ee,De*=Ee),w[0]=Oe,w[1]=Be,w[2]=De,w[3]=0,w[4]=ae*De-me*Be,w[5]=me*Oe-Y*De,w[6]=Y*Be-ae*Oe,w[7]=0,w[8]=Y,w[9]=ae,w[10]=me,w[11]=0,w[12]=R,w[13]=B,w[14]=j,w[15]=1,w},le.str=function(w){return"mat4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+", "+w[8]+", "+w[9]+", "+w[10]+", "+w[11]+", "+w[12]+", "+w[13]+", "+w[14]+", "+w[15]+")"},le.frob=function(w){return Math.hypot(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])},le.add=function(w,M,D){return w[0]=M[0]+D[0],w[1]=M[1]+D[1],w[2]=M[2]+D[2],w[3]=M[3]+D[3],w[4]=M[4]+D[4],w[5]=M[5]+D[5],w[6]=M[6]+D[6],w[7]=M[7]+D[7],w[8]=M[8]+D[8],w[9]=M[9]+D[9],w[10]=M[10]+D[10],w[11]=M[11]+D[11],w[12]=M[12]+D[12],w[13]=M[13]+D[13],w[14]=M[14]+D[14],w[15]=M[15]+D[15],w},le.subtract=L,le.multiplyScalar=function(w,M,D){return w[0]=M[0]*D,w[1]=M[1]*D,w[2]=M[2]*D,w[3]=M[3]*D,w[4]=M[4]*D,w[5]=M[5]*D,w[6]=M[6]*D,w[7]=M[7]*D,w[8]=M[8]*D,w[9]=M[9]*D,w[10]=M[10]*D,w[11]=M[11]*D,w[12]=M[12]*D,w[13]=M[13]*D,w[14]=M[14]*D,w[15]=M[15]*D,w},le.multiplyScalarAndAdd=function(w,M,D,I){return w[0]=M[0]+D[0]*I,w[1]=M[1]+D[1]*I,w[2]=M[2]+D[2]*I,w[3]=M[3]+D[3]*I,w[4]=M[4]+D[4]*I,w[5]=M[5]+D[5]*I,w[6]=M[6]+D[6]*I,w[7]=M[7]+D[7]*I,w[8]=M[8]+D[8]*I,w[9]=M[9]+D[9]*I,w[10]=M[10]+D[10]*I,w[11]=M[11]+D[11]*I,w[12]=M[12]+D[12]*I,w[13]=M[13]+D[13]*I,w[14]=M[14]+D[14]*I,w[15]=M[15]+D[15]*I,w},le.exactEquals=function(w,M){return w[0]===M[0]&&w[1]===M[1]&&w[2]===M[2]&&w[3]===M[3]&&w[4]===M[4]&&w[5]===M[5]&&w[6]===M[6]&&w[7]===M[7]&&w[8]===M[8]&&w[9]===M[9]&&w[10]===M[10]&&w[11]===M[11]&&w[12]===M[12]&&w[13]===M[13]&&w[14]===M[14]&&w[15]===M[15]},le.equals=function(w,M){var D=w[0],I=w[1],R=w[2],B=w[3],j=w[4],K=w[5],ne=w[6],oe=w[7],Y=w[8],ae=w[9],me=w[10],Ee=w[11],Oe=w[12],Be=w[13],De=w[14],Xe=w[15],$e=M[0],tt=M[1],ft=M[2],vt=M[3],yt=M[4],wt=M[5],Bt=M[6],St=M[7],Xt=M[8],un=M[9],Gt=M[10],On=M[11],In=M[12],xn=M[13],mn=M[14],nr=M[15];return Math.abs(D-$e)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs($e))&&Math.abs(I-tt)<=n.EPSILON*Math.max(1,Math.abs(I),Math.abs(tt))&&Math.abs(R-ft)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(ft))&&Math.abs(B-vt)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(vt))&&Math.abs(j-yt)<=n.EPSILON*Math.max(1,Math.abs(j),Math.abs(yt))&&Math.abs(K-wt)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(wt))&&Math.abs(ne-Bt)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Bt))&&Math.abs(oe-St)<=n.EPSILON*Math.max(1,Math.abs(oe),Math.abs(St))&&Math.abs(Y-Xt)<=n.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Xt))&&Math.abs(ae-un)<=n.EPSILON*Math.max(1,Math.abs(ae),Math.abs(un))&&Math.abs(me-Gt)<=n.EPSILON*Math.max(1,Math.abs(me),Math.abs(Gt))&&Math.abs(Ee-On)<=n.EPSILON*Math.max(1,Math.abs(Ee),Math.abs(On))&&Math.abs(Oe-In)<=n.EPSILON*Math.max(1,Math.abs(Oe),Math.abs(In))&&Math.abs(Be-xn)<=n.EPSILON*Math.max(1,Math.abs(Be),Math.abs(xn))&&Math.abs(De-mn)<=n.EPSILON*Math.max(1,Math.abs(De),Math.abs(mn))&&Math.abs(Xe-nr)<=n.EPSILON*Math.max(1,Math.abs(Xe),Math.abs(nr))},le.sub=le.mul=le.ortho=le.perspective=void 0;var n=function(w,M){if(w&&w.__esModule)return w;if(w===null||c(w)!=="object"&&typeof w!="function")return{default:w};var D=s(void 0);if(D&&D.has(w))return D.get(w);var I={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in w)if(B!=="default"&&Object.prototype.hasOwnProperty.call(w,B)){var j=R?Object.getOwnPropertyDescriptor(w,B):null;j&&(j.get||j.set)?Object.defineProperty(I,B,j):I[B]=w[B]}return I.default=w,D&&D.set(w,I),I}(N());function s(w){if(typeof WeakMap!="function")return null;var M=new WeakMap,D=new WeakMap;return(s=function(I){return I?D:M})(w)}function u(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function g(w,M,D){var I=M[0],R=M[1],B=M[2],j=M[3],K=M[4],ne=M[5],oe=M[6],Y=M[7],ae=M[8],me=M[9],Ee=M[10],Oe=M[11],Be=M[12],De=M[13],Xe=M[14],$e=M[15],tt=D[0],ft=D[1],vt=D[2],yt=D[3];return w[0]=tt*I+ft*K+vt*ae+yt*Be,w[1]=tt*R+ft*ne+vt*me+yt*De,w[2]=tt*B+ft*oe+vt*Ee+yt*Xe,w[3]=tt*j+ft*Y+vt*Oe+yt*$e,w[4]=(tt=D[4])*I+(ft=D[5])*K+(vt=D[6])*ae+(yt=D[7])*Be,w[5]=tt*R+ft*ne+vt*me+yt*De,w[6]=tt*B+ft*oe+vt*Ee+yt*Xe,w[7]=tt*j+ft*Y+vt*Oe+yt*$e,w[8]=(tt=D[8])*I+(ft=D[9])*K+(vt=D[10])*ae+(yt=D[11])*Be,w[9]=tt*R+ft*ne+vt*me+yt*De,w[10]=tt*B+ft*oe+vt*Ee+yt*Xe,w[11]=tt*j+ft*Y+vt*Oe+yt*$e,w[12]=(tt=D[12])*I+(ft=D[13])*K+(vt=D[14])*ae+(yt=D[15])*Be,w[13]=tt*R+ft*ne+vt*me+yt*De,w[14]=tt*B+ft*oe+vt*Ee+yt*Xe,w[15]=tt*j+ft*Y+vt*Oe+yt*$e,w}function h(w,M,D){var I=M[0],R=M[1],B=M[2],j=M[3],K=I+I,ne=R+R,oe=B+B,Y=I*K,ae=I*ne,me=I*oe,Ee=R*ne,Oe=R*oe,Be=B*oe,De=j*K,Xe=j*ne,$e=j*oe;return w[0]=1-(Ee+Be),w[1]=ae+$e,w[2]=me-Xe,w[3]=0,w[4]=ae-$e,w[5]=1-(Y+Be),w[6]=Oe+De,w[7]=0,w[8]=me+Xe,w[9]=Oe-De,w[10]=1-(Y+Ee),w[11]=0,w[12]=D[0],w[13]=D[1],w[14]=D[2],w[15]=1,w}function v(w,M){var D=M[4],I=M[5],R=M[6],B=M[8],j=M[9],K=M[10];return w[0]=Math.hypot(M[0],M[1],M[2]),w[1]=Math.hypot(D,I,R),w[2]=Math.hypot(B,j,K),w}function T(w,M,D,I,R){var B,j=1/Math.tan(M/2);return w[0]=j/D,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=j,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,R!=null&&R!==1/0?(w[10]=(R+I)*(B=1/(I-R)),w[14]=2*R*I*B):(w[10]=-1,w[14]=-2*I),w}function P(w,M,D,I,R,B,j){var K=1/(M-D),ne=1/(I-R),oe=1/(B-j);return w[0]=-2*K,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*ne,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*oe,w[11]=0,w[12]=(M+D)*K,w[13]=(R+I)*ne,w[14]=(j+B)*oe,w[15]=1,w}function L(w,M,D){return w[0]=M[0]-D[0],w[1]=M[1]-D[1],w[2]=M[2]-D[2],w[3]=M[3]-D[3],w[4]=M[4]-D[4],w[5]=M[5]-D[5],w[6]=M[6]-D[6],w[7]=M[7]-D[7],w[8]=M[8]-D[8],w[9]=M[9]-D[9],w[10]=M[10]-D[10],w[11]=M[11]-D[11],w[12]=M[12]-D[12],w[13]=M[13]-D[13],w[14]=M[14]-D[14],w[15]=M[15]-D[15],w}return le.perspective=T,le.ortho=P,le.mul=g,le.sub=L,le}var ge,he={},ue={};function Re(){if(ge)return ue;function c(R){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},c(R)}ge=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue.create=u,ue.clone=function(R){var B=new n.ARRAY_TYPE(3);return B[0]=R[0],B[1]=R[1],B[2]=R[2],B},ue.length=g,ue.fromValues=function(R,B,j){var K=new n.ARRAY_TYPE(3);return K[0]=R,K[1]=B,K[2]=j,K},ue.copy=function(R,B){return R[0]=B[0],R[1]=B[1],R[2]=B[2],R},ue.set=function(R,B,j,K){return R[0]=B,R[1]=j,R[2]=K,R},ue.add=function(R,B,j){return R[0]=B[0]+j[0],R[1]=B[1]+j[1],R[2]=B[2]+j[2],R},ue.subtract=h,ue.multiply=v,ue.divide=T,ue.ceil=function(R,B){return R[0]=Math.ceil(B[0]),R[1]=Math.ceil(B[1]),R[2]=Math.ceil(B[2]),R},ue.floor=function(R,B){return R[0]=Math.floor(B[0]),R[1]=Math.floor(B[1]),R[2]=Math.floor(B[2]),R},ue.min=function(R,B,j){return R[0]=Math.min(B[0],j[0]),R[1]=Math.min(B[1],j[1]),R[2]=Math.min(B[2],j[2]),R},ue.max=function(R,B,j){return R[0]=Math.max(B[0],j[0]),R[1]=Math.max(B[1],j[1]),R[2]=Math.max(B[2],j[2]),R},ue.round=function(R,B){return R[0]=Math.round(B[0]),R[1]=Math.round(B[1]),R[2]=Math.round(B[2]),R},ue.scale=function(R,B,j){return R[0]=B[0]*j,R[1]=B[1]*j,R[2]=B[2]*j,R},ue.scaleAndAdd=function(R,B,j,K){return R[0]=B[0]+j[0]*K,R[1]=B[1]+j[1]*K,R[2]=B[2]+j[2]*K,R},ue.distance=P,ue.squaredDistance=L,ue.squaredLength=w,ue.negate=function(R,B){return R[0]=-B[0],R[1]=-B[1],R[2]=-B[2],R},ue.inverse=function(R,B){return R[0]=1/B[0],R[1]=1/B[1],R[2]=1/B[2],R},ue.normalize=function(R,B){var j=B[0],K=B[1],ne=B[2],oe=j*j+K*K+ne*ne;return oe>0&&(oe=1/Math.sqrt(oe)),R[0]=B[0]*oe,R[1]=B[1]*oe,R[2]=B[2]*oe,R},ue.dot=M,ue.cross=function(R,B,j){var K=B[0],ne=B[1],oe=B[2],Y=j[0],ae=j[1],me=j[2];return R[0]=ne*me-oe*ae,R[1]=oe*Y-K*me,R[2]=K*ae-ne*Y,R},ue.lerp=function(R,B,j,K){var ne=B[0],oe=B[1],Y=B[2];return R[0]=ne+K*(j[0]-ne),R[1]=oe+K*(j[1]-oe),R[2]=Y+K*(j[2]-Y),R},ue.hermite=function(R,B,j,K,ne,oe){var Y=oe*oe,ae=Y*(2*oe-3)+1,me=Y*(oe-2)+oe,Ee=Y*(oe-1),Oe=Y*(3-2*oe);return R[0]=B[0]*ae+j[0]*me+K[0]*Ee+ne[0]*Oe,R[1]=B[1]*ae+j[1]*me+K[1]*Ee+ne[1]*Oe,R[2]=B[2]*ae+j[2]*me+K[2]*Ee+ne[2]*Oe,R},ue.bezier=function(R,B,j,K,ne,oe){var Y=1-oe,ae=Y*Y,me=oe*oe,Ee=ae*Y,Oe=3*oe*ae,Be=3*me*Y,De=me*oe;return R[0]=B[0]*Ee+j[0]*Oe+K[0]*Be+ne[0]*De,R[1]=B[1]*Ee+j[1]*Oe+K[1]*Be+ne[1]*De,R[2]=B[2]*Ee+j[2]*Oe+K[2]*Be+ne[2]*De,R},ue.random=function(R,B){B=B||1;var j=2*n.RANDOM()*Math.PI,K=2*n.RANDOM()-1,ne=Math.sqrt(1-K*K)*B;return R[0]=Math.cos(j)*ne,R[1]=Math.sin(j)*ne,R[2]=K*B,R},ue.transformMat4=function(R,B,j){var K=B[0],ne=B[1],oe=B[2],Y=j[3]*K+j[7]*ne+j[11]*oe+j[15];return R[0]=(j[0]*K+j[4]*ne+j[8]*oe+j[12])/(Y=Y||1),R[1]=(j[1]*K+j[5]*ne+j[9]*oe+j[13])/Y,R[2]=(j[2]*K+j[6]*ne+j[10]*oe+j[14])/Y,R},ue.transformMat3=function(R,B,j){var K=B[0],ne=B[1],oe=B[2];return R[0]=K*j[0]+ne*j[3]+oe*j[6],R[1]=K*j[1]+ne*j[4]+oe*j[7],R[2]=K*j[2]+ne*j[5]+oe*j[8],R},ue.transformQuat=function(R,B,j){var K=j[0],ne=j[1],oe=j[2],Y=B[0],ae=B[1],me=B[2],Ee=ne*me-oe*ae,Oe=oe*Y-K*me,Be=K*ae-ne*Y,De=ne*Be-oe*Oe,Xe=oe*Ee-K*Be,$e=K*Oe-ne*Ee,tt=2*j[3];return Oe*=tt,Be*=tt,Xe*=2,$e*=2,R[0]=Y+(Ee*=tt)+(De*=2),R[1]=ae+Oe+Xe,R[2]=me+Be+$e,R},ue.rotateX=function(R,B,j,K){var ne=[],oe=[];return ne[0]=B[0]-j[0],ne[1]=B[1]-j[1],ne[2]=B[2]-j[2],oe[0]=ne[0],oe[1]=ne[1]*Math.cos(K)-ne[2]*Math.sin(K),oe[2]=ne[1]*Math.sin(K)+ne[2]*Math.cos(K),R[0]=oe[0]+j[0],R[1]=oe[1]+j[1],R[2]=oe[2]+j[2],R},ue.rotateY=function(R,B,j,K){var ne=[],oe=[];return ne[0]=B[0]-j[0],ne[1]=B[1]-j[1],ne[2]=B[2]-j[2],oe[0]=ne[2]*Math.sin(K)+ne[0]*Math.cos(K),oe[1]=ne[1],oe[2]=ne[2]*Math.cos(K)-ne[0]*Math.sin(K),R[0]=oe[0]+j[0],R[1]=oe[1]+j[1],R[2]=oe[2]+j[2],R},ue.rotateZ=function(R,B,j,K){var ne=[],oe=[];return ne[0]=B[0]-j[0],ne[1]=B[1]-j[1],ne[2]=B[2]-j[2],oe[0]=ne[0]*Math.cos(K)-ne[1]*Math.sin(K),oe[1]=ne[0]*Math.sin(K)+ne[1]*Math.cos(K),oe[2]=ne[2],R[0]=oe[0]+j[0],R[1]=oe[1]+j[1],R[2]=oe[2]+j[2],R},ue.angle=function(R,B){var j=R[0],K=R[1],ne=R[2],oe=B[0],Y=B[1],ae=B[2],me=Math.sqrt(j*j+K*K+ne*ne)*Math.sqrt(oe*oe+Y*Y+ae*ae),Ee=me&&M(R,B)/me;return Math.acos(Math.min(Math.max(Ee,-1),1))},ue.zero=function(R){return R[0]=0,R[1]=0,R[2]=0,R},ue.str=function(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"},ue.exactEquals=function(R,B){return R[0]===B[0]&&R[1]===B[1]&&R[2]===B[2]},ue.equals=function(R,B){var j=R[0],K=R[1],ne=R[2],oe=B[0],Y=B[1],ae=B[2];return Math.abs(j-oe)<=n.EPSILON*Math.max(1,Math.abs(j),Math.abs(oe))&&Math.abs(K-Y)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(Y))&&Math.abs(ne-ae)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ae))},ue.forEach=ue.sqrLen=ue.len=ue.sqrDist=ue.dist=ue.div=ue.mul=ue.sub=void 0;var n=function(R,B){if(R&&R.__esModule)return R;if(R===null||c(R)!=="object"&&typeof R!="function")return{default:R};var j=s(void 0);if(j&&j.has(R))return j.get(R);var K={},ne=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var oe in R)if(oe!=="default"&&Object.prototype.hasOwnProperty.call(R,oe)){var Y=ne?Object.getOwnPropertyDescriptor(R,oe):null;Y&&(Y.get||Y.set)?Object.defineProperty(K,oe,Y):K[oe]=R[oe]}return K.default=R,j&&j.set(R,K),K}(N());function s(R){if(typeof WeakMap!="function")return null;var B=new WeakMap,j=new WeakMap;return(s=function(K){return K?j:B})(R)}function u(){var R=new n.ARRAY_TYPE(3);return n.ARRAY_TYPE!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function g(R){return Math.hypot(R[0],R[1],R[2])}function h(R,B,j){return R[0]=B[0]-j[0],R[1]=B[1]-j[1],R[2]=B[2]-j[2],R}function v(R,B,j){return R[0]=B[0]*j[0],R[1]=B[1]*j[1],R[2]=B[2]*j[2],R}function T(R,B,j){return R[0]=B[0]/j[0],R[1]=B[1]/j[1],R[2]=B[2]/j[2],R}function P(R,B){return Math.hypot(B[0]-R[0],B[1]-R[1],B[2]-R[2])}function L(R,B){var j=B[0]-R[0],K=B[1]-R[1],ne=B[2]-R[2];return j*j+K*K+ne*ne}function w(R){var B=R[0],j=R[1],K=R[2];return B*B+j*j+K*K}function M(R,B){return R[0]*B[0]+R[1]*B[1]+R[2]*B[2]}ue.sub=h,ue.mul=v,ue.div=T,ue.dist=P,ue.sqrDist=L,ue.len=g,ue.sqrLen=w;var D,I=(D=u(),function(R,B,j,K,ne,oe){var Y,ae;for(B||(B=3),j||(j=0),ae=K?Math.min(K*B+j,R.length):R.length,Y=j;Y<ae;Y+=B)D[0]=R[Y],D[1]=R[Y+1],D[2]=R[Y+2],ne(D,D,oe),R[Y]=D[0],R[Y+1]=D[1],R[Y+2]=D[2];return R});return ue.forEach=I,ue}var Ye,Ie,fe={};function Me(){if(Ye)return fe;function c(I){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(I)}Ye=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.create=u,fe.clone=function(I){var R=new n.ARRAY_TYPE(4);return R[0]=I[0],R[1]=I[1],R[2]=I[2],R[3]=I[3],R},fe.fromValues=function(I,R,B,j){var K=new n.ARRAY_TYPE(4);return K[0]=I,K[1]=R,K[2]=B,K[3]=j,K},fe.copy=function(I,R){return I[0]=R[0],I[1]=R[1],I[2]=R[2],I[3]=R[3],I},fe.set=function(I,R,B,j,K){return I[0]=R,I[1]=B,I[2]=j,I[3]=K,I},fe.add=function(I,R,B){return I[0]=R[0]+B[0],I[1]=R[1]+B[1],I[2]=R[2]+B[2],I[3]=R[3]+B[3],I},fe.subtract=g,fe.multiply=h,fe.divide=v,fe.ceil=function(I,R){return I[0]=Math.ceil(R[0]),I[1]=Math.ceil(R[1]),I[2]=Math.ceil(R[2]),I[3]=Math.ceil(R[3]),I},fe.floor=function(I,R){return I[0]=Math.floor(R[0]),I[1]=Math.floor(R[1]),I[2]=Math.floor(R[2]),I[3]=Math.floor(R[3]),I},fe.min=function(I,R,B){return I[0]=Math.min(R[0],B[0]),I[1]=Math.min(R[1],B[1]),I[2]=Math.min(R[2],B[2]),I[3]=Math.min(R[3],B[3]),I},fe.max=function(I,R,B){return I[0]=Math.max(R[0],B[0]),I[1]=Math.max(R[1],B[1]),I[2]=Math.max(R[2],B[2]),I[3]=Math.max(R[3],B[3]),I},fe.round=function(I,R){return I[0]=Math.round(R[0]),I[1]=Math.round(R[1]),I[2]=Math.round(R[2]),I[3]=Math.round(R[3]),I},fe.scale=function(I,R,B){return I[0]=R[0]*B,I[1]=R[1]*B,I[2]=R[2]*B,I[3]=R[3]*B,I},fe.scaleAndAdd=function(I,R,B,j){return I[0]=R[0]+B[0]*j,I[1]=R[1]+B[1]*j,I[2]=R[2]+B[2]*j,I[3]=R[3]+B[3]*j,I},fe.distance=T,fe.squaredDistance=P,fe.length=L,fe.squaredLength=w,fe.negate=function(I,R){return I[0]=-R[0],I[1]=-R[1],I[2]=-R[2],I[3]=-R[3],I},fe.inverse=function(I,R){return I[0]=1/R[0],I[1]=1/R[1],I[2]=1/R[2],I[3]=1/R[3],I},fe.normalize=function(I,R){var B=R[0],j=R[1],K=R[2],ne=R[3],oe=B*B+j*j+K*K+ne*ne;return oe>0&&(oe=1/Math.sqrt(oe)),I[0]=B*oe,I[1]=j*oe,I[2]=K*oe,I[3]=ne*oe,I},fe.dot=function(I,R){return I[0]*R[0]+I[1]*R[1]+I[2]*R[2]+I[3]*R[3]},fe.cross=function(I,R,B,j){var K=B[0]*j[1]-B[1]*j[0],ne=B[0]*j[2]-B[2]*j[0],oe=B[0]*j[3]-B[3]*j[0],Y=B[1]*j[2]-B[2]*j[1],ae=B[1]*j[3]-B[3]*j[1],me=B[2]*j[3]-B[3]*j[2],Ee=R[0],Oe=R[1],Be=R[2],De=R[3];return I[0]=Oe*me-Be*ae+De*Y,I[1]=-Ee*me+Be*oe-De*ne,I[2]=Ee*ae-Oe*oe+De*K,I[3]=-Ee*Y+Oe*ne-Be*K,I},fe.lerp=function(I,R,B,j){var K=R[0],ne=R[1],oe=R[2],Y=R[3];return I[0]=K+j*(B[0]-K),I[1]=ne+j*(B[1]-ne),I[2]=oe+j*(B[2]-oe),I[3]=Y+j*(B[3]-Y),I},fe.random=function(I,R){var B,j,K,ne,oe,Y;R=R||1;do oe=(B=2*n.RANDOM()-1)*B+(j=2*n.RANDOM()-1)*j;while(oe>=1);do Y=(K=2*n.RANDOM()-1)*K+(ne=2*n.RANDOM()-1)*ne;while(Y>=1);var ae=Math.sqrt((1-oe)/Y);return I[0]=R*B,I[1]=R*j,I[2]=R*K*ae,I[3]=R*ne*ae,I},fe.transformMat4=function(I,R,B){var j=R[0],K=R[1],ne=R[2],oe=R[3];return I[0]=B[0]*j+B[4]*K+B[8]*ne+B[12]*oe,I[1]=B[1]*j+B[5]*K+B[9]*ne+B[13]*oe,I[2]=B[2]*j+B[6]*K+B[10]*ne+B[14]*oe,I[3]=B[3]*j+B[7]*K+B[11]*ne+B[15]*oe,I},fe.transformQuat=function(I,R,B){var j=R[0],K=R[1],ne=R[2],oe=B[0],Y=B[1],ae=B[2],me=B[3],Ee=me*j+Y*ne-ae*K,Oe=me*K+ae*j-oe*ne,Be=me*ne+oe*K-Y*j,De=-oe*j-Y*K-ae*ne;return I[0]=Ee*me+De*-oe+Oe*-ae-Be*-Y,I[1]=Oe*me+De*-Y+Be*-oe-Ee*-ae,I[2]=Be*me+De*-ae+Ee*-Y-Oe*-oe,I[3]=R[3],I},fe.zero=function(I){return I[0]=0,I[1]=0,I[2]=0,I[3]=0,I},fe.str=function(I){return"vec4("+I[0]+", "+I[1]+", "+I[2]+", "+I[3]+")"},fe.exactEquals=function(I,R){return I[0]===R[0]&&I[1]===R[1]&&I[2]===R[2]&&I[3]===R[3]},fe.equals=function(I,R){var B=I[0],j=I[1],K=I[2],ne=I[3],oe=R[0],Y=R[1],ae=R[2],me=R[3];return Math.abs(B-oe)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(oe))&&Math.abs(j-Y)<=n.EPSILON*Math.max(1,Math.abs(j),Math.abs(Y))&&Math.abs(K-ae)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(ae))&&Math.abs(ne-me)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(me))},fe.forEach=fe.sqrLen=fe.len=fe.sqrDist=fe.dist=fe.div=fe.mul=fe.sub=void 0;var n=function(I,R){if(I&&I.__esModule)return I;if(I===null||c(I)!=="object"&&typeof I!="function")return{default:I};var B=s(void 0);if(B&&B.has(I))return B.get(I);var j={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in I)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(I,ne)){var oe=K?Object.getOwnPropertyDescriptor(I,ne):null;oe&&(oe.get||oe.set)?Object.defineProperty(j,ne,oe):j[ne]=I[ne]}return j.default=I,B&&B.set(I,j),j}(N());function s(I){if(typeof WeakMap!="function")return null;var R=new WeakMap,B=new WeakMap;return(s=function(j){return j?B:R})(I)}function u(){var I=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0,I[3]=0),I}function g(I,R,B){return I[0]=R[0]-B[0],I[1]=R[1]-B[1],I[2]=R[2]-B[2],I[3]=R[3]-B[3],I}function h(I,R,B){return I[0]=R[0]*B[0],I[1]=R[1]*B[1],I[2]=R[2]*B[2],I[3]=R[3]*B[3],I}function v(I,R,B){return I[0]=R[0]/B[0],I[1]=R[1]/B[1],I[2]=R[2]/B[2],I[3]=R[3]/B[3],I}function T(I,R){return Math.hypot(R[0]-I[0],R[1]-I[1],R[2]-I[2],R[3]-I[3])}function P(I,R){var B=R[0]-I[0],j=R[1]-I[1],K=R[2]-I[2],ne=R[3]-I[3];return B*B+j*j+K*K+ne*ne}function L(I){return Math.hypot(I[0],I[1],I[2],I[3])}function w(I){var R=I[0],B=I[1],j=I[2],K=I[3];return R*R+B*B+j*j+K*K}fe.sub=g,fe.mul=h,fe.div=v,fe.dist=T,fe.sqrDist=P,fe.len=L,fe.sqrLen=w;var M,D=(M=u(),function(I,R,B,j,K,ne){var oe,Y;for(R||(R=4),B||(B=0),Y=j?Math.min(j*R+B,I.length):I.length,oe=B;oe<Y;oe+=R)M[0]=I[oe],M[1]=I[oe+1],M[2]=I[oe+2],M[3]=I[oe+3],K(M,M,ne),I[oe]=M[0],I[oe+1]=M[1],I[oe+2]=M[2],I[oe+3]=M[3];return I});return fe.forEach=D,fe}function Se(){if(Ie)return he;function c($e){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(tt){return typeof tt}:function(tt){return tt&&typeof Symbol=="function"&&tt.constructor===Symbol&&tt!==Symbol.prototype?"symbol":typeof tt},c($e)}Ie=1,Object.defineProperty(he,"__esModule",{value:!0}),he.create=T,he.identity=function($e){return $e[0]=0,$e[1]=0,$e[2]=0,$e[3]=1,$e},he.setAxisAngle=P,he.getAxisAngle=function($e,tt){var ft=2*Math.acos(tt[3]),vt=Math.sin(ft/2);return vt>n.EPSILON?($e[0]=tt[0]/vt,$e[1]=tt[1]/vt,$e[2]=tt[2]/vt):($e[0]=1,$e[1]=0,$e[2]=0),ft},he.getAngle=function($e,tt){var ft=B($e,tt);return Math.acos(2*ft*ft-1)},he.multiply=L,he.rotateX=function($e,tt,ft){ft*=.5;var vt=tt[0],yt=tt[1],wt=tt[2],Bt=tt[3],St=Math.sin(ft),Xt=Math.cos(ft);return $e[0]=vt*Xt+Bt*St,$e[1]=yt*Xt+wt*St,$e[2]=wt*Xt-yt*St,$e[3]=Bt*Xt-vt*St,$e},he.rotateY=function($e,tt,ft){ft*=.5;var vt=tt[0],yt=tt[1],wt=tt[2],Bt=tt[3],St=Math.sin(ft),Xt=Math.cos(ft);return $e[0]=vt*Xt-wt*St,$e[1]=yt*Xt+Bt*St,$e[2]=wt*Xt+vt*St,$e[3]=Bt*Xt-yt*St,$e},he.rotateZ=function($e,tt,ft){ft*=.5;var vt=tt[0],yt=tt[1],wt=tt[2],Bt=tt[3],St=Math.sin(ft),Xt=Math.cos(ft);return $e[0]=vt*Xt+yt*St,$e[1]=yt*Xt-vt*St,$e[2]=wt*Xt+Bt*St,$e[3]=Bt*Xt-wt*St,$e},he.calculateW=function($e,tt){var ft=tt[0],vt=tt[1],yt=tt[2];return $e[0]=ft,$e[1]=vt,$e[2]=yt,$e[3]=Math.sqrt(Math.abs(1-ft*ft-vt*vt-yt*yt)),$e},he.exp=w,he.ln=M,he.pow=function($e,tt,ft){return M($e,tt),R($e,$e,ft),w($e,$e),$e},he.slerp=D,he.random=function($e){var tt=n.RANDOM(),ft=n.RANDOM(),vt=n.RANDOM(),yt=Math.sqrt(1-tt),wt=Math.sqrt(tt);return $e[0]=yt*Math.sin(2*Math.PI*ft),$e[1]=yt*Math.cos(2*Math.PI*ft),$e[2]=wt*Math.sin(2*Math.PI*vt),$e[3]=wt*Math.cos(2*Math.PI*vt),$e},he.invert=function($e,tt){var ft=tt[0],vt=tt[1],yt=tt[2],wt=tt[3],Bt=ft*ft+vt*vt+yt*yt+wt*wt,St=Bt?1/Bt:0;return $e[0]=-ft*St,$e[1]=-vt*St,$e[2]=-yt*St,$e[3]=wt*St,$e},he.conjugate=function($e,tt){return $e[0]=-tt[0],$e[1]=-tt[1],$e[2]=-tt[2],$e[3]=tt[3],$e},he.fromMat3=I,he.fromEuler=function($e,tt,ft,vt){var yt=.5*Math.PI/180;tt*=yt,ft*=yt,vt*=yt;var wt=Math.sin(tt),Bt=Math.cos(tt),St=Math.sin(ft),Xt=Math.cos(ft),un=Math.sin(vt),Gt=Math.cos(vt);return $e[0]=wt*Xt*Gt-Bt*St*un,$e[1]=Bt*St*Gt+wt*Xt*un,$e[2]=Bt*Xt*un-wt*St*Gt,$e[3]=Bt*Xt*Gt+wt*St*un,$e},he.str=function($e){return"quat("+$e[0]+", "+$e[1]+", "+$e[2]+", "+$e[3]+")"},he.setAxes=he.sqlerp=he.rotationTo=he.equals=he.exactEquals=he.normalize=he.sqrLen=he.squaredLength=he.len=he.length=he.lerp=he.dot=he.scale=he.mul=he.add=he.set=he.copy=he.fromValues=he.clone=void 0;var n=v(N()),s=v(ie()),u=v(Re()),g=v(Me());function h($e){if(typeof WeakMap!="function")return null;var tt=new WeakMap,ft=new WeakMap;return(h=function(vt){return vt?ft:tt})($e)}function v($e,tt){if($e&&$e.__esModule)return $e;if($e===null||c($e)!=="object"&&typeof $e!="function")return{default:$e};var ft=h(tt);if(ft&&ft.has($e))return ft.get($e);var vt={},yt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var wt in $e)if(wt!=="default"&&Object.prototype.hasOwnProperty.call($e,wt)){var Bt=yt?Object.getOwnPropertyDescriptor($e,wt):null;Bt&&(Bt.get||Bt.set)?Object.defineProperty(vt,wt,Bt):vt[wt]=$e[wt]}return vt.default=$e,ft&&ft.set($e,vt),vt}function T(){var $e=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&($e[0]=0,$e[1]=0,$e[2]=0),$e[3]=1,$e}function P($e,tt,ft){ft*=.5;var vt=Math.sin(ft);return $e[0]=vt*tt[0],$e[1]=vt*tt[1],$e[2]=vt*tt[2],$e[3]=Math.cos(ft),$e}function L($e,tt,ft){var vt=tt[0],yt=tt[1],wt=tt[2],Bt=tt[3],St=ft[0],Xt=ft[1],un=ft[2],Gt=ft[3];return $e[0]=vt*Gt+Bt*St+yt*un-wt*Xt,$e[1]=yt*Gt+Bt*Xt+wt*St-vt*un,$e[2]=wt*Gt+Bt*un+vt*Xt-yt*St,$e[3]=Bt*Gt-vt*St-yt*Xt-wt*un,$e}function w($e,tt){var ft=tt[0],vt=tt[1],yt=tt[2],wt=tt[3],Bt=Math.sqrt(ft*ft+vt*vt+yt*yt),St=Math.exp(wt),Xt=Bt>0?St*Math.sin(Bt)/Bt:0;return $e[0]=ft*Xt,$e[1]=vt*Xt,$e[2]=yt*Xt,$e[3]=St*Math.cos(Bt),$e}function M($e,tt){var ft=tt[0],vt=tt[1],yt=tt[2],wt=tt[3],Bt=Math.sqrt(ft*ft+vt*vt+yt*yt),St=Bt>0?Math.atan2(Bt,wt)/Bt:0;return $e[0]=ft*St,$e[1]=vt*St,$e[2]=yt*St,$e[3]=.5*Math.log(ft*ft+vt*vt+yt*yt+wt*wt),$e}function D($e,tt,ft,vt){var yt,wt,Bt,St,Xt,un=tt[0],Gt=tt[1],On=tt[2],In=tt[3],xn=ft[0],mn=ft[1],nr=ft[2],Ln=ft[3];return(wt=un*xn+Gt*mn+On*nr+In*Ln)<0&&(wt=-wt,xn=-xn,mn=-mn,nr=-nr,Ln=-Ln),1-wt>n.EPSILON?(yt=Math.acos(wt),Bt=Math.sin(yt),St=Math.sin((1-vt)*yt)/Bt,Xt=Math.sin(vt*yt)/Bt):(St=1-vt,Xt=vt),$e[0]=St*un+Xt*xn,$e[1]=St*Gt+Xt*mn,$e[2]=St*On+Xt*nr,$e[3]=St*In+Xt*Ln,$e}function I($e,tt){var ft,vt=tt[0]+tt[4]+tt[8];if(vt>0)ft=Math.sqrt(vt+1),$e[3]=.5*ft,$e[0]=(tt[5]-tt[7])*(ft=.5/ft),$e[1]=(tt[6]-tt[2])*ft,$e[2]=(tt[1]-tt[3])*ft;else{var yt=0;tt[4]>tt[0]&&(yt=1),tt[8]>tt[3*yt+yt]&&(yt=2);var wt=(yt+1)%3,Bt=(yt+2)%3;ft=Math.sqrt(tt[3*yt+yt]-tt[3*wt+wt]-tt[3*Bt+Bt]+1),$e[yt]=.5*ft,$e[3]=(tt[3*wt+Bt]-tt[3*Bt+wt])*(ft=.5/ft),$e[wt]=(tt[3*wt+yt]+tt[3*yt+wt])*ft,$e[Bt]=(tt[3*Bt+yt]+tt[3*yt+Bt])*ft}return $e}he.clone=g.clone,he.fromValues=g.fromValues,he.copy=g.copy,he.set=g.set,he.add=g.add,he.mul=L;var R=g.scale;he.scale=R;var B=g.dot;he.dot=B,he.lerp=g.lerp;var j=g.length;he.length=j,he.len=j;var K=g.squaredLength;he.squaredLength=K,he.sqrLen=K;var ne=g.normalize;he.normalize=ne,he.exactEquals=g.exactEquals,he.equals=g.equals;var oe,Y,ae,me=(oe=u.create(),Y=u.fromValues(1,0,0),ae=u.fromValues(0,1,0),function($e,tt,ft){var vt=u.dot(tt,ft);return vt<-.999999?(u.cross(oe,Y,tt),u.len(oe)<1e-6&&u.cross(oe,ae,tt),u.normalize(oe,oe),P($e,oe,Math.PI),$e):vt>.999999?($e[0]=0,$e[1]=0,$e[2]=0,$e[3]=1,$e):(u.cross(oe,tt,ft),$e[0]=oe[0],$e[1]=oe[1],$e[2]=oe[2],$e[3]=1+vt,ne($e,$e))});he.rotationTo=me;var Ee,Oe,Be=(Ee=T(),Oe=T(),function($e,tt,ft,vt,yt,wt){return D(Ee,tt,yt,wt),D(Oe,ft,vt,wt),D($e,Ee,Oe,2*wt*(1-wt)),$e});he.sqlerp=Be;var De,Xe=(De=s.create(),function($e,tt,ft,vt){return De[0]=ft[0],De[3]=ft[1],De[6]=ft[2],De[1]=vt[0],De[4]=vt[1],De[7]=vt[2],De[2]=-tt[0],De[5]=-tt[1],De[8]=-tt[2],ne($e,I($e,De))});return he.setAxes=Xe,he}var ye,Ce={};function Fe(){if(ye)return Ce;function c(D){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},c(D)}ye=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.create=function(){var D=new n.ARRAY_TYPE(8);return n.ARRAY_TYPE!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0,D[4]=0,D[5]=0,D[6]=0,D[7]=0),D[3]=1,D},Ce.clone=function(D){var I=new n.ARRAY_TYPE(8);return I[0]=D[0],I[1]=D[1],I[2]=D[2],I[3]=D[3],I[4]=D[4],I[5]=D[5],I[6]=D[6],I[7]=D[7],I},Ce.fromValues=function(D,I,R,B,j,K,ne,oe){var Y=new n.ARRAY_TYPE(8);return Y[0]=D,Y[1]=I,Y[2]=R,Y[3]=B,Y[4]=j,Y[5]=K,Y[6]=ne,Y[7]=oe,Y},Ce.fromRotationTranslationValues=function(D,I,R,B,j,K,ne){var oe=new n.ARRAY_TYPE(8);oe[0]=D,oe[1]=I,oe[2]=R,oe[3]=B;var Y=.5*j,ae=.5*K,me=.5*ne;return oe[4]=Y*B+ae*R-me*I,oe[5]=ae*B+me*D-Y*R,oe[6]=me*B+Y*I-ae*D,oe[7]=-Y*D-ae*I-me*R,oe},Ce.fromRotationTranslation=v,Ce.fromTranslation=function(D,I){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=.5*I[0],D[5]=.5*I[1],D[6]=.5*I[2],D[7]=0,D},Ce.fromRotation=function(D,I){return D[0]=I[0],D[1]=I[1],D[2]=I[2],D[3]=I[3],D[4]=0,D[5]=0,D[6]=0,D[7]=0,D},Ce.fromMat4=function(D,I){var R=s.create();u.getRotation(R,I);var B=new n.ARRAY_TYPE(3);return u.getTranslation(B,I),v(D,R,B),D},Ce.copy=T,Ce.identity=function(D){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=0,D[5]=0,D[6]=0,D[7]=0,D},Ce.set=function(D,I,R,B,j,K,ne,oe,Y){return D[0]=I,D[1]=R,D[2]=B,D[3]=j,D[4]=K,D[5]=ne,D[6]=oe,D[7]=Y,D},Ce.getDual=function(D,I){return D[0]=I[4],D[1]=I[5],D[2]=I[6],D[3]=I[7],D},Ce.setDual=function(D,I){return D[4]=I[0],D[5]=I[1],D[6]=I[2],D[7]=I[3],D},Ce.getTranslation=function(D,I){var R=I[4],B=I[5],j=I[6],K=I[7],ne=-I[0],oe=-I[1],Y=-I[2],ae=I[3];return D[0]=2*(R*ae+K*ne+B*Y-j*oe),D[1]=2*(B*ae+K*oe+j*ne-R*Y),D[2]=2*(j*ae+K*Y+R*oe-B*ne),D},Ce.translate=function(D,I,R){var B=I[0],j=I[1],K=I[2],ne=I[3],oe=.5*R[0],Y=.5*R[1],ae=.5*R[2],me=I[4],Ee=I[5],Oe=I[6],Be=I[7];return D[0]=B,D[1]=j,D[2]=K,D[3]=ne,D[4]=ne*oe+j*ae-K*Y+me,D[5]=ne*Y+K*oe-B*ae+Ee,D[6]=ne*ae+B*Y-j*oe+Oe,D[7]=-B*oe-j*Y-K*ae+Be,D},Ce.rotateX=function(D,I,R){var B=-I[0],j=-I[1],K=-I[2],ne=I[3],oe=I[4],Y=I[5],ae=I[6],me=I[7],Ee=oe*ne+me*B+Y*K-ae*j,Oe=Y*ne+me*j+ae*B-oe*K,Be=ae*ne+me*K+oe*j-Y*B,De=me*ne-oe*B-Y*j-ae*K;return s.rotateX(D,I,R),D[4]=Ee*(ne=D[3])+De*(B=D[0])+Oe*(K=D[2])-Be*(j=D[1]),D[5]=Oe*ne+De*j+Be*B-Ee*K,D[6]=Be*ne+De*K+Ee*j-Oe*B,D[7]=De*ne-Ee*B-Oe*j-Be*K,D},Ce.rotateY=function(D,I,R){var B=-I[0],j=-I[1],K=-I[2],ne=I[3],oe=I[4],Y=I[5],ae=I[6],me=I[7],Ee=oe*ne+me*B+Y*K-ae*j,Oe=Y*ne+me*j+ae*B-oe*K,Be=ae*ne+me*K+oe*j-Y*B,De=me*ne-oe*B-Y*j-ae*K;return s.rotateY(D,I,R),D[4]=Ee*(ne=D[3])+De*(B=D[0])+Oe*(K=D[2])-Be*(j=D[1]),D[5]=Oe*ne+De*j+Be*B-Ee*K,D[6]=Be*ne+De*K+Ee*j-Oe*B,D[7]=De*ne-Ee*B-Oe*j-Be*K,D},Ce.rotateZ=function(D,I,R){var B=-I[0],j=-I[1],K=-I[2],ne=I[3],oe=I[4],Y=I[5],ae=I[6],me=I[7],Ee=oe*ne+me*B+Y*K-ae*j,Oe=Y*ne+me*j+ae*B-oe*K,Be=ae*ne+me*K+oe*j-Y*B,De=me*ne-oe*B-Y*j-ae*K;return s.rotateZ(D,I,R),D[4]=Ee*(ne=D[3])+De*(B=D[0])+Oe*(K=D[2])-Be*(j=D[1]),D[5]=Oe*ne+De*j+Be*B-Ee*K,D[6]=Be*ne+De*K+Ee*j-Oe*B,D[7]=De*ne-Ee*B-Oe*j-Be*K,D},Ce.rotateByQuatAppend=function(D,I,R){var B=R[0],j=R[1],K=R[2],ne=R[3],oe=I[0],Y=I[1],ae=I[2],me=I[3];return D[0]=oe*ne+me*B+Y*K-ae*j,D[1]=Y*ne+me*j+ae*B-oe*K,D[2]=ae*ne+me*K+oe*j-Y*B,D[3]=me*ne-oe*B-Y*j-ae*K,D[4]=(oe=I[4])*ne+(me=I[7])*B+(Y=I[5])*K-(ae=I[6])*j,D[5]=Y*ne+me*j+ae*B-oe*K,D[6]=ae*ne+me*K+oe*j-Y*B,D[7]=me*ne-oe*B-Y*j-ae*K,D},Ce.rotateByQuatPrepend=function(D,I,R){var B=I[0],j=I[1],K=I[2],ne=I[3],oe=R[0],Y=R[1],ae=R[2],me=R[3];return D[0]=B*me+ne*oe+j*ae-K*Y,D[1]=j*me+ne*Y+K*oe-B*ae,D[2]=K*me+ne*ae+B*Y-j*oe,D[3]=ne*me-B*oe-j*Y-K*ae,D[4]=B*(me=R[7])+ne*(oe=R[4])+j*(ae=R[6])-K*(Y=R[5]),D[5]=j*me+ne*Y+K*oe-B*ae,D[6]=K*me+ne*ae+B*Y-j*oe,D[7]=ne*me-B*oe-j*Y-K*ae,D},Ce.rotateAroundAxis=function(D,I,R,B){if(Math.abs(B)<n.EPSILON)return T(D,I);var j=Math.hypot(R[0],R[1],R[2]);B*=.5;var K=Math.sin(B),ne=K*R[0]/j,oe=K*R[1]/j,Y=K*R[2]/j,ae=Math.cos(B),me=I[0],Ee=I[1],Oe=I[2],Be=I[3];D[0]=me*ae+Be*ne+Ee*Y-Oe*oe,D[1]=Ee*ae+Be*oe+Oe*ne-me*Y,D[2]=Oe*ae+Be*Y+me*oe-Ee*ne,D[3]=Be*ae-me*ne-Ee*oe-Oe*Y;var De=I[4],Xe=I[5],$e=I[6],tt=I[7];return D[4]=De*ae+tt*ne+Xe*Y-$e*oe,D[5]=Xe*ae+tt*oe+$e*ne-De*Y,D[6]=$e*ae+tt*Y+De*oe-Xe*ne,D[7]=tt*ae-De*ne-Xe*oe-$e*Y,D},Ce.add=function(D,I,R){return D[0]=I[0]+R[0],D[1]=I[1]+R[1],D[2]=I[2]+R[2],D[3]=I[3]+R[3],D[4]=I[4]+R[4],D[5]=I[5]+R[5],D[6]=I[6]+R[6],D[7]=I[7]+R[7],D},Ce.multiply=P,Ce.scale=function(D,I,R){return D[0]=I[0]*R,D[1]=I[1]*R,D[2]=I[2]*R,D[3]=I[3]*R,D[4]=I[4]*R,D[5]=I[5]*R,D[6]=I[6]*R,D[7]=I[7]*R,D},Ce.lerp=function(D,I,R,B){var j=1-B;return L(I,R)<0&&(B=-B),D[0]=I[0]*j+R[0]*B,D[1]=I[1]*j+R[1]*B,D[2]=I[2]*j+R[2]*B,D[3]=I[3]*j+R[3]*B,D[4]=I[4]*j+R[4]*B,D[5]=I[5]*j+R[5]*B,D[6]=I[6]*j+R[6]*B,D[7]=I[7]*j+R[7]*B,D},Ce.invert=function(D,I){var R=M(I);return D[0]=-I[0]/R,D[1]=-I[1]/R,D[2]=-I[2]/R,D[3]=I[3]/R,D[4]=-I[4]/R,D[5]=-I[5]/R,D[6]=-I[6]/R,D[7]=I[7]/R,D},Ce.conjugate=function(D,I){return D[0]=-I[0],D[1]=-I[1],D[2]=-I[2],D[3]=I[3],D[4]=-I[4],D[5]=-I[5],D[6]=-I[6],D[7]=I[7],D},Ce.normalize=function(D,I){var R=M(I);if(R>0){R=Math.sqrt(R);var B=I[0]/R,j=I[1]/R,K=I[2]/R,ne=I[3]/R,oe=I[4],Y=I[5],ae=I[6],me=I[7],Ee=B*oe+j*Y+K*ae+ne*me;D[0]=B,D[1]=j,D[2]=K,D[3]=ne,D[4]=(oe-B*Ee)/R,D[5]=(Y-j*Ee)/R,D[6]=(ae-K*Ee)/R,D[7]=(me-ne*Ee)/R}return D},Ce.str=function(D){return"quat2("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+", "+D[4]+", "+D[5]+", "+D[6]+", "+D[7]+")"},Ce.exactEquals=function(D,I){return D[0]===I[0]&&D[1]===I[1]&&D[2]===I[2]&&D[3]===I[3]&&D[4]===I[4]&&D[5]===I[5]&&D[6]===I[6]&&D[7]===I[7]},Ce.equals=function(D,I){var R=D[0],B=D[1],j=D[2],K=D[3],ne=D[4],oe=D[5],Y=D[6],ae=D[7],me=I[0],Ee=I[1],Oe=I[2],Be=I[3],De=I[4],Xe=I[5],$e=I[6],tt=I[7];return Math.abs(R-me)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(me))&&Math.abs(B-Ee)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(Ee))&&Math.abs(j-Oe)<=n.EPSILON*Math.max(1,Math.abs(j),Math.abs(Oe))&&Math.abs(K-Be)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(Be))&&Math.abs(ne-De)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(De))&&Math.abs(oe-Xe)<=n.EPSILON*Math.max(1,Math.abs(oe),Math.abs(Xe))&&Math.abs(Y-$e)<=n.EPSILON*Math.max(1,Math.abs(Y),Math.abs($e))&&Math.abs(ae-tt)<=n.EPSILON*Math.max(1,Math.abs(ae),Math.abs(tt))},Ce.sqrLen=Ce.squaredLength=Ce.len=Ce.length=Ce.dot=Ce.mul=Ce.setReal=Ce.getReal=void 0;var n=h(N()),s=h(Se()),u=h(pe());function g(D){if(typeof WeakMap!="function")return null;var I=new WeakMap,R=new WeakMap;return(g=function(B){return B?R:I})(D)}function h(D,I){if(D&&D.__esModule)return D;if(D===null||c(D)!=="object"&&typeof D!="function")return{default:D};var R=g(I);if(R&&R.has(D))return R.get(D);var B={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var K in D)if(K!=="default"&&Object.prototype.hasOwnProperty.call(D,K)){var ne=j?Object.getOwnPropertyDescriptor(D,K):null;ne&&(ne.get||ne.set)?Object.defineProperty(B,K,ne):B[K]=D[K]}return B.default=D,R&&R.set(D,B),B}function v(D,I,R){var B=.5*R[0],j=.5*R[1],K=.5*R[2],ne=I[0],oe=I[1],Y=I[2],ae=I[3];return D[0]=ne,D[1]=oe,D[2]=Y,D[3]=ae,D[4]=B*ae+j*Y-K*oe,D[5]=j*ae+K*ne-B*Y,D[6]=K*ae+B*oe-j*ne,D[7]=-B*ne-j*oe-K*Y,D}function T(D,I){return D[0]=I[0],D[1]=I[1],D[2]=I[2],D[3]=I[3],D[4]=I[4],D[5]=I[5],D[6]=I[6],D[7]=I[7],D}function P(D,I,R){var B=I[0],j=I[1],K=I[2],ne=I[3],oe=R[4],Y=R[5],ae=R[6],me=R[7],Ee=I[4],Oe=I[5],Be=I[6],De=I[7],Xe=R[0],$e=R[1],tt=R[2],ft=R[3];return D[0]=B*ft+ne*Xe+j*tt-K*$e,D[1]=j*ft+ne*$e+K*Xe-B*tt,D[2]=K*ft+ne*tt+B*$e-j*Xe,D[3]=ne*ft-B*Xe-j*$e-K*tt,D[4]=B*me+ne*oe+j*ae-K*Y+Ee*ft+De*Xe+Oe*tt-Be*$e,D[5]=j*me+ne*Y+K*oe-B*ae+Oe*ft+De*$e+Be*Xe-Ee*tt,D[6]=K*me+ne*ae+B*Y-j*oe+Be*ft+De*tt+Ee*$e-Oe*Xe,D[7]=ne*me-B*oe-j*Y-K*ae+De*ft-Ee*Xe-Oe*$e-Be*tt,D}Ce.getReal=s.copy,Ce.setReal=s.copy,Ce.mul=P;var L=s.dot;Ce.dot=L;var w=s.length;Ce.length=w,Ce.len=w;var M=s.squaredLength;return Ce.squaredLength=M,Ce.sqrLen=M,Ce}var it,We,ut={};function Lt(){if(it)return ut;function c(I){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(I)}it=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.create=u,ut.clone=function(I){var R=new n.ARRAY_TYPE(2);return R[0]=I[0],R[1]=I[1],R},ut.fromValues=function(I,R){var B=new n.ARRAY_TYPE(2);return B[0]=I,B[1]=R,B},ut.copy=function(I,R){return I[0]=R[0],I[1]=R[1],I},ut.set=function(I,R,B){return I[0]=R,I[1]=B,I},ut.add=function(I,R,B){return I[0]=R[0]+B[0],I[1]=R[1]+B[1],I},ut.subtract=g,ut.multiply=h,ut.divide=v,ut.ceil=function(I,R){return I[0]=Math.ceil(R[0]),I[1]=Math.ceil(R[1]),I},ut.floor=function(I,R){return I[0]=Math.floor(R[0]),I[1]=Math.floor(R[1]),I},ut.min=function(I,R,B){return I[0]=Math.min(R[0],B[0]),I[1]=Math.min(R[1],B[1]),I},ut.max=function(I,R,B){return I[0]=Math.max(R[0],B[0]),I[1]=Math.max(R[1],B[1]),I},ut.round=function(I,R){return I[0]=Math.round(R[0]),I[1]=Math.round(R[1]),I},ut.scale=function(I,R,B){return I[0]=R[0]*B,I[1]=R[1]*B,I},ut.scaleAndAdd=function(I,R,B,j){return I[0]=R[0]+B[0]*j,I[1]=R[1]+B[1]*j,I},ut.distance=T,ut.squaredDistance=P,ut.length=L,ut.squaredLength=w,ut.negate=function(I,R){return I[0]=-R[0],I[1]=-R[1],I},ut.inverse=function(I,R){return I[0]=1/R[0],I[1]=1/R[1],I},ut.normalize=function(I,R){var B=R[0],j=R[1],K=B*B+j*j;return K>0&&(K=1/Math.sqrt(K)),I[0]=R[0]*K,I[1]=R[1]*K,I},ut.dot=function(I,R){return I[0]*R[0]+I[1]*R[1]},ut.cross=function(I,R,B){var j=R[0]*B[1]-R[1]*B[0];return I[0]=I[1]=0,I[2]=j,I},ut.lerp=function(I,R,B,j){var K=R[0],ne=R[1];return I[0]=K+j*(B[0]-K),I[1]=ne+j*(B[1]-ne),I},ut.random=function(I,R){R=R||1;var B=2*n.RANDOM()*Math.PI;return I[0]=Math.cos(B)*R,I[1]=Math.sin(B)*R,I},ut.transformMat2=function(I,R,B){var j=R[0],K=R[1];return I[0]=B[0]*j+B[2]*K,I[1]=B[1]*j+B[3]*K,I},ut.transformMat2d=function(I,R,B){var j=R[0],K=R[1];return I[0]=B[0]*j+B[2]*K+B[4],I[1]=B[1]*j+B[3]*K+B[5],I},ut.transformMat3=function(I,R,B){var j=R[0],K=R[1];return I[0]=B[0]*j+B[3]*K+B[6],I[1]=B[1]*j+B[4]*K+B[7],I},ut.transformMat4=function(I,R,B){var j=R[0],K=R[1];return I[0]=B[0]*j+B[4]*K+B[12],I[1]=B[1]*j+B[5]*K+B[13],I},ut.rotate=function(I,R,B,j){var K=R[0]-B[0],ne=R[1]-B[1],oe=Math.sin(j),Y=Math.cos(j);return I[0]=K*Y-ne*oe+B[0],I[1]=K*oe+ne*Y+B[1],I},ut.angle=function(I,R){var B=I[0],j=I[1],K=R[0],ne=R[1],oe=Math.sqrt(B*B+j*j)*Math.sqrt(K*K+ne*ne);return Math.acos(Math.min(Math.max(oe&&(B*K+j*ne)/oe,-1),1))},ut.zero=function(I){return I[0]=0,I[1]=0,I},ut.str=function(I){return"vec2("+I[0]+", "+I[1]+")"},ut.exactEquals=function(I,R){return I[0]===R[0]&&I[1]===R[1]},ut.equals=function(I,R){var B=I[0],j=I[1],K=R[0],ne=R[1];return Math.abs(B-K)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(K))&&Math.abs(j-ne)<=n.EPSILON*Math.max(1,Math.abs(j),Math.abs(ne))},ut.forEach=ut.sqrLen=ut.sqrDist=ut.dist=ut.div=ut.mul=ut.sub=ut.len=void 0;var n=function(I,R){if(I&&I.__esModule)return I;if(I===null||c(I)!=="object"&&typeof I!="function")return{default:I};var B=s(void 0);if(B&&B.has(I))return B.get(I);var j={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in I)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(I,ne)){var oe=K?Object.getOwnPropertyDescriptor(I,ne):null;oe&&(oe.get||oe.set)?Object.defineProperty(j,ne,oe):j[ne]=I[ne]}return j.default=I,B&&B.set(I,j),j}(N());function s(I){if(typeof WeakMap!="function")return null;var R=new WeakMap,B=new WeakMap;return(s=function(j){return j?B:R})(I)}function u(){var I=new n.ARRAY_TYPE(2);return n.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0),I}function g(I,R,B){return I[0]=R[0]-B[0],I[1]=R[1]-B[1],I}function h(I,R,B){return I[0]=R[0]*B[0],I[1]=R[1]*B[1],I}function v(I,R,B){return I[0]=R[0]/B[0],I[1]=R[1]/B[1],I}function T(I,R){return Math.hypot(R[0]-I[0],R[1]-I[1])}function P(I,R){var B=R[0]-I[0],j=R[1]-I[1];return B*B+j*j}function L(I){return Math.hypot(I[0],I[1])}function w(I){var R=I[0],B=I[1];return R*R+B*B}ut.len=L,ut.sub=g,ut.mul=h,ut.div=v,ut.dist=T,ut.sqrDist=P,ut.sqrLen=w;var M,D=(M=u(),function(I,R,B,j,K,ne){var oe,Y;for(R||(R=2),B||(B=0),Y=j?Math.min(j*R+B,I.length):I.length,oe=B;oe<Y;oe+=R)M[0]=I[oe],M[1]=I[oe+1],K(M,M,ne),I[oe]=M[0],I[oe+1]=M[1];return I});return ut.forEach=D,ut}function Ft(){if(We)return A;function c(I){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(I)}We=1,Object.defineProperty(A,"__esModule",{value:!0}),A.vec4=A.vec3=A.vec2=A.quat2=A.quat=A.mat4=A.mat3=A.mat2d=A.mat2=A.glMatrix=void 0;var n=D(N());A.glMatrix=n;var s=D(G());A.mat2=s;var u=D(Z());A.mat2d=u;var g=D(ie());A.mat3=g;var h=D(pe());A.mat4=h;var v=D(Se());A.quat=v;var T=D(Fe());A.quat2=T;var P=D(Lt());A.vec2=P;var L=D(Re());A.vec3=L;var w=D(Me());function M(I){if(typeof WeakMap!="function")return null;var R=new WeakMap,B=new WeakMap;return(M=function(j){return j?B:R})(I)}function D(I,R){if(I&&I.__esModule)return I;if(I===null||c(I)!=="object"&&typeof I!="function")return{default:I};var B=M(R);if(B&&B.has(I))return B.get(I);var j={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in I)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(I,ne)){var oe=K?Object.getOwnPropertyDescriptor(I,ne):null;oe&&(oe.get||oe.set)?Object.defineProperty(j,ne,oe):j[ne]=I[ne]}return j.default=I,B&&B.set(I,j),j}return A.vec4=w,A}var mt,jt,Ht,Tn,Pe=Ft(),At=function(){if(jt)return mt;function c(n,s,u,g){this.cx=3*n,this.bx=3*(u-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(g-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=s,this.p2x=u,this.p2y=g}return jt=1,mt=c,c.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,s){if(s===void 0&&(s=1e-6),n<0)return 0;if(n>1)return 1;for(var u=n,g=0;g<8;g++){var h=this.sampleCurveX(u)-n;if(Math.abs(h)<s)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=h/v}var T=0,P=1;for(u=n,g=0;g<20&&(h=this.sampleCurveX(u),!(Math.abs(h-n)<s));g++)n>h?T=u:P=u,u=.5*(P-T)+T;return u},solve:function(n,s){return this.sampleCurveY(this.solveCurveX(n,s))}},mt}(),He=C(At);function pt(){if(Tn)return Ht;function c(n,s){this.x=n,this.y=s}return Tn=1,Ht=c,c.prototype={clone:function(){return new c(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,s){return this.clone()._rotateAround(n,s)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var s=n.x-this.x,u=n.y-this.y;return s*s+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,s){return Math.atan2(this.x*s-this.y*n,this.x*n+this.y*s)},_matMult:function(n){var s=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=s,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var s=Math.cos(n),u=Math.sin(n),g=u*this.x+s*this.y;return this.x=s*this.x-u*this.y,this.y=g,this},_rotateAround:function(n,s){var u=Math.cos(n),g=Math.sin(n),h=s.y+g*(this.x-s.x)+u*(this.y-s.y);return this.x=s.x+u*(this.x-s.x)-g*(this.y-s.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},c.convert=function(n){return n instanceof c?n:Array.isArray(n)?new c(n[0],n[1]):n},Ht}var et=C(pt());function rn(c,n){if(Array.isArray(c)){if(!Array.isArray(n)||c.length!==n.length)return!1;for(let s=0;s<c.length;s++)if(!rn(c[s],n[s]))return!1;return!0}if(typeof c=="object"&&c!==null&&n!==null){if(typeof n!="object"||Object.keys(c).length!==Object.keys(n).length)return!1;for(const s in c)if(!rn(c[s],n[s]))return!1;return!0}return c===n}const kt=Math.PI/180,zt=180/Math.PI;function Mt(c){return c*kt}function en(c){return c*zt}const sn=[[0,0],[1,0],[1,1],[0,1]];function dn(c){if(c<=0)return 0;if(c>=1)return 1;const n=c*c,s=n*c;return 4*(c<.5?s:3*(c-n)+s-.75)}function Pn(c,n,s,u){const g=new He(c,n,s,u);return function(h){return g.solve(h)}}const Ot=Pn(.25,.1,.25,1);function Zt(c,n,s){return Math.min(s,Math.max(n,c))}function jn(c,n,s){return(s=Zt((s-c)/(n-c),0,1))*s*(3-2*s)}function ir(c,n,s){const u=s-n,g=((c-n)%u+u)%u+n;return g===n?s:g}function ur(c,n,s){if(!c.length)return s(null,[]);let u=c.length;const g=new Array(c.length);let h=null;c.forEach((v,T)=>{n(v,(P,L)=>{P&&(h=P),g[T]=L,--u==0&&s(h,g)})})}function ar(c,...n){for(const s of n)for(const u in s)c[u]=s[u];return c}let wr=1;function Xr(){return wr++}function Rt(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function _n(c,n){c.forEach(s=>{n[s]&&(n[s]=n[s].bind(n))})}function dt(c,n){return c.indexOf(n,c.length-n.length)!==-1}function tn(c,n,s){const u={};for(const g in c)u[g]=n.call(this,c[g],g,c);return u}function Ze(c,n,s){const u={};for(const g in c)n.call(this,c[g],g,c)&&(u[g]=c[g]);return u}function gn(c){return Array.isArray(c)?c.map(gn):typeof c=="object"&&c?tn(c,gn):c}const rr={};function Hn(c){rr[c]||(typeof console<"u"&&console.warn(c),rr[c]=!0)}function eo(c,n,s){return(s.y-c.y)*(n.x-c.x)>(n.y-c.y)*(s.x-c.x)}function Mi(c){let n=0;for(let s,u,g=0,h=c.length,v=h-1;g<h;v=g++)s=c[g],u=c[v],n+=(u.x-s.x)*(s.y+u.y);return n}function mo([c,n,s]){const u=Mt(n+90),g=Mt(s);return{x:c*Math.cos(u)*Math.sin(g),y:c*Math.sin(u)*Math.sin(g),z:c*Math.cos(g),azimuthal:n,polar:s}}function bo(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Rr(c){const n={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,u,g,h)=>{const v=g||h;return n[u]=!v||v.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n}let fi,_a=null;function Ns(c,n){return[c[4*n],c[4*n+1],c[4*n+2],c[4*n+3]]}function Nt(c,n,s,u){for(;n<s;){const g=n+s>>1;c[g]<u?n=g+1:s=g}return n}function Te(c,n,s,u){for(;n<s;){const g=n+s>>1;c[g]<=u?n=g+1:s=g}return n}function ke(c){return c>0?1/(1.001-c):1+c}function Ke(c){return c>0?1-1/(1.001-c):-c}const lt={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(fi==null){const c=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{fi=i.API_URL_REGEX!=null?new RegExp(i.API_URL_REGEX):c}catch{fi=c}}return fi},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!lt.API_URL)return null;try{const c=new URL(lt.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function nt(c){return lt.API_URL_REGEX.test(c)}function xt(c){return lt.API_SPRITE_REGEX.test(c)}let $t,Tt,Vt,Yt,Je,Pt;function vn(){return $t==null&&($t=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),$t}const Cn={now:()=>Yt!==void 0?Yt:performance.now(),setNow(c){Yt=c},restoreNow(){Yt=void 0},frame(c){const n=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(c,n=0){const{width:s,height:u}=c;Je||(Je=document.createElement("canvas"));const g=Je.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return(s>Je.width||u>Je.height)&&(Je.width=s,Je.height=u),g.clearRect(-n,-n,s+2*n,u+2*n),g.drawImage(c,0,0,s,u),g.getImageData(-n,-n,s+2*n,u+2*n)},resolveURL:c=>(Tt||(Tt=document.createElement("a")),Tt.href=c,Tt.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Vt==null&&(Vt=window.matchMedia("(prefers-reduced-motion: reduce)")),Vt.matches)},hasCanvasFingerprintNoise(){if(Pt!==void 0)return Pt;if(!vn())return Pt=!1,!1;const c=new OffscreenCanvas(85,1),n=c.getContext("2d",{willReadFrequently:!0});let s=0;for(let g=0;g<c.width;++g)n.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,n.fillRect(g,0,1,1);const u=n.getImageData(0,0,c.width,c.height);s=0;for(let g=0;g<u.data.length;++g)if(g%4!=3&&s++!==u.data[g])return Pt=!0,!0;return Pt=!1,!1}};function tr(c,n){const s=c.indexOf("?");if(s<0)return`${c}?${new URLSearchParams(n).toString()}`;const u=new URLSearchParams(c.slice(s));for(const g in n)u.set(g,n[g]);return`${c.slice(0,s)}?${u.toString()}`}function hr(c,n={persistentParams:[]}){const s=c.indexOf("?");if(s<0)return c;const u=new URLSearchParams,g=new URLSearchParams(c.slice(s));for(const v of n.persistentParams){const T=g.get(v);T&&u.set(v,T)}const h=u.toString();return`${c.slice(0,s)}${h.length>0?`?${h}`:""}`}const dr="mapbox-tiles";let fr=500,Wr=50;const ro=["language","worldview","jobid"];let Ut,Rn;function Jn(){try{return caches}catch{}}function _r(){const c=Jn();c&&Ut==null&&(Ut=c.open(dr))}let go=1/0;const jo={supported:!1,testSupport:function(c){!Nh&&Ga&&(fd?$h(c):Qs=c)}};let Qs,Ga,Nh=!1,fd=!1;const Nc=typeof self<"u"?self:{};function $h(c){const n=c.createTexture();c.bindTexture(c.TEXTURE_2D,n);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,Ga),c.isContextLost())return;jo.supported=!0}catch{}c.deleteTexture(n),Nh=!0}Nc.document&&(Ga=Nc.document.createElement("img"),Ga.onload=function(){Qs&&$h(Qs),Qs=null,fd=!0},Ga.onerror=function(){Nh=!0,Qs=null},Ga.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const $c={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze($c);class im extends Error{constructor(n,s,u){s===401&&nt(u)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=s,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const sm=bo()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,pd=function(c,n){if(!(/^file:/.test(s=c.url)||/^file:/.test(sm())&&!/^\w+:/.test(s))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,g){const h=new AbortController,v=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:sm(),referrerPolicy:u.referrerPolicy,signal:h.signal});let T=!1,P=!1;const L=(w=v.url).indexOf("sku=")>0&&nt(w);var w;u.type==="json"&&v.headers.set("Accept","application/json");const M=(I,R,B)=>{if(P)return;if(I&&I.message!=="SecurityError"&&Hn(I.toString()),R&&B)return D(R);const j=Date.now();fetch(v).then(K=>{if(K.ok){const ne=L?K.clone():null;return D(K,ne,j)}return g(new im(K.statusText,K.status,u.url))}).catch(K=>{K.name!=="AbortError"&&g(new Error(`${K.message} ${u.url}`))})},D=(I,R,B)=>{(u.type==="arrayBuffer"?I.arrayBuffer():u.type==="json"?I.json():I.text()).then(j=>{P||(R&&B&&function(K,ne,oe){if(_r(),Ut==null)return;const Y=Rr(ne.headers.get("Cache-Control")||"");if(Y["no-store"])return;const ae={status:ne.status,statusText:ne.statusText,headers:new Headers};ne.headers.forEach((Oe,Be)=>ae.headers.set(Be,Oe)),Y["max-age"]&&ae.headers.set("Expires",new Date(oe+1e3*Y["max-age"]).toUTCString());const me=ae.headers.get("Expires");if(!me||new Date(me).getTime()-oe<42e4)return;let Ee=hr(K.url,{persistentParams:ro});if(ne.status===206){const Oe=K.headers.get("Range");if(!Oe)return;ae.status=200,Ee=tr(Ee,{range:Oe})}(function(Oe,Be){if(Rn===void 0)try{new Response(new ReadableStream),Rn=!0}catch{Rn=!1}Rn?Be(Oe.body):Oe.blob().then(Be)})(ne,Oe=>{const Be=new Response((De=ne.status)!==200&&De!==404&&[101,103,204,205,304].includes(De)?null:Oe,ae);var De;_r(),Ut!=null&&Ut.then(Xe=>Xe.put(Ee,Be)).catch(Xe=>Hn(Xe.message))})}(v,R,B),T=!0,g(null,j,I.headers.get("Cache-Control"),I.headers.get("Expires")))}).catch(j=>{P||g(new Error(j.message))})};return L?function(I,R){if(_r(),Ut==null)return R(null);Ut.then(B=>{let j=hr(I.url,{persistentParams:ro});const K=I.headers.get("Range");K&&(j=tr(j,{range:K})),B.match(j).then(ne=>{const oe=function(Y){if(!Y)return!1;const ae=new Date(Y.headers.get("Expires")||0),me=Rr(Y.headers.get("Cache-Control")||"");return ae>Date.now()&&!me["no-cache"]}(ne);B.delete(j),oe&&B.put(j,ne.clone()),R(null,ne,oe)}).catch(R)}).catch(R)}(v,M):M(null,null),{cancel:()=>{P=!0,T||h.abort()}}}(c,n);if(bo()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,n,void 0,!0)}var s;return function(u,g){const h=new XMLHttpRequest;h.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const v in u.headers)h.setRequestHeader(v,u.headers[v]);return u.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=u.credentials==="include",h.onerror=()=>{g(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let v=h.response;if(u.type==="json")try{v=JSON.parse(h.response)}catch(T){return g(T)}g(null,v,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else g(new im(h.statusText,h.status,u.url))},h.send(u.body),{cancel:()=>h.abort()}}(c,n)},Vc=function(c,n){return pd(ar(c,{type:"arrayBuffer"}),n)};function $s(c){const n=document.createElement("a");return n.href=c,n.protocol===location.protocol&&n.host===location.host}const ea="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ta,is;ta=[],is=0;const ya=function(c,n){if(jo.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),is>=lt.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:c,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return ta.push(h),h}is++;let s=!1;const u=()=>{if(!s)for(s=!0,is--;ta.length&&is<lt.MAX_PARALLEL_IMAGE_REQUESTS;){const h=ta.shift(),{requestParameters:v,callback:T,cancelled:P}=h;P||(h.cancel=ya(v,T).cancel)}},g=Vc(c,(h,v,T,P)=>{u(),h?n(h):v&&(self.createImageBitmap?function(L,w){const M=new Blob([new Uint8Array(L)],{type:"image/png"});createImageBitmap(M).then(D=>{w(null,D)}).catch(D=>{w(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(L,w)=>n(L,w,T,P)):function(L,w){const M=new Image;M.onload=()=>{w(null,M),URL.revokeObjectURL(M.src),M.onload=null,requestAnimationFrame(()=>{M.src=ea})},M.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const D=new Blob([new Uint8Array(L)],{type:"image/png"});M.src=L.byteLength?URL.createObjectURL(D):ea}(v,(L,w)=>n(L,w,T,P)))});return{cancel:()=>{g.cancel(),u()}}};var md,am,lm,ba={exports:{}},Vh={exports:{}},h_={exports:{}},u1=function(){if(lm)return ba.exports;lm=1;var c=(md||(md=1,Vh.exports=function(s,u){var g,h,v,T,P,L,w,M;for(h=s.length-(g=3&s.length),v=u,P=3432918353,L=461845907,M=0;M<h;)w=255&s.charCodeAt(M)|(255&s.charCodeAt(++M))<<8|(255&s.charCodeAt(++M))<<16|(255&s.charCodeAt(++M))<<24,++M,v=27492+(65535&(T=5*(65535&(v=(v^=w=(65535&(w=(w=(65535&w)*P+(((w>>>16)*P&65535)<<16)&4294967295)<<15|w>>>17))*L+(((w>>>16)*L&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(w=0,g){case 3:w^=(255&s.charCodeAt(M+2))<<16;case 2:w^=(255&s.charCodeAt(M+1))<<8;case 1:v^=w=(65535&(w=(w=(65535&(w^=255&s.charCodeAt(M)))*P+(((w>>>16)*P&65535)<<16)&4294967295)<<15|w>>>17))*L+(((w>>>16)*L&65535)<<16)&4294967295}return v^=s.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),Vh.exports),n=(am||(am=1,h_.exports=function(s,u){for(var g,h=s.length,v=u^h,T=0;h>=4;)g=1540483477*(65535&(g=255&s.charCodeAt(T)|(255&s.charCodeAt(++T))<<8|(255&s.charCodeAt(++T))<<16|(255&s.charCodeAt(++T))<<24))+((1540483477*(g>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),h-=4,++T;switch(h){case 3:v^=(255&s.charCodeAt(T+2))<<16;case 2:v^=(255&s.charCodeAt(T+1))<<8;case 1:v=1540483477*(65535&(v^=255&s.charCodeAt(T)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),h_.exports);return ba.exports=c,ba.exports.murmur3=c,ba.exports.murmur2=n,ba.exports}(),ss=C(u1);class Tl{constructor(n,...s){ar(this,s[0]||{}),this.type=n}}class gd extends Tl{constructor(n,s={}){super("error",ar({error:n},s))}}function Uc(c,n,s){s[c]&&s[c].indexOf(n)!==-1||(s[c]=s[c]||[],s[c].push(n))}function cm(c,n,s){if(s&&s[c]){const u=s[c].indexOf(n);u!==-1&&s[c].splice(u,1)}}class jc{on(n,s){return this._listeners=this._listeners||{},Uc(n,s,this._listeners),this}off(n,s){return cm(n,s,this._listeners),cm(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Uc(n,s,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,s){const u=typeof n=="string"?new Tl(n,s):n,g=u.type;if(this.listens(g)){u.target=this;const h=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const P of h)P.call(this,u);const v=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const P of v)cm(g,P,this._oneTimeListeners),P.call(this,u);const T=this._eventedParent;T&&(ar(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(u))}else u instanceof gd&&console.error(u.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var um,to={},dm=function(){if(um)return to;um=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(h){return(h=Math.round(h))<0?0:h>255?255:h}function s(h){return n(h[h.length-1]==="%"?parseFloat(h)/100*255:parseInt(h))}function u(h){return(v=h[h.length-1]==="%"?parseFloat(h)/100:parseFloat(h))<0?0:v>1?1:v;var v}function g(h,v,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?h+(v-h)*T*6:2*T<1?v:3*T<2?h+(v-h)*(2/3-T)*6:h}try{to.parseCSSColor=function(h){var v,T=h.replace(/ /g,"").toLowerCase();if(T in c)return c[T].slice();if(T[0]==="#")return T.length===4?(v=parseInt(T.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:T.length===7&&(v=parseInt(T.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var P=T.indexOf("("),L=T.indexOf(")");if(P!==-1&&L+1===T.length){var w=T.substr(0,P),M=T.substr(P+1,L-(P+1)).split(","),D=1;switch(w){case"rgba":if(M.length!==4)return null;D=u(M.pop());case"rgb":return M.length!==3?null:[s(M[0]),s(M[1]),s(M[2]),D];case"hsla":if(M.length!==4)return null;D=u(M.pop());case"hsl":if(M.length!==3)return null;var I=(parseFloat(M[0])%360+360)%360/360,R=u(M[1]),B=u(M[2]),j=B<=.5?B*(R+1):B+R-B*R,K=2*B-j;return[n(255*g(K,j,I+1/3)),n(255*g(K,j,I)),n(255*g(K,j,I-1/3)),D];default:return null}}return null}}catch{}return to}();class co{constructor(n,s,u,g=1){this.r=n,this.g=s,this.b=u,this.a=g}static parse(n){if(!n)return;if(n instanceof co)return n;if(typeof n!="string")return;const s=dm.parseCSSColor(n);return s?new co(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[n,s,u,g]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(n)},${Math.round(s)},${Math.round(u)},${g})`}toRenderColor(n){const{r:s,g:u,b:g,a:h}=this;return new d1(n,s,u,g,h)}}class d1{constructor(n,s,u,g,h){if(n){const v=n.image.height,T=v*v;s=h===0?0:s/h*(v-1),u=h===0?0:u/h*(v-1),g=h===0?0:g/h*(v-1);const P=Math.floor(s),L=Math.floor(u),w=Math.floor(g),M=Math.ceil(s),D=Math.ceil(u),I=Math.ceil(g),R=s-P,B=u-L,j=g-w,K=n.image.data,ne=4*(P+L*T+w*v),oe=4*(P+L*T+I*v),Y=4*(P+D*T+w*v),ae=4*(P+D*T+I*v),me=4*(M+L*T+w*v),Ee=4*(M+L*T+I*v),Oe=4*(M+D*T+w*v),Be=4*(M+D*T+I*v);if(ne<0||Be>=K.length)throw new Error("out of range");this.r=pr(pr(pr(K[ne],K[oe],j),pr(K[Y],K[ae],j),B),pr(pr(K[me],K[Ee],j),pr(K[Oe],K[Be],j),B),R)/255*h,this.g=pr(pr(pr(K[ne+1],K[oe+1],j),pr(K[Y+1],K[ae+1],j),B),pr(pr(K[me+1],K[Ee+1],j),pr(K[Oe+1],K[Be+1],j),B),R)/255*h,this.b=pr(pr(pr(K[ne+2],K[oe+2],j),pr(K[Y+2],K[ae+2],j),B),pr(pr(K[me+2],K[Ee+2],j),pr(K[Oe+2],K[Be+2],j),B),R)/255*h,this.a=h}else this.r=s,this.g=u,this.b=g,this.a=h}toArray(){const{r:n,g:s,b:u,a:g}=this;return g===0?[0,0,0,0]:[255*n/g,255*s/g,255*u/g,g]}toArray01(){const{r:n,g:s,b:u,a:g}=this;return g===0?[0,0,0,0]:[n/g,s/g,u/g,g]}toArray01Scaled(n){const{r:s,g:u,b:g,a:h}=this;return h===0?[0,0,0]:[s/h*n,u/h*n,g/h*n]}toArray01PremultipliedAlpha(){const{r:n,g:s,b:u,a:g}=this;return[n,s,u,g]}toArray01Linear(){const{r:n,g:s,b:u,a:g}=this;return g===0?[0,0,0,0]:[Math.pow(n/g,2.2),Math.pow(s/g,2.2),Math.pow(u/g,2.2),g]}}function pr(c,n,s){return c*(1-s)+n*s}function vd(c,n,s){return c.map((u,g)=>pr(u,n[g],s))}co.black=new co(0,0,0,1),co.white=new co(1,1,1,1),co.transparent=new co(0,0,0,0),co.red=new co(1,0,0,1),co.blue=new co(0,0,1,1);var ic=Object.freeze({__proto__:null,array:vd,color:function(c,n,s){return new co(pr(c.r,n.r,s),pr(c.g,n.g,s),pr(c.b,n.b,s),pr(c.a,n.a,s))},number:pr});function Hc(c,...n){for(const s of n)for(const u in s)c[u]=s[u];return c}class xa extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}class Uh{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[u,g]of s)this.bindings[u]=g}concat(n){return new Uh(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const na={kind:"null"},qn={kind:"number"},qr={kind:"string"},Kr={kind:"boolean"},as={kind:"color"},$i={kind:"object"},Jr={kind:"value"},jh={kind:"collator"},Gc={kind:"formatted"},Wc={kind:"resolvedImage"};function Ki(c,n){return{kind:"array",itemType:c,N:n}}function Qo(c){if(c.kind==="array"){const n=Qo(c.itemType);return typeof c.N=="number"?`array<${n}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${n}>`}return c.kind}const f_=[na,qn,qr,Kr,as,Gc,$i,Ki(Jr),Wc];function qc(c,n){if(n.kind==="error")return null;if(c.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!qc(c.itemType,n.itemType))&&(typeof c.N!="number"||c.N===n.N))return null}else{if(c.kind===n.kind)return null;if(c.kind==="value"){for(const s of f_)if(!qc(s,n))return null}}return`Expected ${Qo(c)} but found ${Qo(n)} instead.`}function Kc(c,n){return n.some(s=>s.kind===c.kind)}function wa(c,n){return n.some(s=>s==="null"?c===null:s==="array"?Array.isArray(c):s==="object"?c&&!Array.isArray(c)&&typeof c=="object":s===typeof c)}class Hh{constructor(n,s,u){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class xs{constructor(n,s,u,g,h){this.text=n.normalize?n.normalize():n,this.image=s,this.scale=u,this.fontStack=g,this.textColor=h}}class Vi{constructor(n){this.sections=n}static fromString(n){return new Vi([new xs(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.namePrimary.length!==0)}static factory(n){return n instanceof Vi?n:Vi.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const s of this.sections){if(s.image){n.push(["image",s.image.namePrimary]);continue}n.push(s.text);const u={};s.fontStack&&(u["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(u["font-scale"]=s.scale),s.textColor&&(u["text-color"]=["rgba"].concat(s.textColor.toRenderColor(null).toArray())),n.push(u)}return n}}class Zi{constructor(n){this.namePrimary=n.namePrimary,n.nameSecondary&&(this.nameSecondary=n.nameSecondary),this.available=n.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(n,s){return n?new Zi({namePrimary:n,nameSecondary:s,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function p_(c,n,s,u){return typeof c=="number"&&c>=0&&c<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[c,n,s,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[c,n,s,u]:[c,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Cl(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof co||c instanceof Hh||c instanceof Vi||c instanceof Zi)return!0;if(Array.isArray(c)){for(const n of c)if(!Cl(n))return!1;return!0}if(typeof c=="object"){for(const n in c)if(!Cl(c[n]))return!1;return!0}return!1}function ci(c){if(c===null)return na;if(typeof c=="string")return qr;if(typeof c=="boolean")return Kr;if(typeof c=="number")return qn;if(c instanceof co)return as;if(c instanceof Hh)return jh;if(c instanceof Vi)return Gc;if(c instanceof Zi)return Wc;if(Array.isArray(c)){const n=c.length;let s;for(const u of c){const g=ci(u);if(s){if(s===g)continue;s=Jr;break}s=g}return Ki(s||Jr,n)}return $i}function Yi(c){const n=typeof c;return c===null?"":n==="string"||n==="number"||n==="boolean"?String(c):c instanceof co||c instanceof Vi||c instanceof Zi?c.toString():JSON.stringify(c)}class ra{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Cl(n[1]))return s.error("invalid value");const u=n[1];let g=ci(u);const h=s.expectedType;return g.kind!=="array"||g.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(g=h),new ra(g,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof co?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Vi?this.value.serialize():this.value}}class yi{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const hm={string:qr,number:qn,boolean:Kr,object:$i};class oa{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let u,g=1;const h=n[0];if(h==="array"){let T,P;if(n.length>2){const L=n[1];if(typeof L!="string"||!(L in hm)||L==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);T=hm[L],g++}else T=Jr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);P=n[2],g++}u=Ki(T,P)}else u=hm[h];const v=[];for(;g<n.length;g++){const T=s.parse(n[g],g,Jr);if(!T)return null;v.push(T)}return new oa(u,v)}evaluate(n){for(let s=0;s<this.args.length;s++){const u=this.args[s].evaluate(n);if(!qc(this.type,ci(u)))return u;if(s===this.args.length-1)throw new yi(`The expression ${JSON.stringify(this.args[s].serialize())} evaluated to ${Qo(ci(u))} but was expected to be of type ${Qo(this.type)}.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,s=[n.kind];if(n.kind==="array"){const u=n.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){s.push(u.kind);const g=n.N;(typeof g=="number"||this.args.length>1)&&s.push(g)}}return s.concat(this.args.map(u=>u.serialize()))}}class Zc{constructor(n){this.type=Gc,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return s.error("First argument must be an image or text section.");const g=[];let h=!1;for(let v=1;v<=n.length-1;++v){const T=n[v];if(h&&typeof T=="object"&&!Array.isArray(T)){h=!1;let P=null;if(T["font-scale"]&&(P=s.parseObjectValue(T["font-scale"],v,"font-scale",qn),!P))return null;let L=null;if(T["text-font"]&&(L=s.parseObjectValue(T["text-font"],v,"text-font",Ki(qr)),!L))return null;let w=null;if(T["text-color"]&&(w=s.parseObjectValue(T["text-color"],v,"text-color",as),!w))return null;const M=g[g.length-1];M.scale=P,M.font=L,M.textColor=w}else{const P=s.parse(n[v],v,Jr);if(!P)return null;const L=P.type.kind;if(L!=="string"&&L!=="value"&&L!=="null"&&L!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,g.push({content:P,scale:null,font:null,textColor:null})}}return new Zc(g)}evaluate(n){return new Vi(this.sections.map(s=>{const u=s.content.evaluate(n);return ci(u)===Wc?new xs("",u,null,null,null):new xs(Yi(u),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const s of this.sections){n.push(s.content.serialize());const u={};s.scale&&(u["font-scale"]=s.scale.serialize()),s.font&&(u["text-font"]=s.font.serialize()),s.textColor&&(u["text-color"]=s.textColor.serialize()),n.push(u)}return n}}class sc{constructor(n,s){this.type=Wc,this.inputPrimary=n,this.inputSecondary=s}static parse(n,s){if(n.length<2)return s.error("Expected two or more arguments.");const u=s.parse(n[1],1,qr);if(!u)return s.error("No image name provided.");if(n.length===2)return new sc(u);const g=s.parse(n[2],1,qr);return g?new sc(u,g):s.error("Secondary image variant is not a string.")}evaluate(n){const s=Zi.fromString(this.inputPrimary.evaluate(n),this.inputSecondary?this.inputSecondary.evaluate(n):void 0);return s&&n.availableImages&&(s.available=n.availableImages.indexOf(s.namePrimary)>-1,s.nameSecondary&&s.available&&n.availableImages&&(s.available=n.availableImages.indexOf(s.nameSecondary)>-1)),s}eachChild(n){n(this.inputPrimary),this.inputSecondary&&n(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function ac(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}const Gh={"to-boolean":Kr,"to-color":as,"to-number":qn,"to-string":qr};class Wa{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const u=n[0],g=[];let h=na;if(u==="to-array"){if(!Array.isArray(n[1]))return null;const v=n[1].length;if(s.expectedType){if(s.expectedType.kind!=="array")return s.error(`Expected ${s.expectedType.kind} but found array.`);h=Ki(s.expectedType.itemType,v)}else{if(!(v>0&&Cl(n[1][0])))return null;h=Ki(ci(n[1][0]),v)}for(let T=0;T<v;T++){const P=n[1][T];let L;if(ac(P)==="array")L=s.parse(P,void 0,h.itemType);else{const w=ac(P);if(w!==h.itemType.kind)return s.error(`Expected ${h.itemType.kind} but found ${w}.`);L=s.registry.literal.parse(["literal",P===void 0?null:P],s)}if(!L)return null;g.push(L)}}else{if((u==="to-boolean"||u==="to-string")&&n.length!==2)return s.error("Expected one argument.");h=Gh[u];for(let v=1;v<n.length;v++){const T=s.parse(n[v],v,Jr);if(!T)return null;g.push(T)}}return new Wa(h,g)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let s,u;for(const g of this.args){if(s=g.evaluate(n),u=null,s instanceof co)return s;if(typeof s=="string"){const h=n.parseColor(s);if(h)return h}else if(Array.isArray(s)&&(u=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:p_(s[0],s[1],s[2],s[3]),!u))return new co(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new yi(u||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const u of this.args){if(s=u.evaluate(n),s===null)return 0;const g=Number(s);if(!isNaN(g))return g}throw new yi(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?Vi.fromString(Yi(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?Zi.fromString(Yi(this.args[0].evaluate(n))):this.type.kind==="array"?this.args.map(s=>s.evaluate(n)):Yi(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Zc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new sc(this.args[0]).serialize();const n=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(s=>{n.push(s.serialize())}),n}}const h1=["Unknown","Point","LineString","Polygon"];class m_{constructor(n,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=n,this.options=s}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?h1[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:u,y:g}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*s-n[0])+this.featureDistanceData.bearing[1]*(g*s-n[1])}return 0}parseColor(n){let s=this._parseColorCache[n];return s||(s=this._parseColorCache[n]=co.parse(n)),s}getConfig(n){return this.options?this.options.get(n):null}}class ls{constructor(n,s,u,g,h){this.name=n,this.type=s,this._evaluate=u,this.args=g,this._overloadIndex=h}evaluate(n){if(!this._evaluate){const s=ls.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,s){const u=n[0],g=ls.definitions[u];if(!g)return s.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(g)?g[0]:g.type,v=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,T=[];let P=null,L=-1;for(const[w,M]of v){if(Array.isArray(w)&&w.length!==n.length-1)continue;T.push(w),L++,P=new M_(s.registry,s.path,null,s.scope,void 0,s._scope,s.options);const D=[];let I=!1;for(let R=1;R<n.length;R++){const B=n[R],j=Array.isArray(w)?w[R-1]:w.type,K=P.parse(B,1+D.length,j);if(!K){I=!0;break}D.push(K)}if(!I)if(Array.isArray(w)&&w.length!==D.length)P.error(`Expected ${w.length} arguments, but found ${D.length} instead.`);else{for(let R=0;R<D.length;R++){const B=Array.isArray(w)?w[R]:w.type,j=D[R];P.concat(R+1).checkSubtype(B,j.type)}if(P.errors.length===0)return new ls(u,h,M,D,L)}}if(T.length===1)s.errors.push(...P.errors);else{const w=(T.length?T:v.map(([D])=>D)).map(f1).join(" | "),M=[];for(let D=1;D<n.length;D++){const I=s.parse(n[D],1+M.length);if(!I)return null;M.push(Qo(I.type))}s.error(`Expected arguments of type ${w}, but found (${M.join(", ")}) instead.`)}return null}static register(n,s){ls.definitions=s;for(const u in s)n[u]=ls}}function f1(c){return Array.isArray(c)?`(${c.map(Qo).join(", ")})`:`(${Qo(c.type)}...)`}class Wh{constructor(n,s,u){this.type=jh,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return s.error("Collator options argument must be an object.");const g=u["case-sensitive"]===void 0?s.parse(!1,1,Kr):s.parseObjectValue(u["case-sensitive"],1,"case-sensitive",Kr);if(!g)return null;const h=u["diacritic-sensitive"]===void 0?s.parse(!1,1,Kr):s.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",Kr);if(!h)return null;let v=null;return u.locale&&(v=s.parseObjectValue(u.locale,1,"locale",qr),!v)?null:new Wh(g,h,v)}evaluate(n){return new Hh(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}function g_(c,n,s=0,u=c.length-1,g=Xc){for(;u>s;){if(u-s>600){const P=u-s+1,L=n-s+1,w=Math.log(P),M=.5*Math.exp(2*w/3),D=.5*Math.sqrt(w*M*(P-M)/P)*(L-P/2<0?-1:1);g_(c,n,Math.max(s,Math.floor(n-L*M/P+D)),Math.min(u,Math.floor(n+(P-L)*M/P+D)),g)}const h=c[n];let v=s,T=u;for(Yc(c,s,n),g(c[u],h)>0&&Yc(c,s,u);v<T;){for(Yc(c,v,T),v++,T--;g(c[v],h)<0;)v++;for(;g(c[T],h)>0;)T--}g(c[s],h)===0?Yc(c,s,T):(T++,Yc(c,T,u)),T<=n&&(s=T+1),n<=T&&(u=T-1)}}function Yc(c,n,s){const u=c[n];c[n]=c[s],c[s]=u}function Xc(c,n){return c<n?-1:c>n?1:0}function p1(c){let n=0;for(let s,u,g=0,h=c.length,v=h-1;g<h;v=g++)s=c[g],u=c[v],n+=(u.x-s.x)*(s.y+u.y);return n}function _d(c,n){c[0]=Math.min(c[0],n[0]),c[1]=Math.min(c[1],n[1]),c[2]=Math.max(c[2],n[0]),c[3]=Math.max(c[3],n[1])}function lc(c,n){return!(c[0]<=n[0]||c[2]>=n[2]||c[1]<=n[1]||c[3]>=n[3])}function m1(c,n,s){const u=c[0]-n[0],g=c[1]-n[1],h=c[0]-s[0],v=c[1]-s[1];return u*v-h*g==0&&u*h<=0&&g*v<=0}function Jc(c,n,s=!1){let u=!1;for(let T=0,P=n.length;T<P;T++){const L=n[T];for(let w=0,M=L.length,D=M-1;w<M;D=w++){const I=L[D],R=L[w];if(m1(c,I,R))return s;(h=I)[1]>(g=c)[1]!=(v=R)[1]>g[1]&&g[0]<(v[0]-h[0])*(g[1]-h[1])/(v[1]-h[1])+h[0]&&(u=!u)}}var g,h,v;return u}function v_(c,n,s,u){const g=u[0]-s[0],h=u[1]-s[1],v=(c[0]-s[0])*h-g*(c[1]-s[1]),T=(n[0]-s[0])*h-g*(n[1]-s[1]);return v>0&&T<0||v<0&&T>0}function qh(c,n,s,u){return(g=[u[0]-s[0],u[1]-s[1]])[0]*(h=[n[0]-c[0],n[1]-c[1]])[1]-g[1]*h[0]!=0&&!(!v_(c,n,s,u)||!v_(s,u,c,n));var g,h}const ws=8192;function Ur(c,n){const s=(180+c[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,g=Math.pow(2,n.z);return[Math.round(s*g*ws),Math.round(u*g*ws)]}function or(c,n){for(let s=0;s<n.length;s++)if(Jc(c,n[s]))return!0;return!1}function fm(c,n,s){for(const u of s)for(let g=0,h=u.length,v=h-1;g<h;v=g++)if(qh(c,n,u[v],u[g]))return!0;return!1}function Mr(c,n){for(let s=0;s<c.length;++s)if(!Jc(c[s],n))return!1;for(let s=0;s<c.length-1;++s)if(fm(c[s],c[s+1],n))return!1;return!0}function pm(c,n){for(let s=0;s<n.length;s++)if(Mr(c,n[s]))return!0;return!1}function yd(c,n,s){const u=[];for(let g=0;g<c.length;g++){const h=[];for(let v=0;v<c[g].length;v++){const T=Ur(c[g][v],s);_d(n,T),h.push(T)}u.push(h)}return u}function yr(c,n,s){const u=[];for(let g=0;g<c.length;g++){const h=yd(c[g],n,s);u.push(h)}return u}function mm(c,n,s,u){if(c[0]<s[0]||c[0]>s[2]){const g=.5*u;let h=c[0]-s[0]>g?-u:s[0]-c[0]>g?u:0;h===0&&(h=c[0]-s[2]>g?-u:s[2]-c[0]>g?u:0),c[0]+=h}_d(n,c)}function Kh(c,n,s,u){const g=Math.pow(2,u.z)*ws,h=[u.x*ws,u.y*ws],v=[];if(!c)return v;for(const T of c)for(const P of T){const L=[P.x+h[0],P.y+h[1]];mm(L,n,s,g),v.push(L)}return v}function gm(c,n,s,u){const g=Math.pow(2,u.z)*ws,h=[u.x*ws,u.y*ws],v=[];if(!c)return v;for(const P of c){const L=[];for(const w of P){const M=[w.x+h[0],w.y+h[1]];_d(n,M),L.push(M)}v.push(L)}if(n[2]-n[0]<=g/2){(T=n)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const P of v)for(const L of P)mm(L,n,s,g)}var T;return v}class El{constructor(n,s){this.type=Kr,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Cl(n[1])){const u=n[1];if(u.type==="FeatureCollection")for(let g=0;g<u.features.length;++g){const h=u.features[g].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new El(u,u.features[g].geometry)}else if(u.type==="Feature"){const g=u.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new El(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new El(u,u)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,u){const g=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const T=yd(u.coordinates,h,v),P=Kh(s.geometry(),g,h,v);if(!lc(g,h))return!1;for(const L of P)if(!Jc(L,T))return!1}if(u.type==="MultiPolygon"){const T=yr(u.coordinates,h,v),P=Kh(s.geometry(),g,h,v);if(!lc(g,h))return!1;for(const L of P)if(!or(L,T))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,u){const g=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const T=yd(u.coordinates,h,v),P=gm(s.geometry(),g,h,v);if(!lc(g,h))return!1;for(const L of P)if(!Mr(L,T))return!1}if(u.type==="MultiPolygon"){const T=yr(u.coordinates,h,v),P=gm(s.geometry(),g,h,v);if(!lc(g,h))return!1;for(const L of P)if(!pm(L,T))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const cc={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Pi=1/298.257223563,Zh=Pi*(2-Pi),Qc=Math.PI/180;class eu{static fromTile(n,s,u){const g=Math.PI*(1-2*(n+.5)/Math.pow(2,s)),h=Math.atan(.5*(Math.exp(g)-Math.exp(-g)))/Qc;return new eu(h,u)}static get units(){return cc}constructor(n,s){if(n===void 0)throw new Error("No latitude given.");if(s&&!cc[s])throw new Error(`Unknown unit ${s}. Use one of: ${Object.keys(cc).join(", ")}`);const u=6378.137*Qc*(s?cc[s]:1),g=Math.cos(n*Qc),h=1/(1-Zh*(1-g*g)),v=Math.sqrt(h);this.kx=u*v*g,this.ky=u*v*h*(1-Zh)}distance(n,s){const u=Go(n[0]-s[0])*this.kx,g=(n[1]-s[1])*this.ky;return Math.sqrt(u*u+g*g)}bearing(n,s){const u=Go(s[0]-n[0])*this.kx;return Math.atan2(u,(s[1]-n[1])*this.ky)/Qc}destination(n,s,u){const g=u*Qc;return this.offset(n,Math.sin(g)*s,Math.cos(g)*s)}offset(n,s,u){return[n[0]+s/this.kx,n[1]+u/this.ky]}lineDistance(n){let s=0;for(let u=0;u<n.length-1;u++)s+=this.distance(n[u],n[u+1]);return s}area(n){let s=0;for(let u=0;u<n.length;u++){const g=n[u];for(let h=0,v=g.length,T=v-1;h<v;T=h++)s+=Go(g[h][0]-g[T][0])*(g[h][1]+g[T][1])*(u?-1:1)}return Math.abs(s)/2*this.kx*this.ky}along(n,s){let u=0;if(s<=0)return n[0];for(let g=0;g<n.length-1;g++){const h=n[g],v=n[g+1],T=this.distance(h,v);if(u+=T,u>s)return qa(h,v,(s-(u-T))/T)}return n[n.length-1]}pointToSegmentDistance(n,s,u){let[g,h]=s,v=Go(u[0]-g)*this.kx,T=(u[1]-h)*this.ky;if(v!==0||T!==0){const P=(Go(n[0]-g)*this.kx*v+(n[1]-h)*this.ky*T)/(v*v+T*T);P>1?(g=u[0],h=u[1]):P>0&&(g+=v/this.kx*P,h+=T/this.ky*P)}return v=Go(n[0]-g)*this.kx,T=(n[1]-h)*this.ky,Math.sqrt(v*v+T*T)}pointOnLine(n,s){let u=1/0,g=n[0][0],h=n[0][1],v=0,T=0;for(let P=0;P<n.length-1;P++){let L=n[P][0],w=n[P][1],M=Go(n[P+1][0]-L)*this.kx,D=(n[P+1][1]-w)*this.ky,I=0;M===0&&D===0||(I=(Go(s[0]-L)*this.kx*M+(s[1]-w)*this.ky*D)/(M*M+D*D),I>1?(L=n[P+1][0],w=n[P+1][1]):I>0&&(L+=M/this.kx*I,w+=D/this.ky*I)),M=Go(s[0]-L)*this.kx,D=(s[1]-w)*this.ky;const R=M*M+D*D;R<u&&(u=R,g=L,h=w,v=P,T=I)}return{point:[g,h],index:v,t:Math.max(0,Math.min(1,T))}}lineSlice(n,s,u){let g=this.pointOnLine(u,n),h=this.pointOnLine(u,s);if(g.index>h.index||g.index===h.index&&g.t>h.t){const L=g;g=h,h=L}const v=[g.point],T=g.index+1,P=h.index;!Yh(u[T],v[0])&&T<=P&&v.push(u[T]);for(let L=T+1;L<=P;L++)v.push(u[L]);return Yh(u[P],h.point)||v.push(h.point),v}lineSliceAlong(n,s,u){let g=0;const h=[];for(let v=0;v<u.length-1;v++){const T=u[v],P=u[v+1],L=this.distance(T,P);if(g+=L,g>n&&h.length===0&&h.push(qa(T,P,(n-(g-L))/L)),g>=s)return h.push(qa(T,P,(s-(g-L))/L)),h;g>n&&h.push(P)}return h}bufferPoint(n,s){const u=s/this.ky,g=s/this.kx;return[n[0]-g,n[1]-u,n[0]+g,n[1]+u]}bufferBBox(n,s){const u=s/this.ky,g=s/this.kx;return[n[0]-g,n[1]-u,n[2]+g,n[3]+u]}insideBBox(n,s){return Go(n[0]-s[0])>=0&&Go(n[0]-s[2])<=0&&n[1]>=s[1]&&n[1]<=s[3]}}function Yh(c,n){return c[0]===n[0]&&c[1]===n[1]}function qa(c,n,s){const u=Go(n[0]-c[0]);return[c[0]+u*s,c[1]+(n[1]-c[1])*s]}function Go(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class vm{constructor(n=[],s=(u,g)=>u<g?-1:u>g?1:0){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:u}=this,g=s[n];for(;n>0;){const h=n-1>>1,v=s[h];if(u(g,v)>=0)break;s[n]=v,n=h}s[n]=g}_down(n){const{data:s,compare:u}=this,g=this.length>>1,h=s[n];for(;n<g;){let v=1+(n<<1);const T=v+1;if(T<this.length&&u(s[T],s[v])<0&&(v=T),u(s[v],h)>=0)break;s[n]=s[v],n=v}s[n]=h}}var An=8192;function __(c,n){return n.dist-c.dist}const tu=100,Xh=50;function Jh(c){const n=[1/0,1/0,-1/0,-1/0];if(n.length!==c.length)return!1;for(let s=0;s<n.length;s++)if(n[s]!==c[s])return!1;return!0}function Qh(c){return c[1]-c[0]+1}function Ka(c,n){const s=c[1]>=c[0]&&c[1]<n;return s||console.warn("Distance Expression: Index is out of range"),s}function _m(c,n){if(c[0]>c[1])return[null,null];const s=Qh(c);if(n){if(s===2)return[c,null];const u=Math.floor(s/2);return[[c[0],c[0]+u],[c[0]+u,c[1]]]}{if(s===1)return[c,null];const u=Math.floor(s/2)-1;return[[c[0],c[0]+u],[c[0]+u+1,c[1]]]}}function Ss(c,n){const s=[1/0,1/0,-1/0,-1/0];if(!Ka(n,c.length))return s;for(let u=n[0];u<=n[1];++u)_d(s,c[u]);return s}function ef(c){const n=[1/0,1/0,-1/0,-1/0];for(let s=0;s<c.length;++s)for(let u=0;u<c[s].length;++u)_d(n,c[s][u]);return n}function nu(c,n,s){if(Jh(c)||Jh(n))return NaN;let u=0,g=0;return c[2]<n[0]&&(u=n[0]-c[2]),c[0]>n[2]&&(u=c[0]-n[2]),c[1]>n[3]&&(g=c[1]-n[3]),c[3]<n[1]&&(g=n[1]-c[3]),s.distance([0,0],[u,g])}function y_(c){return 360*c-180}function b_(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Ts(c,n){const s=Math.pow(2,n.z),u=(c.y/An+n.y)/s;return[y_((c.x/An+n.x)/s),b_(u)]}function x_(c,n){const s=[];for(let u=0;u<c.length;++u)s.push(Ts(c[u],n));return s}function ym(c,n,s){const u=s.pointOnLine(n,c).point;return s.distance(c,u)}function bm(c,n,s,u,g){const h=s.slice(u[0],u[1]+1);let v=1/0;for(let T=n[0];T<=n[1];++T)if((v=Math.min(v,ym(c[T],h,g)))===0)return 0;return v}function tf(c,n,s,u,g){const h=Math.min(g.pointToSegmentDistance(c,s,u),g.pointToSegmentDistance(n,s,u)),v=Math.min(g.pointToSegmentDistance(s,c,n),g.pointToSegmentDistance(u,c,n));return Math.min(h,v)}function w_(c,n,s,u,g){if(!Ka(n,c.length)||!Ka(u,s.length))return NaN;let h=1/0;for(let v=n[0];v<n[1];++v)for(let T=u[0];T<u[1];++T){if(qh(c[v],c[v+1],s[T],s[T+1]))return 0;h=Math.min(h,tf(c[v],c[v+1],s[T],s[T+1],g))}return h}function S_(c,n,s,u,g){if(!Ka(n,c.length)||!Ka(u,s.length))return NaN;let h=1/0;for(let v=n[0];v<=n[1];++v)for(let T=u[0];T<=u[1];++T)if((h=Math.min(h,g.distance(c[v],s[T])))===0)return h;return h}function T_(c,n,s){if(Jc(c,n,!0))return 0;let u=1/0;for(const g of n){const h=g.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(g[0]!==g[h-1]&&(u=Math.min(u,s.pointToSegmentDistance(c,g[h-1],g[0])))===0||(u=Math.min(u,ym(c,g,s)))===0)return u}return u}function C_(c,n,s,u){if(!Ka(n,c.length))return NaN;for(let h=n[0];h<=n[1];++h)if(Jc(c[h],s,!0))return 0;let g=1/0;for(let h=n[0];h<n[1];++h)for(const v of s)for(let T=0,P=v.length,L=P-1;T<P;L=T++){if(qh(c[h],c[h+1],v[L],v[T]))return 0;g=Math.min(g,tf(c[h],c[h+1],v[L],v[T],u))}return g}function xm(c,n){for(const s of c)for(let u=0;u<=s.length-1;++u)if(Jc(s[u],n,!0))return!0;return!1}function E_(c,n,s,u=1/0){const g=ef(c),h=ef(n);if(u!==1/0&&nu(g,h,s)>=u)return u;if(lc(g,h)){if(xm(c,n))return 0}else if(xm(n,c))return 0;let v=u;for(const T of c)for(let P=0,L=T.length,w=L-1;P<L;w=P++)for(const M of n)for(let D=0,I=M.length,R=I-1;D<I;R=D++){if(qh(T[w],T[P],M[R],M[D]))return 0;v=Math.min(v,tf(T[w],T[P],M[R],M[D],s))}return v}function bd(c,n,s,u,g,h,v){if(h===null||v===null)return;const T=nu(Ss(u,h),Ss(g,v),s);T<n&&c.push({dist:T,range1:h,range2:v})}function nf(c,n,s,u,g=1/0){let h=Math.min(u.distance(c[0],s[0][0]),g);if(h===0)return h;const v=new vm([{dist:0,range1:[0,c.length-1],range2:[0,0]}],__),T=n?Xh:tu,P=ef(s);for(;v.length;){const L=v.pop();if(L.dist>=h)continue;const w=L.range1;if(Qh(w)<=T){if(!Ka(w,c.length))return NaN;if(n){const M=C_(c,w,s,u);if((h=Math.min(h,M))===0)return h}else for(let M=w[0];M<=w[1];++M){const D=T_(c[M],s,u);if((h=Math.min(h,D))===0)return h}}else{const M=_m(w,n);if(M[0]!==null){const D=nu(Ss(c,M[0]),P,u);D<h&&v.push({dist:D,range1:M[0],range2:[0,0]})}if(M[1]!==null){const D=nu(Ss(c,M[1]),P,u);D<h&&v.push({dist:D,range1:M[1],range2:[0,0]})}}}return h}function xd(c,n,s,u,g,h=1/0){let v=Math.min(h,g.distance(c[0],s[0]));if(v===0)return v;const T=new vm([{dist:0,range1:[0,c.length-1],range2:[0,s.length-1]}],__),P=n?Xh:tu,L=u?Xh:tu;for(;T.length;){const w=T.pop();if(w.dist>=v)continue;const M=w.range1,D=w.range2;if(Qh(M)<=P&&Qh(D)<=L){if(!Ka(M,c.length)||!Ka(D,s.length))return NaN;if(n&&u?v=Math.min(v,w_(c,M,s,D,g)):n||u?n&&!u?v=Math.min(v,bm(s,D,c,M,g)):!n&&u&&(v=Math.min(v,bm(c,M,s,D,g))):v=Math.min(v,S_(c,M,s,D,g)),v===0)return v}else{const I=_m(M,n),R=_m(D,u);bd(T,v,g,c,s,I[0],R[0]),bd(T,v,g,c,s,I[0],R[1]),bd(T,v,g,c,s,I[1],R[0]),bd(T,v,g,c,s,I[1],R[1])}}return v}function ru(c,n,s,u,g=1/0){let h=g;const v=Ss(c,[0,c.length-1]);for(const T of s)if(!(h!==1/0&&nu(v,Ss(T,[0,T.length-1]),u)>=h)&&(h=Math.min(h,xd(c,n,T,!0,u,h)),h===0))return h;return h}function wd(c,n,s,u,g=1/0){let h=g;const v=Ss(c,[0,c.length-1]);for(const T of s){if(h!==1/0&&nu(v,ef(T),u)>=h)continue;const P=nf(c,n,T,u,h);if(isNaN(P))return P;if((h=Math.min(h,P))===0)return h}return h}function rf(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class Ml{constructor(n,s){this.type=qn,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'distance' expression requires either one argument, but found ' ${n.length-1} instead.`);if(Cl(n[1])){const u=n[1];if(u.type==="FeatureCollection"){for(let g=0;g<u.features.length;++g)if(rf(u.features[g].geometry.type))return new Ml(u,u.features[g].geometry)}else if(u.type==="Feature"){if(rf(u.geometry.type))return new Ml(u,u.geometry)}else if(rf(u.type))return new Ml(u,u)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(n){const s=n.geometry(),u=n.canonicalID();if(s!=null&&u!=null){if(n.geometryType()==="Point")return function(g,h,v){const T=[];for(const L of g)for(const w of L)T.push(Ts(w,h));const P=new eu(T[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?xd(T,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",P):v.type==="MultiLineString"?ru(T,!1,v.coordinates,P):v.type==="Polygon"||v.type==="MultiPolygon"?wd(T,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,P):null}(s,u,this.geometries);if(n.geometryType()==="LineString")return function(g,h,v){const T=[];for(const L of g){const w=[];for(const M of L)w.push(Ts(M,h));T.push(w)}const P=new eu(T[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return ru(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,P);if(v.type==="MultiLineString"){let L=1/0;for(let w=0;w<v.coordinates.length;w++){const M=ru(v.coordinates[w],!0,T,P,L);if(isNaN(M))return M;if((L=Math.min(L,M))===0)return L}return L}if(v.type==="Polygon"||v.type==="MultiPolygon"){let L=1/0;for(let w=0;w<T.length;w++){const M=wd(T[w],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,P,L);if(isNaN(M))return M;if((L=Math.min(L,M))===0)return L}return L}return null}(s,u,this.geometries);if(n.geometryType()==="Polygon")return function(g,h,v){const T=[];for(const L of function(w,M){const D=w.length;if(D<=1)return[w];const I=[];let R,B;for(let j=0;j<D;j++){const K=p1(w[j]);K!==0&&(w[j].area=Math.abs(K),B===void 0&&(B=K<0),B===K<0?(R&&I.push(R),R=[w[j]]):R.push(w[j]))}return R&&I.push(R),I}(g)){const w=[];for(let M=0;M<L.length;++M)w.push(x_(L[M],h));T.push(w)}const P=new eu(T[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return wd(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,P);if(v.type==="MultiLineString"){let L=1/0;for(let w=0;w<v.coordinates.length;w++){const M=wd(v.coordinates[w],!0,T,P,L);if(isNaN(M))return M;if((L=Math.min(L,M))===0)return L}return L}return v.type==="Polygon"||v.type==="MultiPolygon"?function(L,w,M){let D=1/0;for(const I of L)for(const R of w){const B=E_(I,R,M,D);if(isNaN(B))return B;if((D=Math.min(D,B))===0)return D}return D}(v.type==="Polygon"?[v.coordinates]:v.coordinates,T,P):null}(s,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Il(c,n){switch(c){case"string":return Yi(n);case"number":return+n;case"boolean":return!!n;case"color":return co.parse(n);case"formatted":return Vi.fromString(Yi(n));case"resolvedImage":return Zi.fromString(Yi(n))}return n}function Zr(c,n,s,u){return u!==void 0&&(c=u*Math.round(c/u)),n!==void 0&&c<n&&(c=n),s!==void 0&&c>s&&(c=s),c}class ou{constructor(n,s,u){this.type=n,this.key=s,this.scope=u}static parse(n,s){let u=s.expectedType;if(u==null&&(u=Jr),n.length<2||n.length>3)return s.error("Invalid number of arguments for 'config' expression.");const g=s.parse(n[1],1);if(!(g instanceof ra))return s.error("Key name of 'config' expression must be a string literal.");if(n.length>=3){const h=s.parse(n[2],2);return h instanceof ra?new ou(u,Yi(g.value),Yi(h.value)):s.error("Scope of 'config' expression must be a string literal.")}return new ou(u,Yi(g.value))}evaluate(n){const s=[this.key,this.scope,n.scope].filter(Boolean).join(""),u=n.getConfig(s);if(!u)return null;const{type:g,value:h,values:v,minValue:T,maxValue:P,stepValue:L}=u,w=u.default.evaluate(n);let M=w;if(h){const D=n.scope;n.scope=(D||"").split("").slice(1).join(""),M=h.evaluate(n),n.scope=D}return g&&(M=Il(g,M)),M===void 0||T===void 0&&P===void 0&&L===void 0||(typeof M=="number"?M=Zr(M,T,P,L):Array.isArray(M)&&(M=M.map(D=>typeof D=="number"?Zr(D,T,P,L):D))),h!==void 0&&M!==void 0&&v&&!v.includes(M)&&(M=w,g&&(M=Il(g,M))),(g&&g!==this.type||M!==void 0&&ci(M)!==this.type)&&(M=Il(this.type.kind,M)),M}eachChild(){}outputDefined(){return!1}serialize(){const n=["config",this.key];return this.scope&&n.concat(this.key),n}}function Sd(c){if(c instanceof ls&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof El||c instanceof Ml)return!1;let n=!0;return c.eachChild(s=>{n&&!Sd(s)&&(n=!1)}),n}function of(c){if(c instanceof ls&&c.name==="feature-state")return!1;let n=!0;return c.eachChild(s=>{n&&!of(s)&&(n=!1)}),n}function sf(c){if(c instanceof ou)return new Set([c.key]);let n=new Set;return c.eachChild(s=>{n=new Set([...n,...sf(s)])}),n}function Td(c,n){if(c instanceof ls&&n.indexOf(c.name)>=0)return!1;let s=!0;return c.eachChild(u=>{s&&!Td(u,n)&&(s=!1)}),s}class So{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const u=n[1];return s.scope.has(u)?new So(u,s.scope.get(u)):s.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class wm{constructor(n,s=[],u,g=new Uh,h=[],v,T){this.registry=n,this.path=s,this.key=s.map(P=>typeof P=="string"?`['${P}']`:`[${P}]`).join(""),this.scope=g,this.errors=h,this.expectedType=u,this._scope=v,this.options=T}parse(n,s,u,g,h={}){return s||u?this.concat(s,null,u,g)._parse(n,h):this._parse(n,h)}parseObjectValue(n,s,u,g,h,v={}){return this.concat(s,u,g,h)._parse(n,v)}_parse(n,s){function u(g,h,v){return v==="assert"?new oa(h,[g]):v==="coerce"?new Wa(h,[g]):g}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=typeof n[0]=="string"?this.registry[n[0]]:void 0;if(g){let h=g.parse(n,this);if(!h)return null;if(this.expectedType){const v=this.expectedType,T=h.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||T.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(v,T))return null}else h=u(h,v,s.typeAnnotation||"coerce");else h=u(h,v,s.typeAnnotation||"assert")}if(!(h instanceof ra)&&h.type.kind!=="resolvedImage"&&Sm(h)){const v=new m_(this._scope,this.options);try{h=new ra(h.type,h.evaluate(v))}catch(T){return this.error(T.message),null}}return h}return Wa.parse(["to-array",n],this)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,u,g){let h=typeof n=="number"?this.path.concat(n):this.path;h=typeof s=="string"?h.concat(s):h;const v=g?this.scope.concat(g):this.scope;return new wm(this.registry,h,u||null,v,this.errors,this._scope,this.options)}error(n,...s){const u=`${this.key}${s.map(g=>`[${g}]`).join("")}`;this.errors.push(new xa(u,n))}checkSubtype(n,s){const u=qc(n,s);return u&&this.error(u),u}}var M_=wm;function Sm(c){if(c instanceof So)return Sm(c.boundExpression);if(c instanceof ls&&c.name==="error"||c instanceof Wh||c instanceof El||c instanceof Ml||c instanceof ou)return!1;const n=c instanceof Wa||c instanceof oa;let s=!0;return c.eachChild(u=>{s=n?s&&Sm(u):s&&u instanceof ra}),!!s&&Sd(c)&&Td(c,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function af(c,n){const s=c.length-1;let u,g,h=0,v=s,T=0;for(;h<=v;)if(T=Math.floor((h+v)/2),u=c[T],g=c[T+1],u<=n){if(T===s||n<g)return T;h=T+1}else{if(!(u>n))throw new yi("Input is not a number.");v=T-1}return 0}class Cd{constructor(n,s,u){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[g,h]of u)this.labels.push(g),this.outputs.push(h)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const u=s.parse(n[1],1,qn);if(!u)return null;const g=[];let h=null;s.expectedType&&s.expectedType.kind!=="value"&&(h=s.expectedType);for(let v=1;v<n.length;v+=2){const T=v===1?-1/0:n[v],P=n[v+1],L=v,w=v+1;if(typeof T!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(g.length&&g[g.length-1][0]>=T)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',L);const M=s.parse(P,w,h);if(!M)return null;h=h||M.type,g.push([T,M])}return new Cd(h,u,g)}evaluate(n){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(n);const g=this.input.evaluate(n);if(g<=s[0])return u[0].evaluate(n);const h=s.length;return g>=s[h-1]?u[h-1].evaluate(n):u[af(s,g)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&n.push(this.labels[s]),n.push(this.outputs[s].serialize());return n}}const I_=.95047,k_=1.08883,A_=4/29,iu=6/29,P_=3*iu*iu,g1=iu*iu*iu,v1=Math.PI/180,_1=180/Math.PI;function Tm(c){return c>g1?Math.pow(c,1/3):c/P_+A_}function Cm(c){return c>iu?c*c*c:P_*(c-A_)}function Em(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Mm(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function R_(c){const n=Mm(c.r),s=Mm(c.g),u=Mm(c.b),g=Tm((.4124564*n+.3575761*s+.1804375*u)/I_),h=Tm((.2126729*n+.7151522*s+.072175*u)/1);return{l:116*h-16,a:500*(g-h),b:200*(h-Tm((.0193339*n+.119192*s+.9503041*u)/k_)),alpha:c.a}}function D_(c){let n=(c.l+16)/116,s=isNaN(c.a)?n:n+c.a/500,u=isNaN(c.b)?n:n-c.b/200;return n=1*Cm(n),s=I_*Cm(s),u=k_*Cm(u),new co(Em(3.2404542*s-1.5371385*n-.4985314*u),Em(-.969266*s+1.8760108*n+.041556*u),Em(.0556434*s-.2040259*n+1.0572252*u),c.alpha)}function y1(c,n,s){const u=n-c;return c+s*(u>180||u<-180?u-360*Math.round(u/360):u)}const Ed={forward:R_,reverse:D_,interpolate:function(c,n,s){return{l:pr(c.l,n.l,s),a:pr(c.a,n.a,s),b:pr(c.b,n.b,s),alpha:pr(c.alpha,n.alpha,s)}}},Md={forward:function(c){const{l:n,a:s,b:u}=R_(c),g=Math.atan2(u,s)*_1;return{h:g<0?g+360:g,c:Math.sqrt(s*s+u*u),l:n,alpha:c.a}},reverse:function(c){const n=c.h*v1,s=c.c;return D_({l:c.l,a:Math.cos(n)*s,b:Math.sin(n)*s,alpha:c.alpha})},interpolate:function(c,n,s){return{h:y1(c.h,n.h,s),c:pr(c.c,n.c,s),l:pr(c.l,n.l,s),alpha:pr(c.alpha,n.alpha,s)}}};var L_=Object.freeze({__proto__:null,hcl:Md,lab:Ed});class Cs{constructor(n,s,u,g,h){this.type=n,this.operator=s,this.interpolation=u,this.input=g,this.labels=[],this.outputs=[];for(const[v,T]of h)this.labels.push(v),this.outputs.push(T)}static interpolationFactor(n,s,u,g){let h=0;if(n.name==="exponential")h=Im(s,n.base,u,g);else if(n.name==="linear")h=Im(s,1,u,g);else if(n.name==="cubic-bezier"){const v=n.controlPoints;h=new He(v[0],v[1],v[2],v[3]).solve(Im(s,1,u,g))}return h}static parse(n,s){let[u,g,h,...v]=n;if(!Array.isArray(g)||g.length===0)return s.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const L=g[1];if(typeof L!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:L}}else{if(g[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const L=g.slice(1);if(L.length!==4||L.some(w=>typeof w!="number"||w<0||w>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:L}}}if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(h=s.parse(h,2,qn),!h)return null;const T=[];let P=null;u==="interpolate-hcl"||u==="interpolate-lab"?P=as:s.expectedType&&s.expectedType.kind!=="value"&&(P=s.expectedType);for(let L=0;L<v.length;L+=2){const w=v[L],M=v[L+1],D=L+3,I=L+4;if(typeof w!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(T.length&&T[T.length-1][0]>=w)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const R=s.parse(M,I,P);if(!R)return null;P=P||R.type,T.push([w,R])}return P.kind==="number"||P.kind==="color"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new Cs(P,u,g,h,T):s.error(`Type ${Qo(P)} is not interpolatable.`)}evaluate(n){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(n);const g=this.input.evaluate(n);if(g<=s[0])return u[0].evaluate(n);const h=s.length;if(g>=s[h-1])return u[h-1].evaluate(n);const v=af(s,g),T=Cs.interpolationFactor(this.interpolation,g,s[v],s[v+1]),P=u[v].evaluate(n),L=u[v+1].evaluate(n);return this.operator==="interpolate"?ic[this.type.kind.toLowerCase()](P,L,T):this.operator==="interpolate-hcl"?Md.reverse(Md.interpolate(Md.forward(P),Md.forward(L),T)):Ed.reverse(Ed.interpolate(Ed.forward(P),Ed.forward(L),T))}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,n,this.input.serialize()];for(let u=0;u<this.labels.length;u++)s.push(this.labels[u],this.outputs[u].serialize());return s}}function Im(c,n,s,u){const g=u-s,h=c-s;return g===0?0:n===1?h/g:(Math.pow(n,h)-1)/(Math.pow(n,g)-1)}class lf{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let u=null;const g=s.expectedType;g&&g.kind!=="value"&&(u=g);const h=[];for(const T of n.slice(1)){const P=s.parse(T,1+h.length,u,void 0,{typeAnnotation:"omit"});if(!P)return null;u=u||P.type,h.push(P)}const v=g&&h.some(T=>qc(g,T.type));return new lf(v?Jr:u,h)}evaluate(n){let s,u=null,g=0;for(const h of this.args){if(g++,u=h.evaluate(n),u&&u instanceof Zi&&!u.available&&(s||(s=u),u=null,g===this.args.length))return s;if(u!==null)break}return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class cf{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let h=1;h<n.length-1;h+=2){const v=n[h];if(typeof v!="string")return s.error(`Expected string, but found ${typeof v} instead.`,h);if(/[^a-zA-Z0-9_]/.test(v))return s.error("Variable names must contain only alphanumeric characters or '_'.",h);const T=s.parse(n[h+1],h+1);if(!T)return null;u.push([v,T])}const g=s.parse(n[n.length-1],n.length-1,s.expectedType,u);return g?new cf(u,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[s,u]of this.bindings)n.push(s,u.serialize());return n.push(this.result.serialize()),n}}class km{constructor(n,s,u){this.type=n,this.index=s,this.input=u}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,qn),g=s.parse(n[2],2,Ki(s.expectedType||Jr));return u&&g?new km(g.type.itemType,u,g):null}evaluate(n){const s=this.index.evaluate(n),u=this.input.evaluate(n);if(s<0)throw new yi(`Array index out of bounds: ${s} < 0.`);if(s>=u.length)throw new yi(`Array index out of bounds: ${s} > ${u.length-1}.`);if(s!==Math.floor(s))throw new yi(`Array index must be an integer, but found ${s} instead.`);return u[s]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Am{constructor(n,s){this.type=Kr,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,Jr),g=s.parse(n[2],2,Jr);return u&&g?Kc(u.type,[Kr,qr,qn,na,Jr])?new Am(u,g):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qo(u.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(u==null)return!1;if(!wa(s,["boolean","string","number","null"]))throw new yi(`Expected first argument to be of type boolean, string, number or null, but found ${Qo(ci(s))} instead.`);if(!wa(u,["string","array"]))throw new yi(`Expected second argument to be of type array or string, but found ${Qo(ci(u))} instead.`);return u.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class uf{constructor(n,s,u){this.type=qn,this.needle=n,this.haystack=s,this.fromIndex=u}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,Jr),g=s.parse(n[2],2,Jr);if(!u||!g)return null;if(!Kc(u.type,[Kr,qr,qn,na,Jr]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qo(u.type)} instead`);if(n.length===4){const h=s.parse(n[3],3,qn);return h?new uf(u,g,h):null}return new uf(u,g)}evaluate(n){const s=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!wa(s,["boolean","string","number","null"]))throw new yi(`Expected first argument to be of type boolean, string, number or null, but found ${Qo(ci(s))} instead.`);if(!wa(u,["string","array"]))throw new yi(`Expected second argument to be of type array or string, but found ${Qo(ci(u))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(n);return u.indexOf(s,g)}return u.indexOf(s)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Pm{constructor(n,s,u,g,h,v){this.inputType=n,this.type=s,this.input=u,this.cases=g,this.outputs=h,this.otherwise=v}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let u,g;s.expectedType&&s.expectedType.kind!=="value"&&(g=s.expectedType);const h={},v=[];for(let L=2;L<n.length-1;L+=2){let w=n[L];const M=n[L+1];Array.isArray(w)||(w=[w]);const D=s.concat(L);if(w.length===0)return D.error("Expected at least one branch label.");for(const R of w){if(typeof R!="number"&&typeof R!="string")return D.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return D.error("Numeric branch labels must be integer values.");if(u){if(D.checkSubtype(u,ci(R)))return null}else u=ci(R);if(h[String(R)]!==void 0)return D.error("Branch labels must be unique.");h[String(R)]=v.length}const I=s.parse(M,L,g);if(!I)return null;g=g||I.type,v.push(I)}const T=s.parse(n[1],1,Jr);if(!T)return null;const P=s.parse(n[n.length-1],n.length-1,g);return P?T.type.kind!=="value"&&s.concat(1).checkSubtype(u,T.type)?null:new Pm(u,g,T,h,v,P):null}evaluate(n){const s=this.input.evaluate(n);return(ci(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),u=[],g={};for(const v of s){const T=g[this.cases[v]];T===void 0?(g[this.cases[v]]=u.length,u.push([this.cases[v],[v]])):u[T][1].push(v)}const h=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,T]of u)n.push(T.length===1?h(T[0]):T.map(h)),n.push(this.outputs[v].serialize());return n.push(this.otherwise.serialize()),n}}class Id{constructor(n,s,u){this.type=n,this.branches=s,this.otherwise=u}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let u;s.expectedType&&s.expectedType.kind!=="value"&&(u=s.expectedType);const g=[];for(let v=1;v<n.length-1;v+=2){const T=s.parse(n[v],v,Kr);if(!T)return null;const P=s.parse(n[v+1],v+1,u);if(!P)return null;g.push([T,P]),u=u||P.type}const h=s.parse(n[n.length-1],n.length-1,u);return h?new Id(u,g,h):null}evaluate(n){for(const[s,u]of this.branches)if(s.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,u]of this.branches)n(s),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class df{constructor(n,s,u,g){this.type=n,this.input=s,this.beginIndex=u,this.endIndex=g}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,Jr),g=s.parse(n[2],2,qn);if(!u||!g)return null;if(!Kc(u.type,[Ki(Jr),qr,Jr]))return s.error(`Expected first argument to be of type array or string, but found ${Qo(u.type)} instead`);if(n.length===4){const h=s.parse(n[3],3,qn);return h?new df(u.type,u,g,h):null}return new df(u.type,u,g)}evaluate(n){const s=this.input.evaluate(n),u=this.beginIndex.evaluate(n);if(!wa(s,["string","array"]))throw new yi(`Expected first argument to be of type array or string, but found ${Qo(ci(s))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(n);return s.slice(u,g)}return s.slice(u)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Rm(c,n){return c==="=="||c==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function O_(c,n,s,u){return u.compare(n,s)===0}function su(c,n,s){const u=c!=="=="&&c!=="!=";return class NL{constructor(h,v,T){this.type=Kr,this.lhs=h,this.rhs=v,this.collator=T,this.hasUntypedArgument=h.type.kind==="value"||v.type.kind==="value"}static parse(h,v){if(h.length!==3&&h.length!==4)return v.error("Expected two or three arguments.");const T=h[0];let P=v.parse(h[1],1,Jr);if(!P)return null;if(!Rm(T,P.type))return v.concat(1).error(`"${T}" comparisons are not supported for type '${Qo(P.type)}'.`);let L=v.parse(h[2],2,Jr);if(!L)return null;if(!Rm(T,L.type))return v.concat(2).error(`"${T}" comparisons are not supported for type '${Qo(L.type)}'.`);if(P.type.kind!==L.type.kind&&P.type.kind!=="value"&&L.type.kind!=="value")return v.error(`Cannot compare types '${Qo(P.type)}' and '${Qo(L.type)}'.`);u&&(P.type.kind==="value"&&L.type.kind!=="value"?P=new oa(L.type,[P]):P.type.kind!=="value"&&L.type.kind==="value"&&(L=new oa(P.type,[L])));let w=null;if(h.length===4){if(P.type.kind!=="string"&&L.type.kind!=="string"&&P.type.kind!=="value"&&L.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(w=v.parse(h[3],3,jh),!w)return null}return new NL(P,L,w)}evaluate(h){const v=this.lhs.evaluate(h),T=this.rhs.evaluate(h);if(u&&this.hasUntypedArgument){const P=ci(v),L=ci(T);if(P.kind!==L.kind||P.kind!=="string"&&P.kind!=="number")throw new yi(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${P.kind}, ${L.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const P=ci(v),L=ci(T);if(P.kind!=="string"||L.kind!=="string")return n(h,v,T)}return this.collator?s(h,v,T,this.collator.evaluate(h)):n(h,v,T)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[c];return this.eachChild(v=>{h.push(v.serialize())}),h}}}const b1=su("==",function(c,n,s){return n===s},O_),z_=su("!=",function(c,n,s){return n!==s},function(c,n,s,u){return!O_(0,n,s,u)}),B_=su("<",function(c,n,s){return n<s},function(c,n,s,u){return u.compare(n,s)<0}),au=su(">",function(c,n,s){return n>s},function(c,n,s,u){return u.compare(n,s)>0}),F_=su("<=",function(c,n,s){return n<=s},function(c,n,s,u){return u.compare(n,s)<=0}),N_=su(">=",function(c,n,s){return n>=s},function(c,n,s,u){return u.compare(n,s)>=0});class Dm{constructor(n,s,u,g,h,v){this.type=qr,this.number=n,this.locale=s,this.currency=u,this.unit=g,this.minFractionDigits=h,this.maxFractionDigits=v}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const u=s.parse(n[1],1,qn);if(!u)return null;const g=n[2];if(typeof g!="object"||Array.isArray(g))return s.error("NumberFormat options argument must be an object.");let h=null;if(g.locale&&(h=s.parseObjectValue(g.locale,2,"locale",qr),!h))return null;let v=null;if(g.currency&&(v=s.parseObjectValue(g.currency,2,"currency",qr),!v))return null;let T=null;if(g.unit&&(T=s.parseObjectValue(g.unit,2,"unit",qr),!T))return null;let P=null;if(g["min-fraction-digits"]&&(P=s.parseObjectValue(g["min-fraction-digits"],2,"min-fraction-digits",qn),!P))return null;let L=null;return g["max-fraction-digits"]&&(L=s.parseObjectValue(g["max-fraction-digits"],2,"max-fraction-digits",qn),!L)?null:new Dm(u,h,v,T,P,L)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class kd{constructor(n){this.type=qn,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=s.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Qo(u.type)} instead.`):new kd(u):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string"||Array.isArray(s))return s.length;throw new yi(`Expected value to be of type string or array, but found ${Qo(ci(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(s=>{n.push(s.serialize())}),n}}function hf(c){return function(){c=1831565813+(c|=0)|0;let n=Math.imul(c^c>>>15,1|c);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}const lu={"==":b1,"!=":z_,">":au,"<":B_,">=":N_,"<=":F_,array:oa,at:km,boolean:oa,case:Id,coalesce:lf,collator:Wh,format:Zc,image:sc,in:Am,"index-of":uf,interpolate:Cs,"interpolate-hcl":Cs,"interpolate-lab":Cs,length:kd,let:cf,literal:ra,match:Pm,number:oa,"number-format":Dm,object:oa,slice:df,step:Cd,string:oa,"to-boolean":Wa,"to-color":Wa,"to-number":Wa,"to-string":Wa,var:So,within:El,distance:Ml,config:ou};function $_(c,[n,s,u,g]){n=n.evaluate(c),s=s.evaluate(c),u=u.evaluate(c);const h=g?g.evaluate(c):1,v=p_(n,s,u,h);if(v)throw new yi(v);return new co(n/255*h,s/255*h,u/255*h,h)}function Lm(c,[n,s,u,g]){n=n.evaluate(c),s=s.evaluate(c),u=u.evaluate(c);const h=g?g.evaluate(c):1,v=function(L,w,M,D){return typeof L=="number"&&L>=0&&L<=360?typeof w=="number"&&w>=0&&w<=100&&typeof M=="number"&&M>=0&&M<=100?D===void 0||typeof D=="number"&&D>=0&&D<=1?null:`Invalid hsla value [${[L,w,M,D].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof D=="number"?[L,w,M,D]:[L,w,M]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof D=="number"?[L,w,M,D]:[L,w,M]).join(", ")}]: 'h' must be between 0 and 360.`}(n,s,u,h);if(v)throw new yi(v);const T=`hsla(${n}, ${s}%, ${u}%, ${h})`,P=co.parse(T);if(!P)throw new yi(`Failed to parse HSLA color: ${T}`);return P}function Om(c,n){return c in n}function zm(c,n){const s=n[c];return s===void 0?null:s}function uc(c){return{type:c}}function V_(c){return{result:"success",value:c}}function kl(c){return{result:"error",value:c}}function Bm(c,n){return!!c&&!!c.parameters&&c.parameters.indexOf(n)>-1}function ff(c){return c["property-type"]==="data-driven"}function Fm(c){return Bm(c.expression,"measure-light")}function U_(c){return Bm(c.expression,"zoom")}function Nm(c){return!!c.expression&&c.expression.interpolated}function pf(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function j_(c){return c}function H_(c,n){const s=n.type==="color",u=c.stops&&typeof c.stops[0][0]=="object",g=u||!(u||c.property!==void 0),h=c.type||(Nm(n)?"exponential":"interval");if(s&&((c=Hc({},c)).stops&&(c.stops=c.stops.map(L=>[L[0],co.parse(L[1])])),c.default=co.parse(c.default?c.default:n.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!L_[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let v,T,P;if(h==="exponential")v=W_;else if(h==="interval")v=G_;else if(h==="categorical"){v=x1,T=Object.create(null);for(const L of c.stops)T[L[0]]=L[1];P=typeof c.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);v=w1}if(u){const L={},w=[];for(let I=0;I<c.stops.length;I++){const R=c.stops[I],B=R[0].zoom;L[B]===void 0&&(L[B]={zoom:B,type:c.type,property:c.property,default:c.default,stops:[]},w.push(B)),L[B].stops.push([R[0].value,R[1]])}const M=[];for(const I of w)M.push([L[I].zoom,H_(L[I],n)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:Cs.interpolationFactor.bind(void 0,D),zoomStops:M.map(I=>I[0]),evaluate:({zoom:I},R)=>W_({stops:M,base:c.base},n,I).evaluate(I,R)}}if(g){const L=h==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:L,interpolationFactor:Cs.interpolationFactor.bind(void 0,L),zoomStops:c.stops.map(w=>w[0]),evaluate:({zoom:w})=>v(c,n,w,T,P)}}return{kind:"source",evaluate(L,w){const M=w&&w.properties?w.properties[c.property]:void 0;return M===void 0?Ad(c.default,n.default):v(c,n,M,T,P)}}}function Ad(c,n,s){return c!==void 0?c:n!==void 0?n:s!==void 0?s:void 0}function x1(c,n,s,u,g){return Ad(typeof s===g?u[s]:void 0,c.default,n.default)}function G_(c,n,s){if(ac(s)!=="number")return Ad(c.default,n.default);const u=c.stops.length;if(u===1||s<=c.stops[0][0])return c.stops[0][1];if(s>=c.stops[u-1][0])return c.stops[u-1][1];const g=af(c.stops.map(h=>h[0]),s);return c.stops[g][1]}function W_(c,n,s){const u=c.base!==void 0?c.base:1;if(ac(s)!=="number")return Ad(c.default,n.default);const g=c.stops.length;if(g===1||s<=c.stops[0][0])return c.stops[0][1];if(s>=c.stops[g-1][0])return c.stops[g-1][1];const h=af(c.stops.map(w=>w[0]),s),v=function(w,M,D,I){const R=I-D,B=w-D;return R===0?0:M===1?B/R:(Math.pow(M,B)-1)/(Math.pow(M,R)-1)}(s,u,c.stops[h][0],c.stops[h+1][0]),T=c.stops[h][1],P=c.stops[h+1][1];let L=ic[n.type]||j_;if(c.colorSpace&&c.colorSpace!=="rgb"){const w=L_[c.colorSpace];L=(M,D)=>w.reverse(w.interpolate(w.forward(M),w.forward(D),v))}return typeof T.evaluate=="function"?{evaluate(...w){const M=T.evaluate.apply(void 0,w),D=P.evaluate.apply(void 0,w);if(M!==void 0&&D!==void 0)return L(M,D,v)}}:L(T,P,v)}function w1(c,n,s){return n.type==="color"?s=co.parse(s):n.type==="formatted"?s=Vi.fromString(s.toString()):n.type==="resolvedImage"?s=Zi.fromString(s.toString()):ac(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0),Ad(s,c.default,n.default)}ls.register(lu,{error:[{kind:"error"},[qr],(c,[n])=>{throw new yi(n.evaluate(c))}],typeof:[qr,[Jr],(c,[n])=>Qo(ci(n.evaluate(c)))],"to-rgba":[Ki(qn,4),[as],(c,[n])=>n.evaluate(c).toRenderColor(null).toArray()],rgb:[as,[qn,qn,qn],$_],rgba:[as,[qn,qn,qn,qn],$_],hsl:[as,[qn,qn,qn],Lm],hsla:[as,[qn,qn,qn,qn],Lm],has:{type:Kr,overloads:[[[qr],(c,[n])=>Om(n.evaluate(c),c.properties())],[[qr,$i],(c,[n,s])=>Om(n.evaluate(c),s.evaluate(c))]]},get:{type:Jr,overloads:[[[qr],(c,[n])=>zm(n.evaluate(c),c.properties())],[[qr,$i],(c,[n,s])=>zm(n.evaluate(c),s.evaluate(c))]]},"feature-state":[Jr,[qr],(c,[n])=>zm(n.evaluate(c),c.featureState||{})],properties:[$i,[],c=>c.properties()],"geometry-type":[qr,[],c=>c.geometryType()],id:[Jr,[],c=>c.id()],zoom:[qn,[],c=>c.globals.zoom],pitch:[qn,[],c=>c.globals.pitch||0],"distance-from-center":[qn,[],c=>c.distanceFromCenter()],"measure-light":[qn,[qr],(c,[n])=>c.measureLight(n.evaluate(c))],"heatmap-density":[qn,[],c=>c.globals.heatmapDensity||0],"line-progress":[qn,[],c=>c.globals.lineProgress||0],"raster-value":[qn,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[qn,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[qn,[],c=>c.globals.skyRadialProgress||0],accumulated:[Jr,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[qn,uc(qn),(c,n)=>{let s=0;for(const u of n)s+=u.evaluate(c);return s}],"*":[qn,uc(qn),(c,n)=>{let s=1;for(const u of n)s*=u.evaluate(c);return s}],"-":{type:qn,overloads:[[[qn,qn],(c,[n,s])=>n.evaluate(c)-s.evaluate(c)],[[qn],(c,[n])=>-n.evaluate(c)]]},"/":[qn,[qn,qn],(c,[n,s])=>n.evaluate(c)/s.evaluate(c)],"%":[qn,[qn,qn],(c,[n,s])=>n.evaluate(c)%s.evaluate(c)],ln2:[qn,[],()=>Math.LN2],pi:[qn,[],()=>Math.PI],e:[qn,[],()=>Math.E],"^":[qn,[qn,qn],(c,[n,s])=>Math.pow(n.evaluate(c),s.evaluate(c))],sqrt:[qn,[qn],(c,[n])=>Math.sqrt(n.evaluate(c))],log10:[qn,[qn],(c,[n])=>Math.log(n.evaluate(c))/Math.LN10],ln:[qn,[qn],(c,[n])=>Math.log(n.evaluate(c))],log2:[qn,[qn],(c,[n])=>Math.log(n.evaluate(c))/Math.LN2],sin:[qn,[qn],(c,[n])=>Math.sin(n.evaluate(c))],cos:[qn,[qn],(c,[n])=>Math.cos(n.evaluate(c))],tan:[qn,[qn],(c,[n])=>Math.tan(n.evaluate(c))],asin:[qn,[qn],(c,[n])=>Math.asin(n.evaluate(c))],acos:[qn,[qn],(c,[n])=>Math.acos(n.evaluate(c))],atan:[qn,[qn],(c,[n])=>Math.atan(n.evaluate(c))],min:[qn,uc(qn),(c,n)=>Math.min(...n.map(s=>s.evaluate(c)))],max:[qn,uc(qn),(c,n)=>Math.max(...n.map(s=>s.evaluate(c)))],abs:[qn,[qn],(c,[n])=>Math.abs(n.evaluate(c))],round:[qn,[qn],(c,[n])=>{const s=n.evaluate(c);return s<0?-Math.round(-s):Math.round(s)}],floor:[qn,[qn],(c,[n])=>Math.floor(n.evaluate(c))],ceil:[qn,[qn],(c,[n])=>Math.ceil(n.evaluate(c))],"filter-==":[Kr,[qr,Jr],(c,[n,s])=>c.properties()[n.value]===s.value],"filter-id-==":[Kr,[Jr],(c,[n])=>c.id()===n.value],"filter-type-==":[Kr,[qr],(c,[n])=>c.geometryType()===n.value],"filter-<":[Kr,[qr,Jr],(c,[n,s])=>{const u=c.properties()[n.value],g=s.value;return typeof u==typeof g&&u<g}],"filter-id-<":[Kr,[Jr],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s<u}],"filter->":[Kr,[qr,Jr],(c,[n,s])=>{const u=c.properties()[n.value],g=s.value;return typeof u==typeof g&&u>g}],"filter-id->":[Kr,[Jr],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s>u}],"filter-<=":[Kr,[qr,Jr],(c,[n,s])=>{const u=c.properties()[n.value],g=s.value;return typeof u==typeof g&&u<=g}],"filter-id-<=":[Kr,[Jr],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s<=u}],"filter->=":[Kr,[qr,Jr],(c,[n,s])=>{const u=c.properties()[n.value],g=s.value;return typeof u==typeof g&&u>=g}],"filter-id->=":[Kr,[Jr],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s>=u}],"filter-has":[Kr,[Jr],(c,[n])=>n.value in c.properties()],"filter-has-id":[Kr,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Kr,[Ki(qr)],(c,[n])=>n.value.indexOf(c.geometryType())>=0],"filter-id-in":[Kr,[Ki(Jr)],(c,[n])=>n.value.indexOf(c.id())>=0],"filter-in-small":[Kr,[qr,Ki(Jr)],(c,[n,s])=>s.value.indexOf(c.properties()[n.value])>=0],"filter-in-large":[Kr,[qr,Ki(Jr)],(c,[n,s])=>function(u,g,h,v){for(;h<=v;){const T=h+v>>1;if(g[T]===u)return!0;g[T]>u?v=T-1:h=T+1}return!1}(c.properties()[n.value],s.value,0,s.value.length-1)],all:{type:Kr,overloads:[[[Kr,Kr],(c,[n,s])=>n.evaluate(c)&&s.evaluate(c)],[uc(Kr),(c,n)=>{for(const s of n)if(!s.evaluate(c))return!1;return!0}]]},any:{type:Kr,overloads:[[[Kr,Kr],(c,[n,s])=>n.evaluate(c)||s.evaluate(c)],[uc(Kr),(c,n)=>{for(const s of n)if(s.evaluate(c))return!0;return!1}]]},"!":[Kr,[Kr],(c,[n])=>!n.evaluate(c)],"is-supported-script":[Kr,[qr],(c,[n])=>{const s=c.globals&&c.globals.isSupportedScript;return!s||s(n.evaluate(c))}],upcase:[qr,[qr],(c,[n])=>n.evaluate(c).toUpperCase()],downcase:[qr,[qr],(c,[n])=>n.evaluate(c).toLowerCase()],concat:[qr,uc(Jr),(c,n)=>n.map(s=>Yi(s.evaluate(c))).join("")],"resolved-locale":[qr,[jh],(c,[n])=>n.evaluate(c).resolvedLocale()],random:[qn,[qn,qn,Jr],(c,n)=>{const[s,u,g]=n.map(v=>v.evaluate(c));if(s>u||s===u)return s;let h;if(typeof g=="string")h=function(v){let T=0;if(v.length===0)return T;for(let P=0;P<v.length;P++)T=(T<<5)-T+v.charCodeAt(P),T|=0;return T}(g);else{if(typeof g!="number")throw new yi(`Invalid seed input: ${g}`);h=g}return s+hf(h)()*(u-s)}]});class mf{constructor(n,s,u,g){this.expression=n,this._warningHistory={},this._evaluator=new m_(u,g),this._defaultValue=s?function(h){return h.type==="color"&&(pf(h.default)||Array.isArray(h.default))?new co(0,0,0,0):h.type==="color"?co.parse(h.default)||null:h.default===void 0?null:h.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(n,s,u,g,h,v,T,P){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=u,this._evaluator.canonical=g||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=P||null,this.expression.evaluate(this._evaluator)}evaluate(n,s,u,g,h,v,T,P){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=u||null,this._evaluator.canonical=g||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=P||null;try{const L=this.expression.evaluate(this._evaluator);if(L==null||typeof L=="number"&&L!=L)return this._defaultValue;if(this._enumValues&&!(L in this._enumValues))throw new yi(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(L)} instead.`);return L}catch(L){return this._warningHistory[L.message]||(this._warningHistory[L.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${L.message}`)),this._defaultValue}}}function gf(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in lu}function Pd(c,n,s,u){const g=new M_(lu,[],n?function(v){const T={color:as,string:qr,number:qn,enum:qr,boolean:Kr,formatted:Gc,resolvedImage:Wc};return v.type==="array"?Ki(T[v.value]||Jr,v.length):T[v.type]}(n):void 0,void 0,void 0,s,u),h=g.parse(c,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?V_(new mf(h,n,s,u)):kl(g.errors)}class $m{constructor(n,s,u){this.kind=n,this._styleExpression=s,this.isLightConstant=u,this.isStateDependent=n!=="constant"&&!of(s.expression),this.configDependencies=sf(s.expression)}evaluateWithoutErrorHandling(n,s,u,g,h,v){return this._styleExpression.evaluateWithoutErrorHandling(n,s,u,g,h,v)}evaluate(n,s,u,g,h,v){return this._styleExpression.evaluate(n,s,u,g,h,v)}}class Sa{constructor(n,s,u,g,h){this.kind=n,this.zoomStops=u,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!of(s.expression),this.isLightConstant=h,this.configDependencies=sf(s.expression),this.interpolationType=g}evaluateWithoutErrorHandling(n,s,u,g,h,v){return this._styleExpression.evaluateWithoutErrorHandling(n,s,u,g,h,v)}evaluate(n,s,u,g,h,v){return this._styleExpression.evaluate(n,s,u,g,h,v)}interpolationFactor(n,s,u){return this.interpolationType?Cs.interpolationFactor(this.interpolationType,n,s,u):0}}function q_(c,n,s,u){if((c=Pd(c,n,s,u)).result==="error")return c;const g=c.value.expression,h=Sd(g);if(!h&&!ff(n))return kl([new xa("","data expressions not supported")]);const v=Td(g,["zoom","pitch","distance-from-center"]);if(!v&&!U_(n))return kl([new xa("","zoom expressions not supported")]);const T=Td(g,["measure-light"]);if(!T&&!Fm(n))return kl([new xa("","measure-light expression not supported")]);const P=n.expression&&n.expression.relaxZoomRestriction,L=_f(g);return L||v||P?L instanceof xa?kl([L]):L instanceof Cs&&!Nm(n)?kl([new xa("",'"interpolate" expressions cannot be used with this property')]):V_(L?new Sa(h?"camera":"composite",c.value,L.labels,L instanceof Cs?L.interpolation:void 0,T):new $m(h?"constant":"source",c.value,T)):kl([new xa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class vf{constructor(n,s){this._parameters=n,this._specification=s,Hc(this,H_(this._parameters,this._specification))}static deserialize(n){return new vf(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function _f(c){let n=null;if(c instanceof cf)n=_f(c.result);else if(c instanceof lf){for(const s of c.args)if(n=_f(s),n)break}else(c instanceof Cd||c instanceof Cs)&&c.input instanceof ls&&c.input.name==="zoom"&&(n=c);return n instanceof xa||c.eachChild(s=>{const u=_f(s);u instanceof xa?n=u:n&&u&&n!==u&&(n=new xa("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}var yf,Vm,K_=function(){if(Vm)return yf;Vm=1,yf=n;var c=3;function n(s,u,g){var h=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var v=new Int32Array(this.arrayBuffer);s=v[0],this.d=(u=v[1])+2*(g=v[2]);for(var T=0;T<this.d*this.d;T++){var P=v[c+T],L=v[c+T+1];h.push(P===L?null:v.subarray(P,L))}var w=v[c+h.length+1];this.keys=v.subarray(v[c+h.length],w),this.bboxes=v.subarray(w),this.insert=this._insertReadonly}else{this.d=u+2*g;for(var M=0;M<this.d*this.d;M++)h.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=s,this.padding=g,this.scale=u/s,this.uid=0;var D=g/u*s;this.min=-D,this.max=s+D}return n.prototype.insert=function(s,u,g,h,v){this._forEachCell(u,g,h,v,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(h),this.bboxes.push(v)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(s,u,g,h,v,T){this.cells[v].push(T)},n.prototype.query=function(s,u,g,h,v){var T=this.min,P=this.max;if(s<=T&&u<=T&&P<=g&&P<=h&&!v)return Array.prototype.slice.call(this.keys);var L=[];return this._forEachCell(s,u,g,h,this._queryCell,L,{},v),L},n.prototype._queryCell=function(s,u,g,h,v,T,P,L){var w=this.cells[v];if(w!==null)for(var M=this.keys,D=this.bboxes,I=0;I<w.length;I++){var R=w[I];if(P[R]===void 0){var B=4*R;(L?L(D[B+0],D[B+1],D[B+2],D[B+3]):s<=D[B+2]&&u<=D[B+3]&&g>=D[B+0]&&h>=D[B+1])?(P[R]=!0,T.push(M[R])):P[R]=!1}}},n.prototype._forEachCell=function(s,u,g,h,v,T,P,L){for(var w=this._convertToCellCoord(s),M=this._convertToCellCoord(u),D=this._convertToCellCoord(g),I=this._convertToCellCoord(h),R=w;R<=D;R++)for(var B=M;B<=I;B++){var j=this.d*B+R;if((!L||L(this._convertFromCellCoord(R),this._convertFromCellCoord(B),this._convertFromCellCoord(R+1),this._convertFromCellCoord(B+1)))&&v.call(this,s,u,g,h,j,T,P,L))return}},n.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},n.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,u=c+this.cells.length+1+1,g=0,h=0;h<this.cells.length;h++)g+=this.cells[h].length;var v=new Int32Array(u+g+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var T=u,P=0;P<s.length;P++){var L=s[P];v[c+P]=T,v.set(L,T),T+=L.length}return v[c+s.length]=T,v.set(this.keys,T),v[c+s.length+1]=T+=this.keys.length,v.set(this.bboxes,T),T+=this.bboxes.length,v.buffer},yf}(),dc=C(K_);const cu={};function Gn(c,n,s={}){Object.defineProperty(c,"_classRegistryKey",{value:n,writable:!1}),cu[n]={klass:c,omit:s.omit||[]}}Gn(Object,"Object"),dc.serialize=function(c,n){const s=c.toArrayBuffer();return n&&n.add(s),{buffer:s}},dc.deserialize=function(c){return new dc(c.buffer)},Object.defineProperty(dc,"name",{value:"Grid"}),Gn(dc,"Grid"),Gn(co,"Color"),Gn(Error,"Error"),Gn(Vi,"Formatted"),Gn(xs,"FormattedSection"),Gn(im,"AJAXError"),Gn(Zi,"ResolvedImage"),Gn(vf,"StylePropertyFunction"),Gn(mf,"StyleExpression",{omit:["_evaluator"]}),Gn(Sa,"ZoomDependentExpression"),Gn($m,"ZoomConstantExpression"),Gn(ls,"CompoundExpression",{omit:["_evaluate"]});for(const c in lu)cu[lu[c]._classRegistryKey]||Gn(lu[c],`Expression${c}`);function Um(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function Z_(c){return self.ImageBitmap&&c instanceof ImageBitmap}function cs(c,n){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Um(c)||Z_(c))return n&&n.add(c),c;if(ArrayBuffer.isView(c)){const s=c;return n&&n.add(s.buffer),s}if(c instanceof ImageData)return n&&n.add(c.data.buffer),c;if(Array.isArray(c)){const s=[];for(const u of c)s.push(cs(u,n));return s}if(c instanceof Map){const s={$name:"Map"};for(const[u,g]of c.entries())s[u]=cs(g);return s}if(c instanceof Set){const s={$name:"Set"};let u=0;for(const g of c.values())s[++u]=cs(g);return s}if(typeof c=="object"){const s=c.constructor,u=s._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${u}`);const g=s.serialize?s.serialize(c,n):{};if(!s.serialize){for(const h in c)c.hasOwnProperty(h)&&(cu[u].omit.indexOf(h)>=0||(g[h]=cs(c[h],n)));c instanceof Error&&(g.message=c.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(g.$name=u),g}throw new Error("can't serialize object of type "+typeof c)}function hc(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Um(c)||Z_(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(hc);if(typeof c=="object"){const n=c.$name||"Object";if(n==="Map"){const g=new Map;for(const h of Object.keys(c))h!=="$name"&&g.set(h,hc(c[h]));return g}if(n==="Set"){const g=new Set;for(const h of Object.keys(c))h!=="$name"&&g.add(hc(c[h]));return g}const{klass:s}=cu[n];if(!s)throw new Error(`can't deserialize unregistered class ${n}`);if(s.deserialize)return s.deserialize(c);const u=Object.create(s.prototype);for(const g of Object.keys(c))g!=="$name"&&(u[g]=hc(c[g]));return u}throw new Error("can't deserialize object of type "+typeof c)}const Xn={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function bf(c){for(const n of c)if(wf(n.charCodeAt(0)))return!0;return!1}function S1(c){for(const n of c)if(!xf(n.charCodeAt(0)))return!1;return!0}function xf(c){return!(Xn.Arabic(c)||Xn["Arabic Supplement"](c)||Xn["Arabic Extended-A"](c)||Xn["Arabic Presentation Forms-A"](c)||Xn["Arabic Presentation Forms-B"](c))}function wf(c){return!(c!==746&&c!==747&&(c<4352||!(Xn["Bopomofo Extended"](c)||Xn.Bopomofo(c)||Xn["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Xn["CJK Compatibility Ideographs"](c)||Xn["CJK Compatibility"](c)||Xn["CJK Radicals Supplement"](c)||Xn["CJK Strokes"](c)||!(!Xn["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Xn["CJK Unified Ideographs Extension A"](c)||Xn["CJK Unified Ideographs"](c)||Xn["Enclosed CJK Letters and Months"](c)||Xn["Hangul Compatibility Jamo"](c)||Xn["Hangul Jamo Extended-A"](c)||Xn["Hangul Jamo Extended-B"](c)||Xn["Hangul Jamo"](c)||Xn["Hangul Syllables"](c)||Xn.Hiragana(c)||Xn["Ideographic Description Characters"](c)||Xn.Kanbun(c)||Xn["Kangxi Radicals"](c)||Xn["Katakana Phonetic Extensions"](c)||Xn.Katakana(c)&&c!==12540||!(!Xn["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Xn["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Xn["Unified Canadian Aboriginal Syllabics"](c)||Xn["Unified Canadian Aboriginal Syllabics Extended"](c)||Xn["Vertical Forms"](c)||Xn["Yijing Hexagram Symbols"](c)||Xn["Yi Syllables"](c)||Xn["Yi Radicals"](c))))}function Rd(c){return!(wf(c)||function(n){return!!(Xn["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Xn["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Xn["Letterlike Symbols"](n)||Xn["Number Forms"](n)||Xn["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Xn["Control Pictures"](n)&&n!==9251||Xn["Optical Character Recognition"](n)||Xn["Enclosed Alphanumerics"](n)||Xn["Geometric Shapes"](n)||Xn["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Xn["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Xn["CJK Symbols and Punctuation"](n)||Xn.Katakana(n)||Xn["Private Use Area"](n)||Xn["CJK Compatibility Forms"](n)||Xn["Small Form Variants"](n)||Xn["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(c))}function jm(c){return c>=1424&&c<=2303||Xn["Arabic Presentation Forms-A"](c)||Xn["Arabic Presentation Forms-B"](c)}function T1(c,n){return!(!n&&jm(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Xn.Khmer(c))}function C1(c){for(const n of c)if(jm(n.charCodeAt(0)))return!0;return!1}const Dd="deferred",Ld="loading",Sf="loaded";let uu=null,wi="unavailable",Al=null;const Y_=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(wi="error"),uu&&uu(c)};function Hm(){Gm.fire(new Tl("pluginStateChange",{pluginStatus:wi,pluginURL:Al}))}const Gm=new jc,Wm=function(){return wi},qm=function(){if(wi!==Dd||!Al)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");wi=Ld,Hm(),Al&&Vc({url:Al},c=>{c?Y_(c):(wi=Sf,Hm())})},us={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>wi===Sf||us.applyArabicShaping!=null,isLoading:()=>wi===Ld,setState(c){wi=c.pluginStatus,Al=c.pluginURL},isParsed:()=>us.applyArabicShaping!=null&&us.processBidirectionalText!=null&&us.processStyledBidirectionalText!=null,getPluginURL:()=>Al};class Ko{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(n){return function(s,u){for(const g of s)if(!T1(g.charCodeAt(0),u))return!1;return!0}(n,us.isLoaded())}}class Tf{constructor(n,s,u,g){this.property=n,this.value=s,this.expression=function(h,v,T,P){if(pf(h))return new vf(h,v);if(gf(h)||Array.isArray(h)&&h.length>0){const L=q_(h,v,T,P);if(L.result==="error")throw new Error(L.value.map(w=>`${w.key}: ${w.message}`).join(", "));return L.value}{let L=h;return typeof h=="string"&&v.type==="color"&&(L=co.parse(h)),{kind:"constant",configDependencies:new Set,evaluate:()=>L}}}(s===void 0?n.specification.default:s,n.specification,u,g)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,u){return this.property.possiblyEvaluate(this,n,s,u)}}class Km{constructor(n,s,u){this.property=n,this.value=new Tf(n,void 0,s,u)}transitioned(n,s){return new J_(this.property,this.value,s,ar({},n.transition,this.transition),n.now)}untransitioned(){return new J_(this.property,this.value,null,{},0)}}class X_{constructor(n,s,u){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._scope=s,this._options=u,this.configDependencies=new Set}getValue(n){return gn(this._values[n].value.value)}setValue(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new Km(this._values[n].property,this._scope,this._options)),this._values[n].value=new Tf(this._values[n].property,s===null?void 0:gn(s),this._scope,this._options),this._values[n].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].value.expression.configDependencies]))}setTransitionOrValue(n,s){s&&(this._options=s);const u=this._properties.properties;if(n)for(const g in n){const h=n[g];if(dt(g,"-transition")){const v=g.slice(0,-11);u[v]&&this.setTransition(v,h)}else u.hasOwnProperty(g)&&this.setValue(g,h)}}getTransition(n){return gn(this._values[n].transition)}setTransition(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new Km(this._values[n].property)),this._values[n].transition=gn(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(n[s]=u);const g=this.getTransition(s);g!==void 0&&(n[`${s}-transition`]=g)}return n}transitioned(n,s){const u=new Q_(this._properties);for(const g of Object.keys(this._values))u._values[g]=this._values[g].transitioned(n,s._values[g]);return u}untransitioned(){const n=new Q_(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class J_{constructor(n,s,u,g,h){const v=g.delay||0,T=g.duration||0;h=h||0,this.property=n,this.value=s,this.begin=h+v,this.end=this.begin+T,n.specification.transition&&(g.delay||g.duration)&&(this.prior=u)}possiblyEvaluate(n,s,u){const g=n.now||0,h=this.value.possiblyEvaluate(n,s,u),v=this.prior;if(v){if(g>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(g<this.begin)return v.possiblyEvaluate(n,s,u);{const T=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(n,s,u),h,dn(T))}}return h}}class Q_{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,u){const g=new hu(this._properties);for(const h of Object.keys(this._values))g._values[h]=this._values[h].possiblyEvaluate(n,s,u);return g}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class E1{constructor(n,s,u){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._scope=s,this._options=u,this.configDependencies=new Set}getValue(n){return gn(this._values[n].value)}setValue(n,s){this._values[n]=new Tf(this._values[n].property,s===null?void 0:gn(s),this._scope,this._options),this._values[n].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].expression.configDependencies]))}serialize(){const n={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(n[s]=u)}return n}possiblyEvaluate(n,s,u){const g=new hu(this._properties);for(const h of Object.keys(this._values))g._values[h]=this._values[h].possiblyEvaluate(n,s,u);return g}}class du{constructor(n,s,u){this.property=n,this.value=s,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,u,g){return this.property.evaluate(this.value,this.parameters,n,s,u,g)}}class hu{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Sn{constructor(n){this.specification=n}possiblyEvaluate(n,s){return n.expression.evaluate(s)}interpolate(n,s,u){const g=ic[this.specification.type];return g?g(n,s,u):n}}class Qn{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,u,g){return new du(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},u,g)}:n.expression,s)}interpolate(n,s,u){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new du(this,{kind:"constant",value:void 0},n.parameters);const g=ic[this.specification.type];return g?new du(this,{kind:"constant",value:g(n.value.value,s.value.value,u)},n.parameters):n}evaluate(n,s,u,g,h,v){return n.kind==="constant"?n.value:n.evaluate(s,u,g,h,v)}}class ia{constructor(n){this.specification=n}possiblyEvaluate(n,s,u,g){return!!n.expression.evaluate(s,null,{},u,g)}interpolate(){return!1}}class $o{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new Ko(0,{});for(const u in n){const g=n[u];g.specification.overridable&&this.overridableProperties.push(u);const h=this.defaultPropertyValues[u]=new Tf(g,void 0),v=this.defaultTransitionablePropertyValues[u]=new Km(g);this.defaultTransitioningPropertyValues[u]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=h.possiblyEvaluate(s)}}}Gn(Qn,"DataDrivenProperty"),Gn(Sn,"DataConstantProperty"),Gn(ia,"ColorRampProperty");var Dt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{"experimental":true}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Od(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Cf(c){if(Array.isArray(c))return c.map(Cf);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const n={};for(const s in c)n[s]=Cf(c[s]);return n}return Od(c)}function Zm(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const n of c.slice(1))if(!Zm(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function sa(c,n="",s=null,u="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Zm(c)||(c=Ef(c));const g=c;let h=!0;try{h=function(M){if(!fu(M))return M;let D=Cf(M);return fc(D),D=Ym(D),D}(g)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(g,null,2)}
        `)}const v=Dt[`filter_${u}`],T=Pd(h,v,n,s);let P=null;if(T.result==="error")throw new Error(T.value.map(M=>`${M.key}: ${M.message}`).join(", "));P=(M,D,I)=>T.value.evaluate(M,D,{},I);let L=null,w=null;if(h!==g){const M=Pd(g,v,n,s);if(M.result==="error")throw new Error(M.value.map(D=>`${D.key}: ${D.message}`).join(", "));L=(D,I,R,B,j)=>M.value.evaluate(D,I,{},R,void 0,void 0,B,j),w=!Sd(M.value.expression)}return{filter:P,dynamicFilter:L||void 0,needGeometry:ey(h),needFeature:!!w}}function Ym(c){if(!Array.isArray(c))return c;const n=function(s){if(M1.has(s[0])){for(let u=1;u<s.length;u++)if(fu(s[u]))return!0}return s}(c);return n===!0?n:n.map(s=>Ym(s))}function fc(c){let n=!1;const s=[];if(c[0]==="case"){for(let u=1;u<c.length-1;u+=2)n=n||fu(c[u]),s.push(c[u+1]);s.push(c[c.length-1])}else if(c[0]==="match"){n=n||fu(c[1]);for(let u=2;u<c.length-1;u+=2)s.push(c[u+1]);s.push(c[c.length-1])}else if(c[0]==="step"){n=n||fu(c[1]);for(let u=1;u<c.length-1;u+=2)s.push(c[u+1])}n&&(c.length=0,c.push("any",...s));for(let u=1;u<c.length;u++)fc(c[u])}function fu(c){if(!Array.isArray(c))return!1;if((n=c[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let s=1;s<c.length;s++)if(fu(c[s]))return!0;return!1}const M1=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function I1(c,n){return c<n?-1:c>n?1:0}function ey(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let n=1;n<c.length;n++)if(ey(c[n]))return!0;return!1}function Ef(c){if(!c)return!0;const n=c[0];return c.length<=1?n!=="any":n==="=="?Mf(c[1],c[2],"=="):n==="!="?Bd(Mf(c[1],c[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Mf(c[1],c[2],n):n==="any"?(s=c.slice(1),["any"].concat(s.map(Ef))):n==="all"?["all"].concat(c.slice(1).map(Ef)):n==="none"?["all"].concat(c.slice(1).map(Ef).map(Bd)):n==="in"?If(c[1],c.slice(2)):n==="!in"?Bd(If(c[1],c.slice(2))):n==="has"?zd(c[1]):n!=="!has"||Bd(zd(c[1]));var s}function Mf(c,n,s){switch(c){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,c,n]}}function If(c,n){if(n.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",c,["literal",n.sort(I1)]]:["filter-in-small",c,["literal",n]]}}function zd(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Bd(c){return["!",c]}const pu="";function ty(c,n){return n?`${c}${pu}${n}`:c}const aa="-transition",k1=new Set(["fill","line","background","hillshade","raster"]);class Ui extends jc{constructor(n,s,u,g,h){if(super(),this.id=n.id,this.fqid=ty(this.id,u),this.type=n.type,this.scope=u,this.lut=g,this.options=h,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&n.type!=="sky"&&n.type!=="slot"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),n.slot&&(this.slot=n.slot),s.layout&&(this._unevaluatedLayout=new E1(s.layout,this.scope,h),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),s.paint)){this._transitionablePaint=new X_(s.paint,this.scope,h);for(const v in n.paint)this.setPaintProperty(v,n.paint[v]);for(const v in n.layout)this.setLayoutProperty(v,n.layout[v]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new hu(s.paint)}}onAdd(n){}onRemove(n){}isDraped(n){return!this.is3D()&&k1.has(this.type)}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s){if(this.type==="custom"&&n==="visibility")return void(this.visibility=s);const u=this._unevaluatedLayout;u._properties.properties[n]&&(u.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),n==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(n){return dt(n,aa)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s){const u=this._transitionablePaint,g=u._properties.properties;if(dt(n,aa)){const M=n.slice(0,-11);return g[M]&&u.setTransition(M,s||void 0),!1}if(!g[n])return!1;const h=u._values[n],v=h.value.isDataDriven(),T=h.value;u.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(n);const P=u._values[n].value,L=P.isDataDriven(),w=dt(n,"pattern")||n==="line-dasharray";return L||v||w||this._handleOverridablePaintPropertyUpdate(n,T,P)}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getDefaultProgramParams(n,s,u){return null}_handleOverridablePaintPropertyUpdate(n,s,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){return Ze({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(n,s)=>!(n===void 0||s==="layout"&&!Object.keys(n).length||s==="paint"&&!Object.keys(n).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof du&&ff(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(n){this._filterCompiled||(this._featureFilter=sa(this.filter,this.scope,n),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(n){this._stats&&(n.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(n){}queryIntersectsFeature(n,s,u,g,h,v,T,P,L){}queryIntersectsMatchingFeature(n,s,u,g){}}const A1={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Fd{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class zo{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.add(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...n){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...n){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function oo(c,n=1){let s=0,u=0;return{members:c.map(g=>{const h=A1[g.type].BYTES_PER_ELEMENT,v=s=ny(s,Math.max(n,h)),T=g.components||1;return u=Math.max(u,h),s+=h*T,{name:g.name,type:g.type,components:T,offset:v}}),size:ny(s,Math.max(u,n)),alignment:n}}function ny(c,n){return Math.ceil(c/n)*n}class Pl extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const g=2*n;return this.int16[g+0]=s,this.int16[g+1]=u,n}}Pl.prototype.bytesPerElement=4,Gn(Pl,"StructArrayLayout2i4");class kf extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,u)}emplace(n,s,u,g){const h=3*n;return this.int16[h+0]=s,this.int16[h+1]=u,this.int16[h+2]=g,n}}kf.prototype.bytesPerElement=6,Gn(kf,"StructArrayLayout3i6");class Rl extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,g){const h=this.length;return this.resize(h+1),this.emplace(h,n,s,u,g)}emplace(n,s,u,g,h){const v=4*n;return this.int16[v+0]=s,this.int16[v+1]=u,this.int16[v+2]=g,this.int16[v+3]=h,n}}Rl.prototype.bytesPerElement=8,Gn(Rl,"StructArrayLayout4i8");class Af extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,g,h)}emplace(n,s,u,g,h,v){const T=5*n;return this.int16[T+0]=s,this.int16[T+1]=u,this.int16[T+2]=g,this.int16[T+3]=h,this.int16[T+4]=v,n}}Af.prototype.bytesPerElement=10,Gn(Af,"StructArrayLayout5i10");class Xm extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T){const P=this.length;return this.resize(P+1),this.emplace(P,n,s,u,g,h,v,T)}emplace(n,s,u,g,h,v,T,P){const L=6*n,w=12*n,M=3*n;return this.int16[L+0]=s,this.int16[L+1]=u,this.uint8[w+4]=g,this.uint8[w+5]=h,this.uint8[w+6]=v,this.uint8[w+7]=T,this.float32[M+2]=P,n}}Xm.prototype.bytesPerElement=12,Gn(Xm,"StructArrayLayout2i4ub1f12");class Za extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g){const h=this.length;return this.resize(h+1),this.emplace(h,n,s,u,g)}emplace(n,s,u,g,h){const v=4*n;return this.float32[v+0]=s,this.float32[v+1]=u,this.float32[v+2]=g,this.float32[v+3]=h,n}}Za.prototype.bytesPerElement=16,Gn(Za,"StructArrayLayout4f16");class Dl extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,u)}emplace(n,s,u,g){const h=3*n;return this.float32[h+0]=s,this.float32[h+1]=u,this.float32[h+2]=g,n}}Dl.prototype.bytesPerElement=12,Gn(Dl,"StructArrayLayout3f12");class Ya extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,g,h)}emplace(n,s,u,g,h,v){const T=6*n,P=3*n;return this.uint16[T+0]=s,this.uint16[T+1]=u,this.uint16[T+2]=g,this.uint16[T+3]=h,this.float32[P+2]=v,n}}Ya.prototype.bytesPerElement=12,Gn(Ya,"StructArrayLayout4ui1f12");class pc extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,g){const h=this.length;return this.resize(h+1),this.emplace(h,n,s,u,g)}emplace(n,s,u,g,h){const v=4*n;return this.uint16[v+0]=s,this.uint16[v+1]=u,this.uint16[v+2]=g,this.uint16[v+3]=h,n}}pc.prototype.bytesPerElement=8,Gn(pc,"StructArrayLayout4ui8");class Pf extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,g,h,v)}emplace(n,s,u,g,h,v,T){const P=6*n;return this.int16[P+0]=s,this.int16[P+1]=u,this.int16[P+2]=g,this.int16[P+3]=h,this.int16[P+4]=v,this.int16[P+5]=T,n}}Pf.prototype.bytesPerElement=12,Gn(Pf,"StructArrayLayout6i12");class Jm extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T,P,L,w,M,D){const I=this.length;return this.resize(I+1),this.emplace(I,n,s,u,g,h,v,T,P,L,w,M,D)}emplace(n,s,u,g,h,v,T,P,L,w,M,D,I){const R=12*n;return this.int16[R+0]=s,this.int16[R+1]=u,this.int16[R+2]=g,this.int16[R+3]=h,this.uint16[R+4]=v,this.uint16[R+5]=T,this.uint16[R+6]=P,this.uint16[R+7]=L,this.int16[R+8]=w,this.int16[R+9]=M,this.int16[R+10]=D,this.int16[R+11]=I,n}}Jm.prototype.bytesPerElement=24,Gn(Jm,"StructArrayLayout4i4ui4i24");class Qm extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,g,h,v)}emplace(n,s,u,g,h,v,T){const P=10*n,L=5*n;return this.int16[P+0]=s,this.int16[P+1]=u,this.int16[P+2]=g,this.float32[L+2]=h,this.float32[L+3]=v,this.float32[L+4]=T,n}}Qm.prototype.bytesPerElement=20,Gn(Qm,"StructArrayLayout3i3f20");class eg extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}eg.prototype.bytesPerElement=4,Gn(eg,"StructArrayLayout1ul4");class Ll extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const g=2*n;return this.uint16[g+0]=s,this.uint16[g+1]=u,n}}Ll.prototype.bytesPerElement=4,Gn(Ll,"StructArrayLayout2ui4");class mu extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T,P,L,w,M,D,I){const R=this.length;return this.resize(R+1),this.emplace(R,n,s,u,g,h,v,T,P,L,w,M,D,I)}emplace(n,s,u,g,h,v,T,P,L,w,M,D,I,R){const B=20*n,j=10*n;return this.int16[B+0]=s,this.int16[B+1]=u,this.int16[B+2]=g,this.int16[B+3]=h,this.int16[B+4]=v,this.float32[j+3]=T,this.float32[j+4]=P,this.float32[j+5]=L,this.float32[j+6]=w,this.int16[B+14]=M,this.uint32[j+8]=D,this.uint16[B+18]=I,this.uint16[B+19]=R,n}}mu.prototype.bytesPerElement=40,Gn(mu,"StructArrayLayout5i4f1i1ul2ui40");class mc extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T){const P=this.length;return this.resize(P+1),this.emplace(P,n,s,u,g,h,v,T)}emplace(n,s,u,g,h,v,T,P){const L=8*n;return this.int16[L+0]=s,this.int16[L+1]=u,this.int16[L+2]=g,this.int16[L+4]=h,this.int16[L+5]=v,this.int16[L+6]=T,this.int16[L+7]=P,n}}mc.prototype.bytesPerElement=16,Gn(mc,"StructArrayLayout3i2i2i16");class Xi extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,g,h)}emplace(n,s,u,g,h,v){const T=4*n,P=8*n;return this.float32[T+0]=s,this.float32[T+1]=u,this.float32[T+2]=g,this.int16[P+6]=h,this.int16[P+7]=v,n}}Xi.prototype.bytesPerElement=16,Gn(Xi,"StructArrayLayout2f1f2i16");class gu extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,g,h,v)}emplace(n,s,u,g,h,v,T){const P=20*n,L=5*n;return this.uint8[P+0]=s,this.uint8[P+1]=u,this.float32[L+1]=g,this.float32[L+2]=h,this.float32[L+3]=v,this.float32[L+4]=T,n}}gu.prototype.bytesPerElement=20,Gn(gu,"StructArrayLayout2ub4f20");class Ii extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,u)}emplace(n,s,u,g){const h=3*n;return this.uint16[h+0]=s,this.uint16[h+1]=u,this.uint16[h+2]=g,n}}Ii.prototype.bytesPerElement=6,Gn(Ii,"StructArrayLayout3ui6");class tg extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T,P,L,w,M,D,I,R,B,j,K,ne,oe,Y,ae){const me=this.length;return this.resize(me+1),this.emplace(me,n,s,u,g,h,v,T,P,L,w,M,D,I,R,B,j,K,ne,oe,Y,ae)}emplace(n,s,u,g,h,v,T,P,L,w,M,D,I,R,B,j,K,ne,oe,Y,ae,me){const Ee=30*n,Oe=15*n,Be=60*n;return this.int16[Ee+0]=s,this.int16[Ee+1]=u,this.int16[Ee+2]=g,this.float32[Oe+2]=h,this.float32[Oe+3]=v,this.uint16[Ee+8]=T,this.uint16[Ee+9]=P,this.uint32[Oe+5]=L,this.uint32[Oe+6]=w,this.uint32[Oe+7]=M,this.uint16[Ee+16]=D,this.uint16[Ee+17]=I,this.uint16[Ee+18]=R,this.float32[Oe+10]=B,this.float32[Oe+11]=j,this.uint8[Be+48]=K,this.uint8[Be+49]=ne,this.uint8[Be+50]=oe,this.uint32[Oe+13]=Y,this.int16[Ee+28]=ae,this.uint8[Be+58]=me,n}}tg.prototype.bytesPerElement=60,Gn(tg,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class ng extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T,P,L,w,M,D,I,R,B,j,K,ne,oe,Y,ae,me,Ee,Oe,Be,De,Xe,$e,tt,ft,vt,yt){const wt=this.length;return this.resize(wt+1),this.emplace(wt,n,s,u,g,h,v,T,P,L,w,M,D,I,R,B,j,K,ne,oe,Y,ae,me,Ee,Oe,Be,De,Xe,$e,tt,ft,vt,yt)}emplace(n,s,u,g,h,v,T,P,L,w,M,D,I,R,B,j,K,ne,oe,Y,ae,me,Ee,Oe,Be,De,Xe,$e,tt,ft,vt,yt,wt){const Bt=20*n,St=40*n,Xt=80*n;return this.float32[Bt+0]=s,this.float32[Bt+1]=u,this.int16[St+4]=g,this.int16[St+5]=h,this.int16[St+6]=v,this.int16[St+7]=T,this.int16[St+8]=P,this.int16[St+9]=L,this.int16[St+10]=w,this.int16[St+11]=M,this.int16[St+12]=D,this.uint16[St+13]=I,this.uint16[St+14]=R,this.uint16[St+15]=B,this.uint16[St+16]=j,this.uint16[St+17]=K,this.uint16[St+18]=ne,this.uint16[St+19]=oe,this.uint16[St+20]=Y,this.uint16[St+21]=ae,this.uint16[St+22]=me,this.uint16[St+23]=Ee,this.uint16[St+24]=Oe,this.uint16[St+25]=Be,this.uint16[St+26]=De,this.uint16[St+27]=Xe,this.uint32[Bt+14]=$e,this.float32[Bt+15]=tt,this.float32[Bt+16]=ft,this.float32[Bt+17]=vt,this.float32[Bt+18]=yt,this.uint8[Xt+76]=wt,n}}ng.prototype.bytesPerElement=80,Gn(ng,"StructArrayLayout2f9i15ui1ul4f1ub80");class vu extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}vu.prototype.bytesPerElement=4,Gn(vu,"StructArrayLayout1f4");class Xa extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,g,h)}emplace(n,s,u,g,h,v){const T=5*n;return this.float32[T+0]=s,this.float32[T+1]=u,this.float32[T+2]=g,this.float32[T+3]=h,this.float32[T+4]=v,n}}Xa.prototype.bytesPerElement=20,Gn(Xa,"StructArrayLayout5f20");class rg extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T){const P=this.length;return this.resize(P+1),this.emplace(P,n,s,u,g,h,v,T)}emplace(n,s,u,g,h,v,T,P){const L=7*n;return this.float32[L+0]=s,this.float32[L+1]=u,this.float32[L+2]=g,this.float32[L+3]=h,this.float32[L+4]=v,this.float32[L+5]=T,this.float32[L+6]=P,n}}rg.prototype.bytesPerElement=28,Gn(rg,"StructArrayLayout7f28");class Nd extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,g){const h=this.length;return this.resize(h+1),this.emplace(h,n,s,u,g)}emplace(n,s,u,g,h){const v=6*n;return this.uint32[3*n+0]=s,this.uint16[v+2]=u,this.uint16[v+3]=g,this.uint16[v+4]=h,n}}Nd.prototype.bytesPerElement=12,Gn(Nd,"StructArrayLayout1ul3ui12");class og extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}og.prototype.bytesPerElement=2,Gn(og,"StructArrayLayout1ui2");class $d extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const g=2*n;return this.float32[g+0]=s,this.float32[g+1]=u,n}}$d.prototype.bytesPerElement=8,Gn($d,"StructArrayLayout2f8");class Vd extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T,P,L,w,M,D,I,R,B,j){const K=this.length;return this.resize(K+1),this.emplace(K,n,s,u,g,h,v,T,P,L,w,M,D,I,R,B,j)}emplace(n,s,u,g,h,v,T,P,L,w,M,D,I,R,B,j,K){const ne=16*n;return this.float32[ne+0]=s,this.float32[ne+1]=u,this.float32[ne+2]=g,this.float32[ne+3]=h,this.float32[ne+4]=v,this.float32[ne+5]=T,this.float32[ne+6]=P,this.float32[ne+7]=L,this.float32[ne+8]=w,this.float32[ne+9]=M,this.float32[ne+10]=D,this.float32[ne+11]=I,this.float32[ne+12]=R,this.float32[ne+13]=B,this.float32[ne+14]=j,this.float32[ne+15]=K,n}}Vd.prototype.bytesPerElement=64,Gn(Vd,"StructArrayLayout16f64");class Rf extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T){const P=this.length;return this.resize(P+1),this.emplace(P,n,s,u,g,h,v,T)}emplace(n,s,u,g,h,v,T,P){const L=10*n,w=5*n;return this.uint16[L+0]=s,this.uint16[L+1]=u,this.uint16[L+2]=g,this.uint16[L+3]=h,this.float32[w+2]=v,this.float32[w+3]=T,this.float32[w+4]=P,n}}Rf.prototype.bytesPerElement=20,Gn(Rf,"StructArrayLayout4ui3f20");class Df extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.int16[1*n+0]=s,n}}Df.prototype.bytesPerElement=2,Gn(Df,"StructArrayLayout1i2");class Lf extends zo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint8[1*n+0]=s,n}}Lf.prototype.bytesPerElement=1,Gn(Lf,"StructArrayLayout1ub1");class ry extends Fd{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ry.prototype.size=40;class Of extends mu{get(n){return new ry(this,n)}}Gn(Of,"CollisionBoxArray");class Ud extends Fd{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}Ud.prototype.size=60;class ig extends tg{get(n){return new Ud(this,n)}}Gn(ig,"PlacedSymbolArray");class oy extends Fd{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(n){this._structArray.uint32[this._pos4+14]=n}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(n){this._structArray.float32[this._pos4+18]=n}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}oy.prototype.size=80;class sg extends ng{get(n){return new oy(this,n)}}Gn(sg,"SymbolInstanceArray");class iy extends vu{getoffsetX(n){return this.float32[1*n+0]}}Gn(iy,"GlyphOffsetArray");class zf extends Pl{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}Gn(zf,"SymbolLineVertexArray");class sy extends Fd{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}sy.prototype.size=12;class ay extends Nd{get(n){return new sy(this,n)}}Gn(ay,"FeatureIndexArray");class ly extends Ll{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}Gn(ly,"FillExtrusionCentroidArray");class cy extends Fd{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}cy.prototype.size=6;class ag extends kf{get(n){return new cy(this,n)}}Gn(ag,"FillExtrusionWallArray");const P1=oo([{name:"a_pos",components:2,type:"Int16"}],4),R1=oo([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Zo{constructor(n=[]){this.segments=n}_prepareSegment(n,s,u,g){let h=this.segments[this.segments.length-1];return n>Zo.MAX_VERTEX_ARRAY_LENGTH&&Hn(`Max vertices per segment is ${Zo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!h||h.vertexLength+n>Zo.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==g)&&(h={vertexOffset:s,primitiveOffset:u,vertexLength:0,primitiveLength:0},g!==void 0&&(h.sortKey=g),this.segments.push(h)),h}prepareSegment(n,s,u,g){return this._prepareSegment(n,s.length,u.length,g)}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,u,g){return new Zo([{vertexOffset:n,primitiveOffset:s,vertexLength:u,primitiveLength:g,vaos:{},sortKey:0}])}}function uy(c,n){return 256*(c=Zt(Math.floor(c),0,255))+Zt(Math.floor(n),0,255)}Zo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Gn(Zo,"SegmentVector");const D1=oo([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),L1=oo([{name:"a_dash",components:4,type:"Uint16"}]);class jd{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(n,s,u,g){this.ids.push(dy(n)),this.positions.push(s,u,g)}eachPosition(n,s){const u=dy(n);let g=0,h=this.ids.length-1;for(;g<h;){const v=g+h>>1;this.ids[v]>=u?h=v:g=v+1}for(;this.ids[g]===u;)s(this.positions[3*g],this.positions[3*g+1],this.positions[3*g+2]),g++}static serialize(n,s){const u=new Float64Array(n.ids),g=new Uint32Array(n.positions);return _u(u,g,0,u.length-1),s&&(s.add(u.buffer),s.add(g.buffer)),{ids:u,positions:g}}static deserialize(n){const s=new jd;let u;s.ids=n.ids,s.positions=n.positions;for(const g of s.ids)g!==u&&s.uniqueIds.push(g),u=g;return s.indexed=!0,s}}function dy(c){const n=+c;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:ss(String(c))}function _u(c,n,s,u){for(;s<u;){const g=c[s+u>>1];let h=s-1,v=u+1;for(;;){do h++;while(c[h]<g);do v--;while(c[v]>g);if(h>=v)break;Bf(c,h,v),Bf(n,3*h,3*v),Bf(n,3*h+1,3*v+1),Bf(n,3*h+2,3*v+2)}v-s<u-v?(_u(c,n,s,v),s=v+1):(_u(c,n,v+1,u),u=v)}}function Bf(c,n,s){const u=c[n];c[n]=c[s],c[s]=u}Gn(jd,"FeaturePositionMap");class Ja{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,s),this.initialized=!0),!!this.location}set(n,s,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class gc extends Ja{constructor(n){super(n),this.current=0}set(n,s,u){this.fetchUniformLocation(n,s)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class ji extends Ja{constructor(n){super(n),this.current=0}set(n,s,u){this.fetchUniformLocation(n,s)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Ta extends Ja{constructor(n){super(n),this.current=[0,0]}set(n,s,u){this.fetchUniformLocation(n,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class lg extends Ja{constructor(n){super(n),this.current=[0,0,0]}set(n,s,u){this.fetchUniformLocation(n,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class Ff extends Ja{constructor(n){super(n),this.current=[0,0,0,0]}set(n,s,u){this.fetchUniformLocation(n,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class cg extends Ja{constructor(n){super(n),this.current=co.transparent.toRenderColor(null)}set(n,s,u){this.fetchUniformLocation(n,s)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const hy=new Float32Array(16);class Hd extends Ja{constructor(n){super(n),this.current=hy}set(n,s,u){if(this.fetchUniformLocation(n,s)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let g=1;g<16;g++)if(u[g]!==this.current[g]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const O1=new Float32Array(9),z1=new Float32Array(4);class ug extends Ja{constructor(n){super(n),this.current=z1}set(n,s,u){if(this.fetchUniformLocation(n,s)){for(let g=0;g<4;g++)if(u[g]!==this.current[g]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function dg(c){return[uy(255*c.r,255*c.g),uy(255*c.b,255*c.a)]}class Gd{constructor(n,s,u,g){this.value=n,this.uniformNames=s.map(h=>`u_${h}`),this.type=u,this.context=g}setUniform(n,s,u,g,h){const v=g.constantOr(this.value);s.set(n,h,v instanceof co?v.toRenderColor(this.context.lut):v)}getBinding(n,s){return this.type==="color"?new cg(n):new ji(n)}}class yu{constructor(n,s){this.uniformNames=s.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,s,u,g,h){const v=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;v&&s.set(n,h,v)}getBinding(n,s){return s==="u_pattern"||s==="u_dash"?new Ff(n):new ji(n)}}class Ca{constructor(n,s,u,g){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=s.map(h=>({name:`a_${h}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(n,s,u,g,h,v,T){const P=this.paintVertexArray.length,L=this.expression.evaluate(new Ko(0,{brightness:v}),s,{},h,g,T);this.paintVertexArray.resize(n),this._setPaintValue(P,n,L,this.context)}updatePaintArray(n,s,u,g,h,v,T){const P=this.expression.evaluate({zoom:0,brightness:T},u,g,void 0,h);this._setPaintValue(n,s,P,this.context)}_setPaintValue(n,s,u,g){if(this.type==="color"){const h=dg(u.toRenderColor(g.lut));for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,h[0],h[1])}else{for(let h=n;h<s;h++)this.paintVertexArray.emplace(h,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Es{constructor(n,s,u,g,h,v){this.expression=n,this.uniformNames=s.map(T=>`u_${T}_t`),this.type=u,this.useIntegerZoom=g,this.context=h,this.maxValue=0,this.paintVertexAttributes=s.map(T=>({name:`a_${T}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(n,s,u,g,h,v,T){const P=this.expression.evaluate(new Ko(this.context.zoom,{brightness:v}),s,{},h,g,T),L=this.expression.evaluate(new Ko(this.context.zoom+1,{brightness:v}),s,{},h,g,T),w=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(w,n,P,L,this.context)}updatePaintArray(n,s,u,g,h,v,T){const P=this.expression.evaluate({zoom:this.context.zoom,brightness:T},u,g,void 0,h),L=this.expression.evaluate({zoom:this.context.zoom+1,brightness:T},u,g,void 0,h);this._setPaintValue(n,s,P,L,this.context)}_setPaintValue(n,s,u,g,h){if(this.type==="color"){const v=dg(u.toRenderColor(h.lut)),T=dg(u.toRenderColor(h.lut));for(let P=n;P<s;P++)this.paintVertexArray.emplace(P,v[0],v[1],T[0],T[1])}else{for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,u,g);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(g))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s,u,g,h){const v=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,T=Zt(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);s.set(n,h,T)}getBinding(n,s){return new ji(n)}}class Ea{constructor(n,s,u,g,h){this.expression=n,this.layerId=h,this.paintVertexAttributes=(u==="array"?L1:D1).members;for(let v=0;v<s.length;++v);this.paintVertexArray=new g}populatePaintArray(n,s,u,g){const h=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(h,n,s.patterns&&s.patterns[this.layerId],u)}updatePaintArray(n,s,u,g,h,v,T){this._setPaintValues(n,s,u.patterns&&u.patterns[this.layerId],v)}_setPaintValues(n,s,u,g){if(!g||!u)return;const h=g[u];if(!h)return;const{tl:v,br:T,pixelRatio:P}=h;for(let L=n;L<s;L++)this.paintVertexArray.emplace(L,v[0],v[1],T[0],T[1],P)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class vc{constructor(n,s,u=()=>!0){this.binders={},this._buffers=[],this.context=s;const g=[];for(const h in n.paint._values){const v=n.paint.get(h);if(!u(h)||!(v instanceof du&&ff(v.property.specification)))continue;const T=F1(h,n.type),P=v.value,L=v.property.specification.type,w=!!v.property.useIntegerZoom,M=h==="line-dasharray"||h.endsWith("pattern"),D=h==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant";if(P.kind!=="constant"||D)if(P.kind==="source"||D||M){const I=f(h,L,"source");this.binders[h]=M?new Ea(P,T,L,I,n.id):new Ca(P,T,L,I),g.push(`/a_${h}`)}else{const I=f(h,L,"composite");this.binders[h]=new Es(P,T,L,w,s,I),g.push(`/z_${h}`)}else this.binders[h]=M?new yu(P.value,T):new Gd(P.value,T,L,s),g.push(`/u_${h}`)}this.cacheKey=g.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof Ca||s instanceof Es?s.maxValue:0}populatePaintArrays(n,s,u,g,h,v,T){for(const P in this.binders){const L=this.binders[P];L.context=this.context,(L instanceof Ca||L instanceof Es||L instanceof Ea)&&L.populatePaintArray(n,s,u,g,h,v,T)}}setConstantPatternPositions(n){for(const s in this.binders){const u=this.binders[s];u instanceof yu&&u.setConstantPatternPositions(n)}}updatePaintArrays(n,s,u,g,h,v,T,P){let L=!1;const w=Object.keys(n),M=w.length!==0,D=M?w:s.uniqueIds;this.context.lut=h.lut;for(const I in this.binders){const R=this.binders[I];if(R.context=this.context,(R instanceof Ca||R instanceof Es||R instanceof Ea)&&(R.expression.isStateDependent===!0||R.expression.isLightConstant===!1)){const B=h.paint.get(I);R.expression=B.value;for(const j of D){const K=n[j.toString()];s.eachPosition(j,(ne,oe,Y)=>{const ae=g.feature(ne);R.updatePaintArray(oe,Y,ae,K,v,T,P)})}if(!M)for(const j of u.uniqueIds){const K=n[j.toString()];u.eachPosition(j,(ne,oe,Y)=>{const ae=g.feature(ne);R.updatePaintArray(oe,Y,ae,K,v,T,P)})}L=!0}}return L}defines(){const n=[];for(const s in this.binders){const u=this.binders[s];(u instanceof Gd||u instanceof yu)&&n.push(...u.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Ca||u instanceof Es||u instanceof Ea)for(let g=0;g<u.paintVertexAttributes.length;g++)n.push(u.paintVertexAttributes[g].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Gd||u instanceof yu||u instanceof Es)for(const g of u.uniformNames)n.push(g)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const s=[];for(const u in this.binders){const g=this.binders[u];if(g instanceof Gd||g instanceof yu||g instanceof Es)for(const h of g.uniformNames)s.push({name:h,property:u,binding:g.getBinding(n,h)})}return s}setUniforms(n,s,u,g,h){for(const{name:v,property:T,binding:P}of u)this.binders[T].setUniform(n,P,h,g.get(T),v)}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Ca||s instanceof Es||s instanceof Ea)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(n){for(const s in this.binders){const u=this.binders[s];(u instanceof Ca||u instanceof Es||u instanceof Ea)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof Ca||s instanceof Es||s instanceof Ea)&&s.destroy()}}}class Ol{constructor(n,s,u=()=>!0){this.programConfigurations={};for(const g of n)this.programConfigurations[g.id]=new vc(g,s,u);this.needsUpload=!1,this._featureMap=new jd,this._featureMapWithoutIds=new jd,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(n,s,u,g,h,v,T,P){for(const L in this.programConfigurations)this.programConfigurations[L].populatePaintArrays(n,s,g,h,v,T,P);s.id!==void 0?this._featureMap.add(s.id,u,this._bufferOffset,n):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,n),this._idlessCounter+=1),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,u,g,h,v){for(const T of u)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(n,this._featureMap,this._featureMapWithoutIds,s,T,g,h,v||0)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const B1={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function F1(c,n){return B1[c]||[c.replace(`${n}-`,"").replace(/-/g,"_")]}const N1={"line-pattern":{source:Ya,composite:Ya},"fill-pattern":{source:Ya,composite:Ya},"fill-extrusion-pattern":{source:Ya,composite:Ya},"line-dasharray":{source:pc,composite:pc}},fy={color:{source:$d,composite:Za},number:{source:vu,composite:$d}};function f(c,n,s){const u=N1[c];return u&&u[s]||fy[n][s]}Gn(Gd,"ConstantBinder"),Gn(yu,"PatternConstantBinder"),Gn(Ca,"SourceExpressionBinder"),Gn(Ea,"PatternCompositeBinder"),Gn(Es,"CompositeExpressionBinder"),Gn(vc,"ProgramConfiguration",{omit:["_buffers"]}),Gn(Ol,"ProgramConfigurationSet");const r=An/Math.PI/2,l=5,p=6,b=16383,S=64,E=[S,32,16],O=-r,V=r;function H(c,n,s,u=r){return s=Mt(s),[c*Math.sin(s)*u,-n*u,c*Math.cos(s)*u]}function W(c,n,s){return H(Math.cos(Mt(c)),Math.sin(Mt(c)),n,s)}const J=63710088e-1,ee=2*Math.PI*J;class re{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new re(ir(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,u=this.lat*s,g=n.lat*s,h=Math.sin(u)*Math.sin(g)+Math.cos(u)*Math.cos(g)*Math.cos((n.lng-this.lng)*s);return J*Math.acos(Math.min(h,1))}toBounds(n=0){const s=360*n/40075017,u=s/Math.cos(Math.PI/180*this.lat);return new ve({lng:this.lng-u,lat:this.lat-s},{lng:this.lng+u,lat:this.lat+s})}toEcef(n){return W(this.lat,this.lng,r+n*r/J)}static convert(n){if(n instanceof re)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new re(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new re(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ve{constructor(n,s){if(n)if(s)this.setSouthWest(n).setNorthEast(s);else if(n.length===4){const u=n;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{const u=n;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(n){return this._ne=n instanceof re?new re(n.lng,n.lat):re.convert(n),this}setSouthWest(n){return this._sw=n instanceof re?new re(n.lng,n.lat):re.convert(n),this}extend(n){const s=this._sw,u=this._ne;let g,h;if(n instanceof re)g=n,h=n;else{if(!(n instanceof ve))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(ve.convert(n)):this.extend(re.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(re.convert(n)):this;if(g=n._sw,h=n._ne,!g||!h)return this}return s||u?(s.lng=Math.min(g.lng,s.lng),s.lat=Math.min(g.lat,s.lat),u.lng=Math.max(h.lng,u.lng),u.lat=Math.max(h.lat,u.lat)):(this._sw=new re(g.lng,g.lat),this._ne=new re(h.lng,h.lat)),this}getCenter(){return new re((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new re(this.getWest(),this.getNorth())}getSouthEast(){return new re(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:s,lat:u}=re.convert(n);let g=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&g}static convert(n){if(n)return n instanceof ve?n:new ve(n)}}const _e=0,xe=25.5;function we(c){return ee*Math.cos(c*Math.PI/180)}function ze(c){return(180+c)/360}function Ne(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Le(c,n){return c/we(n)}function je(c){return 360*c-180}function Ue(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function rt(c,n){return c*we(Ue(n))}const Qe=85.051129;function ot(c){return Math.cos(Mt(Zt(c,-Qe,Qe)))}function gt(c,n){const s=Zt(n,_e,xe),u=Math.pow(2,s);return ot(c)*ee/(512*u)}function ht(c){return 1/Math.cos(c*Math.PI/180)}function ct(c,n=0){const s=Math.exp(Math.PI*(1-(c.y+n/An)/(1<<c.z)*2));return 80150034*s/(s*s+1)/An/(1<<c.z)}class Ct{constructor(n,s,u=0){this.x=+n,this.y=+s,this.z=+u}static fromLngLat(n,s=0){const u=re.convert(n);return new Ct(ze(u.lng),Ne(u.lat),Le(s,u.lat))}toLngLat(){return new re(je(this.x),Ue(this.y))}toAltitude(){return rt(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ee*ht(Ue(this.y))}}function Kt(c,n,s,u,g,h,v,T,P){const L=(n+u)/2,w=(s+g)/2,M=new et(L,w);T(M),function(D,I,R,B,j,K){const ne=R-j,oe=B-K;return Math.abs((B-I)*ne-(R-D)*oe)/Math.hypot(ne,oe)}(M.x,M.y,h.x,h.y,v.x,v.y)>=P?(Kt(c,n,s,L,w,h,M,T,P),Kt(c,L,w,u,g,M,v,T,P)):c.push(v)}function cn(c,n,s){let u=c[0],g=u.x,h=u.y;n(u);const v=[u];for(let T=1;T<c.length;T++){const P=c[T],{x:L,y:w}=P;n(P),Kt(v,g,h,L,w,u,P,n,s),g=L,h=w,u=P}return v}function qt(c,n,s,u){if(u(n,s)){const g=n.add(s)._mult(.5);qt(c,n,g,u),qt(c,g,s,u)}else c.push(s)}function yn(c,n){let s=c[0];const u=[s];for(let g=1;g<c.length;g++){const h=c[g];qt(u,s,h,n),s=h}return u}const Et=Math.pow(2,14)-1,nn=-Et-1;function Qt(c,n){const s=Math.round(c.x*n),u=Math.round(c.y*n);return c.x=Zt(s,nn,Et),c.y=Zt(u,nn,Et),(s<c.x||s>c.x+1||u<c.y||u>c.y+1)&&Hn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function bn(c,n,s){const u=c.loadGeometry(),g=c.extent,h=An/g;if(n&&s&&s.projection.isReprojectedInTileSpace){const v=1<<n.z,{scale:T,x:P,y:L,projection:w}=s,M=D=>{const I=je((n.x+D.x/g)/v),R=Ue((n.y+D.y/g)/v),B=w.project(I,R);D.x=(B.x*T-P)*g,D.y=(B.y*T-L)*g};for(let D=0;D<u.length;D++)if(c.type!==1)u[D]=cn(u[D],M,1);else{const I=[];for(const R of u[D])R.x<0||R.x>=g||R.y<0||R.y>=g||(M(R),I.push(R));u[D]=I}}for(const v of u)for(const T of v)Qt(T,h);return u}function wn(c,n){return{type:c.type,id:c.id,properties:c.properties,geometry:n?bn(c):[]}}function an(c,n,s,u,g){c.emplaceBack(2*n+(u+1)/2,2*s+(g+1)/2)}function pn(c,n,s){c.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class er{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new Pl,this.indexArray=new Ii,this.segments=new Zo,this.programConfigurations=new Ol(n.layers,{zoom:n.zoom,lut:n.lut}),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}updateFootprints(n,s){}populate(n,s,u,g){const h=this.layers[0],v=[];let T=null;h.type==="circle"&&(T=h.layout.get("circle-sort-key"));for(const{feature:L,id:w,index:M,sourceLayerIndex:D}of n){const I=this.layers[0]._featureFilter.needGeometry,R=wn(L,I);if(!this.layers[0]._featureFilter.filter(new Ko(this.zoom),R,u))continue;const B=T?T.evaluate(R,{},u):void 0,j={id:w,properties:L.properties,type:L.type,sourceLayerIndex:D,index:M,geometry:I?R.geometry:bn(L,u,g),patterns:{},sortKey:B};v.push(j)}T&&v.sort((L,w)=>L.sortKey-w.sortKey);let P=null;g.projection.name==="globe"&&(this.globeExtVertexArray=new Pf,P=g.projection);for(const L of v){const{geometry:w,index:M,sourceLayerIndex:D}=L,I=n[M].feature;this.addFeature(L,w,M,s.availableImages,u,P,s.brightness),s.featureIndex.insert(I,w,M,D,this.index)}}update(n,s,u,g,h){const v=Object.keys(n).length!==0;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,s,v?this.stateDependentLayers:this.layers,u,g,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,P1.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,R1.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,s,u,g,h,v,T){for(const P of s)for(const L of P){const w=L.x,M=L.y;if(w<0||w>=An||M<0||M>=An)continue;if(v){const R=v.projectTilePoint(w,M,h),B=v.upVector(h,w,M),j=this.globeExtVertexArray;pn(j,R,B),pn(j,R,B),pn(j,R,B),pn(j,R,B)}const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),I=D.vertexLength;an(this.layoutVertexArray,w,M,-1,-1),an(this.layoutVertexArray,w,M,1,-1),an(this.layoutVertexArray,w,M,1,1),an(this.layoutVertexArray,w,M,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+2,I+3),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{},g,h,T)}}function Mn(c,n){for(let s=0;s<c.length;s++)if(Lo(n,c[s]))return!0;for(let s=0;s<n.length;s++)if(Lo(c,n[s]))return!0;return!!lr(c,n)}function $n(c,n,s){return!!Lo(c,n)||!!Dr(n,c,s)}function gr(c,n){if(c.length===1)return To(n,c[0]);for(let s=0;s<n.length;s++){const u=n[s];for(let g=0;g<u.length;g++)if(Lo(c,u[g]))return!0}for(let s=0;s<c.length;s++)if(To(n,c[s]))return!0;for(let s=0;s<n.length;s++)if(lr(c,n[s]))return!0;return!1}function Zn(c,n,s){if(c.length>1){if(lr(c,n))return!0;for(let u=0;u<n.length;u++)if(Dr(n[u],c,s))return!0}for(let u=0;u<c.length;u++)if(Dr(c[u],n,s))return!0;return!1}function lr(c,n){if(c.length===0||n.length===0)return!1;for(let s=0;s<c.length-1;s++){const u=c[s],g=c[s+1];for(let h=0;h<n.length-1;h++)if(zr(u,g,n[h],n[h+1]))return!0}return!1}function zr(c,n,s,u){return eo(c,s,u)!==eo(n,s,u)&&eo(c,n,s)!==eo(c,n,u)}function Dr(c,n,s){const u=s*s;if(n.length===1)return c.distSqr(n[0])<u;for(let g=1;g<n.length;g++)if(po(c,n[g-1],n[g])<u)return!0;return!1}function po(c,n,s){const u=n.distSqr(s);if(u===0)return c.distSqr(n);const g=((c.x-n.x)*(s.x-n.x)+(c.y-n.y)*(s.y-n.y))/u;return c.distSqr(g<0?n:g>1?s:s.sub(n)._mult(g)._add(n))}function To(c,n){let s,u,g,h=!1;for(let v=0;v<c.length;v++){s=c[v];for(let T=0,P=s.length-1;T<s.length;P=T++)u=s[T],g=s[P],u.y>n.y!=g.y>n.y&&n.x<(g.x-u.x)*(n.y-u.y)/(g.y-u.y)+u.x&&(h=!h)}return h}function Lo(c,n){let s=!1;for(let u=0,g=c.length-1;u<c.length;g=u++){const h=c[u],v=c[g];h.y>n.y!=v.y>n.y&&n.x<(v.x-h.x)*(n.y-h.y)/(v.y-h.y)+h.x&&(s=!s)}return s}function Vs(c,n,s,u,g){for(const v of c)if(n<=v.x&&s<=v.y&&u>=v.x&&g>=v.y)return!0;const h=[new et(n,s),new et(n,g),new et(u,g),new et(u,s)];if(c.length>2){for(const v of h)if(Lo(c,v))return!0}for(let v=0;v<c.length-1;v++)if(ri(c[v],c[v+1],h))return!0;return!1}function ri(c,n,s){const u=s[0],g=s[2];if(c.x<u.x&&n.x<u.x||c.x>g.x&&n.x>g.x||c.y<u.y&&n.y<u.y||c.y>g.y&&n.y>g.y)return!1;const h=eo(c,n,s[0]);return h!==eo(c,n,s[1])||h!==eo(c,n,s[2])||h!==eo(c,n,s[3])}function jr(c,n,s,u,g,h){let v=n.y-c.y,T=c.x-n.x;if(h=h||0){const P=v*v+T*T;if(P===0)return!0;const L=Math.sqrt(P);v/=L,T/=L}return!((s.x-c.x)*v+(s.y-c.y)*T-h<0||(u.x-c.x)*v+(u.y-c.y)*T-h<0||(g.x-c.x)*v+(g.y-c.y)*T-h<0)}function xo(c,n,s,u,g,h,v){return!(jr(c,n,u,g,h,v)||jr(n,s,u,g,h,v)||jr(s,c,u,g,h,v)||jr(u,g,c,n,s,v)||jr(g,h,c,n,s,v)||jr(h,u,c,n,s,v))}function Vo(c,n,s){const u=n.paint.get(c).value;return u.kind==="constant"?u.value:s.programConfigurations.get(n.id).getMaxValue(c)}function vo(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Lr(c,n,s,u,g){if(!n[0]&&!n[1])return c;const h=et.convert(n)._mult(g);s==="viewport"&&h._rotate(-u);const v=[];for(let T=0;T<c.length;T++)v.push(c[T].sub(h));return v}function io(c,n,s,u){const g=et.convert(c)._mult(u);return n==="viewport"&&g._rotate(-s),g}let uo,Yo;Gn(er,"CircleBucket",{omit:["layers"]});var oi,Yr={exports:{}},gi=(oi||(oi=1,function(c,n){(function(s){function u(h,v,T){var P=g(256*h,256*(v=Math.pow(2,T)-v-1),T),L=g(256*(h+1),256*(v+1),T);return P[0]+","+P[1]+","+L[0]+","+L[1]}function g(h,v,T){var P=2*Math.PI*6378137/256/Math.pow(2,T);return[h*P-2*Math.PI*6378137/2,v*P-2*Math.PI*6378137/2]}s.getURL=function(h,v,T,P,L,w){return w=w||{},h+"?"+["bbox="+u(T,P,L),"format="+(w.format||"image/png"),"service="+(w.service||"WMS"),"version="+(w.version||"1.1.1"),"request="+(w.request||"GetMap"),"srs="+(w.srs||"EPSG:3857"),"width="+(w.width||256),"height="+(w.height||256),"layers="+v].join("&")},s.getTileBBox=u,s.getMercCoords=g,Object.defineProperty(s,"__esModule",{value:!0})})(n)}(0,Yr.exports)),Yr.exports);class bi{constructor(n,s,u){this.z=n,this.x=s,this.y=u,this.key=Ji(0,n,n,s,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s){const u=gi.getTileBBox(this.x,this.y,this.z),g=function(h,v,T){let P,L="";for(let w=h;w>0;w--)P=1<<w-1,L+=(v&P?1:0)+(T&P?2:0);return L}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",g).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class vi{constructor(n,s){this.wrap=n,this.canonical=s,this.key=Ji(n,s.z,s.z,s.x,s.y)}}class Po{constructor(n,s,u,g,h){this.overscaledZ=n,this.wrap=s,this.canonical=new bi(u,+g,+h),this.key=s===0&&n===u?this.canonical.key:Ji(s,n,u,g,h)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const s=this.canonical.z-n;return n>this.canonical.z?new Po(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Po(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s=!0){if(this.overscaledZ===n&&s)return this.key;if(n>this.canonical.z)return Ji(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-n;return Ji(this.wrap*+s,n,n,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.z<this.canonical.z&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new Po(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,u=2*this.canonical.x,g=2*this.canonical.y;return[new Po(s,this.wrap,s,u,g),new Po(s,this.wrap,s,u+1,g),new Po(s,this.wrap,s,u,g+1),new Po(s,this.wrap,s,u+1,g+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new Po(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new Po(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new vi(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Ji(c,n,s,u,g){const h=1<<Math.min(s,22);let v=h*(g%h)+u%h;return c&&s<22&&(v+=h*h*((c<0?-2*c-1:2*c)%(1<<2*(22-s)))),16*(32*v+s)+(n-s)}const Qi=[c=>{let n=c.canonical.x-1,s=c.wrap;return n<0&&(n=(1<<c.canonical.z)-1,s--),new Po(c.overscaledZ,s,c.canonical.z,n,c.canonical.y)},c=>{let n=c.canonical.x+1,s=c.wrap;return n===1<<c.canonical.z&&(n=0,s++),new Po(c.overscaledZ,s,c.canonical.z,n,c.canonical.y)},c=>new Po(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new Po(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];Gn(bi,"CanonicalTileID"),Gn(Po,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Us=oo([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ms}=Us,ds=oo([{name:"a_pos_3",components:3,type:"Int16"}]);var js=oo([{name:"a_pos",type:"Int16",components:2}]);class Qa{constructor(n,s){this.pos=n,this.dir=s}intersectsPlane(n,s,u){const g=Pe.vec3.dot(s,this.dir);if(Math.abs(g)<1e-6)return!1;const h=((n[0]-this.pos[0])*s[0]+(n[1]-this.pos[1])*s[1]+(n[2]-this.pos[2])*s[2])/g;return u[0]=this.pos[0]+this.dir[0]*h,u[1]=this.pos[1]+this.dir[1]*h,u[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(n,s,u){if(Pe.vec3.equals(this.pos,n)||s===0)return u[0]=u[1]=u[2]=0,!1;const[g,h,v]=this.dir,T=this.pos[0]-n[0],P=this.pos[1]-n[1],L=this.pos[2]-n[2],w=g*g+h*h+v*v,M=2*(T*g+P*h+L*v),D=M*M-4*w*(T*T+P*P+L*L-s*s);if(D<0){const I=Math.max(-M/2,0),R=T+g*I,B=P+h*I,j=L+v*I,K=Math.hypot(R,B,j);return u[0]=R*s/K,u[1]=B*s/K,u[2]=j*s/K,!1}{const I=(-M-Math.sqrt(D))/(2*w);if(I<0){const R=Math.hypot(T,P,L);return u[0]=T*s/R,u[1]=P*s/R,u[2]=L*s/R,!1}return u[0]=T+g*I,u[1]=P+h*I,u[2]=L+v*I,!0}}}class zl{constructor(n,s,u,g,h){this.TL=n,this.TR=s,this.BR=u,this.BL=g,this.horizon=h}static fromInvProjectionMatrix(n,s,u){const g=[-1,1,1],h=[1,1,1],v=[1,-1,1],T=[-1,-1,1],P=Pe.vec3.transformMat4(g,g,n),L=Pe.vec3.transformMat4(h,h,n),w=Pe.vec3.transformMat4(v,v,n),M=Pe.vec3.transformMat4(T,T,n);return new zl(P,L,w,M,s/u)}}function Ma(c,n,s){let u=1/0,g=-1/0;const h=[];for(const v of c){Pe.vec3.sub(h,v,n);const T=Pe.vec3.dot(h,s);u=Math.min(u,T),g=Math.max(g,T)}return[u,g]}function bu(c,n){let s=!0;for(let u=0;u<c.planes.length;u++){const g=c.planes[u];let h=0;for(let v=0;v<n.length;v++)h+=Pe.vec3.dot(g,n[v])+g[3]>=0;if(h===0)return 0;h!==n.length&&(s=!1)}return s?2:1}function xu(c,n){for(const s of c.projections){const u=Ma(n,c.points[0],s.axis);if(s.projection[1]<u[0]||s.projection[0]>u[1])return 0}return 1}function Nf(c,n){let s=0;const u=[0,0,0,0];for(let g=0;g<c.length;g++)u[0]=c[g][0],u[1]=c[g][1],u[2]=c[g][2],u[3]=1,Pe.vec4.dot(u,n)>=0&&s++;return s}class wu{constructor(n,s){this.points=n||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=Ro.fromPoints(this.points),this.projections=[],this.frustumEdges=[Pe.vec3.sub([],this.points[2],this.points[3]),Pe.vec3.sub([],this.points[0],this.points[3]),Pe.vec3.sub([],this.points[4],this.points[0]),Pe.vec3.sub([],this.points[5],this.points[1]),Pe.vec3.sub([],this.points[6],this.points[2]),Pe.vec3.sub([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const g=[0,-u[2],u[1]],h=[u[2],0,-u[0]];this.projections.push({axis:g,projection:Ma(this.points,this.points[0],g)}),this.projections.push({axis:h,projection:Ma(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(n,s,u,g){const h=Math.pow(2,u),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(L=>{const w=Pe.vec4.transformMat4([],L,n),M=1/w[3]/s*h;return Pe.vec4.mul(w,w,[M,M,g?1/w[3]:M,M])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(L=>{const w=Pe.vec3.sub([],v[L[0]],v[L[1]]),M=Pe.vec3.sub([],v[L[2]],v[L[1]]),D=Pe.vec3.normalize([],Pe.vec3.cross([],w,M)),I=-Pe.vec3.dot(D,v[L[1]]);return D.concat(I)}),P=[];for(let L=0;L<v.length;L++)P.push([v[L][0],v[L][1],v[L][2]]);return new wu(P,T)}intersectsPrecise(n,s,u){for(let g=0;g<s.length;g++)if(!Nf(n,s[g]))return 0;for(let g=0;g<this.planes.length;g++)if(!Nf(n,this.planes[g]))return 0;for(const g of u)for(const h of this.frustumEdges){const v=Pe.vec3.cross([],g,h),T=Pe.vec3.length(v);if(T===0)continue;Pe.vec3.scale(v,v,1/T);const P=Ma(this.points,this.points[0],v),L=Ma(n,this.points[0],v);if(P[0]>L[1]||L[0]>P[1])return 0}return 1}containsPoint(n){for(const s of this.planes){const u=s[3];if(Pe.vec3.dot([s[0],s[1],s[2]],n)+u<0)return!1}return!0}}class Ro{static fromPoints(n){const s=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const g of n)Pe.vec3.min(s,s,g),Pe.vec3.max(u,u,g);return new Ro(s,u)}static fromTileIdAndHeight(n,s,u){const g=1<<n.canonical.z,h=n.canonical.x,v=n.canonical.y;return new Ro([h/g,v/g,s],[(h+1)/g,(v+1)/g,u])}static applyTransform(n,s){const u=n.getCorners();for(let g=0;g<u.length;++g)Pe.vec3.transformMat4(u[g],u[g],s);return Ro.fromPoints(u)}static applyTransformFast(n,s){const u=[s[12],s[13],s[14]],g=[...u];for(let h=0;h<3;h++)for(let v=0;v<3;v++){const T=s[4*v+h],P=T*n.min[v],L=T*n.max[v];u[h]+=Math.min(P,L),g[h]+=Math.max(P,L)}return new Ro(u,g)}static projectAabbCorners(n,s){const u=n.getCorners();for(let g=0;g<u.length;++g)Pe.vec3.transformMat4(u[g],u[g],s);return u}constructor(n,s){this.min=n,this.max=s,this.center=Pe.vec3.scale([],Pe.vec3.add([],this.min,this.max),.5)}quadrant(n){const s=[n%2==0,n<2],u=Pe.vec3.clone(this.min),g=Pe.vec3.clone(this.max);for(let h=0;h<s.length;h++)u[h]=s[h]?this.min[h]:this.center[h],g[h]=s[h]?this.center[h]:this.max[h];return g[2]=this.max[2],new Ro(u,g)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,s=this.max;return[[n[0],n[1],n[2]],[s[0],n[1],n[2]],[s[0],s[1],n[2]],[n[0],s[1],n[2]],[n[0],n[1],s[2]],[s[0],n[1],s[2]],[s[0],s[1],s[2]],[n[0],s[1],s[2]]]}intersects(n){return this.intersectsAabb(n.bounds)?bu(n,this.getCorners()):0}intersectsFlat(n){return this.intersectsAabb(n.bounds)?bu(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(n,s){return s||this.intersects(n)?xu(n,this.getCorners()):0}intersectsPreciseFlat(n,s){return s||this.intersectsFlat(n)?xu(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(n){for(let s=0;s<3;++s)if(this.min[s]>n.max[s]||n.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(n){return!(this.min[0]>n.max[0]||n.min[0]>this.max[0]||this.min[1]>n.max[1]||n.min[1]>this.max[1])}encapsulate(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n.min[s]),this.max[s]=Math.max(this.max[s],n.max[s])}encapsulatePoint(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n[s]),this.max[s]=Math.max(this.max[s],n[s])}closestPoint(n){return[Math.max(Math.min(this.max[0],n[0]),this.min[0]),Math.max(Math.min(this.max[1],n[1]),this.min[1]),Math.max(Math.min(this.max[2],n[2]),this.min[2])]}}function _c(c){return c*r/J}Gn(Ro,"Aabb");const $1=[new Ro([O,O,O],[V,V,V]),new Ro([O,O,O],[0,0,V]),new Ro([0,O,O],[V,0,V]),new Ro([O,0,O],[0,V,V]),new Ro([0,0,O],[V,V,V])];function py(c,n,s,u=!0){const g=Pe.vec3.scale([],c._camera.position,c.worldSize),h=[n,s,1,1];Pe.vec4.transformMat4(h,h,c.pixelMatrixInverse),Pe.vec4.scale(h,h,1/h[3]);const v=Pe.vec3.sub([],h,g),T=Pe.vec3.normalize([],v),P=c.globeMatrix,L=[P[12],P[13],P[14]],w=Pe.vec3.sub([],L,g),M=Pe.vec3.length(w),D=Pe.vec3.normalize([],w),I=c.worldSize/(2*Math.PI),R=Pe.vec3.dot(D,T),B=Math.asin(I/M);if(B<Math.acos(R)){if(!u)return null;const Xe=[],$e=[];Pe.vec3.scale(Xe,T,M/R),Pe.vec3.normalize($e,Pe.vec3.sub($e,Xe,w)),Pe.vec3.normalize(T,Pe.vec3.add(T,w,Pe.vec3.scale(T,$e,Math.tan(B)*M)))}const j=[];new Qa(g,T).closestPointOnSphere(L,I,j);const K=Pe.vec3.normalize([],Ns(P,0)),ne=Pe.vec3.normalize([],Ns(P,1)),oe=Pe.vec3.normalize([],Ns(P,2)),Y=Pe.vec3.dot(K,j),ae=Pe.vec3.dot(ne,j),me=Pe.vec3.dot(oe,j),Ee=en(Math.asin(-ae/I));let Oe=en(Math.atan2(Y,me));Oe=c.center.lng+function(Xe,$e){const tt=($e-Xe+180)%360-180;return tt<-180?tt+360:tt}(c.center.lng,Oe);const Be=ze(Oe),De=Zt(Ne(Ee),0,1);return new Ct(Be,De)}class NB{constructor(n,s,u){this.a=Pe.vec3.sub([],n,u),this.b=Pe.vec3.sub([],s,u),this.center=u;const g=Pe.vec3.normalize([],this.a),h=Pe.vec3.normalize([],this.b);this.angle=Math.acos(Pe.vec3.dot(g,h))}}function V1(c,n){if(c.angle===0)return null;let s;return s=c.a[n]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[n]/c.a[n]/Math.sin(c.angle)-1/Math.tan(c.angle)),s<0||s>1?null:function(u,g,h,v){const T=Math.sin(h);return u*(Math.sin((1-v)*h)/T)+g*(Math.sin(v*h)/T)}(c.a[n],c.b[n],c.angle,Zt(s,0,1))+c.center[n]}function Bl(c){if(c.z<=1)return $1[c.z+2*c.y+c.x];const n=U1(my(c));return Ro.fromPoints(n)}function yc(c,n,s){return Pe.vec3.scale(c,c,1-s),Pe.vec3.scaleAndAdd(c,c,n,s)}function bE(c,n,s){for(const u of c)Pe.vec3.transformMat4(u,u,n),Pe.vec3.scale(u,u,s)}function xE(c,n,s,u){const g=n/c.worldSize,h=c.globeMatrix;if(s.z<=1){const Be=Bl(s).getCorners();return bE(Be,h,g),Ro.fromPoints(Be)}const v=my(s,u),T=U1(v,r+_c(c._tileCoverLift));bE(T,h,g);const P=Number.MAX_VALUE,L=[-P,-P,-P],w=[P,P,P];if(v.contains(c.center)){for(const Xe of T)Pe.vec3.min(w,w,Xe),Pe.vec3.max(L,L,Xe);L[2]=0;const Be=c.point,De=[Be.x*g,Be.y*g,0];return Pe.vec3.min(w,w,De),Pe.vec3.max(L,L,De),new Ro(w,L)}if(c._tileCoverLift>0){for(const Be of T)Pe.vec3.min(w,w,Be),Pe.vec3.max(L,L,Be);return new Ro(w,L)}const M=[h[12]*g,h[13]*g,h[14]*g],D=v.getCenter(),I=Zt(c.center.lat,-Qe,Qe),R=Zt(D.lat,-Qe,Qe),B=ze(c.center.lng),j=Ne(I);let K=B-ze(D.lng);const ne=j-Ne(R);K>.5?K-=1:K<-.5&&(K+=1);let oe=0;if(Math.abs(K)>Math.abs(ne))oe=K>=0?1:3;else{oe=ne>=0?0:2;const Be=[h[4]*g,h[5]*g,h[6]*g],De=-Math.sin(Mt(ne>=0?v.getSouth():v.getNorth()))*r;Pe.vec3.scaleAndAdd(M,M,Be,De)}const Y=T[oe],ae=T[(oe+1)%4],me=new NB(Y,ae,M),Ee=[V1(me,0)||Y[0],V1(me,1)||Y[1],V1(me,2)||Y[2]],Oe=Su(c.zoom);if(Oe>0){const Be=function({x:Xe,y:$e,z:tt},ft,vt,yt,wt){const Bt=1/(1<<tt);let St=Xe*Bt,Xt=St+Bt,un=$e*Bt,Gt=un+Bt,On=0;const In=(St+Xt)/2-yt;return In>.5?On=-1:In<-.5&&(On=1),St=((St+On)*ft-(yt*=ft))*vt+yt,Xt=((Xt+On)*ft-yt)*vt+yt,un=(un*ft-(wt*=ft))*vt+wt,Gt=(Gt*ft-wt)*vt+wt,[[St,Gt,0],[Xt,Gt,0],[Xt,un,0],[St,un,0]]}(s,n,c._pixelsPerMercatorPixel,B,j);for(let Xe=0;Xe<T.length;Xe++)yc(T[Xe],Be[Xe],Oe);const De=Pe.vec3.add([],Be[oe],Be[(oe+1)%4]);Pe.vec3.scale(De,De,.5),yc(Ee,De,Oe)}for(const Be of T)Pe.vec3.min(w,w,Be),Pe.vec3.max(L,L,Be);return w[2]=Math.min(Y[2],ae[2]),Pe.vec3.min(w,w,Ee),Pe.vec3.max(L,L,Ee),new Ro(w,L)}function my({x:c,y:n,z:s},u=!1){const g=1/(1<<s),h=new re(je(c*g),n===(1<<s)-1&&u?-90:Ue((n+1)*g)),v=new re(je((c+1)*g),n===0&&u?90:Ue(n*g));return new ve(h,v)}function U1(c,n=r){const s=Mt(c.getNorth()),u=Mt(c.getSouth()),g=Math.cos(s),h=Math.cos(u),v=Math.sin(s),T=Math.sin(u),P=c.getWest(),L=c.getEast();return[H(h,T,P,n),H(h,T,L,n),H(g,v,L,n),H(g,v,P,n)]}function hg(c,n,s,u){const g=1<<s.z,h=(c/An+s.x)/g;return W(Ue((n/An+s.y)/g),je(h),u)}function gy({min:c,max:n}){return b/Math.max(n[0]-c[0],n[1]-c[1],n[2]-c[2])}const wE=new Float64Array(16);function vy(c){const n=gy(c),s=Pe.mat4.fromScaling(wE,[n,n,n]);return Pe.mat4.translate(s,s,Pe.vec3.negate([],c.min))}function j1(c){const n=Pe.mat4.fromTranslation(wE,c.min),s=1/gy(c);return Pe.mat4.scale(n,n,[s,s,s])}function H1(c){const n=An/(2*Math.PI);return c/(2*Math.PI)/n}function SE(c,n){return An/(512*Math.pow(2,c))*gy(Bl(n))}function TE(c,n,s,u,g){const h=H1(s),v=[c,n,-s/(2*Math.PI)],T=Pe.mat4.identity(new Float64Array(16));return Pe.mat4.translate(T,T,v),Pe.mat4.scale(T,T,[h,h,h]),Pe.mat4.rotateX(T,T,Mt(-g)),Pe.mat4.rotateY(T,T,Mt(-u)),T}function Su(c){return jn(l,p,c)}function CE(c,n){const s=W(n.lat,n.lng),u=function(h){const v=W(h._center.lat,h._center.lng),T=Pe.vec3.fromValues(0,1,0);let P=Pe.vec3.cross([],T,v);const L=Pe.mat4.fromRotation([],-h.angle,v);P=Pe.vec3.transformMat4(P,P,L),Pe.mat4.fromRotation(L,-h._pitch,P);const w=Pe.vec3.normalize([],v);return Pe.vec3.scale(w,w,_c(h.cameraToCenterDistance/h.pixelsPerMeter)),Pe.vec3.transformMat4(w,w,L),Pe.vec3.add([],v,w)}(c),g=Pe.vec3.subtract([],u,s);return Pe.vec3.angle(g,s)}function G1(c,n){return CE(c,n)>Math.PI/2*1.01}const EE=Mt(85),$B=Math.cos(EE),VB=Math.sin(EE),UB=Pe.mat4.create(),ME=c=>{const n=[];return c.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n};function IE(c,n,s,u,g,h,v,T,P){if(h&&c.queryGeometry.isAboveHorizon)return!1;h&&(P*=c.pixelToTileUnitsFactor);const L=c.tileID.canonical,w=s.projection.upVectorScale(L,s.center.lat,s.worldSize).metersToTile;for(const M of n)for(const D of M){const I=D.add(T),R=g&&s.elevation?s.elevation.exaggeration()*g.getElevationAt(I.x,I.y,!0):0,B=s.projection.projectTilePoint(I.x,I.y,L);if(R>0){const oe=s.projection.upVector(L,I.x,I.y);B.x+=oe[0]*w*R,B.y+=oe[1]*w*R,B.z+=oe[2]*w*R}const j=h?I:jB(B.x,B.y,B.z,u),K=h?c.tilespaceRays.map(oe=>GB(oe,R)):c.queryGeometry.screenGeometry,ne=Pe.vec4.transformMat4([],[B.x,B.y,B.z,1],u);if(!v&&h?P*=ne[3]/s.cameraToCenterDistance:v&&!h&&(P*=s.cameraToCenterDistance/ne[3]),h){const oe=Ue((D.y/An+L.y)/(1<<L.z));P/=s.projection.pixelsPerMeter(oe,1)/Le(1,oe)}if($n(K,j,P))return!0}return!1}function jB(c,n,s,u){const g=Pe.vec4.transformMat4([],[c,n,s,1],u);return new et(g[0]/g[3],g[1]/g[3])}const kE=Pe.vec3.fromValues(0,0,0),HB=Pe.vec3.fromValues(0,0,1);function GB(c,n){const s=Pe.vec3.create();return kE[2]=n,c.intersectsPlane(kE,HB,s),new et(s[0],s[1])}class AE extends er{}let PE,RE,DE,LE;function OE(c,{width:n,height:s},u,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==n*s*u)throw new RangeError("mismatched image size")}else g=new Uint8Array(n*s*u);return c.width=n,c.height=s,c.data=g,c}function zE(c,n,s){const{width:u,height:g}=n;u===c.width&&g===c.height||(W1(c,n,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,u),height:Math.min(c.height,g)},s,null),c.width=u,c.height=g,c.data=n.data)}function W1(c,n,s,u,g,h,v,T){if(g.width===0||g.height===0)return n;if(g.width>c.width||g.height>c.height||s.x>c.width-g.width||s.y>c.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>n.width||g.height>n.height||u.x>n.width-g.width||u.y>n.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const P=c.data,L=n.data,w=h===4&&T;for(let M=0;M<g.height;M++){const D=((s.y+M)*c.width+s.x)*h,I=((u.y+M)*n.width+u.x)*h;if(w)for(let R=0;R<g.width;R++){const B=D+R*h+3,j=I+R*h;L[j+0]=255,L[j+1]=255,L[j+2]=255,L[j+3]=P[B]}else if(v)for(let R=0;R<g.width;R++){const B=D+R*h,j=I+R*h,K=P[B+3],ne=new co(P[B+0]/255*K,P[B+1]/255*K,P[B+2]/255*K,K).toRenderColor(v).toArray();L[j+0]=ne[0],L[j+1]=ne[1],L[j+2]=ne[2],L[j+3]=ne[3]}else for(let R=0;R<g.width*h;R++)L[I+R]=P[D+R]}return n}Gn(AE,"HeatmapBucket",{omit:["layers"]});class Tu{constructor(n,s){OE(this,n,1,s)}resize(n){zE(this,new Tu(n),1)}clone(){return new Tu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,u,g,h){W1(n,s,u,g,h,1,null)}}class es{constructor(n,s){OE(this,n,4,s)}resize(n){zE(this,new es(n),4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new es({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,u,g,h,v,T){W1(n,s,u,g,h,4,v,T)}}class BE{constructor(n,s){this.width=n.width,this.height=n.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}function fg(c){const n={},s=c.resolution||256,u=c.clips?c.clips.length:1,g=c.image||new es({width:s,height:u}),h=(v,T,P)=>{n[c.evaluationKey]=P;const L=c.expression.evaluate(n);L&&(g.data[v+T+0]=Math.floor(255*L.r/L.a),g.data[v+T+1]=Math.floor(255*L.g/L.a),g.data[v+T+2]=Math.floor(255*L.b/L.a),g.data[v+T+3]=Math.floor(255*L.a))};if(c.clips)for(let v=0,T=0;v<u;++v,T+=4*s)for(let P=0,L=0;P<s;P++,L+=4){const w=P/(s-1),{start:M,end:D}=c.clips[v];h(T,L,M*(1-w)+D*w)}else for(let v=0,T=0;v<s;v++,T+=4)h(0,T,v/(s-1));return g}Gn(Tu,"AlphaImage"),Gn(es,"RGBAImage");const WB=oo([{name:"a_pos",components:2,type:"Int16"}],4),{members:qB}=WB;function pg(c,n,s=2){const u=n&&n.length,g=u?n[0]*s:c.length;let h=FE(c,0,g,s,!0);const v=[];if(!h||h.next===h.prev)return v;let T,P,L;if(u&&(h=function(w,M,D,I){const R=[];for(let B=0,j=M.length;B<j;B++){const K=FE(w,M[B]*I,B<j-1?M[B+1]*I:w.length,I,!1);K===K.next&&(K.steiner=!0),R.push(tF(K))}R.sort(JB);for(let B=0;B<R.length;B++)D=QB(R[B],D);return D}(c,n,h,s)),c.length>80*s){T=1/0,P=1/0;let w=-1/0,M=-1/0;for(let D=s;D<g;D+=s){const I=c[D],R=c[D+1];I<T&&(T=I),R<P&&(P=R),I>w&&(w=I),R>M&&(M=R)}L=Math.max(w-T,M-P),L=L!==0?32767/L:0}return mg(h,v,s,T,P,L,0),v}function FE(c,n,s,u,g){let h;if(g===function(v,T,P,L){let w=0;for(let M=T,D=P-L;M<P;M+=L)w+=(v[D]-v[M])*(v[M+1]+v[D+1]),D=M;return w}(c,n,s,u)>0)for(let v=n;v<s;v+=u)h=VE(v/u|0,c[v],c[v+1],h);else for(let v=s-u;v>=n;v-=u)h=VE(v/u|0,c[v],c[v+1],h);return h&&_y(h,h.next)&&(vg(h),h=h.next),h}function Wd(c,n){if(!c)return c;n||(n=c);let s,u=c;do if(s=!1,u.steiner||!_y(u,u.next)&&_i(u.prev,u,u.next)!==0)u=u.next;else{if(vg(u),u=n=u.prev,u===u.next)break;s=!0}while(s||u!==n);return n}function mg(c,n,s,u,g,h,v){if(!c)return;!v&&h&&function(P,L,w,M){let D=P;do D.z===0&&(D.z=q1(D.x,D.y,L,w,M)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==P);D.prevZ.nextZ=null,D.prevZ=null,function(I){let R,B=1;do{let j,K=I;I=null;let ne=null;for(R=0;K;){R++;let oe=K,Y=0;for(let me=0;me<B&&(Y++,oe=oe.nextZ,oe);me++);let ae=B;for(;Y>0||ae>0&&oe;)Y!==0&&(ae===0||!oe||K.z<=oe.z)?(j=K,K=K.nextZ,Y--):(j=oe,oe=oe.nextZ,ae--),ne?ne.nextZ=j:I=j,j.prevZ=ne,ne=j;K=oe}ne.nextZ=null,B*=2}while(R>1)}(D)}(c,u,g,h);let T=c;for(;c.prev!==c.next;){const P=c.prev,L=c.next;if(h?ZB(c,u,g,h):KB(c))n.push(P.i,c.i,L.i),vg(c),c=L.next,T=L.next;else if((c=L)===T){v?v===1?mg(c=YB(Wd(c),n),n,s,u,g,h,2):v===2&&XB(c,n,s,u,g,h):mg(Wd(c),n,s,u,g,h,1);break}}}function KB(c){const n=c.prev,s=c,u=c.next;if(_i(n,s,u)>=0)return!1;const g=n.x,h=s.x,v=u.x,T=n.y,P=s.y,L=u.y,w=g<h?g<v?g:v:h<v?h:v,M=T<P?T<L?T:L:P<L?P:L,D=g>h?g>v?g:v:h>v?h:v,I=T>P?T>L?T:L:P>L?P:L;let R=u.next;for(;R!==n;){if(R.x>=w&&R.x<=D&&R.y>=M&&R.y<=I&&$f(g,T,h,P,v,L,R.x,R.y)&&_i(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function ZB(c,n,s,u){const g=c.prev,h=c,v=c.next;if(_i(g,h,v)>=0)return!1;const T=g.x,P=h.x,L=v.x,w=g.y,M=h.y,D=v.y,I=T<P?T<L?T:L:P<L?P:L,R=w<M?w<D?w:D:M<D?M:D,B=T>P?T>L?T:L:P>L?P:L,j=w>M?w>D?w:D:M>D?M:D,K=q1(I,R,n,s,u),ne=q1(B,j,n,s,u);let oe=c.prevZ,Y=c.nextZ;for(;oe&&oe.z>=K&&Y&&Y.z<=ne;){if(oe.x>=I&&oe.x<=B&&oe.y>=R&&oe.y<=j&&oe!==g&&oe!==v&&$f(T,w,P,M,L,D,oe.x,oe.y)&&_i(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,Y.x>=I&&Y.x<=B&&Y.y>=R&&Y.y<=j&&Y!==g&&Y!==v&&$f(T,w,P,M,L,D,Y.x,Y.y)&&_i(Y.prev,Y,Y.next)>=0))return!1;Y=Y.nextZ}for(;oe&&oe.z>=K;){if(oe.x>=I&&oe.x<=B&&oe.y>=R&&oe.y<=j&&oe!==g&&oe!==v&&$f(T,w,P,M,L,D,oe.x,oe.y)&&_i(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;Y&&Y.z<=ne;){if(Y.x>=I&&Y.x<=B&&Y.y>=R&&Y.y<=j&&Y!==g&&Y!==v&&$f(T,w,P,M,L,D,Y.x,Y.y)&&_i(Y.prev,Y,Y.next)>=0)return!1;Y=Y.nextZ}return!0}function YB(c,n){let s=c;do{const u=s.prev,g=s.next.next;!_y(u,g)&&NE(u,s,s.next,g)&&gg(u,g)&&gg(g,u)&&(n.push(u.i,s.i,g.i),vg(s),vg(s.next),s=c=g),s=s.next}while(s!==c);return Wd(s)}function XB(c,n,s,u,g,h){let v=c;do{let T=v.next.next;for(;T!==v.prev;){if(v.i!==T.i&&nF(v,T)){let P=$E(v,T);return v=Wd(v,v.next),P=Wd(P,P.next),mg(v,n,s,u,g,h,0),void mg(P,n,s,u,g,h,0)}T=T.next}v=v.next}while(v!==c)}function JB(c,n){return c.x-n.x}function QB(c,n){const s=function(g,h){let v=h;const T=g.x,P=g.y;let L,w=-1/0;do{if(P<=v.y&&P>=v.next.y&&v.next.y!==v.y){const B=v.x+(P-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(B<=T&&B>w&&(w=B,L=v.x<v.next.x?v:v.next,B===T))return L}v=v.next}while(v!==h);if(!L)return null;const M=L,D=L.x,I=L.y;let R=1/0;v=L;do{if(T>=v.x&&v.x>=D&&T!==v.x&&$f(P<I?T:w,P,D,I,P<I?w:T,P,v.x,v.y)){const B=Math.abs(P-v.y)/(T-v.x);gg(v,g)&&(B<R||B===R&&(v.x>L.x||v.x===L.x&&eF(L,v)))&&(L=v,R=B)}v=v.next}while(v!==M);return L}(c,n);if(!s)return n;const u=$E(s,c);return Wd(u,u.next),Wd(s,s.next)}function eF(c,n){return _i(c.prev,c,n.prev)<0&&_i(n.next,c,c.next)<0}function q1(c,n,s,u,g){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-s)*g|0)|c<<8))|c<<4))|c<<2))|c<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-u)*g|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function tF(c){let n=c,s=c;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==c);return s}function $f(c,n,s,u,g,h,v,T){return(g-v)*(n-T)>=(c-v)*(h-T)&&(c-v)*(u-T)>=(s-v)*(n-T)&&(s-v)*(h-T)>=(g-v)*(u-T)}function nF(c,n){return c.next.i!==n.i&&c.prev.i!==n.i&&!function(s,u){let g=s;do{if(g.i!==s.i&&g.next.i!==s.i&&g.i!==u.i&&g.next.i!==u.i&&NE(g,g.next,s,u))return!0;g=g.next}while(g!==s);return!1}(c,n)&&(gg(c,n)&&gg(n,c)&&function(s,u){let g=s,h=!1;const v=(s.x+u.x)/2,T=(s.y+u.y)/2;do g.y>T!=g.next.y>T&&g.next.y!==g.y&&v<(g.next.x-g.x)*(T-g.y)/(g.next.y-g.y)+g.x&&(h=!h),g=g.next;while(g!==s);return h}(c,n)&&(_i(c.prev,c,n.prev)||_i(c,n.prev,n))||_y(c,n)&&_i(c.prev,c,c.next)>0&&_i(n.prev,n,n.next)>0)}function _i(c,n,s){return(n.y-c.y)*(s.x-n.x)-(n.x-c.x)*(s.y-n.y)}function _y(c,n){return c.x===n.x&&c.y===n.y}function NE(c,n,s,u){const g=by(_i(c,n,s)),h=by(_i(c,n,u)),v=by(_i(s,u,c)),T=by(_i(s,u,n));return g!==h&&v!==T||!(g!==0||!yy(c,s,n))||!(h!==0||!yy(c,u,n))||!(v!==0||!yy(s,c,u))||!(T!==0||!yy(s,n,u))}function yy(c,n,s){return n.x<=Math.max(c.x,s.x)&&n.x>=Math.min(c.x,s.x)&&n.y<=Math.max(c.y,s.y)&&n.y>=Math.min(c.y,s.y)}function by(c){return c>0?1:c<0?-1:0}function gg(c,n){return _i(c.prev,c,c.next)<0?_i(c,n,c.next)>=0&&_i(c,c.prev,n)>=0:_i(c,n,c.prev)<0||_i(c,c.next,n)<0}function $E(c,n){const s=K1(c.i,c.x,c.y),u=K1(n.i,n.x,n.y),g=c.next,h=n.prev;return c.next=n,n.prev=c,s.next=g,g.prev=s,u.next=s,s.prev=u,h.next=u,u.prev=h,u}function VE(c,n,s,u){const g=K1(c,n,s);return u?(g.next=u.next,g.prev=u,u.next.prev=g,u.next=g):(g.prev=g,g.next=g),g}function vg(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function K1(c,n,s){return{i:c,x:n,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function xy(c,n){const s=c.length;if(s<=1)return[c];const u=[];let g,h;for(let v=0;v<s;v++){const T=Mi(c[v]);T!==0&&(c[v].area=Math.abs(T),h===void 0&&(h=T<0),h===T<0?(g&&u.push(g),g=[c[v]]):g.push(c[v]))}if(g&&u.push(g),n>1)for(let v=0;v<u.length;v++)u[v].length<=n||(g_(u[v],n,1,u[v].length-1,rF),u[v]=u[v].slice(0,n));return u}function rF(c,n){return n.area-c.area}function Z1(c,n,s){const u=s.patternDependencies;let g=!1;for(const h of n){const v=h.paint.get(`${c}-pattern`);v.isConstant()||(g=!0);const T=v.constantOr(null);T&&(g=!0,u[T]=!0)}return g}function Y1(c,n,s,u,g){const h=g.patternDependencies;for(const v of n){const T=v.paint.get(`${c}-pattern`).value;if(T.kind!=="constant"){let P=T.evaluate({zoom:u},s,{},g.availableImages);P=P&&P.name?P.name:P,h[P]=!0,s.patterns[v.id]=P}}return s}class X1{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Pl,this.indexArray=new Ii,this.indexArray2=new Ll,this.programConfigurations=new Ol(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new Zo,this.segments2=new Zo,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=n.projection}updateFootprints(n,s){}populate(n,s,u,g){this.hasPattern=Z1("fill",this.layers,s);const h=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:T,id:P,index:L,sourceLayerIndex:w}of n){const M=this.layers[0]._featureFilter.needGeometry,D=wn(T,M);if(!this.layers[0]._featureFilter.filter(new Ko(this.zoom),D,u))continue;const I=h?h.evaluate(D,{},u,s.availableImages):void 0,R={id:P,properties:T.properties,type:T.type,sourceLayerIndex:w,index:L,geometry:M?D.geometry:bn(T,u,g),patterns:{},sortKey:I};v.push(R)}h&&v.sort((T,P)=>T.sortKey-P.sortKey);for(const T of v){const{geometry:P,index:L,sourceLayerIndex:w}=T;if(this.hasPattern){const M=Y1("fill",this.layers,T,this.zoom,s);this.patternFeatures.push(M)}else this.addFeature(T,P,L,u,{},s.availableImages,s.brightness);s.featureIndex.insert(n[L].feature,P,L,w,this.index)}}update(n,s,u,g,h){const v=Object.keys(n).length!==0;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,s,v?this.stateDependentLayers:this.layers,u,g,h)}addFeatures(n,s,u,g,h,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,s,u,g,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,qB),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,u,g,h,v=[],T){for(const P of xy(s,500)){let L=0;for(const B of P)L+=B.length;const w=this.segments.prepareSegment(L,this.layoutVertexArray,this.indexArray),M=w.vertexLength,D=[],I=[];for(const B of P){if(B.length===0)continue;B!==P[0]&&I.push(D.length/2);const j=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),K=j.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(K+B.length-1,K),D.push(B[0].x),D.push(B[0].y);for(let ne=1;ne<B.length;ne++)this.layoutVertexArray.emplaceBack(B[ne].x,B[ne].y),this.indexArray2.emplaceBack(K+ne-1,K+ne),D.push(B[ne].x),D.push(B[ne].y);j.vertexLength+=B.length,j.primitiveLength+=B.length}const R=pg(D,I);for(let B=0;B<R.length;B+=3)this.indexArray.emplaceBack(M+R[B],M+R[B+1],M+R[B+2]);w.vertexLength+=L,w.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,g,T)}}let UE,jE,HE,GE;Gn(X1,"FillBucket",{omit:["layers","patternFeatures"]});class J1{constructor(n,s,u,g){if(this.triangleCount=s.length/3,this.min=new et(0,0),this.max=new et(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||n.length===0)return;const[h,v]=[n[0].clone(),n[0].clone()];for(let M=1;M<n.length;++M){const D=n[M];h.x=Math.min(h.x,D.x),h.y=Math.min(h.y,D.y),v.x=Math.max(v.x,D.x),v.y=Math.max(v.y,D.y)}if(g){const M=Math.ceil(Math.max(v.x-h.x,v.y-h.y)/g);u=Math.max(u,M)}if(u===0)return;this.min=h,this.max=v;const T=this.max.sub(this.min);T.x=Math.max(T.x,1),T.y=Math.max(T.y,1);const P=Math.max(T.x,T.y)/u;this.cellsX=Math.max(1,Math.ceil(T.x/P)),this.cellsY=Math.max(1,Math.ceil(T.y/P)),this.xScale=1/P,this.yScale=1/P;const L=[];for(let M=0;M<this.triangleCount;M++){const D=n[s[3*M+0]].sub(this.min),I=n[s[3*M+1]].sub(this.min),R=n[s[3*M+2]].sub(this.min),B=Fl(Math.floor(Math.min(D.x,I.x,R.x)),this.xScale,this.cellsX),j=Fl(Math.floor(Math.max(D.x,I.x,R.x)),this.xScale,this.cellsX),K=Fl(Math.floor(Math.min(D.y,I.y,R.y)),this.yScale,this.cellsY),ne=Fl(Math.floor(Math.max(D.y,I.y,R.y)),this.yScale,this.cellsY),oe=new et(0,0),Y=new et(0,0),ae=new et(0,0),me=new et(0,0);for(let Ee=K;Ee<=ne;++Ee){oe.y=Y.y=Ee*P,ae.y=me.y=(Ee+1)*P;for(let Oe=B;Oe<=j;++Oe)oe.x=ae.x=Oe*P,Y.x=me.x=(Oe+1)*P,(xo(D,I,R,oe,Y,me)||xo(D,I,R,oe,me,ae))&&L.push({cellIdx:Ee*this.cellsX+Oe,triIdx:M})}}if(L.length===0)return;L.sort((M,D)=>M.cellIdx-D.cellIdx||M.triIdx-D.triIdx);let w=0;for(;w<L.length;){const M=L[w].cellIdx,D={start:this.payload.length,len:0};for(;w<L.length&&L[w].cellIdx===M;)++D.len,this.payload.push(L[w++].triIdx);this.cells[M]=D}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(n,s){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>n.x||n.y>this.max.y||this.min.y>n.y)return;const u=Fl(n.x-this.min.x,this.xScale,this.cellsX),g=Fl(n.y-this.min.y,this.yScale,this.cellsY),h=this.cells[g*this.cellsX+u];if(h){this._lazyInitLookup();for(let v=0;v<h.len;v++){const T=this.payload[h.start+v],P=Math.floor(T/8),L=1<<T%8;if(!(this.lookup[P]&L)&&(this.lookup[P]|=L,s.push(T),s.length===this.triangleCount))return}}}query(n,s,u){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>s.x||n.y>this.max.y||this.min.y>s.y)return;this._lazyInitLookup();const g=Fl(n.x-this.min.x,this.xScale,this.cellsX),h=Fl(s.x-this.min.x,this.xScale,this.cellsX),v=Fl(n.y-this.min.y,this.yScale,this.cellsY),T=Fl(s.y-this.min.y,this.yScale,this.cellsY);for(let P=v;P<=T;P++)for(let L=g;L<=h;L++){const w=this.cells[P*this.cellsX+L];if(w)for(let M=0;M<w.len;M++){const D=this.payload[w.start+M],I=Math.floor(D/8),R=1<<D%8;if(!(this.lookup[I]&R)&&(this.lookup[I]|=R,u.push(D),u.length===this.triangleCount))return}}}}function Fl(c,n,s){return Math.max(0,Math.min(s-1,Math.floor(c*n)))}Gn(J1,"TriangleGridIndex");class WE{constructor(n){this.zoom=n.zoom,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.footprints=[]}updateFootprints(n,s){for(const u of this.footprints)s.push({footprint:u,id:n})}populate(n,s,u,g){const h=[];for(const{feature:v,id:T,index:P,sourceLayerIndex:L}of n){const w=this.layers[0]._featureFilter.needGeometry,M=wn(v,w);if(!this.layers[0]._featureFilter.filter(new Ko(this.zoom),M,u))continue;const D={id:T,properties:v.properties,type:v.type,sourceLayerIndex:L,index:P,geometry:w?M.geometry:bn(v,u,g),patterns:{}};h.push(D)}for(const v of h){const{geometry:T,index:P,sourceLayerIndex:L}=v;this.addFeature(v,T,P,u,{},s.availableImages,s.brightness),s.featureIndex.insert(n[P].feature,T,P,L,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(n){}update(n,s,u,g,h){}destroy(){}addFeature(n,s,u,g,h,v=[],T){for(const P of xy(s,2)){const L=[],w=[],M=[],D=new et(1/0,1/0),I=new et(-1/0,-1/0);for(const j of P)if(j.length!==0){j!==P[0]&&M.push(w.length/2);for(let K=0;K<j.length;K++)w.push(j[K].x),w.push(j[K].y),L.push(j[K]),D.x=Math.min(D.x,j[K].x),D.y=Math.min(D.y,j[K].y),I.x=Math.max(I.x,j[K].x),I.y=Math.max(I.y,j[K].y)}const R=pg(w,M),B=new J1(L,R,8,256);this.footprints.push({vertices:L,indices:R,grid:B,min:D,max:I})}}}Gn(WE,"ClipBucket",{omit:["layers"]});const oF=oo([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),iF=oo([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),sF=oo([{name:"a_centroid_pos",components:2,type:"Uint16"}]),aF=oo([{name:"a_join_normal_inside",components:3,type:"Int16"}]),lF=oo([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),cF=oo([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:uF}=oF;var Q1,qE,ex,KE,tx,ZE,YE,wy={};function XE(){if(qE)return Q1;qE=1;var c=pt();function n(g,h,v,T,P){this.properties={},this.extent=v,this.type=0,this._pbf=g,this._geometry=-1,this._keys=T,this._values=P,g.readFields(s,this,h)}function s(g,h,v){g==1?h.id=v.readVarint():g==2?function(T,P){for(var L=T.readVarint()+T.pos;T.pos<L;){var w=P._keys[T.readVarint()],M=P._values[T.readVarint()];P.properties[w]=M}}(v,h):g==3?h.type=v.readVarint():g==4&&(h._geometry=v.pos)}function u(g){for(var h,v,T=0,P=0,L=g.length,w=L-1;P<L;w=P++)T+=((v=g[w]).x-(h=g[P]).x)*(h.y+v.y);return T}return Q1=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var g=this._pbf;g.pos=this._geometry;for(var h,v=g.readVarint()+g.pos,T=1,P=0,L=0,w=0,M=[];g.pos<v;){if(P<=0){var D=g.readVarint();T=7&D,P=D>>3}if(P--,T===1||T===2)L+=g.readSVarint(),w+=g.readSVarint(),T===1&&(h&&M.push(h),h=[]),h.push(new c(L,w));else{if(T!==7)throw new Error("unknown command "+T);h&&h.push(h[0].clone())}}return h&&M.push(h),M},n.prototype.bbox=function(){var g=this._pbf;g.pos=this._geometry;for(var h=g.readVarint()+g.pos,v=1,T=0,P=0,L=0,w=1/0,M=-1/0,D=1/0,I=-1/0;g.pos<h;){if(T<=0){var R=g.readVarint();v=7&R,T=R>>3}if(T--,v===1||v===2)(P+=g.readSVarint())<w&&(w=P),P>M&&(M=P),(L+=g.readSVarint())<D&&(D=L),L>I&&(I=L);else if(v!==7)throw new Error("unknown command "+v)}return[w,D,M,I]},n.prototype.toGeoJSON=function(g,h,v){var T,P,L=this.extent*Math.pow(2,v),w=this.extent*g,M=this.extent*h,D=this.loadGeometry(),I=n.types[this.type];function R(K){for(var ne=0;ne<K.length;ne++){var oe=K[ne];K[ne]=[360*(oe.x+w)/L-180,360/Math.PI*Math.atan(Math.exp((180-360*(oe.y+M)/L)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(T=0;T<D.length;T++)B[T]=D[T][0];R(D=B);break;case 2:for(T=0;T<D.length;T++)R(D[T]);break;case 3:for(D=function(K){var ne=K.length;if(ne<=1)return[K];for(var oe,Y,ae=[],me=0;me<ne;me++){var Ee=u(K[me]);Ee!==0&&(Y===void 0&&(Y=Ee<0),Y===Ee<0?(oe&&ae.push(oe),oe=[K[me]]):oe.push(K[me]))}return oe&&ae.push(oe),ae}(D),T=0;T<D.length;T++)for(P=0;P<D[T].length;P++)R(D[T][P])}D.length===1?D=D[0]:I="Multi"+I;var j={type:"Feature",geometry:{type:I,coordinates:D},properties:this.properties};return"id"in this&&(j.id=this.id),j},Q1}function JE(){if(KE)return ex;KE=1;var c=XE();function n(u,g){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(s,this,g),this.length=this._features.length}function s(u,g,h){u===15?g.version=h.readVarint():u===1?g.name=h.readString():u===5?g.extent=h.readVarint():u===2?g._features.push(h.pos):u===3?g._keys.push(h.readString()):u===4&&g._values.push(function(v){for(var T=null,P=v.readVarint()+v.pos;v.pos<P;){var L=v.readVarint()>>3;T=L===1?v.readString():L===2?v.readFloat():L===3?v.readDouble():L===4?v.readVarint64():L===5?v.readVarint():L===6?v.readSVarint():L===7?v.readBoolean():null}return T}(h))}return ex=n,n.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var g=this._pbf.readVarint()+this._pbf.pos;return new c(this._pbf,g,this.extent,this._keys,this._values)},ex}function QE(){return YE||(YE=1,wy.VectorTile=function(){if(ZE)return tx;ZE=1;var c=JE();function n(s,u,g){if(s===3){var h=new c(g,g.readVarint()+g.pos);h.length&&(u[h.name]=h)}}return tx=function(s,u){this.layers=s.readFields(n,{},u)},tx}(),wy.VectorTileFeature=XE(),wy.VectorTileLayer=JE()),wy}var Vf=QE();class qd extends et{constructor(n,s,u){super(n,s),this.z=u}}class eM extends qd{constructor(n,s,u,g){super(n,s,u),this.w=g}}function Sy(c,n,s,u){const g=[],h=u===0?(v,T,P,L,w,M)=>{v.push(new et(M,P+(M-T)/(L-T)*(w-P)))}:(v,T,P,L,w,M)=>{v.push(new et(T+(M-P)/(w-P)*(L-T),M))};for(const v of c){const T=[];for(const P of v){if(P.length<=2)continue;const L=[];for(let D=0;D<P.length-1;D++){const I=P[D].x,R=P[D].y,B=P[D+1].x,j=P[D+1].y,K=u===0?I:R,ne=u===0?B:j;K<n?ne>n&&h(L,I,R,B,j,n):K>s?ne<s&&h(L,I,R,B,j,s):L.push(P[D]),ne<n&&K>=n&&h(L,I,R,B,j,n),ne>s&&K<=s&&h(L,I,R,B,j,s)}let w=P[P.length-1];const M=u===0?w.x:w.y;M>=n&&M<=s&&L.push(w),L.length&&(w=L[L.length-1],L[0].x===w.x&&L[0].y===w.y||L.push(L[0]),T.push(L))}T.length&&g.push(T)}return g}function tM(c,n,s,u){const g=s==="x"?"y":"x",h=(u-c[s])/(n[s]-c[s]);c[g]=c[g]+(n[g]-c[g])*h,c[s]=u,c.hasOwnProperty("z")&&(c.z=pr(c.z,n.z,h)),c.hasOwnProperty("w")&&(c.w=pr(c.w,n.w,h))}function nM(c,n,s,u){const g=s,h=u;for(const v of["x","y"]){let T=c,P=n;T[v]>=P[v]&&(T=n,P=c),T[v]<g&&P[v]>g&&tM(T,P,v,g),T[v]<h&&P[v]>h&&tM(P,T,v,h)}}const Ty=Number.MAX_SAFE_INTEGER;function rM(c,n,s,u){return c.order<n||c.order===Ty||!(c.clipMask&s)||function(g,h){return h.length!==0&&h.find(v=>v===g)===void 0}(u,c.clipScope)}function Cy(c,n){return c.x-n.x||c.y-n.y}function oM(c,n){return Cy(c.min,n.min)===0&&Cy(c.max,n.max)===0}function nx(c,n){return!(c.min.x>n.max.x||c.max.x<n.min.x||c.min.y>n.max.y||c.max.y<n.min.y)}function rx(c,n){if(c.length!==n.length)return!1;for(let s=0;s<c.length;s++)if(c[s].sourceId!==n[s].sourceId||!oM(c[s],n[s])||c[s].order!==n[s].order||c[s].clipMask!==n[s].clipMask||!rn(c[s].clipScope,n[s].clipScope))return!1;return!0}function iM(c,n,s){const u=1/An,g=1/(1<<s.canonical.z),h=(n.x*u+s.canonical.x)*g+s.wrap,v=(n.y*u+s.canonical.y)*g;return{min:new et((c.x*u+s.canonical.x)*g+s.wrap,(c.y*u+s.canonical.y)*g),max:new et(h,v)}}function dF(c,n,s){const u=1<<s.canonical.z,g=((n.x-s.wrap)*u-s.canonical.x)*An,h=(n.y*u-s.canonical.y)*An;return{min:new et(((c.x-s.wrap)*u-s.canonical.x)*An,(c.y*u-s.canonical.y)*An),max:new et(g,h)}}function sM(c,n,s,u,g,h,v){const T=c.indices,P=c.vertices,L=[];for(let w=u;w<u+g;w+=3){const M=n[s[w+0]+h],D=n[s[w+1]+h],I=n[s[w+2]+h],R=Math.min(M.x,D.x,I.x),B=Math.max(M.x,D.x,I.x),j=Math.min(M.y,D.y,I.y),K=Math.max(M.y,D.y,I.y);L.length=0,c.grid.query(new et(R,j),new et(B,K),L);for(let ne=0;ne<L.length;ne++){const oe=L[ne];if(xo(P[T[3*oe+0]],P[T[3*oe+1]],P[T[3*oe+2]],M,D,I,v))return!0}}return!1}function aM(c,n,s,u){if(!c||!s)return!1;let g=c.vertices;if(!n.canonical.equals(u.canonical)||n.wrap!==u.wrap){if(s.vertices.length<c.vertices.length)return aM(s,u,c,n);const h=n.canonical,v=u.canonical,T=Math.pow(2,v.z-h.z);g=c.vertices.map(P=>new et((P.x+h.x*An)*T-v.x*An,(P.y+h.y*An)*T-v.y*An))}return sM(s,g,c.indices,0,c.indices.length,0,0)}function lM(c,n,s,u){const g=Math.pow(2,u.z-s.z);return new et((c+s.x*An)*g-u.x*An,(n+s.y*An)*g-u.y*An)}function cM(c,n){const s=[];n.grid.queryPoint(c,s);const u=n.indices,g=n.vertices;for(let h=0;h<s.length;h++){const v=s[h];if(Lo([g[u[3*v+0]],g[u[3*v+1]],g[u[3*v+2]]],c))return!0}return!1}const ox=[new et(0,0),new et(An,0),new et(An,An),new et(0,An)];function uM(c,n){const s=[];let u=[];if(!n||c.length<2)return[c];if(c.length===2)return ri(c[0],c[1],ox)?[c]:[];for(let g=0;g<c.length+2;g++){const h=c[g%c.length],v=c[(g+1)%c.length],T=ri(g===0?c[c.length-1]:c[(g-1)%c.length],h,ox),P=ri(h,v,ox),L=T||P;L&&u.push(h),L&&P||u.length>0&&(u.length>1&&s.push(u),u=[])}return u.length>1&&s.push(u),s}const ix=Vf.VectorTileFeature.types,hF=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],fF=["fill-extrusion-flood-light-ground-radius"],pF=Math.pow(2,13),mF=Math.pow(2,15)-1,dM=new et(0,1),Cu=2147483648;function _g(c,n,s,u,g,h,v,T){c.emplaceBack((n<<1)+v,(s<<1)+h,(Math.floor(u*pF)<<1)+g,Math.round(T))}function yg(c,n,s){c.emplaceBack(n.x*An,n.y*An,s?1:0)}function Ey(c,n,s,u,g,h){c.emplaceBack(n.x,n.y,(s.x<<1)+u,(s.y<<1)+g,h)}function bg(c,n,s){c.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class hM{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class fM{constructor(){this.centroidXY=new et(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new et(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new et(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new et(this.max.x-this.min.x,this.max.y-this.min.y)}}class pM{constructor(){this.acc=new et(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(n,s){n.min.x===Number.MAX_VALUE&&(n.min.x=n.max.x=s.x,n.min.y=n.max.y=s.y)}appendEdge(n,s,u){this.accCount++,this.acc._add(s);let g=!!this.borders;s.x<n.min.x?(n.min.x=s.x,g=!0):s.x>n.max.x&&(n.max.x=s.x,g=!0),s.y<n.min.y?(n.min.y=s.y,g=!0):s.y>n.max.y&&(n.max.y=s.y,g=!0),((s.x===0||s.x===An)&&s.x===u.x)!=((s.y===0||s.y===An)&&s.y===u.y)&&this.processBorderOverlap(s,u),g&&this.checkBorderIntersection(s,u)}checkBorderIntersection(n,s){s.x<0!=n.x<0&&this.addBorderIntersection(0,pr(s.y,n.y,(0-s.x)/(n.x-s.x))),s.x>An!=n.x>An&&this.addBorderIntersection(1,pr(s.y,n.y,(An-s.x)/(n.x-s.x))),s.y<0!=n.y<0&&this.addBorderIntersection(2,pr(s.x,n.x,(0-s.y)/(n.y-s.y))),s.y>An!=n.y>An&&this.addBorderIntersection(3,pr(s.x,n.x,(An-s.y)/(n.y-s.y)))}addBorderIntersection(n,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[n];s<u[0]&&(u[0]=s),s>u[1]&&(u[1]=s)}processBorderOverlap(n,s){if(n.x===s.x){if(n.y===s.y)return;const u=n.x===0?0:1;this.addBorderIntersection(u,s.y),this.addBorderIntersection(u,n.y)}else{const u=n.y===0?2:3;this.addBorderIntersection(u,s.x),this.addBorderIntersection(u,n.x)}}centroid(){return this.accCount===0?new et(0,0):new et(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((n,s)=>n+ +(s[0]!==Number.MAX_VALUE),0):0}}function mM(c,n){const s=c.add(n)._unit(),u=Zt(c.x*s.x+c.y*s.y,-1,1);var g,h,v;return v=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(v)))/4*mF*((g=c).x*(h=n).y-g.y*h.x<0?-1:1)}const gF=[c=>c.x<0,c=>c.x>An,c=>c.y<0,c=>c.y>An];function vF(c,n,s,u){const g=[4];if(u===0)return g;s._mult(u);const h=c.sub(s),v=n.sub(s),T=[c,n,h,v];for(let P=0;P<4;P++)for(const L of T)if(gF[P](L)){g.push(P);break}return g}class gM{constructor(n){this.vertexArray=new Af,this.indexArray=new Ii,this.programConfigurations=new Ol(n.layers,{zoom:n.zoom,lut:n.lut},s=>fF.includes(s)),this._segments=new Zo,this.hiddenByLandmarkVertexArray=new Lf,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Zo}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(n,s,u,g=!1){const h=n.length;if(h>2){let v=Math.max(0,this._segments.get().length-1);const T=this._segments._prepareSegment(4*h,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let P;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const L=n[0],w=n[1];P=mM(L.sub(n[h-1])._perp()._unit(),w.sub(L)._perp()._unit())}for(let L=0;L<h;L++){const w=L===h-1?0:L+1,M=n[L],D=n[w],I=n[w===h-1?0:w+1],R=D.sub(M)._perp()._unit(),B=mM(R,I.sub(D)._perp()._unit()),j=P,K=B;if(sx(M,D,s)||g&&yM(M,s)&&yM(D,s)){P=B;continue}const ne=T.vertexLength;Ey(this.vertexArray,M,D,1,1,j),Ey(this.vertexArray,M,D,1,0,j),Ey(this.vertexArray,M,D,0,1,K),Ey(this.vertexArray,M,D,0,0,K),T.vertexLength+=4;const oe=vF(M,D,R,u);for(const Y of oe)this._segmentToGroundQuads[v].push({id:ne,region:Y}),this._segmentToRegionTriCounts[v][Y]+=2,T.primitiveLength+=2;P=B}}}prepareBorderSegments(){if(!this.hasData())return;const n=this._segments.get(),s=n.length;for(let u=0;u<s;u++)this._segmentToGroundQuads[u].sort((g,h)=>g.region-h.region);for(let u=0;u<s;u++){const g=this._segmentToGroundQuads[u],h=n[u],v=this._segmentToRegionTriCounts[u];v.reduce((P,L)=>P+L,0);let T=0;for(let P=0;P<=4;P++){const L=v[P];if(L!==0){let w=this.regionSegments[P];w||(w=this.regionSegments[P]=new Zo);const M={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+T,vertexLength:h.vertexLength,primitiveLength:L};w.get().push(M)}T+=L}for(let P=0;P<g.length;P++){const L=g[P].id;this.indexArray.emplaceBack(L,L+1,L+3),this.indexArray.emplaceBack(L,L+3,L+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(n,s,u,g,h,v){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,n,s,u,g,h,v)}upload(n){this.hasData()&&(this.vertexBuffer=n.createVertexBuffer(this.vertexArray,iF.members),this.indexBuffer=n.createIndexBuffer(this.indexArray))}uploadPaintProperties(n){this.hasData()&&this.programConfigurations.upload(n)}update(n,s,u,g,h,v){this.hasData()&&this.programConfigurations.updatePaintArrays(n,s,u,g,h,v)}updateHiddenByLandmark(n){if(!this.hasData())return;const s=n.groundVertexCount+n.groundVertexArrayOffset;if(n.groundVertexCount===0)return;const u=n.flags&Cu?1:0;for(let g=n.groundVertexArrayOffset;g<s;++g)this.hiddenByLandmarkVertexArray.emplace(g,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(n){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=n.createVertexBuffer(this.hiddenByLandmarkVertexArray,lF.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let n=0;n<=4;n++){const s=this.regionSegments[n];s&&s.destroy()}}}}class My{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Ii,this.footprintVertices=new Pl,this.footprintSegments=[],this.layoutVertexArray=new Rl,this.centroidVertexArray=new ly,this.wallVertexArray=new ag,this.indexArray=new Ii,this.programConfigurations=new Ol(n.layers,{zoom:n.zoom,lut:n.lut},s=>hF.includes(s)),this.segments=new Zo,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.groundEffect=new gM(n),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(n,s){}populate(n,s,u,g){this.features=[],this.hasPattern=Z1("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=ct(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:h,id:v,index:T,sourceLayerIndex:P}of n){const L=this.layers[0]._featureFilter.needGeometry,w=wn(h,L);if(!this.layers[0]._featureFilter.filter(new Ko(this.zoom),w,u))continue;const M={id:v,sourceLayerIndex:P,index:T,geometry:L?w.geometry:bn(h,u,g),properties:h.properties,type:h.type,patterns:{}},D=this.layoutVertexArray.length,I=ix[M.type]==="Polygon";if(this.hasPattern)this.features.push(Y1("fill-extrusion",this.layers,M,this.zoom,s));else if(this.wallMode)for(const R of M.geometry)for(const B of uM(R,I))this.addFeature(M,[B],T,u,{},s.availableImages,g,s.brightness);else this.addFeature(M,M.geometry,T,u,{},s.availableImages,g,s.brightness);s.featureIndex.insert(h,M.geometry,T,P,this.index,D)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(n,s,u,g,h,v){for(const T of this.features){const P=ix[T.type]==="Polygon",{geometry:L}=T;if(this.wallMode)for(const w of L)for(const M of uM(w,P))this.addFeature(T,[M],T.index,s,u,g,h,v);else this.addFeature(T,L,T.index,s,u,g,h,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(n,s,u,g,h){const v=Object.keys(n).length!==0;if(v&&!this.stateDependentLayers.length)return;const T=v?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(n,s,T,u,g,h),this.groundEffect.update(n,s,T,u,g,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,uF),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.wallVertexBuffer=n.createVertexBuffer(this.wallVertexArray,aF.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,cF.members,!0)),this.groundEffect.upload(n)),this.groundEffect.uploadPaintProperties(n),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.groundEffect.uploadHiddenByLandmark(n),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,sF.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,u,g,h,v,T,P){const L=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(n,{})/this.tileToMeter,w=[new et(0,0),new et(An,An)],M=T.projection,D=M.name==="globe",I=this.wallMode||ix[n.type]==="Polygon",R=new pM;R.centroidDataIndex=this.centroidData.length;const B=new fM,j=this.layers[0].paint.get("fill-extrusion-base").evaluate(n,{},g)<=0,K=this.layers[0].paint.get("fill-extrusion-height").evaluate(n,{},g);let ne;if(B.height=K,B.vertexArrayOffset=this.layoutVertexArray.length,B.groundVertexArrayOffset=this.groundEffect.vertexArray.length,D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Pf),this.wallMode){if(D)return void Hn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(s.length!==1)return;ne=function(De){const Xe=De[0].x===De[De.length-1].x&&De[0].y===De[De.length-1].y;(function(xn){let mn=0;const nr=xn.length;for(let Ln=0;Ln<nr;Ln++)mn+=(xn[(Ln+1)%nr].x-xn[Ln].x)*(xn[(Ln+1)%nr].y+xn[Ln].y);return mn>=0})(De)||(De=De.reverse());const tt={geometry:[],joinNormals:[],indices:[]},ft=[],vt=[],yt=[];let wt=De.length;if(wt<(Xe?3:2))return tt;for(;wt>=2&&De[wt-1].equals(De[wt-2]);)wt--;let Bt,St,Xt,un,Gt,On=0;for(;On<wt-1&&De[On].equals(De[On+1]);)On++;Xe&&(Bt=De[wt-2],Gt=De[On].sub(Bt)._unit()._perp());for(let xn=On;xn<wt;xn++){if(Xt=xn===wt-1?Xe?De[On+1]:void 0:De[xn+1],Xt&&De[xn].equals(Xt))continue;Gt&&(un=Gt),Bt&&(St=Bt),Bt=De[xn],Gt=Xt?Xt.sub(Bt)._unit()._perp():un,un=un||Gt;let mn=un.add(Gt);mn.x===0&&mn.y===0||mn._unit();const nr=mn.x*Gt.x+mn.y*Gt.y,Ln=nr!==0?1/nr:1/0,Un=un.x*Gt.y-un.y*Gt.x>0;let br="miter";const Or=2;br==="miter"&&Ln>Or&&(br="bevel"),br==="bevel"&&(Ln>100&&(br="flipbevel"),Ln<Or&&(br="miter"));const Ar=(Pr,Nr,Vr,Co)=>{const ho=new et(Pr.x,Pr.y),Sr=new et(Pr.x,Pr.y);ho.x+=Nr.x*Co,ho.y+=Nr.y*Co,Sr.x-=Nr.x*Math.max(Vr,1),Sr.y-=Nr.y*Math.max(Vr,1),yt.push(Nr),ft.push(ho),vt.push(Sr)};if(br==="miter")mn._mult(Ln),Ar(Bt,mn,0,0);else if(br==="flipbevel")mn=Gt.mult(-1),Ar(Bt,mn,0,0),Ar(Bt,mn.mult(-1),0,0);else{const Pr=-Math.sqrt(Ln*Ln-1),Nr=Un?Pr:0,Vr=Un?0:Pr;St&&Ar(Bt,un,Nr,Vr),Xt&&Ar(Bt,Gt,Nr,Vr)}}tt.geometry=[...ft,...vt.reverse(),ft[0]],tt.joinNormals=[...yt,...yt.reverse(),yt[yt.length-1]];const In=tt.geometry.length-1;for(let xn=0;xn<In/2;xn++)if(xn+1<In/2){let mn=xn,nr=xn+1,Ln=In-1-xn,Un=In-2-xn;mn=mn===0?In-1:mn-1,nr=nr===0?In-1:nr-1,Ln=Ln===0?In-1:Ln-1,Un=Un===0?In-1:Un-1,tt.indices.push(Ln),tt.indices.push(nr),tt.indices.push(mn),tt.indices.push(Ln),tt.indices.push(Un),tt.indices.push(nr)}return tt}(s[0]),s=[ne.geometry]}const oe=(De,Xe)=>De<(Xe.length-1)/2||De===Xe.length-1,Y=this.wallMode?[s]:xy(s,500);for(let De=Y.length-1;De>=0;De--){const Xe=Y[De];(Xe.length===0||(ae=Xe[0]).every($e=>$e.x<=0)||ae.every($e=>$e.x>=An)||ae.every($e=>$e.y<=0)||ae.every($e=>$e.y>=An))&&Y.splice(De,1)}var ae;let me;if(D)me=SM(Y,w,g);else{me=[];for(const De of Y)me.push({polygon:De,bounds:w})}const Ee=I?this.edgeRadius:0,Oe=Ee>0&&this.zoom<17,Be=(De,Xe)=>{if(De.length===0)return!1;const $e=De[De.length-1];return Xe.x===$e.x&&Xe.y===$e.y};for(const{polygon:De,bounds:Xe}of me){let $e=0,tt=0;for(const wt of De)I&&!wt[0].equals(wt[wt.length-1])&&wt.push(wt[0]),tt+=I?wt.length-1:wt.length;const ft=this.segments.prepareSegment((I?5:4)*tt,this.layoutVertexArray,this.indexArray);B.footprintSegIdx<0&&(B.footprintSegIdx=this.footprintSegments.length),B.polygonSegIdx<0&&(B.polygonSegIdx=this.polygonSegments.length);const vt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},yt=new hM;if(yt.vertexOffset=this.footprintVertices.length,yt.indexOffset=3*this.footprintIndices.length,yt.ringIndices=[],I){const wt=[],Bt=[];$e=ft.vertexLength;for(let Xt=0;Xt<De.length;Xt++){const un=De[Xt];un.length&&Xt!==0&&Bt.push(wt.length/2);const Gt=[];let On,In;On=un[1].sub(un[0])._perp()._unit(),yt.ringIndices.push(un.length-1);for(let xn=1;xn<un.length;xn++){const mn=un[xn],nr=un[xn===un.length-1?1:xn+1],Ln=mn.clone();if(Ee){In=nr.sub(mn)._perp()._unit();const Un=On.add(In)._unit(),br=Ee*Math.min(4,1/(On.x*Un.x+On.y*Un.y));Ln.x+=br*Un.x,Ln.y+=br*Un.y,Ln.x=Math.round(Ln.x),Ln.y=Math.round(Ln.y),On=In}if(!j||Ee!==0&&!Oe||Be(Gt,Ln)||Gt.push(Ln),_g(this.layoutVertexArray,Ln.x,Ln.y,0,0,1,1,0),this.wallMode){const Un=oe(xn,un);yg(this.wallVertexArray,ne.joinNormals[xn],!Un)}ft.vertexLength++,this.footprintVertices.emplaceBack(mn.x,mn.y),wt.push(mn.x,mn.y),D&&bg(this.layoutVertexExtArray,M.projectTilePoint(Ln.x,Ln.y,g),M.upVector(g,Ln.x,Ln.y))}j&&(Ee===0||Oe)&&(Gt.length!==0&&Be(Gt,Gt[0])&&Gt.pop(),this.groundEffect.addData(Gt,Xe,L))}const St=this.wallMode?ne.indices:pg(wt,Bt);for(let Xt=0;Xt<St.length;Xt+=3)this.footprintIndices.emplaceBack(yt.vertexOffset+St[Xt+0],yt.vertexOffset+St[Xt+1],yt.vertexOffset+St[Xt+2]),this.indexArray.emplaceBack($e+St[Xt],$e+St[Xt+2],$e+St[Xt+1]),ft.primitiveLength++;yt.indexCount+=St.length,yt.vertexCount+=this.footprintVertices.length-yt.vertexOffset}for(let wt=0;wt<De.length;wt++){const Bt=De[wt];R.startRing(B,Bt[0]);let St=Bt.length>4&&bM(Bt[Bt.length-2],Bt[0],Bt[1]),Xt=Ee?_F(Bt[Bt.length-2],Bt[0],Bt[1],Ee):0;const un=[];let Gt,On,In;On=Bt[1].sub(Bt[0])._perp()._unit();let xn=!0;for(let mn=1,nr=0;mn<Bt.length;mn++){let Ln=Bt[mn-1],Un=Bt[mn];const br=Bt[mn===Bt.length-1?1:mn+1];if(R.appendEdge(B,Un,Ln),sx(Un,Ln,Xe)){Ee&&(On=br.sub(Un)._perp()._unit(),xn=!xn);continue}const Or=Un.sub(Ln)._perp(),Ar=Or.x/(Math.abs(Or.x)+Math.abs(Or.y)),Pr=Or.y>0?1:0,Nr=Ln.dist(Un);if(nr+Nr>32768&&(nr=0),Ee){In=br.sub(Un)._perp()._unit();let Sr=_M(Ln,Un,br,vM(On,In),Ee);isNaN(Sr)&&(Sr=0);const so=Un.sub(Ln)._unit();Ln=Ln.add(so.mult(Xt))._round(),Un=Un.add(so.mult(-Sr))._round(),Xt=Sr,On=In,j&&this.zoom>=17&&(Be(un,Ln)||un.push(Ln),Be(un,Un)||un.push(Un))}const Vr=ft.vertexLength,Co=Bt.length>4&&bM(Ln,Un,br);let ho=xM(nr,St,xn);if(_g(this.layoutVertexArray,Ln.x,Ln.y,Ar,Pr,0,0,ho),_g(this.layoutVertexArray,Ln.x,Ln.y,Ar,Pr,0,1,ho),this.wallMode){const Sr=oe(mn-1,Bt),so=ne.joinNormals[mn-1];yg(this.wallVertexArray,so,Sr),yg(this.wallVertexArray,so,Sr)}if(nr+=Nr,ho=xM(nr,Co,!xn),St=Co,_g(this.layoutVertexArray,Un.x,Un.y,Ar,Pr,0,0,ho),_g(this.layoutVertexArray,Un.x,Un.y,Ar,Pr,0,1,ho),this.wallMode){const Sr=oe(mn,Bt),so=ne.joinNormals[mn];yg(this.wallVertexArray,so,Sr),yg(this.wallVertexArray,so,Sr)}if(ft.vertexLength+=4,this.indexArray.emplaceBack(Vr+0,Vr+1,Vr+2),this.indexArray.emplaceBack(Vr+1,Vr+3,Vr+2),ft.primitiveLength+=2,Ee){const Sr=$e+(mn===1?Bt.length-2:mn-2),so=mn===1?$e:Sr+1;if(this.indexArray.emplaceBack(Vr+1,Sr,Vr+3),this.indexArray.emplaceBack(Sr,so,Vr+3),ft.primitiveLength+=2,Gt===void 0&&(Gt=Vr),!sx(br,Bt[mn],Xe)){const lo=mn===Bt.length-1?Gt:ft.vertexLength;this.indexArray.emplaceBack(Vr+2,Vr+3,lo),this.indexArray.emplaceBack(Vr+3,lo+1,lo),this.indexArray.emplaceBack(Vr+3,so,lo+1),ft.primitiveLength+=3}xn=!xn}if(D){const Sr=this.layoutVertexExtArray,so=M.projectTilePoint(Ln.x,Ln.y,g),lo=M.projectTilePoint(Un.x,Un.y,g),Oo=M.upVector(g,Ln.x,Ln.y),ei=M.upVector(g,Un.x,Un.y);bg(Sr,so,Oo),bg(Sr,so,Oo),bg(Sr,lo,ei),bg(Sr,lo,ei)}}I&&($e+=Bt.length-1),j&&Ee&&this.zoom>=17&&(un.length!==0&&Be(un,un[0])&&un.pop(),this.groundEffect.addData(un,Xe,L,Ee>0))}this.footprintSegments.push(yt),vt.triangleCount=this.indexArray.length-vt.triangleArrayOffset,this.polygonSegments.push(vt),++B.footprintSegLen,++B.polygonSegLen}if(B.vertexCount=this.layoutVertexArray.length-B.vertexArrayOffset,B.groundVertexCount=this.groundEffect.vertexArray.length-B.groundVertexArrayOffset,B.vertexCount!==0){if(B.centroidXY=R.borders?dM:this.encodeCentroid(R,B),this.centroidData.push(B),R.borders){this.featuresOnBorder.push(R);const De=this.featuresOnBorder.length-1;for(let Xe=0;Xe<R.borders.length;Xe++)R.borders[Xe][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Xe].push(De)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,g,P),this.groundEffect.addPaintPropertiesData(n,u,h,v,g,P),this.maxHeight=Math.max(this.maxHeight,K)}}sortBorders(){for(let n=0;n<this.borderFeatureIndices.length;n++)this.borderFeatureIndices[n].sort((s,u)=>this.featuresOnBorder[s].borders[n][0]-this.featuresOnBorder[u].borders[n][0])}splitToSubtiles(){const n=[];for(let T=0;T<this.centroidData.length;T++){const P=this.centroidData[T],L=+(P.min.y+P.max.y>An),w=2*L+(+(P.min.x+P.max.x>An)^L);for(let M=0;M<P.polygonSegLen;M++){const D=P.polygonSegIdx+M;n.push({centroidIdx:T,subtile:w,polygonSegmentIdx:D,triangleSegmentIdx:this.polygonSegments[D].triangleSegIdx})}}const s=new Ii;n.sort((T,P)=>T.triangleSegmentIdx===P.triangleSegmentIdx?T.subtile-P.subtile:T.triangleSegmentIdx-P.triangleSegmentIdx);let u=0,g=0,h=0;for(const T of n){if(T.triangleSegmentIdx!==u)break;h++}const v=n.length;for(;g!==n.length;){u=n[g].triangleSegmentIdx;let T=0,P=g,L=g;for(let w=P;w<h&&n[w].subtile===T;w++)L++;for(;P!==h;){const w=n[P];T=w.subtile;const M=this.centroidData[w.centroidIdx].min.clone(),D=this.centroidData[w.centroidIdx].max.clone(),I={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let R=P;R<L;R++){const B=n[R],j=this.polygonSegments[B.polygonSegmentIdx],K=this.centroidData[B.centroidIdx].min,ne=this.centroidData[B.centroidIdx].max,oe=this.indexArray.uint16;for(let Y=j.triangleArrayOffset;Y<j.triangleArrayOffset+j.triangleCount;Y++)s.emplaceBack(oe[3*Y],oe[3*Y+1],oe[3*Y+2]);I.primitiveLength+=j.triangleCount,M.x=Math.min(M.x,K.x),M.y=Math.min(M.y,K.y),D.x=Math.max(D.x,ne.x),D.y=Math.max(D.y,ne.y)}I.primitiveLength>0&&this.triangleSubSegments.push({segment:I,min:M,max:D}),P=L;for(let R=P;R<h&&n[R].subtile===n[P].subtile;R++)L++}g=h;for(let w=g;w<v&&n[w].triangleSegmentIdx===n[g].triangleSegmentIdx;w++)h++}s._trim(),this.indexArray=s}getVisibleSegments(n,s,u){const g=new Zo;if(this.wallMode){for(const B of this.triangleSubSegments)g.segments.push(B.segment);return g}let h=0,v=0;const T=1<<n.canonical.z;if(s){const B=s.getMinMaxForTile(n);B&&(h=B.min,v=B.max)}v+=this.maxHeight;const P=n.toUnwrapped();let L;const w=[P.canonical.x/T+P.wrap,P.canonical.y/T],M=[(P.canonical.x+1)/T+P.wrap,(P.canonical.y+1)/T],D=(B,j,K)=>[B[0]*(1-K[0])+j[0]*K[0],B[1]*(1-K[1])+j[1]*K[1]],I=[],R=[];for(const B of this.triangleSubSegments){I[0]=B.min.x/An,I[1]=B.min.y/An,R[0]=B.max.x/An,R[1]=B.max.y/An;const j=D(w,M,I),K=D(w,M,R);if(new Ro([j[0],j[1],h],[K[0],K[1],v]).intersectsPrecise(u)===0){L&&(g.segments.push(L),L=void 0);continue}const ne=B.segment;L&&L.vertexOffset!==ne.vertexOffset&&(g.segments.push(L),L=void 0),L?(L.vertexLength+=ne.vertexLength,L.primitiveLength+=ne.primitiveLength):L={vertexOffset:ne.vertexOffset,primitiveLength:ne.primitiveLength,vertexLength:ne.vertexLength,primitiveOffset:ne.primitiveOffset,sortKey:void 0,vaos:{}}}return L&&g.segments.push(L),g}encodeCentroid(n,s){const u=n.centroid(),g=s.span(),h=Math.min(7,Math.round(g.x*this.tileToMeter/10)),v=Math.min(7,Math.round(g.y*this.tileToMeter/10));return new et(Zt(u.x,1,An-1)<<3|h,Zt(u.y,1,An-1)<<3|v)}encodeBorderCentroid(n){if(!n.borders)return new et(0,0);const s=n.borders,u=Number.MAX_VALUE;if(s[0][0]!==u||s[1][0]!==u){const g=s[0][0]!==u?0:1;return new et(6|(s[0][0]!==u?0:65528),(s[g][0]+s[g][1])/2<<3|6)}{const g=s[2][0]!==u?2:3;return new et((s[g][0]+s[g][1])/2<<3|6,6|(s[2][0]!==u?0:65528))}}showCentroid(n){const s=this.centroidData[n.centroidDataIndex];s.flags&=Cu,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(n){this.groundEffect.updateHiddenByLandmark(n);const s=n.vertexArrayOffset,u=n.vertexCount+n.vertexArrayOffset,g=n.flags&Cu?dM:n.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==g.y||h!==g.x){for(let v=s;v<u;++v)this.centroidVertexArray.emplace(v,g.x,g.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const n of this.centroidData)this.writeCentroidToBuffer(n)}updateReplacement(n,s,u){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const g=s.getReplacementRegionsForTile(n.toUnwrapped());if(rx(this.activeReplacements,g))return;if(this.activeReplacements=g,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const h=[];for(const v of this.activeReplacements){if(v.order<u)continue;const T=Math.pow(2,v.footprintTileId.canonical.z-n.canonical.z);for(const P of this.centroidData)if(!(P.flags&Cu||v.min.x>P.max.x||P.min.x>v.max.x||v.min.y>P.max.y||P.min.y>v.max.y))for(let L=0;L<P.footprintSegLen;L++){const w=this.footprintSegments[P.footprintSegIdx+L];if(h.length=0,yF(this.footprintVertices,w.vertexOffset,w.vertexCount,v.footprintTileId.canonical,n.canonical,h),sM(v.footprint,h,this.footprintIndices.uint16,w.indexOffset,w.indexCount,-w.vertexOffset,-T)){P.flags|=Cu;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(n,s,u){let g=!1;for(let h=0;h<u.footprintSegLen;h++){const v=this.footprintSegments[u.footprintSegIdx+h];let T=0;for(const P of v.ringIndices){for(let L=T,w=P+T-1;L<P+T;w=L++){const M=this.footprintVertices.int16[2*(L+v.vertexOffset)+0],D=this.footprintVertices.int16[2*(L+v.vertexOffset)+1],I=this.footprintVertices.int16[2*(w+v.vertexOffset)+1];D>s!=I>s&&n<(this.footprintVertices.int16[2*(w+v.vertexOffset)+0]-M)*(s-D)/(I-D)+M&&(g=!g)}T=P}}return g}getHeightAtTileCoord(n,s){let u=Number.NEGATIVE_INFINITY,g=!0;const h=4*(n+An)*An+(s+An);if(this.partLookup.hasOwnProperty(h)){const v=this.partLookup[h];return v?{height:v.height,hidden:!!(v.flags&Cu)}:void 0}for(const v of this.centroidData)n>v.max.x||v.min.x>n||s>v.max.y||v.min.y>s||this.footprintContainsPoint(n,s,v)&&v&&v.height>u&&(u=v.height,this.partLookup[h]=v,g=!!(v.flags&Cu));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:g};this.partLookup[h]=void 0}}function vM(c,n){const s=c.add(n)._unit();return c.x*s.x+c.y*s.y}function _F(c,n,s,u){const g=n.sub(c)._perp()._unit(),h=s.sub(n)._perp()._unit();return _M(c,n,s,vM(g,h),u)}function _M(c,n,s,u,g){const h=Math.sqrt(1-u*u);return Math.min(c.dist(n)/3,n.dist(s)/3,g*h/u)}function sx(c,n,s){return c.x<s[0].x&&n.x<s[0].x||c.x>s[1].x&&n.x>s[1].x||c.y<s[0].y&&n.y<s[0].y||c.y>s[1].y&&n.y>s[1].y}function yM(c,n){return c.x<n[0].x||c.x>n[1].x||c.y<n[0].y||c.y>n[1].y}function bM(c,n,s){if(c.x<0||c.x>=An||n.x<0||n.x>=An||s.x<0||s.x>=An)return!1;const u=s.sub(n),g=u.perp(),h=c.sub(n);return(u.x*h.x+u.y*h.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(h.x*h.x+h.y*h.y))>-.866&&g.x*h.x+g.y*h.y<0}function xM(c,n,s){const u=n?2|c:-3&c;return s?1|u:-2&u}function wM(){const c=Math.PI/32,n=Math.tan(c),s=J;return s*Math.sqrt(1+2*n*n)-s}function SM(c,n,s){const u=1<<s.z,g=je(s.x/u),h=je((s.x+1)/u),v=Ue(s.y/u),T=Ue((s.y+1)/u);return function(P,L,w,M,D=0,I){const R=[];if(!P.length||!w||!M)return R;const B=(me,Ee)=>{for(const Oe of me)R.push({polygon:Oe,bounds:Ee})},j=Math.ceil(Math.log2(w)),K=Math.ceil(Math.log2(M)),ne=j-K,oe=[];for(let me=0;me<Math.abs(ne);me++)oe.push(ne>0?0:1);for(let me=0;me<Math.min(j,K);me++)oe.push(0),oe.push(1);let Y=P;if(Y=Sy(Y,L[0].y-D,L[1].y+D,1),Y=Sy(Y,L[0].x-D,L[1].x+D,0),!Y.length)return R;const ae=[];for(oe.length?ae.push({polygons:Y,bounds:L,depth:0}):B(Y,L);ae.length;){const me=ae.pop(),Ee=me.depth,Oe=oe[Ee],Be=me.bounds[0],De=me.bounds[1],Xe=Oe===0?Be.x:Be.y,$e=Oe===0?De.x:De.y,tt=I?I(Oe,Xe,$e):.5*(Xe+$e),ft=Sy(me.polygons,Xe-D,tt+D,Oe),vt=Sy(me.polygons,tt-D,$e+D,Oe);if(ft.length){const yt=[Be,new et(Oe===0?tt:De.x,Oe===1?tt:De.y)];oe.length>Ee+1?ae.push({polygons:ft,bounds:yt,depth:Ee+1}):B(ft,yt)}if(vt.length){const yt=[new et(Oe===0?tt:Be.x,Oe===1?tt:Be.y),De];oe.length>Ee+1?ae.push({polygons:vt,bounds:yt,depth:Ee+1}):B(vt,yt)}}return R}(c,n,Math.ceil((h-g)/11.25),Math.ceil((v-T)/11.25),1,(P,L,w)=>{if(P===0)return .5*(L+w);{const M=Ue((s.y+L/An)/u);return(Ne(.5*(Ue((s.y+w/An)/u)+M))*u-s.y)*An}})}function yF(c,n,s,u,g,h){const v=Math.pow(2,u.z-g.z);for(let T=0;T<s;T++){let P=c.int16[2*(T+n)+0],L=c.int16[2*(T+n)+1];P=(P+g.x*An)*v-u.x*An,L=(L+g.y*An)*v-u.y*An,h.push(new et(P,L))}}let TM,CM;function xg(c,n){return c.x*n.x+c.y*n.y}function EM(c,n){if(c.length===1){let s=0;const u=n[s++];let g;for(;!g||u.equals(g);)if(g=n[s++],!g)return 1/0;for(;s<n.length;s++){const h=n[s],v=c[0],T=g.sub(u),P=h.sub(u),L=v.sub(u),w=xg(T,T),M=xg(T,P),D=xg(P,P),I=xg(L,T),R=xg(L,P),B=w*D-M*M,j=(D*I-M*R)/B,K=(w*R-M*I)/B,ne=u.z*(1-j-K)+g.z*j+h.z*K;if(isFinite(ne))return ne}return 1/0}{let s=1/0;for(const u of n)s=Math.min(s,u.z);return s}}function MM(c,n,s,u,g,h,v,T){const P=v*g.getElevationAt(c,n,!0,!0),L=h[0]!==0,w=L?h[1]===0?v*(h[0]/7-450):v*function(M,D,I){const R=Math.floor(D[0]/8),B=Math.floor(D[1]/8),j=10*(D[0]-8*R),K=10*(D[1]-8*B),ne=M.getElevationAt(R,B,!0,!0),oe=M.getMeterToDEM(I),Y=Math.floor(.5*(j*oe-1)),ae=Math.floor(.5*(K*oe-1)),me=M.tileCoordToPixel(R,B),Ee=2*Y+1,Oe=2*ae+1,Be=function(vt,yt,wt,Bt,St){return[vt.getElevationAtPixel(yt,wt,!0),vt.getElevationAtPixel(yt+St,wt,!0),vt.getElevationAtPixel(yt,wt+St,!0),vt.getElevationAtPixel(yt+Bt,wt+St,!0)]}(M,me.x-Y,me.y-ae,Ee,Oe),De=Math.abs(Be[0]-Be[1]),Xe=Math.abs(Be[2]-Be[3]),$e=Math.abs(Be[0]-Be[2])+Math.abs(Be[1]-Be[3]),tt=Math.min(.25,.5*oe*(De+Xe)/Ee),ft=Math.min(.25,.5*oe*$e/Oe);return ne+Math.max(tt*j,ft*K)}(g,h,T):P;return{base:P+(s===0)?-1:s,top:L?Math.max(w+u,P+s+2):P+u}}Gn(My,"FillExtrusionBucket",{omit:["layers","features"]}),Gn(fM,"PartData"),Gn(hM,"FootprintSegment"),Gn(pM,"BorderCentroidData"),Gn(gM,"GroundEffect");const bF=oo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),xF=oo([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:wF}=bF,SF=oo([{name:"a_packed",components:4,type:"Float32"}]),{members:TF}=SF,CF=oo([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:EF}=CF;class IM{constructor(n,s){this.width=n,this.height=s,this.nextRow=0,this.image=new Tu({width:n,height:s}),this.positions={},this.uploaded=!1}getDash(n,s){const u=this.getKey(n,s);return this.positions[u]}trim(){const n=this.width,s=this.height=Rt(this.nextRow);this.image.resize({width:n,height:s})}getKey(n,s){return n.join(",")+s}getDashRanges(n,s,u){const g=[];let h=n.length%2==1?-n[n.length-1]*u:0,v=n[0]*u,T=!0;g.push({left:h,right:v,isDash:T,zeroLength:n[0]===0});let P=n[0];for(let L=1;L<n.length;L++){T=!T;const w=n[L];h=P*u,P+=w,v=P*u,g.push({left:h,right:v,isDash:T,zeroLength:w===0})}return g}addRoundDash(n,s,u){const g=s/2;for(let h=-u;h<=u;h++){const v=this.width*(this.nextRow+u+h);let T=0,P=n[T];for(let L=0;L<this.width;L++){L/P.right>1&&(P=n[++T]);const w=Math.abs(L-P.left),M=Math.abs(L-P.right),D=Math.min(w,M);let I;const R=h/u*(g+1);if(P.isDash){const B=g-Math.abs(R);I=Math.sqrt(D*D+B*B)}else I=g-Math.sqrt(D*D+R*R);this.image.data[v+L]=Math.max(0,Math.min(255,I+128))}}}addRegularDash(n,s){for(let P=n.length-1;P>=0;--P){const L=n[P],w=n[P+1];L.zeroLength?n.splice(P,1):w&&w.isDash===L.isDash&&(w.left=L.left,n.splice(P,1))}const u=n[0],g=n[n.length-1];u.isDash===g.isDash&&(u.left=g.left-this.width,g.right=u.right+this.width);const h=this.width*this.nextRow;let v=0,T=n[v];for(let P=0;P<this.width;P++){P/T.right>1&&(T=n[++v]);const L=Math.abs(P-T.left),w=Math.abs(P-T.right),M=Math.min(L,w);this.image.data[h+P]=Math.max(0,Math.min(255,(T.isDash?M:-M)+s+128))}}addDash(n,s){const u=this.getKey(n,s);if(this.positions[u])return this.positions[u];const g=s==="round",h=g?7:0,v=2*h+1;if(this.nextRow+v>this.height)return Hn("LineAtlas out of space"),null;n.length===0&&n.push(1);let T=0;for(let w=0;w<n.length;w++)n[w]<0&&(Hn("Negative value is found in line dasharray, replacing values with 0"),n[w]=0),T+=n[w];if(T!==0){const w=this.width/T,M=this.getDashRanges(n,this.width,w);g?this.addRoundDash(M,w,h):this.addRegularDash(M,s==="square"?.5*w:0)}const P=this.nextRow+h;this.nextRow+=v;const L={tl:[P,h],br:[T,0]};return this.positions[u]=L,L}}Gn(IM,"LineAtlas");const MF=Vf.VectorTileFeature.types,IF=Math.cos(Math.PI/180*37.5),kF=Math.cos(Math.PI/180*5);class ax{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new Xm,this.layoutVertexArray2=new Za,this.patternVertexArray=new Dl,this.indexArray=new Ii,this.programConfigurations=new Ol(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new Zo,this.maxLineLength=0,this.zOffsetVertexArray=new vu,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.tessellationStep=n.tessellationStep?n.tessellationStep:An/64}updateFootprints(n,s){}populate(n,s,u,g){this.hasPattern=Z1("line",this.layers,s);const h=this.layers[0].layout.get("line-sort-key"),v=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!v.isConstant()||!!v.constantOr(0);const T=[];for(const{feature:M,id:D,index:I,sourceLayerIndex:R}of n){const B=this.layers[0]._featureFilter.needGeometry,j=wn(M,B);if(!this.layers[0]._featureFilter.filter(new Ko(this.zoom),j,u))continue;const K=h?h.evaluate(j,{},u):void 0,ne={id:D,properties:M.properties,type:M.type,sourceLayerIndex:R,index:I,geometry:B?j.geometry:bn(M,u,g),patterns:{},sortKey:K};T.push(ne)}h&&T.sort((M,D)=>M.sortKey-D.sortKey);const{lineAtlas:P,featureIndex:L}=s,w=this.addConstantDashes(P);for(const M of T){const{geometry:D,index:I,sourceLayerIndex:R}=M;if(w&&this.addFeatureDashes(M,P),this.hasPattern){const B=Y1("line",this.layers,M,this.zoom,s);this.patternFeatures.push(B)}else this.addFeature(M,D,I,u,P.positions,s.availableImages,s.brightness);L.insert(n[I].feature,D,I,R,this.index)}}addConstantDashes(n){let s=!1;for(const u of this.layers){const g=u.paint.get("line-dasharray").value,h=u.layout.get("line-cap").value;if(g.kind!=="constant"||h.kind!=="constant")s=!0;else{const v=h.value,T=g.value;if(!T)continue;n.addDash(T,v)}}return s}addFeatureDashes(n,s){const u=this.zoom;for(const g of this.layers){const h=g.paint.get("line-dasharray").value,v=g.layout.get("line-cap").value;if(h.kind==="constant"&&v.kind==="constant")continue;let T,P;if(h.kind==="constant"){if(T=h.value,!T)continue}else T=h.evaluate({zoom:u},n);P=v.kind==="constant"?v.value:v.evaluate({zoom:u},n),s.addDash(T,P),n.patterns[g.id]=s.getKey(T,P)}}update(n,s,u,g,h){const v=Object.keys(n).length!==0;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,s,v?this.stateDependentLayers:this.layers,u,g,h)}addFeatures(n,s,u,g,h,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,s,u,g,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,TF)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=n.createVertexBuffer(this.patternVertexArray,EF)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,xF.members,!0)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,wF),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,u,g,h,v,T){const P=this.layers[0].layout,L=P.get("line-join").evaluate(n,{}),w=P.get("line-cap").evaluate(n,{}),M=P.get("line-miter-limit"),D=P.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const I of s)this.addLine(I,n,g,L,w,M,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,g,T)}addLine(n,s,u,g,h,v,T){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const P={zoom:this.zoom,lineProgress:void 0},L=this.layers[0].layout,w=g==="none";if(this.patternJoinNone=this.hasPattern&&w,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let me=0;me<n.length-1;me++)this.totalDistance+=n[me].dist(n[me+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const M=MF[s.type]==="Polygon";let D=n.length;for(;D>=2&&n[D-1].equals(n[D-2]);)D--;let I=0;for(;I<D-1&&n[I].equals(n[I+1]);)I++;if(D<(M?3:2))return;g==="bevel"&&(v=1.05);const R=this.overscaling<=16?15*An/(512*this.overscaling):0,B=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let j,K,ne,oe,Y,ae;this.e1=this.e2=-1,M&&(j=n[D-2],Y=n[I].sub(j)._unit()._perp());for(let me=I;me<D;me++){if(ne=me===D-1?M?n[I+1]:void 0:n[me+1],ne&&n[me].equals(ne))continue;if(Y&&(oe=Y),j&&(K=j),j=n[me],this.hasZOffset){const yt=L.get("line-z-offset").value;if(yt.kind==="constant")ae=yt.value;else{if(this.lineClips){const wt=this.totalDistance/(this.lineClips.end-this.lineClips.start);P.lineProgress=(wt*this.lineClips.start+this.distance+(K?K.dist(j):0))/wt}else Hn(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),P.lineProgress=0;ae=yt.evaluate(P,s)}ae=ae||0}Y=ne?ne.sub(j)._unit()._perp():oe,oe=oe||Y;const Ee=K&&ne;let Oe=Ee?g:M||w?"butt":h;const Be=oe.x*Y.x+oe.y*Y.y;if(w){const yt=function(wt){if(wt.patternJoinNone){const Bt=wt.segmentPoints.length/2,St=wt.lineSoFar-wt.segmentStart;for(let Xt=0;Xt<Bt;++Xt){const un=wt.segmentPoints[2*Xt+1],Gt=Math.round(wt.segmentPoints[2*Xt])+.5+.25*un;wt.patternVertexArray.emplaceBack(Gt,St,wt.segmentStart),wt.patternVertexArray.emplaceBack(Gt,St,wt.segmentStart)}wt.segmentPoints.length=0}wt.e1=wt.e2=-1};if(Ee&&Be<kF){this.updateDistance(K,j),this.addCurrentVertex(j,oe,1,1,B,ae),yt(this),this.addCurrentVertex(j,Y,-1,-1,B,ae);continue}if(K){if(!ne){this.updateDistance(K,j),this.addCurrentVertex(j,oe,1,1,B,ae),yt(this);continue}Oe="miter"}}let De=oe.add(Y);De.x===0&&De.y===0||De._unit();const Xe=De.x*Y.x+De.y*Y.y,$e=Xe!==0?1/Xe:1/0,tt=2*Math.sqrt(2-2*Xe),ft=Xe<IF&&K&&ne,vt=oe.x*Y.y-oe.y*Y.x>0;if(ft&&me>I){const yt=j.dist(K);if(yt>2*R){const wt=j.sub(j.sub(K)._mult(R/yt)._round());this.updateDistance(K,wt),this.addCurrentVertex(wt,oe,0,0,B,ae),K=wt}}if(Ee&&Oe==="round"&&($e<T?Oe="miter":$e<=2&&(Oe="fakeround")),Oe==="miter"&&$e>v&&(Oe="bevel"),Oe==="bevel"&&($e>2&&(Oe="flipbevel"),$e<v&&(Oe="miter")),K&&this.updateDistance(K,j),Oe==="miter")De._mult($e),this.addCurrentVertex(j,De,0,0,B,ae);else if(Oe==="flipbevel"){if($e>100)De=Y.mult(-1);else{const yt=$e*oe.add(Y).mag()/oe.sub(Y).mag();De._perp()._mult(yt*(vt?-1:1))}this.addCurrentVertex(j,De,0,0,B,ae),this.addCurrentVertex(j,De.mult(-1),0,0,B,ae)}else if(Oe==="bevel"||Oe==="fakeround"){const yt=-Math.sqrt($e*$e-1),wt=vt?yt:0,Bt=vt?0:yt;if(K&&this.addCurrentVertex(j,oe,wt,Bt,B,ae),Oe==="fakeround"){const St=Math.round(180*tt/Math.PI/20);for(let Xt=1;Xt<St;Xt++){let un=Xt/St;if(un!==.5){const On=un-.5;un+=un*On*(un-1)*((1.0904+Be*(Be*(3.55645-1.43519*Be)-3.2452))*On*On+(.848013+Be*(.215638*Be-1.06021)))}const Gt=Y.sub(oe)._mult(un)._add(oe)._unit()._mult(vt?-1:1);this.addHalfVertex(j,Gt.x,Gt.y,!1,vt,0,B,ae)}}ne&&this.addCurrentVertex(j,Y,-wt,-Bt,B,ae)}else Oe==="butt"?this.addCurrentVertex(j,De,0,0,B,ae):Oe==="square"?(K||this.addCurrentVertex(j,De,-1,-1,B,ae),this.addCurrentVertex(j,De,0,0,B,ae),K&&this.addCurrentVertex(j,De,1,1,B,ae)):Oe==="round"&&(K&&(this.addCurrentVertex(j,oe,0,0,B,ae),this.addCurrentVertex(j,oe,1,1,B,ae,!0)),ne&&(this.addCurrentVertex(j,Y,-1,-1,B,ae,!0),this.addCurrentVertex(j,Y,0,0,B,ae)));if(ft&&me<D-1){const yt=j.dist(ne);if(yt>2*R){const wt=j.add(ne.sub(j)._mult(R/yt)._round());this.updateDistance(j,wt),this.addCurrentVertex(wt,Y,0,0,B,ae),j=wt}}}}addVerticesTo(n,s,u,g,h,v,T,P,L,w){const M=(s.w-n.w)/this.tessellationStep|0;if(M>1){this.lineSoFar=n.w;const D=(s.x-n.x)/M,I=(s.y-n.y)/M,R=(s.z-n.z)/M,B=(s.w-n.w)/M;for(let j=1;j<M;++j)n.x+=D,n.y+=I,n.z+=R,this.lineSoFar+=B,this.addHalfVertex(n,u,g,w,!1,T,L,n.z),this.addHalfVertex(n,h,v,w,!0,-P,L,n.z)}this.lineSoFar=s.w,this.addHalfVertex(s,u,g,w,!1,T,L,s.z),this.addHalfVertex(s,h,v,w,!0,-P,L,s.z)}addCurrentVertex(n,s,u,g,h,v,T=!1){const P=s.x+s.y*u,L=s.y-s.x*u,w=s.y*g-s.x,M=-s.y-s.x*g;if(v!=null){const I=An+10,R=v,B=new eM(n.x,n.y,R,this.lineSoFar),j=kM(n,-10,I),K=this.lineSoFar;if(this.currentVertex)if(j){const ne=this.currentVertexIsOutside,oe=this.currentVertex,Y=new eM(n.x,n.y,R,this.lineSoFar);nM(oe,Y,-10,I),kM(Y,-10,I)||(ne&&(this.e1=this.e2=-1,this.lineSoFar=oe.w,this.addHalfVertex(oe,P,L,T,!1,u,h,oe.z),this.addHalfVertex(oe,w,M,T,!0,-g,h,oe.z)),this.addVerticesTo(oe,Y,P,L,w,M,u,g,h,T))}else{const ne=this.currentVertex;this.currentVertexIsOutside&&(nM(ne,B,-10,I),this.e1=this.e2=-1,this.lineSoFar=ne.w,this.addHalfVertex(ne,P,L,T,!1,u,h,ne.z),this.addHalfVertex(ne,w,M,T,!0,-g,h,ne.z)),this.addVerticesTo(ne,B,P,L,w,M,u,g,h,T)}else j||(this.addHalfVertex(n,P,L,T,!1,u,h,v),this.addHalfVertex(n,w,M,T,!0,-g,h,v));this.currentVertex=B,this.currentVertexIsOutside=j,this.lineSoFar=K}else this.addHalfVertex(n,P,L,T,!1,u,h,v),this.addHalfVertex(n,w,M,T,!0,-g,h,v)}addHalfVertex({x:n,y:s},u,g,h,v,T,P,L){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,T)),this.layoutVertexArray.emplaceBack((n<<1)+(h?1:0),(s<<1)+(v?1:0),Math.round(63*u)+128,Math.round(63*g)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const w=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,w),P.primitiveLength++),v?this.e2=w:this.e1=w,L!=null&&this.zOffsetVertexArray.emplaceBack(L)}updateScaledDistance(){if(this.lineClips){const n=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=n*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(n,s){this.distance+=n.dist(s),this.updateScaledDistance()}}function kM(c,n,s){return c.x<n||c.x>s||c.y<n||c.y>s}let AM,PM;function RM(c,n,s){return n*(An/(c.tileSize*Math.pow(2,s-c.tileID.overscaledZ)))}function DM(c,n){return 1/RM(c,1,n.tileZoom)}function LM(c,n,s,u){return c.translatePosMatrix(u||n.tileID.projMatrix,n,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}Gn(ax,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const OM=c=>{const n=[];zM(c)&&n.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT");const s=c.paint.get("line-trim-offset");s[0]===0&&s[1]===0||n.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&n.push("RENDER_LINE_BORDER");const u=c.layout.get("line-join").constantOr("miter")==="none",g=!!c.paint.get("line-pattern").constantOr(1);return u&&g&&n.push("LINE_JOIN_NONE"),n};function zM(c){const n=c.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}let lx;const BM=()=>lx||(lx={layout:AM||(AM=new $o({"line-cap":new Qn(Dt.layout_line["line-cap"]),"line-join":new Qn(Dt.layout_line["line-join"]),"line-miter-limit":new Sn(Dt.layout_line["line-miter-limit"]),"line-round-limit":new Sn(Dt.layout_line["line-round-limit"]),"line-sort-key":new Qn(Dt.layout_line["line-sort-key"]),"line-z-offset":new Qn(Dt.layout_line["line-z-offset"]),visibility:new Sn(Dt.layout_line.visibility)})),paint:PM||(PM=new $o({"line-opacity":new Qn(Dt.paint_line["line-opacity"]),"line-color":new Qn(Dt.paint_line["line-color"]),"line-translate":new Sn(Dt.paint_line["line-translate"]),"line-translate-anchor":new Sn(Dt.paint_line["line-translate-anchor"]),"line-width":new Qn(Dt.paint_line["line-width"]),"line-gap-width":new Qn(Dt.paint_line["line-gap-width"]),"line-offset":new Qn(Dt.paint_line["line-offset"]),"line-blur":new Qn(Dt.paint_line["line-blur"]),"line-dasharray":new Qn(Dt.paint_line["line-dasharray"]),"line-pattern":new Qn(Dt.paint_line["line-pattern"]),"line-gradient":new ia(Dt.paint_line["line-gradient"]),"line-trim-offset":new Sn(Dt.paint_line["line-trim-offset"]),"line-trim-fade-range":new Sn(Dt.paint_line["line-trim-fade-range"]),"line-trim-color":new Sn(Dt.paint_line["line-trim-color"]),"line-emissive-strength":new Sn(Dt.paint_line["line-emissive-strength"]),"line-border-width":new Qn(Dt.paint_line["line-border-width"]),"line-border-color":new Qn(Dt.paint_line["line-border-color"]),"line-occlusion-opacity":new Sn(Dt.paint_line["line-occlusion-opacity"])}))},lx);class AF extends Qn{possiblyEvaluate(n,s){return s=new Ko(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(n,s)}evaluate(n,s,u,g){return s=ar({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(n,s,u,g)}}let wg;function FM(c,n){return n>0?n+2*c:c}const PF=oo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),RF=oo([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),DF=oo([{name:"a_projected_pos",components:4,type:"Float32"}],4);oo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const LF=oo([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),OF=oo([{name:"a_texb",components:2,type:"Uint16"}]),zF=oo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),BF=oo([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);oo([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const NM=oo([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),FF=oo([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);oo([{name:"triangle",components:3,type:"Uint16"}]),oo([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),oo([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),oo([{type:"Float32",name:"offsetX"}]),oo([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ri=24;const el=128;function cx(c,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Ko(c+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:g}=s;let h=0;for(;h<u.length&&u[h]<=c;)h++;h=Math.max(0,h-1);let v=h;for(;v<u.length&&u[v]<c+1;)v++;v=Math.min(u.length-1,v);const T=u[h],P=u[v];return s.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:P,interpolationType:g}:{kind:"camera",minZoom:T,maxZoom:P,minSize:s.evaluate(new Ko(T)),maxSize:s.evaluate(new Ko(P)),interpolationType:g}}}function Iy(c,{uSize:n,uSizeT:s},{lowerSize:u,upperSize:g}){return c.kind==="source"?u/el:c.kind==="composite"?pr(u/el,g/el,s):n}function Uf(c,n){let s=0,u=0;if(c.kind==="constant")u=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:g,minZoom:h,maxZoom:v}=c,T=g?Zt(Cs.interpolationFactor(g,n,h,v),0,1):0;c.kind==="camera"?u=pr(c.minSize,c.maxSize,T):s=T}return{uSizeT:s,uSize:u}}var NF=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:el,evaluateSizeForFeature:Iy,evaluateSizeForZoom:Uf,getSizeData:cx});function $F(c,n,s){return c.sections.forEach(u=>{u.text=function(g,h,v){const T=h.layout.get("text-transform").evaluate(v,{});return T==="uppercase"?g=g.toLocaleUpperCase():T==="lowercase"&&(g=g.toLocaleLowerCase()),us.applyArabicShaping&&(g=us.applyArabicShaping(g)),g}(u.text,n,s)}),c}const Sg={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function VF(c){return c==="︶"||c==="﹈"||c==="︸"||c==="﹄"||c==="﹂"||c==="︾"||c==="︼"||c==="︺"||c==="︘"||c==="﹀"||c==="︐"||c==="︓"||c==="︔"||c==="｀"||c==="￣"||c==="︑"||c==="︒"}function UF(c){return c==="︵"||c==="﹇"||c==="︷"||c==="﹃"||c==="﹁"||c==="︽"||c==="︻"||c==="︹"||c==="︗"||c==="︿"}var $M,ux,VM,dx={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function jF(){return $M||($M=1,dx.read=function(c,n,s,u,g){var h,v,T=8*g-u-1,P=(1<<T)-1,L=P>>1,w=-7,M=s?g-1:0,D=s?-1:1,I=c[n+M];for(M+=D,h=I&(1<<-w)-1,I>>=-w,w+=T;w>0;h=256*h+c[n+M],M+=D,w-=8);for(v=h&(1<<-w)-1,h>>=-w,w+=u;w>0;v=256*v+c[n+M],M+=D,w-=8);if(h===0)h=1-L;else{if(h===P)return v?NaN:1/0*(I?-1:1);v+=Math.pow(2,u),h-=L}return(I?-1:1)*v*Math.pow(2,h-u)},dx.write=function(c,n,s,u,g,h){var v,T,P,L=8*h-g-1,w=(1<<L)-1,M=w>>1,D=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=u?0:h-1,R=u?1:-1,B=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(T=isNaN(n)?1:0,v=w):(v=Math.floor(Math.log(n)/Math.LN2),n*(P=Math.pow(2,-v))<1&&(v--,P*=2),(n+=v+M>=1?D/P:D*Math.pow(2,1-M))*P>=2&&(v++,P/=2),v+M>=w?(T=0,v=w):v+M>=1?(T=(n*P-1)*Math.pow(2,g),v+=M):(T=n*Math.pow(2,M-1)*Math.pow(2,g),v=0));g>=8;c[s+I]=255&T,I+=R,T/=256,g-=8);for(v=v<<g|T,L+=g;L>0;c[s+I]=255&v,I+=R,v/=256,L-=8);c[s+I-R]|=128*B}),dx}function UM(){if(VM)return ux;VM=1,ux=n;var c=jF();function n(Y){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Y)?Y:new Uint8Array(Y||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var s=4294967296,u=1/s,g=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function h(Y){return Y.type===n.Bytes?Y.readVarint()+Y.pos:Y.pos+1}function v(Y,ae,me){return me?4294967296*ae+(Y>>>0):4294967296*(ae>>>0)+(Y>>>0)}function T(Y,ae,me){var Ee=ae<=16383?1:ae<=2097151?2:ae<=268435455?3:Math.floor(Math.log(ae)/(7*Math.LN2));me.realloc(Ee);for(var Oe=me.pos-1;Oe>=Y;Oe--)me.buf[Oe+Ee]=me.buf[Oe]}function P(Y,ae){for(var me=0;me<Y.length;me++)ae.writeVarint(Y[me])}function L(Y,ae){for(var me=0;me<Y.length;me++)ae.writeSVarint(Y[me])}function w(Y,ae){for(var me=0;me<Y.length;me++)ae.writeFloat(Y[me])}function M(Y,ae){for(var me=0;me<Y.length;me++)ae.writeDouble(Y[me])}function D(Y,ae){for(var me=0;me<Y.length;me++)ae.writeBoolean(Y[me])}function I(Y,ae){for(var me=0;me<Y.length;me++)ae.writeFixed32(Y[me])}function R(Y,ae){for(var me=0;me<Y.length;me++)ae.writeSFixed32(Y[me])}function B(Y,ae){for(var me=0;me<Y.length;me++)ae.writeFixed64(Y[me])}function j(Y,ae){for(var me=0;me<Y.length;me++)ae.writeSFixed64(Y[me])}function K(Y,ae){return(Y[ae]|Y[ae+1]<<8|Y[ae+2]<<16)+16777216*Y[ae+3]}function ne(Y,ae,me){Y[me]=ae,Y[me+1]=ae>>>8,Y[me+2]=ae>>>16,Y[me+3]=ae>>>24}function oe(Y,ae){return(Y[ae]|Y[ae+1]<<8|Y[ae+2]<<16)+(Y[ae+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(Y,ae,me){for(me=me||this.length;this.pos<me;){var Ee=this.readVarint(),Oe=Ee>>3,Be=this.pos;this.type=7&Ee,Y(Oe,ae,this),this.pos===Be&&this.skip(Ee)}return ae},readMessage:function(Y,ae){return this.readFields(Y,ae,this.readVarint()+this.pos)},readFixed32:function(){var Y=K(this.buf,this.pos);return this.pos+=4,Y},readSFixed32:function(){var Y=oe(this.buf,this.pos);return this.pos+=4,Y},readFixed64:function(){var Y=K(this.buf,this.pos)+K(this.buf,this.pos+4)*s;return this.pos+=8,Y},readSFixed64:function(){var Y=K(this.buf,this.pos)+oe(this.buf,this.pos+4)*s;return this.pos+=8,Y},readFloat:function(){var Y=c.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Y},readDouble:function(){var Y=c.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Y},readVarint:function(Y){var ae,me,Ee=this.buf;return ae=127&(me=Ee[this.pos++]),me<128?ae:(ae|=(127&(me=Ee[this.pos++]))<<7,me<128?ae:(ae|=(127&(me=Ee[this.pos++]))<<14,me<128?ae:(ae|=(127&(me=Ee[this.pos++]))<<21,me<128?ae:function(Oe,Be,De){var Xe,$e,tt=De.buf;if(Xe=(112&($e=tt[De.pos++]))>>4,$e<128||(Xe|=(127&($e=tt[De.pos++]))<<3,$e<128)||(Xe|=(127&($e=tt[De.pos++]))<<10,$e<128)||(Xe|=(127&($e=tt[De.pos++]))<<17,$e<128)||(Xe|=(127&($e=tt[De.pos++]))<<24,$e<128)||(Xe|=(1&($e=tt[De.pos++]))<<31,$e<128))return v(Oe,Xe,Be);throw new Error("Expected varint not more than 10 bytes")}(ae|=(15&(me=Ee[this.pos]))<<28,Y,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Y=this.readVarint();return Y%2==1?(Y+1)/-2:Y/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var Y=this.readVarint()+this.pos,ae=this.pos;return this.pos=Y,Y-ae>=12&&g?function(me,Ee,Oe){return g.decode(me.subarray(Ee,Oe))}(this.buf,ae,Y):function(me,Ee,Oe){for(var Be="",De=Ee;De<Oe;){var Xe,$e,tt,ft=me[De],vt=null,yt=ft>239?4:ft>223?3:ft>191?2:1;if(De+yt>Oe)break;yt===1?ft<128&&(vt=ft):yt===2?(192&(Xe=me[De+1]))==128&&(vt=(31&ft)<<6|63&Xe)<=127&&(vt=null):yt===3?($e=me[De+2],(192&(Xe=me[De+1]))==128&&(192&$e)==128&&((vt=(15&ft)<<12|(63&Xe)<<6|63&$e)<=2047||vt>=55296&&vt<=57343)&&(vt=null)):yt===4&&($e=me[De+2],tt=me[De+3],(192&(Xe=me[De+1]))==128&&(192&$e)==128&&(192&tt)==128&&((vt=(15&ft)<<18|(63&Xe)<<12|(63&$e)<<6|63&tt)<=65535||vt>=1114112)&&(vt=null)),vt===null?(vt=65533,yt=1):vt>65535&&(vt-=65536,Be+=String.fromCharCode(vt>>>10&1023|55296),vt=56320|1023&vt),Be+=String.fromCharCode(vt),De+=yt}return Be}(this.buf,ae,Y)},readBytes:function(){var Y=this.readVarint()+this.pos,ae=this.buf.subarray(this.pos,Y);return this.pos=Y,ae},readPackedVarint:function(Y,ae){if(this.type!==n.Bytes)return Y.push(this.readVarint(ae));var me=h(this);for(Y=Y||[];this.pos<me;)Y.push(this.readVarint(ae));return Y},readPackedSVarint:function(Y){if(this.type!==n.Bytes)return Y.push(this.readSVarint());var ae=h(this);for(Y=Y||[];this.pos<ae;)Y.push(this.readSVarint());return Y},readPackedBoolean:function(Y){if(this.type!==n.Bytes)return Y.push(this.readBoolean());var ae=h(this);for(Y=Y||[];this.pos<ae;)Y.push(this.readBoolean());return Y},readPackedFloat:function(Y){if(this.type!==n.Bytes)return Y.push(this.readFloat());var ae=h(this);for(Y=Y||[];this.pos<ae;)Y.push(this.readFloat());return Y},readPackedDouble:function(Y){if(this.type!==n.Bytes)return Y.push(this.readDouble());var ae=h(this);for(Y=Y||[];this.pos<ae;)Y.push(this.readDouble());return Y},readPackedFixed32:function(Y){if(this.type!==n.Bytes)return Y.push(this.readFixed32());var ae=h(this);for(Y=Y||[];this.pos<ae;)Y.push(this.readFixed32());return Y},readPackedSFixed32:function(Y){if(this.type!==n.Bytes)return Y.push(this.readSFixed32());var ae=h(this);for(Y=Y||[];this.pos<ae;)Y.push(this.readSFixed32());return Y},readPackedFixed64:function(Y){if(this.type!==n.Bytes)return Y.push(this.readFixed64());var ae=h(this);for(Y=Y||[];this.pos<ae;)Y.push(this.readFixed64());return Y},readPackedSFixed64:function(Y){if(this.type!==n.Bytes)return Y.push(this.readSFixed64());var ae=h(this);for(Y=Y||[];this.pos<ae;)Y.push(this.readSFixed64());return Y},skip:function(Y){var ae=7&Y;if(ae===n.Varint)for(;this.buf[this.pos++]>127;);else if(ae===n.Bytes)this.pos=this.readVarint()+this.pos;else if(ae===n.Fixed32)this.pos+=4;else{if(ae!==n.Fixed64)throw new Error("Unimplemented type: "+ae);this.pos+=8}},writeTag:function(Y,ae){this.writeVarint(Y<<3|ae)},realloc:function(Y){for(var ae=this.length||16;ae<this.pos+Y;)ae*=2;if(ae!==this.length){var me=new Uint8Array(ae);me.set(this.buf),this.buf=me,this.length=ae}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Y){this.realloc(4),ne(this.buf,Y,this.pos),this.pos+=4},writeSFixed32:function(Y){this.realloc(4),ne(this.buf,Y,this.pos),this.pos+=4},writeFixed64:function(Y){this.realloc(8),ne(this.buf,-1&Y,this.pos),ne(this.buf,Math.floor(Y*u),this.pos+4),this.pos+=8},writeSFixed64:function(Y){this.realloc(8),ne(this.buf,-1&Y,this.pos),ne(this.buf,Math.floor(Y*u),this.pos+4),this.pos+=8},writeVarint:function(Y){(Y=+Y||0)>268435455||Y<0?function(ae,me){var Ee,Oe;if(ae>=0?(Ee=ae%4294967296|0,Oe=ae/4294967296|0):(Oe=~(-ae/4294967296),4294967295^(Ee=~(-ae%4294967296))?Ee=Ee+1|0:(Ee=0,Oe=Oe+1|0)),ae>=18446744073709552e3||ae<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");me.realloc(10),function(Be,De,Xe){Xe.buf[Xe.pos++]=127&Be|128,Be>>>=7,Xe.buf[Xe.pos++]=127&Be|128,Be>>>=7,Xe.buf[Xe.pos++]=127&Be|128,Be>>>=7,Xe.buf[Xe.pos++]=127&Be|128,Xe.buf[Xe.pos]=127&(Be>>>=7)}(Ee,0,me),function(Be,De){var Xe=(7&Be)<<4;De.buf[De.pos++]|=Xe|((Be>>>=3)?128:0),Be&&(De.buf[De.pos++]=127&Be|((Be>>>=7)?128:0),Be&&(De.buf[De.pos++]=127&Be|((Be>>>=7)?128:0),Be&&(De.buf[De.pos++]=127&Be|((Be>>>=7)?128:0),Be&&(De.buf[De.pos++]=127&Be|((Be>>>=7)?128:0),Be&&(De.buf[De.pos++]=127&Be)))))}(Oe,me)}(Y,this):(this.realloc(4),this.buf[this.pos++]=127&Y|(Y>127?128:0),Y<=127||(this.buf[this.pos++]=127&(Y>>>=7)|(Y>127?128:0),Y<=127||(this.buf[this.pos++]=127&(Y>>>=7)|(Y>127?128:0),Y<=127||(this.buf[this.pos++]=Y>>>7&127))))},writeSVarint:function(Y){this.writeVarint(Y<0?2*-Y-1:2*Y)},writeBoolean:function(Y){this.writeVarint(!!Y)},writeString:function(Y){Y=String(Y),this.realloc(4*Y.length),this.pos++;var ae=this.pos;this.pos=function(Ee,Oe,Be){for(var De,Xe,$e=0;$e<Oe.length;$e++){if((De=Oe.charCodeAt($e))>55295&&De<57344){if(!Xe){De>56319||$e+1===Oe.length?(Ee[Be++]=239,Ee[Be++]=191,Ee[Be++]=189):Xe=De;continue}if(De<56320){Ee[Be++]=239,Ee[Be++]=191,Ee[Be++]=189,Xe=De;continue}De=Xe-55296<<10|De-56320|65536,Xe=null}else Xe&&(Ee[Be++]=239,Ee[Be++]=191,Ee[Be++]=189,Xe=null);De<128?Ee[Be++]=De:(De<2048?Ee[Be++]=De>>6|192:(De<65536?Ee[Be++]=De>>12|224:(Ee[Be++]=De>>18|240,Ee[Be++]=De>>12&63|128),Ee[Be++]=De>>6&63|128),Ee[Be++]=63&De|128)}return Be}(this.buf,Y,this.pos);var me=this.pos-ae;me>=128&&T(ae,me,this),this.pos=ae-1,this.writeVarint(me),this.pos+=me},writeFloat:function(Y){this.realloc(4),c.write(this.buf,Y,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Y){this.realloc(8),c.write(this.buf,Y,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Y){var ae=Y.length;this.writeVarint(ae),this.realloc(ae);for(var me=0;me<ae;me++)this.buf[this.pos++]=Y[me]},writeRawMessage:function(Y,ae){this.pos++;var me=this.pos;Y(ae,this);var Ee=this.pos-me;Ee>=128&&T(me,Ee,this),this.pos=me-1,this.writeVarint(Ee),this.pos+=Ee},writeMessage:function(Y,ae,me){this.writeTag(Y,n.Bytes),this.writeRawMessage(ae,me)},writePackedVarint:function(Y,ae){ae.length&&this.writeMessage(Y,P,ae)},writePackedSVarint:function(Y,ae){ae.length&&this.writeMessage(Y,L,ae)},writePackedBoolean:function(Y,ae){ae.length&&this.writeMessage(Y,D,ae)},writePackedFloat:function(Y,ae){ae.length&&this.writeMessage(Y,w,ae)},writePackedDouble:function(Y,ae){ae.length&&this.writeMessage(Y,M,ae)},writePackedFixed32:function(Y,ae){ae.length&&this.writeMessage(Y,I,ae)},writePackedSFixed32:function(Y,ae){ae.length&&this.writeMessage(Y,R,ae)},writePackedFixed64:function(Y,ae){ae.length&&this.writeMessage(Y,B,ae)},writePackedSFixed64:function(Y,ae){ae.length&&this.writeMessage(Y,j,ae)},writeBytesField:function(Y,ae){this.writeTag(Y,n.Bytes),this.writeBytes(ae)},writeFixed32Field:function(Y,ae){this.writeTag(Y,n.Fixed32),this.writeFixed32(ae)},writeSFixed32Field:function(Y,ae){this.writeTag(Y,n.Fixed32),this.writeSFixed32(ae)},writeFixed64Field:function(Y,ae){this.writeTag(Y,n.Fixed64),this.writeFixed64(ae)},writeSFixed64Field:function(Y,ae){this.writeTag(Y,n.Fixed64),this.writeSFixed64(ae)},writeVarintField:function(Y,ae){this.writeTag(Y,n.Varint),this.writeVarint(ae)},writeSVarintField:function(Y,ae){this.writeTag(Y,n.Varint),this.writeSVarint(ae)},writeStringField:function(Y,ae){this.writeTag(Y,n.Bytes),this.writeString(ae)},writeFloatField:function(Y,ae){this.writeTag(Y,n.Fixed32),this.writeFloat(ae)},writeDoubleField:function(Y,ae){this.writeTag(Y,n.Fixed64),this.writeDouble(ae)},writeBooleanField:function(Y,ae){this.writeVarintField(Y,!!ae)}},ux}var ky=C(UM());const hx=3;function HF(c,n,s){n.glyphs=[],c===1&&s.readMessage(GF,n)}function GF(c,n,s){if(c===3){const{id:u,bitmap:g,width:h,height:v,left:T,top:P,advance:L}=s.readMessage(WF,{});n.glyphs.push({id:u,bitmap:new Tu({width:h+2*hx,height:v+2*hx},g),metrics:{width:h,height:v,left:T,top:P,advance:L}})}else c===4?n.ascender=s.readSVarint():c===5&&(n.descender=s.readSVarint())}function WF(c,n,s){c===1?n.id=s.readVarint():c===2?n.bitmap=s.readBytes():c===3?n.width=s.readVarint():c===4?n.height=s.readVarint():c===5?n.left=s.readSVarint():c===6?n.top=s.readSVarint():c===7&&(n.advance=s.readVarint())}const jM=hx,la={horizontal:1,vertical:2,horizontalOnly:3};class Tg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,s){const u=new Tg;return u.scale=n||1,u.fontStack=s,u}static forImage(n){const s=new Tg;return s.imageName=n,s}}class jf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const u=new jf;for(let g=0;g<n.sections.length;g++){const h=n.sections[g];h.image?u.addImageSection(h):u.addTextSection(h,s)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCodePoint(n){return this.text.codePointAt(n)}verticalizePunctuation(n){this.text=function(s,u){let g="";for(let h=0;h<s.length;h++){const v=s.charCodeAt(h+1)||null,T=s.charCodeAt(h-1)||null;g+=!u&&(v&&Rd(v)&&!Sg[s[h+1]]||T&&Rd(T)&&!Sg[s[h-1]])||!Sg[s[h]]?s[h]:Sg[s[h]]}return g}(this.text,n)}trim(){let n=0;for(let u=0;u<this.text.length&&Ay[this.text.charCodeAt(u)];u++)n++;let s=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&Ay[this.text.charCodeAt(u)];u--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const u=new jf;return u.text=this.text.substring(n,s),u.sectionIndex=this.sectionIndex.slice(n,s),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(Tg.forText(n.scale,n.fontStack||s));const u=this.sections.length-1;for(let g=0;g<n.text.length;++g)this.sectionIndex.push(u)}addImageSection(n){const s=n.image?n.image.namePrimary:"";if(s.length===0)return void Hn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCodePoint(u),this.sections.push(Tg.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Hn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function fx(c,n,s,u,g,h,v,T,P,L,w,M,D,I,R){const B=jf.fromFeature(c,g);M===la.vertical&&B.verticalizePunctuation(D);let j=[];const K=function(me,Ee,Oe,Be,De,Xe){if(!me)return[];const $e=[],tt=function(wt,Bt,St,Xt,un,Gt){let On=0;for(let In=0;In<wt.length();In++){const xn=wt.getSection(In);On+=HM(wt.getCodePoint(In),xn,Xt,un,Bt,Gt)}return On/Math.max(1,Math.ceil(On/St))}(me,Ee,Oe,Be,De,Xe),ft=me.text.indexOf("​")>=0;let vt=0;for(let wt=0;wt<me.length();wt++){const Bt=me.getSection(wt),St=me.getCodePoint(wt);if(Ay[St]||(vt+=HM(St,Bt,Be,De,Ee,Xe)),wt<me.length()-1){const Xt=!((yt=St)<11904||!(Xn["Bopomofo Extended"](yt)||Xn.Bopomofo(yt)||Xn["CJK Compatibility Forms"](yt)||Xn["CJK Compatibility Ideographs"](yt)||Xn["CJK Compatibility"](yt)||Xn["CJK Radicals Supplement"](yt)||Xn["CJK Strokes"](yt)||Xn["CJK Symbols and Punctuation"](yt)||Xn["CJK Unified Ideographs Extension A"](yt)||Xn["CJK Unified Ideographs"](yt)||Xn["Enclosed CJK Letters and Months"](yt)||Xn["Halfwidth and Fullwidth Forms"](yt)||Xn.Hiragana(yt)||Xn["Ideographic Description Characters"](yt)||Xn["Kangxi Radicals"](yt)||Xn["Katakana Phonetic Extensions"](yt)||Xn.Katakana(yt)||Xn["Vertical Forms"](yt)||Xn["Yi Radicals"](yt)||Xn["Yi Syllables"](yt)));(qF[St]||Xt||Bt.imageName)&&$e.push(WM(wt+1,vt,tt,$e,KF(St,me.getCodePoint(wt+1),Xt&&ft),!1))}}var yt;return qM(WM(me.length(),vt,tt,$e,0,!0))}(B,L,h,n,u,I),{processBidirectionalText:ne,processStyledBidirectionalText:oe}=us;if(ne&&B.sections.length===1){const me=ne(B.toString(),K);for(const Ee of me){const Oe=new jf;Oe.text=Ee,Oe.sections=B.sections;for(let Be=0;Be<Ee.length;Be++)Oe.sectionIndex.push(0);j.push(Oe)}}else if(oe){const me=oe(B.text,B.sectionIndex,K);for(const Ee of me){const Oe=new jf;Oe.text=Ee[0],Oe.sectionIndex=Ee[1],Oe.sections=B.sections,j.push(Oe)}}else j=function(me,Ee){const Oe=[],Be=me.text;let De=0;for(const Xe of Ee)Oe.push(me.substring(De,Xe)),De=Xe;return De<Be.length&&Oe.push(me.substring(De,Be.length)),Oe}(B,K);const Y=[],ae={positionedLines:Y,text:B.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:M,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(me,Ee,Oe,Be,De,Xe,$e,tt,ft,vt,yt,wt){let Bt=0,St=0,Xt=0;const un=tt==="right"?1:tt==="left"?0:.5;let Gt=!1;for(const Ln of De){const Un=Ln.getSections();for(const br of Un){if(br.imageName)continue;const Or=Ee[br.fontStack];if(Or&&(Gt=Or.ascender!==void 0&&Or.descender!==void 0,!Gt))break}if(!Gt)break}let On=0;for(const Ln of De){Ln.trim();const Un=Ln.getMaxScale(),br=(Un-1)*Ri,Or={positionedGlyphs:[],lineOffset:0};me.positionedLines[On]=Or;const Ar=Or.positionedGlyphs;let Pr=0;if(!Ln.length()){St+=Xe,++On;continue}let Nr=0,Vr=0;for(let ho=0;ho<Ln.length();ho++){const Sr=Ln.getSection(ho),so=Ln.getSectionIndex(ho),lo=Ln.getCodePoint(ho);let Oo=Sr.scale,ei=null,di=null,ti=null,Wo=Ri,Si=0;const pi=!(ft===la.horizontal||!yt&&!wf(lo)||yt&&(Ay[lo]||(In=lo,Xn.Arabic(In)||Xn["Arabic Supplement"](In)||Xn["Arabic Extended-A"](In)||Xn["Arabic Presentation Forms-A"](In)||Xn["Arabic Presentation Forms-B"](In))));if(Sr.imageName){const Di=Be[Sr.imageName];if(!Di)continue;ti=Sr.imageName,me.iconsInText=me.iconsInText||!0,di=Di.paddedRect;const Do=Di.displaySize;Oo=Oo*Ri/wt,ei={width:Do[0],height:Do[1],left:0,top:-jM,advance:pi?Do[1]:Do[0],localGlyph:!1},Si=Gt?-ei.height*Oo:Un*Ri-17-Do[1]*Oo,Wo=ei.advance;const Is=(pi?Do[0]:Do[1])*Oo-Ri*Un;Is>0&&Is>Pr&&(Pr=Is)}else{const Di=Oe[Sr.fontStack];if(!Di)continue;Di[lo]&&(di=Di[lo]);const Do=Ee[Sr.fontStack];if(!Do)continue;const Is=Do.glyphs[lo];if(!Is)continue;if(ei=Is.metrics,Wo=lo!==8203?Ri:0,Gt){const il=Do.ascender!==void 0?Math.abs(Do.ascender):0,ka=Do.descender!==void 0?Math.abs(Do.descender):0,Aa=(il+ka)*Oo;Nr<Aa&&(Nr=Aa,Vr=(il-ka)/2*Oo),Si=-il*Oo}else Si=(Un-Oo)*Ri-17}pi?(me.verticalizable=!0,Ar.push({glyph:lo,imageName:ti,x:Bt,y:St+Si,vertical:pi,scale:Oo,localGlyph:ei.localGlyph,fontStack:Sr.fontStack,sectionIndex:so,metrics:ei,rect:di}),Bt+=Wo*Oo+vt):(Ar.push({glyph:lo,imageName:ti,x:Bt,y:St+Si,vertical:pi,scale:Oo,localGlyph:ei.localGlyph,fontStack:Sr.fontStack,sectionIndex:so,metrics:ei,rect:di}),Bt+=ei.advance*Oo+vt)}Ar.length!==0&&(Xt=Math.max(Bt-vt,Xt),Gt?KM(Ar,un,Pr,Vr,Xe*Un/2):KM(Ar,un,Pr,0,Xe/2)),Bt=0;const Co=Xe*Un+Pr;Or.lineOffset=Math.max(Pr,br),St+=Co,++On}var In;const xn=St,{horizontalAlign:mn,verticalAlign:nr}=px($e);(function(Ln,Un,br,Or,Ar,Pr){const Nr=(Un-br)*Ar,Vr=-Pr*Or;for(const Co of Ln)for(const ho of Co.positionedGlyphs)ho.x+=Nr,ho.y+=Vr})(me.positionedLines,un,mn,nr,Xt,xn),me.top+=-nr*xn,me.bottom=me.top+xn,me.left+=-mn*Xt,me.right=me.left+Xt,me.hasBaseline=Gt}(ae,n,s,u,j,v,T,P,M,L,D,R),!function(me){for(const Ee of me)if(Ee.positionedGlyphs.length!==0)return!1;return!0}(Y)&&ae}const Ay={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},qF={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function HM(c,n,s,u,g,h){if(n.imageName){const v=u[n.imageName];return v?v.displaySize[0]*n.scale*Ri/h+g:0}{const v=s[n.fontStack],T=v&&v.glyphs[c];return T?T.metrics.advance*n.scale+g:0}}function GM(c,n,s,u){const g=Math.pow(c-n,2);return u?c<n?g/2:2*g:g+Math.abs(s)*s}function KF(c,n,s){let u=0;return c===10&&(u-=1e4),s&&(u+=150),c!==40&&c!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function WM(c,n,s,u,g,h){let v=null,T=GM(n,s,g,h);for(const P of u){const L=GM(n-P.x,s,g,h)+P.badness;L<=T&&(v=P,T=L)}return{index:c,x:n,priorBreak:v,badness:T}}function qM(c){return c?qM(c.priorBreak).concat(c.index):[]}function px(c){let n=.5,s=.5;switch(c){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function KM(c,n,s,u,g){if(!(n||s||u||g))return;const h=c.length-1,v=c[h],T=(v.x+v.metrics.advance*v.scale)*n;for(let P=0;P<=h;P++)c[P].x-=T,c[P].y+=s+u+g}function ZF(c,n,s,u){const{horizontalAlign:g,verticalAlign:h}=px(u),v=s[0]-c.displaySize[0]*g,T=s[1]-c.displaySize[1]*h;return{imagePrimary:c,imageSecondary:n,top:T,bottom:T+c.displaySize[1],left:v,right:v+c.displaySize[0]}}function ZM(c,n,s,u,g,h){const v=c.imagePrimary;let T;if(v.content){const j=v.content,K=v.pixelRatio||1;T=[j[0]/K,j[1]/K,v.displaySize[0]-j[2]/K,v.displaySize[1]-j[3]/K]}const P=n.left*h,L=n.right*h;let w,M,D,I;s==="width"||s==="both"?(I=g[0]+P-u[3],M=g[0]+L+u[1]):(I=g[0]+(P+L-v.displaySize[0])/2,M=I+v.displaySize[0]);const R=n.top*h,B=n.bottom*h;return s==="height"||s==="both"?(w=g[1]+R-u[0],D=g[1]+B+u[2]):(w=g[1]+(R+B-v.displaySize[1])/2,D=w+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:w,right:M,bottom:D,left:I,collisionPadding:T}}class bc extends et{constructor(n,s,u,g,h){super(n,s),this.angle=g,this.z=u,h!==void 0&&(this.segment=h)}clone(){return new bc(this.x,this.y,this.z,this.angle,this.segment)}}function YM(c,n,s,u,g){if(n.segment===void 0)return!0;let h=n,v=n.segment+1,T=0;for(;T>-s/2;){if(v--,v<0)return!1;T-=c[v].dist(h),h=c[v]}T+=c[v].dist(c[v+1]),v++;const P=[];let L=0;for(;T<s/2;){const w=c[v],M=c[v+1];if(!M)return!1;let D=c[v-1].angleTo(w)-w.angleTo(M);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:T,angleDelta:D}),L+=D;T-P[0].distance>u;)L-=P.shift().angleDelta;if(L>g)return!1;v++,T+=w.dist(M)}return!0}function XM(c){let n=0;for(let s=0;s<c.length-1;s++)n+=c[s].dist(c[s+1]);return n}function JM(c,n,s){return c?.6*n*s:0}function QM(c,n){return Math.max(c?c.right-c.left:0,n?n.right-n.left:0)}function YF(c,n,s,u,g,h){const v=JM(s,g,h),T=QM(s,u)*h;let P=0;const L=XM(c)/2;for(let w=0;w<c.length-1;w++){const M=c[w],D=c[w+1],I=M.dist(D);if(P+I>L){const R=(L-P)/I,B=pr(M.x,D.x,R),j=pr(M.y,D.y,R),K=new bc(B,j,0,D.angleTo(M),w);return!v||YM(c,K,T,v,n)?K:void 0}P+=I}}function XF(c,n,s,u,g,h,v,T,P){const L=JM(u,h,v),w=QM(u,g),M=w*v,D=c[0].x===0||c[0].x===P||c[0].y===0||c[0].y===P;return n-M<n/4&&(n=M+n/4),eI(c,D?n/2*T%n:(w/2+2*h)*v*T%n,n,L,s,M,D,!1,P)}function eI(c,n,s,u,g,h,v,T,P){const L=h/2,w=XM(c);let M=0,D=n-s,I=[];for(let R=0;R<c.length-1;R++){const B=c[R],j=c[R+1],K=B.dist(j),ne=j.angleTo(B);for(;D+s<M+K;){D+=s;const oe=(D-M)/K,Y=pr(B.x,j.x,oe),ae=pr(B.y,j.y,oe);if(Y>=0&&Y<P&&ae>=0&&ae<P&&D-L>=0&&D+L<=w){const me=new bc(Y,ae,0,ne,R);u&&!YM(c,me,h,u,g)||I.push(me)}}M+=K}return T||I.length||v||(I=eI(c,M/2,s,u,g,h,v,!0,P)),I}function tI(c,n,s,u,g){const h=[];for(let v=0;v<c.length;v++){const T=c[v];let P;for(let L=0;L<T.length-1;L++){let w=T[L],M=T[L+1];w.x<n&&M.x<n||(w.x<n?w=new et(n,w.y+(n-w.x)/(M.x-w.x)*(M.y-w.y))._round():M.x<n&&(M=new et(n,w.y+(n-w.x)/(M.x-w.x)*(M.y-w.y))._round()),w.y<s&&M.y<s||(w.y<s?w=new et(w.x+(s-w.y)/(M.y-w.y)*(M.x-w.x),s)._round():M.y<s&&(M=new et(w.x+(s-w.y)/(M.y-w.y)*(M.x-w.x),s)._round()),w.x>=u&&M.x>=u||(w.x>=u?w=new et(u,w.y+(u-w.x)/(M.x-w.x)*(M.y-w.y))._round():M.x>=u&&(M=new et(u,w.y+(u-w.x)/(M.x-w.x)*(M.y-w.y))._round()),w.y>=g&&M.y>=g||(w.y>=g?w=new et(w.x+(g-w.y)/(M.y-w.y)*(M.x-w.x),g)._round():M.y>=g&&(M=new et(w.x+(g-w.y)/(M.y-w.y)*(M.x-w.x),g)._round()),P&&w.equals(P[P.length-1])||(P=[w],h.push(P)),P.push(M)))))}}return h}function nI(c){let n=0,s=0;for(const v of c)n+=v.w*v.h,s=Math.max(s,v.w);c.sort((v,T)=>T.h-v.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let g=0,h=0;for(const v of c)for(let T=u.length-1;T>=0;T--){const P=u[T];if(!(v.w>P.w||v.h>P.h)){if(v.x=P.x,v.y=P.y,h=Math.max(h,v.y+v.h),g=Math.max(g,v.x+v.w),v.w===P.w&&v.h===P.h){const L=u.pop();T<u.length&&(u[T]=L)}else v.h===P.h?(P.x+=v.w,P.w-=v.w):v.w===P.w?(P.y+=v.h,P.h-=v.h):(u.push({x:P.x+v.w,y:P.y,w:P.w-v.w,h:v.h}),P.y+=v.h,P.h-=v.h);break}}return{w:g,h,fill:n/(g*h)||0}}Gn(bc,"Anchor");const Cg=1;class mx{constructor(n,{pixelRatio:s,version:u,stretchX:g,stretchY:h,content:v},T){this.paddedRect=n,this.pixelRatio=s,this.stretchX=g,this.stretchY=h,this.content=v,this.version=u,this.padding=T}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class rI{constructor(n,s,u){const g={},h={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,g,Cg,v),this.addImages(s,h,2,v);const{w:T,h:P}=nI(v),L=new es({width:T||1,height:P||1});for(const w in n){const M=n[w],D=g[w].paddedRect;es.copy(M.data,L,{x:0,y:0},{x:D.x+Cg,y:D.y+Cg},M.data,u,M.sdf)}for(const w in s){const M=s[w],D=h[w].paddedRect;let I=h[w].padding;const R=D.x+I,B=D.y+I,j=M.data.width,K=M.data.height;I=I>1?I-1:I,es.copy(M.data,L,{x:0,y:0},{x:R,y:B},M.data,u),es.copy(M.data,L,{x:0,y:K-I},{x:R,y:B-I},{width:j,height:I},u),es.copy(M.data,L,{x:0,y:0},{x:R,y:B+K},{width:j,height:I},u),es.copy(M.data,L,{x:j-I,y:0},{x:R-I,y:B},{width:I,height:K},u),es.copy(M.data,L,{x:0,y:0},{x:R+j,y:B},{width:I,height:K},u),es.copy(M.data,L,{x:j-I,y:K-I},{x:R-I,y:B-I},{width:I,height:I},u),es.copy(M.data,L,{x:0,y:K-I},{x:R+j,y:B-I},{width:I,height:I},u),es.copy(M.data,L,{x:0,y:0},{x:R+j,y:B+K},{width:I,height:I},u),es.copy(M.data,L,{x:j-I,y:0},{x:R-I,y:B+K},{width:I,height:I},u)}this.image=L,this.iconPositions=g,this.patternPositions=h}addImages(n,s,u,g){for(const h in n){const v=n[h],T={x:0,y:0,w:v.data.width+2*u,h:v.data.height+2*u};g.push(T),s[h]=new mx(T,v,u),v.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(n,s,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(g=>n.hasImage(g,u)),n.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const g in n.getUpdatedImages(u))this.patchUpdatedImage(this.iconPositions[g],n.getImage(g,u),s),this.patchUpdatedImage(this.patternPositions[g],n.getImage(g,u),s)}patchUpdatedImage(n,s,u){if(!n||!s||n.version===s.version)return;n.version=s.version;const[g,h]=n.tl;u.update(s.data,{position:{x:g,y:h}})}}Gn(mx,"ImagePosition"),Gn(rI,"ImageAtlas");const Eg=1e20;function oI(c,n,s,u,g,h,v,T,P){for(let L=n;L<n+u;L++)iI(c,s*h+L,h,g,v,T,P);for(let L=s;L<s+g;L++)iI(c,L*h+n,1,u,v,T,P)}function iI(c,n,s,u,g,h,v){h[0]=0,v[0]=-Eg,v[1]=Eg,g[0]=c[n];for(let T=1,P=0,L=0;T<u;T++){g[T]=c[n+T*s];const w=T*T;do{const M=h[P];L=(g[T]-g[M]+w-M*M)/(T-M)/2}while(L<=v[P]&&--P>-1);P++,h[P]=T,v[P]=L,v[P+1]=Eg}for(let T=0,P=0;T<u;T++){for(;v[P+1]<T;)P++;const L=h[P],w=T-L;c[n+T*s]=g[L]+w*w}}const tl=2,gx={none:0,ideographs:1,all:2};class Hf{constructor(n,s,u){this.requestManager=n,this.localGlyphMode=s,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n,s){this.urls[s]=n}getGlyphs(n,s,u){const g=[],h=this.urls[s]||lt.GLYPHS_URL;for(const v in n)for(const T of n[v])g.push({stack:v,id:T});ur(g,({stack:v,id:T},P)=>{let L=this.entries[v];L||(L=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=L.glyphs[T];if(w!==void 0)return void P(null,{stack:v,id:T,glyph:w});if(w=this._tinySDF(L,v,T),w)return L.glyphs[T]=w,void P(null,{stack:v,id:T,glyph:w});const M=Math.floor(T/256);if(256*M>65535)return void P(new Error("glyphs > 65535 not supported"));if(L.ranges[M])return void P(null,{stack:v,id:T,glyph:w});let D=L.requests[M];D||(D=L.requests[M]=[],Hf.loadGlyphRange(v,M,h,this.requestManager,(I,R)=>{if(R){L.ascender=R.ascender,L.descender=R.descender;for(const B in R.glyphs)this._doesCharSupportLocalGlyph(+B)||(L.glyphs[+B]=R.glyphs[+B]);L.ranges[M]=!0}for(const B of D)B(I,R);delete L.requests[M]})),D.push((I,R)=>{I?P(I):R&&P(null,{stack:v,id:T,glyph:R.glyphs[T]||null})})},(v,T)=>{if(v)u(v);else if(T){const P={};for(const{stack:L,id:w,glyph:M}of T)P[L]===void 0&&(P[L]={}),P[L].glyphs===void 0&&(P[L].glyphs={}),P[L].glyphs[w]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},P[L].ascender=this.entries[L].ascender,P[L].descender=this.entries[L].descender;u(null,P)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==gx.none&&(this.localGlyphMode===gx.all?!!this.localFontFamily:!!this.localFontFamily&&(Xn["CJK Unified Ideographs"](n)||Xn["Hangul Syllables"](n)||Xn.Hiragana(n)||Xn.Katakana(n)||Xn["CJK Symbols and Punctuation"](n)||Xn["CJK Unified Ideographs Extension A"](n)||Xn["CJK Unified Ideographs Extension B"](n)))}_tinySDF(n,s,u){const g=this.localFontFamily;if(!g||!this._doesCharSupportLocalGlyph(u))return;let h=n.tinySDF;if(!h){let B="400";/bold/i.test(s)?B="900":/medium/i.test(s)?B="500":/light/i.test(s)&&(B="200"),h=n.tinySDF=new Hf.TinySDF({fontFamily:g,fontWeight:B,fontSize:24*tl,buffer:3*tl,radius:8*tl}),h.fontWeight=B}if(this.localGlyphs[h.fontWeight][u])return this.localGlyphs[h.fontWeight][u];const v=String.fromCodePoint(u),{data:T,width:P,height:L,glyphWidth:w,glyphHeight:M,glyphLeft:D,glyphTop:I,glyphAdvance:R}=h.draw(v);return this.localGlyphs[h.fontWeight][u]={id:u,bitmap:new Tu({width:P,height:L},T),metrics:{width:w/tl,height:M/tl,left:D/tl,top:I/tl-27,advance:R/tl,localGlyph:!0}}}}Hf.loadGlyphRange=function(c,n,s,u,g){const h=256*n,v=h+255,T=u.transformRequest(u.normalizeGlyphsURL(s).replace("{fontstack}",c).replace("{range}",`${h}-${v}`),$c.Glyphs);Vc(T,(P,L)=>{if(P)g(P);else if(L){const w={},M=function(D){return new ky(D).readFields(HF,{})}(L);for(const D of M.glyphs)w[D.id]=D;g(null,{glyphs:w,ascender:M.ascender,descender:M.descender})}})},Hf.TinySDF=class{constructor({fontSize:c=24,buffer:n=3,radius:s=8,cutoff:u=.25,fontFamily:g="sans-serif",fontWeight:h="normal",fontStyle:v="normal"}={}){this.buffer=n,this.cutoff=u,this.radius=s;const T=this.size=c+4*n,P=this._createCanvas(T),L=this.ctx=P.getContext("2d",{willReadFrequently:!0});L.font=`${v} ${h} ${c}px ${g}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(c){const n=document.createElement("canvas");return n.width=n.height=c,n}draw(c){const{width:n,actualBoundingBoxAscent:s,actualBoundingBoxDescent:u,actualBoundingBoxLeft:g,actualBoundingBoxRight:h}=this.ctx.measureText(c),v=Math.ceil(s),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-g))),P=Math.min(this.size-this.buffer,v+Math.ceil(u)),L=T+2*this.buffer,w=P+2*this.buffer,M=Math.max(L*w,0),D=new Uint8ClampedArray(M),I={data:D,width:L,height:w,glyphWidth:T,glyphHeight:P,glyphTop:v,glyphLeft:0,glyphAdvance:n};if(T===0||P===0)return I;const{ctx:R,buffer:B,gridInner:j,gridOuter:K}=this;R.clearRect(B,B,T,P),R.fillText(c,B,B+v);const ne=R.getImageData(B,B,T,P);K.fill(Eg,0,M),j.fill(0,0,M);for(let oe=0;oe<P;oe++)for(let Y=0;Y<T;Y++){const ae=ne.data[4*(oe*T+Y)+3]/255;if(ae===0)continue;const me=(oe+B)*L+Y+B;if(ae===1)K[me]=0,j[me]=Eg;else{const Ee=.5-ae;K[me]=Ee>0?Ee*Ee:0,j[me]=Ee<0?Ee*Ee:0}}oI(K,0,0,L,w,L,this.f,this.v,this.z),oI(j,B,B,T,P,L,this.f,this.v,this.z);for(let oe=0;oe<M;oe++){const Y=Math.sqrt(K[oe])-Math.sqrt(j[oe]);D[oe]=Math.round(255-255*(Y/this.radius+this.cutoff))}return I}};const Eu=Cg;function sI(c,n,s,u){const g=[],h=c.imagePrimary,v=h.pixelRatio,T=h.paddedRect.w-2*Eu,P=h.paddedRect.h-2*Eu,L=c.right-c.left,w=c.bottom-c.top,M=h.stretchX||[[0,T]],D=h.stretchY||[[0,P]],I=(Xe,$e)=>Xe+$e[1]-$e[0],R=M.reduce(I,0),B=D.reduce(I,0),j=T-R,K=P-B;let ne=0,oe=R,Y=0,ae=B,me=0,Ee=j,Oe=0,Be=K;if(h.content&&u){const Xe=h.content;ne=Py(M,0,Xe[0]),Y=Py(D,0,Xe[1]),oe=Py(M,Xe[0],Xe[2]),ae=Py(D,Xe[1],Xe[3]),me=Xe[0]-ne,Oe=Xe[1]-Y,Ee=Xe[2]-Xe[0]-oe,Be=Xe[3]-Xe[1]-ae}const De=(Xe,$e,tt,ft)=>{const vt=Ry(Xe.stretch-ne,oe,L,c.left),yt=Dy(Xe.fixed-me,Ee,Xe.stretch,R),wt=Ry($e.stretch-Y,ae,w,c.top),Bt=Dy($e.fixed-Oe,Be,$e.stretch,B),St=Ry(tt.stretch-ne,oe,L,c.left),Xt=Dy(tt.fixed-me,Ee,tt.stretch,R),un=Ry(ft.stretch-Y,ae,w,c.top),Gt=Dy(ft.fixed-Oe,Be,ft.stretch,B),On=new et(vt,wt),In=new et(St,wt),xn=new et(St,un),mn=new et(vt,un),nr=new et(yt/v,Bt/v),Ln=new et(Xt/v,Gt/v),Un=n*Math.PI/180;if(Un){const Vr=Math.sin(Un),Co=Math.cos(Un),ho=[Co,-Vr,Vr,Co];On._matMult(ho),In._matMult(ho),mn._matMult(ho),xn._matMult(ho)}const br=Xe.stretch+Xe.fixed,Or=tt.stretch+tt.fixed,Ar=$e.stretch+$e.fixed,Pr=ft.stretch+ft.fixed,Nr=c.imageSecondary;return{tl:On,tr:In,bl:mn,br:xn,texPrimary:{x:h.paddedRect.x+Eu+br,y:h.paddedRect.y+Eu+Ar,w:Or-br,h:Pr-Ar},texSecondary:Nr?{x:Nr.paddedRect.x+Eu+br,y:Nr.paddedRect.y+Eu+Ar,w:Or-br,h:Pr-Ar}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:nr,pixelOffsetBR:Ln,minFontScaleX:Ee/v/L,minFontScaleY:Be/v/w,isSDF:s}};if(u&&(h.stretchX||h.stretchY)){const Xe=aI(M,j,R),$e=aI(D,K,B);for(let tt=0;tt<Xe.length-1;tt++){const ft=Xe[tt],vt=Xe[tt+1];for(let yt=0;yt<$e.length-1;yt++)g.push(De(ft,$e[yt],vt,$e[yt+1]))}}else g.push(De({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:P+1}));return g}function Py(c,n,s){let u=0;for(const g of c)u+=Math.max(n,Math.min(s,g[1]))-Math.max(n,Math.min(s,g[0]));return u}function aI(c,n,s){const u=[{fixed:-Eu,stretch:0}];for(const[g,h]of c){const v=u[u.length-1];u.push({fixed:g-v.stretch,stretch:v.stretch}),u.push({fixed:g-v.stretch,stretch:v.stretch+(h-g)})}return u.push({fixed:n+Eu,stretch:s}),u}function Ry(c,n,s,u){return c/n*s+u}function Dy(c,n,s,u){return c-n*s/u}function JF(c,n,s,u){const g=n+c.positionedLines[u].lineOffset;return u===0?s+g/2:s+(g+(n+c.positionedLines[u-1].lineOffset))/2}function QF(c,n=1,s=!1){let u=1/0,g=1/0,h=-1/0,v=-1/0;const T=c[0];for(let I=0;I<T.length;I++){const R=T[I];(!I||R.x<u)&&(u=R.x),(!I||R.y<g)&&(g=R.y),(!I||R.x>h)&&(h=R.x),(!I||R.y>v)&&(v=R.y)}const P=Math.min(h-u,v-g);let L=P/2;const w=new vm([],eN);if(P===0)return new et(u,g);for(let I=u;I<h;I+=P)for(let R=g;R<v;R+=P)w.push(new Gf(I+L,R+L,L,c));let M=function(I){let R=0,B=0,j=0;const K=I[0];for(let ne=0,oe=K.length,Y=oe-1;ne<oe;Y=ne++){const ae=K[ne],me=K[Y],Ee=ae.x*me.y-me.x*ae.y;B+=(ae.x+me.x)*Ee,j+=(ae.y+me.y)*Ee,R+=3*Ee}return new Gf(B/R,j/R,0,I)}(c),D=w.length;for(;w.length;){const I=w.pop();(I.d>M.d||!M.d)&&(M=I,s&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,D)),I.max-M.d<=n||(L=I.h/2,w.push(new Gf(I.p.x-L,I.p.y-L,L,c)),w.push(new Gf(I.p.x+L,I.p.y-L,L,c)),w.push(new Gf(I.p.x-L,I.p.y+L,L,c)),w.push(new Gf(I.p.x+L,I.p.y+L,L,c)),D+=4)}return s&&(console.log(`num probes: ${D}`),console.log(`best distance: ${M.d}`)),M.p}function eN(c,n){return n.max-c.max}class Gf{constructor(n,s,u,g){this.p=new et(n,s),this.h=u,this.d=function(h,v){let T=!1,P=1/0;for(let L=0;L<v.length;L++){const w=v[L];for(let M=0,D=w.length,I=D-1;M<D;I=M++){const R=w[M],B=w[I];R.y>h.y!=B.y>h.y&&h.x<(B.x-R.x)*(h.y-R.y)/(B.y-R.y)+R.x&&(T=!T),P=Math.min(P,po(h,R,B))}}return(T?1:-1)*Math.sqrt(P)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}}const vx=Number.POSITIVE_INFINITY,tN=Math.sqrt(2);function lI(c,[n,s]){let u=0,g=0;if(s===vx){n<0&&(n=0);const h=n/tN;switch(c){case"top-right":case"top-left":g=h-7;break;case"bottom-right":case"bottom-left":g=7-h;break;case"bottom":g=7-n;break;case"top":g=n-7}switch(c){case"top-right":case"bottom-right":u=-h;break;case"top-left":case"bottom-left":u=h;break;case"left":u=n;break;case"right":u=-n}}else{switch(n=Math.abs(n),s=Math.abs(s),c){case"top-right":case"top-left":case"top":g=s-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-s}switch(c){case"top-right":case"bottom-right":case"right":u=-n;break;case"top-left":case"bottom-left":case"left":u=n}}return[u,g]}function _x(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function nN(c,n,s,u,g,h,v,T,P,L,w,M,D,I,R){let B=h.textMaxSize.evaluate(n,{},M);B===void 0&&(B=v);const j=c.layers[0].layout,K=j.get("icon-offset").evaluate(n,{},M),ne=uI(s.horizontal)||s.vertical,oe=D.name==="globe",Y=Ri,ae=v/Y,me=c.tilePixelRatio*B/Y,Ee=(vt=c.overscaling,c.zoom>18&&vt>2&&(vt>>=1),Math.max(An/(512*vt),1)*j.get("symbol-spacing")),Oe=j.get("text-padding")*c.tilePixelRatio,Be=j.get("icon-padding")*c.tilePixelRatio,De=Mt(j.get("text-max-angle")),Xe=j.get("text-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",$e=j.get("icon-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",tt=j.get("symbol-placement"),ft=Ee/2;var vt;const yt=j.get("icon-text-fit").evaluate(n,{},M),wt=j.get("icon-text-fit-padding").evaluate(n,{},M),Bt=yt!=="none";let St;c.hasAnyIconTextFit===!1&&Bt&&(c.hasAnyIconTextFit=!0),u&&Bt&&(c.allowVerticalPlacement&&s.vertical&&(St=ZM(u,s.vertical,yt,wt,K,ae)),ne&&(u=ZM(u,ne,yt,wt,K,ae)));const Xt=(un,Gt,On)=>{if(Gt.x<0||Gt.x>=An||Gt.y<0||Gt.y>=An)return;let In=null;if(oe){const{x:xn,y:mn,z:nr}=D.projectTilePoint(Gt.x,Gt.y,On);In={anchor:new bc(xn,mn,nr,0,void 0),up:D.upVector(On,Gt.x,Gt.y)}}(function(xn,mn,nr,Ln,Un,br,Or,Ar,Pr,Nr,Vr,Co,ho,Sr,so,lo,Oo,ei,di,ti,Wo,Si,pi,Di,Do,Is,il){const ka=xn.addToLineVertexArray(mn,Ln);let Aa,Xd,Pu,Jd,Hg,Pk,Rk,Dk=0,Lk=0,Ok=0,zk=0,qx=-1,Kx=-1;const Nl={};let Bk=ss("");const Qd=nr?nr.anchor:mn,Zx=Pr.layout.get("icon-text-fit").evaluate(Wo,{},Do)!=="none";let Yx=0,Xx=0;if(Pr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Yx,Xx]=Pr.layout.get("text-offset").evaluate(Wo,{},Do).map(Hs=>Hs*Ri):(Yx=Pr.layout.get("text-radial-offset").evaluate(Wo,{},Do)*Ri,Xx=vx),xn.allowVerticalPlacement&&Un.vertical){const Hs=Un.vertical;if(so)Pk=yx(Hs),Ar&&(Rk=yx(Ar));else{const Gs=Pr.layout.get("text-rotate").evaluate(Wo,{},Do)+90;Pu=Ly(Nr,Qd,mn,Vr,Co,ho,Hs,Sr,Gs,lo),Ar&&(Jd=Ly(Nr,Qd,mn,Vr,Co,ho,Ar,ei,Gs))}}if(br){const Hs=Pr.layout.get("icon-rotate").evaluate(Wo,{},Do),Gs=sI(br,Hs,pi,Zx),Qf=Ar?sI(Ar,Hs,pi,Zx):void 0;Xd=Ly(Nr,Qd,mn,Vr,Co,ho,br,ei,Hs),Dk=4*Gs.length;const Fk=xn.iconSizeData;let eh=null;Fk.kind==="source"?(eh=[el*Pr.layout.get("icon-size").evaluate(Wo,{},Do)],eh[0]>Mu&&Hn(`${xn.layerIds[0]}: Value for "icon-size" is >= ${Mg}. Reduce your "icon-size".`)):Fk.kind==="composite"&&(eh=[el*Si.compositeIconSizes[0].evaluate(Wo,{},Do),el*Si.compositeIconSizes[1].evaluate(Wo,{},Do)],(eh[0]>Mu||eh[1]>Mu)&&Hn(`${xn.layerIds[0]}: Value for "icon-size" is >= ${Mg}. Reduce your "icon-size".`)),xn.addSymbols(xn.icon,Gs,eh,ti,di,Wo,!1,nr,mn,ka.lineStartIndex,ka.lineLength,-1,Di,Do,Is,il),qx=xn.icon.placedSymbolArray.length-1,Qf&&(Lk=4*Qf.length,xn.addSymbols(xn.icon,Qf,eh,ti,di,Wo,la.vertical,nr,mn,ka.lineStartIndex,ka.lineLength,-1,Di,Do,Is,il),Kx=xn.icon.placedSymbolArray.length-1)}for(const Hs in Un.horizontal){const Gs=Un.horizontal[Hs];Aa||(Bk=ss(Gs.text),so?Hg=yx(Gs):Aa=Ly(Nr,Qd,mn,Vr,Co,ho,Gs,Sr,Pr.layout.get("text-rotate").evaluate(Wo,{},Do),lo));const Qf=Gs.positionedLines.length===1;if(Ok+=cI(xn,nr,mn,Gs,Or,Pr,so,Wo,lo,ka,Un.vertical?la.horizontal:la.horizontalOnly,Qf?Object.keys(Un.horizontal):[Hs],Nl,qx,Si,Di,Do,Is),Qf)break}Un.vertical&&(zk+=cI(xn,nr,mn,Un.vertical,Or,Pr,so,Wo,lo,ka,la.vertical,["vertical"],Nl,Kx,Si,Di,Do,Is));let Ru=-1;const Jx=(Hs,Gs)=>Hs?Math.max(Hs,Gs):Gs;Ru=Jx(Hg,Ru),Ru=Jx(Pk,Ru),Ru=Jx(Rk,Ru);const v6=Ru>-1?1:0;xn.glyphOffsetArray.length>=65535&&Hn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Wo.sortKey!==void 0&&xn.addToSortKeyRanges(xn.symbolInstances.length,Wo.sortKey),xn.symbolInstances.emplaceBack(mn.x,mn.y,Qd.x,Qd.y,Qd.z,Nl.right>=0?Nl.right:-1,Nl.center>=0?Nl.center:-1,Nl.left>=0?Nl.left:-1,Nl.vertical>=0?Nl.vertical:-1,qx,Kx,Bk,Aa!==void 0?Aa:xn.collisionBoxArray.length,Aa!==void 0?Aa+1:xn.collisionBoxArray.length,Pu!==void 0?Pu:xn.collisionBoxArray.length,Pu!==void 0?Pu+1:xn.collisionBoxArray.length,Xd!==void 0?Xd:xn.collisionBoxArray.length,Xd!==void 0?Xd+1:xn.collisionBoxArray.length,Jd||xn.collisionBoxArray.length,Jd?Jd+1:xn.collisionBoxArray.length,Vr,Ok,zk,Dk,Lk,v6,0,Yx,Xx,Ru,0,Zx?1:0)})(c,Gt,In,un,s,u,g,St,c.layers[0],c.collisionBoxArray,n.index,n.sourceLayerIndex,c.index,Oe,Xe,P,0,Be,$e,K,n,h,L,w,M,I,R)};if(tt==="line")for(const un of tI(n.geometry,0,0,An,An)){const Gt=XF(un,Ee,De,s.vertical||ne,u,Y,me,c.overscaling,An);for(const On of Gt)ne&&rN(c,ne.text,ft,On)||Xt(un,On,M)}else if(tt==="line-center"){for(const un of n.geometry)if(un.length>1){const Gt=YF(un,De,s.vertical||ne,u,Y,me);Gt&&Xt(un,Gt,M)}}else if(n.type==="Polygon")for(const un of xy(n.geometry,0)){const Gt=QF(un,16);Xt(un[0],new bc(Gt.x,Gt.y,0,0,void 0),M)}else if(n.type==="LineString")for(const un of n.geometry)Xt(un,new bc(un[0].x,un[0].y,0,0,void 0),M);else if(n.type==="Point")for(const un of n.geometry)for(const Gt of un)Xt([Gt],new bc(Gt.x,Gt.y,0,0,void 0),M)}const Mg=255,Mu=Mg*el;function cI(c,n,s,u,g,h,v,T,P,L,w,M,D,I,R,B,j,K){const ne=function(ae,me,Ee,Oe,Be,De,Xe,$e){const tt=[];if(me.positionedLines.length===0)return tt;const ft=Oe.layout.get("text-rotate").evaluate(De,{})*Math.PI/180,vt=function(Xt){const un=Xt[0],Gt=Xt[1],On=un*Gt;return On>0?[un,-Gt]:On<0?[-un,Gt]:un===0?[Gt,un]:[Gt,-un]}(Ee);let yt=Math.abs(me.top-me.bottom);for(const Xt of me.positionedLines)yt-=Xt.lineOffset;const wt=me.positionedLines.length,Bt=yt/wt;let St=me.top-Ee[1];for(let Xt=0;Xt<wt;++Xt){const un=me.positionedLines[Xt];St=JF(me,Bt,St,Xt);for(const Gt of un.positionedGlyphs){if(!Gt.rect)continue;const On=Gt.rect||{};let In=jM+1,xn=!0,mn=1,nr=0;if(Gt.imageName){const ti=Xe[Gt.imageName];if(!ti)continue;if(ti.sdf){Hn("SDF images are not supported in formatted text and will be ignored.");continue}xn=!1,mn=ti.pixelRatio,In=Cg/mn}const Ln=(Be||$e)&&Gt.vertical,Un=Gt.metrics.advance*Gt.scale/2,br=Gt.metrics,Or=Gt.rect;if(Or===null)continue;$e&&me.verticalizable&&(nr=Gt.imageName?Un-Gt.metrics.width*Gt.scale/2:0);const Ar=Be?[Gt.x+Un,Gt.y]:[0,0];let Pr=[0,0],Nr=[0,0],Vr=!1;Be||(Ln?(Nr=[Gt.x+Un+vt[0],Gt.y+vt[1]-nr],Vr=!0):Pr=[Gt.x+Un+Ee[0],Gt.y+Ee[1]-nr]);const Co=Or.w*Gt.scale/(mn*(Gt.localGlyph?tl:1)),ho=Or.h*Gt.scale/(mn*(Gt.localGlyph?tl:1));let Sr,so,lo,Oo;if(Ln){const ti=Gt.y-St,Wo=new et(-Un,Un-ti),Si=-Math.PI/2,pi=new et(...Nr);Sr=new et(-Un+Pr[0],Pr[1]),Sr._rotateAround(Si,Wo)._add(pi),Sr.x+=-ti+Un,Sr.y-=(br.left-In)*Gt.scale;const Di=Gt.imageName?br.advance*Gt.scale:Ri*Gt.scale,Do=String.fromCodePoint(Gt.glyph);VF(Do)?Sr.x+=(1-In)*Gt.scale:UF(Do)?Sr.x+=Di-br.height*Gt.scale+(-In-1)*Gt.scale:Sr.x+=Gt.imageName||br.width+2*In===Or.w&&br.height+2*In===Or.h?(Di-ho)/2:(Di-(br.height+2*In)*Gt.scale)/2,so=new et(Sr.x,Sr.y-Co),lo=new et(Sr.x+ho,Sr.y),Oo=new et(Sr.x+ho,Sr.y-Co)}else{const ti=(br.left-In)*Gt.scale-Un+Pr[0],Wo=(-br.top-In)*Gt.scale+Pr[1],Si=ti+Co,pi=Wo+ho;Sr=new et(ti,Wo),so=new et(Si,Wo),lo=new et(ti,pi),Oo=new et(Si,pi)}if(ft){let ti;ti=Be?new et(0,0):Vr?new et(vt[0],vt[1]):new et(Ee[0],Ee[1]),Sr._rotateAround(ft,ti),so._rotateAround(ft,ti),lo._rotateAround(ft,ti),Oo._rotateAround(ft,ti)}const ei=new et(0,0),di=new et(0,0);tt.push({tl:Sr,tr:so,bl:lo,br:Oo,texPrimary:On,texSecondary:void 0,writingMode:me.writingMode,glyphOffset:Ar,sectionIndex:Gt.sectionIndex,isSDF:xn,pixelOffsetTL:ei,pixelOffsetBR:di,minFontScaleX:0,minFontScaleY:0})}}return tt}(0,u,P,h,v,T,g,c.allowVerticalPlacement),oe=c.textSizeData;let Y=null;oe.kind==="source"?(Y=[el*h.layout.get("text-size").evaluate(T,{},j)],Y[0]>Mu&&Hn(`${c.layerIds[0]}: Value for "text-size" is >= ${Mg}. Reduce your "text-size".`)):oe.kind==="composite"&&(Y=[el*R.compositeTextSizes[0].evaluate(T,{},j),el*R.compositeTextSizes[1].evaluate(T,{},j)],(Y[0]>Mu||Y[1]>Mu)&&Hn(`${c.layerIds[0]}: Value for "text-size" is >= ${Mg}. Reduce your "text-size".`)),c.addSymbols(c.text,ne,Y,P,v,T,w,n,s,L.lineStartIndex,L.lineLength,I,B,j,K,!1);for(const ae of M)D[ae]=c.text.placedSymbolArray.length-1;return 4*ne.length}function uI(c){for(const n in c)return c[n];return null}function Ly(c,n,s,u,g,h,v,T,P,L){let w=v.top,M=v.bottom,D=v.left,I=v.right;const R=v.collisionPadding;if(R&&(D-=R[0],w-=R[1],I+=R[2],M+=R[3]),P){const B=new et(D,w),j=new et(I,w),K=new et(D,M),ne=new et(I,M),oe=Mt(P);let Y=new et(0,0);L&&(Y=new et(L[0],L[1])),B._rotateAround(oe,Y),j._rotateAround(oe,Y),K._rotateAround(oe,Y),ne._rotateAround(oe,Y),D=Math.min(B.x,j.x,K.x,ne.x),I=Math.max(B.x,j.x,K.x,ne.x),w=Math.min(B.y,j.y,K.y,ne.y),M=Math.max(B.y,j.y,K.y,ne.y)}return c.emplaceBack(n.x,n.y,n.z,s.x,s.y,D,w,I,M,T,u,g,h),c.length-1}function yx(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const n=c.bottom-c.top;return n>0?Math.max(10,n):null}function rN(c,n,s,u){const g=c.compareText;if(n in g){const h=g[n];for(let v=h.length-1;v>=0;v--)if(u.dist(h[v])<s)return!0}else g[n]=[];return g[n].push(u),!1}function dI(c,n){const s=c.fovAboveCenter,u=c.elevation?c.elevation.getMinElevationBelowMSL()*n:0,g=(c._camera.position[2]*c.worldSize-u)/Math.cos(c._pitch),h=Math.sin(s)*g/Math.sin(Math.max(Math.PI/2-c._pitch-s,.01));let v=Math.sin(c._pitch)*h+g;const T=g*(1/c._horizonShift);return c.elevation&&c.elevation.exaggeration()!==0||(v*=1+Math.max(c.zoom-17,0)),Math.min(1.01*v,T)}function Ig(c,n){if(!n.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:n};const s=Math.pow(2,-c.z),u=c.x*s,g=(c.x+1)*s,h=c.y*s,v=(c.y+1)*s,T=je(u),P=je(g),L=Ue(h),w=Ue(v),M=n.project(T,L),D=n.project(P,L),I=n.project(P,w),R=n.project(T,w);let B=Math.min(M.x,D.x,I.x,R.x),j=Math.min(M.y,D.y,I.y,R.y),K=Math.max(M.x,D.x,I.x,R.x),ne=Math.max(M.y,D.y,I.y,R.y);const oe=s/16;function Y(me,Ee,Oe,Be,De,Xe){const $e=(Oe+De)/2,tt=(Be+Xe)/2,ft=n.project(je($e),Ue(tt)),vt=Math.max(0,B-ft.x,j-ft.y,ft.x-K,ft.y-ne);B=Math.min(B,ft.x),K=Math.max(K,ft.x),j=Math.min(j,ft.y),ne=Math.max(ne,ft.y),vt>oe&&(Y(me,ft,Oe,Be,$e,tt),Y(ft,Ee,$e,tt,De,Xe))}Y(M,D,u,h,g,h),Y(D,I,g,h,g,v),Y(I,R,g,v,u,v),Y(R,M,u,v,u,h),B-=oe,j-=oe,K+=oe,ne+=oe;const ae=1/Math.max(K-B,ne-j);return{scale:ae,x:B*ae,y:j*ae,x2:K*ae,y2:ne*ae,projection:n}}function hI(c,{x:n,y:s},u=0){return new et(((n-u)*c.scale-c.x)*An,(s*c.scale-c.y)*An)}const oN=Pe.mat4.identity(new Float32Array(16));class Iu{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,s){return{x:0,y:0,z:0}}unproject(n,s){return new re(0,0)}projectTilePoint(n,s,u){return{x:n,y:s,z:0}}locationPoint(n,s,u=!0){return n._coordinatePoint(n.locationCoordinate(s),u)}pixelsPerMeter(n,s){return Le(1,n)*s}pixelSpaceConversion(n,s,u){return 1}farthestPixelDistance(n){return dI(n,n.pixelsPerMeter)}pointCoordinate(n,s,u,g){const h=n.horizonLineFromTop(!1),v=new et(s,Math.max(h,u));return n.rayIntersectionCoordinate(n.pointRayIntersection(v,g))}pointCoordinate3D(n,s,u){const g=new et(s,u);if(n.elevation)return n.elevation.pointCoordinate(g);{const h=this.pointCoordinate(n,g.x,g.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(n,s){if(n.elevation&&n.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(n,s.x,s.y);const u=n.horizonLineFromTop();return s.y<u}createInversionMatrix(n,s){return oN}createTileMatrix(n,s,u){let g,h,v;const T=u.canonical,P=Pe.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const L=Ig(T,this);g=1,h=L.x+u.wrap*L.scale,v=L.y,Pe.mat4.scale(P,P,[g/L.scale,g/L.scale,n.pixelsPerMeter/s])}else g=s/n.zoomScale(T.z),h=(T.x+Math.pow(2,T.z)*u.wrap)*g,v=T.y*g;return Pe.mat4.translate(P,P,[h,v,0]),Pe.mat4.scale(P,P,[g/An,g/An,1]),P}upVector(n,s,u){return[0,0,1]}upVectorScale(n,s,u){return{metersToTile:1}}}class iN extends Iu{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[s,u]=this.parallels=n.parallels||[29.5,45.5],g=Math.sin(Mt(s));this.n=(g+Math.sin(Mt(u)))/2,this.c=1+g*(2*this.n-g),this.r0=Math.sqrt(this.c)/this.n}project(n,s){const{n:u,c:g,r0:h}=this,v=Mt(n-this.center[0]),T=Mt(s),P=Math.sqrt(g-2*u*Math.sin(T))/u;return{x:P*Math.sin(v*u),y:P*Math.cos(v*u)-h,z:0}}unproject(n,s){const{n:u,c:g,r0:h}=this,v=h+s;let T=Math.atan2(n,Math.abs(v))*Math.sign(v);v*u<0&&(T-=Math.PI*Math.sign(n)*Math.sign(v));const P=Mt(this.center[0])*u;T=ir(T,-Math.PI-P,Math.PI-P);const L=Zt(en(T/u)+this.center[0],-180,180),w=Math.asin(Zt((g-(n*n+v*v)*u*u)/(2*u),-1,1)),M=Zt(en(w),-Qe,Qe);return new re(L,M)}}const kg=1.340264,Ag=-.081106,Pg=893e-6,Rg=.003796,Oy=Math.sqrt(3)/2;class sN extends Iu{project(n,s){s=s/180*Math.PI,n=n/180*Math.PI;const u=Math.asin(Oy*Math.sin(s)),g=u*u,h=g*g*g;return{x:.5*(n*Math.cos(u)/(Oy*(kg+3*Ag*g+h*(7*Pg+9*Rg*g)))/Math.PI+.5),y:1-.5*(u*(kg+Ag*g+h*(Pg+Rg*g))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,g=u*u,h=g*g*g;for(let w,M,D,I=0;I<12&&(M=u*(kg+Ag*g+h*(Pg+Rg*g))-s,D=kg+3*Ag*g+h*(7*Pg+9*Rg*g),w=M/D,u=Zt(u-w,-Math.PI/3,Math.PI/3),g=u*u,h=g*g*g,!(Math.abs(w)<1e-12));++I);const v=Oy*n*(kg+3*Ag*g+h*(7*Pg+9*Rg*g))/Math.cos(u),T=Math.asin(Math.sin(u)/Oy),P=Zt(180*v/Math.PI,-180,180),L=Zt(180*T/Math.PI,-Qe,Qe);return new re(P,L)}}class aN extends Iu{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){return{x:.5+n/360,y:.5-s/360,z:0}}unproject(n,s){const u=360*(n-.5),g=Zt(360*(.5-s),-Qe,Qe);return new re(u,g)}}const Wf=Math.PI/2;function zy(c){return Math.tan((Wf+c)/2)}class lN extends Iu{constructor(n){super(n),this.center=n.center||[0,30];const[s,u]=this.parallels=n.parallels||[30,30];let g=Mt(s),h=Mt(u);this.southernCenter=g+h<0,this.southernCenter&&(g=-g,h=-h);const v=Math.cos(g),T=zy(g);this.n=g===h?Math.sin(g):Math.log(v/Math.cos(h))/Math.log(zy(h)/T),this.f=v*Math.pow(zy(g),this.n)/this.n}project(n,s){s=Mt(s),this.southernCenter&&(s=-s),n=Mt(n-this.center[0]);const u=1e-6,{n:g,f:h}=this;h>0?s<-Wf+u&&(s=-Wf+u):s>Wf-u&&(s=Wf-u);const v=h/Math.pow(zy(s),g);let T=v*Math.sin(g*n),P=h-v*Math.cos(g*n);return T=.5*(T/Math.PI+.5),P=.5*(P/Math.PI+.5),{x:T,y:this.southernCenter?P:1-P,z:0}}unproject(n,s){n=(2*n-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:u,f:g}=this,h=g-s,v=Math.sign(h),T=Math.sign(u)*Math.sqrt(n*n+h*h);let P=Math.atan2(n,Math.abs(h))*v;h*u<0&&(P-=Math.PI*Math.sign(n)*v);const L=Zt(en(P/u)+this.center[0],-180,180),w=Zt(en(2*Math.atan(Math.pow(g/T,1/u))-Wf),-Qe,Qe);return new re(L,this.southernCenter?-w:w)}}class fI extends Iu{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,s){return{x:ze(n),y:Ne(s),z:0}}unproject(n,s){const u=je(n),g=Ue(s);return new re(u,g)}}const pI=Mt(Qe);class cN extends Iu{project(n,s){const u=(s=Mt(s))*s,g=u*u;return{x:.5*((n=Mt(n))*(.8707-.131979*u+g*(g*(.003971*u-.001529*g)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+u*(.015085+g*(.028874*u-.044475-.005916*g)))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,g=25,h=0,v=u*u;do{v=u*u;const L=v*v;h=(u*(1.007226+v*(.015085+L*(.028874*v-.044475-.005916*L)))-s)/(1.007226+v*(.045255+L*(.259866*v-.311325-.005916*11*L))),u=Zt(u-h,-pI,pI)}while(Math.abs(h)>1e-6&&--g>0);v=u*u;const T=Zt(en(n/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),P=en(u);return new re(T,P)}}const mI=Mt(Qe);class uN extends Iu{project(n,s){s=Mt(s),n=Mt(n);const u=Math.cos(s),g=2/Math.PI,h=Math.acos(u*Math.cos(n/2)),v=Math.sin(h)/h,T=.5*(n*g+2*u*Math.sin(n/2)/v)||0,P=.5*(s+Math.sin(s)/v)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(P/Math.PI+1),z:0}}unproject(n,s){let u=n=(2*n-.5)*Math.PI,g=s=(2*(1-s)-1)*Math.PI,h=25;const v=1e-6;let T=0,P=0;do{const L=Math.cos(g),w=Math.sin(g),M=2*w*L,D=w*w,I=L*L,R=Math.cos(u/2),B=Math.sin(u/2),j=2*R*B,K=B*B,ne=1-I*R*R,oe=ne?1/ne:0,Y=ne?Math.acos(L*R)*Math.sqrt(1/ne):0,ae=.5*(2*Y*L*B+2*u/Math.PI)-n,me=.5*(Y*w+g)-s,Ee=.5*oe*(I*K+Y*L*R*D)+1/Math.PI,Oe=oe*(j*M/4-Y*w*B),Be=.125*oe*(M*B-Y*w*I*j),De=.5*oe*(D*R+Y*K*L)+.5,Xe=Oe*Be-De*Ee;T=(me*Oe-ae*De)/Xe,P=(ae*Be-me*Ee)/Xe,u=Zt(u-T,-Math.PI,Math.PI),g=Zt(g-P,-mI,mI)}while((Math.abs(T)>v||Math.abs(P)>v)&&--h>0);return new re(en(u),en(g))}}class gI extends Iu{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Mt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){const{scale:u,cosPhi:g}=this;return{x:Mt(n)*g*u+.5,y:-Math.sin(Mt(s))/g*u+.5,z:0}}unproject(n,s){const{scale:u,cosPhi:g}=this,h=-(s-.5)/u,v=Zt(en((n-.5)/u)/g,-180,180),T=Math.asin(Zt(h*g,-1,1)),P=Zt(en(T),-Qe,Qe);return new re(v,P)}}class dN extends fI{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,s,u){const g=hg(n,s,u),h=vy(Bl(u));return Pe.vec3.transformMat4(g,g,h),{x:g[0],y:g[1],z:g[2]}}locationPoint(n,s){const u=W(s.lat,s.lng),g=Pe.vec3.normalize([],u),h=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(s),n._centerAltitude):n._centerAltitude,v=Le(1,0)*An*h;Pe.vec3.scaleAndAdd(u,u,g,v);const T=Pe.mat4.identity(new Float64Array(16));return Pe.mat4.multiply(T,n.pixelMatrix,n.globeMatrix),Pe.vec3.transformMat4(u,u,T),new et(u[0],u[1])}pixelsPerMeter(n,s){return Le(1,0)*s}pixelSpaceConversion(n,s,u){const g=Le(1,n)*s,h=pr(Le(1,45)*s,g,u);return this.pixelsPerMeter(n,s)/h}createTileMatrix(n,s,u){const g=j1(Bl(u.canonical));return Pe.mat4.multiply(new Float64Array(16),n.globeMatrix,g)}createInversionMatrix(n,s){const{center:u}=n,g=vy(Bl(s));return Pe.mat4.rotateY(g,g,Mt(u.lng)),Pe.mat4.rotateX(g,g,Mt(u.lat)),Pe.mat4.scale(g,g,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(g)}pointCoordinate(n,s,u,g){return py(n,s,u,!0)||new Ct(0,0)}pointCoordinate3D(n,s,u){const g=this.pointCoordinate(n,s,u,0);return[g.x,g.y,g.z]}isPointAboveHorizon(n,s){return!py(n,s.x,s.y,!1)}farthestPixelDistance(n){const s=function(g,h){const v=g.cameraToCenterDistance,T=g._centerAltitude*h,P=g._camera,L=g._camera.forward(),w=Pe.vec3.add([],Pe.vec3.scale([],L,-v),[0,0,T]),M=g.worldSize/(2*Math.PI),D=[0,0,-M],I=g.width/g.height,R=Math.tan(g.fovAboveCenter),B=Pe.vec3.scale([],P.up(),R),j=Pe.vec3.scale([],P.right(),R*I),K=Pe.vec3.normalize([],Pe.vec3.add([],Pe.vec3.add([],L,B),j)),ne=[];let oe;if(new Qa(w,K).closestPointOnSphere(D,M,ne)){const Y=Pe.vec3.add([],ne,D),ae=Pe.vec3.sub([],Y,w);oe=Math.cos(g.fovAboveCenter)*Pe.vec3.length(ae)}else{const Y=Pe.vec3.sub([],w,D),ae=Pe.vec3.sub([],D,w);Pe.vec3.normalize(ae,ae);const me=Pe.vec3.length(Y)-M;oe=Math.sqrt(me*(me+2*M));const Ee=Math.acos(oe/(M+me))-Math.acos(Pe.vec3.dot(L,ae));oe*=Math.cos(Ee)}return 1.01*oe}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),u=Su(n.zoom);if(u>0){const g=dI(n,Le(1,n.center.lat)*n.worldSize),h=n.worldSize/(2*Math.PI),v=Math.max(n.width,n.height)/n.worldSize*Math.PI;return pr(s,g+h*(1-Math.cos(v)),Math.pow(u,10))}return s}upVector(n,s,u){return hg(s,u,n,1)}upVectorScale(n){return{metersToTile:_c(gy(Bl(n)))}}}function vI(c){const n=c.parallels,s=!!n&&Math.abs(n[0]+n[1])<.01;switch(c.name){case"mercator":return new fI(c);case"equirectangular":return new aN(c);case"naturalEarth":return new cN(c);case"equalEarth":return new sN(c);case"winkelTripel":return new uN(c);case"albers":return s?new gI(c):new iN(c);case"lambertConformalConic":return s?new gI(c):new lN(c);case"globe":return new dN(c)}throw new Error(`Invalid projection name: ${c.name}`)}const hN=Vf.VectorTileFeature.types,fN=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function By(c,n,s,u,g,h,v,T,P,L,w,M,D){const I=T?Math.min(Mu,Math.round(T[0])):0,R=T?Math.min(Mu,Math.round(T[1])):0;c.emplaceBack(n,s,Math.round(32*u),Math.round(32*g),h,v,(I<<1)+(P?1:0),R,16*L,16*w,256*M,256*D)}function Fy(c,n,s){c.emplaceBack(n,s)}function Ny(c,n,s,u,g,h,v){c.emplaceBack(n,s,u,g,h,v)}function $y(c,n,s,u,g){c.emplaceBack(n,s,u,g),c.emplaceBack(n,s,u,g),c.emplaceBack(n,s,u,g),c.emplaceBack(n,s,u,g)}function pN(c){for(const n of c.sections)if(C1(n.text))return!0;return!1}class bx{constructor(n){this.layoutVertexArray=new Jm,this.indexArray=new Ii,this.programConfigurations=n,this.segments=new Zo,this.dynamicLayoutVertexArray=new Za,this.opacityVertexArray=new eg,this.placedSymbolArray=new ig,this.iconTransitioningVertexArray=new Ll,this.globeExtVertexArray=new Qm,this.zOffsetVertexArray=new vu}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(n,s,u,g,h){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,PF.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,DF.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,fN,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=n.createVertexBuffer(this.iconTransitioningVertexArray,OF.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,RF.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,LF.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||g)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Gn(bx,"SymbolBuffers");class xx{constructor(n,s,u){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new u,this.segments=new Zo,this.collisionVertexArray=new gu,this.collisionVertexArrayExt=new Za}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,zF.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,BF.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Gn(xx,"CollisionBuffers");class Vy{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.lut=n.lut,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Pe.mat4.identity([]),this.placementViewportMatrix=Pe.mat4.identity([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=cx(this.zoom,s["text-size"]),this.iconSizeData=cx(this.zoom,s["icon-size"]);const u=this.layers[0].layout,g=u.get("symbol-sort-key"),h=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&g.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(v=>la[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=n.sourceID,this.projection=n.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=u.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new bx(new Ol(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("text")||n.startsWith("symbol"))),this.icon=new bx(new Ol(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("icon")||n.startsWith("symbol"))),this.glyphOffsetArray=new iy,this.lineVertexArray=new zf,this.symbolInstances=new sg}calculateGlyphDependencies(n,s,u,g,h){for(let v=0;v<n.length;v++){const T=n.codePointAt(v);if(T===void 0)break;if(s[T]=!0,g&&h&&T<=65535){const P=Sg[n.charAt(v)];P&&(s[P.charCodeAt(0)]=!0)}}}updateFootprints(n,s){}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const u=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);return!rx(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(n,s,u,g){const h=this.layers[0],v=h.layout,T=this.projection.name==="globe",P=v.get("text-font"),L=v.get("text-field"),w=v.get("icon-image"),M=(L.value.kind!=="constant"||L.value.value instanceof Vi&&!L.value.value.isEmpty()||L.value.value.toString().length>0)&&(P.value.kind!=="constant"||P.value.value.length>0),D=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,I=v.get("symbol-sort-key");if(this.features=[],!M&&!D)return;const R=s.iconDependencies,B=s.glyphDependencies,j=s.availableImages,K=new Ko(this.zoom);for(const{feature:ne,id:oe,index:Y,sourceLayerIndex:ae}of n){const me=h._featureFilter.needGeometry,Ee=wn(ne,me);if(!h._featureFilter.filter(K,Ee,u))continue;if(me||(Ee.geometry=bn(ne,u,g)),T&&ne.type!==1&&u.z<=5){const Xe=Ee.geometry,$e=.98078528056,tt=(ft,vt)=>{const yt=hg(ft.x,ft.y,u,1),wt=hg(vt.x,vt.y,u,1);return Pe.vec3.dot(yt,wt)<$e};for(let ft=0;ft<Xe.length;ft++)Xe[ft]=yn(Xe[ft],tt)}let Oe,Be;if(M){const Xe=h.getValueAndResolveTokens("text-field",Ee,u,j),$e=Vi.factory(Xe);pN($e)&&(this.hasRTLText=!0),(!this.hasRTLText||Wm()==="unavailable"||this.hasRTLText&&us.isParsed())&&(Oe=$F($e,h,Ee))}if(D){const Xe=h.getValueAndResolveTokens("icon-image",Ee,u,j);Be=Xe instanceof Zi?Xe:Zi.fromString(Xe)}if(!Oe&&!Be)continue;const De=this.sortFeaturesByKey?I.evaluate(Ee,{},u):void 0;if(this.features.push({id:oe,text:Oe,icon:Be,index:Y,sourceLayerIndex:ae,geometry:Ee.geometry,properties:ne.properties,type:hN[ne.type],sortKey:De}),Be&&(R[Be.namePrimary]=!0,Be.nameSecondary&&(R[Be.nameSecondary]=!0)),Oe){const Xe=P.evaluate(Ee,{},u).join(","),$e=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(la.vertical)>=0;for(const tt of Oe.sections)if(tt.image)R[tt.image.namePrimary]=!0;else{const ft=bf(Oe.toString()),vt=tt.fontStack||Xe,yt=B[vt]=B[vt]||{};this.calculateGlyphDependencies(tt.text,yt,$e,this.allowVerticalPlacement,ft)}}}v.get("symbol-placement")==="line"&&(this.features=function(ne){const oe={},Y={},ae=[];let me=0;function Ee(Xe){ae.push(ne[Xe]),me++}function Oe(Xe,$e,tt){const ft=Y[Xe];return delete Y[Xe],Y[$e]=ft,ae[ft].geometry[0].pop(),ae[ft].geometry[0]=ae[ft].geometry[0].concat(tt[0]),ft}function Be(Xe,$e,tt){const ft=oe[$e];return delete oe[$e],oe[Xe]=ft,ae[ft].geometry[0].shift(),ae[ft].geometry[0]=tt[0].concat(ae[ft].geometry[0]),ft}function De(Xe,$e,tt){const ft=tt?$e[0][$e[0].length-1]:$e[0][0];return`${Xe}:${ft.x}:${ft.y}`}for(let Xe=0;Xe<ne.length;Xe++){const $e=ne[Xe],tt=$e.geometry,ft=$e.text?$e.text.toString():null;if(!ft){Ee(Xe);continue}const vt=De(ft,tt),yt=De(ft,tt,!0);if(vt in Y&&yt in oe&&Y[vt]!==oe[yt]){const wt=Be(vt,yt,tt),Bt=Oe(vt,yt,ae[wt].geometry);delete oe[vt],delete Y[yt],Y[De(ft,ae[Bt].geometry,!0)]=Bt,ae[wt].geometry=null}else vt in Y?Oe(vt,yt,tt):yt in oe?Be(vt,yt,tt):(Ee(Xe),oe[vt]=me-1,Y[yt]=me-1)}return ae.filter(Xe=>Xe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ne,oe)=>ne.sortKey-oe.sortKey)}update(n,s,u,g,h){const v=Object.keys(n).length!==0;if(v&&!this.stateDependentLayers.length)return;const T=v?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(n,s,T,u,g,h),this.icon.programConfigurations.updatePaintArrays(n,s,T,u,g,h)}updateZOffset(){const n=(h,v,T)=>{u+=v,u>h.length&&h.resize(u);for(let P=-v;P<0;P++)h.emplace(P+u,T)},s=(h,v,T)=>{g+=v,g>h.length&&h.resize(g);for(let P=-v;P<0;P++)h.emplace(P+g,T)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,g=0;for(let h=0;h<this.symbolInstances.length;h++){const v=this.symbolInstances.get(h),{numHorizontalGlyphVertices:T,numVerticalGlyphVertices:P,numIconVertices:L}=v,w=v.zOffset,M=L>0;if((T>0||P>0)&&(n(this.text.zOffsetVertexArray,T,w),n(this.text.zOffsetVertexArray,P,w)),M){const{placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:I}=v;D>=0&&s(this.icon.zOffsetVertexArray,L,w),I>=0&&s(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,w)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=vI(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const u=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:g,y:h}of s)this.lineVertexArray.emplaceBack(g,h);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,s,u,g,h,v,T,P,L,w,M,D,I,R,B,j){const K=n.indexArray,ne=n.layoutVertexArray,oe=n.globeExtVertexArray,Y=n.segments.prepareSegment(4*s.length,ne,K,this.canOverlap?v.sortKey:void 0),ae=this.glyphOffsetArray.length,me=Y.vertexLength,Ee=this.allowVerticalPlacement&&T===la.vertical?Math.PI/2:0,Oe=v.text&&v.text.sections;for(let De=0;De<s.length;De++){const{tl:Xe,tr:$e,bl:tt,br:ft,texPrimary:vt,texSecondary:yt,pixelOffsetTL:wt,pixelOffsetBR:Bt,minFontScaleX:St,minFontScaleY:Xt,glyphOffset:un,isSDF:Gt,sectionIndex:On}=s[De],In=Y.vertexLength,xn=un[1];if(By(ne,L.x,L.y,Xe.x,xn+Xe.y,vt.x,vt.y,u,Gt,wt.x,wt.y,St,Xt),By(ne,L.x,L.y,$e.x,xn+$e.y,vt.x+vt.w,vt.y,u,Gt,Bt.x,wt.y,St,Xt),By(ne,L.x,L.y,tt.x,xn+tt.y,vt.x,vt.y+vt.h,u,Gt,wt.x,Bt.y,St,Xt),By(ne,L.x,L.y,ft.x,xn+ft.y,vt.x+vt.w,vt.y+vt.h,u,Gt,Bt.x,Bt.y,St,Xt),P){const{x:mn,y:nr,z:Ln}=P.anchor,[Un,br,Or]=P.up;Ny(oe,mn,nr,Ln,Un,br,Or),Ny(oe,mn,nr,Ln,Un,br,Or),Ny(oe,mn,nr,Ln,Un,br,Or),Ny(oe,mn,nr,Ln,Un,br,Or),$y(n.dynamicLayoutVertexArray,mn,nr,Ln,Ee)}else $y(n.dynamicLayoutVertexArray,L.x,L.y,L.z,Ee);if(j){const mn=yt||vt;Fy(n.iconTransitioningVertexArray,mn.x,mn.y),Fy(n.iconTransitioningVertexArray,mn.x+mn.w,mn.y),Fy(n.iconTransitioningVertexArray,mn.x,mn.y+mn.h),Fy(n.iconTransitioningVertexArray,mn.x+mn.w,mn.y+mn.h)}K.emplaceBack(In,In+1,In+2),K.emplaceBack(In+1,In+2,In+3),Y.vertexLength+=4,Y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(un[0]),De!==s.length-1&&On===s[De+1].sectionIndex||n.programConfigurations.populatePaintArrays(ne.length,v,v.index,{},I,R,B,Oe&&Oe[On])}const Be=P?P.anchor:L;n.placedSymbolArray.emplaceBack(Be.x,Be.y,Be.z,L.x,L.y,ae,this.glyphOffsetArray.length-ae,me,w,M,L.segment,u?u[0]:0,u?u[1]:0,g[0],g[1],T,0,!1,0,D,0)}_commitLayoutVertex(n,s,u,g,h,v,T){n.emplaceBack(s,u,g,h,v,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(n,s,u,g,h,v,T){const P=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),L=P.vertexLength,w=T.tileAnchorX,M=T.tileAnchorY;for(let I=0;I<4;I++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,s,n.padding,T.zOffset),this._commitLayoutVertex(u.layoutVertexArray,g,h,v,w,M,new et(n.x1,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,g,h,v,w,M,new et(n.x2,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,g,h,v,w,M,new et(n.x2,n.y2)),this._commitLayoutVertex(u.layoutVertexArray,g,h,v,w,M,new et(n.x1,n.y2)),P.vertexLength+=4;const D=u.indexArray;D.emplaceBack(L,L+1),D.emplaceBack(L+1,L+2),D.emplaceBack(L+2,L+3),D.emplaceBack(L+3,L),P.primitiveLength+=4}_addTextDebugCollisionBoxes(n,s,u,g,h,v){for(let T=g;T<h;T++){const P=u.get(T),L=this.getSymbolInstanceTextSize(n,v,s,T);this._addCollisionDebugVertices(P,L,this.textCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(n,s,u,g,h,v){for(let T=g;T<h;T++){const P=u.get(T),L=this.getSymbolInstanceIconSize(n,s,v.placedIconSymbolIndex);this._addCollisionDebugVertices(P,L,this.iconCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,v)}}generateCollisionDebugBuffers(n,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new xx(mc,NM.members,Ll),this.iconCollisionBox=new xx(mc,NM.members,Ll);const u=Uf(this.iconSizeData,n),g=Uf(this.textSizeData,n);for(let h=0;h<this.symbolInstances.length;h++){const v=this.symbolInstances.get(h);this._addTextDebugCollisionBoxes(g,n,s,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(g,n,s,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(u,n,s,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(u,n,s,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(n,s,u,g){const h=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:g),v=Iy(this.textSizeData,n,h)/Ri;return this.tilePixelRatio*v}getSymbolInstanceIconSize(n,s,u){const g=this.icon.placedSymbolArray.get(u),h=Iy(this.iconSizeData,n,g);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(n,s,u,g){n.emplaceBack(s,-u,-u,g),n.emplaceBack(s,u,-u,g),n.emplaceBack(s,u,u,g),n.emplaceBack(s,-u,u,g)}_updateTextDebugCollisionBoxes(n,s,u,g,h,v){for(let T=g;T<h;T++){const P=u.get(T),L=this.getSymbolInstanceTextSize(n,v,s,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,L,P.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(n,s,u,g,h,v){for(let T=g;T<h;T++){const P=u.get(T),L=this.getSymbolInstanceIconSize(n,s,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,L,P.padding,v.zOffset)}}updateCollisionDebugBuffers(n,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const u=Uf(this.iconSizeData,n),g=Uf(this.textSizeData,n);for(let h=0;h<this.symbolInstances.length;h++){const v=this.symbolInstances.get(h);this._updateTextDebugCollisionBoxes(g,n,s,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(g,n,s,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(u,n,s,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._updateIconDebugCollisionBoxes(u,n,s,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,s,u,g,h,v,T,P,L){const w={};if(s<u){const{x1:M,y1:D,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:oe,tileAnchorY:Y,featureIndex:ae}=n.get(s);w.textBox={x1:M,y1:D,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:oe,tileAnchorY:Y},w.textFeatureIndex=ae}if(g<h){const{x1:M,y1:D,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:oe,tileAnchorY:Y,featureIndex:ae}=n.get(g);w.verticalTextBox={x1:M,y1:D,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:oe,tileAnchorY:Y},w.verticalTextFeatureIndex=ae}if(v<T){const{x1:M,y1:D,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:oe,tileAnchorY:Y,featureIndex:ae}=n.get(v);w.iconBox={x1:M,y1:D,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:oe,tileAnchorY:Y},w.iconFeatureIndex=ae}if(P<L){const{x1:M,y1:D,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:oe,tileAnchorY:Y,featureIndex:ae}=n.get(P);w.verticalIconBox={x1:M,y1:D,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:oe,tileAnchorY:Y},w.verticalIconFeatureIndex=ae}return w}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(n,s){const u=n.placedSymbolArray.get(s),g=u.vertexStartIndex+4*u.numGlyphs;for(let h=u.vertexStartIndex;h<g;h+=4)n.indexArray.emplaceBack(h,h+1,h+2),n.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),u=Math.cos(n),g=[],h=[],v=[];for(let T=0;T<this.symbolInstances.length;++T){v.push(T);const P=this.symbolInstances.get(T);g.push(0|Math.round(s*P.tileAnchorX+u*P.tileAnchorY)),h.push(P.featureIndex)}return v.sort((T,P)=>g[T]-g[P]||h[P]-h[T]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let n=0;n<this.symbolInstances.length;++n)this.symbolInstanceIndexesSortedZOffset.push(n)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((n,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(n).zOffset)}addToSortKeyRanges(n,s){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===s?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const u=this.symbolInstances.get(s);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:P,verticalPlacedIconSymbolIndex:L}=u;g>=0&&this.addIndicesForPlacedSymbol(this.text,g),h>=0&&h!==g&&this.addIndicesForPlacedSymbol(this.text,h),v>=0&&v!==h&&v!==g&&this.addIndicesForPlacedSymbol(this.text,v),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P),L>=0&&this.addIndicesForPlacedSymbol(this.icon,L)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let _I,yI,wx;Gn(Vy,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Vy.addDynamicAttributes=$y;class bI{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:na,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Gn(bI,"FormatSectionOverride",{omit:["defaultValue"]});const Sx=()=>wx||(wx={layout:_I||(_I=new $o({"symbol-placement":new Sn(Dt.layout_symbol["symbol-placement"]),"symbol-spacing":new Sn(Dt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Sn(Dt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Qn(Dt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Sn(Dt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Sn(Dt.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Sn(Dt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Sn(Dt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Sn(Dt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Sn(Dt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Qn(Dt.layout_symbol["icon-size"]),"icon-text-fit":new Qn(Dt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Qn(Dt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Qn(Dt.layout_symbol["icon-image"]),"icon-rotate":new Qn(Dt.layout_symbol["icon-rotate"]),"icon-padding":new Sn(Dt.layout_symbol["icon-padding"]),"icon-keep-upright":new Sn(Dt.layout_symbol["icon-keep-upright"]),"icon-offset":new Qn(Dt.layout_symbol["icon-offset"]),"icon-anchor":new Qn(Dt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Sn(Dt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Sn(Dt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Sn(Dt.layout_symbol["text-rotation-alignment"]),"text-field":new Qn(Dt.layout_symbol["text-field"]),"text-font":new Qn(Dt.layout_symbol["text-font"]),"text-size":new Qn(Dt.layout_symbol["text-size"]),"text-max-width":new Qn(Dt.layout_symbol["text-max-width"]),"text-line-height":new Qn(Dt.layout_symbol["text-line-height"]),"text-letter-spacing":new Qn(Dt.layout_symbol["text-letter-spacing"]),"text-justify":new Qn(Dt.layout_symbol["text-justify"]),"text-radial-offset":new Qn(Dt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Sn(Dt.layout_symbol["text-variable-anchor"]),"text-anchor":new Qn(Dt.layout_symbol["text-anchor"]),"text-max-angle":new Sn(Dt.layout_symbol["text-max-angle"]),"text-writing-mode":new Sn(Dt.layout_symbol["text-writing-mode"]),"text-rotate":new Qn(Dt.layout_symbol["text-rotate"]),"text-padding":new Sn(Dt.layout_symbol["text-padding"]),"text-keep-upright":new Sn(Dt.layout_symbol["text-keep-upright"]),"text-transform":new Qn(Dt.layout_symbol["text-transform"]),"text-offset":new Qn(Dt.layout_symbol["text-offset"]),"text-allow-overlap":new Sn(Dt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Sn(Dt.layout_symbol["text-ignore-placement"]),"text-optional":new Sn(Dt.layout_symbol["text-optional"]),visibility:new Sn(Dt.layout_symbol.visibility)})),paint:yI||(yI=new $o({"icon-opacity":new Qn(Dt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Qn(Dt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Qn(Dt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Qn(Dt.paint_symbol["text-emissive-strength"]),"icon-color":new Qn(Dt.paint_symbol["icon-color"]),"icon-halo-color":new Qn(Dt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Qn(Dt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Qn(Dt.paint_symbol["icon-halo-blur"]),"icon-translate":new Sn(Dt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Sn(Dt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Qn(Dt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Qn(Dt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Qn(Dt.paint_symbol["text-occlusion-opacity"]),"text-color":new Qn(Dt.paint_symbol["text-color"],{runtimeType:as,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new Qn(Dt.paint_symbol["text-halo-color"]),"text-halo-width":new Qn(Dt.paint_symbol["text-halo-width"]),"text-halo-blur":new Qn(Dt.paint_symbol["text-halo-blur"]),"text-translate":new Sn(Dt.paint_symbol["text-translate"]),"text-translate-anchor":new Sn(Dt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Sn(Dt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Sn(Dt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Sn(Dt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Sn(Dt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Qn(Dt.paint_symbol["symbol-z-offset"]),"symbol-elevation-reference":new Sn(Dt.paint_symbol["symbol-elevation-reference"])}))},wx);class Uy extends Ui{constructor(n,s,u,g){super(n,Sx(),s,u,g),this._colorAdjustmentMatrix=Pe.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=n.paint!==void 0&&("icon-occlusion-opacity"in n.paint||"text-occlusion-opacity"in n.paint)}recalculate(n,s){super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const g=[];for(const h of u)g.indexOf(h)<0&&g.push(h);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(n,s,u,g){return this._saturation===n&&this._contrast===s&&this._brightnessMin===u&&this._brightnessMax===g||(this._colorAdjustmentMatrix=function(h,v,T,P){h=Ke(h),v=ke(v);const L=Pe.mat4.create(),w=h/3,M=1-2*w,D=[M,w,w,0,w,M,w,0,w,w,M,0,0,0,0,1],I=.5-.5*v,R=P-T;return Pe.mat4.multiply(L,[R,0,0,0,0,R,0,0,0,0,R,0,T,T,T,1],[v,0,0,0,0,v,0,0,0,0,v,0,I,I,I,1]),Pe.mat4.multiply(L,L,D),L}(n,s,u,g),this._saturation=n,this._contrast=s,this._brightnessMin=u,this._brightnessMax=g),this._colorAdjustmentMatrix}getValueAndResolveTokens(n,s,u,g){const h=this.layout.get(n).evaluate(s,{},u,g),v=this._unevaluatedLayout._values[n];return v.isDataDriven()||gf(v.value)||!h?h:function(T,P){return P.replace(/{([^{}]+)}/g,(L,w)=>w in T?String(T[w]):"")}(s.properties,h)}createBucket(n){return new Vy(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of Sx().paint.overridableProperties){if(!Uy.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),u=new bI(s),g=new mf(u,s.property.specification,this.scope,this.options);let h=null;h=s.value.kind==="constant"||s.value.kind==="source"?new $m("source",g):new Sa("composite",g,s.value.zoomStops,s.value._interpolationType),this.paint._values[n]=new du(s.property,h,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven())&&Uy.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const u=n.get("text-field"),g=Sx().paint.properties[s];let h=!1;const v=T=>{for(const P of T)if(g.overrides&&g.overrides.hasOverride(P))return void(h=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Vi)v(u.value.value.sections);else if(u.value.kind==="source"){const T=L=>{h||(L instanceof ra&&ci(L.value)===Gc?v(L.value.sections):L instanceof Zc?v(L.sections):L.eachChild(T))},P=u.value;P._styleExpression&&T(P._styleExpression.expression)}return h}getProgramIds(){return["symbol"]}getDefaultProgramParams(n,s,u){return{config:new vc(this,{zoom:s,lut:u}),overrideFog:!1}}}let xI,wI,SI,TI;var Tx=oo([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function Cx(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function Ex(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class Mx{constructor(n,s,u,g){this.context=n,this.format=u,this.useMipmap=g&&g.useMipmap,this.texture=n.gl.createTexture(),this.update(s,{premultiply:g&&g.premultiply})}update(n,s){const u=n&&n instanceof HTMLVideoElement&&n.width===0?n.videoWidth:n.width,g=n&&n instanceof HTMLVideoElement&&n.height===0?n.videoHeight:n.height,{context:h}=this,{gl:v}=h,{x:T,y:P}=s&&s.position?s.position:{x:0,y:0},L=Math.max(T+u,this.size?this.size[0]:0),w=Math.max(P+g,this.size?this.size[1]:0);!this.size||this.size[0]===L&&this.size[1]===w||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!s||s.premultiply!==!1));const M=n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||ImageBitmap&&n instanceof ImageBitmap;if(!this.size&&L>0&&w>0){const D=this.useMipmap?Math.floor(Math.log2(Math.max(L,w)))+1:1;v.texStorage2D(v.TEXTURE_2D,D,this.format,L,w),this.size=[L,w]}if(this.size)if(M)v.texSubImage2D(v.TEXTURE_2D,0,T,P,Cx(this.format),Ex(this.format),n);else{const D=n.data;D&&v.texSubImage2D(v.TEXTURE_2D,0,T,P,u,g,Cx(this.format),Ex(this.format),D)}this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(n,s,u=!1){const{context:g}=this,{gl:h}=g;h.bindTexture(h.TEXTURE_2D,this.texture),n!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,n),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap&&!u?n===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),s!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,s),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(n,s,u,g){const{context:h}=this,{gl:v}=h;v.bindTexture(v.TEXTURE_2D,this.texture),s!==this.magFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,s),this.magFilter=s),n!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?n===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),u!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,u),this.wrapS=u),g!==this.wrapT&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,g),this.wrapT=g)}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class jy{constructor(n,s){this.context=n,this.texture=s}bind(n,s){const{context:u}=this,{gl:g}=u;g.bindTexture(g.TEXTURE_2D,this.texture),n!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,n),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,n),this.minFilter=n),s!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,s),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,s),this.wrapS=s)}}function Hy(c,n,s,u,g,h,v,T){const P=[c,n,1,s,u,1,g,h,1],L=[v,T,1],w=Pe.mat3.adjoint([],P),[M,D,I]=Pe.vec3.transformMat3(L,L,w);return Pe.mat3.multiply(P,P,[M,0,0,0,D,0,0,0,I])}function CI(c,n,s,u,g,h,v,T){const P=function(L,w,M,D,I,R,B,j){const K=Hy(0,0,1,0,1,1,0,1),ne=Hy(L,w,M,D,I,R,B,j),oe=Pe.mat3.adjoint([],K);return Pe.mat3.multiply(ne,ne,oe)}(c,n,s,u,g,h,v,T);return[P[2]/P[8]/An,P[5]/P[8]/An]}function Gy(c){return[c[0],Math.min(Math.max(c[1],-Qe),Qe)]}class EI extends jc{constructor(n,s,u,g){super(),this.id=n,this.dispatcher=u,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(g),this.options=s,this._dirty=!1}load(n,s){if(this._loaded=s||!1,this.fire(new Tl("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return n&&(this.coordinates=n),this._loaded=!0,void this._finishLoading();this._imageRequest=ya(this.map._requestManager.transformRequest(this.url,$c.Image),(u,g)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new gd(u)):g&&(this.image=g instanceof HTMLImageElement?Cn.getImageData(g):g,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}setTexture(n){if(!(n.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new jy(this.map.painter.context,n.handle),this.width=n.dimensions[0],this.height=n.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Tl("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(n){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof jy||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(n){if(this.coordinates=n,this._boundsArray=void 0,this._unsupportedCoords=!1,!n.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=n[0][1],u=n[0][1];for(const h of n)h[1]>u&&(u=h[1]),h[1]<s&&(s=h[1]);const g=(u+s)/2;if(g>Qe?this.onNorthPole=!0:g<-Qe&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const h=n.map(Ct.fromLngLat);this.tileID=function(v){let T=1/0,P=1/0,L=-1/0,w=-1/0;for(const B of v)T=Math.min(T,B.x),P=Math.min(P,B.y),L=Math.max(L,B.x),w=Math.max(w,B.y);const M=Math.max(L-T,w-P),D=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),I=Math.pow(2,D);let R=Math.floor((T+L)/2*I);return R>1&&(R-=1),new bi(D,R,Math.floor((P+w)/2*I))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Tl("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(n){for(const K in this.tiles){const ne=this.tiles[K];ne.state!=="loaded"&&(ne.state="loaded",ne.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const s=Ig(new bi(0,0,0),this.map.transform.projection),u=[s.projection.project(this.coordinates[0][0],this.coordinates[0][1]),s.projection.project(this.coordinates[1][0],this.coordinates[1][1]),s.projection.project(this.coordinates[2][0],this.coordinates[2][1]),s.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(K){const ne=K[1].x-K[0].x,oe=K[1].y-K[0].y,Y=K[2].x-K[1].x,ae=K[2].y-K[1].y,me=K[3].x-K[2].x,Ee=K[3].y-K[2].y,Oe=K[0].x-K[3].x,Be=K[0].y-K[3].y,De=ne*ae-Y*oe,Xe=Y*Ee-me*ae,$e=me*Be-Oe*Ee,tt=Oe*oe-ne*Be;return De>0&&Xe>0&&$e>0&&tt>0||De<0&&Xe<0&&$e<0&&tt<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const g=Ig(this.tileID,this.map.transform.projection),[h,v,T,P]=this.coordinates.map(K=>{const ne=g.projection.project(K[0],K[1]);return hI(g,ne)._round()});this.perspectiveTransform=CI(h.x,h.y,v.x,v.y,T.x,T.y,P.x,P.y);const L=this._boundsArray=new Rl;L.emplaceBack(h.x,h.y,0,0),L.emplaceBack(v.x,v.y,An,0),L.emplaceBack(P.x,P.y,0,An),L.emplaceBack(T.x,T.y,An,An),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=n.createVertexBuffer(L,Tx.members),this.boundsSegments=Zo.simpleSegment(0,0,4,2);const w=[],M=[Gy((D=this.coordinates)[0]),Gy(D[1]),Gy(D[2]),Gy(D[3])];var D;const[I,R,B,j]=function(K){let ne=K[0][0],oe=ne,Y=K[0][1],ae=Y;for(let me=1;me<K.length;me++)K[me][0]<ne?ne=K[me][0]:K[me][0]>oe&&(oe=K[me][0]),K[me][1]<Y?Y=K[me][1]:K[me][1]>ae&&(ae=K[me][1]);return[ne,Y,oe-ne,ae-Y]}(M);{const K=new Rl,[ne,oe,Y,ae]=function(wt){let Bt=wt[0].x,St=Bt,Xt=wt[0].y,un=Xt;for(let Gt=1;Gt<wt.length;Gt++)wt[Gt].x<Bt?Bt=wt[Gt].x:wt[Gt].x>St&&(St=wt[Gt].x),wt[Gt].y<Xt?Xt=wt[Gt].y:wt[Gt].y>un&&(un=wt[Gt].y);return[Bt,Xt,St-Bt,un-Xt]}(u),me=wt=>[(wt.x-ne)/Y,(wt.y-oe)/ae],[Ee,Oe,Be,De]=u.map(me),Xe=function(wt,Bt,St,Xt,un,Gt,On,In){const xn=Hy(0,0,1,0,1,1,0,1),mn=Hy(wt,Bt,St,Xt,un,Gt,On,In),nr=Pe.mat3.adjoint([],mn);return Pe.mat3.multiply(xn,xn,nr)}(Ee[0],Ee[1],Oe[0],Oe[1],Be[0],Be[1],De[0],De[1]);this.elevatedGlobePerspectiveTransform=CI(Ee[0],Ee[1],Oe[0],Oe[1],Be[0],Be[1],De[0],De[1]);const $e=(wt,Bt)=>{w.push(wt.lng);const St=Math.round((wt.lng-I)/B*An),Xt=Math.round((wt.lat-R)/j*An),un=me(Bt),Gt=Pe.vec3.transformMat3([],[un[0],un[1],1],Xe),On=Math.round(Gt[0]/Gt[2]*An),In=Math.round(Gt[1]/Gt[2]*An);K.emplaceBack(St,Xt,On,In)},tt=u[3].x-u[0].x,ft=u[3].y-u[0].y,vt=u[2].x-u[1].x,yt=u[2].y-u[1].y;for(let wt=0;wt<65;wt++){const Bt=wt/64,St=[u[0].x+Bt*tt,u[0].y+Bt*ft],Xt=[u[1].x+Bt*vt,u[1].y+Bt*yt],un=Xt[0]-St[0],Gt=Xt[1]-St[1];for(let On=0;On<65;On++){const In=On/64,xn={x:St[0]+un*In,y:St[1]+Gt*In,z:0};$e(s.projection.unproject(xn.x,xn.y),xn)}}this.elevatedGlobeVertexBuffer=n.createVertexBuffer(K,Tx.members)}{this.maxLongitudeTriangleSize=0;let K=[],ne=new Ii;const oe=(Y,ae,me)=>{ne.emplaceBack(Y,ae,me);const Ee=w[Y],Oe=w[ae],Be=w[me],De=Math.min(Math.min(Ee,Oe),Be),Xe=Math.max(Math.max(Ee,Oe),Be)-De;Xe>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Xe),K.push(De+Xe/2)};for(let Y=0;Y<64;Y++)for(let ae=0;ae<64;ae++){const me=65*Y+ae,Ee=me+1,Oe=me+65,Be=Oe+1;oe(me,Oe,Ee),oe(Ee,Oe,Be)}[K,ne]=function(Y,ae){const me=Array.from({length:Y.length},(Be,De)=>De);me.sort((Be,De)=>Y[Be]-Y[De]);const Ee=[],Oe=new Ii;for(let Be=0;Be<me.length;Be++){const De=me[Be];Ee.push(Y[De]);const Xe=3*De,$e=Xe+1;Oe.emplaceBack(ae.uint16[Xe],ae.uint16[$e],ae.uint16[$e+1])}return[Ee,Oe]}(K,ne),this.elevatedGlobeTrianglesCenterLongitudes=K,this.elevatedGlobeIndexBuffer=n.createIndexBuffer(ne)}this.elevatedGlobeSegments=Zo.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,B/An,0,j/An,0,0,R,I,0])}prepare(){const n=Object.keys(this.tiles).length!==0;if(this.tileID&&!n)return;const s=this.map.painter.context,u=s.gl;!this._dirty||this.texture instanceof jy||(this.texture?this.texture.update(this.image):(this.texture=new Mx(s,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),n&&this._prepareData(s)}loadTile(n,s){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},s(null)):(n.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(n){const s=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!s)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let g=(h=n+180)+360*Math.round((u[0]-h)/360);var h;const v=new Zo,T=(M,D)=>{v.segments.push({vertexOffset:0,primitiveOffset:M,vertexLength:s.segments[0].vertexLength,primitiveLength:D,sortKey:void 0,vaos:{}})},P=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-g)<=P){const M=Te(u,0,u.length,g+P);return M===u.length||T(M,Nt(u,M+1,u.length,g+360-P)-M),v}g<u[0]&&(g+=360);const L=Nt(u,0,u.length,g-P);if(L===u.length)return T(0,u.length),v;T(0,L-0);const w=Te(u,L+1,u.length,g+P);return w!==u.length&&T(w,u.length-w),v}}const mN=(Math.pow(256,2)-1)/16907520;class MI extends Ui{constructor(n,s,u,g){super(n,{layout:SI||(SI=new $o({visibility:new Sn(Dt.layout_raster.visibility)})),paint:TI||(TI=new $o({"raster-opacity":new Sn(Dt.paint_raster["raster-opacity"]),"raster-color":new ia(Dt.paint_raster["raster-color"]),"raster-color-mix":new Sn(Dt.paint_raster["raster-color-mix"]),"raster-color-range":new Sn(Dt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Sn(Dt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Sn(Dt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Sn(Dt.paint_raster["raster-brightness-max"]),"raster-saturation":new Sn(Dt.paint_raster["raster-saturation"]),"raster-contrast":new Sn(Dt.paint_raster["raster-contrast"]),"raster-resampling":new Sn(Dt.paint_raster["raster-resampling"]),"raster-fade-duration":new Sn(Dt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Sn(Dt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Sn(Dt.paint_raster["raster-array-band"]),"raster-elevation":new Sn(Dt.paint_raster["raster-elevation"])}))},s,u,g),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(n){return!(n&&n._source instanceof EI&&(n._source.onNorthPole||n._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(n){if(!this.hasColorMap()||!this._curRampRange)return;const s=this._transitionablePaint._values["raster-color"].value.expression,[u,g]=n||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(g)||u===this._curRampRange[0]&&g===this._curRampRange[1]||(this.colorRamp=fg({expression:s,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:g}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,g])}}let II,kI,AI,PI,RI;class DI extends Ui{constructor(n,s,u,g){super(n,{layout:II||(II=new $o({visibility:new Sn(Dt["layout_raster-particle"].visibility)})),paint:kI||(kI=new $o({"raster-particle-array-band":new Sn(Dt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Sn(Dt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new ia(Dt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Sn(Dt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Sn(Dt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Sn(Dt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Sn(Dt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Sn(Dt["paint_raster-particle"]["raster-particle-elevation"])}))},s,u,g),this._updateColorRamp(),this.lastInvalidatedAt=Cn.now()}onRemove(n){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(n){return!1}_handleSpecialPaintPropertyUpdate(n){n!=="raster-particle-color"&&n!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),n==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-particle-color"].value.expression,s=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=fg({expression:n,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:s}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Cn.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class gN extends Ui{constructor(n,s){super(n,{},s,null),this.implementation=n,n.slot&&(this.slot=n.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(n){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}function Ix(c,n,s){const u=[0,0,1],g=Pe.quat.identity([]);return Pe.quat.rotateY(g,g,s?-Mt(c)+Math.PI:Mt(c)),Pe.quat.rotateX(g,g,-Mt(n)),Pe.vec3.transformQuat(u,u,g),Pe.vec3.normalize(u,u)}function LI(c,n){const s=Wy(c.projection,c.zoom,c.width,c.height),u=function(h,v,T,P,L){const w=new re(T.lng-180*ku,T.lat),M=new re(T.lng+180*ku,T.lat),D=h.project(w.lng,w.lat),I=h.project(M.lng,M.lat),R=-Math.atan2(I.y-D.y,I.x-D.x),B=Ct.fromLngLat(T);B.y=Zt(B.y,-1+ku,1-ku);const j=B.toLngLat(),K=h.project(j.lng,j.lat),ne=Ct.fromLngLat(j);ne.x+=ku;const oe=ne.toLngLat(),Y=h.project(oe.lng,oe.lat),ae=zI(Y.x-K.x,Y.y-K.y,R),me=Ct.fromLngLat(j);me.y+=ku;const Ee=me.toLngLat(),Oe=h.project(Ee.lng,Ee.lat),Be=zI(Oe.x-K.x,Oe.y-K.y,R),De=Math.abs(ae.x)/Math.abs(Be.y),Xe=Pe.mat4.identity([]);Pe.mat4.rotateZ(Xe,Xe,-R*(1-(L?0:P)));const $e=Pe.mat4.identity([]);return Pe.mat4.scale($e,$e,[1,1-(1-De)*P,1]),$e[4]=-Be.x/Be.y*P,Pe.mat4.rotateZ($e,$e,R),Pe.mat4.multiply($e,Xe,$e),$e}(c.projection,0,c.center,s,n),g=OI(c);return Pe.mat4.scale(u,u,[g,g,1]),u}function OI(c){const n=c.projection,s=Wy(c.projection,c.zoom,c.width,c.height),u=kx(n,c.center),g=kx(n,re.convert(n.center));return Math.pow(2,u*s+(1-s)*g)}function Wy(c,n,s,u,g=1/0){const h=c.range;if(!h)return 0;const v=Math.min(g,Math.max(s,u)),T=Math.log(v/1024)/Math.LN2;return jn(h[0]+T,h[1]+T,n)}const ku=1/4e4;function kx(c,n){const s=Zt(n.lat,-Qe,Qe),u=new re(n.lng-180*ku,s),g=new re(n.lng+180*ku,s),h=c.project(u.lng,s),v=c.project(g.lng,s),T=Ct.fromLngLat(u),P=Ct.fromLngLat(g),L=v.x-h.x,w=v.y-h.y,M=P.x-T.x,D=P.y-T.y,I=Math.sqrt((M*M+D*D)/(L*L+w*w));return Math.log(I)/Math.LN2}function zI(c,n,s){const u=Math.cos(s),g=Math.sin(s);return{x:c*u-n*g,y:c*g+n*u}}function BI(c,n,s){Pe.mat4.identity(c),Pe.mat4.rotateZ(c,c,Mt(n[2])),Pe.mat4.rotateX(c,c,Mt(n[0])),Pe.mat4.rotateY(c,c,Mt(n[1])),Pe.mat4.scale(c,c,s),Pe.mat4.multiply(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function qy(c,n,s,u,g,h,v,T){const P=[s[0]-n[0],s[1]-n[1],0],L=[u[0]-n[0],u[1]-n[1],0];if(Pe.vec3.length(P)<1e-12||Pe.vec3.length(L)<1e-12)return Pe.quat.identity(c);const w=Pe.vec3.cross([],P,L);Pe.vec3.normalize(w,w),Pe.vec3.subtract(L,u,n),P[2]=(h-g)*T,L[2]=(v-g)*T;const M=P;return Pe.vec3.cross(M,P,L),Pe.vec3.normalize(M,M),Pe.quat.rotationTo(c,w,M)}function Ax(c,n,s=!1){const u=Su(n.zoom),g=function(h,v,T){const P=v.worldSize,L=[h[12],h[13],h[14]],w=Ue(L[1]/P),M=je(L[0]/P),D=Pe.mat4.identity([]),I=Le(1,w)*P,R=Le(1,0)*P*gt(w,v.zoom),B=1/H1(P);let j=R*B;if(T){const Y=Wy(v.projection,v.zoom,v.width,v.height,1024);j=B*v.projection.pixelSpaceConversion(v.center.lat,P,Y)}const K=W(w,M);Pe.vec3.add(K,K,Pe.vec3.scale([],Pe.vec3.normalize([],K),I*j*L[2]));const ne=function(Y){const ae=[Y[0],Y[1],Y[2]];let me=[0,1,0];const Ee=Pe.vec3.cross([],me,ae);return Pe.vec3.cross(me,ae,Ee),Pe.vec3.squaredLength(me)===0&&(me=[0,1,0],Pe.vec3.cross(Ee,ae,me)),Pe.vec3.normalize(Ee,Ee),Pe.vec3.normalize(me,me),Pe.vec3.normalize(ae,ae),[Ee[0],Ee[1],Ee[2],0,me[0],me[1],me[2],0,ae[0],ae[1],ae[2],0,Y[0],Y[1],Y[2],1]}(K);Pe.mat4.scale(D,D,[j,j,j*I]),Pe.mat4.translate(D,D,[-L[0],-L[1],-L[2]]);const oe=Pe.mat4.multiply([],v.globeMatrix,ne);return Pe.mat4.multiply(oe,oe,D),Pe.mat4.multiply(oe,oe,h),oe}(c,n,s);if(u>0){const h=function(v,T){const P=T.worldSize,L=Le(1,0)*P*gt(T.center.lat,T.zoom)/H1(P),w=Le(1,T.center.lat)*P,M=Pe.mat4.identity([]);return Pe.mat4.rotateY(M,M,Mt(T.center.lng)),Pe.mat4.rotateX(M,M,Mt(T.center.lat)),Pe.mat4.translate(M,M,[0,0,r]),Pe.mat4.scale(M,M,[L,L,L*w]),Pe.mat4.translate(M,M,[T.point.x-.5*P,T.point.y-.5*P,0]),Pe.mat4.multiply(M,M,v),Pe.mat4.multiply(M,T.globeMatrix,M)}(c,n);return function(v,T,P){const L=(R,B,j)=>{const K=Pe.vec3.length(R),ne=Pe.vec3.length(B),oe=yc(R,B,j);return Pe.vec3.scale(oe,oe,1/Pe.vec3.length(oe)*pr(K,ne,j))},w=L([v[0],v[1],v[2]],[T[0],T[1],T[2]],P),M=L([v[4],v[5],v[6]],[T[4],T[5],T[6]],P),D=L([v[8],v[9],v[10]],[T[8],T[9],T[10]],P),I=yc([v[12],v[13],v[14]],[T[12],T[13],T[14]],P);return[w[0],w[1],w[2],0,M[0],M[1],M[2],0,D[0],D[1],D[2],0,I[0],I[1],I[2],1]}(g,h,u)}return g}function FI(c,n,s,u){const g=Ro.projectAabbCorners(u,s);let h=Number.MAX_VALUE,v=-1;for(let L=0;L<g.length;++L){const w=g[L];w[0]=(.5*w[0]+.5)*n.width,w[1]=(.5-.5*w[1])*n.height,w[2]<h&&(v=L,h=w[2])}const T=L=>new et(g[L][0],g[L][1]);let P;switch(v){case 0:case 6:P=[T(1),T(5),T(4),T(7),T(3),T(2),T(1)];break;case 1:case 7:P=[T(0),T(4),T(5),T(6),T(2),T(3),T(0)];break;case 3:case 5:P=[T(1),T(0),T(4),T(7),T(6),T(2),T(1)];break;default:P=[T(1),T(5),T(6),T(7),T(3),T(0),T(1)]}if(Mn(c,P))return h}const vN=oo([{name:"a_pos_3f",components:3,type:"Float32"}]),_N=oo([{name:"a_color_3f",components:3,type:"Float32"}]),yN=oo([{name:"a_color_4f",components:4,type:"Float32"}]),bN=oo([{name:"a_uv_2f",components:2,type:"Float32"}]),xN=oo([{name:"a_normal_3f",components:3,type:"Float32"}]),wN=oo([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),SN=oo([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),NI={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class Ky{constructor(n,s,u,g){this.message=(n?`${n}: `:"")+u,g&&(this.identifier=g),s!=null&&s.__line__&&(this.line=s.__line__)}}function $I(c,n){const s=c.indexOf("://")===-1;try{return new URL(c,s&&n?"http://example.com":void 0),!0}catch{return!1}}class VI{constructor(n,s){this.feature=n,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class UI{constructor(){this.instancedDataArray=new Vd,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Px{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.projection=n.projection,this.index=n.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(n,s){}populate(n,s,u,g){this.tileToMeter=ct(u);const h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:T,index:P,sourceLayerIndex:L}of n){const w=T??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),M=wn(v,h);if(!this.layers[0]._featureFilter.filter(new Ko(this.zoom),M,u))continue;const D={id:w,sourceLayerIndex:L,index:P,geometry:h?M.geometry:bn(v,u,g),properties:v.properties,type:v.type,patterns:{}},I=this.addFeature(D,D.geometry,M);I&&s.featureIndex.insert(v,D.geometry,P,L,this.index,this.instancesPerModel[I].instancedDataArray.length,An/32)}this.lookup=null}update(n,s,u,g){for(const h in this.instancesPerModel){const v=this.instancesPerModel[h];for(const T in n)v.idToFeaturesIndex.hasOwnProperty(T)&&(this.evaluate(v.features[v.idToFeaturesIndex[T]],n[T],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let n=!1;for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];for(const g of u.features){const h=this.layers[0],v=g.feature,T=this.canonical,P=h.paint.get("model-rotation").evaluate(v,{},T),L=h.paint.get("model-scale").evaluate(v,{},T),w=h.paint.get("model-translation").evaluate(v,{},T);Pe.vec3.exactEquals(g.rotation,P)&&Pe.vec3.exactEquals(g.scale,L)&&Pe.vec3.exactEquals(g.translation,w)||(this.evaluate(g,g.featureStates,u,!0),n=!0)}}return n}updateReplacement(n,s,u,g){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const h=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);if(rx(this.activeReplacements,h))return!1;this.activeReplacements=h;let v=!1;for(const T in this.instancesPerModel){const P=this.instancesPerModel[T],L=P.instancedDataArray;for(const w of P.features){const M=w.instancedDataOffset,D=w.instancedDataCount;for(let I=0;I<D;I++){const R=16*(I+M);let B=L.float32[R+0];const j=B>An;B=j?B-An:B;const K=Math.floor(B),ne=L.float32[R+1];let oe=!1;for(const Y of this.activeReplacements)if(!rM(Y,u,NI.Model,g)&&!(Y.min.x>K||K>Y.max.x||Y.min.y>ne||ne>Y.max.y)&&(oe=cM(lM(K,ne,n.canonical,Y.footprintTileId.canonical),Y.footprint),oe))break;L.float32[R]=oe?B+An:B,v=v||oe!==j}}}return v}isEmpty(){for(const n in this.instancesPerModel)if(this.instancesPerModel[n].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(n){if(!this.uploaded)for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=n.createVertexBuffer(u.instancedDataArray,wN.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const n=this.layers[0].modelManager;if(n&&this.modelUris)for(const s of this.modelUris)n.removeModel(s,"")}addFeature(n,s,u){const g=this.layers[0],h=g.layout.get("model-id").evaluate(u,{},this.canonical);if(!h)return Hn(`modelId is not evaluated for layer ${g.id} and it is not going to get rendered.`),h;$I(h,!1)&&(this.modelUris.includes(h)||this.modelUris.push(h)),this.instancesPerModel[h]||(this.instancesPerModel[h]=new UI);const v=this.instancesPerModel[h],T=v.instancedDataArray,P=new VI(u,T.length);for(const L of s)for(const w of L){if(w.x<0||w.x>=An||w.y<0||w.y>=An)continue;const M=(this.lookupDim-1)/An,D=this.lookupDim*(w.y*M|0)+w.x*M|0;if(this.lookup){if(this.lookup[D]!==0)continue;this.lookup[D]=1}this.instanceCount++;const I=T.length;T.resize(I+1),v.instancesEvaluatedElevation.push(0),T.float32[16*I]=w.x,T.float32[16*I+1]=w.y}return P.instancedDataCount=v.instancedDataArray.length-P.instancedDataOffset,P.instancedDataCount>0&&(n.id&&(v.idToFeaturesIndex[n.id]=v.features.length),v.features.push(P),this.evaluate(P,{},v,!1)),h}getModelUris(){return this.modelUris}evaluate(n,s,u,g){const h=this.layers[0],v=n.feature,T=this.canonical,P=n.rotation=h.paint.get("model-rotation").evaluate(v,s,T),L=n.scale=h.paint.get("model-scale").evaluate(v,s,T),w=n.translation=h.paint.get("model-translation").evaluate(v,s,T),M=h.paint.get("model-color").evaluate(v,s,T);M.a=h.paint.get("model-color-mix-intensity").evaluate(v,s,T);const D=[];this.maxVerticalOffset<w[2]&&(this.maxVerticalOffset=w[2]),this.maxScale=Math.max(Math.max(this.maxScale,L[0]),Math.max(L[1],L[2])),BI(D,P,L);const I=Math.round(100*M.a)+M.b/1.05;for(let R=0;R<n.instancedDataCount;++R){const B=n.instancedDataOffset+R,j=16*B,K=u.instancedDataArray.float32;let ne=0;g&&(ne=K[j+6]-u.instancesEvaluatedElevation[B]);const oe=0|K[j+1];K[j]=(0|K[j])+M.r/1.05,K[j+1]=oe+M.g/1.05,K[j+2]=I,K[j+3]=1/(T.z>10?this.tileToMeter:ct(T,oe)),K[j+4]=w[0],K[j+5]=w[1],K[j+6]=w[2]+ne,K[j+7]=D[0],K[j+8]=D[1],K[j+9]=D[2],K[j+10]=D[4],K[j+11]=D[5],K[j+12]=D[6],K[j+13]=D[8],K[j+14]=D[9],K[j+15]=D[10],u.instancesEvaluatedElevation[B]=w[2]}}}let jI,HI;Gn(Px,"ModelBucket",{omit:["layers"]}),Gn(UI,"PerModelAttributes"),Gn(VI,"ModelFeature");const Kd=64,qf={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function GI(c,n,s,u,g,h,v,T,P,L=!1){const w=s.zoom,M=s.project(u),D=gt(u.lat,w),I=1/D;Pe.mat4.identity(c),Pe.mat4.translate(c,c,[M.x+v[0]*I,M.y+v[1]*I,v[2]]);let R=1,B=1;const j=s.worldSize;if(L){if(s.projection.name==="mercator"){let Y=0;s.elevation&&(Y=s.elevation.getAtPointOrZero(new Ct(M.x/j,M.y/j),0));const ae=Pe.vec4.transformMat4([],[M.x,M.y,Y,1],s.projMatrix)[3]/s.cameraToCenterDistance;R=ae,B=ae*gt(s.center.lat,w)}else if(s.projection.name==="globe"){const Y=Ax(c,s),ae=Pe.mat4.multiply([],s.projMatrix,Y),me=[0,0,0,1];Pe.vec4.transformMat4(me,me,ae);const Ee=me[3]/s.cameraToCenterDistance,Oe=Su(w),Be=s.projection.pixelsPerMeter(u.lat,j)*gt(u.lat,w),De=s.projection.pixelsPerMeter(s.center.lat,j)*gt(s.center.lat,w);R=Ee/pr(Be,ot(s.center.lat),Oe),B=Ee*D/Be,R*=De,B*=De}}else R=I;Pe.mat4.scale(c,c,[R,R,B]);const K=[...c],ne=n.orientation,oe=[];if(BI(oe,[ne[0]+g[0],ne[1]+g[1],ne[2]+g[2]],h),Pe.mat4.multiply(c,K,oe),T&&s.elevation){let Y=0;const ae=[];if(P&&s.elevation){Y=function(Oe,Be,De,Xe,$e){const tt=Be.elevation;if(!tt)return 0;const ft=Ro.projectAabbCorners(De,Xe),vt=Le(1,$e.lat)*Be.worldSize,yt=function(nr,Ln){const Un=[0,0,1],br=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Or of br){const Ar=nr[Or.corners[0]],Pr=nr[Or.corners[1]],Nr=nr[Or.corners[2]],Vr=[Pr[0]-Ar[0],Pr[1]-Ar[1],Ln*(Pr[2]-Ar[2])],Co=Pe.vec3.cross(Vr,Vr,[Nr[0]-Ar[0],Nr[1]-Ar[1],Ln*(Nr[2]-Ar[2])]);Pe.vec3.normalize(Co,Co),Or.dotProductWithUp=Pe.vec3.dot(Co,Un)}return br.sort((Or,Ar)=>Or.dotProductWithUp-Ar.dotProductWithUp),br[0].corners}(ft,vt),wt=ft[yt[0]],Bt=ft[yt[1]],St=ft[yt[2]],Xt=ft[yt[3]],un=tt.getAtPointOrZero(new Ct(wt[0]/Be.worldSize,wt[1]/Be.worldSize),0),Gt=tt.getAtPointOrZero(new Ct(Bt[0]/Be.worldSize,Bt[1]/Be.worldSize),0),On=tt.getAtPointOrZero(new Ct(St[0]/Be.worldSize,St[1]/Be.worldSize),0),In=tt.getAtPointOrZero(new Ct(Xt[0]/Be.worldSize,Xt[1]/Be.worldSize),0),xn=(un+In)/2,mn=(Gt+On)/2;return xn>mn?Gt<On?qy(Oe,Bt,Xt,wt,Gt,In,un,vt):qy(Oe,St,wt,Xt,On,un,In,vt):un<In?qy(Oe,wt,Bt,St,un,Gt,On,vt):qy(Oe,Xt,St,Bt,In,On,Gt,vt),Math.max(xn,mn)}(ae,s,n.aabb,c,u);const me=Pe.mat4.fromQuat([],ae),Ee=Pe.mat4.multiply([],me,oe);Pe.mat4.multiply(c,K,Ee)}else Y=s.elevation.getAtPointOrZero(new Ct(M.x/j,M.y/j),0);Y!==0&&(c[14]+=Y)}}function Dg(c,n,s=!1){c.uploaded||(c.gfxTexture=new Mx(n,c.image,s?n.gl.R8:n.gl.RGBA8,{useMipmap:c.sampler.minFilter>=n.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function TN(c,n,s){c.indexBuffer=n.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=n.createVertexBuffer(c.vertexArray,vN.members,!1,!0),c.normalArray&&(c.normalBuffer=n.createVertexBuffer(c.normalArray,xN.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=n.createVertexBuffer(c.texcoordArray,bN.members,!1,!0)),c.colorArray&&(c.colorBuffer=n.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?_N:yN).members,!1,!0)),c.featureArray&&(c.pbrBuffer=n.createVertexBuffer(c.featureArray,SN.members,!0)),c.segments=Zo.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const u=c.material;u.pbrMetallicRoughness.baseColorTexture&&Dg(u.pbrMetallicRoughness.baseColorTexture,n),u.pbrMetallicRoughness.metallicRoughnessTexture&&Dg(u.pbrMetallicRoughness.metallicRoughnessTexture,n),u.normalTexture&&Dg(u.normalTexture,n),u.occlusionTexture&&Dg(u.occlusionTexture,n,s),u.emissionTexture&&Dg(u.emissionTexture,n)}function Rx(c,n,s){if(c.meshes)for(const u of c.meshes)TN(u,n,s);if(c.children)for(const u of c.children)Rx(u,n,s)}function Zy(c){if(c.meshes)for(const n of c.meshes)n.indexArray.destroy(),n.vertexArray.destroy(),n.colorArray&&n.colorArray.destroy(),n.normalArray&&n.normalArray.destroy(),n.texcoordArray&&n.texcoordArray.destroy(),n.featureArray&&n.featureArray.destroy();if(c.children)for(const n of c.children)Zy(n)}function Dx(c){if(c.meshes)for(const s of c.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((n=s.material).pbrMetallicRoughness.baseColorTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),n.pbrMetallicRoughness.metallicRoughnessTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),n.normalTexture&&n.normalTexture.gfxTexture&&n.normalTexture.gfxTexture.destroy(),n.emissionTexture&&n.emissionTexture.gfxTexture&&n.emissionTexture.gfxTexture.destroy(),n.occlusionTexture&&n.occlusionTexture.gfxTexture&&n.occlusionTexture.gfxTexture.destroy()));var n;if(c.children)for(const s of c.children)Dx(s)}class Kf{constructor(n,s,u){this._demTile=n,this._dem=this._demTile.dem,this._scale=s,this._offset=u}static create(n,s,u){const g=u||n.findDEMTileFor(s);if(!g||!g.dem)return;const h=g.dem,v=g.tileID,T=1<<s.canonical.z-v.canonical.z;return new Kf(g,h.dim/An/T,[(s.canonical.x/T-v.canonical.x)*h.dim,(s.canonical.y/T-v.canonical.y)*h.dim])}tileCoordToPixel(n,s){const u=s*this._scale+this._offset[1],g=Math.floor(n*this._scale+this._offset[0]),h=Math.floor(u);return new et(g,h)}getElevationAt(n,s,u,g){const h=n*this._scale+this._offset[0],v=s*this._scale+this._offset[1],T=Math.floor(h),P=Math.floor(v),L=this._dem;return g=!!g,u?pr(pr(L.get(T,P,g),L.get(T,P+1,g),v-P),pr(L.get(T+1,P,g),L.get(T+1,P+1,g),v-P),h-T):L.get(T,P,g)}getElevationAtPixel(n,s,u){return this._dem.get(n,s,!!u)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*Le(1,n)*this._dem.stride}}const Lx=new Float32Array(262144),Zd=new Uint8Array(262144);function WI(c){let n=0;if(c.meshes)for(const s of c.meshes)n=Math.max(n,s.aabb.max[2]);if(c.children)for(const s of c.children)n=Math.max(n,WI(s));return n}function qI(c,n,s){if(c.meshes)for(const u of c.meshes)u.aabb.min[0]!==1/0&&s.insert(n,u.aabb.min[0],u.aabb.min[1],u.aabb.max[0],u.aabb.max[1]);if(c.children)for(const u of c.children)qI(u,n,s)}const KI=["","wall","door","roof","window","lamp","logo"];class ZI{constructor(n){this.node=n,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:n.id,geometry:[],properties:{height:WI(n)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new Ro([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let n=0;const s=new Ro([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==n&&(u.transformedAabb=Ro.applyTransformFast(u.aabb,this.node.matrix),s.encapsulate(u.transformedAabb)),n++;this.aabb=s}return this.aabb}}class Yy{constructor(n,s,u,g,h,v){this.id=s,this.modelTraits|=qf.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,u&&(this.modelTraits|=qf.HasMapboxMeshFeatures),g&&(this.modelTraits|=qf.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=h,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const T of n)this.nodesInfo.push(new ZI(T)),qI(T,v.featureIndexArray.length,v.grid),v.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,v.bucketLayerIDs.length-1,0)}updateFootprints(n,s){for(const u of this.getNodesInfo()){const g=u.node;g.footprint&&s.push({footprint:g.footprint,id:n})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(n){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const u of s){const g=u.node;this.uploaded?this.updatePbrBuffer(g):Rx(g,n,!0)}for(const u of s)Zy(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(n){let s=!1;if(!n.meshes)return s;for(const u of n.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),s=!0);return s}needsReEvaluation(n,s,u){const g=n.transform.projectionOptions,h=n.style.getBrightness(),v=this.brightness!==h;return!!(!this.uploaded||this.dirty||g.name!==this.projection.name||Lg(u.paint.get("model-color").value,v)||Lg(u.paint.get("model-color-mix-intensity").value,v)||Lg(u.paint.get("model-roughness").value,v)||Lg(u.paint.get("model-emissive-strength").value,v)||Lg(u.paint.get("model-height-based-emissive-strength-multiplier").value,v))&&(this.projection=g,this.brightness=h,!0)}evaluateScale(n,s){if(n.transform.zoom===this.zoom)return;this.zoom=n.transform.zoom;const u=this.getNodesInfo(),g=this.id.canonical;for(const h of u){const v=h.feature;h.evaluatedScale=s.paint.get("model-scale").evaluate(v,{},g)}}evaluate(n){const s=this.getNodesInfo();for(const u of s){if(!u.node.meshes)continue;const g=u.feature,h=u.node.meshes&&u.node.meshes[0].featureData,v=u.evaluatedColor[2],T=u.evaluatedRMEA[2],P=this.id.canonical;if(u.hasTranslucentParts=!1,h){for(let L=0;L<KI.length;L++){const w=KI[L];w.length&&(g.properties.part=w);const M=n.paint.get("model-color").evaluate(g,{},P).toRenderColor(null),D=n.paint.get("model-color-mix-intensity").evaluate(g,{},P);u.evaluatedColor[L]=[M.r,M.g,M.b,D],u.evaluatedRMEA[L][0]=n.paint.get("model-roughness").evaluate(g,{},P),u.evaluatedRMEA[L][2]=n.paint.get("model-emissive-strength").evaluate(g,{},P),u.evaluatedRMEA[L][3]=M.a,u.emissionHeightBasedParams[L]=n.paint.get("model-height-based-emissive-strength-multiplier").evaluate(g,{},P),!u.hasTranslucentParts&&M.a<1&&(u.hasTranslucentParts=!0)}delete g.properties.part,EN(u,v!==u.evaluatedColor[2]||T!==u.evaluatedRMEA[2],this.modelTraits)}else u.evaluatedRMEA[0][2]=n.paint.get("model-emissive-strength").evaluate(g,{},P);u.evaluatedScale=n.paint.get("model-scale").evaluate(g,{},P),this.updatePbrBuffer(u.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(n,s,u,g){const h=n.findDEMTileFor(u);if(h&&(h.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;const v=Kf.create(n,u,h);if(!v)return;this.modelTraits&qf.HasMapboxMeshFeatures&&this.updateDEM(n,v,u,g);for(const T of this.getNodesInfo()){const P=T.node;if(!P.footprint||!P.footprint.vertices||!P.footprint.vertices.length)continue;const L=P.footprint.vertices;let w=v.getElevationAt(L[0].x,L[0].y,!0,!0);for(let M=1;M<L.length;M++)w=Math.min(w,v.getElevationAt(L[M].x,L[M].y,!0,!0));P.elevation=w}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=s}}updateDEM(n,s,u,g){let h=s._dem._modifiedForSources[g];if(h===void 0&&(s._dem._modifiedForSources[g]=[],h=s._dem._modifiedForSources[g]),h.includes(u.canonical))return;const v=s._dem.dim;h.push(u.canonical);let T=!1;for(const P of this.getNodesInfo()){const L=P.node;if(!L.footprint||!L.footprint.grid)continue;const w=L.footprint.grid,M=s.tileCoordToPixel(w.min.x,w.min.y),D=s.tileCoordToPixel(w.max.x,w.max.y),I=Math.min(Math.min(v-D.y,M.x),Math.min(M.y,v-D.x));if(I<0)continue;const R=Zt(I,2,5);let B=Math.max(0,M.x-R),j=Math.max(0,M.y-R),K=Math.min(D.x+R,v-1),ne=Math.min(D.y+R,v-1);for(let me=j;me<=ne;++me)for(let Ee=B;Ee<=K;++Ee)Zd[me*v+Ee]=255;let oe=0,Y=0;for(let me=0;me<w.cellsY;++me)for(let Ee=0;Ee<w.cellsX;++Ee){if(!w.cells[me*w.cellsX+Ee])continue;const Oe=s.tileCoordToPixel(w.min.x+Ee/w.xScale,w.min.y+me/w.yScale),Be=s.tileCoordToPixel(w.min.x+(Ee+1)/w.xScale,w.min.y+(me+1)/w.yScale);for(let De=Oe.y;De<=Math.min(Be.y+1,v-1);++De)for(let Xe=Oe.x;Xe<=Math.min(Be.x+1,v-1);++Xe)Zd[De*v+Xe]===255&&(Zd[De*v+Xe]=0,oe+=s.getElevationAtPixel(Xe,De),Y++)}const ae=oe/Y;B=Math.max(1,M.x-R),j=Math.max(1,M.y-R),K=Math.min(D.x+R,v-2),ne=Math.min(D.y+R,v-2),T=!0;for(let me=j;me<=ne;++me)for(let Ee=B;Ee<=K;++Ee)Zd[me*v+Ee]===0&&(Lx[me*v+Ee]=s._dem.set(Ee,me,ae));for(let me=1;me<R;++me){B=Math.max(1,M.x-me),j=Math.max(1,M.y-me),K=Math.min(D.x+me,v-2),ne=Math.min(D.y+me,v-2);for(let Ee=j;Ee<=ne;++Ee)for(let Oe=B;Oe<=K;++Oe){const Be=Ee*v+Oe;if(Zd[Be]===255){let De=0,Xe=0,$e=-1,tt=-1;for(let ft=-1;ft<=1;++ft)for(let vt=-1;vt<=1;++vt){const yt=(Ee+ft)*v+Oe+vt;if(Zd[yt]>=me)continue;const wt=Lx[yt],Bt=Math.abs(wt);Bt>Xe&&(De=wt,Xe=Bt,$e=vt,tt=ft)}if(Xe>.1){const ft=1-(me+.5*Math.abs($e*tt))/R;let vt=s._dem.get(Oe,Ee)+De*ft;const yt=s._dem.get(Oe+$e,Ee+tt),wt=s._dem.get(Oe-$e,Ee-tt,!0);(vt-yt)*(vt-wt)>0&&(vt=(yt+wt)/2),Lx[Be]=s._dem.set(Oe,Ee,vt),Zd[Be]=me}}}}}T&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=Cn.now())}getNodesInfo(){return this.nodesInfo}destroy(){const n=this.getNodesInfo();for(const s of n)Zy(s.node),Dx(s.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const u=s.getReplacementRegionsForTile(n.toUnwrapped()),g=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){const v=g[h].node;g[h].hiddenByReplacement=!!v.footprint&&!u.find(T=>T.footprint===v.footprint)}}getHeightAtTileCoord(n,s){const u=this.getNodesInfo(),g=[],h=[0,0,0],v=Pe.mat4.identity([]);for(let T=0;T<this.nodesInfo.length;T++){const P=u[T],L=P.node.meshes[0],w=L.transformedAabb;if(n<w.min[0]||s<w.min[1]||n>w.max[0]||s>w.max[1])continue;if(P.node.hidden===!0)return{height:1/0,maxHeight:P.feature.properties.height,hidden:!1,verticalScale:P.evaluatedScale[2]};Pe.mat4.invert(v,P.node.matrix),h[0]=n,h[1]=s,Pe.vec3.transformMat4(h,h,v);const M=(h[0]-L.aabb.min[0])/(L.aabb.max[0]-L.aabb.min[0])*Kd|0,D=Math.min(63,(h[1]-L.aabb.min[1])/(L.aabb.max[1]-L.aabb.min[1])*Kd|0)*Kd+Math.min(63,M),I=L.heightmap[D];if(!(I<0&&P.node.footprint))return P.hiddenByReplacement?void 0:{height:I,maxHeight:P.feature.properties.height,hidden:!1,verticalScale:P.evaluatedScale[2]};if(P.node.footprint.grid.query(new et(n,s),new et(n,s),g),g.length>0)return{height:void 0,maxHeight:P.feature.properties.height,hidden:P.hiddenByReplacement,verticalScale:P.evaluatedScale[2]}}}}function Lg(c,n){return!c.isLightConstant&&n}function CN(c,n,s,u,g,h,v,T){let P=(61440&n|(61440&n)>>4)>>8,L=(3840&n|(3840&n)>>4)>>4,w=240&n|(240&n)>>4;s[3]>0&&(P=pr(P,255*s[0],s[3]),L=pr(L,255*s[1],s[3]),w=pr(w,255*s[2],s[3]));const M=P<<8|L,D=w<<8|Math.floor(255*u[3]),I=function(me){const Ee=Zt(me,0,2);return Math.min(Math.round(.5*Ee*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],R=Zt(g[0],0,1),B=Zt(g[1],0,1),j=Zt(g[2],0,1),K=Zt(g[3],0,1);let ne,oe,Y,ae;if(R!==B&&v!==h&&B!==R){const me=v-h;oe=1/(me*(B-R)),Y=-(h+me*R)/(me*(B-R));const Ee=Zt(g[4],-1,1);ae=Math.pow(10,Ee),ne=255*j<<8|255*K}else ne=65535,oe=0,Y=1,ae=1;if(c.emplaceBack(M,D,I,ne,oe,Y,ae),T){const me=T.length;T.clear();for(let Ee=0;Ee<me;Ee++)T.emplaceBack(M,D,I,ne,oe,Y,ae)}}function EN(c,n,s){const u=c.node;let g=0;const h=s&qf.HasMeshoptCompression;for(const v of u.meshes){if(u.lights&&u.lightMeshIndex===g||!v.featureData)continue;v.featureArray=new Rf,v.featureArray.reserve(v.featureData.length);let T=n;for(const P of v.featureData){const L=h?65535&P:P>>16&65535,w=h?P>>16&65535:65535&P,M=(15&w)<8?15&w:0,D=c.evaluatedRMEA[M],I=c.evaluatedColor[M],R=c.emissionHeightBasedParams[M];let B;if(T&&M===2&&u.lights&&(B=new Rf,B.resize(10*u.lights.length)),CN(v.featureArray,L,I,D,R,v.aabb.min[2],v.aabb.max[2],B),B&&T){T=!1;const j=u.meshes[u.lightMeshIndex];j.featureArray=B,j.featureArray._trim()}}v.featureArray._trim(),g++}}function YI(c,n,s,u){const g=1<<c.z;n.lat=Ue((u/An+c.y)/g),n.lng=je((s/An+c.x)/g)}Gn(Yy,"Tiled3dModelBucket",{omit:["layers"]}),Gn(ZI,"Tiled3dModelFeature");const MN={circle:class extends Ui{constructor(c,n,s,u){super(c,{layout:uo||(uo=new $o({"circle-sort-key":new Qn(Dt.layout_circle["circle-sort-key"]),visibility:new Sn(Dt.layout_circle.visibility)})),paint:Yo||(Yo=new $o({"circle-radius":new Qn(Dt.paint_circle["circle-radius"]),"circle-color":new Qn(Dt.paint_circle["circle-color"]),"circle-blur":new Qn(Dt.paint_circle["circle-blur"]),"circle-opacity":new Qn(Dt.paint_circle["circle-opacity"]),"circle-translate":new Sn(Dt.paint_circle["circle-translate"]),"circle-translate-anchor":new Sn(Dt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Sn(Dt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Sn(Dt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Qn(Dt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Qn(Dt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Qn(Dt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Sn(Dt.paint_circle["circle-emissive-strength"])}))},n,s,u)}createBucket(c){return new er(c)}queryRadius(c){const n=c;return Vo("circle-radius",this,n)+Vo("circle-stroke-width",this,n)+vo(this.paint.get("circle-translate"))}queryIntersectsFeature(c,n,s,u,g,h,v,T){const P=io(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),L=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s);return IE(c,u,h,v,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",P,L)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,n,s){const u=ME(this);return{config:new vc(this,{zoom:n,lut:s}),defines:u,overrideFog:!1}}},heatmap:class extends Ui{createBucket(c){return new AE(c)}constructor(c,n,s,u){super(c,{layout:PE||(PE=new $o({visibility:new Sn(Dt.layout_heatmap.visibility)})),paint:RE||(RE=new $o({"heatmap-radius":new Qn(Dt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Qn(Dt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Sn(Dt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ia(Dt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Sn(Dt.paint_heatmap["heatmap-opacity"])}))},n,s,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=fg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return Vo("heatmap-radius",this,c)}queryIntersectsFeature(c,n,s,u,g,h,v,T){const P=this.paint.get("heatmap-radius").evaluate(n,s);return IE(c,u,h,v,T,!0,!0,new et(0,0),P)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,n,s){return c==="heatmap"?{config:new vc(this,{zoom:n,lut:s}),overrideFog:!1}:{}}},hillshade:class extends Ui{constructor(c,n,s,u){super(c,{layout:DE||(DE=new $o({visibility:new Sn(Dt.layout_hillshade.visibility)})),paint:LE||(LE=new $o({"hillshade-illumination-direction":new Sn(Dt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Sn(Dt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Sn(Dt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Sn(Dt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Sn(Dt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Sn(Dt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Sn(Dt.paint_hillshade["hillshade-emissive-strength"])}))},n,s,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,n,s){return{overrideFog:!1}}},fill:class extends Ui{constructor(c,n,s,u){super(c,{layout:UE||(UE=new $o({"fill-sort-key":new Qn(Dt.layout_fill["fill-sort-key"]),visibility:new Sn(Dt.layout_fill.visibility)})),paint:jE||(jE=new $o({"fill-antialias":new Sn(Dt.paint_fill["fill-antialias"]),"fill-opacity":new Qn(Dt.paint_fill["fill-opacity"]),"fill-color":new Qn(Dt.paint_fill["fill-color"]),"fill-outline-color":new Qn(Dt.paint_fill["fill-outline-color"]),"fill-translate":new Sn(Dt.paint_fill["fill-translate"]),"fill-translate-anchor":new Sn(Dt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Qn(Dt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Sn(Dt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Qn(Dt.paint_fill["fill-z-offset"])}))},n,s,u)}getProgramIds(){const c=this.paint.get("fill-pattern"),n=c&&c.constantOr(1),s=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(c,n,s){return{config:new vc(this,{zoom:n,lut:s}),overrideFog:!1}}recalculate(c,n){super.recalculate(c,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new X1(c)}queryRadius(){return vo(this.paint.get("fill-translate"))}queryIntersectsFeature(c,n,s,u,g,h){return!c.queryGeometry.isAboveHorizon&&gr(Lr(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends Ui{constructor(c,n,s,u){super(c,{layout:TM||(TM=new $o({visibility:new Sn(Dt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Sn(Dt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:CM||(CM=new $o({"fill-extrusion-opacity":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Qn(Dt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Qn(Dt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Qn(Dt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Qn(Dt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Qn(Dt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Qn(Dt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Qn(Dt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Qn(Dt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Sn(Dt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},n,s,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new My(c)}queryRadius(){return vo(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,n,s,u,g,h,v,T,P){const L=io(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(n,s),M=this.paint.get("fill-extrusion-base").evaluate(n,s),D=[0,0],I=T&&h.elevation,R=h.elevation?h.elevation.exaggeration():1,B=c.tile.getBucket(this);if(I&&B instanceof My){const Y=B.centroidVertexArray,ae=P+1;ae<Y.length&&(D[0]=Y.geta_centroid_pos0(ae),D[1]=Y.geta_centroid_pos1(ae))}if(D[0]===0&&D[1]===1)return!1;h.projection.name==="globe"&&(u=SM([u],[new et(0,0),new et(An,An)],c.tileID.canonical).map(Y=>Y.polygon).flat());const j=I?T:null,[K,ne]=function(Y,ae,me,Ee,Oe,Be,De,Xe,$e,tt,ft){return Y.projection.name==="globe"?function(vt,yt,wt,Bt,St,Xt,un,Gt,On,In,xn){const mn=[],nr=[],Ln=vt.projection.upVectorScale(xn,vt.center.lat,vt.worldSize).metersToTile,Un=[0,0,0,1],br=[0,0,0,1],Or=(Pr,Nr,Vr,Co)=>{Pr[0]=Nr,Pr[1]=Vr,Pr[2]=Co,Pr[3]=1},Ar=wM();wt>0&&(wt+=Ar),Bt+=Ar;for(const Pr of yt){const Nr=[],Vr=[];for(const Co of Pr){const ho=Co.x+St.x,Sr=Co.y+St.y,so=vt.projection.projectTilePoint(ho,Sr,xn),lo=vt.projection.upVector(xn,Co.x,Co.y);let Oo=wt,ei=Bt;if(un){const di=MM(ho,Sr,wt,Bt,un,Gt,On,In);Oo+=di.base,ei+=di.top}wt!==0?Or(Un,so.x+lo[0]*Ln*Oo,so.y+lo[1]*Ln*Oo,so.z+lo[2]*Ln*Oo):Or(Un,so.x,so.y,so.z),Or(br,so.x+lo[0]*Ln*ei,so.y+lo[1]*Ln*ei,so.z+lo[2]*Ln*ei),Pe.vec3.transformMat4(Un,Un,Xt),Pe.vec3.transformMat4(br,br,Xt),Nr.push(new qd(Un[0],Un[1],Un[2])),Vr.push(new qd(br[0],br[1],br[2]))}mn.push(Nr),nr.push(Vr)}return[mn,nr]}(Y,ae,me,Ee,Oe,Be,De,Xe,$e,tt,ft):De?function(vt,yt,wt,Bt,St,Xt,un,Gt,On){const In=[],xn=[],mn=[0,0,0,1];for(const nr of vt){const Ln=[],Un=[];for(const br of nr){const Or=br.x+Bt.x,Ar=br.y+Bt.y,Pr=MM(Or,Ar,yt,wt,Xt,un,Gt,On);mn[0]=Or,mn[1]=Ar,mn[2]=Pr.base,mn[3]=1,Pe.vec4.transformMat4(mn,mn,St),mn[3]=Math.max(mn[3],1e-5);const Nr=new qd(mn[0]/mn[3],mn[1]/mn[3],mn[2]/mn[3]);mn[0]=Or,mn[1]=Ar,mn[2]=Pr.top,mn[3]=1,Pe.vec4.transformMat4(mn,mn,St),mn[3]=Math.max(mn[3],1e-5);const Vr=new qd(mn[0]/mn[3],mn[1]/mn[3],mn[2]/mn[3]);Ln.push(Nr),Un.push(Vr)}In.push(Ln),xn.push(Un)}return[In,xn]}(ae,me,Ee,Oe,Be,De,Xe,$e,tt):function(vt,yt,wt,Bt,St){const Xt=[],un=[],Gt=St[8]*yt,On=St[9]*yt,In=St[10]*yt,xn=St[11]*yt,mn=St[8]*wt,nr=St[9]*wt,Ln=St[10]*wt,Un=St[11]*wt;for(const br of vt){const Or=[],Ar=[];for(const Pr of br){const Nr=Pr.x+Bt.x,Vr=Pr.y+Bt.y,Co=St[0]*Nr+St[4]*Vr+St[12],ho=St[1]*Nr+St[5]*Vr+St[13],Sr=St[2]*Nr+St[6]*Vr+St[14],so=St[3]*Nr+St[7]*Vr+St[15],lo=Co+Gt,Oo=ho+On,ei=Sr+In,di=Math.max(so+xn,1e-5),ti=Co+mn,Wo=ho+nr,Si=Sr+Ln,pi=Math.max(so+Un,1e-5);Or.push(new qd(lo/di,Oo/di,ei/di)),Ar.push(new qd(ti/pi,Wo/pi,Si/pi))}Xt.push(Or),un.push(Ar)}return[Xt,un]}(ae,me,Ee,Oe,Be)}(h,u,M,w,L,v,j,D,R,h.center.lat,c.tileID.canonical),oe=c.queryGeometry;return function(Y,ae,me){let Ee=1/0;gr(me,ae)&&(Ee=EM(me,ae[0]));for(let Oe=0;Oe<ae.length;Oe++){const Be=ae[Oe],De=Y[Oe];for(let Xe=0;Xe<Be.length-1;Xe++){const $e=Be[Xe],tt=[$e,Be[Xe+1],De[Xe+1],De[Xe],$e];Mn(me,tt)&&(Ee=Math.min(Ee,EM(me,tt)))}}return Ee!==1/0&&Ee}(K,ne,oe.isPointQuery()?oe.screenBounds:oe.screenGeometry)}},line:class extends Ui{constructor(c,n,s,u){const g=BM();super(c,g,n,s,u),g.layout&&(this.layout=new hu(g.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof Cd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,n){super.recalculate(c,n),this.paint._values["line-floorwidth"]=(()=>{if(wg)return wg;const s=BM();return wg=new AF(s.paint.properties["line-width"].specification),wg.useIntegerZoom=!0,wg})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new ax(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,n,s){const u=OM(this);return{config:new vc(this,{zoom:n,lut:s}),defines:u,overrideFog:!1}}queryRadius(c){const n=c,s=FM(Vo("line-width",this,n),Vo("line-gap-width",this,n)),u=Vo("line-offset",this,n);return s/2+Math.abs(u)+vo(this.paint.get("line-translate"))}queryIntersectsFeature(c,n,s,u,g,h){if(c.queryGeometry.isAboveHorizon)return!1;const v=Lr(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),T=c.pixelToTileUnitsFactor/2*FM(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),P=this.paint.get("line-offset").evaluate(n,s);return P&&(u=function(L,w){const M=[],D=new et(0,0);for(let I=0;I<L.length;I++){const R=L[I],B=[];for(let j=0;j<R.length;j++){const K=R[j],ne=R[j+1],oe=j===0?D:K.sub(R[j-1])._unit()._perp(),Y=j===R.length-1?D:ne.sub(K)._unit()._perp(),ae=oe._add(Y)._unit();ae._mult(1/(ae.x*Y.x+ae.y*Y.y)),B.push(ae._mult(w)._add(K))}M.push(B)}return M}(u,P*c.pixelToTileUnitsFactor)),function(L,w,M){for(let D=0;D<w.length;D++){const I=w[D];if(L.length>=3){for(let R=0;R<I.length;R++)if(Lo(L,I[R]))return!0}if(Zn(L,I,M))return!0}return!1}(v,u,T)}isTileClipped(){return!0}isDraped(c){const n=this.layout.get("line-z-offset");return n.isConstant()&&!n.constantOr(0)}},symbol:Uy,background:class extends Ui{constructor(c,n,s,u){super(c,{layout:xI||(xI=new $o({visibility:new Sn(Dt.layout_background.visibility)})),paint:wI||(wI=new $o({"background-pitch-alignment":new Sn(Dt.paint_background["background-pitch-alignment"]),"background-color":new Sn(Dt.paint_background["background-color"]),"background-pattern":new Sn(Dt.paint_background["background-pattern"]),"background-opacity":new Sn(Dt.paint_background["background-opacity"]),"background-emissive-strength":new Sn(Dt.paint_background["background-emissive-strength"])}))},n,s,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,n,s){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:MI,"raster-particle":DI,sky:class extends Ui{constructor(c,n,s,u){super(c,{layout:AI||(AI=new $o({visibility:new Sn(Dt.layout_sky.visibility)})),paint:PI||(PI=new $o({"sky-type":new Sn(Dt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Sn(Dt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Sn(Dt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Sn(Dt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Sn(Dt.paint_sky["sky-gradient-radius"]),"sky-gradient":new ia(Dt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Sn(Dt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Sn(Dt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Sn(Dt.paint_sky["sky-opacity"])}))},n,s,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=fg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(c,n){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),g=!u,h=c.style.light,v=h.properties.get("position");return g&&h.properties.get("anchor")==="viewport"&&Hn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),g?Ix(v.azimuthal,90-v.polar,n):Ix(u[0],90-u[1],n)}const s=this.paint.get("sky-gradient-center");return Ix(s[0],90-s[1],n)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends Ui{constructor(c,n,s,u){super(c,{paint:RI||(RI=new $o({}))},n,null)}},model:class extends Ui{constructor(c,n,s,u){super(c,{layout:jI||(jI=new $o({visibility:new Sn(Dt.layout_model.visibility),"model-id":new Qn(Dt.layout_model["model-id"])})),paint:HI||(HI=new $o({"model-opacity":new Sn(Dt.paint_model["model-opacity"]),"model-rotation":new Qn(Dt.paint_model["model-rotation"]),"model-scale":new Qn(Dt.paint_model["model-scale"]),"model-translation":new Qn(Dt.paint_model["model-translation"]),"model-color":new Qn(Dt.paint_model["model-color"]),"model-color-mix-intensity":new Qn(Dt.paint_model["model-color-mix-intensity"]),"model-type":new Sn(Dt.paint_model["model-type"]),"model-cast-shadows":new Sn(Dt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Sn(Dt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Sn(Dt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Qn(Dt.paint_model["model-emissive-strength"]),"model-roughness":new Qn(Dt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Qn(Dt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Sn(Dt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Sn(Dt.paint_model["model-front-cutoff"])}))},n,s,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new Px(c)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof Yy?An-1:0}queryIntersectsFeature(c,n,s,u,g,h){if(!this.modelManager)return!1;const v=this.modelManager,T=c.tile.getBucket(this);if(!(T&&T instanceof Px))return!1;const P=T;for(const L in P.instancesPerModel){const w=P.instancesPerModel[L],M=n.id!==void 0?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(w.idToFeaturesIndex.hasOwnProperty(M)){const D=w.features[w.idToFeaturesIndex[M]],I=v.getModel(L,this.scope);if(!I)return!1;let R=Pe.mat4.create();const B=new re(0,0),j=P.canonical;let K=Number.MAX_VALUE;for(let ne=0;ne<D.instancedDataCount;++ne){const oe=16*(D.instancedDataOffset+ne),Y=w.instancedDataArray.float32,ae=[Y[oe+4],Y[oe+5],Y[oe+6]];YI(j,B,Y[oe],0|Y[oe+1]),GI(R,I,h,B,D.rotation,D.scale,ae,!1,!1,!1),h.projection.name==="globe"&&(R=Ax(R,h));const me=Pe.mat4.multiply([],h.projMatrix,R),Ee=c.queryGeometry,Oe=FI(Ee.isPointQuery()?Ee.screenBounds:Ee.screenGeometry,h,me,I.aabb);Oe!=null&&(K=Math.min(Oe,K))}return K!==Number.MAX_VALUE&&K}}return!1}_handleOverridablePaintPropertyUpdate(c,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const n=this._transitionablePaint._values[c];return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof Sa}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(c,n,s,u){const g=c.tile,h=g.getBucket(this);let v=null,T=Number.MAX_VALUE;if(!(h&&h instanceof Yy))return{queryFeature:v,intersectionZ:T};const P=h.getNodesInfo()[n];if(P.hiddenByReplacement||!P.node.meshes||!s.filter(new Ko(g.tileID.overscaledZ),P.feature,g.tileID.canonical))return{queryFeature:v,intersectionZ:T};const L=P.node,w=u.calculatePosMatrix(g.tileID.toUnwrapped(),u.worldSize),M=P.evaluatedScale;let D=0;u.elevation&&L.elevation&&(D=L.elevation*u.elevation.exaggeration()),Pe.mat4.translate(w,w,[(L.anchor?L.anchor[0]:0)*(M[0]-1),(L.anchor?L.anchor[1]:0)*(M[1]-1),D]),Pe.mat4.scale(w,w,M),Pe.mat4.multiply(w,w,L.matrix);const I=c.queryGeometry,R=I.isPointQuery()?I.screenBounds:I.screenGeometry,B=function(K){const ne=Pe.mat4.multiply([],w,K.matrix),oe=Pe.mat4.multiply(ne,u.expandedFarZProjMatrix,ne);for(let Y=0;Y<K.meshes.length;++Y){const ae=K.meshes[Y];if(Y===K.lightMeshIndex)continue;const me=FI(R,u,oe,ae.aabb);me!=null&&(T=Math.min(me,T))}if(K.children)for(const Y of K.children)B(Y)};if(B(L),T===Number.MAX_VALUE)return{queryFeature:v,intersectionZ:T};const j=new re(0,0);return YI(g.tileID.canonical,j,P.node.anchor[0],P.node.anchor[1]),v={type:"Feature",geometry:{type:"Point",coordinates:[j.lng,j.lat]},properties:P.feature.properties,id:P.feature.id,state:{},layer:this.serialize()},{queryFeature:v,intersectionZ:T}}},clip:class extends Ui{constructor(c,n,s,u){super(c,{layout:HE||(HE=new $o({"clip-layer-types":new Sn(Dt.layout_clip["clip-layer-types"]),"clip-layer-scope":new Sn(Dt.layout_clip["clip-layer-scope"])})),paint:GE||(GE=new $o({}))},n,s,u)}recalculate(c,n){super.recalculate(c,n)}createBucket(c){return new WE(c)}isTileClipped(){return!0}is3D(){return!0}}};class IN{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class kN{constructor(){this.tasks={},this.taskQueue=[],_n(["process"],this),this.invoker=new IN(this.process),this.nextId=0}add(n,s){const u=this.nextId++,g=function({type:h,isSymbolTile:v,zoom:T}){return T=T||0,h==="message"?0:h!=="maybePrepare"||v?h!=="parseTile"||v?h==="parseTile"&&v?300-T:h==="maybePrepare"&&v?400-T:500:200-T:100-T}(s);if(g===0){try{n()}finally{}return null}return this.tasks[u]={fn:n,metadata:s,priority:g,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const s=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let n=null,s=1/0;for(let g=0;g<this.taskQueue.length;g++){const h=this.tasks[this.taskQueue[g]];h.priority<s&&(s=h.priority,n=g)}if(n===null)return null;const u=this.taskQueue[n];return this.taskQueue.splice(n,1),u}remove(){this.invoker.remove()}}class XI{constructor(n,s,u){this.target=n,this.parent=s,this.mapId=u,this.callbacks={},this.cancelCallbacks={},_n(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new kN}send(n,s,u,g,h=!1,v){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=v,this.callbacks[T]=u);const P=new Set;return this.target.postMessage({id:T,type:n,hasCallback:!!u,targetMapId:g,mustQueue:h,sourceMapId:this.mapId,data:cs(s,P)},P),{cancel:()=>{u&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:g,sourceMapId:this.mapId})}}}receive(n){const s=n.data,u=s.id;if(u&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const g=this.cancelCallbacks[u];delete this.cancelCallbacks[u],g&&g.cancel()}else if(s.mustQueue||bo()){const g=this.callbacks[u],h=this.scheduler.add(()=>this.processTask(u,s),g&&g.metadata||{type:"message"});h&&(this.cancelCallbacks[u]=h)}else this.processTask(u,s)}processTask(n,s){if(delete this.cancelCallbacks[n],s.type==="<response>"){const u=this.callbacks[n];delete this.callbacks[n],u&&(s.error?u(hc(s.error)):u(null,hc(s.data)))}else{const u=new Set,g=s.hasCallback?(v,T)=>{this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:v?cs(v):null,data:cs(T,u)},u)}:v=>{},h=hc(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,h,g);else if(this.parent.getWorkerSource){const v=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,v[0],h.source,h.scope)[v[1]](h,g)}else g(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Zf{constructor(n,s){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=Xr();const u=this.workerPool.acquire(this.id);for(let g=0;g<u.length;g++){const h=new Zf.Actor(u[g],s,this.id);h.name=`Worker ${g}`,this.actors.push(h)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,s,u){ur(this.actors,(g,h)=>{g.send(n,s,h)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}Zf.Actor=XI;class JI{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,s){const u=this.toIdx(n,s);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(n,s){return this.leaves[this.toIdx(n,s)]}toIdx(n,s){return s*this.size+n}}function QI(c,n,s,u){let g=0,h=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(u[v])<1e-15){if(s[v]<c[v]||s[v]>n[v])return null}else{const T=1/u[v];let P=(c[v]-s[v])*T,L=(n[v]-s[v])*T;if(P>L){const w=P;P=L,L=w}if(P>g&&(g=P),L<h&&(h=L),g>h)return null}return g}function ek(c,n,s,u,g,h,v,T,P,L,w){const M=u-c,D=g-n,I=h-s,R=v-c,B=T-n,j=P-s,K=w[1]*j-w[2]*B,ne=w[2]*R-w[0]*j,oe=w[0]*B-w[1]*R,Y=M*K+D*ne+I*oe;if(Math.abs(Y)<1e-15)return null;const ae=1/Y,me=L[0]-c,Ee=L[1]-n,Oe=L[2]-s,Be=(me*K+Ee*ne+Oe*oe)*ae;if(Be<0||Be>1)return null;const De=Ee*I-Oe*D,Xe=Oe*M-me*I,$e=me*D-Ee*M,tt=(w[0]*De+w[1]*Xe+w[2]*$e)*ae;return tt<0||Be+tt>1?null:(R*De+B*Xe+j*$e)*ae}function tk(c,n,s){return(c-n)/(s-n)}function nk(c,n,s,u,g,h,v,T,P){const L=1<<s,w=h-u,M=v-g,D=(c+1)/L*w+u,I=(n+0)/L*M+g,R=(n+1)/L*M+g;T[0]=(c+0)/L*w+u,T[1]=I,P[0]=D,P[1]=R}class rk{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(h){const v=Math.ceil(Math.log2(h.dim/8)),T=[];let P=Math.ceil(Math.pow(2,v));const L=1/P,w=(I,R,B,j,K)=>{const ne=j?1:0,oe=(I+1)*B-ne,Y=R*B,ae=(R+1)*B-ne;K[0]=I*B,K[1]=Y,K[2]=oe,K[3]=ae};let M=new JI(P);const D=[];for(let I=0;I<P*P;I++){w(I%P,Math.floor(I/P),L,!1,D);const R=Au(D[0],D[1],h),B=Au(D[2],D[1],h),j=Au(D[2],D[3],h),K=Au(D[0],D[3],h);M.minimums.push(Math.min(R,B,j,K)),M.maximums.push(Math.max(R,B,j,K)),M.leaves.push(1)}for(T.push(M),P/=2;P>=1;P/=2){const I=T[T.length-1];M=new JI(P);for(let R=0;R<P*P;R++){w(R%P,Math.floor(R/P),2,!0,D);const B=I.getElevation(D[0],D[1]),j=I.getElevation(D[2],D[1]),K=I.getElevation(D[2],D[3]),ne=I.getElevation(D[0],D[3]),oe=I.isLeaf(D[0],D[1]),Y=I.isLeaf(D[2],D[1]),ae=I.isLeaf(D[2],D[3]),me=I.isLeaf(D[0],D[3]),Ee=Math.min(B.min,j.min,K.min,ne.min),Oe=Math.max(B.max,j.max,K.max,ne.max),Be=oe&&Y&&ae&&me;M.maximums.push(Oe),M.minimums.push(Ee),M.leaves.push(Oe-Ee<=5&&Be?1:0)}T.push(M)}return T}(this.dem),u=s.length-1,g=s[u];this._addNode(g.minimums[0],g.maximums[0],g.leaves[0]),this._construct(s,0,0,u,0)}raycastRoot(n,s,u,g,h,v,T=1){return QI([n,s,-100],[u,g,this.maximums[0]*T],h,v)}raycast(n,s,u,g,h,v,T=1){if(!this.nodeCount)return null;const P=this.raycastRoot(n,s,u,g,h,v,T);if(P==null)return null;const L=[],w=[],M=[],D=[],I=[{idx:0,t:P,nodex:0,nodey:0,depth:0}];for(;I.length>0;){const{idx:R,t:B,nodex:j,nodey:K,depth:ne}=I.pop();if(this.leaves[R]){nk(j,K,ne,n,s,u,g,M,D);const Y=1<<ne,ae=(j+0)/Y,me=(j+1)/Y,Ee=(K+0)/Y,Oe=(K+1)/Y,Be=Au(ae,Ee,this.dem)*T,De=Au(me,Ee,this.dem)*T,Xe=Au(me,Oe,this.dem)*T,$e=Au(ae,Oe,this.dem)*T,tt=ek(M[0],M[1],Be,D[0],M[1],De,D[0],D[1],Xe,h,v),ft=ek(D[0],D[1],Xe,M[0],D[1],$e,M[0],M[1],Be,h,v),vt=Math.min(tt!==null?tt:Number.MAX_VALUE,ft!==null?ft:Number.MAX_VALUE);if(vt!==Number.MAX_VALUE)return vt;{const yt=Pe.vec3.scaleAndAdd([],h,v,B);if(ok(Be,De,$e,Xe,tk(yt[0],M[0],D[0]),tk(yt[1],M[1],D[1]))>=yt[2])return B}continue}let oe=0;for(let Y=0;Y<this._siblingOffset.length;Y++){nk((j<<1)+this._siblingOffset[Y][0],(K<<1)+this._siblingOffset[Y][1],ne+1,n,s,u,g,M,D),M[2]=-100,D[2]=this.maximums[this.childOffsets[R]+Y]*T;const ae=QI(M,D,h,v);if(ae!=null){const me=ae;L[Y]=me;let Ee=!1;for(let Oe=0;Oe<oe&&!Ee;Oe++)me>=L[w[Oe]]&&(w.splice(Oe,0,Y),Ee=!0);Ee||(w[oe]=Y),oe++}}for(let Y=0;Y<oe;Y++){const ae=w[Y];I.push({idx:this.childOffsets[R]+ae,t:L[ae],nodex:(j<<1)+this._siblingOffset[ae][0],nodey:(K<<1)+this._siblingOffset[ae][1],depth:ne+1})}}return null}_addNode(n,s,u){return this.minimums.push(n),this.maximums.push(s),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(n,s,u,g,h){if(n[g].isLeaf(s,u)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const v=g-1,T=n[v];let P=0,L=0;for(let w=0;w<this._siblingOffset.length;w++){const M=2*s+this._siblingOffset[w][0],D=2*u+this._siblingOffset[w][1],I=T.getElevation(M,D),R=T.isLeaf(M,D),B=this._addNode(I.min,I.max,R);R&&(P|=1<<w),L||(L=B)}for(let w=0;w<this._siblingOffset.length;w++)P&1<<w||this._construct(n,2*s+this._siblingOffset[w][0],2*u+this._siblingOffset[w][1],v,L+w)}}function ok(c,n,s,u,g,h){return pr(pr(c,s,h),pr(n,u,h),g)}function Au(c,n,s){const u=s.dim,g=Zt(c*u-.5,0,u-1),h=Zt(n*u-.5,0,u-1),v=Math.floor(g),T=Math.floor(h),P=Math.min(v+1,u-1),L=Math.min(T+1,u-1);return ok(s.get(v,T),s.get(P,T),s.get(v,L),s.get(P,L),g-v,h-T)}const AN={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function PN(c,n,s){return(256*c*256+256*n+s)/10-1e4}function RN(c,n,s){return 256*c+n+s/256-32768}class Xy{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,s,u,g=!1){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void Hn(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const h=this.dim=s.height-2,v=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=g,this._modifiedForSources={},!g){for(let P=0;P<h;P++)v[this._idx(-1,P)]=v[this._idx(0,P)],v[this._idx(h,P)]=v[this._idx(h-1,P)],v[this._idx(P,-1)]=v[this._idx(P,0)],v[this._idx(P,h)]=v[this._idx(P,h-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(h,-1)]=v[this._idx(h-1,0)],v[this._idx(-1,h)]=v[this._idx(0,h-1)],v[this._idx(h,h)]=v[this._idx(h-1,h-1)]}const T=u==="terrarium"?RN:PN;for(let P=0;P<v.length;++P){const L=4*P;this.floatView[P]=T(this.pixels[L],this.pixels[L+1],this.pixels[L+2])}this._timestamp=Cn.now()}_buildQuadTree(){this._tree=new rk(this)}get(n,s,u=!1){u&&(n=Zt(n,-1,this.dim),s=Zt(s,-1,this.dim));const g=this._idx(n,s);return this.floatView[g]}set(n,s,u){const g=this._idx(n,s),h=this.floatView[g];return this.floatView[g]=u,u-h}static getUnpackVector(n){return AN[n]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}static pack(n,s){const u=[0,0,0,0],g=Xy.getUnpackVector(s);let h=Math.floor((n+g[3])/g[2]);return u[2]=h%256,h=Math.floor(h/256),u[1]=h%256,h=Math.floor(h/256),u[0]=h,u}getPixels(){return new BE({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,s,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let g=s*this.dim,h=s*this.dim+this.dim,v=u*this.dim,T=u*this.dim+this.dim;switch(s){case-1:g=h-1;break;case 1:h=g+1}switch(u){case-1:v=T-1;break;case 1:T=v+1}const P=-s*this.dim,L=-u*this.dim;for(let w=v;w<T;w++)for(let M=g;M<h;M++){const D=4*this._idx(M,w),I=4*this._idx(M+P,w+L);this.pixels[D+0]=n.pixels[I+0],this.pixels[D+1]=n.pixels[I+1],this.pixels[D+2]=n.pixels[I+2],this.pixels[D+3]=n.pixels[I+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function DN(c,n,s){c===1?n.header_length=s.readFixed32():c===2?n.x=s.readVarint():c===3?n.y=s.readVarint():c===4?n.z=s.readVarint():c===5&&n.layers.push(function(u,g){return u.readFields(FN,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},g)}(s,s.readVarint()+s.pos))}function LN(c,n,s){c===1?(n.delta_filter=function(u,g){return u.readFields(ON,{block_size:0},g)}(s,s.readVarint()+s.pos),n.filter="delta_filter"):c===2?(s.readVarint(),n.filter="zigzag_filter"):c===3?(s.readVarint(),n.filter="bitshuffle_filter"):c===4&&(s.readVarint(),n.filter="byteshuffle_filter")}function ON(c,n,s){c===1&&(n.block_size=s.readVarint())}function zN(c,n,s){c===1?(s.readVarint(),n.codec="gzip_data"):c===2?(s.readVarint(),n.codec="jpeg_image"):c===3?(s.readVarint(),n.codec="webp_image"):c===4&&(s.readVarint(),n.codec="png_image")}function BN(c,n,s){c===1?n.first_byte=s.readFixed64():c===2?n.last_byte=s.readFixed64():c===3?n.filters.push(function(u,g){return u.readFields(LN,{},g)}(s,s.readVarint()+s.pos)):c===4?n.codec=function(u,g){return u.readFields(zN,{},g)}(s,s.readVarint()+s.pos):c===5?n.deprecated_offset=s.readFloat():c===6?n.deprecated_scale=s.readFloat():c===7?n.bands.push(s.readString()):c===8?n.offset=s.readDouble():c===9&&(n.scale=s.readDouble())}function FN(c,n,s){c===1?n.version=s.readVarint():c===2?n.name=s.readString():c===3?n.units=s.readString():c===4?n.tilesize=s.readVarint():c===5?n.buffer=s.readVarint():c===6?n.pixel_format=s.readVarint():c===7&&n.data_index.push(function(u,g){return u.readFields(BN,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,deprecated_offset:0,deprecated_scale:0,bands:[]},g)}(s,s.readVarint()+s.pos))}function NN(c,n,s){if(c===2)(function(u,g,h){u.readFields($N,h,g)})(s,s.readVarint()+s.pos,n);else if(c===3)throw new Error("Not implemented")}function $N(c,n,s){if(c===1){let u=0;const g=s.readVarint()+s.pos;for(;s.pos<g;)n[u++]=s.readVarint()}}Gn(Xy,"DEMData"),Gn(rk,"DemMinMaxQuadTree",{omit:["dem"]});class VN{constructor(n){this.capacity=n,this.cache=new Map}get(n){if(!this.cache.has(n))return;const s=this.cache.get(n);return this.cache.delete(n),this.cache.set(n,s),s}put(n,s){this.cache.has(n)?this.cache.delete(n):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(n,s)}}function UN(c,n){if(n.length!==4)throw new Error(`Expected data of dimension 4 but got ${n.length}.`);let s=n[3];for(let u=2;u>=1;u--){const g=u===1?1:0,h=u===2?1:0;for(let v=0;v<n[0];v++){const T=n[1]*v;for(let P=g;P<n[1];P++){const L=n[2]*(P+T);for(let w=h;w<n[2];w++){const M=n[3]*(w+L);for(let D=0;D<n[3];D++){const I=M+D;c[I]+=c[I-s]}}}}s*=n[u]}return c}function jN(c){for(let n=0,s=c.length;n<s;n++)c[n]=c[n]>>>1^-(1&c[n]);return c}function HN(c,n){switch(n){case"uint32":return c;case"uint16":for(let s=0;s<c.length;s+=2){const u=c[s],g=c[s+1];c[s]=(240&u)>>4|(61440&u)>>8|(240&g)<<4|61440&g,c[s+1]=15&u|(3840&u)>>4|(15&g)<<8|(3840&g)<<4}return c;case"uint8":for(let s=0;s<c.length;s+=4){const u=c[s],g=c[s+1],h=c[s+2],v=c[s+3];c[s+0]=(192&u)>>6|(192&g)>>4|(192&h)>>2|192&v,c[s+1]=(48&u)>>4|(48&g)>>2|48&h|(48&v)<<2,c[s+2]=(12&u)>>2|12&g|(12&h)<<2|(12&v)<<4,c[s+3]=3&u|(3&g)<<2|(3&h)<<4|(3&v)<<6}return c;default:throw new Error(`Invalid pixel format, "${n}"`)}}var ca=Uint8Array,Og=Uint16Array,GN=Int32Array,ik=new ca([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),sk=new ca([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),WN=new ca([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ak=function(c,n){for(var s=new Og(31),u=0;u<31;++u)s[u]=n+=1<<c[u-1];var g=new GN(s[30]);for(u=1;u<30;++u)for(var h=s[u];h<s[u+1];++h)g[h]=h-s[u]<<5|u;return{b:s,r:g}},lk=ak(ik,2),ck=lk.b,qN=lk.r;ck[28]=258,qN[258]=28;for(var KN=ak(sk,0).b,uk=new Og(32768),ui=0;ui<32768;++ui){var Yf=(43690&ui)>>1|(21845&ui)<<1;uk[ui]=((65280&(Yf=(61680&(Yf=(52428&Yf)>>2|(13107&Yf)<<2))>>4|(3855&Yf)<<4))>>8|(255&Yf)<<8)>>1}var zg=function(c,n,s){for(var u=c.length,g=0,h=new Og(n);g<u;++g)c[g]&&++h[c[g]-1];var v,T=new Og(n);for(g=1;g<n;++g)T[g]=T[g-1]+h[g-1]<<1;v=new Og(1<<n);var P=15-n;for(g=0;g<u;++g)if(c[g])for(var L=g<<4|c[g],w=n-c[g],M=T[c[g]-1]++<<w,D=M|(1<<w)-1;M<=D;++M)v[uk[M]>>P]=L;return v},Bg=new ca(288);for(ui=0;ui<144;++ui)Bg[ui]=8;for(ui=144;ui<256;++ui)Bg[ui]=9;for(ui=256;ui<280;++ui)Bg[ui]=7;for(ui=280;ui<288;++ui)Bg[ui]=8;var dk=new ca(32);for(ui=0;ui<32;++ui)dk[ui]=5;var ZN=zg(Bg,9),YN=zg(dk,5),Ox=function(c){for(var n=c[0],s=1;s<c.length;++s)c[s]>n&&(n=c[s]);return n},nl=function(c,n,s){var u=n/8|0;return(c[u]|c[u+1]<<8)>>(7&n)&s},zx=function(c,n){var s=n/8|0;return(c[s]|c[s+1]<<8|c[s+2]<<16)>>(7&n)},XN=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],rl=function(c,n,s){var u=new Error(n||XN[c]);if(u.code=c,Error.captureStackTrace&&Error.captureStackTrace(u,rl),!s)throw u;return u},JN=new ca(0),QN=typeof TextDecoder<"u"&&new TextDecoder;try{QN.decode(JN,{stream:!0})}catch{}const e6={gzip_data:"gzip"};class Ia extends Error{constructor(n){super(n),this.name="MRTError"}}const t6={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},hk={uint32:1,uint16:2,uint8:4},n6={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let Bx;class Fx{constructor(n=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=n}getLayer(n){const s=this.layers[n];if(!s)throw new Ia(`Layer '${n}' not found`);return s}getHeaderLength(n){const s=new Uint8Array(n),u=new DataView(n);if(s[0]!==13)throw new Ia("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(n){const s=new Uint8Array(n),u=this.getHeaderLength(n);if(s.length<u)throw new Ia(`Expected header with length >= ${u} but got buffer of length ${s.length}`);const g=function(h,v){return h.readFields(DN,{header_length:0,x:0,y:0,z:0,layers:[]},void 0)}(new Bx(s.subarray(0,u)));if(!isNaN(this.x)&&(this.x!==g.x||this.y!==g.y||this.z!==g.z))throw new Ia(`Invalid attempt to parse header ${g.z}/${g.x}/${g.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=g.x,this.y=g.y,this.z=g.z;for(const h of g.layers)this.layers[h.name]=new r6(h,{cacheSize:this._cacheSize});return this}createDecodingTask(n){const s=[],u=this.getLayer(n.layerName);for(let g of n.blockIndices){const h=u.dataIndex[g],v=h.first_byte-n.firstByte,T=h.last_byte-n.firstByte;if(u._blocksInProgress.has(g))continue;const P={layerName:u.name,firstByte:v,lastByte:T,pixelFormat:u.pixelFormat,blockIndex:g,blockShape:[h.bands.length].concat(u.bandShape),buffer:u.buffer,codec:h.codec.codec,filters:h.filters.map(L=>L.filter)};u._blocksInProgress.add(g),s.push(P)}return new fk(s,()=>{s.forEach(g=>u._blocksInProgress.delete(g.blockIndex))},(g,h)=>{if(s.forEach(v=>u._blocksInProgress.delete(v.blockIndex)),g)throw g;h.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class r6{constructor({version:n,name:s,units:u,tilesize:g,pixel_format:h,buffer:v,data_index:T},P){if(this.version=n,this.version!==1)throw new Ia(`Cannot parse raster layer encoded with MRT version ${n}`);this.name=s,this.units=u,this.tileSize=g,this.buffer=v,this.pixelFormat=t6[h],this.dataIndex=T,this.bandShape=[g+2*v,g+2*v,hk[this.pixelFormat]],this._decodedBlocks=new VN(P?P.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return hk[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:n})=>n).flat()}processDecodedData(n){const s=n.blockIndex.toString();this._decodedBlocks.get(s)||this._decodedBlocks.put(s,n.data)}getBlockForBand(n){let s=0;switch(typeof n){case"string":for(const[u,g]of this.dataIndex.entries()){for(const[h,v]of g.bands.entries())if(v===n)return{bandIndex:s+h,blockIndex:u,blockBandIndex:h};s+=g.bands.length}break;case"number":for(const[u,g]of this.dataIndex.entries()){if(n>=s&&n<s+g.bands.length)return{bandIndex:n,blockIndex:u,blockBandIndex:n-s};s+=g.bands.length}break;default:throw new Ia(`Invalid band \`${JSON.stringify(n)}\`. Expected string or integer.`)}throw new Ia(`Band not found: ${JSON.stringify(n)}`)}getDataRange(n){let s=1/0,u=-1/0;const g=[],h=new Set;for(const v of n){const{blockIndex:T}=this.getBlockForBand(v);if(T<0)throw new Ia(`Invalid band: ${JSON.stringify(v)}`);const P=this.dataIndex[T];g.includes(T)||g.push(T),h.add(T),s=Math.min(s,P.first_byte),u=Math.max(u,P.last_byte)}if(h.size>this.cacheSize)throw new Ia(`Number of blocks to decode (${h.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:s,lastByte:u,blockIndices:g}}hasBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0}hasDataForBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0&&!!this._decodedBlocks.get(s.toString())}getBandView(n){const{blockIndex:s,blockBandIndex:u}=this.getBlockForBand(n),g=this._decodedBlocks.get(s.toString());if(!g)throw new Ia(`Data for band ${JSON.stringify(n)} of layer "${this.name}" not decoded.`);const h=this.dataIndex[s],v=this.bandShape.reduce((L,w)=>L*w,1),T=u*v,P=g.subarray(T,T+v);return{data:P,bytes:new Uint8Array(P.buffer).subarray(P.byteOffset,P.byteOffset+P.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:h.offset!==0?h.offset:h.deprecated_offset,scale:h.scale!==0?h.scale:h.deprecated_scale}}}Fx.setPbf=function(c){Bx=c};class fk{constructor(n,s,u){this.tasks=n,this._onCancel=s,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(n,s){this._finalized||(this._onComplete(n,s),this._finalized=!0)}}Fx.performDecoding=function(c,n){const s=new Uint8Array(c);return Promise.all(n.tasks.map(u=>{const{layerName:g,firstByte:h,lastByte:v,pixelFormat:T,blockShape:P,blockIndex:L,filters:w,codec:M}=u,D=s.subarray(h,v+1),I=new Uint32Array(P[0]*P[1]*P[2]);let R;if(M!=="gzip_data")throw new Ia(`Unhandled codec: ${M}`);return R=function(B,j){if(!globalThis.DecompressionStream&&j==="gzip_data")return Promise.resolve(((Y=function(Ee){Ee[0]==31&&Ee[1]==139&&Ee[2]==8||rl(6,"invalid gzip data");var Oe=Ee[3],Be=10;4&Oe&&(Be+=2+(Ee[10]|Ee[11]<<8));for(var De=(Oe>>3&1)+(Oe>>4&1);De>0;De-=!Ee[Be++]);return Be+(2&Oe)}(oe=B))+8>oe.length&&rl(6,"invalid gzip data"),function(Ee,Oe,Be,De){var Xe=Ee.length;if(!Xe||Oe.f&&!Oe.l)return Be||new ca(0);var $e=!Be,tt=$e||Oe.i!=2,ft=Oe.i;$e&&(Be=new ca(3*Xe));var vt,yt,wt=function(Pu){var Jd=Be.length;if(Pu>Jd){var Hg=new ca(Math.max(2*Jd,Pu));Hg.set(Be),Be=Hg}},Bt=Oe.f||0,St=Oe.p||0,Xt=Oe.b||0,un=Oe.l,Gt=Oe.d,On=Oe.m,In=Oe.n,xn=8*Xe;do{if(!un){Bt=nl(Ee,St,1);var mn=nl(Ee,St+1,3);if(St+=3,!mn){var nr=Ee[(Sr=4+((St+7)/8|0))-4]|Ee[Sr-3]<<8,Ln=Sr+nr;if(Ln>Xe){ft&&rl(0);break}tt&&wt(Xt+nr),Be.set(Ee.subarray(Sr,Ln),Xt),Oe.b=Xt+=nr,Oe.p=St=8*Ln,Oe.f=Bt;continue}if(mn==1)un=ZN,Gt=YN,On=9,In=5;else if(mn==2){var Un=nl(Ee,St,31)+257,br=nl(Ee,St+10,15)+4,Or=Un+nl(Ee,St+5,31)+1;St+=14;for(var Ar=new ca(Or),Pr=new ca(19),Nr=0;Nr<br;++Nr)Pr[WN[Nr]]=nl(Ee,St+3*Nr,7);St+=3*br;var Vr=Ox(Pr),Co=(1<<Vr)-1,ho=zg(Pr,Vr);for(Nr=0;Nr<Or;){var Sr,so=ho[nl(Ee,St,Co)];if(St+=15&so,(Sr=so>>4)<16)Ar[Nr++]=Sr;else{var lo=0,Oo=0;for(Sr==16?(Oo=3+nl(Ee,St,3),St+=2,lo=Ar[Nr-1]):Sr==17?(Oo=3+nl(Ee,St,7),St+=3):Sr==18&&(Oo=11+nl(Ee,St,127),St+=7);Oo--;)Ar[Nr++]=lo}}var ei=Ar.subarray(0,Un),di=Ar.subarray(Un);On=Ox(ei),In=Ox(di),un=zg(ei,On),Gt=zg(di,In)}else rl(1);if(St>xn){ft&&rl(0);break}}tt&&wt(Xt+131072);for(var ti=(1<<On)-1,Wo=(1<<In)-1,Si=St;;Si=St){var pi=(lo=un[zx(Ee,St)&ti])>>4;if((St+=15&lo)>xn){ft&&rl(0);break}if(lo||rl(2),pi<256)Be[Xt++]=pi;else{if(pi==256){Si=St,un=null;break}var Di=pi-254;pi>264&&(Di=nl(Ee,St,(1<<(il=ik[Nr=pi-257]))-1)+ck[Nr],St+=il);var Do=Gt[zx(Ee,St)&Wo],Is=Do>>4;if(Do||rl(3),St+=15&Do,di=KN[Is],Is>3){var il=sk[Is];di+=zx(Ee,St)&(1<<il)-1,St+=il}if(St>xn){ft&&rl(0);break}tt&&wt(Xt+131072);var ka=Xt+Di;if(Xt<di){var Aa=0-di,Xd=Math.min(di,ka);for(Aa+Xt<0&&rl(3);Xt<Xd;++Xt)Be[Xt]=(void 0)[Aa+Xt]}for(;Xt<ka;++Xt)Be[Xt]=Be[Xt-di]}}Oe.l=un,Oe.p=Si,Oe.b=Xt,Oe.f=Bt,un&&(Bt=1,Oe.m=On,Oe.d=Gt,Oe.n=In)}while(!Bt);return Xt!=Be.length&&$e?(vt=Be,((yt=Xt)==null||yt>vt.length)&&(yt=vt.length),new ca(vt.subarray(0,yt))):Be.subarray(0,Xt)}(oe.subarray(Y,-8),{i:2},new ca(((K=oe)[(ne=K.length)-4]|K[ne-3]<<8|K[ne-2]<<16|K[ne-1]<<24)>>>0))));var K,ne,oe,Y;const ae=e6[j];if(!ae)throw new Error(`Unhandled codec: ${j}`);const me=new globalThis.DecompressionStream(ae);return new Response(new Blob([B]).stream().pipeThrough(me)).arrayBuffer().then(Ee=>new Uint8Array(Ee))}(D,M).then(B=>(function(j,K){j.readFields(NN,K)}(new Bx(B),I),new n6[T](I.buffer))),R.then(B=>{for(let j=w.length-1;j>=0;j--)switch(w[j]){case"delta_filter":UN(B,P);break;case"zigzag_filter":jN(B);break;case"bitshuffle_filter":HN(B,T);break;default:throw new Ia(`Unhandled filter "${w[j]}"`)}return{layerName:g,blockIndex:L,data:B}}).catch(B=>{throw B})}))},Gn(fk,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var Fg={workerUrl:"",workerClass:null,workerParams:void 0};const Nx="mapboxgl_preloaded_worker_pool";class Ng{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<Ng.workerCount;)this.workers.push(Fg.workerClass!=null?new Fg.workerClass:new self.Worker(Fg.workerUrl,Fg.workerParams));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.workers&&this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Nx]}numActive(){return Object.keys(this.active).length}}let $g;function Jy(){return $g||($g=new Ng),$g}Ng.workerCount=2;let Vg,$x,ol,Xf,Vx,Jf=null;function pk(){return bo()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:$x||lt.DRACO_URL}function mk(){if(bo()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Xf)return Xf;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Xf=WebAssembly.validate(c)?lt.MESHOPT_SIMD_URL:lt.MESHOPT_URL,Xf}const Qy={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},o6={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Ug={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function gk(c,n,s){const u=s.json.bufferViews.length,g=s.buffers.length;n.bufferView=u,s.json.bufferViews[u]={buffer:g,byteLength:c.byteLength},s.buffers[g]=c}const Ux="KHR_draco_mesh_compression";function i6(c,n){const s=c.extensions&&c.extensions[Ux];if(!s)return;const u=new ol.Decoder,g=bk(n,s.bufferView),h=new ol.Mesh;if(!u.DecodeArrayToMesh(g,g.byteLength,h))throw new Error("Failed to decode Draco mesh");const v=n.json.accessors[c.indices],T=Qy[v.componentType],P=v.count*T.BYTES_PER_ELEMENT,L=ol._malloc(P);T===Uint16Array?u.GetTrianglesUInt16Array(h,P,L):u.GetTrianglesUInt32Array(h,P,L),gk(ol.memory.buffer.slice(L,L+P),v,n),ol._free(L);for(const w of Object.keys(s.attributes)){const M=u.GetAttributeByUniqueId(h,s.attributes[w]),D=n.json.accessors[c.attributes[w]],I=o6[D.componentType],R=D.count*Ug[D.type]*Qy[D.componentType].BYTES_PER_ELEMENT,B=ol._malloc(R);u.GetAttributeDataArrayForAllPoints(h,M,ol[I],R,B),gk(ol.memory.buffer.slice(B,B+R),D,n),ol._free(B)}u.destroy(),h.destroy(),delete c.extensions[Ux]}const e0="EXT_meshopt_compression";function s6(c,n){if(!c.extensions||!c.extensions[e0])return;const s=c.extensions[e0],u=new Uint8Array(n.buffers[s.buffer],s.byteOffset||0,s.byteLength||0),g=new Uint8Array(s.count*s.byteStride);Vx.decodeGltfBuffer(g,s.count,s.byteStride,u,s.mode,s.filter),c.buffer=n.buffers.length,c.byteOffset=0,n.buffers[c.buffer]=g.buffer,delete c.extensions[e0]}const vk=1179937895,_k=new TextDecoder("utf8");function yk(c,n){return new URL(c,n).href}function a6(c,n,s,u){return fetch(yk(c.uri,u)).then(g=>g.arrayBuffer()).then(g=>{n.buffers[s]=g})}function bk(c,n){const s=c.json.bufferViews[n];return new Uint8Array(c.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function l6(c,n,s,u){if(c.uri){const g=yk(c.uri,u);return fetch(g).then(h=>h.blob()).then(h=>createImageBitmap(h)).then(h=>{n.images[s]=h})}if(c.bufferView!==void 0){const g=bk(n,c.bufferView),h=new Blob([g],{type:c.mimeType});return createImageBitmap(h).then(v=>{n.images[s]=v})}}function xk(c,n=0,s){const u={json:null,images:[],buffers:[]};if(new Uint32Array(c,n,1)[0]===vk){const w=new Uint32Array(c,n);let M=2;const D=(w[M++]>>2)-3,I=w[M++]>>2;if(M++,u.json=JSON.parse(_k.decode(w.subarray(M,M+I))),M+=I,M<D){const R=w[M++];M++;const B=n+(M<<2);u.buffers[0]=c.slice(B,B+R)}}else u.json=JSON.parse(_k.decode(new Uint8Array(c,n)));const{buffers:g,images:h,meshes:v,extensionsUsed:T,bufferViews:P}=u.json;let L=Promise.resolve();if(g){const w=[];for(let M=0;M<g.length;M++){const D=g[M];D.uri?w.push(a6(D,u,M,s)):u.buffers[M]||(u.buffers[M]=null)}L=Promise.all(w)}return L.then(()=>{const w=[],M=T&&T.includes(Ux),D=T&&T.includes(e0);if(M&&w.push(function(){if(!ol)return Vg??(Vg=function(I){let R,B=null;function j(){R=new Uint8Array(B.buffer)}function K(){throw new Error("Unexpected Draco error.")}const ne={a:{a:K,d:function(oe,Y,ae){return R.copyWithin(oe,Y,Y+ae)},c:function(oe){const Y=R.length,ae=Math.max(oe>>>0,Math.ceil(1.2*Y)),me=Math.ceil((ae-Y)/65536);try{return B.grow(me),j(),!0}catch{return!1}},b:K}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(I,ne):I.then(oe=>oe.arrayBuffer()).then(oe=>WebAssembly.instantiate(oe,ne))).then(oe=>{const{Rb:Y,Qb:ae,P:me,T:Ee,X:Oe,Ja:Be,La:De,Qa:Xe,Va:$e,Wa:tt,eb:ft,jb:vt,f:yt,e:wt,yb:Bt,zb:St,Ab:Xt,Bb:un,Db:Gt,Gb:On}=oe.instance.exports;B=wt;const In=(()=>{let xn=0,mn=0,nr=0,Ln=0;return Un=>{nr&&(Y(Ln),Y(xn),mn+=nr,nr=xn=0),xn||(mn+=128,xn=ae(mn));const br=Un.length+7&-8;let Or=xn;br>=mn&&(nr=br,Or=Ln=ae(br));for(let Ar=0;Ar<Un.length;Ar++)R[Or+Ar]=Un[Ar];return Or}})();return j(),yt(),{memory:wt,_free:Y,_malloc:ae,Mesh:class{constructor(){this.ptr=me()}destroy(){Ee(this.ptr)}},Decoder:class{constructor(){this.ptr=Be()}destroy(){vt(this.ptr)}DecodeArrayToMesh(xn,mn,nr){const Ln=In(xn),Un=De(this.ptr,Ln,mn,nr.ptr);return!!Oe(Un)}GetAttributeByUniqueId(xn,mn){return{ptr:Xe(this.ptr,xn.ptr,mn)}}GetTrianglesUInt16Array(xn,mn,nr){$e(this.ptr,xn.ptr,mn,nr)}GetTrianglesUInt32Array(xn,mn,nr){tt(this.ptr,xn.ptr,mn,nr)}GetAttributeDataArrayForAllPoints(xn,mn,nr,Ln,Un){ft(this.ptr,xn.ptr,mn.ptr,nr,Ln,Un)}},DT_INT8:Bt(),DT_UINT8:St(),DT_INT16:Xt(),DT_UINT16:un(),DT_UINT32:Gt(),DT_FLOAT32:On()}})}(fetch(pk())),Vg.then(I=>{ol=I,Vg=void 0}))}()),D&&w.push(function(){if(Vx)return;const I=function(R){let B;const j=WebAssembly.instantiateStreaming(R,{}).then(oe=>{B=oe.instance,B.exports.__wasm_call_ctors()}),K={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ne={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:j,supported:!0,decodeGltfBuffer(oe,Y,ae,me,Ee,Oe){(function(Be,De,Xe,$e,tt,ft,vt){const yt=Be.exports.sbrk,wt=$e+3&-4,Bt=yt(wt*tt),St=yt(ft.length),Xt=new Uint8Array(Be.exports.memory.buffer);Xt.set(ft,St);const un=De(Bt,$e,tt,St,ft.length);if(un===0&&vt&&vt(Bt,wt,tt),Xe.set(Xt.subarray(Bt,Bt+$e*tt)),yt(Bt-yt(0)),un!==0)throw new Error(`Malformed buffer data: ${un}`)})(B,B.exports[ne[Ee]],oe,Y,ae,me,B.exports[K[Oe]])}}}(fetch(mk()));return I.ready.then(()=>{Vx=I})}()),h)for(let I=0;I<h.length;I++)w.push(l6(h[I],u,I,s));return(w.length?Promise.all(w):Promise.resolve()).then(()=>{if(M&&v)for(const{primitives:I}of v)for(const R of I)i6(R,u);if(D&&v&&P)for(const I of P)s6(I,u);return u})})}function Yd(c,n){const s=c.json.bufferViews[n.bufferView],u=Qy[n.componentType];return new u(c.buffers[s.buffer],(n.byteOffset||0)+(s.byteOffset||0),n.count*(s.byteStride&&s.byteStride!==Ug[n.type]*u.BYTES_PER_ELEMENT?s.byteStride/u.BYTES_PER_ELEMENT:Ug[n.type]))}function jx(c,n,s,u){const g=Qy[n.componentType],h=function(w){switch(w){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(g),v=c.json.bufferViews[n.bufferView],T=v.byteStride?v.byteStride/g.BYTES_PER_ELEMENT:Ug[n.type],P=s.float32,L=P.length/s.capacity;for(let w=0,M=0;w<n.count*T;w+=T,M+=L)for(let D=0;D<L;D++)P[M+D]=u[w+D]*h;s._trim()}function c6(c,n,s){const u=c.indices,g=c.attributes,h={};h.indexArray=new Ii;const v=n.json.accessors[u],T=v.count/3;h.indexArray.reserve(T);const P=Yd(n,v);for(let D=0;D<T;D++)h.indexArray.emplaceBack(P[3*D],P[3*D+1],P[3*D+2]);h.indexArray._trim(),h.vertexArray=new Dl;const L=n.json.accessors[g.POSITION];h.vertexArray.reserve(L.count);const w=Yd(n,L);for(let D=0;D<L.count;D++)h.vertexArray.emplaceBack(w[3*D],w[3*D+1],w[3*D+2]);if(h.vertexArray._trim(),h.aabb=new Ro(L.min,L.max),h.centroid=function(D,I){const R=[0,0,0],B=D.length;if(B>0){for(let j=0;j<B;j++){const K=3*D[j];R[0]+=I[K],R[1]+=I[K+1],R[2]+=I[K+2]}R[0]/=B,R[1]/=B,R[2]/=B}return R}(P,w),g.COLOR_0!==void 0){const D=n.json.accessors[g.COLOR_0],I=Ug[D.type],R=Yd(n,D);h.colorArray=I===3?new Dl:new Za,h.colorArray.resize(D.count),jx(n,D,h.colorArray,R)}if(g.NORMAL!==void 0){h.normalArray=new Dl;const D=n.json.accessors[g.NORMAL];h.normalArray.resize(D.count);const I=Yd(n,D);jx(n,D,h.normalArray,I)}if(g.TEXCOORD_0!==void 0&&s.length>0){h.texcoordArray=new $d;const D=n.json.accessors[g.TEXCOORD_0];h.texcoordArray.resize(D.count);const I=Yd(n,D);jx(n,D,h.texcoordArray,I)}if(g._FEATURE_ID_RGBA4444!==void 0){const D=n.json.accessors[g._FEATURE_ID_RGBA4444];n.json.extensionsUsed&&n.json.extensionsUsed.includes("EXT_meshopt_compression")&&(h.featureData=Yd(n,D))}g._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(Yd(n,n.json.accessors[g._FEATURE_RGBA4444]).buffer));const M=c.material;return h.material=function(D,I){const{emissiveFactor:R=[0,0,0],alphaMode:B="OPAQUE",alphaCutoff:j=.5,normalTexture:K,occlusionTexture:ne,emissiveTexture:oe,doubleSided:Y}=D,{baseColorFactor:ae=[1,1,1,1],metallicFactor:me=1,roughnessFactor:Ee=1,baseColorTexture:Oe,metallicRoughnessTexture:Be}=D.pbrMetallicRoughness||{},De=ne?I[ne.index]:void 0;if(ne&&ne.extensions&&ne.extensions.KHR_texture_transform&&De){const Xe=ne.extensions.KHR_texture_transform;De.offsetScale=[Xe.offset[0],Xe.offset[1],Xe.scale[0],Xe.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new co(...ae),metallicFactor:me,roughnessFactor:Ee,baseColorTexture:Oe?I[Oe.index]:void 0,metallicRoughnessTexture:Be?I[Be.index]:void 0},doubleSided:Y,emissiveFactor:R,alphaMode:B,alphaCutoff:j,normalTexture:K?I[K.index]:void 0,occlusionTexture:De,emissionTexture:oe?I[oe.index]:void 0,defined:D.defined===void 0}}(M!==void 0?n.json.materials[M]:{defined:!1},s),h}function wk(c,n,s){const{matrix:u,rotation:g,translation:h,scale:v,mesh:T,extras:P,children:L}=c,w={};if(w.matrix=u||Pe.mat4.fromRotationTranslationScale([],g||[0,0,0,1],h||[0,0,0],v||[1,1,1]),T!==void 0){w.meshes=s[T];const M=w.anchor=[0,0];for(const D of w.meshes){const{min:I,max:R}=D.aabb;M[0]+=I[0]+R[0],M[1]+=I[1]+R[1]}M[0]=Math.floor(M[0]/w.meshes.length/2),M[1]=Math.floor(M[1]/w.meshes.length/2)}if(P&&(P.id&&(w.id=P.id),P.lights&&(w.lights=function(M){if(!M.length)return[];const D=function(K){const ne=atob(K),oe=new Uint8Array(ne.length);for(let Y=0;Y<ne.length;Y++)oe[Y]=ne.codePointAt(Y);return oe}(M),I=[],R=D.length/24,B=new Uint16Array(D.buffer),j=new Float32Array(D.buffer);for(let K=0;K<R;K++){const ne=B[2*K*6]/30,oe=B[2*K*6+1]/30,Y=B[2*K*6+10]/100,ae=j[6*K+1],me=j[6*K+2],Ee=j[6*K+3],Oe=j[6*K+4],Be=Ee-ae,De=Oe-me,Xe=Math.hypot(Be,De);I.push({pos:[ae+.5*Be,me+.5*De,oe],normal:[De/Xe,-Be/Xe,0],width:Xe,height:ne,depth:Y,points:[ae,me,Ee,Oe]})}return I}(P.lights))),L){const M=[];for(const D of L)M.push(wk(n.json.nodes[D],n,s));w.children=M}return w}function u6(c){if(c.vertices.length===0||c.indices.length===0)return null;const n=new J1(c.vertices,c.indices,8,256),[s,u]=[n.min.clone(),n.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:n,min:s,max:u}}function d6(c){if(!c.extras||!c.extras.ground)return null;const n=c.extras.ground;if(!n||!Array.isArray(n)||n.length===0)return null;const s=n[0];if(!s||!Array.isArray(s)||s.length===0)return null;const u=[];for(const v of s){if(!Array.isArray(v)||v.length!==2)continue;const T=v[0],P=v[1];typeof T=="number"&&typeof P=="number"&&u.push(new et(T,P))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let g=0;for(let v=0;v<u.length;v++){const T=u[v],P=u[(v+1)%u.length],L=u[(v+2)%u.length];g+=(T.x-P.x)*(L.y-P.y)-(L.x-P.x)*(T.y-P.y)}g>0&&u.reverse();const h=pg(u.flatMap(v=>[v.x,v.y]),[]);return h.length===0?null:{vertices:u,indices:h}}function h6(c,n){const s=[],u=[];let g=0;const h=[];for(const v of c){g=s.length;const T=v.vertexArray.float32,P=v.indexArray.uint16;for(let L=0;L<v.vertexArray.length;L++)h[0]=T[3*L+0],h[1]=T[3*L+1],h[2]=T[3*L+2],Pe.vec3.transformMat4(h,h,n),s.push(new et(h[0],h[1]));for(let L=0;L<3*v.indexArray.length;L++)u.push(P[L]+g)}if(u.length%3!=0)return null;for(let v=0;v<u.length;v+=3){const T=s[u[v+0]],P=s[u[v+1]],L=s[u[v+2]];(T.x-P.x)*(L.y-P.y)-(L.x-P.x)*(T.y-P.y)>0&&([u[v+1],u[v+2]]=[u[v+2],u[v+1]])}return{vertices:s,indices:u}}function Sk(c){const n=function(P,L){const w=[],M=WebGL2RenderingContext;if(P.json.textures)for(const D of P.json.textures){const I={magFilter:M.LINEAR,minFilter:M.NEAREST,wrapS:M.REPEAT,wrapT:M.REPEAT};D.sampler!==void 0&&Object.assign(I,P.json.samplers[D.sampler]),w.push({image:L[D.source],sampler:I,uploaded:!1})}return w}(c,c.images),s=function(P,L){const w=[];for(const M of P.json.meshes){const D=[];for(const I of M.primitives)D.push(c6(I,P,L));w.push(D)}return w}(c,n),{scenes:u,scene:g,nodes:h}=c.json,v=u?u[g||0].nodes:h,T=[];for(const P of v)T.push(wk(h[P],c,s));return function(P,L,w){const M={},D=new Set;for(let I=0;I<P.length;I++){const R=w[L[I]];if(!R.extras)continue;const B=R.extras["mapbox:footprint:version"],j=R.extras["mapbox:footprint:id"];(B||j)&&D.add(I),B==="1.0.0"&&j&&(M[j]=I)}for(let I=0;I<P.length;I++){if(D.has(I))continue;const R=P[I],B=w[L[I]];if(!B.extras)continue;let j=null;R.id in M&&(j=h6(P[M[R.id]].meshes,R.matrix)),j||(j=d6(B)),j&&(R.footprint=u6(j))}if(D.size>0){const I=Array.from(D.values()).sort((R,B)=>R-B);for(let R=I.length-1;R>=0;R--)P.splice(I[R],1)}}(T,v,c.json.nodes),T}function f6(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const n=c.vertexArray.float32,s=c.aabb.min[0]-1,u=c.aabb.min[1]-1,g=Kd/(c.aabb.max[0]-s+2),h=Kd/(c.aabb.max[1]-u+2);for(let v=0;v<n.length;v+=3){const T=n[v+2],P=(n[v+0]-s)*g|0,L=(n[v+1]-u)*h|0;T>c.heightmap[L*Kd+P]&&(c.heightmap[L*Kd+P]=T)}}function p6(c,n){const s={};s.indexArray=new Ii,s.indexArray.reserve(4*c.length),s.vertexArray=new Dl,s.vertexArray.reserve(10*c.length),s.colorArray=new Za,s.vertexArray.reserve(10*c.length);let u=0;for(const v of c){const T=Math.min(10,Math.max(4,1.3*v.height))*n,P=[-v.normal[1],v.normal[0],0],L=Math.min(.29,.1*v.width/v.depth),w=v.width-2*v.depth*n*(L+.01),M=Pe.vec3.scaleAndAdd([],v.pos,P,w/2),D=Pe.vec3.scaleAndAdd([],v.pos,P,-w/2),I=[M[0],M[1],M[2]+v.height],R=[D[0],D[1],D[2]+v.height],B=Pe.vec3.scaleAndAdd([],v.normal,P,L);Pe.vec3.scale(B,B,T);const j=Pe.vec3.scaleAndAdd([],v.normal,P,-L);Pe.vec3.scale(j,j,T),Pe.vec3.add(B,M,B),Pe.vec3.add(j,D,j),M[2]+=.1,D[2]+=.1,s.vertexArray.emplaceBack(B[0],B[1],B[2]),s.vertexArray.emplaceBack(j[0],j[1],j[2]),s.vertexArray.emplaceBack(M[0],M[1],M[2]),s.vertexArray.emplaceBack(D[0],D[1],D[2]),s.vertexArray.emplaceBack(I[0],I[1],I[2]),s.vertexArray.emplaceBack(R[0],R[1],R[2]),s.vertexArray.emplaceBack(M[0],M[1],M[2]),s.vertexArray.emplaceBack(D[0],D[1],D[2]),s.vertexArray.emplaceBack(B[0],B[1],B[2]),s.vertexArray.emplaceBack(j[0],j[1],j[2]);const K=w/T/2;s.colorArray.emplaceBack(-K-L,-1,K,.8),s.colorArray.emplaceBack(K+L,-1,K,.8),s.colorArray.emplaceBack(-K,0,K,1.3),s.colorArray.emplaceBack(K,0,K,1.3),s.colorArray.emplaceBack(K+L,-.8,K,.7),s.colorArray.emplaceBack(K+L,-.8,K,.7),s.colorArray.emplaceBack(0,0,K,1.3),s.colorArray.emplaceBack(0,0,K,1.3),s.colorArray.emplaceBack(K+L,-1.2,K,.8),s.colorArray.emplaceBack(K+L,-1.2,K,.8),s.indexArray.emplaceBack(6+u,4+u,8+u),s.indexArray.emplaceBack(7+u,9+u,5+u),s.indexArray.emplaceBack(0+u,1+u,2+u),s.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const g={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=co.white,g.pbrMetallicRoughness=h,s.material=g,s.aabb=new Ro([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}class Tk{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const u=n[s];this._stringToNumber[u]=s,this._numberToString[s]=u}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const m6=["id","tile","layer","source","sourceLayer","state"];class Ck{constructor(n,s,u,g,h){this.type="Feature",this._vectorTileFeature=n,this._z=s,this._x=u,this._y=g,this.properties=n.properties,this.id=h}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const s of m6)this[s]!==void 0&&(n[s]=this[s]);return n}}class Ek{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new dc(An,16,0),this.featureIndexArray=new ay,this.promoteId=s,this.is3DTile=!1}insert(n,s,u,g,h,v=0,T=0){const P=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,g,h,v);const L=this.grid;for(let w=0;w<s.length;w++){const M=s[w],D=[1/0,1/0,-1/0,-1/0];for(let I=0;I<M.length;I++){const R=M[I];D[0]=Math.min(D[0],R.x),D[1]=Math.min(D[1],R.y),D[2]=Math.max(D[2],R.x),D[3]=Math.max(D[3],R.y)}T!==0&&(D[0]-=T,D[1]-=T,D[2]+=T,D[3]+=T),D[0]<An&&D[1]<An&&D[2]>=0&&D[3]>=0&&L.insert(P,D[0],D[1],D[2],D[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Vf.VectorTile(new ky(this.rawTileData)).layers,this.sourceLayerCoder=new Tk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,s,u,g){this.loadVTLayers();const h=n.params||{},v=sa(h.filter),T=n.tileResult,P=n.transform,L=T.bufferedTilespaceBounds,w=this.grid.query(L.min.x,L.min.y,L.max.x,L.max.y,(R,B,j,K)=>Vs(T.bufferedTilespaceGeometry,R,B,j,K));w.sort(g6);let M=null;P.elevation&&w.length>0&&(M=Kf.create(P.elevation,this.tileID));const D={};let I;for(let R=0;R<w.length;R++){const B=w[R];if(B===I)continue;I=B;const j=this.featureIndexArray.get(B);let K=null;if(this.is3DTile){const ne=this.bucketLayerIDs[0][0],oe=s[ne];if(oe.type!=="model")continue;const{queryFeature:Y,intersectionZ:ae}=oe.queryIntersectsMatchingFeature(T,j.featureIndex,v,P);Y&&this.appendToResult(D,ne,j.featureIndex,Y,ae)}else this.loadMatchingFeature(D,j,v,h.layers,h.availableImages,s,u,g,(ne,oe,Y,ae=0)=>(K||(K=bn(ne,this.tileID.canonical,n.tileTransform)),oe.queryIntersectsFeature(T,ne,Y,K,this.z,n.transform,n.pixelPosMatrix,M,ae)))}return D}loadMatchingFeature(n,s,u,g,h,v,T,P,L){const{featureIndex:w,bucketIndex:M,sourceLayerIndex:D,layoutVertexArrayOffset:I}=s,R=this.bucketLayerIDs[M];if(g&&!function(ne,oe){for(let Y=0;Y<ne.length;Y++)if(oe.indexOf(ne[Y])>=0)return!0;return!1}(g,R))return;const B=this.sourceLayerCoder.decode(D),j=this.vtLayers[B].feature(w);if(u.needGeometry){const ne=wn(j,!0);if(!u.filter(new Ko(this.tileID.overscaledZ),ne,this.tileID.canonical))return}else if(!u.filter(new Ko(this.tileID.overscaledZ),j))return;const K=this.getId(j,B);for(let ne=0;ne<R.length;ne++){const oe=R[ne];if(g&&g.indexOf(oe)<0)continue;const Y=v[oe];if(!Y)continue;let ae={};K!==void 0&&P&&(ae=P.getState(Y.sourceLayer||"_geojsonTileLayer",K));const me=!L||L(j,Y,ae,I);if(!me)continue;const Ee=new Ck(j,this.z,this.x,this.y,K),Oe=ar({},T[oe]);Oe.paint=Mk(Oe.paint,Y.paint,j,ae,h),Oe.layout=Mk(Oe.layout,Y.layout,j,ae,h),Ee.layer=Oe,this.appendToResult(n,oe,w,Ee,me)}}appendToResult(n,s,u,g,h){let v=n[s];v===void 0&&(v=n[s]=[]),v.push({featureIndex:u,feature:g,intersectionZ:h})}lookupSymbolFeatures(n,s,u,g,h,v,T,P){const L={};this.loadVTLayers();const w=sa(h);for(const M of n)this.loadMatchingFeature(L,{bucketIndex:u,sourceLayerIndex:g,featureIndex:M,layoutVertexArrayOffset:0},w,v,T,P,s);return L}loadFeature(n){const{featureIndex:s,sourceLayerIndex:u}=n;this.loadVTLayers();const g=this.sourceLayerCoder.decode(u),h=this.vtFeatures[g];if(h[s])return h[s];const v=this.vtLayers[g].feature(s);return h[s]=v,v}hasLayer(n){for(const s of this.bucketLayerIDs)for(const u of s)if(n===u)return!0;return!1}getId(n,s){let u=n.id;if(this.promoteId){const g=typeof this.promoteId=="string"?this.promoteId:this.promoteId[s];g!=null&&(u=n.properties[g]),typeof u=="boolean"&&(u=Number(u))}return u}}function Mk(c,n,s,u,g){return tn(c,(h,v)=>{const T=n instanceof hu?n.get(v):null;return T&&T.evaluate?T.evaluate(s,u,g):T})}function g6(c,n){return n-c}Gn(Ek,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const Ik=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Hx{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,u]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=u>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const h=Ik[15&u];if(!h)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(n,2,1),[T]=new Uint32Array(n,4,1);return new Hx(T,v,h,n)}constructor(n,s=64,u=Float64Array,g){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=u,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const h=Ik.indexOf(this.ArrayType),v=2*n*this.ArrayType.BYTES_PER_ELEMENT,T=n*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-T%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${u}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+T+P,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+v+T+P),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+T+P,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=n,this.coords[this._pos++]=s,u}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Gx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,u,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:v,nodeSize:T}=this,P=[0,h.length-1,0],L=[];for(;P.length;){const w=P.pop()||0,M=P.pop()||0,D=P.pop()||0;if(M-D<=T){for(let j=D;j<=M;j++){const K=v[2*j],ne=v[2*j+1];K>=n&&K<=u&&ne>=s&&ne<=g&&L.push(h[j])}continue}const I=D+M>>1,R=v[2*I],B=v[2*I+1];R>=n&&R<=u&&B>=s&&B<=g&&L.push(h[I]),(w===0?n<=R:s<=B)&&(P.push(D),P.push(I-1),P.push(1-w)),(w===0?u>=R:g>=B)&&(P.push(I+1),P.push(M),P.push(1-w))}return L}within(n,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:h,nodeSize:v}=this,T=[0,g.length-1,0],P=[],L=u*u;for(;T.length;){const w=T.pop()||0,M=T.pop()||0,D=T.pop()||0;if(M-D<=v){for(let j=D;j<=M;j++)Ak(h[2*j],h[2*j+1],n,s)<=L&&P.push(g[j]);continue}const I=D+M>>1,R=h[2*I],B=h[2*I+1];Ak(R,B,n,s)<=L&&P.push(g[I]),(w===0?n-u<=R:s-u<=B)&&(T.push(D),T.push(I-1),T.push(1-w)),(w===0?n+u>=R:s+u>=B)&&(T.push(I+1),T.push(M),T.push(1-w))}return P}}function Gx(c,n,s,u,g,h){if(g-u<=s)return;const v=u+g>>1;kk(c,n,v,u,g,h),Gx(c,n,s,u,v-1,1-h),Gx(c,n,s,v+1,g,1-h)}function kk(c,n,s,u,g,h){for(;g>u;){if(g-u>600){const L=g-u+1,w=s-u+1,M=Math.log(L),D=.5*Math.exp(2*M/3),I=.5*Math.sqrt(M*D*(L-D)/L)*(w-L/2<0?-1:1);kk(c,n,s,Math.max(u,Math.floor(s-w*D/L+I)),Math.min(g,Math.floor(s+(L-w)*D/L+I)),h)}const v=n[2*s+h];let T=u,P=g;for(jg(c,n,u,s),n[2*g+h]>v&&jg(c,n,u,g);T<P;){for(jg(c,n,T,P),T++,P--;n[2*T+h]<v;)T++;for(;n[2*P+h]>v;)P--}n[2*u+h]===v?jg(c,n,u,P):(P++,jg(c,n,P,g)),P<=s&&(u=P+1),s<=P&&(g=P-1)}}function jg(c,n,s,u){Wx(c,s,u),Wx(n,2*s,2*u),Wx(n,2*s+1,2*u+1)}function Wx(c,n,s){const u=c[n];c[n]=c[s],c[s]=u}function Ak(c,n,s,u){const g=c-s,h=n-u;return g*g+h*h}o.$=X_,o.A=class extends Ky{},o.B=ac,o.C=Hc,o.D=Od,o.E=jc,o.F=Nm,o.G=ff,o.H=U_,o.I=mx,o.J=gf,o.K=Cf,o.L=q_,o.M=Pd,o.N=of,o.O=Td,o.P=et,o.Q=Sd,o.R=$c,o.S=ls,o.T=Mx,o.U=dm,o.V=Ky,o.W=Zm,o.X=pf,o.Y=Fm,o.Z=function(c){const n=c.value;let s=[];if(!n)return s;const u=ac(n);return u!=="string"?(s=s.concat([new Ky(c.key,n,`string expected, "${u}" found`)]),s):($I(n,!0)||(s=s.concat([new Ky(c.key,n,`invalid url "${n}"`)])),s)},o._=Dt,o.a=function(c){return lt.API_CDN_URL_REGEX.test(c)},o.a$=og,o.a0=$o,o.a1=Sn,o.a2=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return mo(c.expression.evaluate(n))}interpolate(c,n,s){return{x:pr(c.x,n.x,s),y:pr(c.y,n.y,s),z:pr(c.z,n.z,s),azimuthal:pr(c.azimuthal,n.azimuthal,s),polar:pr(c.polar,n.polar,s)}}},o.a3=Ko,o.a4=Sa,o.a5=Ct,o.a6=Pe,o.a7=jn,o.a8=hu,o.a9=Su,o.aA=Po,o.aB=MI,o.aC=DI,o.aD=EI,o.aE=function(c,n){const s=document.createElement("video");s.muted=!0,s.onloadstart=function(){n(null,s)};for(let u=0;u<c.length;u++){const g=document.createElement("source");$s(c[u])||(s.crossOrigin="Anonymous"),g.src=c[u],s.appendChild(g)}return{cancel:()=>{}}},o.aF=jy,o.aG=function(c){return fetch(c).then(n=>n.arrayBuffer()).then(n=>xk(n,0,c))},o.aH=Sk,o.aI=class{constructor(c,n,s,u){this.id=c,this.position=n!=null?new re(n[0],n[1]):new re(0,0),this.orientation=s??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new Ro([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(c,n){if(Pe.mat4.multiply(c.matrix,n,c.matrix),c.meshes)for(const s of c.meshes){const u=Ro.applyTransformFast(s.aabb,c.matrix);this.aabb.encapsulate(u)}if(c.children)for(const s of c.children)this._applyTransformations(s,c.matrix)}computeBoundsAndApplyParent(){const c=Pe.mat4.identity([]);for(const n of this.nodes)this._applyTransformations(n,c)}computeModelMatrix(c,n,s,u,g,h,v=!1){GI(this.matrix,this,c.transform,this.position,n,s,u,g,h,v)}upload(c){if(!this.uploaded){for(const n of this.nodes)Rx(n,c);for(const n of this.nodes)Zy(n);this.uploaded=!0}}destroy(){for(const c of this.nodes)Dx(c)}},o.aJ=_n,o.aK=Ig,o.aL=je,o.aM=Ue,o.aN=Rl,o.aO=Ii,o.aP=Xr,o.aQ=Of,o.aR=Vy,o.aS=function(){us.isLoading()||us.isLoaded()||Wm()!=="deferred"||qm()},o.aT=sa,o.aU=wn,o.aV=Ck,o.aW=Rr,o.aX=ax,o.aY=X1,o.aZ=bn,o.a_=Pl,o.aa=pr,o.ab=An,o.ac=vd,o.ad=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return function([s,u]){const g=mo([1,s,u]);return{x:g.x,y:g.y,z:g.z}}(c.expression.evaluate(n))}interpolate(c,n,s){return{x:pr(c.x,n.x,s),y:pr(c.y,n.y,s),z:pr(c.z,n.z,s)}}},o.ae=function(c,n,s=0,u=!0){const g=new et(s,s),h=c.sub(g),v=n.add(g),T=[h,new et(v.x,h.y),v,new et(h.x,v.y)];return u&&T.push(h.clone()),T},o.af=function(c,n){const s=[];for(let u=0;u<c.length;u++){const g=ir(u-1,-1,c.length-1),h=ir(u+1,-1,c.length-1),v=c[u],T=c[h],P=c[g].sub(v).unit(),L=T.sub(v).unit(),w=L.angleWithSep(P.x,P.y),M=P.add(L).unit().mult(-1*n/Math.sin(w/2));s.push(v.add(M))}return s},o.ag=hI,o.ah=Vs,o.ai=function(c,n,s=0){return Pe.vec3.fromValues(((n.x-s)*c.scale-c.x)*An,(n.y*c.scale-c.y)*An,rt(n.z,n.y))},o.aj=Qa,o.ak=RM,o.al=function(c){let n=1/0,s=1/0,u=-1/0,g=-1/0;for(const h of c)n=Math.min(n,h.x),s=Math.min(s,h.y),u=Math.max(u,h.x),g=Math.max(g,h.y);return{min:new et(n,s),max:new et(u,g)}},o.am=ze,o.an=Lo,o.ao=cn,o.ap=Zt,o.aq=r,o.ar=function(c,n){const s={};for(let u=0;u<n.length;u++){const g=n[u];g in c&&(s[g]=c[g])}return s},o.as=ve,o.at=Ne,o.au=class{constructor(c){this.entries={},this.scheduler=c}request(c,n,s,u){const g=this.entries[c]=this.entries[c]||{callbacks:[]};if(g.result){const[h,v]=g.result;return this.scheduler?this.scheduler.add(()=>{u(h,v)},n):u(h,v),()=>{}}return g.callbacks.push(u),g.cancel||(g.cancel=s((h,v)=>{g.result=[h,v];for(const T of g.callbacks)this.scheduler?this.scheduler.add(()=>{T(h,v)},n):T(h,v);setTimeout(()=>delete this.entries[c],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(h=>h!==u),g.callbacks.length||(g.cancel(),delete this.entries[c]))}}},o.av=ty,o.aw=function(c,n,s){const u=JSON.stringify(c.request);return c.data&&(this.deduped.entries[u]={result:[null,c.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},g=>{const h=Vc(c.request,(v,T,P,L)=>{v?g(v):T&&g(null,{vectorTile:s?void 0:new Vf.VectorTile(new ky(T)),rawData:T,cacheControl:P,expires:L})});return()=>{h.cancel(),g()}},n)},o.ax=function(c){go++,go>Wr&&(c.getActor().send("enforceCacheSizeLimit",fr),go=0)},o.ay=vn,o.az=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},o.b=function(c){return lt.API_FONTS_REGEX.test(c)},o.b$=function(c){const{x:n,y:s}=c.point,{lng:u,lat:g}=c._center;return TE(n,s,c.worldSize,u,g)},o.b0=js,o.b1=Zo,o.b2=pg,o.b3=Tx,o.b4=function(c,n){const s=Su(n.zoom);if(s===0)return Bl(c);const u=my(c),g=U1(u),h=ze(u.getWest())*n.worldSize,v=ze(u.getEast())*n.worldSize,T=Ne(u.getNorth())*n.worldSize,P=Ne(u.getSouth())*n.worldSize,L=[h,T,0],w=[v,T,0],M=[h,P,0],D=[v,P,0],I=Pe.mat4.invert([],n.globeMatrix);return Pe.vec3.transformMat4(L,L,I),Pe.vec3.transformMat4(w,w,I),Pe.vec3.transformMat4(M,M,I),Pe.vec3.transformMat4(D,D,I),g[0]=yc(g[0],M,s),g[1]=yc(g[1],D,s),g[2]=yc(g[2],w,s),g[3]=yc(g[3],L,s),Ro.fromPoints(g)},o.b5=vy,o.b6=hg,o.b7=yc,o.b8=kf,o.b9=ds,o.bA=ir,o.bB=Mt,o.bC=Ns,o.bD=Le,o.bE=function(c,n,s){c[4*n+0]=s[0],c[4*n+1]=s[1],c[4*n+2]=s[2],c[4*n+3]=s[3]},o.bF=Hd,o.bG=Ta,o.bH=lg,o.bI=ji,o.bJ=gc,o.bK=re,o.bL=vI,o.bM=vi,o.bN=wu,o.bO=OI,o.bP=bi,o.bQ=xE,o.bR=function(c,n,s,u,g,h,v,T,P){if(P.name==="globe")return xE(c,n,new bi(s,u,g),!1);const L=Ig({z:s,x:u,y:g},P);return new Ro([(h+L.x/L.scale)*n,n*(L.y/L.scale),v],[(h+L.x2/L.scale)*n,n*(L.y2/L.scale),T])},o.bS=function(c,n,s){let u=0;for(let g=0;g<2;++g)c[g]>0&&(u+=(c[g]-0)*(c[g]-0)),n[g]<0&&(u+=(0-n[g])*(0-n[g]));return u},o.bT=Qe,o.bU=p,o.bV=function(c){const n=Pe.mat4.identity(new Float64Array(16));Pe.mat4.multiply(n,c.pixelMatrix,c.globeMatrix);const s=[0,O,0],u=[0,V,0];return Pe.vec3.transformMat4(s,s,n),Pe.vec3.transformMat4(u,u,n),[s[0]>0&&s[0]<=c.width&&s[1]>0&&s[1]<=c.height&&!G1(c,new re(c.center.lat,90)),u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!G1(c,new re(c.center.lat,-90))]},o.bW=function(c,n){const{scale:s}=c.tileTransform,u=s*An/(c.tileSize*Math.pow(2,n.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return Pe.mat2.scale(new Float32Array(4),n.inverseAdjustmentMatrix,[u,u])},o.bX=Wy,o.bY=LI,o.bZ=function(c){const n=LI(c,!0);return Pe.mat2.invert([],[n[0],n[1],n[4],n[5]])},o.b_=zl,o.ba=Fx,o.bb=ky,o.bc=Vc,o.bd=function(c){const n=[];for(const s in c)n.push(c[s]);return n},o.be=function(c,n){const s=[];for(const u in c)u in n||s.push(u);return s},o.bf=ur,o.bg=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.bh=rn,o.bi=function(c,n){const{x:s,y:u}=c.point,g=TE(s,u,c.worldSize/c._pixelsPerMercatorPixel,0,0);return Pe.mat4.multiply(g,g,j1(Bl(n)))},o.bj=Uf,o.bk=la,o.bl=Iy,o.bm=function(c,n,s,u,g){const h=5*n+2;c.float32[h+0]=s,c.float32[h+1]=u,c.float32[h+2]=g},o.bn=$y,o.bo=tI,o.bp=Mn,o.bq=Ri,o.br=rM,o.bs=NI,o.bt=lM,o.bu=cM,o.bv=_x,o.bw=lI,o.bx=px,o.by=Hx,o.bz=co,o.c=xt,o.c$=Qi,o.c0=en,o.c1=Ji,o.c2=l,o.c3=function(c){const n=Math.round((c+45+360)%360/90)%4;return sn[n]},o.c4=45,o.c5=we,o.c6=Ff,o.c7=function(c,n,s){const u=Math.sqrt(c*c+n*n+s*s),g=u>0?Math.acos(s/u)*zt:0;let h=c!==0||n!==0?Math.atan2(-n,-c)*zt+90:0;return h<0&&(h+=360),[u,h,g]},o.c8=ct,o.c9=Ro,o.cA=function(c){const n=Qe-5;c=Zt(c,-n,n)/n*90;const s=Math.pow(Math.abs(Math.sin(Mt(c))),3);return Math.round(s*(E.length-1))},o.cB=function(c,n,s,u){const g=n.getNorth(),h=n.getSouth(),v=n.getWest(),T=n.getEast(),P=1<<c.z,L=T-v,w=g-h,M=L/S,D=-w/E[s],I=[0,M,0,D,0,0,g,v,0];if(c.z>0){const R=180/u;Pe.mat3.multiply(I,I,[R/L+1,0,0,0,R/w+1,0,-.5*R/M,.5*R/D,1])}return I[2]=P,I[5]=c.x,I[8]=c.y,I},o.cC=Bl,o.cD=function(c,n,s){const u=Pe.mat4.identity(new Float64Array(16)),g=(n/(1<<c)-.5)*Math.PI*2;return Pe.mat4.rotateY(u,s.globeMatrix,g),Float32Array.from(u)},o.cE=class{isDataAvailableAtPoint(c){const n=this._source();if(this.isUsingMockSource()||!n||c.y<0||c.y>1)return!1;const s=n.getSource().maxzoom,u=1<<s,g=Math.floor(c.x),h=Math.floor((c.x-g)*u),v=Math.floor(c.y*u),T=this.findDEMTileFor(new Po(s,g,s,h,v));return!(!T||!T.dem)}getAtPointOrZero(c,n=0){return this.getAtPoint(c,n)||0}getAtPoint(c,n,s=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const u=this._source();if(!u||c.y<0||c.y>1)return n;const g=u.getSource().maxzoom,h=1<<g,v=Math.floor(c.x),T=c.x-v,P=new Po(g,v,g,Math.floor(T*h),Math.floor(c.y*h)),L=this.findDEMTileFor(P);if(!L||!L.dem)return n;const w=L.dem,M=1<<L.tileID.canonical.z,D=(T*M-L.tileID.canonical.x)*w.dim,I=(c.y*M-L.tileID.canonical.y)*w.dim,R=Math.floor(D),B=Math.floor(I);return(s?this.exaggeration():1)*pr(pr(w.get(R,B),w.get(R,B+1),I-B),pr(w.get(R+1,B),w.get(R+1,B+1),I-B),D-R)}getAtTileOffset(c,n,s){const u=1<<c.canonical.z;return this.getAtPointOrZero(new Ct(c.wrap+(c.canonical.x+n/An)/u,(c.canonical.y+s/An)/u))}getAtTileOffsetFunc(c,n,s,u){return g=>{const h=this.getAtTileOffset(c,g.x,g.y),v=u.upVector(c.canonical,g.x,g.y),T=u.upVectorScale(c.canonical,n,s).metersToTile;return Pe.vec3.scale(v,v,h*T),v}}getForTilePoints(c,n,s,u){if(this.isUsingMockSource())return!1;const g=Kf.create(this,c,u);return!!g&&(n.forEach(h=>{h[2]=this.exaggeration()*g.getElevationAt(h[0],h[1],s)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(c);if(!n||!n.dem)return null;const s=n.dem.tree,u=n.tileID,g=1<<c.canonical.z-u.canonical.z;let h=c.canonical.x/g-u.canonical.x,v=c.canonical.y/g-u.canonical.y,T=0;for(let P=0;P<c.canonical.z-u.canonical.z&&!s.leaves[T];P++){h*=2,v*=2;const L=2*Math.floor(v)+Math.floor(h);T=s.childOffsets[T]+L,h%=1,v%=1}return{min:this.exaggeration()*s.minimums[T],max:this.exaggeration()*s.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,n,s){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let n=!1,s=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const g of c){const h=this.getMinMaxForTile(g.tileID);h&&(s=Math.min(s,h.min),u=Math.max(u,h.max),n=!0)}return n?{min:s,max:u}:null}},o.cF=BE,o.cG=_c,o.cH=function(c,n){return[Math.pow(c[0],2.2)*n,Math.pow(c[1],2.2)*n,Math.pow(c[2],2.2)*n]},o.cI=SE,o.cJ=Ke,o.cK=ke,o.cL=256,o.cM=function(c,n){const s=[0,0,0],u=vy(Bl(n.canonical));return Pe.vec3.transformMat4(s,s,u),Pe.vec3.transformMat4(s,s,c),s},o.cN=c=>({u_camera_to_center_distance:new ji(c),u_extrude_scale:new ug(c),u_device_pixel_ratio:new ji(c),u_matrix:new Hd(c),u_inv_rot_matrix:new Hd(c),u_merc_center:new Ta(c),u_tile_id:new lg(c),u_zoom_transition:new ji(c),u_up_dir:new lg(c),u_emissive_strength:new ji(c)}),o.cO=c=>({u_matrix:new Hd(c),u_pixels_to_tile_units:new ug(c),u_device_pixel_ratio:new ji(c),u_units_to_pixels:new Ta(c),u_dash_image:new gc(c),u_gradient_image:new gc(c),u_image_height:new ji(c),u_texsize:new Ta(c),u_tile_units_to_pixels:new ji(c),u_alpha_discard_threshold:new ji(c),u_trim_offset:new Ta(c),u_trim_fade_range:new Ta(c),u_trim_color:new Ff(c),u_emissive_strength:new ji(c)}),o.cP=c=>({u_matrix:new Hd(c),u_texsize:new Ta(c),u_pixels_to_tile_units:new ug(c),u_device_pixel_ratio:new ji(c),u_image:new gc(c),u_units_to_pixels:new Ta(c),u_tile_units_to_pixels:new ji(c),u_alpha_discard_threshold:new ji(c),u_trim_offset:new Ta(c)}),o.cQ=Xi,o.cR=FF,o.cS=NF,o.cT=ME,o.cU=(c,n,s,u,g,h)=>{const v=c.transform,T=v.projection.name==="globe";let P;if(h.paint.get("circle-pitch-alignment")==="map")if(T){const w=SE(v.zoom,n.canonical)*v._pixelsPerMercatorPixel;P=Float32Array.from([w,0,0,w])}else P=v.calculatePixelsToTileUnitsMatrix(s);else P=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const L={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(v.projection),u_matrix:c.translatePosMatrix(n.projMatrix,s,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Cn.devicePixelRatio,u_extrude_scale:P,u_inv_rot_matrix:UB,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(T){L.u_inv_rot_matrix=u,L.u_merc_center=g,L.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],L.u_zoom_transition=Su(v.zoom);const w=g[0]*An,M=g[1]*An;L.u_up_dir=v.projection.upVector(new bi(0,0,0),w,M)}return L},o.cV=OM,o.cW=(c,n,s,u,g,h)=>{const v=c.transform;return{u_matrix:LM(c,n,s,u),u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:v.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:g,u_image:0,u_tile_units_to_pixels:DM(n,v),u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:h}},o.cX=(c,n,s,u,g,h,v)=>{const T=c.transform,P=T.calculatePixelsToTileUnitsMatrix(n);return{u_matrix:LM(c,n,s,u),u_pixels_to_tile_units:P,u_device_pixel_ratio:h,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:g,u_texsize:zM(s)&&n.lineAtlasTexture?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:DM(n,c.transform),u_alpha_discard_threshold:0,u_trim_offset:v,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength")}},o.cY=Rt,o.cZ=fg,o.c_=wM,o.ca=mo,o.cb=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},o.cc=function(c){return c({pluginStatus:wi,pluginURL:Al}),Gm.on("pluginStateChange",c),c},o.cd=Zf,o.ce=Jy,o.cf=Hf,o.cg=gx,o.ch=sm,o.ci=Y_,o.cj=hr,o.ck=ss,o.cl=gn,o.cm=function(c){const n=c.indexOf(pu);return n>=0?c.slice(0,n):c},o.cn=function(c){return c.indexOf(pu)>=0},o.co=function(c){const n=c.indexOf(pu);return n>=0?c.slice(n+1):""},o.cp=function(c){const n=[],s=c.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),c.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},o.cq=function(c,n,s,u){return c.type==="custom"?new gN(c,n):new MN[c.type](c,n,s,u)},o.cr=Ze,o.cs=Gm,o.ct=pd,o.cu=cg,o.cv=class extends Ja{constructor(c){super(c),this.current=O1}set(c,n,s){if(this.fetchUniformLocation(c,n)){for(let u=0;u<9;u++)if(s[u]!==this.current[u]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},o.cw=dn,o.cx=function(c,n,s){const u=Su(s.zoom),g=c.style.map._antialias,h=n.options.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return u===0&&!g&&!h},o.cy=function(c){const n=c.pixelsPerMeter,s=n/Le(1,c.center.lat),u=Pe.mat4.identity(new Float64Array(16));return Pe.mat4.translate(u,u,[c.point.x,c.point.y,0]),Pe.mat4.scale(u,u,[s,s,n]),Float32Array.from(u)},o.cz=my,o.d=function(c){return lt.API_TILEJSON_REGEX.test(c)},o.d$=C,o.d0=My,o.d1=Cu,o.d2=450,o.d3=7,o.d4=mN,o.d5=oo,o.d6=Df,o.d7=256,o.d8=j1,o.d9=Dl,o.dA=CE,o.dB=function(c){const n=[0,0,0],s=Pe.mat4.identity(new Float64Array(16));return Pe.mat4.multiply(s,c.pixelMatrix,c.globeMatrix),Pe.vec3.transformMat4(n,n,s),new et(n[0],n[1])},o.dC=function(c,n,s=!1){if(wi===Dd||wi===Ld||wi===Sf)throw new Error("setRTLTextPlugin cannot be called multiple times.");Al=Cn.resolveURL(c),wi=Dd,uu=n,Hm(),s||qm()},o.dD=Wm,o.dE=function(){Jy().acquire(Nx)},o.dF=function(){const c=$g;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(Nx),$g=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},o.dG=Ng,o.dH=function(c){const n=Jn();if(!n)return;const s=n.delete(dr);c&&s.catch(c).then(()=>c())},o.dI=Fg,o.dJ=pk,o.dK=function(c){$x=Cn.resolveURL(c),Jf||(Jf=new Zf(Jy(),new jc)),Jf.broadcast("setDracoUrl",$x)},o.dL=mk,o.dM=function(c){Xf=Cn.resolveURL(c),Jf||(Jf=new Zf(Jy(),new jc)),Jf.broadcast("setMeshoptUrl",Xf)},o.dN=Gn,o.dO=Tu,o.dP=tl,o.dQ=Tk,o.dR=Ek,o.dS=IM,o.dT=tn,o.dU=rI,o.dV=function(c,n,s,u,g,h,v,T,P,L,w){c.createArrays(),c.tilePixelRatio=An/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const M=c.layers[0].layout,D=c.layers[0]._unevaluatedLayout._values,I={};if(c.textSizeData.kind==="composite"){const{minZoom:K,maxZoom:ne}=c.textSizeData;I.compositeTextSizes=[D["text-size"].possiblyEvaluate(new Ko(K),T),D["text-size"].possiblyEvaluate(new Ko(ne),T)]}if(c.iconSizeData.kind==="composite"){const{minZoom:K,maxZoom:ne}=c.iconSizeData;I.compositeIconSizes=[D["icon-size"].possiblyEvaluate(new Ko(K),T),D["icon-size"].possiblyEvaluate(new Ko(ne),T)]}I.layoutTextSize=D["text-size"].possiblyEvaluate(new Ko(P+1),T),I.layoutIconSize=D["icon-size"].possiblyEvaluate(new Ko(P+1),T),I.textMaxSize=D["text-size"].possiblyEvaluate(new Ko(18),T);const R=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point",B=M.get("text-size");let j=!1;for(const K of c.features)if(K.icon&&K.icon.nameSecondary){j=!0;break}for(const K of c.features){const ne=M.get("text-font").evaluate(K,{},T).join(","),oe=B.evaluate(K,{},T),Y=I.layoutTextSize.evaluate(K,{},T),ae=(I.layoutIconSize.evaluate(K,{},T),{horizontal:{},vertical:void 0}),me=K.text;let Ee,Oe=[0,0];if(me){const Xe=me.toString(),$e=M.get("text-letter-spacing").evaluate(K,{},T)*Ri,tt=M.get("text-line-height").evaluate(K,{},T)*Ri,ft=S1(Xe)?$e:0,vt=M.get("text-anchor").evaluate(K,{},T),yt=M.get("text-variable-anchor");if(!yt){const un=M.get("text-radial-offset").evaluate(K,{},T);Oe=un?lI(vt,[un*Ri,vx]):M.get("text-offset").evaluate(K,{},T).map(Gt=>Gt*Ri)}let wt=R?"center":M.get("text-justify").evaluate(K,{},T);const Bt=M.get("symbol-placement")==="point",St=Bt?M.get("text-max-width").evaluate(K,{},T)*Ri:1/0,Xt=un=>{c.allowVerticalPlacement&&bf(Xe)&&(ae.vertical=fx(me,n,s,g,ne,St,tt,vt,un,ft,Oe,la.vertical,!0,Y,oe))};if(!R&&yt){const un=wt==="auto"?yt.map(On=>_x(On)):[wt];let Gt=!1;for(let On=0;On<un.length;On++){const In=un[On];if(!ae.horizontal[In])if(Gt)ae.horizontal[In]=ae.horizontal[0];else{const xn=fx(me,n,s,g,ne,St,tt,"center",In,ft,Oe,la.horizontal,!1,Y,oe);xn&&(ae.horizontal[In]=xn,Gt=xn.positionedLines.length===1)}}Xt("left")}else{if(wt==="auto"&&(wt=_x(vt)),Bt||M.get("text-writing-mode").indexOf("horizontal")>=0||!bf(Xe)){const un=fx(me,n,s,g,ne,St,tt,vt,wt,ft,Oe,la.horizontal,!1,Y,oe);un&&(ae.horizontal[wt]=un)}Xt(Bt?"left":wt)}}let Be=!1;if(K.icon&&K.icon.namePrimary){const Xe=u[K.icon.namePrimary];Xe&&(Ee=ZF(g[K.icon.namePrimary],K.icon.nameSecondary?g[K.icon.nameSecondary]:void 0,M.get("icon-offset").evaluate(K,{},T),M.get("icon-anchor").evaluate(K,{},T)),Be=Xe.sdf,c.sdfIcons===void 0?c.sdfIcons=Xe.sdf:c.sdfIcons!==Xe.sdf&&Hn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Xe.pixelRatio!==c.pixelRatio||M.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const De=uI(ae.horizontal)||ae.vertical;c.iconsInText||(c.iconsInText=!!De&&De.iconsInText),(De||Ee)&&nN(c,K,ae,Ee,u,I,Y,0,Oe,Be,v,T,L,w,j)}h&&c.generateCollisionDebugBuffers(P,c.collisionBoxArray)},o.dW=Vf,o.dX=Xy,o.dY=pt,o.dZ=QE,o.d_=UM,o.da=Xa,o.db=rg,o.dc=function(c,n,s,u,g){return Zt((c-n)/(s-n)*(g-u)+u,u,g)},o.dd=hf,o.de=gt,o.df=class{constructor(c,n,s,u){this.context=c,this.format=u,this.size=s,this.texture=c.gl.createTexture();const[g,h,v]=this.size,{gl:T}=c;T.bindTexture(T.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),T.texImage3D(T.TEXTURE_3D,0,this.format,g,h,v,0,Cx(this.format),Ex(this.format),n.data)}bind(c,n){const{context:s}=this,{gl:u}=s;u.bindTexture(u.TEXTURE_3D,this.texture),c!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,c),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,c),this.minFilter=c),n!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,n),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,n),this.wrapS=n)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},o.dg=Ax,o.dh=[1,1,1],o.di=Kf,o.dj=qf,o.dk=Ll,o.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new et(1/0,1/0),max:new et(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,n=!1){const s=iM(new et(0,0),new et(An,An),c),u=[];if(n&&!nx(s,this._globalClipBounds))return u;for(const g of this._activeRegions){if(g.hiddenByOverlap||!nx(s,g))continue;const h=dF(g.min,g.max,c);u.push({min:h.min,max:h.max,sourceId:this._sourceIds[g.priority],footprint:g.footprint,footprintTileId:g.tileId,order:g.order,clipMask:g.clipMask,clipScope:g.clipScope})}return u}setSources(c){this._setSources(c.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const s=[];for(const u of n.cache.getVisibleCoordinates()){const g=n.cache.getTile(u).buckets[n.layer];g&&g.updateFootprints(u.toUnwrapped(),s)}return s},getOrder:()=>n.order,getClipMask:()=>n.clipMask,getClipScope:()=>n.clipScope})))}_addSource(c){const n=c.getFootprints();if(n.length===0)return;const s=c.getOrder(),u=c.getClipMask(),g=c.getClipScope();for(const h of n){if(!h.footprint)continue;const v=iM(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint,order:s,clipMask:u,clipScope:g})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((n,s)=>n.priority-s.priority||Cy(n.min,s.min)||Cy(n.max,s.max)||n.order-s.order||n.clipMask-s.clipMask||function(u,g){const h=(v,T)=>v+T;return u.length-g.length||u.reduce(h,"").localeCompare(g.reduce(h,""))}(n.clipScope,s.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let n=0;for(;!c&&n!==this._activeRegions.length;){const s=this._activeRegions[n],u=this._prevRegions[n];c=s.priority!==u.priority||!oM(s,u)||s.order!==u.order||s.clipMask!==u.clipMask||!rn(s.clipScope,u.clipScope),++n}}if(c){++this._updateTime;for(const s of this._activeRegions)s.order!==Ty&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,s.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,s.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,s.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,s.max.y));const n=s=>{const u=this._activeRegions;if(s>=u.length)return s;const g=u[s].priority;for(;s<u.length&&u[s].priority===g;)++s;return s};if(this._sourceIds.length>1){let s=0,u=n(s);for(;s!==u;){let g=s;const h=s;for(;g!==u;){const v=this._activeRegions[g];v.hiddenByOverlap=!1;for(let T=0;T<h;T++){const P=this._activeRegions[T];if(!P.hiddenByOverlap&&v.order===Ty&&nx(v,P)&&(v.hiddenByOverlap=aM(v.footprint,v.tileId,P.footprint,P.tileId),v.hiddenByOverlap))break}++g}s=u,u=n(s)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=c.length-1;n>=0;n--)this._addSource(c[n]);this._computeReplacement()}},o.dm=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,n){const s=new Pl,u=new Ii,g=[],h=c+1+2,v=n[0]+1,T=n[0]+1+(1+n.length),P=(L,w,M)=>{let D=L===h-1?L-2:L===0?L:L-1;return D+=M?24575:0,[D,w]};for(let L=0;L<h;++L)s.emplaceBack(...P(L,0,!0));for(let L=0;L<v;++L)for(let w=0;w<h;++w)s.emplaceBack(...P(w,L,(w===0||w===h-1)&&!0));for(let L=0;L<n.length;++L){const w=n[L];for(let M=0;M<h;++M)s.emplaceBack(...P(M,w,!0))}for(let L=0;L<n.length;++L){const w=u.length,M=n[L]+1+2,D=new Ii;for(let B=0;B<M-1;B++){const j=B===M-2,K=j?h*(T-n.length+L-B):h;for(let ne=0;ne<h-1;ne++){const oe=B*h+ne;B===0||j||ne===0||ne===h-2?(D.emplaceBack(oe+1,oe,oe+K),D.emplaceBack(oe+K,oe+K+1,oe+1)):(u.emplaceBack(oe+1,oe,oe+K),u.emplaceBack(oe+K,oe+K+1,oe+1))}}const I=Zo.simpleSegment(0,w,s.length,u.length-w);for(let B=0;B<D.uint16.length;B+=3)u.emplaceBack(D.uint16[B],D.uint16[B+1],D.uint16[B+2]);const R=Zo.simpleSegment(0,w,s.length,u.length-w);g.push({withoutSkirts:I,withSkirts:R})}return{vertices:s,indices:u,segments:g}}_createGrid(c){const n=this._fillGridMeshWithLods(S,E);this._gridSegments=n.segments,this._gridBuffer=c.createVertexBuffer(n.vertices,js.members),this._gridIndexBuffer=c.createIndexBuffer(n.indices,!0)}_createPoles(c){const n=new Ii;for(let v=0;v<=S;v++)n.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=c.createIndexBuffer(n,!0);const s=new Xa,u=new Xa,g=new Xa,h=new Xa;this._poleSegments=[];for(let v=0,T=0;v<l;v++){const P=360/(1<<v);s.emplaceBack(0,-r,0,.5,0),u.emplaceBack(0,-r,0,.5,1),g.emplaceBack(0,-r,0,.5,.5),h.emplaceBack(0,-r,0,.5,.5);for(let L=0;L<=S;L++){let w=L/S,M=0;const D=pr(0,P,w),[I,R,B]=H($B,VB,D,r);s.emplaceBack(I,R,B,w,M),u.emplaceBack(I,R,B,w,1-M);const j=Mt(D);w=.5+.5*Math.sin(j),M=.5+.5*Math.cos(j),g.emplaceBack(I,R,B,w,M),h.emplaceBack(I,R,B,w,1-M)}this._poleSegments.push(Zo.simpleSegment(T,0,66,64)),T+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(s,Ms,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(u,Ms,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(g,Ms,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(h,Ms,!1)}getGridBuffers(c,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},o.dn=Ty,o.dp=Pn,o.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},o.dr=Ot,o.ds=ht,o.dt=W,o.du=function([c,n,s]){const u=Math.hypot(c,n,s),g=Math.atan2(c,s),h=.5*Math.PI-Math.acos(-n/u);return new re(en(g),en(h))},o.dv=kx,o.dw=J,o.dx=function(c){const n=c.navigator?c.navigator.userAgent:null;return!!function(s){if(_a==null){const u=s.navigator?s.navigator.userAgent:null;_a=!!s.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return _a}(c)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.dy=function(c,n){fr=c,Wr=n},o.dz=G1,o.e=lt,o.e0=function(c){let n=0;if(new Uint32Array(c,0,1)[0]!==vk){const s=new Uint32Array(c,0,7),[,,u,g,h,v]=s;n=s.byteLength+g+h+v+h,(u!==c.byteLength||n>=c.byteLength)&&Hn("Invalid b3dm header information.")}return xk(c,n)},o.e1=function(c,n){const s=Sk(c);for(const u of s){for(const g of u.meshes)f6(g);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(p6(u.lights,n)))}return s},o.e2=Yy,o.e3=XI,o.e4=us,o.e5=function(c){_r(),Ut!=null&&Ut.then(n=>{n.keys().then(s=>{for(let u=0;u<s.length-c;u++)n.delete(s[u])})})},o.f=function(c){return c.indexOf("mapbox:")===0},o.g=function(c,n){return pd(ar(c,{method:"GET"}),n)},o.h=nt,o.i=function(c){return lt.API_STYLE_REGEX.test(c)&&!xt(c)},o.j=function(c){return decodeURIComponent(atob(c).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))},o.k=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(n,s)=>String.fromCharCode(+("0x"+s))))},o.l=ar,o.m=jo,o.n=function(c,n){return pd(ar(c,{type:"json"}),n)},o.o=ya,o.p=function(c,n){return pd(ar(c,{method:"POST"}),n)},o.q=Cn,o.r=es,o.s=function(c){try{const n=self[c];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}},o.t=gd,o.u=function(){return function c(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},o.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},o.w=Hn,o.x=Tl,o.y=2,o.z=nI}),_(["./shared"],function(o){function C(Nt){const Te=Nt?Nt.url.toString():void 0;return Te?performance.getEntriesByName(Te):[]}function k(Nt){if(typeof Nt=="number"||typeof Nt=="boolean"||typeof Nt=="string"||Nt==null)return JSON.stringify(Nt);if(Array.isArray(Nt)){let ke="[";for(const Ke of Nt)ke+=`${k(Ke)},`;return`${ke}]`}let Te="{";for(const ke of Object.keys(Nt).sort())Te+=`${ke}:${k(Nt[ke])},`;return`${Te}}`}function A(Nt){let Te="";for(const ke of o.bg)Te+=`/${k(Nt[ke])}`;return Te}class z{constructor(Te){this.keyCache={},this._layers={},this._layerConfigs={},Te&&this.replace(Te)}replace(Te,ke){this._layerConfigs={},this._layers={},this.update(Te,[],ke)}update(Te,ke,Ke){this._options=Ke;for(const nt of Te)this._layerConfigs[nt.id]=nt,(this._layers[nt.id]=o.cq(nt,this.scope,null,this._options)).compileFilter(Ke),this.keyCache[nt.id]&&delete this.keyCache[nt.id];for(const nt of ke)delete this.keyCache[nt],delete this._layerConfigs[nt],delete this._layers[nt];this.familiesBySource={};const lt=function(nt,xt){const $t={};for(let Vt=0;Vt<nt.length;Vt++){const Yt=xt&&xt[nt[Vt].id]||A(nt[Vt]);xt&&(xt[nt[Vt].id]=Yt);let Je=$t[Yt];Je||(Je=$t[Yt]=[]),Je.push(nt[Vt])}const Tt=[];for(const Vt in $t)Tt.push($t[Vt]);return Tt}(o.bd(this._layerConfigs),this.keyCache);for(const nt of lt){const xt=nt.map(Pt=>this._layers[Pt.id]),$t=xt[0];if($t.visibility==="none")continue;const Tt=$t.source||"";let Vt=this.familiesBySource[Tt];Vt||(Vt=this.familiesBySource[Tt]={});const Yt=$t.sourceLayer||"_geojsonTileLayer";let Je=Vt[Yt];Je||(Je=Vt[Yt]=[]),Je.push(xt)}}}const N=1*o.dP;class ${constructor(Te){const ke={},Ke=[];for(const $t in Te){const Tt=Te[$t],Vt=ke[$t]={};for(const Yt in Tt.glyphs){const Je=Tt.glyphs[+Yt];if(!Je||Je.bitmap.width===0||Je.bitmap.height===0)continue;const Pt=Je.metrics.localGlyph?N:1,vn={x:0,y:0,w:Je.bitmap.width+2*Pt,h:Je.bitmap.height+2*Pt};Ke.push(vn),Vt[Yt]=vn}}const{w:lt,h:nt}=o.z(Ke),xt=new o.dO({width:lt||1,height:nt||1});for(const $t in Te){const Tt=Te[$t];for(const Vt in Tt.glyphs){const Yt=Tt.glyphs[+Vt];if(!Yt||Yt.bitmap.width===0||Yt.bitmap.height===0)continue;const Je=ke[$t][Vt],Pt=Yt.metrics.localGlyph?N:1;o.dO.copy(Yt.bitmap,xt,{x:0,y:0},{x:Je.x+Pt,y:Je.y+Pt},Yt.bitmap)}}this.image=xt,this.positions=ke}}o.dN($,"GlyphAtlas");class F{constructor(Te){this.tileID=new o.aA(Te.tileID.overscaledZ,Te.tileID.wrap,Te.tileID.canonical.z,Te.tileID.canonical.x,Te.tileID.canonical.y),this.tileZoom=Te.tileZoom,this.uid=Te.uid,this.zoom=Te.zoom,this.lut=Te.lut,this.canonical=Te.tileID.canonical,this.pixelRatio=Te.pixelRatio,this.tileSize=Te.tileSize,this.source=Te.source,this.scope=Te.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Te.showCollisionBoxes,this.collectResourceTiming=!!Te.collectResourceTiming,this.promoteId=Te.promoteId,this.isSymbolTile=Te.isSymbolTile,this.tileTransform=o.aK(Te.tileID.canonical,Te.projection),this.projection=Te.projection,this.brightness=Te.brightness,this.extraShadowCaster=!!Te.extraShadowCaster,this.tessellationStep=Te.tessellationStep}parse(Te,ke,Ke,lt,nt){this.status="parsing",this.data=Te,this.collisionBoxArray=new o.aQ;const xt=new o.dQ(Object.keys(Te.layers).sort()),$t=new o.dR(this.tileID,this.promoteId);$t.bucketLayerIDs=[];const Tt={},Vt=new o.dS(256,256),Yt={featureIndex:$t,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Vt,availableImages:Ke,brightness:this.brightness},Je=ke.familiesBySource[this.source];for(const fr in Je){const Wr=Te.layers[fr];if(!Wr)continue;let ro=!1,Ut=!1,Rn=!1;for(const go of Je[fr])go[0].type==="symbol"?ro=!0:Ut=!0,go[0].is3D()&&go[0].type!=="model"&&(Rn=!0);if(this.extraShadowCaster&&!Rn||this.isSymbolTile===!0&&!ro||this.isSymbolTile===!1&&!Ut)continue;Wr.version===1&&o.w(`Vector tile source "${this.source}" layer "${fr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Jn=xt.encode(fr),_r=[];for(let go=0;go<Wr.length;go++){const jo=Wr.feature(go),Qs=$t.getId(jo,fr);_r.push({feature:jo,id:Qs,index:go,sourceLayerIndex:Jn})}for(const go of Je[fr]){const jo=go[0];(!this.extraShadowCaster||jo.is3D()&&jo.type!=="model")&&(this.isSymbolTile!==void 0&&jo.type==="symbol"!==this.isSymbolTile||jo.minzoom&&this.zoom<Math.floor(jo.minzoom)||jo.maxzoom&&this.zoom>=jo.maxzoom||jo.visibility!=="none"&&(G(go,this.zoom,Yt.brightness,Ke),(Tt[jo.id]=jo.createBucket({index:$t.bucketLayerIDs.length,layers:go,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Jn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(_r,Yt,this.tileID.canonical,this.tileTransform),$t.bucketLayerIDs.push(go.map(Qs=>Qs.id))))}}let Pt,vn,Cn,tr;Vt.trim();const hr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},dr=()=>{if(Pt)return this.status="done",nt(Pt);if(this.extraShadowCaster)this.status="done",nt(null,{buckets:o.bd(Tt).filter(fr=>!fr.isEmpty()),featureIndex:$t,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Yt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(vn&&Cn&&tr){const fr=new $(vn),Wr=new o.dU(Cn,tr,this.lut);for(const ro in Tt){const Ut=Tt[ro];Ut instanceof o.aR?(G(Ut.layers,this.zoom,Yt.brightness,Ke),o.dV(Ut,vn,fr.positions,Cn,Wr.iconPositions,this.showCollisionBoxes,Ke,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):Ut.hasPattern&&(Ut instanceof o.aX||Ut instanceof o.aY||Ut instanceof o.d0)&&(G(Ut.layers,this.zoom,Yt.brightness,Ke),Ut.addFeatures(Yt,this.tileID.canonical,Wr.patternPositions,Ke,this.tileTransform,this.brightness))}this.status="done",nt(null,{buckets:o.bd(Tt).filter(ro=>!ro.isEmpty()),featureIndex:$t,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:fr.image,lineAtlas:Vt,imageAtlas:Wr,brightness:Yt.brightness})}};if(!this.extraShadowCaster){const fr=o.dT(Yt.glyphDependencies,Ut=>Object.keys(Ut).map(Number));Object.keys(fr).length?lt.send("getGlyphs",{uid:this.uid,stacks:fr,scope:this.scope},(Ut,Rn)=>{Pt||(Pt=Ut,vn=Rn,dr())},void 0,!1,hr):vn={};const Wr=Object.keys(Yt.iconDependencies);Wr.length?lt.send("getImages",{icons:Wr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Ut,Rn)=>{Pt||(Pt=Ut,Cn=Rn,dr())},void 0,!1,hr):Cn={};const ro=Object.keys(Yt.patternDependencies);ro.length?lt.send("getImages",{icons:ro,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Ut,Rn)=>{Pt||(Pt=Ut,tr=Rn,dr())},void 0,!1,hr):tr={}}dr()}}function G(Nt,Te,ke,Ke){const lt=new o.a3(Te,{brightness:ke});for(const nt of Nt)nt.recalculate(lt,Ke)}class U extends o.E{constructor(Te,ke,Ke,lt,nt,xt){super(),this.actor=Te,this.layerIndex=ke,this.availableImages=Ke,this.loadVectorData=nt||o.aw,this.loading={},this.loaded={},this.deduped=new o.au(Te.scheduler),this.isSpriteLoaded=lt,this.scheduler=Te.scheduler,this.brightness=xt}loadTile(Te,ke){const Ke=Te.uid,lt=Te&&Te.request,nt=lt&&lt.collectResourceTiming,xt=this.loading[Ke]=new F(Te);xt.abort=this.loadVectorData(Te,($t,Tt)=>{const Vt=!this.loading[Ke];if(delete this.loading[Ke],Vt||$t||!Tt)return xt.status="done",Vt||(this.loaded[Ke]=xt),ke($t);const Yt=Tt.rawData,Je={};Tt.expires&&(Je.expires=Tt.expires),Tt.cacheControl&&(Je.cacheControl=Tt.cacheControl),xt.vectorTile=Tt.vectorTile||new o.dW.VectorTile(new o.bb(Yt));const Pt=()=>{xt.parse(xt.vectorTile,this.layerIndex,this.availableImages,this.actor,(vn,Cn)=>{if(vn||!Cn)return ke(vn);const tr={};if(nt){const hr=C(lt);hr.length>0&&(tr.resourceTiming=JSON.parse(JSON.stringify(hr)))}ke(null,o.l({rawTileData:Yt.slice(0)},Cn,Je,tr))})};this.isSpriteLoaded?Pt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Pt,{type:"parseTile",isSymbolTile:Te.isSymbolTile,zoom:Te.tileZoom}):Pt()}),this.loaded=this.loaded||{},this.loaded[Ke]=xt})}reloadTile(Te,ke){const Ke=this.loaded,lt=Te.uid;if(Ke&&Ke[lt]){const nt=Ke[lt];nt.showCollisionBoxes=Te.showCollisionBoxes,nt.projection=Te.projection,nt.brightness=Te.brightness,nt.tileTransform=o.aK(Te.tileID.canonical,Te.projection),nt.extraShadowCaster=Te.extraShadowCaster,nt.lut=Te.lut;const xt=($t,Tt)=>{const Vt=nt.reloadCallback;Vt&&(delete nt.reloadCallback,nt.parse(nt.vectorTile,this.layerIndex,this.availableImages,this.actor,Vt)),ke($t,Tt)};nt.status==="parsing"?nt.reloadCallback=xt:nt.status==="done"&&(nt.vectorTile?nt.parse(nt.vectorTile,this.layerIndex,this.availableImages,this.actor,xt):xt())}else ke(null,void 0)}abortTile(Te,ke){const Ke=Te.uid,lt=this.loading[Ke];lt&&(lt.abort&&lt.abort(),delete this.loading[Ke]),ke()}removeTile(Te,ke){const Ke=this.loaded,lt=Te.uid;Ke&&Ke[lt]&&delete Ke[lt],ke()}}class te{loadTile(Te,ke){const{uid:Ke,encoding:lt,rawImageData:nt,padding:xt}=Te,$t=ImageBitmap&&nt instanceof ImageBitmap?this.getImageData(nt,xt):nt;ke(null,new o.dX(Ke,$t,lt,xt<1))}getImageData(Te,ke){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Te.width,Te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Te.width,this.offscreenCanvas.height=Te.height,this.offscreenCanvasContext.drawImage(Te,0,0,Te.width,Te.height);const Ke=this.offscreenCanvasContext.getImageData(-ke,-ke,Te.width+2*ke,Te.height+2*ke);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ke}}o.ba.setPbf(o.bb);class Z{decodeRasterArray({task:Te,buffer:ke},Ke){o.ba.performDecoding(ke,Te).then(lt=>{Ke(null,lt)},lt=>{Ke(lt)})}}const q=o.dW.VectorTileFeature.prototype.toGeoJSON;class X{constructor(Te){this._feature=Te,this.extent=o.ab,this.type=Te.type,this.properties=Te.tags,"id"in Te&&!isNaN(Te.id)&&(this.id=parseInt(Te.id,10))}loadGeometry(){if(this._feature.type===1){const Te=[];for(const ke of this._feature.geometry)Te.push([new o.P(ke[0],ke[1])]);return Te}{const Te=[];for(const ke of this._feature.geometry){const Ke=[];for(const lt of ke)Ke.push(new o.P(lt[0],lt[1]));Te.push(Ke)}return Te}}toGeoJSON(Te,ke,Ke){return q.call(this,Te,ke,Ke)}}class ie{constructor(Te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.ab,this.length=Te.length,this._features=Te}feature(Te){return new X(this._features[Te])}}const de=64/4096,le=128;class pe{constructor(){this.features=new Map}clear(){this.features.clear()}load(Te=[],ke){for(const Ke of Te){const lt=Ke.id;if(lt==null)continue;let nt=this.features.get(lt);nt&&this.updateCache(nt,ke),Ke.geometry?(nt=he(Ke),this.updateCache(nt,ke),this.features.set(lt,nt)):this.features.delete(lt),this.updateCache(nt,ke)}}updateCache(Te,ke){for(const{canonical:Ke,uid:lt}of Object.values(ke)){const{z:nt,x:xt,y:$t}=Ke;ge(Te,Math.pow(2,nt),xt,$t)&&delete ke[lt]}}getTile(Te,ke,Ke){const lt=Math.pow(2,Te),nt=[];for(const xt of this.features.values())ge(xt,lt,ke,Ke)&&nt.push(Ie(xt,lt,ke,Ke));return{features:nt}}getFeatures(){return[...this.features.values()]}}function ge({minX:Nt,minY:Te,maxX:ke,maxY:Ke},lt,nt,xt){return Nt<(nt+1+de)/lt&&Te<(xt+1+de)/lt&&ke>(nt-de)/lt&&Ke>(xt-de)/lt}function he(Nt){const{id:Te,geometry:ke,properties:Ke}=Nt;if(!ke)return;if(ke.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:lt,coordinates:nt}=ke,xt={id:Te,type:1,geometry:[],tags:Ke,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},$t=xt.geometry;if(lt==="Point")ue(nt,$t,xt);else if(lt==="MultiPoint")for(const Tt of nt)ue(Tt,$t,xt);else if(lt==="LineString")xt.type=2,Re(nt,$t,xt);else if(lt==="MultiLineString")xt.type=2,Ye(nt,$t,xt);else if(lt==="Polygon")xt.type=3,Ye(nt,$t,xt,!0);else{if(lt!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");xt.type=3;for(const Tt of nt)Ye(Tt,$t,xt,!0)}return xt}function ue([Nt,Te],ke,Ke){const lt=o.am(Nt);let nt=o.at(Te);nt=nt<0?0:nt>1?1:nt,ke.push(lt,nt),Ke.minX=Math.min(Ke.minX,lt),Ke.minY=Math.min(Ke.minY,nt),Ke.maxX=Math.max(Ke.maxX,lt),Ke.maxY=Math.max(Ke.maxY,nt)}function Re(Nt,Te,ke,Ke=!1,lt=!1){const nt=[];for(const xt of Nt)ue(xt,nt,ke);Te.push(nt),Ke&&function(xt,$t){let Tt=0;for(let Vt=0,Yt=xt.length,Je=Yt-2;Vt<Yt;Je=Vt,Vt+=2)Tt+=(xt[Vt]-xt[Je])*(xt[Vt+1]+xt[Je+1]);if(Tt>0===$t)for(let Vt=0,Yt=xt.length;Vt<Yt/2;Vt+=2){const Je=xt[Vt],Pt=xt[Vt+1];xt[Vt]=xt[Yt-2-Vt],xt[Vt+1]=xt[Yt-1-Vt],xt[Yt-2-Vt]=Je,xt[Yt-1-Vt]=Pt}}(nt,lt)}function Ye(Nt,Te,ke,Ke=!1){for(let lt=0;lt<Nt.length;lt++)Re(Nt[lt],Te,ke,Ke,lt===0)}function Ie(Nt,Te,ke,Ke){const{id:lt,type:nt,geometry:xt,tags:$t}=Nt,Tt=[];if(nt===1)(function(Vt,Yt,Je,Pt,vn){for(let Cn=0;Cn<Vt.length;Cn+=2){const tr=Math.round(o.ab*(Vt[Cn+0]*Yt-Je)),hr=Math.round(o.ab*(Vt[Cn+1]*Yt-Pt));vn.push([tr,hr])}})(xt,Te,ke,Ke,Tt);else for(const Vt of xt)fe(Vt,Te,ke,Ke,Tt);return{id:lt,type:nt,geometry:Tt,tags:$t}}function fe(Nt,Te,ke,Ke,lt){const nt=-le,xt=o.ab+le;let $t;for(let Tt=0;Tt<Nt.length-2;Tt+=2){let Vt=Math.round(o.ab*(Nt[Tt+0]*Te-ke)),Yt=Math.round(o.ab*(Nt[Tt+1]*Te-Ke)),Je=Math.round(o.ab*(Nt[Tt+2]*Te-ke)),Pt=Math.round(o.ab*(Nt[Tt+3]*Te-Ke));const vn=Je-Vt,Cn=Pt-Yt;Vt<nt&&Je<nt||(Vt<nt?(Yt+=Math.round(Cn*((nt-Vt)/vn)),Vt=nt):Je<nt&&(Pt=Yt+Math.round(Cn*((nt-Vt)/vn)),Je=nt),Yt<nt&&Pt<nt||(Yt<nt?(Vt+=Math.round(vn*((nt-Yt)/Cn)),Yt=nt):Pt<nt&&(Je=Vt+Math.round(vn*((nt-Yt)/Cn)),Pt=nt),Vt>=xt&&Je>=xt||(Vt>=xt?(Yt+=Math.round(Cn*((xt-Vt)/vn)),Vt=xt):Je>=xt&&(Pt=Yt+Math.round(Cn*((xt-Vt)/vn)),Je=xt),Yt>=xt&&Pt>=xt||(Yt>=xt?(Vt+=Math.round(vn*((xt-Yt)/Cn)),Yt=xt):Pt>=xt&&(Je=Vt+Math.round(vn*((xt-Yt)/Cn)),Pt=xt),$t&&Vt===$t[$t.length-1][0]&&Yt===$t[$t.length-1][1]||($t=[[Vt,Yt]],lt.push($t)),$t.push([Je,Pt])))))}}var Me,Se,ye,Ce={exports:{}},Fe=function(){if(ye)return Ce.exports;ye=1;var Nt=o.d_(),Te=function(){if(Se)return Me;Se=1;var Yt=o.dY(),Je=o.dZ().VectorTileFeature;function Pt(Cn,tr){this.options=tr||{},this.features=Cn,this.length=Cn.length}function vn(Cn,tr){this.id=typeof Cn.id=="number"?Cn.id:void 0,this.type=Cn.type,this.rawGeometry=Cn.type===1?[Cn.geometry]:Cn.geometry,this.properties=Cn.tags,this.extent=tr||4096}return Me=Pt,Pt.prototype.feature=function(Cn){return new vn(this.features[Cn],this.options.extent)},vn.prototype.loadGeometry=function(){var Cn=this.rawGeometry;this.geometry=[];for(var tr=0;tr<Cn.length;tr++){for(var hr=Cn[tr],dr=[],fr=0;fr<hr.length;fr++)dr.push(new Yt(hr[fr][0],hr[fr][1]));this.geometry.push(dr)}return this.geometry},vn.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Cn=this.geometry,tr=1/0,hr=-1/0,dr=1/0,fr=-1/0,Wr=0;Wr<Cn.length;Wr++)for(var ro=Cn[Wr],Ut=0;Ut<ro.length;Ut++){var Rn=ro[Ut];tr=Math.min(tr,Rn.x),hr=Math.max(hr,Rn.x),dr=Math.min(dr,Rn.y),fr=Math.max(fr,Rn.y)}return[tr,dr,hr,fr]},vn.prototype.toGeoJSON=Je.prototype.toGeoJSON,Me}();function ke(Yt){var Je=new Nt;return function(Pt,vn){for(var Cn in Pt.layers)vn.writeMessage(3,Ke,Pt.layers[Cn])}(Yt,Je),Je.finish()}function Ke(Yt,Je){var Pt;Je.writeVarintField(15,Yt.version||1),Je.writeStringField(1,Yt.name||""),Je.writeVarintField(5,Yt.extent||4096);var vn={keys:[],values:[],keycache:{},valuecache:{}};for(Pt=0;Pt<Yt.length;Pt++)vn.feature=Yt.feature(Pt),Je.writeMessage(2,lt,vn);var Cn=vn.keys;for(Pt=0;Pt<Cn.length;Pt++)Je.writeStringField(3,Cn[Pt]);var tr=vn.values;for(Pt=0;Pt<tr.length;Pt++)Je.writeMessage(4,Vt,tr[Pt])}function lt(Yt,Je){var Pt=Yt.feature;Pt.id!==void 0&&Je.writeVarintField(1,Pt.id),Je.writeMessage(2,nt,Yt),Je.writeVarintField(3,Pt.type),Je.writeMessage(4,Tt,Pt)}function nt(Yt,Je){var Pt=Yt.feature,vn=Yt.keys,Cn=Yt.values,tr=Yt.keycache,hr=Yt.valuecache;for(var dr in Pt.properties){var fr=Pt.properties[dr],Wr=tr[dr];if(fr!==null){Wr===void 0&&(vn.push(dr),tr[dr]=Wr=vn.length-1),Je.writeVarint(Wr);var ro=typeof fr;ro!=="string"&&ro!=="boolean"&&ro!=="number"&&(fr=JSON.stringify(fr));var Ut=ro+":"+fr,Rn=hr[Ut];Rn===void 0&&(Cn.push(fr),hr[Ut]=Rn=Cn.length-1),Je.writeVarint(Rn)}}}function xt(Yt,Je){return(Je<<3)+(7&Yt)}function $t(Yt){return Yt<<1^Yt>>31}function Tt(Yt,Je){for(var Pt=Yt.loadGeometry(),vn=Yt.type,Cn=0,tr=0,hr=Pt.length,dr=0;dr<hr;dr++){var fr=Pt[dr],Wr=1;vn===1&&(Wr=fr.length),Je.writeVarint(xt(1,Wr));for(var ro=vn===3?fr.length-1:fr.length,Ut=0;Ut<ro;Ut++){Ut===1&&vn!==1&&Je.writeVarint(xt(2,ro-1));var Rn=fr[Ut].x-Cn,Jn=fr[Ut].y-tr;Je.writeVarint($t(Rn)),Je.writeVarint($t(Jn)),Cn+=Rn,tr+=Jn}vn===3&&Je.writeVarint(xt(7,1))}}function Vt(Yt,Je){var Pt=typeof Yt;Pt==="string"?Je.writeStringField(1,Yt):Pt==="boolean"?Je.writeBooleanField(7,Yt):Pt==="number"&&(Yt%1!=0?Je.writeDoubleField(3,Yt):Yt<0?Je.writeSVarintField(6,Yt):Je.writeVarintField(5,Yt))}return Ce.exports=ke,Ce.exports.fromVectorTileJs=ke,Ce.exports.fromGeojsonVt=function(Yt,Je){Je=Je||{};var Pt={};for(var vn in Yt)Pt[vn]=new Te(Yt[vn].features,Je),Pt[vn].name=vn,Pt[vn].version=Je.version,Pt[vn].extent=Je.extent;return ke({layers:Pt})},Ce.exports.GeoJSONWrapper=Te,Ce.exports}(),it=o.d$(Fe);const We={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Nt=>Nt},ut=Math.fround||(Lt=new Float32Array(1),Nt=>(Lt[0]=+Nt,Lt[0]));var Lt;const Ft=3,mt=5,jt=6;class Ht{constructor(Te){this.options=Object.assign(Object.create(We),Te),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Te){const{log:ke,minZoom:Ke,maxZoom:lt}=this.options;ke&&console.time("total time");const nt=`prepare ${Te.length} points`;ke&&console.time(nt),this.points=Te;const xt=[];for(let Tt=0;Tt<Te.length;Tt++){const Vt=Te[Tt];if(!Vt.geometry)continue;const[Yt,Je]=Vt.geometry.coordinates,Pt=ut(At(Yt)),vn=ut(He(Je));xt.push(Pt,vn,1/0,Tt,-1,1),this.options.reduce&&xt.push(0)}let $t=this.trees[lt+1]=this._createTree(xt);ke&&console.timeEnd(nt);for(let Tt=lt;Tt>=Ke;Tt--){const Vt=+Date.now();$t=this.trees[Tt]=this._createTree(this._cluster($t,Tt)),ke&&console.log("z%d: %d clusters in %dms",Tt,$t.numItems,+Date.now()-Vt)}return ke&&console.timeEnd("total time"),this}getClusters(Te,ke){let Ke=((Te[0]+180)%360+360)%360-180;const lt=Math.max(-90,Math.min(90,Te[1]));let nt=Te[2]===180?180:((Te[2]+180)%360+360)%360-180;const xt=Math.max(-90,Math.min(90,Te[3]));if(Te[2]-Te[0]>=360)Ke=-180,nt=180;else if(Ke>nt){const Je=this.getClusters([Ke,lt,180,xt],ke),Pt=this.getClusters([-180,lt,nt,xt],ke);return Je.concat(Pt)}const $t=this.trees[this._limitZoom(ke)],Tt=$t.range(At(Ke),He(xt),At(nt),He(lt)),Vt=$t.data,Yt=[];for(const Je of Tt){const Pt=this.stride*Je;Yt.push(Vt[Pt+mt]>1?Tn(Vt,Pt,this.clusterProps):this.points[Vt[Pt+Ft]])}return Yt}getChildren(Te){const ke=this._getOriginId(Te),Ke=this._getOriginZoom(Te),lt="No cluster with the specified id.",nt=this.trees[Ke];if(!nt)throw new Error(lt);const xt=nt.data;if(ke*this.stride>=xt.length)throw new Error(lt);const $t=this.options.radius/(this.options.extent*Math.pow(2,Ke-1)),Tt=nt.within(xt[ke*this.stride],xt[ke*this.stride+1],$t),Vt=[];for(const Yt of Tt){const Je=Yt*this.stride;xt[Je+4]===Te&&Vt.push(xt[Je+mt]>1?Tn(xt,Je,this.clusterProps):this.points[xt[Je+Ft]])}if(Vt.length===0)throw new Error(lt);return Vt}getLeaves(Te,ke,Ke){const lt=[];return this._appendLeaves(lt,Te,ke=ke||10,Ke=Ke||0,0),lt}getTile(Te,ke,Ke){const lt=this.trees[this._limitZoom(Te)],nt=Math.pow(2,Te),{extent:xt,radius:$t}=this.options,Tt=$t/xt,Vt=(Ke-Tt)/nt,Yt=(Ke+1+Tt)/nt,Je={features:[]};return this._addTileFeatures(lt.range((ke-Tt)/nt,Vt,(ke+1+Tt)/nt,Yt),lt.data,ke,Ke,nt,Je),ke===0&&this._addTileFeatures(lt.range(1-Tt/nt,Vt,1,Yt),lt.data,nt,Ke,nt,Je),ke===nt-1&&this._addTileFeatures(lt.range(0,Vt,Tt/nt,Yt),lt.data,-1,Ke,nt,Je),Je.features.length?Je:null}getClusterExpansionZoom(Te){let ke=this._getOriginZoom(Te)-1;for(;ke<=this.options.maxZoom;){const Ke=this.getChildren(Te);if(ke++,Ke.length!==1)break;Te=Ke[0].properties.cluster_id}return ke}_appendLeaves(Te,ke,Ke,lt,nt){const xt=this.getChildren(ke);for(const $t of xt){const Tt=$t.properties;if(Tt&&Tt.cluster?nt+Tt.point_count<=lt?nt+=Tt.point_count:nt=this._appendLeaves(Te,Tt.cluster_id,Ke,lt,nt):nt<lt?nt++:Te.push($t),Te.length===Ke)break}return nt}_createTree(Te){const ke=new o.by(Te.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ke=0;Ke<Te.length;Ke+=this.stride)ke.add(Te[Ke],Te[Ke+1]);return ke.finish(),ke.data=Te,ke}_addTileFeatures(Te,ke,Ke,lt,nt,xt){for(const $t of Te){const Tt=$t*this.stride,Vt=ke[Tt+mt]>1;let Yt,Je,Pt;if(Vt)Yt=Pe(ke,Tt,this.clusterProps),Je=ke[Tt],Pt=ke[Tt+1];else{const tr=this.points[ke[Tt+Ft]];Yt=tr.properties;const[hr,dr]=tr.geometry.coordinates;Je=At(hr),Pt=He(dr)}const vn={type:1,geometry:[[Math.round(this.options.extent*(Je*nt-Ke)),Math.round(this.options.extent*(Pt*nt-lt))]],tags:Yt};let Cn;Cn=Vt||this.options.generateId?ke[Tt+Ft]:this.points[ke[Tt+Ft]].id,Cn!==void 0&&(vn.id=Cn),xt.features.push(vn)}}_limitZoom(Te){return Math.max(this.options.minZoom,Math.min(Math.floor(+Te),this.options.maxZoom+1))}_cluster(Te,ke){const{radius:Ke,extent:lt,reduce:nt,minPoints:xt}=this.options,$t=Ke/(lt*Math.pow(2,ke)),Tt=Te.data,Vt=[],Yt=this.stride;for(let Je=0;Je<Tt.length;Je+=Yt){if(Tt[Je+2]<=ke)continue;Tt[Je+2]=ke;const Pt=Tt[Je],vn=Tt[Je+1],Cn=Te.within(Tt[Je],Tt[Je+1],$t),tr=Tt[Je+mt];let hr=tr;for(const dr of Cn){const fr=dr*Yt;Tt[fr+2]>ke&&(hr+=Tt[fr+mt])}if(hr>tr&&hr>=xt){let dr,fr=Pt*tr,Wr=vn*tr,ro=-1;const Ut=(Je/Yt<<5)+(ke+1)+this.points.length;for(const Rn of Cn){const Jn=Rn*Yt;if(Tt[Jn+2]<=ke)continue;Tt[Jn+2]=ke;const _r=Tt[Jn+mt];fr+=Tt[Jn]*_r,Wr+=Tt[Jn+1]*_r,Tt[Jn+4]=Ut,nt&&(dr||(dr=this._map(Tt,Je,!0),ro=this.clusterProps.length,this.clusterProps.push(dr)),nt(dr,this._map(Tt,Jn)))}Tt[Je+4]=Ut,Vt.push(fr/hr,Wr/hr,1/0,Ut,-1,hr),nt&&Vt.push(ro)}else{for(let dr=0;dr<Yt;dr++)Vt.push(Tt[Je+dr]);if(hr>1)for(const dr of Cn){const fr=dr*Yt;if(!(Tt[fr+2]<=ke)){Tt[fr+2]=ke;for(let Wr=0;Wr<Yt;Wr++)Vt.push(Tt[fr+Wr])}}}}return Vt}_getOriginId(Te){return Te-this.points.length>>5}_getOriginZoom(Te){return(Te-this.points.length)%32}_map(Te,ke,Ke){if(Te[ke+mt]>1){const xt=this.clusterProps[Te[ke+jt]];return Ke?Object.assign({},xt):xt}const lt=this.points[Te[ke+Ft]].properties,nt=this.options.map(lt);return Ke&&nt===lt?Object.assign({},nt):nt}}function Tn(Nt,Te,ke){return{type:"Feature",id:Nt[Te+Ft],properties:Pe(Nt,Te,ke),geometry:{type:"Point",coordinates:[(Ke=Nt[Te],360*(Ke-.5)),pt(Nt[Te+1])]}};var Ke}function Pe(Nt,Te,ke){const Ke=Nt[Te+mt],lt=Ke>=1e4?`${Math.round(Ke/1e3)}k`:Ke>=1e3?Math.round(Ke/100)/10+"k":Ke,nt=Nt[Te+jt],xt=nt===-1?{}:Object.assign({},ke[nt]);return Object.assign(xt,{cluster:!0,cluster_id:Nt[Te+Ft],point_count:Ke,point_count_abbreviated:lt})}function At(Nt){return Nt/360+.5}function He(Nt){const Te=Math.sin(Nt*Math.PI/180),ke=.5-.25*Math.log((1+Te)/(1-Te))/Math.PI;return ke<0?0:ke>1?1:ke}function pt(Nt){const Te=(180-360*Nt)*Math.PI/180;return 360*Math.atan(Math.exp(Te))/Math.PI-90}function et(Nt,Te,ke,Ke){let lt=Ke;const nt=Te+(ke-Te>>1);let xt,$t=ke-Te;const Tt=Nt[Te],Vt=Nt[Te+1],Yt=Nt[ke],Je=Nt[ke+1];for(let Pt=Te+3;Pt<ke;Pt+=3){const vn=rn(Nt[Pt],Nt[Pt+1],Tt,Vt,Yt,Je);if(vn>lt)xt=Pt,lt=vn;else if(vn===lt){const Cn=Math.abs(Pt-nt);Cn<$t&&(xt=Pt,$t=Cn)}}lt>Ke&&(xt-Te>3&&et(Nt,Te,xt,Ke),Nt[xt+2]=lt,ke-xt>3&&et(Nt,xt,ke,Ke))}function rn(Nt,Te,ke,Ke,lt,nt){let xt=lt-ke,$t=nt-Ke;if(xt!==0||$t!==0){const Tt=((Nt-ke)*xt+(Te-Ke)*$t)/(xt*xt+$t*$t);Tt>1?(ke=lt,Ke=nt):Tt>0&&(ke+=xt*Tt,Ke+=$t*Tt)}return xt=Nt-ke,$t=Te-Ke,xt*xt+$t*$t}function kt(Nt,Te,ke,Ke){const lt={id:Nt??null,type:Te,geometry:ke,tags:Ke,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Te==="Point"||Te==="MultiPoint"||Te==="LineString")zt(lt,ke);else if(Te==="Polygon")zt(lt,ke[0]);else if(Te==="MultiLineString")for(const nt of ke)zt(lt,nt);else if(Te==="MultiPolygon")for(const nt of ke)zt(lt,nt[0]);return lt}function zt(Nt,Te){for(let ke=0;ke<Te.length;ke+=3)Nt.minX=Math.min(Nt.minX,Te[ke]),Nt.minY=Math.min(Nt.minY,Te[ke+1]),Nt.maxX=Math.max(Nt.maxX,Te[ke]),Nt.maxY=Math.max(Nt.maxY,Te[ke+1])}function Mt(Nt,Te,ke,Ke){if(!Te.geometry)return;const lt=Te.geometry.coordinates;if(lt&&lt.length===0)return;const nt=Te.geometry.type,xt=Math.pow(ke.tolerance/((1<<ke.maxZoom)*ke.extent),2);let $t=[],Tt=Te.id;if(ke.promoteId?Tt=Te.properties[ke.promoteId]:ke.generateId&&(Tt=Ke||0),nt==="Point")en(lt,$t);else if(nt==="MultiPoint")for(const Vt of lt)en(Vt,$t);else if(nt==="LineString")sn(lt,$t,xt,!1);else if(nt==="MultiLineString"){if(ke.lineMetrics){for(const Vt of lt)$t=[],sn(Vt,$t,xt,!1),Nt.push(kt(Tt,"LineString",$t,Te.properties));return}dn(lt,$t,xt,!1)}else if(nt==="Polygon")dn(lt,$t,xt,!0);else{if(nt!=="MultiPolygon"){if(nt==="GeometryCollection"){for(const Vt of Te.geometry.geometries)Mt(Nt,{id:Tt,geometry:Vt,properties:Te.properties},ke,Ke);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Vt of lt){const Yt=[];dn(Vt,Yt,xt,!0),$t.push(Yt)}}Nt.push(kt(Tt,nt,$t,Te.properties))}function en(Nt,Te){Te.push(Pn(Nt[0]),Ot(Nt[1]),0)}function sn(Nt,Te,ke,Ke){let lt,nt,xt=0;for(let Tt=0;Tt<Nt.length;Tt++){const Vt=Pn(Nt[Tt][0]),Yt=Ot(Nt[Tt][1]);Te.push(Vt,Yt,0),Tt>0&&(xt+=Ke?(lt*Yt-Vt*nt)/2:Math.sqrt(Math.pow(Vt-lt,2)+Math.pow(Yt-nt,2))),lt=Vt,nt=Yt}const $t=Te.length-3;Te[2]=1,et(Te,0,$t,ke),Te[$t+2]=1,Te.size=Math.abs(xt),Te.start=0,Te.end=Te.size}function dn(Nt,Te,ke,Ke){for(let lt=0;lt<Nt.length;lt++){const nt=[];sn(Nt[lt],nt,ke,Ke),Te.push(nt)}}function Pn(Nt){return Nt/360+.5}function Ot(Nt){const Te=Math.sin(Nt*Math.PI/180),ke=.5-.25*Math.log((1+Te)/(1-Te))/Math.PI;return ke<0?0:ke>1?1:ke}function Zt(Nt,Te,ke,Ke,lt,nt,xt,$t){if(Ke/=Te,nt>=(ke/=Te)&&xt<Ke)return Nt;if(xt<ke||nt>=Ke)return null;const Tt=[];for(const Vt of Nt){const Yt=Vt.geometry;let Je=Vt.type;const Pt=lt===0?Vt.minX:Vt.minY,vn=lt===0?Vt.maxX:Vt.maxY;if(Pt>=ke&&vn<Ke){Tt.push(Vt);continue}if(vn<ke||Pt>=Ke)continue;let Cn=[];if(Je==="Point"||Je==="MultiPoint")jn(Yt,Cn,ke,Ke,lt);else if(Je==="LineString")ir(Yt,Cn,ke,Ke,lt,!1,$t.lineMetrics);else if(Je==="MultiLineString")ar(Yt,Cn,ke,Ke,lt,!1);else if(Je==="Polygon")ar(Yt,Cn,ke,Ke,lt,!0);else if(Je==="MultiPolygon")for(const tr of Yt){const hr=[];ar(tr,hr,ke,Ke,lt,!0),hr.length&&Cn.push(hr)}if(Cn.length){if($t.lineMetrics&&Je==="LineString"){for(const tr of Cn)Tt.push(kt(Vt.id,Je,tr,Vt.tags));continue}Je!=="LineString"&&Je!=="MultiLineString"||(Cn.length===1?(Je="LineString",Cn=Cn[0]):Je="MultiLineString"),Je!=="Point"&&Je!=="MultiPoint"||(Je=Cn.length===3?"Point":"MultiPoint"),Tt.push(kt(Vt.id,Je,Cn,Vt.tags))}}return Tt.length?Tt:null}function jn(Nt,Te,ke,Ke,lt){for(let nt=0;nt<Nt.length;nt+=3){const xt=Nt[nt+lt];xt>=ke&&xt<=Ke&&wr(Te,Nt[nt],Nt[nt+1],Nt[nt+2])}}function ir(Nt,Te,ke,Ke,lt,nt,xt){let $t=ur(Nt);const Tt=lt===0?Xr:Rt;let Vt,Yt,Je=Nt.start;for(let hr=0;hr<Nt.length-3;hr+=3){const dr=Nt[hr],fr=Nt[hr+1],Wr=Nt[hr+2],ro=Nt[hr+3],Ut=Nt[hr+4],Rn=lt===0?dr:fr,Jn=lt===0?ro:Ut;let _r=!1;xt&&(Vt=Math.sqrt(Math.pow(dr-ro,2)+Math.pow(fr-Ut,2))),Rn<ke?Jn>ke&&(Yt=Tt($t,dr,fr,ro,Ut,ke),xt&&($t.start=Je+Vt*Yt)):Rn>Ke?Jn<Ke&&(Yt=Tt($t,dr,fr,ro,Ut,Ke),xt&&($t.start=Je+Vt*Yt)):wr($t,dr,fr,Wr),Jn<ke&&Rn>=ke&&(Yt=Tt($t,dr,fr,ro,Ut,ke),_r=!0),Jn>Ke&&Rn<=Ke&&(Yt=Tt($t,dr,fr,ro,Ut,Ke),_r=!0),!nt&&_r&&(xt&&($t.end=Je+Vt*Yt),Te.push($t),$t=ur(Nt)),xt&&(Je+=Vt)}let Pt=Nt.length-3;const vn=Nt[Pt],Cn=Nt[Pt+1],tr=lt===0?vn:Cn;tr>=ke&&tr<=Ke&&wr($t,vn,Cn,Nt[Pt+2]),Pt=$t.length-3,nt&&Pt>=3&&($t[Pt]!==$t[0]||$t[Pt+1]!==$t[1])&&wr($t,$t[0],$t[1],$t[2]),$t.length&&Te.push($t)}function ur(Nt){const Te=[];return Te.size=Nt.size,Te.start=Nt.start,Te.end=Nt.end,Te}function ar(Nt,Te,ke,Ke,lt,nt){for(const xt of Nt)ir(xt,Te,ke,Ke,lt,nt,!1)}function wr(Nt,Te,ke,Ke){Nt.push(Te,ke,Ke)}function Xr(Nt,Te,ke,Ke,lt,nt){const xt=(nt-Te)/(Ke-Te);return wr(Nt,nt,ke+(lt-ke)*xt,1),xt}function Rt(Nt,Te,ke,Ke,lt,nt){const xt=(nt-ke)/(lt-ke);return wr(Nt,Te+(Ke-Te)*xt,nt,1),xt}function _n(Nt,Te){const ke=[];for(let Ke=0;Ke<Nt.length;Ke++){const lt=Nt[Ke],nt=lt.type;let xt;if(nt==="Point"||nt==="MultiPoint"||nt==="LineString")xt=dt(lt.geometry,Te);else if(nt==="MultiLineString"||nt==="Polygon"){xt=[];for(const $t of lt.geometry)xt.push(dt($t,Te))}else if(nt==="MultiPolygon"){xt=[];for(const $t of lt.geometry){const Tt=[];for(const Vt of $t)Tt.push(dt(Vt,Te));xt.push(Tt)}}ke.push(kt(lt.id,nt,xt,lt.tags))}return ke}function dt(Nt,Te){const ke=[];ke.size=Nt.size,Nt.start!==void 0&&(ke.start=Nt.start,ke.end=Nt.end);for(let Ke=0;Ke<Nt.length;Ke+=3)ke.push(Nt[Ke]+Te,Nt[Ke+1],Nt[Ke+2]);return ke}function tn(Nt,Te){if(Nt.transformed)return Nt;const ke=1<<Nt.z,Ke=Nt.x,lt=Nt.y;for(const nt of Nt.features){const xt=nt.geometry,$t=nt.type;if(nt.geometry=[],$t===1)for(let Tt=0;Tt<xt.length;Tt+=2)nt.geometry.push(Ze(xt[Tt],xt[Tt+1],Te,ke,Ke,lt));else for(let Tt=0;Tt<xt.length;Tt++){const Vt=[];for(let Yt=0;Yt<xt[Tt].length;Yt+=2)Vt.push(Ze(xt[Tt][Yt],xt[Tt][Yt+1],Te,ke,Ke,lt));nt.geometry.push(Vt)}}return Nt.transformed=!0,Nt}function Ze(Nt,Te,ke,Ke,lt,nt){return[Math.round(ke*(Nt*Ke-lt)),Math.round(ke*(Te*Ke-nt))]}function gn(Nt,Te,ke,Ke,lt){const nt=Te===lt.maxZoom?0:lt.tolerance/((1<<Te)*lt.extent),xt={features:[],numPoints:0,numSimplified:0,numFeatures:Nt.length,source:null,x:ke,y:Ke,z:Te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const $t of Nt)rr(xt,$t,nt,lt);return xt}function rr(Nt,Te,ke,Ke){const lt=Te.geometry,nt=Te.type,xt=[];if(Nt.minX=Math.min(Nt.minX,Te.minX),Nt.minY=Math.min(Nt.minY,Te.minY),Nt.maxX=Math.max(Nt.maxX,Te.maxX),Nt.maxY=Math.max(Nt.maxY,Te.maxY),nt==="Point"||nt==="MultiPoint")for(let $t=0;$t<lt.length;$t+=3)xt.push(lt[$t],lt[$t+1]),Nt.numPoints++,Nt.numSimplified++;else if(nt==="LineString")Hn(xt,lt,Nt,ke,!1,!1);else if(nt==="MultiLineString"||nt==="Polygon")for(let $t=0;$t<lt.length;$t++)Hn(xt,lt[$t],Nt,ke,nt==="Polygon",$t===0);else if(nt==="MultiPolygon")for(let $t=0;$t<lt.length;$t++){const Tt=lt[$t];for(let Vt=0;Vt<Tt.length;Vt++)Hn(xt,Tt[Vt],Nt,ke,!0,Vt===0)}if(xt.length){let $t=Te.tags||null;if(nt==="LineString"&&Ke.lineMetrics){$t={};for(const Vt in Te.tags)$t[Vt]=Te.tags[Vt];$t.mapbox_clip_start=lt.start/lt.size,$t.mapbox_clip_end=lt.end/lt.size}const Tt={geometry:xt,type:nt==="Polygon"||nt==="MultiPolygon"?3:nt==="LineString"||nt==="MultiLineString"?2:1,tags:$t};Te.id!==null&&(Tt.id=Te.id),Nt.features.push(Tt)}}function Hn(Nt,Te,ke,Ke,lt,nt){const xt=Ke*Ke;if(Ke>0&&Te.size<(lt?xt:Ke))return void(ke.numPoints+=Te.length/3);const $t=[];for(let Tt=0;Tt<Te.length;Tt+=3)(Ke===0||Te[Tt+2]>xt)&&(ke.numSimplified++,$t.push(Te[Tt],Te[Tt+1])),ke.numPoints++;lt&&function(Tt,Vt){let Yt=0;for(let Je=0,Pt=Tt.length,vn=Pt-2;Je<Pt;vn=Je,Je+=2)Yt+=(Tt[Je]-Tt[vn])*(Tt[Je+1]+Tt[vn+1]);if(Yt>0===Vt)for(let Je=0,Pt=Tt.length;Je<Pt/2;Je+=2){const vn=Tt[Je],Cn=Tt[Je+1];Tt[Je]=Tt[Pt-2-Je],Tt[Je+1]=Tt[Pt-1-Je],Tt[Pt-2-Je]=vn,Tt[Pt-1-Je]=Cn}}($t,nt),Nt.push($t)}const eo={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Mi{constructor(Te,ke){const Ke=(ke=this.options=function(nt,xt){for(const $t in xt)nt[$t]=xt[$t];return nt}(Object.create(eo),ke)).debug;if(Ke&&console.time("preprocess data"),ke.maxZoom<0||ke.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ke.promoteId&&ke.generateId)throw new Error("promoteId and generateId cannot be used together.");let lt=function(nt,xt){const $t=[];if(nt.type==="FeatureCollection")for(let Tt=0;Tt<nt.features.length;Tt++)Mt($t,nt.features[Tt],xt,Tt);else Mt($t,nt.type==="Feature"?nt:{geometry:nt},xt);return $t}(Te,ke);this.tiles={},this.tileCoords=[],Ke&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ke.indexMaxZoom,ke.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),lt=function(nt,xt){const $t=xt.buffer/xt.extent;let Tt=nt;const Vt=Zt(nt,1,-1-$t,$t,0,-1,2,xt),Yt=Zt(nt,1,1-$t,2+$t,0,-1,2,xt);return(Vt||Yt)&&(Tt=Zt(nt,1,-$t,1+$t,0,-1,2,xt)||[],Vt&&(Tt=_n(Vt,1).concat(Tt)),Yt&&(Tt=Tt.concat(_n(Yt,-1)))),Tt}(lt,ke),lt.length&&this.splitTile(lt,0,0,0),Ke&&(lt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Te,ke,Ke,lt,nt,xt,$t){const Tt=[Te,ke,Ke,lt],Vt=this.options,Yt=Vt.debug;for(;Tt.length;){lt=Tt.pop(),Ke=Tt.pop(),ke=Tt.pop(),Te=Tt.pop();const Je=1<<ke,Pt=mo(ke,Ke,lt);let vn=this.tiles[Pt];if(!vn&&(Yt>1&&console.time("creation"),vn=this.tiles[Pt]=gn(Te,ke,Ke,lt,Vt),this.tileCoords.push({z:ke,x:Ke,y:lt}),Yt)){Yt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ke,Ke,lt,vn.numFeatures,vn.numPoints,vn.numSimplified),console.timeEnd("creation"));const _r=`z${ke}`;this.stats[_r]=(this.stats[_r]||0)+1,this.total++}if(vn.source=Te,nt==null){if(ke===Vt.indexMaxZoom||vn.numPoints<=Vt.indexMaxPoints)continue}else{if(ke===Vt.maxZoom||ke===nt)continue;if(nt!=null){const _r=nt-ke;if(Ke!==xt>>_r||lt!==$t>>_r)continue}}if(vn.source=null,Te.length===0)continue;Yt>1&&console.time("clipping");const Cn=.5*Vt.buffer/Vt.extent,tr=.5-Cn,hr=.5+Cn,dr=1+Cn;let fr=null,Wr=null,ro=null,Ut=null,Rn=Zt(Te,Je,Ke-Cn,Ke+hr,0,vn.minX,vn.maxX,Vt),Jn=Zt(Te,Je,Ke+tr,Ke+dr,0,vn.minX,vn.maxX,Vt);Te=null,Rn&&(fr=Zt(Rn,Je,lt-Cn,lt+hr,1,vn.minY,vn.maxY,Vt),Wr=Zt(Rn,Je,lt+tr,lt+dr,1,vn.minY,vn.maxY,Vt),Rn=null),Jn&&(ro=Zt(Jn,Je,lt-Cn,lt+hr,1,vn.minY,vn.maxY,Vt),Ut=Zt(Jn,Je,lt+tr,lt+dr,1,vn.minY,vn.maxY,Vt),Jn=null),Yt>1&&console.timeEnd("clipping"),Tt.push(fr||[],ke+1,2*Ke,2*lt),Tt.push(Wr||[],ke+1,2*Ke,2*lt+1),Tt.push(ro||[],ke+1,2*Ke+1,2*lt),Tt.push(Ut||[],ke+1,2*Ke+1,2*lt+1)}}getTile(Te,ke,Ke){Te=+Te,ke=+ke,Ke=+Ke;const lt=this.options,{extent:nt,debug:xt}=lt;if(Te<0||Te>24)return null;const $t=1<<Te,Tt=mo(Te,ke=ke+$t&$t-1,Ke);if(this.tiles[Tt])return tn(this.tiles[Tt],nt);xt>1&&console.log("drilling down to z%d-%d-%d",Te,ke,Ke);let Vt,Yt=Te,Je=ke,Pt=Ke;for(;!Vt&&Yt>0;)Yt--,Je>>=1,Pt>>=1,Vt=this.tiles[mo(Yt,Je,Pt)];return Vt&&Vt.source?(xt>1&&(console.log("found parent tile z%d-%d-%d",Yt,Je,Pt),console.time("drilling down")),this.splitTile(Vt.source,Yt,Je,Pt,Te,ke,Ke),xt>1&&console.timeEnd("drilling down"),this.tiles[Tt]?tn(this.tiles[Tt],nt):null):null}}function mo(Nt,Te,ke){return 32*((1<<Nt)*ke+Te)+Nt}function bo(Nt,Te){const ke=Nt.tileID.canonical;if(!this._geoJSONIndex)return void Te(null,null);const Ke=this._geoJSONIndex.getTile(ke.z,ke.x,ke.y);if(!Ke)return void Te(null,null);const lt=new ie(Ke.features);let nt=it(lt);nt.byteOffset===0&&nt.byteLength===nt.buffer.byteLength||(nt=new Uint8Array(nt)),Te(null,{vectorTile:lt,rawData:nt.buffer})}class Rr extends U{constructor(Te,ke,Ke,lt,nt,xt){super(Te,ke,Ke,lt,bo,xt),nt&&(this.loadGeoJSON=nt),this._dynamicIndex=new pe}loadData(Te,ke){const Ke=Te&&Te.request,lt=Ke&&Ke.collectResourceTiming;this.loadGeoJSON(Te,(nt,xt)=>{if(nt||!xt)return ke(nt);if(typeof xt!="object")return ke(new Error(`Input data given to '${Te.source}' is not a valid GeoJSON object.`));{try{if(Te.filter){const Tt=o.M(Te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Tt.result==="error")throw new Error(Tt.value.map(Vt=>`${Vt.key}: ${Vt.message}`).join(", "));xt.features=xt.features.filter(Vt=>Tt.value.evaluate({zoom:0},Vt))}Te.dynamic?(xt.type==="Feature"&&(xt={type:"FeatureCollection",features:[xt]}),Te.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(xt.features,this.loaded),Te.cluster&&(xt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=Te.cluster?new Ht(function({superclusterOptions:Tt,clusterProperties:Vt}){if(!Vt||!Tt)return Tt;const Yt={},Je={},Pt={accumulated:null,zoom:0},vn={properties:null},Cn=Object.keys(Vt);for(const tr of Cn){const[hr,dr]=Vt[tr],fr=o.M(dr),Wr=o.M(typeof hr=="string"?[hr,["accumulated"],["get",tr]]:hr);Yt[tr]=fr.value,Je[tr]=Wr.value}return Tt.map=tr=>{vn.properties=tr;const hr={};for(const dr of Cn)hr[dr]=Yt[dr].evaluate(Pt,vn);return hr},Tt.reduce=(tr,hr)=>{vn.properties=hr;for(const dr of Cn)Pt.accumulated=tr[dr],tr[dr]=Je[dr].evaluate(Pt,vn)},Tt}(Te)).load(xt.features):Te.dynamic?this._dynamicIndex:function(Tt,Vt){return new Mi(Tt,Vt)}(xt,Te.geojsonVtOptions)}catch(Tt){return ke(Tt)}const $t={};if(lt){const Tt=C(Ke);Tt&&($t.resourceTiming={},$t.resourceTiming[Te.source]=JSON.parse(JSON.stringify(Tt)))}ke(null,$t)}})}reloadTile(Te,ke){const Ke=this.loaded;return Ke&&Ke[Te.uid]?Te.partial?ke(null,void 0):super.reloadTile(Te,ke):this.loadTile(Te,ke)}loadGeoJSON(Te,ke){if(Te.request)o.n(Te.request,ke);else{if(typeof Te.data!="string")return ke(new Error(`Input data given to '${Te.source}' is not a valid GeoJSON object.`));try{return ke(null,JSON.parse(Te.data))}catch{return ke(new Error(`Input data given to '${Te.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Te,ke){try{ke(null,this._geoJSONIndex.getClusterExpansionZoom(Te.clusterId))}catch(Ke){ke(Ke)}}getClusterChildren(Te,ke){try{ke(null,this._geoJSONIndex.getChildren(Te.clusterId))}catch(Ke){ke(Ke)}}getClusterLeaves(Te,ke){try{ke(null,this._geoJSONIndex.getLeaves(Te.clusterId,Te.limit,Te.offset))}catch(Ke){ke(Ke)}}}class fi{constructor(Te,ke){this.tileID=new o.aA(Te.tileID.overscaledZ,Te.tileID.wrap,Te.tileID.canonical.z,Te.tileID.canonical.x,Te.tileID.canonical.y),this.tileZoom=Te.tileZoom,this.uid=Te.uid,this.zoom=Te.zoom,this.canonical=Te.tileID.canonical,this.pixelRatio=Te.pixelRatio,this.tileSize=Te.tileSize,this.source=Te.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Te.projection,this.brightness=ke}parse(Te,ke,Ke,lt){this.status="parsing";const nt=new o.aA(Ke.tileID.overscaledZ,Ke.tileID.wrap,Ke.tileID.canonical.z,Ke.tileID.canonical.x,Ke.tileID.canonical.y),xt={},$t=ke.familiesBySource[Ke.source],Tt=new o.dR(nt,Ke.promoteId);return Tt.bucketLayerIDs=[],Tt.is3DTile=!0,o.e0(Te).then(Vt=>{if(!Vt)return lt(new Error("Could not parse tile"));const Yt=o.e1(Vt,1/o.c8(Ke.tileID.canonical)),Je=Vt.json.extensionsUsed&&Vt.json.extensionsUsed.includes("MAPBOX_mesh_features")||Vt.json.asset.extras&&Vt.json.asset.extras.MAPBOX_mesh_features,Pt=Vt.json.extensionsUsed&&Vt.json.extensionsUsed.includes("EXT_meshopt_compression"),vn=new o.a3(this.zoom,{brightness:this.brightness});for(const Cn in $t)for(const tr of $t[Cn]){const hr=tr[0];Tt.bucketLayerIDs.push(tr.map(fr=>fr.id)),hr.recalculate(vn,[]);const dr=new o.e2(Yt,nt,Je,Pt,this.brightness,Tt);Je||(dr.needsUpload=!0),xt[hr.fqid]=dr,dr.evaluate(hr)}this.status="done",lt(null,{buckets:xt,featureIndex:Tt})}).catch(Vt=>lt(new Error(Vt.message)))}}class _a{constructor(Te,ke,Ke,lt,nt,xt){this.actor=Te,this.layerIndex=ke,this.brightness=xt,this.loading={},this.loaded={}}loadTile(Te,ke){const Ke=Te.uid,lt=this.loading[Ke]=new fi(Te,this.brightness);o.bc(Te.request,(nt,xt)=>{const $t=!this.loading[Ke];return delete this.loading[Ke],$t||nt?(lt.status="done",$t||(this.loaded[Ke]=lt),ke(nt)):xt&&xt.byteLength!==0?void lt.parse(xt,this.layerIndex,Te,(Tt,Vt)=>{lt.status="done",this.loaded=this.loaded||{},this.loaded[Ke]=lt,Tt||!Vt?ke(Tt):ke(null,Vt)}):(lt.status="done",this.loaded[Ke]=lt,ke())})}reloadTile(Te,ke){const Ke=this.loaded,lt=Te.uid;if(Ke&&Ke[lt]){const nt=Ke[lt];nt.projection=Te.projection,nt.brightness=Te.brightness;const xt=($t,Tt)=>{nt.reloadCallback&&(delete nt.reloadCallback,this.loadTile(Te,ke)),ke($t,Tt)};nt.status==="parsing"?nt.reloadCallback=xt:nt.status==="done"&&this.loadTile(Te,ke)}}abortTile(Te,ke){const Ke=Te.uid;this.loading[Ke]&&delete this.loading[Ke],ke()}removeTile(Te,ke){const Ke=this.loaded,lt=Te.uid;Ke&&Ke[lt]&&delete Ke[lt],ke()}}class Ns{constructor(Te){this.self=Te,this.actor=new o.e3(Te,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.bL({name:"mercator"}),this.workerSourceTypes={vector:U,geojson:Rr,"batched-model":_a},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ke,Ke)=>{if(this.workerSourceTypes[ke])throw new Error(`Worker source with name "${ke}" already registered.`);this.workerSourceTypes[ke]=Ke},this.self.registerRTLTextPlugin=ke=>{if(o.e4.isParsed())throw new Error("RTL text plugin already registered.");o.e4.applyArabicShaping=ke.applyArabicShaping,o.e4.processBidirectionalText=ke.processBidirectionalText,o.e4.processStyledBidirectionalText=ke.processStyledBidirectionalText}}clearCaches(Te,ke,Ke){delete this.layerIndexes[Te],delete this.availableImages[Te],delete this.workerSources[Te],delete this.demWorkerSources[Te],delete this.rasterArrayWorkerSource,Ke()}checkIfReady(Te,ke,Ke){Ke()}setReferrer(Te,ke){this.referrer=ke}spriteLoaded(Te,{scope:ke,isLoaded:Ke}){if(this.isSpriteLoaded[Te]||(this.isSpriteLoaded[Te]={}),this.isSpriteLoaded[Te][ke]=Ke,this.workerSources[Te]&&this.workerSources[Te][ke])for(const lt in this.workerSources[Te][ke]){const nt=this.workerSources[Te][ke][lt];for(const xt in nt){const $t=nt[xt];$t instanceof U&&($t.isSpriteLoaded=Ke,$t.fire(new o.x("isSpriteLoaded")))}}}setImages(Te,{scope:ke,images:Ke},lt){if(this.availableImages[Te]||(this.availableImages[Te]={}),this.availableImages[Te][ke]=Ke,this.workerSources[Te]&&this.workerSources[Te][ke]){for(const nt in this.workerSources[Te][ke]){const xt=this.workerSources[Te][ke][nt];for(const $t in xt)xt[$t].availableImages=Ke}lt()}else lt()}setProjection(Te,ke){this.projections[Te]=o.bL(ke)}setBrightness(Te,ke,Ke){this.brightness=ke,Ke()}setLayers(Te,ke,Ke){this.getLayerIndex(Te,ke.scope).replace(ke.layers,ke.options),Ke()}updateLayers(Te,ke,Ke){this.getLayerIndex(Te,ke.scope).update(ke.layers,ke.removedIds,ke.options),Ke()}loadTile(Te,ke,Ke){ke.projection=this.projections[Te]||this.defaultProjection,this.getWorkerSource(Te,ke.type,ke.source,ke.scope).loadTile(ke,Ke)}loadDEMTile(Te,ke,Ke){this.getDEMWorkerSource(Te,ke.source,ke.scope).loadTile(ke,Ke)}decodeRasterArray(Te,ke,Ke){this.getRasterArrayWorkerSource().decodeRasterArray(ke,Ke)}reloadTile(Te,ke,Ke){ke.projection=this.projections[Te]||this.defaultProjection,this.getWorkerSource(Te,ke.type,ke.source,ke.scope).reloadTile(ke,Ke)}abortTile(Te,ke,Ke){this.getWorkerSource(Te,ke.type,ke.source,ke.scope).abortTile(ke,Ke)}removeTile(Te,ke,Ke){this.getWorkerSource(Te,ke.type,ke.source,ke.scope).removeTile(ke,Ke)}removeSource(Te,ke,Ke){if(!(this.workerSources[Te]&&this.workerSources[Te][ke.scope]&&this.workerSources[Te][ke.scope][ke.type]&&this.workerSources[Te][ke.scope][ke.type][ke.source]))return;const lt=this.workerSources[Te][ke.scope][ke.type][ke.source];delete this.workerSources[Te][ke.scope][ke.type][ke.source],lt.removeSource!==void 0?lt.removeSource(ke,Ke):Ke()}loadWorkerSource(Te,ke,Ke){try{this.self.importScripts(ke.url),Ke()}catch(lt){Ke(lt.toString())}}syncRTLPluginState(Te,ke,Ke){try{o.e4.setState(ke);const lt=o.e4.getPluginURL();if(o.e4.isLoaded()&&!o.e4.isParsed()&&lt!=null){this.self.importScripts(lt);const nt=o.e4.isParsed();Ke(nt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${lt}`),nt)}}catch(lt){Ke(lt.toString())}}setDracoUrl(Te,ke){this.dracoUrl=ke}getAvailableImages(Te,ke){this.availableImages[Te]||(this.availableImages[Te]={});let Ke=this.availableImages[Te][ke];return Ke||(Ke=[]),Ke}getLayerIndex(Te,ke){this.layerIndexes[Te]||(this.layerIndexes[Te]={});let Ke=this.layerIndexes[Te][ke];return Ke||(Ke=this.layerIndexes[Te][ke]=new z,Ke.scope=ke),Ke}getWorkerSource(Te,ke,Ke,lt){return this.workerSources[Te]||(this.workerSources[Te]={}),this.workerSources[Te][lt]||(this.workerSources[Te][lt]={}),this.workerSources[Te][lt][ke]||(this.workerSources[Te][lt][ke]={}),this.isSpriteLoaded[Te]||(this.isSpriteLoaded[Te]={}),this.workerSources[Te][lt][ke][Ke]||(this.workerSources[Te][lt][ke][Ke]=new this.workerSourceTypes[ke]({send:(nt,xt,$t,Tt,Vt,Yt)=>{this.actor.send(nt,xt,$t,Te,Vt,Yt)},scheduler:this.actor.scheduler},this.getLayerIndex(Te,lt),this.getAvailableImages(Te,lt),this.isSpriteLoaded[Te][lt],void 0,this.brightness)),this.workerSources[Te][lt][ke][Ke]}getDEMWorkerSource(Te,ke,Ke){return this.demWorkerSources[Te]||(this.demWorkerSources[Te]={}),this.demWorkerSources[Te][Ke]||(this.demWorkerSources[Te][Ke]={}),this.demWorkerSources[Te][Ke][ke]||(this.demWorkerSources[Te][Ke][ke]=new te),this.demWorkerSources[Te][Ke][ke]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new Z),this.rasterArrayWorkerSource}enforceCacheSizeLimit(Te,ke){o.e5(ke)}getWorkerPerformanceMetrics(Te,ke,Ke){Ke(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ns(self)),Ns}),_(["./shared"],function(o){var C="3.7.0";const k={create:"create",load:"load",fullLoad:"fullLoad"},A={mark(f){performance.mark(f)},measure(f,r,l){performance.measure(f,r,l)}};function z(f){const r=f.name.split("?")[0];return o.a(r)&&r.includes("mapbox-gl.js")?"javascript":o.a(r)&&r.includes("mapbox-gl.css")?"css":o.b(r)?"fontRange":o.c(r)?"sprite":o.i(r)?"style":o.d(r)?"tilejson":"other"}var N,$={},F=function(){if(N)return $;function f(p){return!r(p)}function r(p){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,E,O=new Blob([""],{type:"text/javascript"}),V=URL.createObjectURL(O);try{E=new Worker(V),S=!0}catch{S=!1}return E&&E.terminate(),URL.revokeObjectURL(V),S}()?function(){var S=document.createElement("canvas");S.width=S.height=1;var E=S.getContext("2d");if(!E)return!1;var O=E.getImageData(0,0,1,1);return O&&O.width===S.width}()?(l[b=p&&p.failIfMajorPerformanceCaveat]===void 0&&(l[b]=function(S){var E,O=function(V){var H=document.createElement("canvas"),W=Object.create(f.webGLContextAttributes);return W.failIfMajorPerformanceCaveat=V,H.getContext("webgl2",W)}(S);if(!O)return!1;try{E=O.createShader(O.VERTEX_SHADER)}catch{return!1}return!(!E||O.isContextLost())&&(O.shaderSource(E,"void main() {}"),O.compileShader(E),O.getShaderParameter(E,O.COMPILE_STATUS)===!0)}(b)),l[b]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var b}N=1,$.supported=f,$.notSupportedReason=r;var l={};return f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},$}();function G(f,r,l){const p=document.createElement(f);return r!=null&&(p.className=r),l&&l.appendChild(p),p}function U(f,r,l){const p=document.createElementNS("http://www.w3.org/2000/svg",f);for(const b of Object.keys(r))p.setAttributeNS(null,b,String(r[b]));return l&&l.appendChild(p),p}const te=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Z=te&&te.userSelect!==void 0?"userSelect":"WebkitUserSelect";let q;function X(){te&&Z&&(q=te[Z],te[Z]="none")}function ie(){te&&Z&&(te[Z]=q)}function de(f){f.preventDefault(),f.stopPropagation(),window.removeEventListener("click",de,!0)}function le(){window.addEventListener("click",de,!0),window.setTimeout(()=>{window.removeEventListener("click",de,!0)},0)}function pe(f,r){const l=f.getBoundingClientRect();return ue(f,l,r)}function ge(f,r){const l=f.getBoundingClientRect(),p=[];for(let b=0;b<r.length;b++)p.push(ue(f,l,r[b]));return p}function he(f){return window.InstallTrigger!==void 0&&f.button===2&&f.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function ue(f,r,l){const p=f.offsetWidth===r.width?1:f.offsetWidth/r.width;return new o.P((l.clientX-r.left)*p,(l.clientY-r.top)*p)}const Re="01",Ye="NO_ACCESS_TOKEN";class Ie{constructor(r,l,p){this._transformRequestFn=r,this._customAccessToken=l,this._silenceAuthErrors=!!p,this._createSkuToken()}_createSkuToken(){const r=function(){let l="";for(let p=0;p<10;p++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Re,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,l){return this._transformRequestFn&&this._transformRequestFn(r,l)||{url:r}}normalizeStyleURL(r,l){if(!o.f(r))return r;const p=Me(r);return p.params.push(`sdk=js-${C}`),p.path=`/styles/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeGlyphsURL(r,l){if(!o.f(r))return r;const p=Me(r);return p.path=`/fonts/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeModelURL(r,l){if(!o.f(r))return r;const p=Me(r);return p.path=`/models/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeSourceURL(r,l,p,b){if(!o.f(r))return r;const S=Me(r);return S.path=`/v4/${S.authority}.json`,S.params.push("secure"),p&&S.params.push(`language=${p}`),b&&S.params.push(`worldview=${b}`),this._makeAPIURL(S,this._customAccessToken||l)}normalizeSpriteURL(r,l,p,b){const S=Me(r);return o.f(r)?(S.path=`/styles/v1${S.path}/sprite${l}${p}`,this._makeAPIURL(S,this._customAccessToken||b)):(S.path+=`${l}${p}`,Se(S))}normalizeTileURL(r,l,p){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!o.f(r))return r;const b=Me(r);b.path=b.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||p&&b.authority!=="raster"&&p===512?"@2x":""}${o.m.supported?".webp":"$1"}`),b.authority==="raster"?b.path=`/${o.e.RASTER_URL_PREFIX}${b.path}`:b.authority==="rasterarrays"?b.path=`/${o.e.RASTERARRAYS_URL_PREFIX}${b.path}`:b.authority==="3dtiles"?b.path=`/${o.e.TILES3D_URL_PREFIX}${b.path}`:(b.path=b.path.replace(/^.+\/v4\//,"/"),b.path=`/${o.e.TILE_URL_VERSION}${b.path}`);const S=this._customAccessToken||function(E){for(const O of E){const V=O.match(/^access_token=(.*)$/);if(V)return V[1]}return null}(b.params)||o.e.ACCESS_TOKEN;return o.e.REQUIRE_ACCESS_TOKEN&&S&&this._skuToken&&b.params.push(`sku=${this._skuToken}`),this._makeAPIURL(b,S)}canonicalizeTileURL(r,l){const p=Me(r);if(!p.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!p.path.match(/\.[\w]+$/))return r;let b="mapbox://";p.path.match(/^\/raster\/v1\//)?b+=`raster/${p.path.replace(`/${o.e.RASTER_URL_PREFIX}/`,"")}`:p.path.match(/^\/rasterarrays\/v1\//)?b+=`rasterarrays/${p.path.replace(`/${o.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:b+=`tiles/${p.path.replace(`/${o.e.TILE_URL_VERSION}/`,"")}`;let S=p.params;return l&&(S=S.filter(E=>!E.match(/^access_token=/))),S.length&&(b+=`?${S.join("&")}`),b}canonicalizeTileset(r,l){const p=!!l&&o.f(l),b=[];for(const S of r.tiles||[])o.h(S)?b.push(this.canonicalizeTileURL(S,p)):b.push(S);return b}_makeAPIURL(r,l){const p="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",b=Me(o.e.API_URL);if(r.protocol=b.protocol,r.authority=b.authority,r.protocol==="http"){const S=r.params.indexOf("secure");S>=0&&r.params.splice(S,1)}if(b.path!=="/"&&(r.path=`${b.path}${r.path}`),!o.e.REQUIRE_ACCESS_TOKEN)return Se(r);if(l=l||o.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${p}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${p}`)}return r.params=r.params.filter(S=>S.indexOf("access_token")===-1),r.params.push(`access_token=${l||""}`),Se(r)}}const fe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Me(f){const r=f.match(fe);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Se(f){const r=f.params.length?`?${f.params.join("&")}`:"";return`${f.protocol}://${f.authority}${f.path}${r}`}const ye="mapbox.eventData";function Ce(f){if(!f)return null;const r=f.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(o.j(r[1]))}catch{return null}}class Fe{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const l=Ce(o.e.ACCESS_TOKEN);let p="";return p=l&&l.u?o.k(l.u):o.e.ACCESS_TOKEN||"",r?`${ye}.${r}:${p}`:`${ye}:${p}`}fetchEventData(){const r=o.s("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid");if(r)try{const b=localStorage.getItem(l);b&&(this.eventData=JSON.parse(b));const S=localStorage.getItem(p);S&&(this.anonId=S)}catch{o.w("Unable to read from LocalStorage")}}saveEventData(){const r=o.s("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid"),b=this.anonId;if(r&&b)try{localStorage.setItem(p,b),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData))}catch{o.w("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,l,p,b){if(!o.e.EVENTS_URL)return;const S=Me(o.e.EVENTS_URL);S.params.push(`access_token=${b||o.e.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(r).toISOString()},O=l?o.l(E,l):E,V={url:Se(S),headers:{"Content-Type":"text/plain"},body:JSON.stringify([O])};this.pendingRequest=o.p(V,H=>{this.pendingRequest=null,p(H),this.saveEventData(),this.processRequests(b)})}queueRequest(r,l){this.queue.push(r),this.processRequests(l)}}const it=new class extends Fe{constructor(f){super("appUserTurnstile"),this._customAccessToken=f}postTurnstileEvent(f,r){o.e.EVENTS_URL&&o.e.ACCESS_TOKEN&&Array.isArray(f)&&f.some(l=>o.f(l)||o.h(l))&&this.queueRequest(Date.now(),r)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=Ce(o.e.ACCESS_TOKEN),l=r?r.u:o.e.ACCESS_TOKEN;let p=l!==this.eventData.tokenU;o.v(this.anonId)||(this.anonId=o.u(),p=!0);const b=this.queue.shift();if(this.eventData.lastSuccess){const S=new Date(this.eventData.lastSuccess),E=new Date(b),O=(b-this.eventData.lastSuccess)/864e5;p=p||O>=1||O<-1||S.getDate()!==E.getDate()}else p=!0;p?this.postEvent(b,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:Re,"enabled.telemetry":!1,userId:this.anonId},S=>{S||(this.eventData.lastSuccess=b,this.eventData.tokenU=l)},f):this.processRequests()}},We=it.postTurnstileEvent.bind(it),ut=new class extends Fe{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(f,r,l,p){this.skuToken=r,this.errorCb=p,o.e.EVENTS_URL&&(l||o.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},l):this.errorCb(new Error(Ye)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),o.v(this.anonId)||(this.anonId=o.u()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:Re,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},f))}remove(){this.errorCb=null}},Lt=ut.postMapLoadEvent.bind(ut),Ft=new class extends Fe{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(f){let r=this.mapInstanceIdMap.get(f);return r||(r=o.u(),this.mapInstanceIdMap.set(f,r)),r}getEventId(f){const r=this.eventIdPerMapInstanceMap.get(f)||0;return this.eventIdPerMapInstanceMap.set(f,r+1),r}postStyleLoadEvent(f,r){const{map:l,style:p,importedStyles:b}=r;if(!o.e.EVENTS_URL||!f&&!o.e.ACCESS_TOKEN)return;const S=this.getMapInstanceId(l),E={mapInstanceId:S,eventId:this.getEventId(S),style:p};b.length&&(E.importedStyles=b),this.queueRequest({timestamp:Date.now(),payload:E},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:l}=this.queue.shift();this.postEvent(r,l,()=>{},f)}},mt=Ft.postStyleLoadEvent.bind(Ft),jt=new class extends Fe{constructor(){super("gljs.performance")}postPerformanceEvent(f,r){o.e.EVENTS_URL&&(f||o.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:l}=this.queue.shift(),p=function(b){const S=performance.getEntriesByType("resource"),E=performance.getEntriesByType("mark"),O=function(re){const ve={};if(re){for(const _e in re)if(_e!=="other")for(const xe of re[_e]){const we=`${_e}ResolveRangeMin`,ze=`${_e}ResolveRangeMax`,Ne=`${_e}RequestCount`,Le=`${_e}RequestCachedCount`;ve[we]=Math.min(ve[we]||1/0,xe.startTime),ve[ze]=Math.max(ve[ze]||-1/0,xe.responseEnd);const je=Ue=>{ve[Ue]===void 0&&(ve[Ue]=0),++ve[Ue]};xe.transferSize!==void 0&&xe.transferSize===0&&je(Le),je(Ne)}}return ve}(function(re,ve){const _e={};if(re)for(const xe of re){const we=ve(xe);_e[we]===void 0&&(_e[we]=[]),_e[we].push(xe)}return _e}(S,z)),V=window.devicePixelRatio,H=navigator.connection||navigator.mozConnection||navigator.webkitConnection,W=H?H.effectiveType:void 0,J={counters:[],metadata:[],attributes:[]},ee=(re,ve,_e)=>{_e!=null&&re.push({name:ve,value:_e.toString()})};for(const re in O)ee(J.counters,re,O[re]);if(b.interactionRange[0]!==1/0&&b.interactionRange[1]!==-1/0&&(ee(J.counters,"interactionRangeMin",b.interactionRange[0]),ee(J.counters,"interactionRangeMax",b.interactionRange[1])),E)for(const re of Object.keys(k)){const ve=k[re],_e=E.find(xe=>xe.name===ve);_e&&ee(J.counters,ve,_e.startTime)}return ee(J.counters,"visibilityHidden",b.visibilityHidden),ee(J.attributes,"style",function(re){if(re)for(const ve of re){const _e=ve.name.split("?")[0];if(o.i(_e)){const xe=_e.split("/").slice(-2);if(xe.length===2)return`mapbox://styles/${xe[0]}/${xe[1]}`}}}(S)),ee(J.attributes,"terrainEnabled",b.terrainEnabled?"true":"false"),ee(J.attributes,"fogEnabled",b.fogEnabled?"true":"false"),ee(J.attributes,"projection",b.projection),ee(J.attributes,"zoom",b.zoom),ee(J.metadata,"devicePixelRatio",V),ee(J.metadata,"connectionEffectiveType",W),ee(J.metadata,"navigatorUserAgent",navigator.userAgent),ee(J.metadata,"screenWidth",window.screen.width),ee(J.metadata,"screenHeight",window.screen.height),ee(J.metadata,"windowWidth",window.innerWidth),ee(J.metadata,"windowHeight",window.innerHeight),ee(J.metadata,"mapWidth",b.width/V),ee(J.metadata,"mapHeight",b.height/V),ee(J.metadata,"webglRenderer",b.renderer),ee(J.metadata,"webglVendor",b.vendor),ee(J.metadata,"sdkVersion",C),ee(J.metadata,"sdkIdentifier","mapbox-gl-js"),J}(l);for(const b of p.metadata);for(const b of p.counters);for(const b of p.attributes);this.postEvent(r,p,()=>{},f)}},Ht=jt.postPerformanceEvent.bind(jt),Tn=new class extends Fe{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(f,r,l,p){if(!o.e.API_URL||!o.e.SESSION_PATH)return;const b=Me(o.e.API_URL+o.e.SESSION_PATH);b.params.push(`sku=${r||""}`),b.params.push(`access_token=${p||o.e.ACCESS_TOKEN||""}`);const S={url:Se(b),headers:{"Content-Type":"text/plain"}};this.pendingRequest=o.g(S,E=>{this.pendingRequest=null,l(E),this.saveEventData(),this.processRequests(p)})}getSessionAPI(f,r,l,p){this.skuToken=r,this.errorCb=p,o.e.SESSION_PATH&&o.e.API_URL&&(l||o.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},l):this.errorCb(new Error(Ye)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||this.getSession(l,this.skuToken,p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},f)}remove(){this.errorCb=null}},Pe=Tn.getSessionAPI.bind(Tn),At=new Set;function He(f,r){r?At.add(f):At.delete(f)}class pt{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,l){this._updatedSourceCaches[r]=l,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const l=r.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(r.id),this.setDirty()}removeLayer(r){const l=r.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][r.id]=r,this._updatedLayers[l].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const l in this._updatedLayers)r[l]=r[l]||{},r[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)r[l]=r[l]||{},r[l].removedIds=Object.keys(this._removedLayers[l]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(r){this._updatedImages.add(r),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function et(f){const{userImage:r}=f;return!!(r&&r.render&&r.render())&&(f.data.replace(new Uint8Array(r.data.buffer)),!0)}class rn extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(r){this.images[r]={},this.loaded[r]=!1,this.updatedImages[r]={},this.patterns[r]={},this.callbackDispatchedThisFrame[r]={},this.atlasImage[r]=new o.r({width:1,height:1})}isLoaded(){for(const r in this.loaded)if(!this.loaded[r])return!1;return!0}setLoaded(r,l){if(this.loaded[l]!==r&&(this.loaded[l]=r,r)){for(const{ids:p,callback:b}of this.requestors)this._notify(p,l,b);this.requestors=[]}}hasImage(r,l){return!!this.getImage(r,l)}getImage(r,l){return this.images[l][r]}addImage(r,l,p){this._validate(r,p)&&(this.images[l][r]=p)}_validate(r,l){let p=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "stretchX" value`))),p=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "stretchY" value`))),p=!1),this._validateContent(l.content,l)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "content" value`))),p=!1),p}_validateStretch(r,l){if(!r)return!0;let p=0;for(const b of r){if(b[0]<p||b[1]<b[0]||l<b[1])return!1;p=b[1]}return!0}_validateContent(r,l){return!(r&&(r.length!==4||r[0]<0||l.data.width<r[0]||r[1]<0||l.data.height<r[1]||r[2]<0||l.data.width<r[2]||r[3]<0||l.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,l,p){p.version=this.images[l][r].version+1,this.images[l][r]=p,this.updatedImages[l][r]=!0}removeImage(r,l){const p=this.images[l][r];delete this.images[l][r],delete this.patterns[l][r],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(r){return Object.keys(this.images[r])}getImages(r,l,p){let b=!0;const S=!!this.loaded[l];if(!S)for(const E of r)this.images[l][E]||(b=!1);S||b?this._notify(r,l,p):this.requestors.push({ids:r,scope:l,callback:p})}getUpdatedImages(r){return this.updatedImages[r]}_notify(r,l,p){const b={};for(const S of r){this.images[l][S]||this.fire(new o.x("styleimagemissing",{id:S}));const E=this.images[l][S];E?b[S]={data:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)}:o.w(`Image "${S}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,b)}getPixelSize(r){const{width:l,height:p}=this.atlasImage[r];return{width:l,height:p}}getPattern(r,l,p){const b=this.patterns[l][r],S=this.getImage(r,l);if(!S)return null;if(b&&b.position.version===S.version)return b.position;if(b)b.position.version=S.version;else{const E={w:S.data.width+2*o.y,h:S.data.height+2*o.y,x:0,y:0},O=new o.I(E,S,o.y);this.patterns[l][r]={bin:E,position:O}}return this._updatePatternAtlas(l,p),this.patterns[l][r].position}bind(r,l){const p=r.gl;let b=this.atlasTexture[l];b?this.dirty&&(b.update(this.atlasImage[l]),this.dirty=!1):(b=new o.T(r,this.atlasImage[l],p.RGBA8),this.atlasTexture[l]=b),b.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(r,l){const p=[];for(const O in this.patterns[r])p.push(this.patterns[r][O].bin);const{w:b,h:S}=o.z(p),E=this.atlasImage[r];E.resize({width:b||1,height:S||1});for(const O in this.patterns[r]){const{bin:V,position:H}=this.patterns[r][O];let W=H.padding;const J=V.x+W,ee=V.y+W,re=this.images[r][O].data,ve=re.width,_e=re.height;W=W>1?W-1:W,o.r.copy(re,E,{x:0,y:0},{x:J,y:ee},{width:ve,height:_e},l),o.r.copy(re,E,{x:0,y:_e-W},{x:J,y:ee-W},{width:ve,height:W},l),o.r.copy(re,E,{x:0,y:0},{x:J,y:ee+_e},{width:ve,height:W},l),o.r.copy(re,E,{x:ve-W,y:0},{x:J-W,y:ee},{width:W,height:_e},l),o.r.copy(re,E,{x:0,y:0},{x:J+ve,y:ee},{width:W,height:_e},l),o.r.copy(re,E,{x:ve-W,y:_e-W},{x:J-W,y:ee-W},{width:W,height:W},l),o.r.copy(re,E,{x:0,y:_e-W},{x:J+ve,y:ee-W},{width:W,height:W},l),o.r.copy(re,E,{x:0,y:0},{x:J+ve,y:ee+_e},{width:W,height:W},l),o.r.copy(re,E,{x:ve-W,y:0},{x:J-W,y:ee+_e},{width:W,height:W},l)}this.dirty=!0}beginFrame(){for(const r in this.images)this.callbackDispatchedThisFrame[r]={}}dispatchRenderCallbacks(r,l){for(const p of r){if(this.callbackDispatchedThisFrame[l][p])continue;this.callbackDispatchedThisFrame[l][p]=!0;const b=this.images[l][p];et(b)&&this.updateImage(p,l,b)}}}function kt(f){const r=f.key,l=f.value,p=f.valueSpec||{},b=f.objectElementValidators||{},S=f.style,E=f.styleSpec;let O=[];const V=o.B(l);if(V!=="object")return[new o.V(r,l,`object expected, ${V} found`)];for(const H in l){const W=H.split(".")[0];let J;b[W]?J=b[W]:p[W]?J=Hn:b["*"]?J=b["*"]:p["*"]&&(J=Hn),J?O=O.concat(J({key:(r&&`${r}.`)+H,value:l[H],valueSpec:p[W]||p["*"],style:S,styleSpec:E,object:l,objectKey:H},l)):O.push(new o.A(r,l[H],`unknown property "${H}"`))}for(const H in p)b[H]||p[H].required&&p[H].default===void 0&&l[H]===void 0&&O.push(new o.V(r,l,`missing required property "${H}"`));return O}function zt(f){const r=f.value,l=f.valueSpec,p=f.style,b=f.styleSpec,S=f.key,E=f.arrayElementValidator||Hn;if(o.B(r)!=="array")return[new o.V(S,r,`array expected, ${o.B(r)} found`)];if(l.length&&r.length!==l.length)return[new o.V(S,r,`array length ${l.length} expected, length ${r.length} found`)];if(l["min-length"]&&r.length<l["min-length"])return[new o.V(S,r,`array length at least ${l["min-length"]} expected, length ${r.length} found`)];let O={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};b.$version<7&&(O.function=l.function),o.B(l.value)==="object"&&(O=l.value);let V=[];for(let H=0;H<r.length;H++)V=V.concat(E({array:r,arrayIndex:H,value:r[H],valueSpec:O,style:p,styleSpec:b,key:`${S}[${H}]`},!0));return V}function Mt(f){const r=f.key,l=f.value,p=f.valueSpec;let b=o.B(l);if(b==="number"&&l!=l&&(b="NaN"),b!=="number")return[new o.V(r,l,`number expected, ${b} found`)];if("minimum"in p){let S=p.minimum;if(o.B(p.minimum)==="array"&&(S=p.minimum[f.arrayIndex]),l<S)return[new o.V(r,l,`${l} is less than the minimum value ${S}`)]}if("maximum"in p){let S=p.maximum;if(o.B(p.maximum)==="array"&&(S=p.maximum[f.arrayIndex]),l>S)return[new o.V(r,l,`${l} is greater than the maximum value ${S}`)]}return[]}function en(f){const r=f.valueSpec,l=o.D(f.value.type);let p,b,S,E={};const O=l!=="categorical"&&f.value.property===void 0,V=!O,H=o.B(f.value.stops)==="array"&&o.B(f.value.stops[0])==="array"&&o.B(f.value.stops[0][0])==="object",W=kt({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(re){if(l==="identity")return[new o.V(re.key,re.value,'identity function may not have a "stops" property')];let ve=[];const _e=re.value;return ve=ve.concat(zt({key:re.key,value:_e,valueSpec:re.valueSpec,style:re.style,styleSpec:re.styleSpec,arrayElementValidator:J})),o.B(_e)==="array"&&_e.length===0&&ve.push(new o.V(re.key,_e,"array must have at least one stop")),ve},default:function(re){return Hn({key:re.key,value:re.value,valueSpec:r,style:re.style,styleSpec:re.styleSpec})}}});return l==="identity"&&O&&W.push(new o.V(f.key,f.value,'missing required property "property"')),l==="identity"||f.value.stops||W.push(new o.V(f.key,f.value,'missing required property "stops"')),l==="exponential"&&f.valueSpec.expression&&!o.F(f.valueSpec)&&W.push(new o.V(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(V&&!o.G(f.valueSpec)?W.push(new o.V(f.key,f.value,"property functions not supported")):O&&!o.H(f.valueSpec)&&W.push(new o.V(f.key,f.value,"zoom functions not supported"))),l!=="categorical"&&!H||f.value.property!==void 0||W.push(new o.V(f.key,f.value,'"property" property is required')),W;function J(re){let ve=[];const _e=re.value,xe=re.key;if(o.B(_e)!=="array")return[new o.V(xe,_e,`array expected, ${o.B(_e)} found`)];if(_e.length!==2)return[new o.V(xe,_e,`array length 2 expected, length ${_e.length} found`)];if(H){if(o.B(_e[0])!=="object")return[new o.V(xe,_e,`object expected, ${o.B(_e[0])} found`)];if(_e[0].zoom===void 0)return[new o.V(xe,_e,"object stop key must have zoom")];if(_e[0].value===void 0)return[new o.V(xe,_e,"object stop key must have value")];const we=o.D(_e[0].zoom);if(typeof we!="number")return[new o.V(xe,_e[0].zoom,"stop zoom values must be numbers")];if(S&&S>we)return[new o.V(xe,_e[0].zoom,"stop zoom values must appear in ascending order")];we!==S&&(S=we,b=void 0,E={}),ve=ve.concat(kt({key:`${xe}[0]`,value:_e[0],valueSpec:{zoom:{}},style:re.style,styleSpec:re.styleSpec,objectElementValidators:{zoom:Mt,value:ee}}))}else ve=ve.concat(ee({key:`${xe}[0]`,value:_e[0],valueSpec:{},style:re.style,styleSpec:re.styleSpec},_e));return o.J(o.K(_e[1]))?ve.concat([new o.V(`${xe}[1]`,_e[1],"expressions are not allowed in function stops.")]):ve.concat(Hn({key:`${xe}[1]`,value:_e[1],valueSpec:r,style:re.style,styleSpec:re.styleSpec}))}function ee(re,ve){const _e=o.B(re.value),xe=o.D(re.value),we=re.value!==null?re.value:ve;if(p){if(_e!==p)return[new o.V(re.key,we,`${_e} stop domain type must match previous stop domain type ${p}`)]}else p=_e;if(_e!=="number"&&_e!=="string"&&_e!=="boolean"&&typeof xe!="number"&&typeof xe!="string"&&typeof xe!="boolean")return[new o.V(re.key,we,"stop domain value must be a number, string, or boolean")];if(_e!=="number"&&l!=="categorical"){let ze=`number expected, ${_e} found`;return o.G(r)&&l===void 0&&(ze+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new o.V(re.key,we,ze)]}return l!=="categorical"||_e!=="number"||typeof xe=="number"&&isFinite(xe)&&Math.floor(xe)===xe?l!=="categorical"&&_e==="number"&&typeof xe=="number"&&typeof b=="number"&&b!==void 0&&xe<b?[new o.V(re.key,we,"stop domain values must appear in ascending order")]:(b=xe,l==="categorical"&&xe in E?[new o.V(re.key,we,"stop domain values must be unique")]:(E[xe]=!0,[])):[new o.V(re.key,we,`integer expected, found ${String(xe)}`)]}}function sn(f){const r=(f.expressionContext==="property"?o.L:o.M)(o.K(f.value),f.valueSpec);if(r.result==="error")return r.value.map(p=>new o.V(`${f.key}${p.key}`,f.value,p.message));const l=r.value.expression||r.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!l.outputDefined())return[new o.V(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!o.N(l))return[new o.V(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter")return dn(l,f);if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!o.O(l,["zoom","feature-state"]))return[new o.V(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!o.Q(l))return[new o.V(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function dn(f,r){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const b of r.valueSpec.expression.parameters)l.delete(b);if(l.size===0)return[];const p=[];return f instanceof o.S&&l.has(f.name)?[new o.V(r.key,r.value,`["${f.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(f.eachChild(b=>{p.push(...dn(b,r))}),p)}function Pn(f){const r=f.key,l=f.value,p=f.valueSpec,b=[];return Array.isArray(p.values)?p.values.indexOf(o.D(l))===-1&&b.push(new o.V(r,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(p.values).indexOf(o.D(l))===-1&&b.push(new o.V(r,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),b}function Ot(f){return o.W(o.K(f.value))?sn(o.C({},f,{expressionContext:"filter",valueSpec:f.styleSpec[`filter_${f.layerType||"fill"}`]})):Zt(f)}function Zt(f){const r=f.value,l=f.key;if(o.B(r)!=="array")return[new o.V(l,r,`array expected, ${o.B(r)} found`)];const p=f.styleSpec;let b,S=[];if(r.length<1)return[new o.V(l,r,"filter array must have at least 1 element")];switch(S=S.concat(Pn({key:`${l}[0]`,value:r[0],valueSpec:p.filter_operator,style:f.style,styleSpec:f.styleSpec})),o.D(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&o.D(r[1])==="$type"&&S.push(new o.V(l,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&S.push(new o.V(l,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(b=o.B(r[1]),b!=="string"&&S.push(new o.V(`${l}[1]`,r[1],`string expected, ${b} found`)));for(let E=2;E<r.length;E++)b=o.B(r[E]),o.D(r[1])==="$type"?S=S.concat(Pn({key:`${l}[${E}]`,value:r[E],valueSpec:p.geometry_type,style:f.style,styleSpec:f.styleSpec})):b!=="string"&&b!=="number"&&b!=="boolean"&&S.push(new o.V(`${l}[${E}]`,r[E],`string, number, or boolean expected, ${b} found`));break;case"any":case"all":case"none":for(let E=1;E<r.length;E++)S=S.concat(Zt({key:`${l}[${E}]`,value:r[E],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":b=o.B(r[1]),r.length!==2?S.push(new o.V(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):b!=="string"&&S.push(new o.V(`${l}[1]`,r[1],`string expected, ${b} found`))}return S}function jn(f,r){const l=f.key,p=f.style,b=f.layer,S=f.styleSpec,E=f.value,O=f.objectKey,V=S[`${r}_${f.layerType}`];if(!V)return[];const H=O.match(/^(.*)-transition$/);if(r==="paint"&&H&&V[H[1]]&&V[H[1]].transition)return Hn({key:l,value:E,valueSpec:S.transition,style:p,styleSpec:S});const W=f.valueSpec||V[O];if(!W)return[new o.A(l,E,`unknown property "${O}"`)];let J;if(o.B(E)==="string"&&o.G(W)&&!W.tokens&&(J=/^{([^}]+)}$/.exec(E))){const re=`\`{ "type": "identity", "property": ${J?JSON.stringify(J[1]):'"_"'} }\``;return[new o.V(l,E,`"${O}" does not support interpolation syntax
Use an identity property function instead: ${re}.`)]}const ee=[];if(f.layerType==="symbol")O!=="text-field"||!p||p.glyphs||p.imports||ee.push(new o.V(l,E,'use of "text-field" requires a style "glyphs" property')),O==="text-font"&&o.X(o.K(E))&&o.D(E.type)==="identity"&&ee.push(new o.V(l,E,'"text-font" does not support identity functions'));else if(f.layerType==="model"&&r==="paint"&&b&&b.layout&&b.layout.hasOwnProperty("model-id")&&o.G(W)&&(o.Y(W)||o.H(W))){const re=o.L(o.K(E),W),ve=re.value.expression||re.value._styleExpression.expression;ve&&!o.O(ve,["measure-light"])&&(O==="model-emissive-strength"&&o.Q(ve)&&o.N(ve)||ee.push(new o.V(l,E,`${O} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ee.concat(Hn({key:f.key,value:E,valueSpec:W,style:p,styleSpec:S,expressionContext:"property",propertyType:r,propertyKey:O}))}function ir(f){return jn(f,"paint")}function ur(f){return jn(f,"layout")}function ar(f){let r=[];const l=f.value,p=f.key,b=f.style,S=f.styleSpec;l.type||l.ref||r.push(new o.V(p,l,'either "type" or "ref" is required'));let E=o.D(l.type);const O=o.D(l.ref);if(l.id){const V=o.D(l.id);for(let H=0;H<f.arrayIndex;H++){const W=b.layers[H];o.D(W.id)===V&&r.push(new o.V(p,l.id,`duplicate layer id "${l.id}", previously used at line ${W.id.__line__}`))}}if("ref"in l){let V;["type","source","source-layer","filter","layout"].forEach(H=>{H in l&&r.push(new o.V(p,l[H],`"${H}" is prohibited for ref layers`))}),b.layers.forEach(H=>{o.D(H.id)===O&&(V=H)}),V?V.ref?r.push(new o.V(p,l.ref,"ref cannot reference another ref layer")):E=o.D(V.type):typeof O=="string"&&r.push(new o.V(p,l.ref,`ref layer "${O}" not found`))}else if(E!=="background"&&E!=="sky"&&E!=="slot")if(l.source){const V=b.sources&&b.sources[l.source],H=V&&o.D(V.type);V?H==="vector"&&E==="raster"?r.push(new o.V(p,l.source,`layer "${l.id}" requires a raster source`)):H==="raster"&&E!=="raster"?r.push(new o.V(p,l.source,`layer "${l.id}" requires a vector source`)):H!=="vector"||l["source-layer"]?H==="raster-dem"&&E!=="hillshade"?r.push(new o.V(p,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):H!=="raster-array"||["raster","raster-particle"].includes(E)?E!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||H==="geojson"&&V.lineMetrics?E==="raster-particle"&&H!=="raster-array"&&r.push(new o.V(p,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):r.push(new o.V(p,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new o.V(p,l.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new o.V(p,l,`layer "${l.id}" must specify a "source-layer"`)):r.push(new o.V(p,l.source,`source "${l.source}" not found`))}else r.push(new o.V(p,l,'missing required property "source"'));return r=r.concat(kt({key:p,value:l,valueSpec:S.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Hn({key:`${p}.type`,value:l.type,valueSpec:S.layer.type,style:f.style,styleSpec:f.styleSpec,object:l,objectKey:"type"}),filter:V=>Ot(o.C({layerType:E},V)),layout:V=>kt({layer:l,key:V.key,value:V.value,valueSpec:{},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{"*":H=>ur(o.C({layerType:E},H))}}),paint:V=>kt({layer:l,key:V.key,value:V.value,valueSpec:{},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{"*":H=>ir(o.C({layerType:E,layer:l},H))}})}})),r}function wr(f){const r=f.value,l=f.key,p=o.B(r);return p!=="string"?[new o.V(l,r,`string expected, ${p} found`)]:[]}const Xr={promoteId:function({key:f,value:r}){if(o.B(r)==="string")return wr({key:f,value:r});{const l=[];for(const p in r)l.push(...wr({key:`${f}.${p}`,value:r[p]}));return l}}};function Rt(f){const r=f.value,l=f.key,p=f.styleSpec,b=f.style;if(!r.type)return[new o.V(l,r,'"type" is required')];const S=o.D(r.type);let E=[];switch(["vector","raster","raster-dem","raster-array"].includes(S)&&(r.url||r.tiles||E.push(new o.A(l,r,'Either "url" or "tiles" is required.'))),S){case"vector":case"raster":case"raster-dem":case"raster-array":return E=E.concat(kt({key:l,value:r,valueSpec:p[`source_${S.replace("-","_")}`],style:f.style,styleSpec:p,objectElementValidators:Xr})),E;case"geojson":if(E=kt({key:l,value:r,valueSpec:p.source_geojson,style:b,styleSpec:p,objectElementValidators:Xr}),r.cluster)for(const O in r.clusterProperties){const[V,H]=r.clusterProperties[O],W=typeof V=="string"?[V,["accumulated"],["get",O]]:V;E.push(...sn({key:`${l}.${O}.map`,value:H,expressionContext:"cluster-map"})),E.push(...sn({key:`${l}.${O}.reduce`,value:W,expressionContext:"cluster-reduce"}))}return E;case"video":return kt({key:l,value:r,valueSpec:p.source_video,style:b,styleSpec:p});case"image":return kt({key:l,value:r,valueSpec:p.source_image,style:b,styleSpec:p});case"canvas":return[new o.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Pn({key:`${l}.type`,value:r.type,valueSpec:{values:_n(p)},style:b,styleSpec:p})}}function _n(f){return f.source.reduce((r,l)=>{const p=f[l];return p.type.type==="enum"&&(r=r.concat(Object.keys(p.type.values))),r},[])}function dt(f){const r=f.value,l=f.styleSpec,p=l.light,b=f.style;let S=[];const E=o.B(r);if(r===void 0)return S;if(E!=="object")return S=S.concat([new o.V("light",r,`object expected, ${E} found`)]),S;for(const O in r){const V=O.match(/^(.*)-transition$/);S=S.concat(V&&p[V[1]]&&p[V[1]].transition?Hn({key:O,value:r[O],valueSpec:l.transition,style:b,styleSpec:l}):p[O]?Hn({key:O,value:r[O],valueSpec:p[O],style:b,styleSpec:l}):[new o.V(O,r[O],`unknown property "${O}"`)])}return S}function tn(f){const r=f.value;let l=[];if(!r)return l;const p=o.B(r);if(p!=="object")return l=l.concat([new o.V("light-3d",r,`object expected, ${p} found`)]),l;const b=f.styleSpec,S=b["light-3d"],E=f.key,O=f.style,V=f.style.lights;for(const J of["type","id"])if(!(J in r))return l=l.concat([new o.V("light-3d",r,`missing property ${J} on light`)]),l;if(r.type&&V)for(let J=0;J<f.arrayIndex;J++){const ee=o.D(r.type),re=V[J];o.D(re.type)===ee&&l.push(new o.V(E,r.id,`duplicate light type "${r.type}", previously defined at line ${re.id.__line__}`))}const H=`properties_light_${r.type}`;if(!(H in b))return l=l.concat([new o.V("light-3d",r,`Invalid light type ${r.type}`)]),l;const W=b[H];for(const J in r)if(J==="properties"){const ee=r[J],re=o.B(ee);if(re!=="object")return l=l.concat([new o.V("properties",ee,`object expected, ${re} found`)]),l;for(const ve in ee)l=l.concat(W[ve]?Hn({key:ve,value:ee[ve],valueSpec:W[ve],style:O,styleSpec:b}):[new o.A(f.key,ee[ve],`unknown property "${ve}"`)])}else{const ee=J.match(/^(.*)-transition$/);l=l.concat(ee&&S[ee[1]]&&S[ee[1]].transition?Hn({key:J,value:r[J],valueSpec:b.transition,style:O,styleSpec:b}):S[J]?Hn({key:J,value:r[J],valueSpec:S[J],style:O,styleSpec:b}):[new o.A(J,r[J],`unknown property "${J}"`)])}return l}function Ze(f){const r=f.value,l=f.key,p=f.style,b=f.styleSpec,S=b.terrain;let E=[];const O=o.B(r);if(r===void 0||O==="null")return E;if(O!=="object")return E=E.concat([new o.V("terrain",r,`object expected, ${O} found`)]),E;for(const V in r){const H=V.match(/^(.*)-transition$/);E=E.concat(H&&S[H[1]]&&S[H[1]].transition?Hn({key:V,value:r[V],valueSpec:b.transition,style:p,styleSpec:b}):S[V]?Hn({key:V,value:r[V],valueSpec:S[V],style:p,styleSpec:b}):[new o.A(V,r[V],`unknown property "${V}"`)])}if(r.source){const V=p.sources&&p.sources[r.source],H=V&&o.D(V.type);V?H!=="raster-dem"&&E.push(new o.V(l,r.source,`terrain cannot be used with a source of type ${String(H)}, it only be used with a "raster-dem" source type`)):E.push(new o.V(l,r.source,`source "${r.source}" not found`))}else E.push(new o.V(l,r,'terrain is missing required property "source"'));return E}function gn(f){const r=f.value,l=f.style,p=f.styleSpec,b=p.fog;let S=[];const E=o.B(r);if(r===void 0)return S;if(E!=="object")return S=S.concat([new o.V("fog",r,`object expected, ${E} found`)]),S;for(const O in r){const V=O.match(/^(.*)-transition$/);S=S.concat(V&&b[V[1]]&&b[V[1]].transition?Hn({key:O,value:r[O],valueSpec:p.transition,style:l,styleSpec:p}):b[O]?Hn({key:O,value:r[O],valueSpec:b[O],style:l,styleSpec:p}):[new o.A(O,r[O],`unknown property "${O}"`)])}return S}const rr={"*":()=>[],array:zt,boolean:function(f){const r=f.value,l=f.key,p=o.B(r);return p!=="boolean"?[new o.V(l,r,`boolean expected, ${p} found`)]:[]},number:Mt,color:function(f){const r=f.key,l=f.value,p=o.B(l);return p!=="string"?[new o.V(r,l,`color expected, ${p} found`)]:o.U.parseCSSColor(l)===null?[new o.V(r,l,`color expected, "${l}" found`)]:[]},enum:Pn,filter:Ot,function:en,layer:ar,object:kt,source:Rt,model:o.Z,light:dt,"light-3d":tn,terrain:Ze,fog:gn,string:wr,formatted:function(f){return wr(f).length===0?[]:sn(f)},resolvedImage:function(f){return wr(f).length===0?[]:sn(f)},projection:function(f){const r=f.value,l=f.styleSpec,p=l.projection,b=f.style;let S=[];const E=o.B(r);if(E==="object")for(const O in r)S=S.concat(Hn({key:O,value:r[O],valueSpec:p[O],style:b,styleSpec:l}));else E!=="string"&&(S=S.concat([new o.V("projection",r,`object or string expected, ${E} found`)]));return S},import:function(f){const{value:r,styleSpec:l}=f,{data:p,...b}=r;Object.defineProperty(b,"__line__",{value:r.__line__,enumerable:!1});let S=kt(o.C({},f,{value:b,valueSpec:l.import}));return o.D(b.id)===""&&S.push(new o.V(`${f.key}.id`,b,"import id can't be an empty string")),p&&(S=S.concat(Mi(p,l,{key:`${f.key}.data`}))),S}};function Hn(f,r=!1){const l=f.value,p=f.valueSpec,b=f.styleSpec;if(p.expression&&o.X(o.D(l)))return en(f);if(p.expression&&o.J(o.K(l)))return sn(f);if(p.type&&rr[p.type]){const S=rr[p.type](f);return r===!0&&S.length>0&&o.B(f.value)==="array"?sn(f):S}return kt(o.C({},f,{valueSpec:p.type?b[p.type]:p}))}function eo(f){const r=f.value,l=f.key,p=wr(f);return p.length||(r.indexOf("{fontstack}")===-1&&p.push(new o.V(l,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&p.push(new o.V(l,r,'"glyphs" url must include a "{range}" token'))),p}function Mi(f,r=o._,l={}){return Hn({key:l.key||"",value:f,valueSpec:r.$root,styleSpec:r,style:f,objectElementValidators:{glyphs:eo,"*":()=>[]}})}function mo(f,r=o._){return nt(Mi(f,r))}const bo=f=>nt(Rt(f)),Rr=f=>nt(dt(f)),fi=f=>nt(tn(f)),_a=f=>nt(Ze(f)),Ns=f=>nt(gn(f)),Nt=f=>nt(ar(f)),Te=f=>nt(Ot(f)),ke=f=>nt(ir(f)),Ke=f=>nt(ur(f)),lt=f=>nt(o.Z(f));function nt(f){return f.slice().sort((r,l)=>r.line&&l.line?r.line-l.line:0)}function xt(f,r){let l=!1;if(r&&r.length)for(const p of r)p instanceof o.A?o.w(p.message):(f.fire(new o.t(new Error(p.message))),l=!0);return l}let $t;class Tt extends o.E{constructor(r,l="flat"){super(),this._transitionable=new o.$($t||($t=new o.a0({anchor:new o.a1(o._.light.anchor),position:new o.a2(o._.light.position),color:new o.a1(o._.light.color),intensity:new o.a1(o._.light.intensity)}))),this.setLight(r,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,l,p={}){this._validate(Rr,r,p)||(this._transitionable.setTransitionOrValue(r),this.id=l)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&xt(this,r.call(mo,o.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o._})))}}const Vt=new o.a0({source:new o.a1(o._.terrain.source),exaggeration:new o.a1(o._.terrain.exaggeration)});let Yt=class extends o.E{constructor(f,r,l,p){super(),this.scope=l,this._transitionable=new o.$(Vt,l,p),this._transitionable.setTransitionOrValue(f,p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(f,r){this._transitionable.setTransitionOrValue(f,r)}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}getExaggeration(f){return this._transitioning.possiblyEvaluate(new o.a3(f)).get("exaggeration")}isZoomDependent(){const f=this._transitionable._values.exaggeration;return f!=null&&f.value!=null&&f.value.expression!=null&&f.value.expression instanceof o.a4}};const Je=45,Pt=65,vn=.05;function Cn(f,r,l,p){const b=o.a7(Je,Pt,l),[S,E]=tr(f,p);let O=1-Math.min(1,Math.exp((r-S)/(E-S)*-6));return O*=O*O,O=Math.min(1,1.00747*O),O*b*f.alpha}function tr(f,r){const l=.5/Math.tan(.5*r);return[f.range[0]+l,f.range[1]+l]}function hr(f,r,l,p,b){const S=o.a6.vec3.transformMat4([],[r,l,p],b.mercatorFogMatrix);return Cn(f,o.a6.vec3.length(S),b.pitch,b._fov)}function dr(f,r,l,p,b,S,E){const O=[[l,p,0],[b,p,0],[b,S,0],[l,S,0]];let V=Number.MAX_VALUE,H=-Number.MAX_VALUE;for(const W of O){const J=o.a6.vec3.transformMat4([],W,r),ee=o.a6.vec3.length(J);V=Math.min(V,ee),H=Math.max(H,ee)}return[Cn(f,V,E.pitch,E._fov),Cn(f,H,E.pitch,E._fov)]}const fr=new o.a0({range:new o.a1(o._.fog.range),color:new o.a1(o._.fog.color),"high-color":new o.a1(o._.fog["high-color"]),"space-color":new o.a1(o._.fog["space-color"]),"horizon-blend":new o.a1(o._.fog["horizon-blend"]),"star-intensity":new o.a1(o._.fog["star-intensity"]),"vertical-range":new o.a1(o._.fog["vertical-range"])});class Wr extends o.E{constructor(r,l,p,b){super(),this._transitionable=new o.$(fr,p,new Map(b)),this.set(r,b),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new o.a8(fr),this.scope=p}get state(){const r=this._transform,l=r.projection.name==="globe",p=o.a9(r.zoom),b=this.properties.get("range"),S=[.5,3];return{range:l?[o.aa(S[0],b[0],p),o.aa(S[1],b[1],p)]:b,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,l,p={}){if(this._validate(Ns,r,p))return;const b=o.l({},r);for(const S of Object.keys(o._.fog))b[S]===void 0&&(b[S]=o._.fog[S].default);this._options=b,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.a7(Je,Pt,r))*l.a}getOpacityAtLatLng(r,l){return this._transform.projection.supportsFog?function(p,b,S){const E=o.a5.fromLngLat(b),O=S.elevation?S.elevation.getAtPointOrZero(E):0;return hr(p,E.x,E.y,O,S)}(this.state,r,l):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(r.toUnwrapped());return dr(this.state,l,0,0,o.ab,o.ab,this._transform)}getOpacityForBounds(r,l,p,b,S){return this._transform.projection.supportsFog?dr(this.state,r,l,p,b,S,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?tr(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const p of l){const b=r.points[p];let S;if(b[2]>=0)S=b;else{const E=r.points[p-4];S=o.ac(E,b,E[2]/(E[2]-b[2]))}if(hr(this.state,S[0],S[1],0,this._transform)>=vn)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&xt(this,r.call(mo,o.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o._})))}}class ro extends o.E{constructor(r,l,p,b){super(),this.scope=p,this._options=r,this.properties=new o.a8(l),this._transitionable=new o.$(l,p,new Map(b)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,l){this._options=r,this._transitionable.setTransitionOrValue(r.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let Ut,Rn;class Jn{constructor(r,l,p,b){this.screenBounds=r,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,b)}static createFromScreenPoints(r,l){let p,b;if(r instanceof o.P||typeof r[0]=="number"){const S=o.P.convert(r);p=[S],b=l.isPointAboveHorizon(S)}else{const S=o.P.convert(r[0]),E=o.P.convert(r[1]);p=[S,E],b=o.ae(S,E).every(O=>l.isPointAboveHorizon(O))}return new Jn(p,l.getCameraPoint(),b,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return o.ae(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],b=o.ae(l,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<p.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?b[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(b[3]=this.cameraPoint)),o.af(b,r)}bufferedCameraGeometryGlobe(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],b=o.ae(l,p,r),S=this.cameraPoint.clone();switch(3*((S.y>l.y)+(S.y>p.y))+((S.x>l.x)+(S.x>p.x))){case 0:b[0]=S,b[4]=S.clone();break;case 1:b.splice(1,0,S);break;case 2:b[1]=S;break;case 3:b.splice(4,0,S);break;case 5:b.splice(2,0,S);break;case 6:b[3]=S;break;case 7:b.splice(3,0,S);break;case 8:b[2]=S}return b}containsTile(r,l,p,b=0){const S=r.queryPadding/l._pixelsPerMercatorPixel+1,E=p?this._bufferedCameraMercator(S,l):this._bufferedScreenMercator(S,l);let O=r.tileID.wrap+(E.unwrapped?b:0);const V=E.polygon.map(xe=>o.ag(r.tileTransform,xe,O));if(!o.ah(V,0,0,o.ab,o.ab))return;O=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?b:0);const H=this.screenGeometryMercator.polygon.map(xe=>o.ai(r.tileTransform,xe,O)),W=H.map(xe=>new o.P(xe[0],xe[1])),J=l.getFreeCameraOptions().position||new o.a5(0,0,0),ee=o.ai(r.tileTransform,J,O),re=H.map(xe=>{const we=o.a6.vec3.sub(xe,xe,ee);return o.a6.vec3.normalize(we,we),new o.aj(ee,we)}),ve=o.ak(r,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:W,tilespaceRays:re,bufferedTilespaceGeometry:V,bufferedTilespaceBounds:(_e=o.al(V),_e.min.x=o.ap(_e.min.x,0,o.ab),_e.min.y=o.ap(_e.min.y,0,o.ab),_e.max.x=o.ap(_e.max.x,0,o.ab),_e.max.y=o.ap(_e.max.y,0,o.ab),_e),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:ve};var _e}_bufferedScreenMercator(r,l){const p=jo(r);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let b;return b=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),l):{polygon:this.bufferedScreenGeometry(r).map(S=>l.pointCoordinate3D(S)),unwrapped:!0},this._screenRaycastCache[p]=b,b}}_bufferedCameraMercator(r,l){const p=jo(r);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let b;return b=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),l):{polygon:this.bufferedCameraGeometry(r).map(S=>l.pointCoordinate3D(S)),unwrapped:!0},this._cameraRaycastCache[p]=b,b}}_projectAndResample(r,l){const p=function(S,E){const O=o.a6.mat4.multiply([],E.pixelMatrix,E.globeMatrix),V=[0,-o.aq,0,1],H=[0,o.aq,0,1],W=[0,0,0,1];o.a6.vec4.transformMat4(V,V,O),o.a6.vec4.transformMat4(H,H,O),o.a6.vec4.transformMat4(W,W,O);const J=new o.P(V[0]/V[3],V[1]/V[3]),ee=new o.P(H[0]/H[3],H[1]/H[3]),re=o.an(S,J)&&V[3]<W[3],ve=o.an(S,ee)&&H[3]<W[3];if(!re&&!ve)return null;const _e=function(rt,Qe,ot){for(let gt=1;gt<rt.length;gt++){const ht=go(Qe.pointCoordinate3D(rt[gt-1]).x),ct=go(Qe.pointCoordinate3D(rt[gt]).x);if(ot<0){if(ht<ct)return{idx:gt,t:-ht/(ct-1-ht)}}else if(ct<ht)return{idx:gt,t:(1-ht)/(ct+1-ht)}}return null}(S,E,re?-1:1);if(!_e)return null;const{idx:xe,t:we}=_e;let ze=xe>1?_r(S.slice(0,xe),E):[],Ne=xe<S.length?_r(S.slice(xe),E):[];ze=ze.map(rt=>new o.P(go(rt.x),rt.y)),Ne=Ne.map(rt=>new o.P(go(rt.x),rt.y));const Le=[...ze];Le.length===0&&Le.push(Ne[Ne.length-1]);const je=o.aa(Le[Le.length-1].y,(Ne.length===0?ze[0]:Ne[0]).y,we);let Ue;return Ue=re?[new o.P(0,je),new o.P(0,0),new o.P(1,0),new o.P(1,je)]:[new o.P(1,je),new o.P(1,1),new o.P(0,1),new o.P(0,je)],Le.push(...Ue),Ne.length===0?Le.push(ze[0]):Le.push(...Ne),{polygon:Le.map(rt=>new o.a5(rt.x,rt.y)),unwrapped:!1}}(r,l);if(p)return p;const b=function(S,E){let O=!1,V=-1/0,H=0;for(let J=0;J<S.length-1;J++)S[J].x>V&&(V=S[J].x,H=J);for(let J=0;J<S.length-1;J++){const ee=(H+J)%(S.length-1),re=S[ee],ve=S[ee+1];Math.abs(re.x-ve.x)>.5&&(re.x<ve.x?(re.x+=1,ee===0&&(S[S.length-1].x+=1)):(ve.x+=1,ee+1===S.length-1&&(S[0].x+=1)),O=!0)}const W=o.am(E.center.lng);return O&&W<Math.abs(W-1)&&S.forEach(J=>{J.x-=1}),{polygon:S,unwrapped:O}}(_r(r,l).map(S=>new o.P(go(S.x),S.y)),l);return{polygon:b.polygon.map(S=>new o.a5(S.x,S.y)),unwrapped:b.unwrapped}}}function _r(f,r){return o.ao(f,l=>{const p=r.pointCoordinate3D(l);l.x=p.x,l.y=p.y},1/256)}function go(f){return f<0?1+f%1:f%1}function jo(f){return 100*f|0}function Qs(f,r,l,p,b){const S=function(O,V){if(O)return b(O);if(V){if(f.url&&V.tiles&&f.tiles&&delete f.tiles,V.variants){if(!Array.isArray(V.variants))return b(new Error("variants must be an array"));for(const W of V.variants){if(W==null||typeof W!="object"||W.constructor!==Object)return b(new Error("variant must be an object"));if(!Array.isArray(W.capabilities))return b(new Error("capabilities must be an array"));if(W.capabilities.length===1&&W.capabilities[0]==="meshopt"){V=o.l(V,W);break}}}const H=o.ar(o.l(V,f),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);V.vector_layers&&(H.vectorLayers=V.vector_layers,H.vectorLayerIds=H.vectorLayers.map(W=>W.id)),V.raster_layers&&(H.rasterLayers=V.raster_layers,H.rasterLayerIds=H.rasterLayers.map(W=>W.id)),H.tiles=r.canonicalizeTileset(H,f.url),b(null,H)}},E=function(O,V,H){if(!O)return null;if(!V&&!H)return O;H=H||O.worldview_default;const W=Object.values(O.language||{});if(W.length===0)return null;const J=Object.values(O.worldview||{});if(J.length===0)return null;const ee=W.every(ve=>ve===V),re=J.every(ve=>ve===H);return ee&&re?O:V in(O.language_options||{})||H in(O.worldview_options||{})?null:O.language_options&&O.worldview_options?O:null}(f.data,l,p);return E?o.q.frame(()=>S(null,E)):f.url?o.n(r.transformRequest(r.normalizeSourceURL(f.url,null,l,p),o.R.Source),S):o.q.frame(()=>{const{data:O,...V}=f;S(null,V)})}class Ga{constructor(r,l,p){this.bounds=o.as.convert(this.validateBounds(r)),this.minzoom=l||0,this.maxzoom=p||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const l=Math.pow(2,r.z),p=Math.floor(o.am(this.bounds.getWest())*l),b=Math.floor(o.at(this.bounds.getNorth())*l),S=Math.ceil(o.am(this.bounds.getEast())*l),E=Math.ceil(o.at(this.bounds.getSouth())*l);return r.x>=p&&r.x<S&&r.y>=b&&r.y<E}}class Nh extends o.E{constructor(r,l,p,b){if(super(),this.id=r,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.l(this,o.ar(l,["url","scheme","tileSize","promoteId"])),this._options=o.l({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b),this._tileWorkers={},this._deduped=new o.au}load(r){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map._worldview;this._tileJSONRequest=Qs(this._options,this.map._requestManager,l,p,(b,S)=>{this._tileJSONRequest=null,this._loaded=!0,b?(l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),p&&p.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new o.t(b))):S&&(o.l(this,S),S.bounds&&(this.tileBounds=new Ga(S.bounds,this.minzoom,this.maxzoom)),We(S.tiles,this.map._requestManager._customAccessToken),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),r&&r(b)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=o.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return o.l({},this._options)}loadTile(r,l){const p=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme)),b=this.map._requestManager.transformRequest(p,o.R.Tile),S=this.map.style?this.map.style.getLut(this.scope):null,E={request:b,data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,lut:S?{image:S.image.clone()}:null,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(E.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=l:r.request=r.actor.send("reloadTile",E,O.bind(this));else if(r.actor=this._tileWorkers[p]=this._tileWorkers[p]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",E,O.bind(this),void 0,!0);else{const V=o.aw.call({deduped:this._deduped},E,(H,W)=>{H||!W?O.call(this,H):(E.data={cacheControl:W.cacheControl,expires:W.expires,rawData:W.rawData.slice(0)},r.actor&&r.actor.send("loadTile",E,O.bind(this),void 0,!0))},!0);r.request={cancel:V}}function O(V,H){return delete r.request,r.aborted?l(null):V&&V.status!==404?l(V):(H&&H.resourceTiming&&(r.resourceTiming=H.resourceTiming),this.map._refreshExpiredTiles&&H&&r.setExpiryData(H),r.loadVectorData(H,this.map.painter),o.ax(this.dispatcher),l(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,l){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class fd extends o.E{constructor(r,l,p,b){super(),this.id=r,this.dispatcher=p,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.l({type:"raster"},l),o.l(this,o.ar(l,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"})),this._tileJSONRequest=Qs(this._options,this.map._requestManager,null,null,(l,p)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new o.t(l)):p&&(o.l(this,p),p.bounds&&(this.tileBounds=new Ga(p.bounds,this.minzoom,this.maxzoom)),We(p.tiles),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),r&&r(l)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=o.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return o.l({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,l){const p=o.q.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);r.request=o.o(this.map._requestManager.transformRequest(b,o.R.Tile),(S,E,O,V)=>(delete r.request,r.aborted?(r.state="unloaded",l(null)):S?(r.state="errored",l(S)):E?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:O,expires:V}),r.setTexture(E,this.map.painter),r.state="loaded",o.ax(this.dispatcher),void l(null)):l(null)))}abortTile(r,l){r.request&&(r.request.cancel(),delete r.request),l&&l()}unloadTile(r,l){r.texture&&r.texture instanceof o.T?(r.destroy(!0),r.texture&&r.texture instanceof o.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Nc extends fd{constructor(r,l,p,b){super(r,l,p,b),this.type="raster-array",this.maxzoom=22,this._options=o.l({type:"raster-array"},l)}triggerRepaint(r){const l=this.map.painter._terrain,p=this.map.style.getSourceCache(this.id);l&&l.enabled&&p&&l._clearRenderCacheForTile(p.id,r.tileID),this.map.triggerRepaint()}loadTile(r,l){const p=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),b=this.map._requestManager.transformRequest(p,o.R.Tile);r.requestParams=b,r.actor||(r.actor=this.dispatcher.getActor()),r.request=r.fetchHeader(void 0,(S,E,O,V)=>{if(delete r.request,r.aborted)return r.state="unloaded",l(null);if(S)return S.code===20?void 0:(r.state="errored",l(S));this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:O,expires:V}),r.state="empty",l(null)})}unloadTile(r,l){const p=r.texture;p&&p instanceof o.T?(r.destroy(!0),this.map.painter.saveTileTexture(p)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,l,p){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(l,p,(b,S)=>{if(b)return r.state="errored",this.fire(new o.t(b)),void this.triggerRepaint(r);S&&(r.setTexture(S,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find(({id:S})=>S===r),p=l&&l.fields,b=p&&p.bands&&p.bands;return b?b[0]:0}getTextureDescriptor(r,l,p){if(!r)return;const b=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!b)return;let S=null;l instanceof o.aB?S=l.paint.get("raster-array-band"):l instanceof o.aC&&(S=l.paint.get("raster-particle-array-band"));const E=S||this.getInitialBand(b);if(E!=null)if(r.textureDescriptor){if(!r.updateNeeded(b,E)||p)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,b,E)}}const $h={vector:Nh,raster:fd,"raster-dem":class extends fd{constructor(f,r,l,p){super(f,r,l,p),this.type="raster-dem",this.maxzoom=22,this._options=o.l({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(f,r){const l=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(b,S){b&&(f.state="errored",r(b)),S&&(f.dem=S,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",r(null))}f.request=o.o(this.map._requestManager.transformRequest(l,o.R.Tile),(function(b,S,E,O){if(delete f.request,f.aborted)f.state="unloaded",r(null);else if(b)f.state="errored",r(b);else if(S){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:E,expires:O});const V=ImageBitmap&&S instanceof ImageBitmap&&o.ay(),H=1-(S.width-o.az(S.width))/2;H<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const W=V?S:o.q.getImageData(S,H),J={uid:f.uid,coord:f.tileID,source:this.id,scope:this.scope,rawImageData:W,encoding:this.encoding,padding:H};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",J,p.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(f){const r=f.canonical,l=Math.pow(2,r.z),p=(r.x-1+l)%l,b=r.x===0?f.wrap-1:f.wrap,S=(r.x+1+l)%l,E=r.x+1===l?f.wrap+1:f.wrap,O={};return O[new o.aA(f.overscaledZ,b,r.z,p,r.y).key]={backfilled:!1},O[new o.aA(f.overscaledZ,E,r.z,S,r.y).key]={backfilled:!1},r.y>0&&(O[new o.aA(f.overscaledZ,b,r.z,p,r.y-1).key]={backfilled:!1},O[new o.aA(f.overscaledZ,f.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},O[new o.aA(f.overscaledZ,E,r.z,S,r.y-1).key]={backfilled:!1}),r.y+1<l&&(O[new o.aA(f.overscaledZ,b,r.z,p,r.y+1).key]={backfilled:!1},O[new o.aA(f.overscaledZ,f.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},O[new o.aA(f.overscaledZ,E,r.z,S,r.y+1).key]={backfilled:!1}),O}},"raster-array":Nc,geojson:class extends o.E{constructor(f,r,l,p){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(p),this._data=r.data,this._options=o.l({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.minzoom!==void 0&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const b=o.ab/this.tileSize;this.workerOptions=o.l({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*b,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*b,extent:o.ab,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:o.ab,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*b,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}updateData(f){if(!this._options.dynamic)return this.fire(new o.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof f!="string"&&(f.type==="Feature"&&(f={type:"FeatureCollection",features:[f]}),f.type!=="FeatureCollection"))return this.fire(new o.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof f!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const r=new Map;for(const l of this._data.features)r.set(l.id,l);for(const l of f.features)r.set(l.id,l);this._data.features=[...r.values()]}else this._data=f;return this._updateWorkerData(!0),this}getClusterExpansionZoom(f,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id,scope:this.scope},r),this}getClusterChildren(f,r){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id,scope:this.scope},r),this}getClusterLeaves(f,r,l,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:f,limit:r,offset:l},p),this}_updateWorkerData(f=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.x("dataloading",{dataType:"source"})),this._loaded=!1;const r=o.l({append:f},this.workerOptions);r.scope=this.scope;const l=this._data;typeof l=="string"?(r.request=this.map._requestManager.transformRequest(o.q.resolveURL(l),o.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(p,b)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new o.t(p));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(S.resourceTiming=b.resourceTiming[this.id]),f&&(this._partialReload=!0),this.fire(new o.x("data",S)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(f),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,r){const l=f.actor?"reloadTile":"loadTile";f.actor=this.actor;const p=this.map.style?this.map.style.getLut(this.scope):null,b=this._partialReload,S={type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:p?{image:p.image.clone()}:null,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:b};f.request=this.actor.send(l,S,(E,O)=>b&&!O?(f.state="loaded",r(null)):(delete f.request,f.destroy(),f.aborted?r(null):E?r(E):(f.loadVectorData(O,this.map.painter,l==="reloadTile"),r(null))),void 0,l==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f,r){this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id,scope:this.scope}),f.destroy()}onRemove(f){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends o.aD{constructor(f,r,l,p){super(f,r,l,p),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const r of f.urls)this.urls.push(this.map._requestManager.transformRequest(r,o.R.Source).url);o.aE(this.urls,(r,l)=>{this._loaded=!0,r?this.fire(new o.t(r)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const r=this.video.seekable;f<r.start(0)||f>r.end(0)?this.fire(new o.t(new o.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,r=f.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(f,this.video,r.RGBA8),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:o.aD,model:class extends o.E{constructor(f,r,l,p){super(),this.id=f,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const f=[];for(const r in this._options.models){const l=this._options.models[r],p=o.aG(this.map._requestManager.transformRequest(l.uri,o.R.Model).url).then(b=>{if(!b)return;const S=o.aH(b),E=new o.aI(r,l.position,l.orientation,S);E.computeBoundsAndApplyParent(),this.models.push(E)}).catch(b=>{this.fire(new o.t(new Error(`Could not load model ${r} from ${l.uri}: ${b.message}`)))});f.push(p)}return Promise.allSettled(f).then(()=>{this._loaded=!0,this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this.fire(new o.t(new Error(`Could not load models: ${r.message}`)))})}onAdd(f){this.map=f,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(f,r){}serialize(){return{type:"model"}}},"batched-model":class extends o.E{constructor(f,r,l,p){super(),this.type="batched-model",this.id=f,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(p)}onAdd(f){this.map=f,this.load()}load(f){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map._worldview;this._tileJSONRequest=Qs(this._options,this.map._requestManager,r,l,(p,b)=>{this._tileJSONRequest=null,this._loaded=!0,p?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new o.t(p))):b&&(o.l(this,b),b.bounds&&(this.tileBounds=new Ga(b.bounds,this.minzoom,this.maxzoom)),We(b.tiles,this.map._requestManager._customAccessToken),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),f&&f(p)})}hasTransition(){return!1}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}loaded(){return this._loaded}loadTile(f,r){const l=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(l,o.R.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:f.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(f.actor&&f.state!=="expired")if(f.state==="loading")f.reloadCallback=r;else{if(f.buckets){const S=Object.values(f.buckets);for(const E of S)E.dirty=!0;return void(f.state="loaded")}f.request=f.actor.send("reloadTile",p,b.bind(this))}else f.actor=this.dispatcher.getActor(),f.request=f.actor.send("loadTile",p,b.bind(this),void 0,!0);function b(S,E){return f.aborted?r(null):S&&S.status!==404?r(S):(E&&(E.resourceTiming&&(f.resourceTiming=E.resourceTiming),this.map._refreshExpiredTiles&&f.setExpiryData(E),f.buckets={...f.buckets,...E.buckets},E.featureIndex&&(f.latestFeatureIndex=E.featureIndex)),f.state="loaded",void r(null))}}serialize(){return o.l({},this._options)}},canvas:class extends o.aD{constructor(f,r,l,p){super(f,r,l,p),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(S=>typeof S!="number"))||this.fire(new o.t(new o.V(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.t(new o.V(`sources.${f}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new o.t(new o.V(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new o.t(new o.V(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.t(new o.V(`sources.${f}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(f){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!f&&!this._playing||this.texture instanceof o.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(r,this.canvas,r.gl.RGBA8,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends o.E{constructor(f,r,l,p){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=r,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.t(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.t(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ga(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),o.l(this,o.ar(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this.map=f,this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:r,y:l,z:p}=f.canonical;return this._implementation.hasTile({x:r,y:l,z:p})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,r){const{x:l,y:p,z:b}=f.tileID.canonical,S=new AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:l,y:p,z:b},{signal:S.signal})).then((function(E){return delete f.request,f.aborted?(f.state="unloaded",r(null)):E===void 0?(f.state="errored",r(null)):E===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",r(null)):function(O){return O instanceof ImageData||O instanceof HTMLCanvasElement||O instanceof ImageBitmap||O instanceof HTMLImageElement}(E)?(this.loadTileData(f,E),f.state="loaded",void r(null)):(f.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(E=>{E.code!==20&&(f.state="errored",r(E))}),f.request.cancel=()=>S.abort()}loadTileData(f,r){f.setTexture(r,this.map.painter)}unloadTile(f,r){if(f.texture&&f.texture instanceof o.T?(f.destroy(!0),f.texture&&f.texture instanceof o.T&&this.map.painter.saveTileTexture(f.texture)):f.destroy(),this._implementation.unloadTile){const{x:l,y:p,z:b}=f.tileID.canonical;this._implementation.unloadTile({x:l,y:p,z:b})}r&&r()}abortTile(f,r){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),r&&r()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){const f=o.av(this.id,this.scope);this.map.style.clearSource(f)}_update(){this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}}},$c=function(f,r,l,p){const b=new $h[r.type](f,r,l,p);if(b.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${b.id}`);return o.aJ(["load","abort","unload","serialize","prepare"],b),b};function im(f,r){const l=o.a6.mat4.identity([]);return o.a6.mat4.scale(l,l,[.5*f.width,.5*-f.height,1]),o.a6.mat4.translate(l,l,[1,-1,0]),o.a6.mat4.multiply(l,l,f.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(l)}function sm(f,r,l,p,b,S,E,O=!1){const V=f.tilesIn(p,E,O);V.sort(Vc);const H=[];for(const J of V)H.push({wrappedTileID:J.tile.tileID.wrapped().key,queryResults:J.tile.queryRenderedFeatures(r,l,f._state,J,b,S,im(f.transform,J.tile.tileID),O)});const W=function(J){const ee={},re={};for(const ve of J){const _e=ve.queryResults,xe=ve.wrappedTileID,we=re[xe]=re[xe]||{};for(const ze in _e){const Ne=_e[ze],Le=we[ze]=we[ze]||{},je=ee[ze]=ee[ze]||[];for(const Ue of Ne)Le[Ue.featureIndex]||(Le[Ue.featureIndex]=!0,je.push(Ue))}}return ee}(H);for(const J in W)W[J].forEach(ee=>{const re=ee.feature,ve=re.layer;ve&&ve.type!=="background"&&ve.type!=="sky"&&ve.type!=="slot"&&(re.source=ve.source,ve["source-layer"]&&(re.sourceLayer=ve["source-layer"]),re.state=re.id!==void 0?f.getFeatureState(ve["source-layer"],re.id):{})});return W}function pd(f,r){const l=f.getRenderableIds().map(S=>f.getTileByID(S)),p=[],b={};for(let S=0;S<l.length;S++){const E=l[S],O=E.tileID.canonical.key;b[O]||(b[O]=!0,E.querySourceFeatures(p,r))}return p}function Vc(f,r){const l=f.tileID,p=r.tileID;return l.overscaledZ-p.overscaledZ||l.canonical.y-p.canonical.y||l.wrap-p.wrap||l.canonical.x-p.canonical.x}const $s=32,ea=33,ta=new Uint16Array(8184);for(let f=0;f<2046;f++){let r=f+2,l=0,p=0,b=0,S=0,E=0,O=0;for(1&r?b=S=E=$s:l=p=O=$s;(r>>=1)>1;){const H=l+b>>1,W=p+S>>1;1&r?(b=l,S=p,l=E,p=O):(l=b,p=S,b=E,S=O),E=H,O=W}const V=4*f;ta[V+0]=l,ta[V+1]=p,ta[V+2]=b,ta[V+3]=S}const is=new Uint16Array(2178),ya=new Uint8Array(1089),md=new Uint16Array(1089);function am(f){return f===0?-.03125:f===32?.03125:0}const lm={type:2,extent:o.ab,loadGeometry:()=>[[new o.P(0,0),new o.P(o.ab+1,0),new o.P(o.ab+1,o.ab+1),new o.P(0,o.ab+1),new o.P(0,0)]]};class ba{constructor(r,l,p,b,S){this.tileID=r,this.uid=o.aP(),this.uses=0,this.tileSize=l,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=S,b&&b.style&&(this._lastUpdatedBrightness=b.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",b&&b.transform&&(this.projection=b.transform.projection)}registerFadeDuration(r){const l=r+this.timeAdded;l<o.q.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=o.aK(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,l,p){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(b,S){const E={};if(!S)return E;for(const O of b){const V=O.layerIds.map(H=>S.getLayer(H)).filter(Boolean);if(V.length!==0){O.layers=V,O.stateDependentLayerIds&&(O.stateDependentLayers=O.stateDependentLayerIds.map(H=>V.filter(W=>W.id===H)[0]));for(const H of V)E[H.fqid]=O}}return E}(r.buckets,l.style),this.hasSymbolBuckets=!1;for(const b in this.buckets){const S=this.buckets[b];if(S instanceof o.aR){if(this.hasSymbolBuckets=!0,!p)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const b in this.buckets){const S=this.buckets[b];if(S instanceof o.aR&&S.hasRTLText){this.hasRTLText=!0,o.aS();break}}this.queryPadding=0;for(const b in this.buckets){const S=this.buckets[b],E=l.style.getOwnLayer(b);if(!E)continue;const O=E.queryRadius(S);this.queryPadding=Math.max(this.queryPadding,O)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new o.aQ}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const b in this.buckets){const S=this.buckets[b];S.uploadPending()&&S.upload(r)}const l=r.gl,p=this.imageAtlas;if(p&&!p.uploaded){const b=!!Object.keys(p.patternPositions).length;this.imageAtlasTexture=new o.T(r,p.image,l.RGBA8,{useMipmap:b}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(r,this.glyphAtlasImage,l.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new o.T(r,this.lineAtlas.image,l.R8),this.lineAtlas.uploaded=!0)}prepare(r,l,p){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,p),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const b=l.style.getBrightness();(this._lastUpdatedBrightness||b)&&(this._lastUpdatedBrightness&&b&&Math.abs(this._lastUpdatedBrightness-b)<.001||(this._lastUpdatedBrightness=b,this.updateBuckets(l)))}queryRenderedFeatures(r,l,p,b,S,E,O,V){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:b,pixelPosMatrix:O,transform:E,params:S,tileTransform:this.tileTransform},r,l,p):{}}querySourceFeatures(r,l){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const b=p.loadVTLayers(),S=l?l.sourceLayer:"",E=b._geojsonTileLayer||b[S];if(!E)return;const O=o.aT(l&&l.filter),{z:V,x:H,y:W}=this.tileID.canonical,J={z:V,x:H,y:W};for(let ee=0;ee<E.length;ee++){const re=E.feature(ee);if(O.needGeometry){const xe=o.aU(re,!0);if(!O.filter(new o.a3(this.tileID.overscaledZ),xe,this.tileID.canonical))continue}else if(!O.filter(new o.a3(this.tileID.overscaledZ),re))continue;const ve=p.getId(re,S),_e=new o.aV(re,V,H,W,ve);_e.tile=J,r.push(_e)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const l=this.expirationTime;if(r.cacheControl){const p=o.aW(r.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const p=Date.now();let b=!1;if(this.expirationTime>p)b=!1;else if(l)if(this.expirationTime<l)b=!0;else{const S=this.expirationTime-l;S?this.expirationTime=p+Math.max(S,3e4):b=!0}else b=!0;b?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,l){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(r).length!==0&&l&&this.updateBuckets(l)}updateBuckets(r){if(!this.latestFeatureIndex)return;const l=this.latestFeatureIndex.loadVTLayers(),p=r.style.listImages(),b=r.style.getBrightness();for(const S in this.buckets){if(!r.style.hasLayer(S))continue;const E=this.buckets[S],O=E.layers[0].sourceLayer||"_geojsonTileLayer",V=l[O],H=r.style.getOwnSourceCache(E.layers[0].source);let W={};H&&(W=H._state.getState(O,void 0)),E.update(W,V,p,this.imageAtlas&&this.imageAtlas.patternPositions||{},b),(E instanceof o.aX||E instanceof o.aY)&&r._terrain&&r._terrain.enabled&&H&&E.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(H.id,this.tileID);const J=r&&r.style&&r.style.getOwnLayer(S);J&&(this.queryPadding=Math.max(this.queryPadding,J.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=o.q.now()+r}setTexture(r,l){const p=l.context,b=p.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof o.T?this.texture.update(r):(this.texture=new o.T(p,r,b.RGBA8,{useMipmap:!0}),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE))}setDependencies(r,l){const p={};for(const b of l)p[b]=!0;this.dependencies[r]=p}hasDependency(r,l){for(const p of r){const b=this.dependencies[p];if(b){for(const S of l)if(b[S])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const p=o.aZ(lm,this.tileID.canonical,this.tileTransform)[0],b=new o.a_,S=new o.a$;for(let E=0;E<p.length;E++){const{x:O,y:V}=p[E];b.emplaceBack(O,V),S.emplaceBack(E)}S.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(S),this._tileDebugBuffer=r.createVertexBuffer(b,o.b0.members),this._tileDebugSegments=o.b1.simpleSegment(0,0,b.length,S.length)}_makeTileBoundsBuffers(r,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const p=o.aZ(lm,this.tileID.canonical,this.tileTransform)[0];let b,S;if(this.isRaster){const E=function(O,V){const H=o.aK(O,V),W=Math.pow(2,O.z);for(let xe=0;xe<ea;xe++)for(let we=0;we<ea;we++){const ze=o.aL((O.x+(we+am(we))/$s)/W),Ne=o.aM((O.y+(xe+am(xe))/$s)/W),Le=V.project(ze,Ne),je=xe*ea+we;is[2*je+0]=Math.round((Le.x*H.scale-H.x)*o.ab),is[2*je+1]=Math.round((Le.y*H.scale-H.y)*o.ab)}ya.fill(0),md.fill(0);for(let xe=2045;xe>=0;xe--){const we=4*xe,ze=ta[we+0],Ne=ta[we+1],Le=ta[we+2],je=ta[we+3],Ue=ze+Le>>1,rt=Ne+je>>1,Qe=Ue+rt-Ne,ot=rt+ze-Ue,gt=Ne*ea+ze,ht=je*ea+Le,ct=rt*ea+Ue,Ct=Math.hypot((is[2*gt+0]+is[2*ht+0])/2-is[2*ct+0],(is[2*gt+1]+is[2*ht+1])/2-is[2*ct+1])>=16;ya[ct]=ya[ct]||(Ct?1:0),xe<1022&&(ya[ct]=ya[ct]||ya[(Ne+ot>>1)*ea+(ze+Qe>>1)]||ya[(je+ot>>1)*ea+(Le+Qe>>1)])}const J=new o.aN,ee=new o.aO;let re=0;function ve(xe,we){const ze=we*ea+xe;return md[ze]===0&&(J.emplaceBack(is[2*ze+0],is[2*ze+1],xe*o.ab/$s,we*o.ab/$s),md[ze]=++re),md[ze]-1}function _e(xe,we,ze,Ne,Le,je){const Ue=xe+ze>>1,rt=we+Ne>>1;if(Math.abs(xe-Le)+Math.abs(we-je)>1&&ya[rt*ea+Ue])_e(Le,je,xe,we,Ue,rt),_e(ze,Ne,Le,je,Ue,rt);else{const Qe=ve(xe,we),ot=ve(ze,Ne),gt=ve(Le,je);ee.emplaceBack(Qe,ot,gt)}}return _e(0,0,$s,$s,$s,0),_e($s,$s,0,0,0,$s),{vertices:J,indices:ee}}(this.tileID.canonical,l);b=E.vertices,S=E.indices}else{b=new o.aN,S=new o.aO;for(const{x:O,y:V}of p)b.emplaceBack(O,V,0,0);const E=o.b2(b.int16,void 0,4);for(let O=0;O<E.length;O+=3)S.emplaceBack(E[O],E[O+1],E[O+2])}this._tileBoundsBuffer=r.createVertexBuffer(b,o.b3.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(S),this._tileBoundsSegments=o.b1.simpleSegment(0,0,b.length,S.length)}_makeGlobeTileDebugBuffers(r,l){const p=l.projection;if(!p||p.name!=="globe"||l.freezeTileCoverage)return;const b=this.tileID.canonical,S=o.b4(b,l),E=o.b5(S),O=o.a9(l.zoom);let V;O>0&&(V=o.a6.mat4.invert(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,b,l,E,V,O),this._makeGlobeTileDebugTextBuffer(r,b,l,E,V,O)}_globePoint(r,l,p,b,S,E,O){let V=o.b6(r,l,p);if(E){const H=1<<p.z,W=o.am(b.center.lng),J=o.at(b.center.lat),ee=(p.x+.5)/H-W;let re=0;ee>.5?re=-1:ee<-.5&&(re=1);let ve=(r/o.ab+p.x)/H+re,_e=(l/o.ab+p.y)/H;ve=(ve-W)*b._pixelsPerMercatorPixel+W,_e=(_e-J)*b._pixelsPerMercatorPixel+J;const xe=[ve*b.worldSize,_e*b.worldSize,0];o.a6.vec3.transformMat4(xe,xe,E),V=o.b7(V,xe,O)}return o.a6.vec3.transformMat4(V,V,S)}_makeGlobeTileDebugBorderBuffer(r,l,p,b,S,E){const O=new o.a_,V=new o.a$,H=new o.b8,W=(ee,re,ve,_e,xe)=>{const we=(ve-ee)/(xe-1),ze=(_e-re)/(xe-1),Ne=O.length;for(let Le=0;Le<xe;Le++){const je=ee+Le*we,Ue=re+Le*ze;O.emplaceBack(je,Ue);const rt=this._globePoint(je,Ue,l,p,b,S,E);H.emplaceBack(rt[0],rt[1],rt[2]),V.emplaceBack(Ne+Le)}},J=o.ab;W(0,0,J,0,16),W(J,0,J,J,16),W(J,J,0,J,16),W(0,J,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(V),this._tileDebugBuffer=r.createVertexBuffer(O,o.b0.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(H,o.b9.members),this._tileDebugSegments=o.b1.simpleSegment(0,0,O.length,V.length)}_makeGlobeTileDebugTextBuffer(r,l,p,b,S,E){const O=o.ab/4,V=new o.a_,H=new o.aO,W=new o.b8,J=25;H.reserve(32),V.reserve(J),W.reserve(J);const ee=(re,ve)=>J*re+ve;for(let re=0;re<J;re++){const ve=re*O;for(let _e=0;_e<J;_e++){const xe=_e*O;V.emplaceBack(xe,ve);const we=this._globePoint(xe,ve,l,p,b,S,E);W.emplaceBack(we[0],we[1],we[2])}}for(let re=0;re<4;re++)for(let ve=0;ve<4;ve++){const _e=ee(re,ve),xe=ee(re,ve+1),we=ee(re+1,ve),ze=ee(re+1,ve+1);H.emplaceBack(_e,xe,we),H.emplaceBack(we,xe,ze)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(H),this._tileDebugTextBuffer=r.createVertexBuffer(V,o.b0.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(W,o.b9.members),this._tileDebugTextSegments=o.b1.simpleSegment(0,0,J,32)}destroy(r=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof o.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}o.ba.setPbf(o.bb);class Vh extends ba{constructor(r,l,p,b,S){super(r,l,p,b,S),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(r,l){const p=l.context,b=p.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof o.T?this.texture.update(r,{premultiply:!1}):this.texture=new o.T(p,r,b.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,l){const p=this._mrt=new o.ba(30),b=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=o.bc(b,(S,E,O,V)=>{if(S)l(S);else try{const H=p.getHeaderLength(E);if(H>r)return void(this.request=this.fetchHeader(H,l));p.parseHeader(E),this._isHeaderLoaded=!0;let W=0;for(const J of Object.values(p.layers))W=Math.max(W,J.dataIndex[J.dataIndex.length-1].last_byte);E.byteLength>=W&&(this.entireBuffer=E),l(null,this.entireBuffer||E,O,V)}catch(H){l(H)}}),this.request}fetchBand(r,l,p){const b=this._mrt;if(!this._isHeaderLoaded||!b)return void p(new Error("Tile header is not ready"));const S=this.actor;if(!S)return void p(new Error("Can't fetch tile band without an actor"));let E;const O=(J,ee)=>{E.complete(J,ee),J?p(J):(this.updateTextureDescriptor(r,l),p(null,this.textureDescriptor&&this.textureDescriptor.img))},V=(J,ee)=>{if(J)return p(J);const re=S.send("decodeRasterArray",{buffer:ee,task:E},O,void 0,!0);this._workQueue.push(()=>{re&&re.cancel(),E.cancel()})},H=b.getLayer(r);if(!H)return void p(new Error(`Unknown sourceLayer "${r}"`));if(H.hasDataForBand(l))return this.updateTextureDescriptor(r,l),void p(null,this.textureDescriptor?this.textureDescriptor.img:null);const W=H.getDataRange([l]);if(E=b.createDecodingTask(W),!E||E.tasks.length)if(this.flushQueues(),this.entireBuffer)V(null,this.entireBuffer.slice(W.firstByte,W.lastByte+1));else{const J=Object.assign({},this.requestParams,{headers:{Range:`bytes=${W.firstByte}-${W.lastByte}`}}),ee=o.bc(J,V);this._fetchQueue.push(()=>{ee.cancel(),E.cancel()})}else p(null)}updateNeeded(r,l){return(!this.textureDescriptor||this.textureDescriptor.band!==l||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,l){if(!this._mrt)return;const p=this._mrt.getLayer(r);if(!p||!p.hasBand(l)||!p.hasDataForBand(l))return;const{bytes:b,tileSize:S,buffer:E,offset:O,scale:V}=p.getBandView(l),H=S+2*E,W={data:b,width:H,height:H},J=this.texture;J&&J instanceof o.T&&J.update(W,{premultiply:!1}),this.textureDescriptor={layer:r,band:l,img:W,buffer:E,offset:O,tileSize:S,format:p.pixelFormat,mix:[V,256*V,65536*V,16777216*V]}}}class h_{constructor(r,l){this.max=r,this.onRemove=l,this.reset()}reset(){for(const r in this.data)for(const l of this.data[r])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(r,l,p){const b=r.wrapped().key;this.data[b]===void 0&&(this.data[b]=[]);const S={value:l,timeout:void 0};if(p!==void 0&&(S.timeout=setTimeout(()=>{this.remove(r,S)},p)),this.data[b].push(S),this.order.push(b),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const l=this.data[r].shift();return l.timeout&&clearTimeout(l.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),l.value}getByKey(r){const l=this.data[r];return l?l[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,l){if(!this.has(r))return this;const p=r.wrapped().key,b=l===void 0?0:this.data[p].indexOf(l),S=this.data[p][b];return this.data[p].splice(b,1),S.timeout&&clearTimeout(S.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(S.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(r){const l=[];for(const p in this.data)for(const b of this.data[p])r(b.value)||l.push(b);for(const p of l)this.remove(p.value.tileID,p)}}class u1{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,l,p){const b=String(l);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][b]=this.stateChanges[r][b]||{},o.l(this.stateChanges[r][b],p),this.deletedStates[r]===null){this.deletedStates[r]={};for(const S in this.state[r])S!==b&&(this.deletedStates[r][S]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][b]===null){this.deletedStates[r][b]={};for(const S in this.state[r][b])p[S]||(this.deletedStates[r][b][S]=null)}else for(const S in p)this.deletedStates[r]&&this.deletedStates[r][b]&&this.deletedStates[r][b][S]===null&&delete this.deletedStates[r][b][S]}removeFeatureState(r,l,p){if(this.deletedStates[r]===null)return;const b=String(l);if(this.deletedStates[r]=this.deletedStates[r]||{},p&&l!==void 0)this.deletedStates[r][b]!==null&&(this.deletedStates[r][b]=this.deletedStates[r][b]||{},this.deletedStates[r][b][p]=null);else if(l!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][b])for(p in this.deletedStates[r][b]={},this.stateChanges[r][b])this.deletedStates[r][b][p]=null;else this.deletedStates[r][b]=null;else this.deletedStates[r]=null}getState(r,l){const p=this.state[r]||{},b=this.stateChanges[r]||{},S=this.deletedStates[r];if(S===null)return{};if(l!==void 0){const O=String(l),V=o.l({},p[O],b[O]);if(S){const H=S[l];if(H===null)return{};for(const W in H)delete V[W]}return V}const E=o.l({},p,b);if(S)for(const O in S)delete E[O];return E}initializeTileState(r,l){r.setFeatureState(this.state,l)}coalesceChanges(r,l){const p={};for(const b in this.stateChanges){this.state[b]=this.state[b]||{};const S={};for(const E in this.stateChanges[b])this.state[b][E]||(this.state[b][E]={}),o.l(this.state[b][E],this.stateChanges[b][E]),S[E]=this.state[b][E];p[b]=S}for(const b in this.deletedStates){this.state[b]=this.state[b]||{};const S={};if(this.deletedStates[b]===null)for(const E in this.state[b])S[E]={},this.state[b][E]={};else for(const E in this.deletedStates[b]){if(this.deletedStates[b][E]===null)this.state[b][E]={};else if(this.state[b][E])for(const O of Object.keys(this.deletedStates[b][E]))delete this.state[b][E][O];S[E]=this.state[b][E]}p[b]=p[b]||{},o.l(p[b],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const b in r)r[b].setFeatureState(p,l)}}class ss extends o.E{constructor(r,l,p){super(),this.id=r,this._onlySymbols=p,l.on("data",b=>{b.dataType==="source"&&b.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&b.dataType==="source"&&b.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new h_(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new u1,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const l=this._tiles[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,l){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,l)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const p=this._tiles[l];p.upload(r),p.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return o.bd(this._tiles).map(r=>r.tileID).sort(Tl).map(r=>r.key)}getRenderableIds(r,l){const p=[];for(const b in this._tiles)this._isIdRenderable(+b,r,l)&&p.push(this._tiles[b]);return r?p.sort((b,S)=>{const E=b.tileID,O=S.tileID,V=new o.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),H=new o.P(O.canonical.x,O.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-O.overscaledZ||H.y-V.y||H.x-V.x}).map(b=>b.tileID.key):p.map(b=>b.tileID).sort(Tl).map(b=>b.key)}hasRenderableParent(r){const l=this.findLoadedParent(r,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(r,l,p){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(l||!this._tiles[r].holdingForFade())&&(p||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,l){const p=this._tiles[r];p&&(p.state!=="loading"&&(p.state=l),this._loadTile(p,this._tileLoaded.bind(this,p,r,l)))}_tileLoaded(r,l,p,b){if(b)if(r.state="errored",b.status!==404)this._source.fire(new o.t(b,{tile:r}));else{if(this._source.fire(new o.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:r})),!(r.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const S=this.map.painter.terrain;this.update(this.transform,S.getScaledDemTileSize(),!0),S.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=o.q.now(),p==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(l,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new o.x("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const l=this.getRenderableIds();for(let b=0;b<l.length;b++){const S=l[b];if(r.neighboringTiles&&r.neighboringTiles[S]){const E=this.getTileByID(S);p(r,E),p(E,r)}}function p(b,S){if(!b.dem||b.dem.borderReady)return;b.needsHillshadePrepare=!0,b.needsDEMTextureUpload=!0;let E=S.tileID.canonical.x-b.tileID.canonical.x;const O=S.tileID.canonical.y-b.tileID.canonical.y,V=Math.pow(2,b.tileID.canonical.z),H=S.tileID.key;E===0&&O===0||Math.abs(O)>1||(Math.abs(E)>1&&(Math.abs(E+V)===1?E+=V:Math.abs(E-V)===1&&(E-=V)),S.dem&&b.dem&&(b.dem.backfillBorder(S.dem,E,O),b.neighboringTiles&&b.neighboringTiles[H]&&(b.neighboringTiles[H].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,l,p,b){for(const S in this._tiles){let E=this._tiles[S];if(b[S]||!E.hasData()||E.tileID.overscaledZ<=l||E.tileID.overscaledZ>p)continue;let O=E.tileID;for(;E&&E.tileID.overscaledZ>l+1;){const H=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[H.key],E&&E.hasData()&&(O=H)}let V=O;for(;V.overscaledZ>l;)if(V=V.scaledTo(V.overscaledZ-1),r[V.key]){b[O.key]=O;break}}}findLoadedParent(r,l){if(r.key in this._loadedParentTiles){const p=this._loadedParentTiles[r.key];return p&&p.tileID.overscaledZ>=l?p:null}for(let p=r.overscaledZ-1;p>=l;p--){const b=r.scaledTo(p),S=this._getLoadedTile(b);if(S)return S}}_getLoadedTile(r){const l=this._tiles[r.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,l){l=l||this._source.tileSize;const p=Math.ceil(r.width/l)+1,b=Math.ceil(r.height/l)+1,S=Math.floor(p*b*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,S):S,O=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(O)}handleWrapJump(r){const l=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,l){const p={};for(const b in this._tiles){const S=this._tiles[b];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+l),p[S.tileID.key]=S}this._tiles=p;for(const b in this._timers)clearTimeout(this._timers[b]),delete this._timers[b];for(const b in this._tiles)this._setTileReloadTimer(+b,this._tiles[b])}}update(r,l,p,b){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;this.updateCacheSize(r,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const S=this._source.type==="batched-model";let E;if(this.used||this.usedForTerrain){if(this._source.tileID)E=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(H=>new o.aA(H.canonical.z,H.wrap,H.canonical.z,H.canonical.x,H.canonical.y));else if(this.tileCoverLift!==0){const H=r.clone();H.tileCoverLift=this.tileCoverLift,E=H.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.minzoom<=1&&r.projection.name==="globe"&&(E.push(new o.aA(1,0,1,0,0)),E.push(new o.aA(1,0,1,1,0)),E.push(new o.aA(1,0,1,0,1)),E.push(new o.aA(1,0,1,1,1)))}else if(E=r.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.hasTile){const H=this._source.hasTile.bind(this._source);E=E.filter(W=>H(W))}}else E=[];if(E.length>0&&this.castsShadows&&b&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!gd(this._source.type)){const H=r.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!p}),W=Math.min(H,this._source.maxzoom);if(S){const J=r.extendTileCover(E,W);for(const ee of J)E.push(ee)}else{const J=r.extendTileCover(E,W,b);for(const ee of J)this._shadowCasterTiles[ee.key]=!0,E.push(ee)}}const O=this._updateRetainedTiles(E);if(gd(this._source.type)&&E.length!==0){const H={},W={},J=Object.keys(O);for(const re of J){const ve=O[re],_e=this._tiles[re];if(!_e||_e.fadeEndTime&&_e.fadeEndTime<=o.q.now())continue;const xe=this.findLoadedParent(ve,Math.max(ve.overscaledZ-ss.maxOverzooming,this._source.minzoom));xe&&(this._addTile(xe.tileID),H[xe.tileID.key]=xe.tileID),W[re]=ve}const ee=E[E.length-1].overscaledZ;for(const re in this._tiles){const ve=this._tiles[re];if(O[re]||!ve.hasData())continue;let _e=ve.tileID;for(;_e.overscaledZ>ee;){_e=_e.scaledTo(_e.overscaledZ-1);const xe=this._tiles[_e.key];if(xe&&xe.hasData()&&W[_e.key]){O[re]=ve.tileID;break}}}for(const re in H)O[re]||(this._coveredTiles[re]=!0,O[re]=H[re])}for(const H in O)this._tiles[H].clearFadeHold();const V=o.be(this._tiles,O);for(const H of V){const W=this._tiles[H];W.hasSymbolBuckets&&!W.holdingForFade()?W.setHoldDuration(this.map._fadeDuration):W.hasSymbolBuckets&&!W.symbolFadeFinished()||this._removeTile(+H)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const l={};if(r.length===0)return l;const p={},b=r.reduce((H,W)=>Math.min(H,W.overscaledZ),1/0),S=r[0].overscaledZ,E=Math.max(S-ss.maxOverzooming,this._source.minzoom),O=Math.max(S+ss.maxUnderzooming,this._source.minzoom),V={};for(const H of r){const W=this._addTile(H);l[H.key]=H,W.hasData()||b<this._source.maxzoom&&(V[H.key]=H)}this._retainLoadedChildren(V,b,O,l);for(const H of r){let W=this._tiles[H.key];if(W.hasData())continue;if(H.canonical.z>=this._source.maxzoom){const ee=H.children(this._source.maxzoom)[0],re=this.getTile(ee);if(re&&re.hasData()){l[ee.key]=ee;continue}}else{const ee=H.children(this._source.maxzoom);if(l[ee[0].key]&&l[ee[1].key]&&l[ee[2].key]&&l[ee[3].key])continue}let J=W.wasRequested();for(let ee=H.overscaledZ-1;ee>=E;--ee){const re=H.scaledTo(ee);if(p[re.key]||(p[re.key]=!0,W=this.getTile(re),!W&&J&&(W=this._addTile(re)),W&&(l[re.key]=re,J=W.wasRequested(),W.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const l=[];let p,b=this._tiles[r].tileID;for(;b.overscaledZ>0;){if(b.key in this._loadedParentTiles){p=this._loadedParentTiles[b.key];break}l.push(b.key);const S=b.scaledTo(b.overscaledZ-1);if(p=this._getLoadedTile(S),p)break;b=S}for(const S of l)this._loadedParentTiles[S]=p}}_addTile(r){let l=this._tiles[r.key];if(l)return l.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),l;l=this._cache.getAndRemove(r),l&&(this._setTileReloadTimer(r.key,l),l.tileID=r,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,l)));const p=!!l;if(!p){const b=this.map?this.map.painter:null,S=this._source.tileSize*r.overscaleFactor();l=this._source.type==="raster-array"?new Vh(r,S,this.transform.tileZoom,b,this._isRaster):new ba(r,S,this.transform.tileZoom,b,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,r.key,l.state))}return l?(l.uses++,this._tiles[r.key]=l,p||this._source.fire(new o.x("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(r,l){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const p=l.getExpiryTimeout();p&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},p))}_removeTile(r){const l=this._tiles[r];l&&(l.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,l,p){const b=[],S=this.transform;if(!S)return b;const E=S.projection.name==="globe",O=o.am(S.center.lng);for(const V in this._tiles){const H=this._tiles[V];if(p&&H.clearQueryDebugViz(),H.holdingForFade())continue;let W;if(E){const J=H.tileID.canonical;if(J.z===0){const ee=[Math.abs(o.ap(O,...Uc(J,-1))-O),Math.abs(o.ap(O,...Uc(J,1))-O)];W=[0,2*ee.indexOf(Math.min(...ee))-1]}else{const ee=[Math.abs(o.ap(O,...Uc(J,-1))-O),Math.abs(o.ap(O,...Uc(J,0))-O),Math.abs(o.ap(O,...Uc(J,1))-O)];W=[ee.indexOf(Math.min(...ee))-1]}}else W=[0];for(const J of W){const ee=r.containsTile(H,S,l,J);ee&&b.push(ee)}}return b}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,l){const p=this.getRenderableIds(r,l).map(S=>this._tiles[S].tileID),b=this.transform.projection.name==="globe";for(const S of p)S.projMatrix=this.transform.calculateProjMatrix(S.toUnwrapped()),S.expandedProjMatrix=b?this.transform.calculateProjMatrix(S.toUnwrapped(),!1,!0):S.projMatrix;return p}sortCoordinatesByDistance(r){const l=r.slice(),p=this.transform._camera.position,b=this.transform._camera.forward(),S={};for(const E of l){const O=1/(1<<E.canonical.z);S[E.key]=((E.canonical.x+.5)*O+E.wrap-p[0])*b[0]+((E.canonical.y+.5)*O-p[1])*b[1]-p[2]*b[2]}return l.sort((E,O)=>S[E.key]-S[O.key]),l}hasTransition(){if(this._source.hasTransition())return!0;if(gd(this._source.type))for(const r in this._tiles){const l=this._tiles[r];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=o.q.now())return!0}return!1}setFeatureState(r,l,p){this._state.updateState(r=r||"_geojsonTileLayer",l,p)}removeFeatureState(r,l,p){this._state.removeFeatureState(r=r||"_geojsonTileLayer",l,p)}getFeatureState(r,l){return this._state.getState(r=r||"_geojsonTileLayer",l)}setDependencies(r,l,p){const b=this._tiles[r];b&&b.setDependencies(l,p)}reloadTilesForDependencies(r,l){for(const p in this._tiles)this._tiles[p].hasDependency(r,l)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(r,l))}_preloadTiles(r,l){if(!this._sourceLoaded){const V=()=>{this._sourceLoaded&&(this._source.off("data",V),this._preloadTiles(r,l))};return void this._source.on("data",V)}const p=new Map,b=Array.isArray(r)?r:[r],S=this.map.painter.terrain,E=this.usedForTerrain&&S?S.getScaledDemTileSize():this._source.tileSize;for(const V of b){const H=V.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const W of H)p.set(W.key,W);this.usedForTerrain&&V.updateElevation(!1)}const O=Array.from(p.values());o.bf(O,(V,H)=>{const W=new ba(V,this._source.tileSize*V.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(W,J=>{this._source.type==="raster-dem"&&W.dem&&this._backfillDEM(W),H(J,W)})},l)}}function Tl(f,r){const l=Math.abs(2*f.wrap)-+(f.wrap<0),p=Math.abs(2*r.wrap)-+(r.wrap<0);return f.overscaledZ-r.overscaledZ||p-l||r.canonical.y-f.canonical.y||r.canonical.x-f.canonical.x}function gd(f){return f==="raster"||f==="image"||f==="video"||f==="custom"}function Uc(f,r){const l=1<<f.z;return[f.x/l+r,(f.x+1)/l+r]}ss.maxOverzooming=10,ss.maxUnderzooming=3;class cm{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,l=!1;for(const p in this.style._mergedLayers){const b=this.style._mergedLayers[p];if(b.type==="fill-extrusion")this.layers.push({layer:b,visible:r,visibilityChanged:l});else if(b.type==="model"){const S=this.style.getLayerSource(b);S&&S.type==="batched-model"&&this.layers.push({layer:b,visible:r,visibilityChanged:l})}}}onNewFrame(r){this.layersGotHidden=!1;for(const l of this.layers){const p=l.layer;let b=!1;p.type==="fill-extrusion"?b=!p.isHidden(r)&&p.paint.get("fill-extrusion-opacity")>0:p.type==="model"&&(b=!p.isHidden(r)&&p.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!b&&l.visible,l.visible=b}}updateZOffset(r,l){this.currentBuildingBuckets=[];for(const b of this.layers){const S=b.layer,E=this.style.getLayerSourceCache(S);let O=1;S.type==="fill-extrusion"&&(O=b.visible?S.paint.get("fill-extrusion-vertical-scale"):0);let V=E?E.getTile(l):null;if(!V&&E&&l.canonical.z>E.getSource().minzoom){let H=l.scaledTo(Math.min(E.getSource().maxzoom,l.overscaledZ-1));for(;H.overscaledZ>=E.getSource().minzoom&&(V=E.getTile(H),!V&&H.overscaledZ!==0);)H=H.scaledTo(H.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:V?V.getBucket(S):null,tileID:V?V.tileID:l,verticalScale:O})}r.hasAnyZOffset=!1;let p=!1;for(let b=0;b<r.symbolInstances.length;b++){const S=r.symbolInstances.get(b),E=S.zOffset,O=this._getHeightAtTileOffset(l,S.tileAnchorX,S.tileAnchorY);S.zOffset=O!==Number.NEGATIVE_INFINITY?O:E,p||E===S.zOffset||(p=!0),r.hasAnyZOffset||S.zOffset===0||(r.hasAnyZOffset=!0)}p&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,l,p,b){let S=l,E=p;if(r.canonical.z!==b.canonical.z){const O=b.canonical,V=1/(1<<r.canonical.z-O.z);S=(l+r.canonical.x*o.ab)*V-O.x*o.ab|0,E=(p+r.canonical.y*o.ab)*V-O.y*o.ab|0}return{tileX:S,tileY:E}}_getHeightAtTileOffset(r,l,p){let b,S;for(let E=0;E<this.layers.length;++E){if(this.layers[E].layer.type!=="fill-extrusion")continue;const{bucket:O,tileID:V,verticalScale:H}=this.currentBuildingBuckets[E];if(!O)continue;const{tileX:W,tileY:J}=this._mapCoordToOverlappingTile(r,l,p,V),ee=O.getHeightAtTileCoord(W,J);ee&&ee.height!==void 0&&(ee.hidden?b=ee.height:S=Math.max(ee.height*H,S||0))}if(S!==void 0)return S;for(let E=0;E<this.layers.length;++E){const O=this.layers[E];if(O.layer.type!=="model"||!O.visible)continue;const{bucket:V,tileID:H}=this.currentBuildingBuckets[E];if(!V)continue;const{tileX:W,tileY:J}=this._mapCoordToOverlappingTile(r,l,p,H),ee=V.getHeightAtTileCoord(W,J);if(ee&&!ee.hidden)return ee.height===void 0&&b!==void 0?Math.min(ee.maxHeight,b)*ee.verticalScale:ee.height?ee.height*ee.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function jc(f,r){const l={};for(const p in f)p!=="ref"&&(l[p]=f[p]);return o.bg.forEach(p=>{p in r&&(l[p]=r[p])}),l}function um(f){f=f.slice();const r=Object.create(null);for(let l=0;l<f.length;l++)r[f[l].id]=f[l];for(let l=0;l<f.length;l++)"ref"in f[l]&&(f[l]=jc(f[l],r[f[l].ref]));return f}const to={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function dm(f,r,l){l.push({command:to.addSource,args:[f,r[f]]})}function co(f,r,l){r.push({command:to.removeSource,args:[f]}),l[f]=!0}function d1(f,r,l,p){co(f,l,p),dm(f,r,l)}function pr(f,r,l){let p;for(p in f[l])if(f[l].hasOwnProperty(p)&&p!=="data"&&!o.bh(f[l][p],r[l][p]))return!1;for(p in r[l])if(r[l].hasOwnProperty(p)&&p!=="data"&&!o.bh(f[l][p],r[l][p]))return!1;return!0}function vd(f,r,l,p,b,S){let E;for(E in r=r||{},f=f||{})f.hasOwnProperty(E)&&(o.bh(f[E],r[E])||l.push({command:S,args:[p,E,r[E],b]}));for(E in r)r.hasOwnProperty(E)&&!f.hasOwnProperty(E)&&(o.bh(f[E],r[E])||l.push({command:S,args:[p,E,r[E],b]}))}function ic(f){return f.id}function Hc(f,r){return f[r.id]=r,f}class xa{constructor(r,l){this.reset(r,l)}reset(r,l){this.points=r||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=o.ap(r,0,1);let l=1,p=this._distances[l];const b=r*this.paddedLength+this.padding;for(;p<b&&l<this._distances.length;)p=this._distances[++l];const S=l-1,E=this._distances[S],O=p-E,V=O>0?(b-E)/O:0;return this.points[S].mult(1-V).add(this.points[l].mult(V))}}class Uh{constructor(r,l,p){const b=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(r/p),this.yCellCount=Math.ceil(l/p);for(let E=0;E<this.xCellCount*this.yCellCount;E++)b.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=l,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,l,p,b,S){this._forEachCell(l,p,b,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(b),this.bboxes.push(S)}insertCircle(r,l,p,b){this._forEachCell(l-b,p-b,l+b,p+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(l),this.circles.push(p),this.circles.push(b)}_insertBoxCell(r,l,p,b,S,E){this.boxCells[S].push(E)}_insertCircleCell(r,l,p,b,S,E){this.circleCells[S].push(E)}_query(r,l,p,b,S,E){if(p<0||r>this.width||b<0||l>this.height)return!S&&[];const O=[];if(r<=0&&l<=0&&this.width<=p&&this.height<=b){if(S)return!0;for(let V=0;V<this.boxKeys.length;V++)O.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(let V=0;V<this.circleKeys.length;V++){const H=this.circles[3*V],W=this.circles[3*V+1],J=this.circles[3*V+2];O.push({key:this.circleKeys[V],x1:H-J,y1:W-J,x2:H+J,y2:W+J})}return E?O.filter(E):O}return this._forEachCell(r,l,p,b,this._queryCell,O,{hitTest:S,seenUids:{box:{},circle:{}}},E),S?O.length>0:O}_queryCircle(r,l,p,b,S){const E=r-p,O=r+p,V=l-p,H=l+p;if(O<0||E>this.width||H<0||V>this.height)return!b&&[];const W=[];return this._forEachCell(E,V,O,H,this._queryCellCircle,W,{hitTest:b,circle:{x:r,y:l,radius:p},seenUids:{box:{},circle:{}}},S),b?W.length>0:W}query(r,l,p,b,S){return this._query(r,l,p,b,!1,S)}hitTest(r,l,p,b,S){return this._query(r,l,p,b,!0,S)}hitTestCircle(r,l,p,b){return this._queryCircle(r,l,p,!0,b)}_queryCell(r,l,p,b,S,E,O,V){const H=O.seenUids,W=this.boxCells[S];if(W!==null){const ee=this.bboxes;for(const re of W)if(!H.box[re]){H.box[re]=!0;const ve=4*re;if(r<=ee[ve+2]&&l<=ee[ve+3]&&p>=ee[ve+0]&&b>=ee[ve+1]&&(!V||V(this.boxKeys[re]))){if(O.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[re],x1:ee[ve],y1:ee[ve+1],x2:ee[ve+2],y2:ee[ve+3]})}}}const J=this.circleCells[S];if(J!==null){const ee=this.circles;for(const re of J)if(!H.circle[re]){H.circle[re]=!0;const ve=3*re;if(this._circleAndRectCollide(ee[ve],ee[ve+1],ee[ve+2],r,l,p,b)&&(!V||V(this.circleKeys[re]))){if(O.hitTest)return E.push(!0),!0;{const _e=ee[ve],xe=ee[ve+1],we=ee[ve+2];E.push({key:this.circleKeys[re],x1:_e-we,y1:xe-we,x2:_e+we,y2:xe+we})}}}}}_queryCellCircle(r,l,p,b,S,E,O,V){const H=O.circle,W=O.seenUids,J=this.boxCells[S];if(J!==null){const re=this.bboxes;for(const ve of J)if(!W.box[ve]){W.box[ve]=!0;const _e=4*ve;if(this._circleAndRectCollide(H.x,H.y,H.radius,re[_e+0],re[_e+1],re[_e+2],re[_e+3])&&(!V||V(this.boxKeys[ve])))return E.push(!0),!0}}const ee=this.circleCells[S];if(ee!==null){const re=this.circles;for(const ve of ee)if(!W.circle[ve]){W.circle[ve]=!0;const _e=3*ve;if(this._circlesCollide(re[_e],re[_e+1],re[_e+2],H.x,H.y,H.radius)&&(!V||V(this.circleKeys[ve])))return E.push(!0),!0}}}_forEachCell(r,l,p,b,S,E,O,V){const H=this._convertToXCellCoord(r),W=this._convertToYCellCoord(l),J=this._convertToXCellCoord(p),ee=this._convertToYCellCoord(b);for(let re=H;re<=J;re++)for(let ve=W;ve<=ee;ve++)if(S.call(this,r,l,p,b,this.xCellCount*ve+re,E,O,V))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,l,p,b,S,E){const O=b-r,V=S-l,H=p+E;return H*H>O*O+V*V}_circleAndRectCollide(r,l,p,b,S,E,O){const V=(E-b)/2,H=Math.abs(r-(b+V));if(H>V+p)return!1;const W=(O-S)/2,J=Math.abs(l-(S+W));if(J>W+p)return!1;if(H<=V||J<=W)return!0;const ee=H-V,re=J-W;return ee*ee+re*re<=p*p}}const na={unknown:0,flipRequired:1,flipNotRequired:2},qn=Math.tan(85*Math.PI/180);function qr(f,r,l,p,b,S,E){const O=o.a6.mat4.create();if(l)if(S.name==="globe"){const V=o.bi(b,r);o.a6.mat4.multiply(O,O,V)}else{const V=o.a6.mat2.invert([],E);O[0]=V[0],O[1]=V[1],O[4]=V[2],O[5]=V[3],p||o.a6.mat4.rotateZ(O,O,b.angle)}else o.a6.mat4.multiply(O,b.labelPlaneMatrix,f);return O}function Kr(f,r,l,p,b,S,E){const O=qr(f,r,l,p,b,S,E);return S.name==="globe"&&l||(O[2]=O[6]=O[10]=O[14]=0),O}function as(f,r,l,p,b,S,E){if(l){if(S.name==="globe"){const O=qr(f,r,l,p,b,S,E);return o.a6.mat4.invert(O,O),o.a6.mat4.multiply(O,f,O),O}{const O=o.a6.mat4.clone(f),V=o.a6.mat4.identity([]);return V[0]=E[0],V[1]=E[1],V[4]=E[2],V[5]=E[3],o.a6.mat4.multiply(O,O,V),p||o.a6.mat4.rotateZ(O,O,-b.angle),O}}return b.glCoordMatrix}function $i(f,r,l,p){const b=[f,r,l,1];l?o.a6.vec4.transformMat4(b,b,p):Hh(b,b,p);const S=b[3];return b[0]/=S,b[1]/=S,b[2]/=S,b}function Jr(f,r){return Math.min(.5+f/r*.5,1.5)}function jh(f,r){const l=f[0]/f[3],p=f[1]/f[3];return l>=-r[0]&&l<=r[0]&&p>=-r[1]&&p<=r[1]}function Gc(f,r,l,p,b,S,E,O,V,H){const W=l.transform,J=p?f.textSizeData:f.iconSizeData,ee=o.bj(J,l.transform.zoom),re=W.projection.name==="globe",ve=[256/l.width*2+1,256/l.height*2+1],_e=p?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;_e.clear();let xe=null;re&&(xe=p?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const we=f.lineVertexArray,ze=p?f.text.placedSymbolArray:f.icon.placedSymbolArray,Ne=l.transform.width/l.transform.height;let Le,je=!1;for(let Ue=0;Ue<ze.length;Ue++){const rt=ze.get(Ue),{numGlyphs:Qe,writingMode:ot}=rt;if(ot!==o.bk.vertical||je||Le===o.bk.horizontal||(je=!0),Le=ot,(rt.hidden||ot===o.bk.vertical)&&!je){wa(Qe,_e);continue}je=!1;const gt=new o.P(rt.tileAnchorX,rt.tileAnchorY);let{x:ht,y:ct,z:Ct}=W.projection.projectTilePoint(gt.x,gt.y,H.canonical);if(V){const[an,pn,er]=V(gt);ht+=an,ct+=pn,Ct+=er}const Kt=[ht,ct,Ct,1];if(o.a6.vec4.transformMat4(Kt,Kt,r),!jh(Kt,ve)){wa(Qe,_e);continue}const cn=Kt[3],qt=Jr(l.transform.getCameraToCenterDistance(W.projection),cn),yn=o.bl(J,ee,rt),Et=E?yn/qt:yn*qt,nn=$i(ht,ct,Ct,b);if(nn[3]<=0){wa(Qe,_e);continue}let Qt={};const bn=E?null:V,wn=Qo(rt,Et,!1,O,r,b,S,f.glyphOffsetArray,we,_e,xe,nn,gt,Qt,Ne,bn,W.projection,H,E);je=wn.useVertical,bn&&wn.needsFlipping&&(Qt={}),(wn.notEnoughRoom||je||wn.needsFlipping&&Qo(rt,Et,!0,O,r,b,S,f.glyphOffsetArray,we,_e,xe,nn,gt,Qt,Ne,bn,W.projection,H,E).notEnoughRoom)&&wa(Qe,_e)}p?(f.text.dynamicLayoutVertexBuffer.updateData(_e),xe&&f.text.globeExtVertexBuffer&&f.text.globeExtVertexBuffer.updateData(xe)):(f.icon.dynamicLayoutVertexBuffer.updateData(_e),xe&&f.icon.globeExtVertexBuffer&&f.icon.globeExtVertexBuffer.updateData(xe))}function Wc(f,r,l,p,b,S,E,O,V,H,W,J,ee,re,ve,_e){const{lineStartIndex:xe,glyphStartIndex:we,segment:ze}=O,Ne=we+O.numGlyphs,Le=xe+O.lineLength,je=r.getoffsetX(we),Ue=r.getoffsetX(Ne-1),rt=Kc(f*je,l,p,b,S,E,ze,xe,Le,V,H,W,J,ee,!0,re,ve,_e);if(!rt)return null;const Qe=Kc(f*Ue,l,p,b,S,E,ze,xe,Le,V,H,W,J,ee,!0,re,ve,_e);return Qe?{first:rt,last:Qe}:null}function Ki(f,r,l,p){return f===o.bk.horizontal&&Math.abs(p)>Math.abs(l)?{useVertical:!0}:f===o.bk.vertical?p>0?{needsFlipping:!0}:null:r!==na.unknown&&function(b,S){return b===0||Math.abs(S/b)>qn}(l,p)?r===na.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function Qo(f,r,l,p,b,S,E,O,V,H,W,J,ee,re,ve,_e,xe,we,ze){const Ne=r/24,Le=f.lineOffsetX*Ne,je=f.lineOffsetY*Ne,{lineStartIndex:Ue,glyphStartIndex:rt,numGlyphs:Qe,segment:ot,writingMode:gt,flipState:ht}=f,ct=Ue+f.lineLength,Ct=Kt=>{if(W){const[Et,nn,Qt]=Kt.up,bn=H.length;o.bm(W,bn+0,Et,nn,Qt),o.bm(W,bn+1,Et,nn,Qt),o.bm(W,bn+2,Et,nn,Qt),o.bm(W,bn+3,Et,nn,Qt)}const[cn,qt,yn]=Kt.point;o.bn(H,cn,qt,yn,Kt.angle)};if(Qe>1){const Kt=Wc(Ne,O,Le,je,l,J,ee,f,V,S,re,_e,!1,xe,we,ze);if(!Kt)return{notEnoughRoom:!0};if(p&&!l){let[cn,qt,yn]=Kt.first.point,[Et,nn,Qt]=Kt.last.point;[cn,qt]=$i(cn,qt,yn,E),[Et,nn]=$i(Et,nn,Qt,E);const bn=Ki(gt,ht,(Et-cn)*ve,nn-qt);if(f.flipState=bn&&bn.needsFlipping?na.flipRequired:na.flipNotRequired,bn)return bn}Ct(Kt.first);for(let cn=rt+1;cn<rt+Qe-1;cn++){const qt=Kc(Ne*O.getoffsetX(cn),Le,je,l,J,ee,ot,Ue,ct,V,S,re,_e,!1,!1,xe,we,ze);if(!qt)return H.length-=4*(cn-rt),{notEnoughRoom:!0};Ct(qt)}Ct(Kt.last)}else{if(p&&!l){const cn=$i(ee.x,ee.y,0,b),qt=Ue+ot+1,yn=new o.P(V.getx(qt),V.gety(qt)),Et=$i(yn.x,yn.y,0,b),nn=Et[3]>0?Et:qc(ee,yn,cn,1,b,void 0,xe,we.canonical),Qt=Ki(gt,ht,(nn[0]-cn[0])*ve,nn[1]-cn[1]);if(f.flipState=Qt&&Qt.needsFlipping?na.flipRequired:na.flipNotRequired,Qt)return Qt}const Kt=Kc(Ne*O.getoffsetX(rt),Le,je,l,J,ee,ot,Ue,ct,V,S,re,_e,!1,!1,xe,we,ze);if(!Kt)return{notEnoughRoom:!0};Ct(Kt)}return{}}function f_(f,r,l,p,b){const{x:S,y:E,z:O}=p.projectTilePoint(f.x,f.y,r);if(!b)return $i(S,E,O,l);const[V,H,W]=b(f);return $i(S+V,E+H,O+W,l)}function qc(f,r,l,p,b,S,E,O){const V=f_(f.sub(r)._unit()._add(f),O,b,E,S);return o.a6.vec3.sub(V,l,V),o.a6.vec3.normalize(V,V),o.a6.vec3.scaleAndAdd(V,l,V,p)}function Kc(f,r,l,p,b,S,E,O,V,H,W,J,ee,re,ve,_e,xe,we){const ze=p?f-r:f+r;let Ne=ze>0?1:-1,Le=0;p&&(Ne*=-1,Le=Math.PI),Ne<0&&(Le+=Math.PI);let je=O+E+(Ne>0?0:1)|0,Ue=b,rt=b,Qe=0,ot=0;const gt=Math.abs(ze),ht=[],ct=[];let Ct=S,Kt=Ct;const cn=()=>qc(Kt,Ct,rt,gt-Qe+1,W,ee,_e,xe.canonical);for(;Qe+ot<=gt;){if(je+=Ne,je<O||je>=V)return null;if(rt=Ue,Kt=Ct,ht.push(rt),re&&ct.push(Kt),Ct=new o.P(H.getx(je),H.gety(je)),Ue=J[je],!Ue){const pn=f_(Ct,xe.canonical,W,_e,ee);Ue=pn[3]>0?J[je]=pn:cn()}Qe+=ot,ot=o.a6.vec3.distance(rt,Ue)}ve&&ee&&(J[je]&&(Ue=cn(),ot=o.a6.vec3.distance(rt,Ue)),J[je]=Ue);const qt=(gt-Qe)/ot,yn=Ct.sub(Kt)._mult(qt)._add(Kt),Et=o.a6.vec3.sub([],Ue,rt),nn=o.a6.vec3.scaleAndAdd([],rt,Et,qt);let Qt=[0,0,1],bn=Et[0],wn=Et[1];if(we&&(Qt=_e.upVector(xe.canonical,yn.x,yn.y),Qt[0]!==0||Qt[1]!==0||Qt[2]!==1)){const pn=[Qt[2],0,-Qt[0]],er=o.a6.vec3.cross([],Qt,pn);o.a6.vec3.normalize(pn,pn),o.a6.vec3.normalize(er,er),bn=o.a6.vec3.dot(Et,pn),wn=o.a6.vec3.dot(Et,er)}if(l){const pn=o.a6.vec3.cross([],Qt,Et);o.a6.vec3.normalize(pn,pn),o.a6.vec3.scaleAndAdd(nn,nn,pn,l*Ne)}const an=Le+Math.atan2(wn,bn);return ht.push(nn),re&&ct.push(yn),{point:nn,angle:an,path:ht,tilePath:ct,up:Qt}}function wa(f,r){const l=r.length,p=l+4*f;r.resize(p),r.float32.fill(-1/0,4*l,4*p)}function Hh(f,r,l){const p=r[0],b=r[1];return f[0]=l[0]*p+l[4]*b+l[12],f[1]=l[1]*p+l[5]*b+l[13],f[3]=l[3]*p+l[7]*b+l[15],f}const xs=100;class Vi{constructor(r,l,p=new Uh(r.width+200,r.height+200,25),b=new Uh(r.width+200,r.height+200,25)){this.transform=r,this.grid=p,this.ignoredGrid=b,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+xs,this.screenBottomBoundary=r.height+xs,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=l}placeCollisionBox(r,l,p,b,S,E,O,V){let H=p.projectedAnchorX,W=p.projectedAnchorY,J=p.projectedAnchorZ;const ee=p.elevation,re=p.tileID,ve=r.getProjection();if(ee&&re){const[Ue,rt,Qe]=ve.upVector(re.canonical,p.tileAnchorX,p.tileAnchorY),ot=ve.upVectorScale(re.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=Ue*ee*ot,W+=rt*ee*ot,J+=Qe*ee*ot}const _e=this.projectAndGetPerspectiveRatio(O,H,W,J,p.tileID,ve.name==="globe"||!!ee||this.transform.pitch>0,ve),xe=E*_e.perspectiveRatio,we=(p.x1*l+b.x-p.padding)*xe+_e.point.x,ze=(p.y1*l+b.y-p.padding)*xe+_e.point.y,Ne=(p.x2*l+b.x+p.padding)*xe+_e.point.x,Le=(p.y2*l+b.y+p.padding)*xe+_e.point.y,je=_e.perspectiveRatio<=.55||_e.occluded;return!this.isInsideGrid(we,ze,Ne,Le)||!S&&this.grid.hitTest(we,ze,Ne,Le,V)||je?{box:[],offscreen:!1,occluded:_e.occluded}:{box:[we,ze,Ne,Le],offscreen:this.isOffscreen(we,ze,Ne,Le),occluded:!1}}placeCollisionCircles(r,l,p,b,S,E,O,V,H,W,J,ee,re,ve,_e){const xe=[],we=this.transform.elevation,ze=r.getProjection(),Ne=we?we.getAtTileOffsetFunc(_e,this.transform.center.lat,this.transform.worldSize,ze):null,Le=new o.P(p.tileAnchorX,p.tileAnchorY);let{x:je,y:Ue,z:rt}=ze.projectTilePoint(Le.x,Le.y,_e.canonical);if(Ne){const[yn,Et,nn]=Ne(Le);je+=yn,Ue+=Et,rt+=nn}const Qe=ze.name==="globe",ot=this.projectAndGetPerspectiveRatio(O,je,Ue,rt,_e,Qe||!!we||this.transform.pitch>0,ze),{perspectiveRatio:gt}=ot,ht=(J?E/gt:E*gt)/o.bq,ct=$i(je,Ue,rt,V),Ct=ot.signedDistanceFromCamera>0?Wc(ht,S,p.lineOffsetX*ht,p.lineOffsetY*ht,!1,ct,Le,p,b,V,{},we&&!J?Ne:null,J&&!!we,ze,_e,J):null;let Kt=!1,cn=!1,qt=!0;if(Ct&&!ot.occluded){const yn=.5*re*gt+ve,Et=new o.P(-100,-100),nn=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Qt=new xa,{first:bn,last:wn}=Ct,an=bn.path.length;let pn=[];for(let $n=an-1;$n>=1;$n--)pn.push(bn.path[$n]);for(let $n=1;$n<wn.path.length;$n++)pn.push(wn.path[$n]);const er=2.5*yn;H&&(pn=pn.map(([$n,gr,Zn],lr)=>(Ne&&!Qe&&(Zn=Ne(lr<an-1?bn.tilePath[an-1-lr]:wn.tilePath[lr-an+2])[2]),$i($n,gr,Zn,H))),pn.some($n=>$n[3]<=0)&&(pn=[]));let Mn=[];if(pn.length>0){let $n=1/0,gr=-1/0,Zn=1/0,lr=-1/0;for(const zr of pn)$n=Math.min($n,zr[0]),Zn=Math.min(Zn,zr[1]),gr=Math.max(gr,zr[0]),lr=Math.max(lr,zr[1]);gr>=Et.x&&$n<=nn.x&&lr>=Et.y&&Zn<=nn.y&&(Mn=[pn.map(zr=>new o.P(zr[0],zr[1]))],($n<Et.x||gr>nn.x||Zn<Et.y||lr>nn.y)&&(Mn=o.bo(Mn,Et.x,Et.y,nn.x,nn.y)))}for(const $n of Mn){Qt.reset($n,.25*yn);let gr=0;gr=Qt.length<=.5*yn?1:Math.ceil(Qt.paddedLength/er)+1;for(let Zn=0;Zn<gr;Zn++){const lr=Zn/Math.max(gr-1,1),zr=Qt.lerp(lr),Dr=zr.x+xs,po=zr.y+xs;xe.push(Dr,po,yn,0);const To=Dr-yn,Lo=po-yn,Vs=Dr+yn,ri=po+yn;if(qt=qt&&this.isOffscreen(To,Lo,Vs,ri),cn=cn||this.isInsideGrid(To,Lo,Vs,ri),!l&&this.grid.hitTestCircle(Dr,po,yn,ee)&&(Kt=!0,!W))return{circles:[],offscreen:!1,collisionDetected:Kt,occluded:!1}}}}return{circles:!W&&Kt||!cn?[]:xe,offscreen:qt,collisionDetected:Kt,occluded:ot.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let p=1/0,b=1/0,S=-1/0,E=-1/0;for(const W of r){const J=new o.P(W.x+xs,W.y+xs);p=Math.min(p,J.x),b=Math.min(b,J.y),S=Math.max(S,J.x),E=Math.max(E,J.y),l.push(J)}const O=this.grid.query(p,b,S,E).concat(this.ignoredGrid.query(p,b,S,E)),V={},H={};for(const W of O){const J=W.key;if(V[J.bucketInstanceId]===void 0&&(V[J.bucketInstanceId]={}),V[J.bucketInstanceId][J.featureIndex])continue;const ee=[new o.P(W.x1,W.y1),new o.P(W.x2,W.y1),new o.P(W.x2,W.y2),new o.P(W.x1,W.y2)];o.bp(l,ee)&&(V[J.bucketInstanceId][J.featureIndex]=!0,H[J.bucketInstanceId]===void 0&&(H[J.bucketInstanceId]=[]),H[J.bucketInstanceId].push(J.featureIndex))}return H}insertCollisionBox(r,l,p,b,S){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:b,collisionGroupID:S},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,l,p,b,S){const E=l?this.ignoredGrid:this.grid,O={bucketInstanceId:p,featureIndex:b,collisionGroupID:S};for(let V=0;V<r.length;V+=4)E.insertCircle(O,r[V],r[V+1],r[V+2])}projectAndGetPerspectiveRatio(r,l,p,b,S,E,O){const V=[l,p,b,1];let H=!1;b||this.transform.pitch>0?(o.a6.vec4.transformMat4(V,V,r),this.fogState&&S&&O.name!=="globe"&&(H=function(ee,re,ve,_e,xe,we){const ze=we.calculateFogTileMatrix(xe),Ne=[re,ve,_e];return o.a6.vec3.transformMat4(Ne,Ne,ze),Cn(ee,o.a6.vec3.length(Ne),we.pitch,we._fov)}(this.fogState,l,p,b,S.toUnwrapped(),this.transform)>.9)):Hh(V,V,r);const W=V[3];return{point:new o.P((V[0]/W+1)/2*this.transform.width+xs,(-V[1]/W+1)/2*this.transform.height+xs),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/W*.5,1.5),signedDistanceFromCamera:W,occluded:E&&V[2]>W||H}}isOffscreen(r,l,p,b){return p<xs||r>=this.screenRightBoundary||b<xs||l>this.screenBottomBoundary}isInsideGrid(r,l,p,b){return p>=0&&r<this.gridRightBoundary&&b>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const r=o.a6.mat4.identity([]);return o.a6.mat4.translate(r,r,[-100,-100,0]),r}}function Zi(f,r,l){const p=r.createTileMatrix(f,f.worldSize,l.toUnwrapped());return o.a6.mat4.multiply(new Float32Array(16),f.projMatrix,p)}function p_(f,r,l){if(r.projection.name===l.projection.name)return f.projMatrix;const p=l.clone();return p.setProjection(r.projection),Zi(p,r.getProjection(),f)}function Cl(f,r,l){return r.name===l.projection.name?f.projMatrix:Zi(l,r,f)}class ci{constructor(r,l,p,b){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?l:-l))):b&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class Yi{constructor(r,l,p,b,S,E=!1){this.text=new ci(r?r.text:null,l,p,S),this.icon=new ci(r?r.icon:null,l,b,S),this.clipped=E}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ra{constructor(r,l,p,b=!1){this.text=r,this.icon=l,this.skipFade=p,this.clipped=b}}class yi{constructor(){this.invProjMatrix=o.a6.mat4.create(),this.viewportMatrix=o.a6.mat4.create(),this.circles=[]}}class hm{constructor(r,l,p,b,S){this.bucketInstanceId=r,this.featureIndex=l,this.sourceLayerIndex=p,this.bucketIndex=b,this.tileID=S}}class oa{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const l=++this.maxGroupID;this.collisionGroups[r]={ID:l,predicate:p=>p.collisionGroupID===l}}return this.collisionGroups[r]}}function Zc(f,r,l,p,b){const{horizontalAlign:S,verticalAlign:E}=o.bx(f),O=-(S-.5)*r,V=-(E-.5)*l,H=o.bw(f,p);return new o.P(O+H[0]*b,V+H[1]*b)}function sc(f,r,l,p,b){const S=new o.P(f,r);return l&&S._rotate(p?b:-b),S}class ac{constructor(r,l,p,b,S,E){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new Vi(this.transform,S),this.buildingIndex=E,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new oa(p),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,l,p,b){const S=p.getBucket(l),E=p.latestFeatureIndex;if(!S||!E||l.fqid!==S.layerIds[0])return;const O=S.layers[0].layout,V=S.layers[0].paint,H=p.collisionBoxArray,W=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),J=p.tileSize/o.ab,ee=p.tileID.toUnwrapped();this.transform.setProjection(S.projection);const re=(ve=p.tileID,_e=S.getProjection(),xe=this.transform,_e.name===this.projection?xe.calculateProjMatrix(ve.toUnwrapped()):Zi(xe,_e,ve));var ve,_e,xe;const we=O.get("text-pitch-alignment")==="map",ze=O.get("text-rotation-alignment")==="map";l.compileFilter();const Ne=l.dynamicFilter(),Le=l.dynamicFilterNeedsFeature(),je=this.transform.calculatePixelsToTileUnitsMatrix(p),Ue=Kr(re,p.tileID.canonical,we,ze,this.transform,S.getProjection(),je);let rt=null;if(we){const gt=as(re,p.tileID.canonical,we,ze,this.transform,S.getProjection(),je);rt=o.a6.mat4.multiply([],this.transform.labelPlaneMatrix,gt)}let Qe=null;Ne&&p.latestFeatureIndex&&(Qe={unwrappedTileID:ee,dynamicFilter:Ne,dynamicFilterNeedsFeature:Le}),this.retainedQueryData[S.bucketInstanceId]=new hm(S.bucketInstanceId,E,S.sourceLayerIndex,S.index,p.tileID);const ot={bucket:S,layout:O,paint:V,posMatrix:re,textLabelPlaneMatrix:Ue,labelToScreenMatrix:rt,clippingData:Qe,scale:W,textPixelRatio:J,holdingForFade:p.holdingForFade(),collisionBoxArray:H,partiallyEvaluatedTextSize:o.bj(S.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.bj(S.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID),latestFeatureIndex:p.latestFeatureIndex};if(b)for(const gt of S.sortKeyRanges){const{sortKey:ht,symbolInstanceStart:ct,symbolInstanceEnd:Ct}=gt;r.push({sortKey:ht,symbolInstanceStart:ct,symbolInstanceEnd:Ct,parameters:ot})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:ot})}attemptAnchorPlacement(r,l,p,b,S,E,O,V,H,W,J,ee,re,ve,_e,xe,we,ze){const{textOffset0:Ne,textOffset1:Le,crossTileID:je}=ee,Ue=[Ne,Le],rt=Zc(r,p,b,Ue,S),Qe=this.collisionIndex.placeCollisionBox(ve,S,l,sc(rt.x,rt.y,E,O,this.transform.angle),J,V,H,W.predicate);if(xe){const ot=ve.getSymbolInstanceIconSize(ze,this.transform.zoom,ee.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ve,ot,xe,sc(rt.x,rt.y,E,O,this.transform.angle),J,V,H,W.predicate).box.length===0)return}if(Qe.box.length>0){let ot;return this.prevPlacement&&this.prevPlacement.variableOffsets[je]&&this.prevPlacement.placements[je]&&this.prevPlacement.placements[je].text&&(ot=this.prevPlacement.variableOffsets[je].anchor),this.variableOffsets[je]={textOffset:Ue,width:p,height:b,anchor:r,textScale:S,prevAnchor:ot},this.markUsedJustification(ve,r,ee,_e),ve.allowVerticalPlacement&&(this.markUsedOrientation(ve,_e,ee),this.placedOrientations[je]=_e),{shift:rt,placedGlyphBoxes:Qe}}}placeLayerBucketPart(r,l,p,b){const{bucket:S,layout:E,paint:O,posMatrix:V,textLabelPlaneMatrix:H,labelToScreenMatrix:W,clippingData:J,textPixelRatio:ee,holdingForFade:re,collisionBoxArray:ve,partiallyEvaluatedTextSize:_e,partiallyEvaluatedIconSize:xe,collisionGroup:we,latestFeatureIndex:ze}=r.parameters,Ne=E.get("text-optional"),Le=E.get("icon-optional"),je=E.get("text-allow-overlap"),Ue=E.get("icon-allow-overlap"),rt=E.get("text-rotation-alignment")==="map",Qe=E.get("text-pitch-alignment")==="map",ot=E.get("symbol-z-elevate"),gt=O.get("symbol-z-offset"),ht=O.get("symbol-elevation-reference")==="sea";this.transform.setProjection(S.projection);let ct=je&&(Ue||!S.hasIconData()||Le),Ct=Ue&&(je||!S.hasTextData()||Ne);const Kt=!gt.isConstant();!S.collisionArrays&&ve&&S.deserializeCollisionBoxes(ve),p&&b&&S.updateCollisionDebugBuffers(this.transform.zoom,ve);const cn=(qt,yn,Et)=>{const{crossTileID:nn,numVerticalGlyphVertices:Qt}=qt;let bn=null;if(J&&J.dynamicFilterNeedsFeature||Kt){const Lr=this.retainedQueryData[S.bucketInstanceId];bn=ze.loadFeature({featureIndex:qt.featureIndex,bucketIndex:Lr.bucketIndex,sourceLayerIndex:Lr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(J&&!(0,J.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},bn,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new o.P(qt.tileAnchorX,qt.tileAnchorY),this.transform.calculateDistanceTileData(J.unwrappedTileID)))return this.placements[nn]=new ra(!1,!1,!1,!0),void l.add(nn);const wn=gt.evaluate(bn,{});if(l.has(nn))return;if(re)return void(this.placements[nn]=new ra(!1,!1,!1));let an=!1,pn=!1,er=!0,Mn=!1,$n=!1,gr=null,Zn={box:null,offscreen:null,occluded:null},lr={box:null,offscreen:null,occluded:null},zr=null,Dr=null,po=null,To=0,Lo=0,Vs=0;Et.textFeatureIndex?To=Et.textFeatureIndex:qt.useRuntimeCollisionCircles&&(To=qt.featureIndex),Et.verticalTextFeatureIndex&&(Lo=Et.verticalTextFeatureIndex);const ri=Lr=>{Lr.tileID=this.retainedQueryData[S.bucketInstanceId].tileID;const io=this.transform.elevation;Lr.elevation=ht?wn:wn+(io?io.getAtTileOffset(Lr.tileID,Lr.tileAnchorX,Lr.tileAnchorY):0),Lr.elevation+=qt.zOffset},jr=Et.textBox;if(jr){ri(jr);const Lr=uo=>{let Yo=o.bk.horizontal;if(S.allowVerticalPlacement&&!uo&&this.prevPlacement){const oi=this.prevPlacement.placedOrientations[nn];oi&&(this.placedOrientations[nn]=oi,Yo=oi,this.markUsedOrientation(S,Yo,qt))}return Yo},io=(uo,Yo)=>{if(S.allowVerticalPlacement&&Qt>0&&Et.verticalTextBox){for(const oi of S.writingModes)if(oi===o.bk.vertical?(Zn=Yo(),lr=Zn):Zn=uo(),Zn&&Zn.box&&Zn.box.length)break}else Zn=uo()};if(E.get("text-variable-anchor")){let uo=E.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[nn]){const Yr=this.prevPlacement.variableOffsets[nn];uo.indexOf(Yr.anchor)>0&&(uo=uo.filter(gi=>gi!==Yr.anchor),uo.unshift(Yr.anchor))}const Yo=(Yr,gi,bi)=>{const vi=S.getSymbolInstanceTextSize(_e,qt,this.transform.zoom,yn),Po=(Yr.x2-Yr.x1)*vi+2*Yr.padding,Ji=(Yr.y2-Yr.y1)*vi+2*Yr.padding,Qi=qt.hasIconTextFit&&!Ue?gi:null;Qi&&ri(Qi);let Us={box:[],offscreen:!1,occluded:!1};const Ms=je?2*uo.length:uo.length;for(let ds=0;ds<Ms;++ds){const js=this.attemptAnchorPlacement(uo[ds%uo.length],Yr,Po,Ji,vi,rt,Qe,ee,V,we,ds>=uo.length,qt,yn,S,bi,Qi,_e,xe);if(js&&(Us=js.placedGlyphBoxes,Us&&Us.box&&Us.box.length)){an=!0,gr=js.shift;break}}return Us};io(()=>Yo(jr,Et.iconBox,o.bk.horizontal),()=>{const Yr=Et.verticalTextBox;return Yr&&ri(Yr),S.allowVerticalPlacement&&!(Zn&&Zn.box&&Zn.box.length)&&Qt>0&&Yr?Yo(Yr,Et.verticalIconBox,o.bk.vertical):{box:null,offscreen:null,occluded:null}}),Zn&&(an=Zn.box,er=Zn.offscreen,Mn=Zn.occluded);const oi=Lr(!(!Zn||!Zn.box));if(!an&&this.prevPlacement){const Yr=this.prevPlacement.variableOffsets[nn];Yr&&(this.variableOffsets[nn]=Yr,this.markUsedJustification(S,Yr.anchor,qt,oi))}}else{const uo=(Yo,oi)=>{const Yr=S.getSymbolInstanceTextSize(_e,qt,this.transform.zoom,yn),gi=this.collisionIndex.placeCollisionBox(S,Yr,Yo,new o.P(0,0),je,ee,V,we.predicate);return gi&&gi.box&&gi.box.length&&(this.markUsedOrientation(S,oi,qt),this.placedOrientations[nn]=oi),gi};io(()=>uo(jr,o.bk.horizontal),()=>{const Yo=Et.verticalTextBox;return S.allowVerticalPlacement&&Qt>0&&Yo?(ri(Yo),uo(Yo,o.bk.vertical)):{box:null,offscreen:null,occluded:null}}),Lr(!!(Zn&&Zn.box&&Zn.box.length))}}if(zr=Zn,an=zr&&zr.box&&zr.box.length>0,er=zr&&zr.offscreen,Mn=zr&&zr.occluded,qt.useRuntimeCollisionCircles){const Lr=S.text.placedSymbolArray.get(qt.centerJustifiedTextSymbolIndex>=0?qt.centerJustifiedTextSymbolIndex:qt.verticalPlacedTextSymbolIndex),io=o.bl(S.textSizeData,_e,Lr),uo=E.get("text-padding");Dr=this.collisionIndex.placeCollisionCircles(S,je,Lr,S.lineVertexArray,S.glyphOffsetArray,io,V,H,W,p,Qe,we.predicate,qt.collisionCircleDiameter*io/o.bq,uo,this.retainedQueryData[S.bucketInstanceId].tileID),an=je||Dr.circles.length>0&&!Dr.collisionDetected,er=er&&Dr.offscreen,Mn=Dr.occluded}if(Et.iconFeatureIndex&&(Vs=Et.iconFeatureIndex),Et.iconBox){const Lr=io=>{ri(io);const uo=qt.hasIconTextFit&&gr?sc(gr.x,gr.y,rt,Qe,this.transform.angle):new o.P(0,0),Yo=S.getSymbolInstanceIconSize(xe,this.transform.zoom,qt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,Yo,io,uo,Ue,ee,V,we.predicate)};lr&&lr.box&&lr.box.length&&Et.verticalIconBox?(po=Lr(Et.verticalIconBox),pn=po.box.length>0):(po=Lr(Et.iconBox),pn=po.box.length>0),er=er&&po.offscreen,$n=po.occluded}const xo=Ne||qt.numHorizontalGlyphVertices===0&&Qt===0,Vo=Le||qt.numIconVertices===0;if(xo||Vo?Vo?xo||(pn=pn&&an):an=pn&&an:pn=an=pn&&an,an&&zr&&zr.box&&this.collisionIndex.insertCollisionBox(zr.box,E.get("text-ignore-placement"),S.bucketInstanceId,lr&&lr.box&&Lo?Lo:To,we.ID),pn&&po&&this.collisionIndex.insertCollisionBox(po.box,E.get("icon-ignore-placement"),S.bucketInstanceId,Vs,we.ID),Dr&&(an&&this.collisionIndex.insertCollisionCircles(Dr.circles,E.get("text-ignore-placement"),S.bucketInstanceId,To,we.ID),p)){const Lr=S.bucketInstanceId;let io=this.collisionCircleArrays[Lr];io===void 0&&(io=this.collisionCircleArrays[Lr]=new yi);for(let uo=0;uo<Dr.circles.length;uo+=4)io.circles.push(Dr.circles[uo+0]),io.circles.push(Dr.circles[uo+1]),io.circles.push(Dr.circles[uo+2]),io.circles.push(Dr.collisionDetected?1:0)}const vo=S.projection.name!=="globe";ct=ct&&(vo||!Mn),Ct=Ct&&(vo||!$n),this.placements[nn]=new ra(an||ct,pn||Ct,er||S.justReloaded),l.add(nn)};if(ot&&this.buildingIndex&&(this.buildingIndex.updateZOffset(S,this.retainedQueryData[S.bucketInstanceId].tileID),S.updateZOffset()),S.sortFeaturesByY){const qt=S.getSortedSymbolIndexes(this.transform.angle);for(let yn=qt.length-1;yn>=0;--yn){const Et=qt[yn];cn(S.symbolInstances.get(Et),Et,S.collisionArrays[Et])}S.hasAnyZOffset&&o.w(`${S.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(S.hasAnyZOffset){const qt=S.getSortedIndexesByZOffset();for(let yn=0;yn<qt.length;++yn){const Et=qt[yn];cn(S.symbolInstances.get(Et),Et,S.collisionArrays[Et])}}else for(let qt=r.symbolInstanceStart;qt<r.symbolInstanceEnd;qt++)cn(S.symbolInstances.get(qt),qt,S.collisionArrays[qt]);if(p&&S.bucketInstanceId in this.collisionCircleArrays){const qt=this.collisionCircleArrays[S.bucketInstanceId];o.a6.mat4.invert(qt.invProjMatrix,V),qt.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(r,l,p,b){const{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:V,crossTileID:H}=p,W=o.bv(l),J=b===o.bk.vertical?V:W==="left"?S:W==="center"?E:W==="right"?O:-1;S>=0&&(r.text.placedSymbolArray.get(S).crossTileID=J>=0&&S!==J?0:H),E>=0&&(r.text.placedSymbolArray.get(E).crossTileID=J>=0&&E!==J?0:H),O>=0&&(r.text.placedSymbolArray.get(O).crossTileID=J>=0&&O!==J?0:H),V>=0&&(r.text.placedSymbolArray.get(V).crossTileID=J>=0&&V!==J?0:H)}markUsedOrientation(r,l,p){const b=l===o.bk.horizontal||l===o.bk.horizontalOnly?l:0,S=l===o.bk.vertical?l:0,{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:V,verticalPlacedTextSymbolIndex:H}=p,W=r.text.placedSymbolArray;E>=0&&(W.get(E).placedOrientation=b),O>=0&&(W.get(O).placedOrientation=b),V>=0&&(W.get(V).placedOrientation=b),H>=0&&(W.get(H).placedOrientation=S)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let p=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const b=l?l.symbolFadeChange(r):1,S=l?l.opacities:{},E=l?l.variableOffsets:{},O=l?l.placedOrientations:{};for(const V in this.placements){const H=this.placements[V],W=S[V];W?(this.opacities[V]=new Yi(W,b,H.text,H.icon,null,H.clipped),p=p||H.text!==W.text.placed||H.icon!==W.icon.placed):(this.opacities[V]=new Yi(null,b,H.text,H.icon,H.skipFade,H.clipped),p=p||H.text||H.icon)}for(const V in S){const H=S[V];if(!this.opacities[V]){const W=new Yi(H,b,!1,!1);W.isHidden()||(this.opacities[V]=W,p=p||H.text.placed||H.icon.placed)}}for(const V in E)this.variableOffsets[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.variableOffsets[V]=E[V]);for(const V in O)this.placedOrientations[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.placedOrientations[V]=O[V]);p?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:r)}updateLayerOpacities(r,l,p,b){const S=new Set;for(const E of l){const O=E.getBucket(r);O&&E.latestFeatureIndex&&r.fqid===O.layerIds[0]&&(this.updateBucketOpacities(O,S,E,E.collisionBoxArray,p,b,E.tileID,r.scope),O.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(O,E.tileID),O.updateZOffset()))}}updateBucketOpacities(r,l,p,b,S,E,O,V){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const H=r.layers[0].layout,W=r.layers[0].paint,J=!!r.layers[0].dynamicFilter(),ee=new Yi(null,0,!1,!1,!0),re=H.get("text-allow-overlap"),ve=H.get("icon-allow-overlap"),_e=H.get("text-variable-anchor"),xe=H.get("text-rotation-alignment")==="map",we=H.get("text-pitch-alignment")==="map",ze=W.get("symbol-z-offset"),Ne=W.get("symbol-elevation-reference")==="sea",Le=!ze.isConstant(),je=new Yi(null,0,re&&(ve||!r.hasIconData()||H.get("icon-optional")),ve&&(re||!r.hasTextData()||H.get("text-optional")),!0);!r.collisionArrays&&b&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(b);const Ue=(Qe,ot,gt)=>{for(let ht=0;ht<ot/4;ht++)Qe.opacityVertexArray.emplaceBack(gt)};let rt=0;E&&r.updateReplacement(O,E);for(let Qe=0;Qe<r.symbolInstances.length;Qe++){const ot=r.symbolInstances.get(Qe),{numHorizontalGlyphVertices:gt,numVerticalGlyphVertices:ht,crossTileID:ct,numIconVertices:Ct,tileAnchorX:Kt,tileAnchorY:cn}=ot;let qt=null;if(ot&&Le){const Mn=this.retainedQueryData[r.bucketInstanceId];qt=p.latestFeatureIndex.loadFeature({featureIndex:ot.featureIndex,bucketIndex:Mn.bucketIndex,sourceLayerIndex:Mn.sourceLayerIndex,layoutVertexArrayOffset:0})}const yn=ze.evaluate(qt,{}),Et=l.has(ct);let nn=this.opacities[ct];Et?nn=ee:nn||(nn=je,this.opacities[ct]=nn),l.add(ct);const Qt=gt>0||ht>0,bn=Ct>0,wn=this.placedOrientations[ct],an=wn===o.bk.vertical,pn=wn===o.bk.horizontal||wn===o.bk.horizontalOnly;!Qt&&!bn||nn.isHidden()||rt++;let er=!1;if((Qt||bn)&&E)for(const Mn of r.activeReplacements){if(o.br(Mn,S,o.bs.Symbol,V)||Mn.min.x>Kt||Kt>Mn.max.x||Mn.min.y>cn||cn>Mn.max.y)continue;const $n=o.bt(Kt,cn,O.canonical,Mn.footprintTileId.canonical);if(er=o.bu($n,Mn.footprint),er)break}if(Qt){const Mn=er?Xc:Yc(nn.text);Ue(r.text,gt,an?Xc:Mn),Ue(r.text,ht,pn?Xc:Mn);const $n=nn.text.isHidden(),{leftJustifiedTextSymbolIndex:gr,centerJustifiedTextSymbolIndex:Zn,rightJustifiedTextSymbolIndex:lr,verticalPlacedTextSymbolIndex:zr}=ot,Dr=r.text.placedSymbolArray,po=$n||an?1:0;gr>=0&&(Dr.get(gr).hidden=po),Zn>=0&&(Dr.get(Zn).hidden=po),lr>=0&&(Dr.get(lr).hidden=po),zr>=0&&(Dr.get(zr).hidden=$n||pn?1:0);const To=this.variableOffsets[ct];To&&this.markUsedJustification(r,To.anchor,ot,wn);const Lo=this.placedOrientations[ct];Lo&&(this.markUsedJustification(r,"left",ot,Lo),this.markUsedOrientation(r,Lo,ot))}if(bn){const Mn=er?Xc:Yc(nn.icon),{placedIconSymbolIndex:$n,verticalPlacedIconSymbolIndex:gr}=ot,Zn=r.icon.placedSymbolArray,lr=nn.icon.isHidden()?1:0;$n>=0&&(Ue(r.icon,Ct,an?Xc:Mn),Zn.get($n).hidden=lr),gr>=0&&(Ue(r.icon,ot.numVerticalIconVertices,pn?Xc:Mn),Zn.get(gr).hidden=lr)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Mn=r.collisionArrays[Qe];if(Mn){let $n=new o.P(0,0),gr=!0;if(Mn.textBox||Mn.verticalTextBox){if(_e){const lr=this.variableOffsets[ct];lr?($n=Zc(lr.anchor,lr.width,lr.height,lr.textOffset,lr.textScale),xe&&$n._rotate(we?this.transform.angle:-this.transform.angle)):gr=!1}J&&(gr=!nn.clipped),Mn.textBox&&Gh(r.textCollisionBox.collisionVertexArray,nn.text.placed,!gr||an,yn,Ne,$n.x,$n.y),Mn.verticalTextBox&&Gh(r.textCollisionBox.collisionVertexArray,nn.text.placed,!gr||pn,yn,Ne,$n.x,$n.y)}const Zn=gr&&!!(!pn&&Mn.verticalIconBox);Mn.iconBox&&Gh(r.iconCollisionBox.collisionVertexArray,nn.icon.placed,Zn,yn,Ne,ot.hasIconTextFit?$n.x:0,ot.hasIconTextFit?$n.y:0),Mn.verticalIconBox&&Gh(r.iconCollisionBox.collisionVertexArray,nn.icon.placed,!Zn,yn,Ne,ot.hasIconTextFit?$n.x:0,ot.hasIconTextFit?$n.y:0)}}}if(r.fullyClipped=rt===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const Qe=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=Qe.invProjMatrix,r.placementViewportMatrix=Qe.viewportMatrix,r.collisionCircleArray=Qe.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,l){const p=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*p>r}setStale(){this.stale=!0}}function Gh(f,r,l,p,b,S,E){f.emplaceBack(r?1:0,l?1:0,S||0,E||0,p,b?1:0),f.emplaceBack(r?1:0,l?1:0,S||0,E||0,p,b?1:0),f.emplaceBack(r?1:0,l?1:0,S||0,E||0,p,b?1:0),f.emplaceBack(r?1:0,l?1:0,S||0,E||0,p,b?1:0)}const Wa=Math.pow(2,25),h1=Math.pow(2,24),m_=Math.pow(2,17),ls=Math.pow(2,16),f1=Math.pow(2,9),Wh=Math.pow(2,8),g_=Math.pow(2,1);function Yc(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const r=f.placed?1:0,l=Math.floor(127*f.opacity);return l*Wa+r*h1+l*m_+r*ls+l*f1+r*Wh+l*g_+r}const Xc=0;class p1{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,l,p,b,S){const E=this._bucketParts;for(;this._currentTileIndex<r.length;)if(l.getBucketParts(E,b,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((O,V)=>O.sortKey-V.sortKey));this._currentPartIndex<E.length;){const O=E[this._currentPartIndex];if(l.placeLayerBucketPart(O,this._seenCrossTileIDs,p,O.symbolInstanceStart===0),this._currentPartIndex++,S())return!0}return!1}}class _d{constructor(r,l,p,b,S,E,O,V,H){this.placement=new ac(r,S,E,O,V,H),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(r,l,p,b){const S=o.q.now(),E=()=>{const O=o.q.now()-S;return!this._forceFullPlacement&&O>2};for(;this._currentPlacementIndex>=0;){const O=l[r[this._currentPlacementIndex]],V=this.placement.collisionIndex.transform.zoom;if(O.type==="symbol"&&(!O.minzoom||O.minzoom<=V)&&(!O.maxzoom||O.maxzoom>V)){const H=O,W=H.layout.get("symbol-z-elevate"),J=H.layout.get("symbol-sort-key").constantOr(1)!==void 0,ee=H.layout.get("symbol-z-order"),re=ee==="viewport-y"||ee==="auto"&&!(ee!=="viewport-y"&&J),ve=H.layout.get("text-allow-overlap")||H.layout.get("icon-allow-overlap")||H.layout.get("text-ignore-placement")||H.layout.get("icon-ignore-placement"),_e=re&&ve,xe=this._inProgressLayer=this._inProgressLayer||new p1(H),we=o.av(O.source,O.scope);if(xe.continuePlacement(W||_e?b[we]:p[we],this.placement,this._showCollisionBoxes,O,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const lc=512/o.ab/2;class m1{constructor(r,l,p){this.tileID=r,this.bucketInstanceId=p,this.index=new o.by(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const b=r.canonical.x*o.ab,S=r.canonical.y*o.ab;for(let E=0;E<l.length;E++){const{key:O,crossTileID:V,tileAnchorX:H,tileAnchorY:W}=l.get(E),J=Math.floor((b+H)*lc),ee=Math.floor((S+W)*lc);this.index.add(J,ee),this.keys.push(O),this.crossTileIDs.push(V)}this.index.finish()}findMatches(r,l,p){const b=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),S=lc/Math.pow(2,l.canonical.z-this.tileID.canonical.z),E=l.canonical.x*o.ab,O=l.canonical.y*o.ab;for(let V=0;V<r.length;V++){const H=r.get(V);if(H.crossTileID)continue;const{key:W,tileAnchorX:J,tileAnchorY:ee}=H,re=Math.floor((E+J)*S),ve=Math.floor((O+ee)*S),_e=this.index.range(re-b,ve-b,re+b,ve+b);for(const xe of _e){const we=this.crossTileIDs[xe];if(this.keys[xe]===W&&!p.has(we)){p.add(we),H.crossTileID=we;break}}}}}class Jc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class v_{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const l=Math.round((r-this.lng)/360);if(l!==0)for(const p in this.indexes){const b=this.indexes[p],S={};for(const E in b){const O=b[E];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+l),S[O.tileID.key]=O}this.indexes[p]=S}this.lng=r}addBucket(r,l,p){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let S=0;S<l.symbolInstances.length;S++)l.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const b=this.usedCrossTileIDs[r.overscaledZ];for(const S in this.indexes){const E=this.indexes[S];if(Number(S)>r.overscaledZ)for(const O in E){const V=E[O];V.tileID.isChildOf(r)&&V.findMatches(l.symbolInstances,r,b)}else{const O=E[r.scaledTo(Number(S)).key];O&&O.findMatches(l.symbolInstances,r,b)}}for(let S=0;S<l.symbolInstances.length;S++){const E=l.symbolInstances.get(S);E.crossTileID||(E.crossTileID=p.generate(),b.add(E.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new m1(r,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(r,l){for(const p of l.crossTileIDs)this.usedCrossTileIDs[r].delete(p)}removeStaleBuckets(r){let l=!1;for(const p in this.indexes){const b=this.indexes[p];for(const S in b)r[b[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,b[S]),delete b[S],l=!0)}return l}}class qh{constructor(){this.layerIndexes={},this.crossTileIDs=new Jc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,l,p,b){let S=this.layerIndexes[r.fqid];S===void 0&&(S=this.layerIndexes[r.fqid]=new v_);let E=!1;const O={};b.name!=="globe"&&S.handleWrapJump(p);for(const V of l){const H=V.getBucket(r);H&&r.fqid===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(V.tileID,H,this.crossTileIDs)&&(E=!0),O[H.bucketInstanceId]=!0)}return S.removeStaleBuckets(O)&&(E=!0),E}pruneUnusedLayers(r){const l={};r.forEach(p=>{l[p]=!0});for(const p in this.layerIndexes)l[p]||delete this.layerIndexes[p]}}const ws=771;class Ur{constructor(r,l,p,b){this.blendFunction=r,this.blendColor=l,this.mask=p,this.blendEquation=b}}Ur.Replace=[1,0,1,0],Ur.disabled=new Ur(Ur.Replace,o.bz.transparent,[!1,!1,!1,!1]),Ur.unblended=new Ur(Ur.Replace,o.bz.transparent,[!0,!0,!0,!0]),Ur.alphaBlended=new Ur([1,ws,1,ws],o.bz.transparent,[!0,!0,!0,!0]),Ur.alphaBlendedNonPremultiplied=new Ur([770,ws,770,ws],o.bz.transparent,[!0,!0,!0,!0]),Ur.multiply=new Ur([774,0,774,0],o.bz.transparent,[!0,!0,!0,!0]);class or{constructor(r,l,p){this.func=r,this.mask=l,this.range=p}}or.ReadOnly=!1,or.ReadWrite=!0,or.disabled=new or(519,or.ReadOnly,[0,1]);const fm=7680;class Mr{constructor(r,l,p,b,S,E){this.test=r,this.ref=l,this.mask=p,this.fail=b,this.depthFail=S,this.pass=E}}Mr.disabled=new Mr({func:519,mask:0},0,0,fm,fm,fm);const pm=1029,yd=2305;class yr{constructor(r,l,p){this.enable=r,this.mode=l,this.frontFace=p}}function mm(f,r){const l=o.bC(f,3);o.a6.mat4.fromQuat(f,r),o.bE(f,3,l)}function Kh(f,r){const l=o.a6.quat.identity([]);return o.a6.quat.rotateZ(l,l,-r),o.a6.quat.rotateX(l,l,-f),l}function gm(f,r){const l=[f[0],f[1],0],p=[r[0],r[1],0];if(o.a6.vec3.length(l)>=1e-15){const E=o.a6.vec3.normalize([],l);o.a6.vec3.scale(p,E,o.a6.vec3.dot(p,E)),r[0]=p[0],r[1]=p[1]}const b=o.a6.vec3.cross([],r,f);if(o.a6.vec3.len(b)<1e-15)return null;const S=Math.atan2(-b[1],b[0]);return Kh(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),S)}yr.disabled=new yr(!1,pm,yd),yr.backCCW=new yr(!0,pm,yd),yr.backCW=new yr(!0,pm,2304),yr.frontCW=new yr(!0,1028,2304),yr.frontCCW=new yr(!0,1028,yd);class El{constructor(r,l){this.position=r,this.orientation=l}get position(){return this._position}set position(r){if(r){const l=r instanceof o.a5?r:new o.a5(r[0],r[1],r[2]);this._renderWorldCopies&&(l.x=o.bA(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(r,l){if(this.orientation=null,!this.position)return;const p=this.position,b=this._elevation?this._elevation.getAtPointOrZero(o.a5.fromLngLat(r)):0,S=o.a5.fromLngLat(r,b),E=[S.x-p.x,S.y-p.y,S.z-p.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=gm(E,l)}setPitchBearing(r,l){this.orientation=Kh(o.bB(r),o.bB(-l))}}class cc{constructor(r,l){this._transform=o.a6.mat4.identity([]),this.orientation=l,this.position=r}get mercatorPosition(){const r=this.position;return new o.a5(r[0],r[1],r[2])}get position(){const r=o.bC(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var l;r&&o.bE(this._transform,3,[(l=r)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||o.a6.quat.identity([]),r&&mm(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,l){this._orientation=Kh(r,l),mm(this._transform,this._orientation)}forward(){const r=o.bC(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=o.bC(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=o.bC(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,l){const p=new Float64Array(16);return o.a6.mat4.invert(p,this.getWorldToCamera(r,l)),p}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,l,p){const b=this.position;o.a6.vec3.scale(b,b,-r);const S=new Float64Array(16);return o.a6.mat4.fromScaling(S,[p,p,p]),o.a6.mat4.translate(S,S,b),S[10]*=l,S}getWorldToCamera(r,l){const p=new Float64Array(16),b=new Float64Array(4),S=this.position;return o.a6.quat.conjugate(b,this._orientation),o.a6.vec3.scale(S,S,-r),o.a6.mat4.fromQuat(p,b),o.a6.mat4.translate(p,p,S),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=l,p[9]*=l,p[10]*=l,p[11]*=l,p}getCameraToClipPerspective(r,l,p,b){const S=new Float64Array(16);return o.a6.mat4.perspective(S,r,l,p,b),S}getCameraToClipOrthographic(r,l,p,b,S,E){const O=new Float64Array(16);return o.a6.mat4.ortho(O,r,l,p,b,S,E),O}getDistanceToElevation(r,l=!1){const p=r===0?0:o.bD(r,l?o.aM(this.position[1]):this.position[1]),b=this.forward();return(p-this.position[2])/b[2]}clone(){return new cc([...this.position],[...this.orientation])}}const Pi={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Zh{constructor(r=0,l=0,p=0,b=0){if(isNaN(r)||r<0||isNaN(l)||l<0||isNaN(p)||p<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=l,this.left=p,this.right=b}interpolate(r,l,p){return l.top!=null&&r.top!=null&&(this.top=o.aa(r.top,l.top,p)),l.bottom!=null&&r.bottom!=null&&(this.bottom=o.aa(r.bottom,l.bottom,p)),l.left!=null&&r.left!=null&&(this.left=o.aa(r.left,l.left,p)),l.right!=null&&r.right!=null&&(this.right=o.aa(r.right,l.right,p)),this}getCenter(r,l){const p=o.ap((this.left+r-this.right)/2,0,r),b=o.ap((this.top+l-this.bottom)/2,0,l);return new o.P(p,b)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Zh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Qc=(f,r,l)=>(1-l)*f+l*r,eu=f=>f*f*f*f*f;class Yh{constructor(r,l,p,b,S,E,O){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=p??0,this._maxPitch=b??60,this.setProjection(E),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new o.bK(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Zh,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new cc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const r=new Yh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,l=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||p)&&this._updateCameraOnTerrain(),(r||p)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return o.ar(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=o.bL(this.projectionOptions);const p=this.getProjection(),b=!o.bh(l,p);return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.bL({name:"mercator"});const l=r!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.bD(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return o.bA(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const l=-r*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=o.a6.mat2.create(),o.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const l=o.ap(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=o.bB(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const l=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const p=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&p.exaggeration()&&this._centerAltitudeValidForExaggeration!==p.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*p.exaggeration(),this._centerAltitudeValidForExaggeration=p.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=p.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let b=0,S=0;for(let E=0;E<l.length;E++){const O=new o.P(l[E][0]*this.width,p+l[E][1]*(this.height-p)),V=r.pointCoordinate(O);if(!V)continue;const H=1/Math.hypot(V[0]-this._camera.position[0],V[1]-this._camera.position[1]);b+=V[3]*H,S+=H}return S===0?NaN:b/S}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*l,b=this._mercatorZfromZoom(r),S=this._mercatorZfromZoom(this._maxZoom),E=Math.max(b-p,S);this._setZoom(this._zoomFromMercatorZ(E))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let p;p=r.z<this._camera.position[2]?[l.x,l.y,l.z]:[r.x,r.y,r.z];const b=o.a6.vec3.length(o.a6.vec3.sub([],this._camera.position,p));return o.ap(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let l=!1;if(r.orientation&&!o.a6.quat.exactEquals(r.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(r.orientation)),r.position){const p=[r.position.x,r.position.y,r.position.z];o.a6.vec3.exactEquals(p,this._camera.position)||(this._setCameraPosition(p),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,l=new El;return l.position=new o.a5(r[0],r[1],r[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(r){if(!o.a6.quat.length(r))return!1;o.a6.quat.normalize(r,r);const l=o.a6.vec3.transformQuat([],[0,0,-1],r),p=o.a6.vec3.transformQuat([],[0,-1,0],r);if(p[2]<0)return!1;const b=gm(l,p);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(r){const l=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;r[2]=o.ap(r[2],b/p,b/l),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,l,p){this._unmodified=!1,this._edgeInsets.interpolate(r,l,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const l=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(r){const l=[new o.bM(0,r)];if(this.renderWorldCopies){const p=this.pointCoordinate(new o.P(0,0)),b=this.pointCoordinate(new o.P(this.width,0)),S=this.pointCoordinate(new o.P(this.width,this.height)),E=this.pointCoordinate(new o.P(0,this.height)),O=Math.floor(Math.min(p.x,b.x,S.x,E.x)),V=Math.floor(Math.max(p.x,b.x,S.x,E.x)),H=1;for(let W=O-H;W<=V+H;W++)W!==0&&l.push(new o.bM(W,r))}return l}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(r,l,p){let b=[];const S=p!==void 0,E=!S;if(E&&this.zoom<l||S&&p[0]===0&&p[1]===0)return b;const O=new Set,V=(W,J,ee,re,ve)=>{const _e=o.c1(J,W,ee,re,ve);O.has(_e)||(b.push(new o.aA(W,J,ee,re,ve)),O.add(_e))};for(let W=0;W<r.length;W++){const J=r[W];if(E&&J.canonical.z!==l)continue;const ee=J.canonical,re=J.overscaledZ,ve=J.wrap,_e=1<<ee.z,xe=ee.x+1<_e,we=ee.x>0,ze=ee.y+1<_e,Ne=ee.y>0,Le=J.wrap-(we?0:1),je=J.wrap+(xe?0:1),Ue=we?ee.x-1:_e-1,rt=xe?ee.x+1:0;if(S)p[0]<0?(V(re,je,ee.z,rt,ee.y),p[1]<0&&ze&&(V(re,ve,ee.z,ee.x,ee.y+1),V(re,je,ee.z,rt,ee.y+1)),p[1]>0&&Ne&&(V(re,ve,ee.z,ee.x,ee.y-1),V(re,je,ee.z,rt,ee.y-1))):p[0]>0?(V(re,Le,ee.z,Ue,ee.y),p[1]<0&&ze&&(V(re,ve,ee.z,ee.x,ee.y+1),V(re,Le,ee.z,Ue,ee.y+1)),p[1]>0&&Ne&&(V(re,ve,ee.z,ee.x,ee.y-1),V(re,Le,ee.z,Ue,ee.y-1))):p[1]<0&&ze?V(re,ve,ee.z,ee.x,ee.y+1):Ne&&V(re,ve,ee.z,ee.x,ee.y-1);else{const Qe=J.visibleQuadrants;1&Qe&&(V(re,Le,ee.z,Ue,ee.y),Ne&&(V(re,ve,ee.z,ee.x,ee.y-1),V(re,Le,ee.z,Ue,ee.y-1))),2&Qe&&(V(re,je,ee.z,rt,ee.y),Ne&&(V(re,ve,ee.z,ee.x,ee.y-1),V(re,je,ee.z,rt,ee.y-1))),4&Qe&&(V(re,Le,ee.z,Ue,ee.y),ze&&(V(re,ve,ee.z,ee.x,ee.y+1),V(re,Le,ee.z,Ue,ee.y+1))),8&Qe&&(V(re,je,ee.z,rt,ee.y),ze&&(V(re,ve,ee.z,ee.x,ee.y+1),V(re,je,ee.z,rt,ee.y+1)))}}const H=[];for(const W of b)b.some(J=>W.isChildOf(J))||H.push(W);if(b=H.filter(W=>!r.some(J=>!!(W.overscaledZ<l&&J.isChildOf(W))||W.equals(J)||W.isChildOf(J))),E){const W=1<<l,J=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ee=[W*J.x,W*J.y],re=4,ve=re*re;b=b.filter(_e=>{const xe=_e.canonical.x+.5-ee[0],we=_e.canonical.y+.5-ee[1];return xe*xe+we*we<ve})}return b}coveringTiles(r){let l=this.coveringZoomLevel(r);const p=l,b=this.elevation&&this.elevation.exaggeration(),S=b&&!r.isTerrainDEM,E=this.projection.name==="mercator";if(r.minzoom!==void 0&&l<r.minzoom)return[];r.maxzoom!==void 0&&l>r.maxzoom&&(l=r.maxzoom);const O=this.locationCoordinate(this.center),V=this.center.lat,H=1<<l,W=[H*O.x,H*O.y,0],J=this.projection.name==="globe",ee=!J,re=o.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,ee),ve=J?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),_e=H*o.bD(1,this.center.lat),xe=this._camera.position[2]/o.bD(1,this.center.lat),we=[H*ve.x,H*ve.y,xe*(ee?1:_e)],ze=J||b,Ne=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),Le=this.isLODDisabled(!0)?l:0;let je;if(this._elevation&&r.isTerrainDEM)je=1e4*this._elevation.exaggeration();else if(this._elevation){const Et=this._elevation.getMinMaxForVisibleTiles();je=Et?Et.max:this._centerAltitude}else je=this._centerAltitude;const Ue=r.isTerrainDEM?-je:this._elevation?this._elevation.getMinElevationBelowMSL():0,rt=this.projection.isReprojectedInTileSpace?o.bO(this):1,Qe=Et=>{const Qt=new o.a5(Et.x+25e-6,Et.y,Et.z),bn=new o.a5(Et.x,Et.y+25e-6,Et.z),wn=Et.toLngLat(),an=Qt.toLngLat(),pn=bn.toLngLat(),er=this.locationCoordinate(wn),Mn=this.locationCoordinate(an),$n=this.locationCoordinate(pn),gr=Math.hypot(Mn.x-er.x,Mn.y-er.y),Zn=Math.hypot($n.x-er.x,$n.y-er.y);return Math.sqrt(gr*Zn)*rt/25e-6},ot=Et=>{const nn=je,Qt=Ue;return{aabb:o.bR(this,H,0,0,0,Et,Qt,nn,this.projection),zoom:0,x:0,y:0,minZ:Qt,maxZ:nn,wrap:Et,fullyVisible:!1}},gt=[];let ht=[];const ct=l,Ct=r.reparseOverscaled?p:l,Kt=(xe-this._centerAltitude)*_e,cn=Et=>{if(!this._elevation||!Et.tileID||!E)return;const nn=this._elevation.getMinMaxForTile(Et.tileID),Qt=Et.aabb;nn?(Qt.min[2]=nn.min,Qt.max[2]=nn.max,Qt.center[2]=(Qt.min[2]+Qt.max[2])/2):(Et.shouldSplit=yn(Et),Et.shouldSplit||(Qt.min[2]=Qt.max[2]=Qt.center[2]=this._centerAltitude))},qt=(Et,nn)=>{if(.707*nn<Et)return 1;const Qt=nn/Et;return Qt/(1.4144271570014144+(Math.pow(1.1,Qt-1.4144271570014144+1)-1)/(1.1-1)-1)},yn=Et=>{if(Et.zoom<Le)return!0;if(Et.zoom===ct)return!1;if(Et.shouldSplit!=null)return Et.shouldSplit;const nn=Et.aabb.distanceX(we),Qt=Et.aabb.distanceY(we);let bn=Kt,wn=1;if(J){bn=Et.aabb.distanceZ(we);const Zn=Math.pow(2,Et.zoom),lr=o.aM((Et.y+1)/Zn),zr=o.aM(Et.y/Zn),Dr=Math.min(Math.max(V,lr),zr),po=o.c5(Dr)/o.c5(V);if(wn=Dr===V?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,po/this._mercatorScaleRatio),this.zoom<=o.c2&&Et.zoom===ct-1&&po>=.9)return!0}else if(S&&(bn=Et.aabb.distanceZ(we)*_e),this.projection.isReprojectedInTileSpace&&p<=5){const Zn=Math.pow(2,Et.zoom),lr=Qe(new o.a5((Et.x+.5)/Zn,(Et.y+.5)/Zn));wn=lr>.85?1:lr}if(!E){const Zn=Math.sqrt(nn*nn+Qt*Qt+bn*bn);let lr=(1<<ct-Et.zoom)*Ne*wn;return lr*=qt(Math.max(bn,Kt),Zn),Zn<lr}let an=Number.MAX_VALUE,pn=0;const er=Et.aabb.getCorners(),Mn=[];for(const Zn of er){o.a6.vec3.sub(Mn,Zn,we),J||(S?Mn[2]*=_e:Mn[2]=Kt);const lr=o.a6.vec3.dot(Mn,this._camera.forward());lr<an&&(an=lr,pn=Math.abs(Mn[2]))}let $n=(1<<ct-Et.zoom)*Ne*wn;if($n*=qt(Math.max(pn,Kt),an),an<$n)return!0;const gr=Et.aabb.closestPoint(W);return gr[0]===W[0]&&gr[1]===W[1]};if(this.renderWorldCopies)for(let Et=1;Et<=3;Et++)gt.push(ot(-Et)),gt.push(ot(Et));for(gt.push(ot(0));gt.length>0;){const Et=gt.pop(),nn=Et.x,Qt=Et.y;let bn=Et.fullyVisible;const wn=()=>this.projection.name==="globe"&&(Et.y===0||Et.y===(1<<Et.zoom)-1);if(!bn){let an=ze?Et.aabb.intersects(re):Et.aabb.intersectsFlat(re);if(an===0&&wn()){const pn=new o.bP(Et.zoom,nn,Qt);an=o.bQ(this,H,pn,!0).intersects(re)}if(an===0)continue;bn=an===2}if(Et.zoom!==ct&&yn(Et))for(let an=0;an<4;an++){const pn=(nn<<1)+an%2,er=(Qt<<1)+(an>>1),Mn={aabb:E?Et.aabb.quadrant(an):o.bR(this,H,Et.zoom+1,pn,er,Et.wrap,Et.minZ,Et.maxZ,this.projection),zoom:Et.zoom+1,x:pn,y:er,wrap:Et.wrap,fullyVisible:bn,tileID:void 0,shouldSplit:void 0,minZ:Et.minZ,maxZ:Et.maxZ};S&&!J&&(Mn.tileID=new o.aA(Et.zoom+1===ct?Ct:Et.zoom+1,Et.wrap,Et.zoom+1,pn,er),cn(Mn)),gt.push(Mn)}else{const an=Et.zoom===ct?Ct:Et.zoom;if(r.minzoom&&r.minzoom>an)continue;let pn=0;if(!bn){let gr=ze?Et.aabb.intersectsPrecise(re):Et.aabb.intersectsPreciseFlat(re);if(gr===0&&wn()){const Zn=new o.bP(Et.zoom,nn,Qt);gr=o.bQ(this,H,Zn,!0).intersectsPrecise(re)}if(gr===0)continue;if(r.calculateQuadrantVisibility)if(re.containsPoint(Et.aabb.center))pn=15;else for(let Zn=0;Zn<4;Zn++)Et.aabb.quadrant(Zn).intersects(re)!==0&&(pn|=1<<Zn)}const er=W[0]-(.5+nn+(Et.wrap<<Et.zoom))*(1<<l-Et.zoom),Mn=W[1]-.5-Qt,$n=Et.tileID?Et.tileID:new o.aA(an,Et.wrap,Et.zoom,nn,Qt);r.calculateQuadrantVisibility&&($n.visibleQuadrants=pn),ht.push({tileID:$n,distanceSq:er*er+Mn*Mn})}}if(this.fogCullDistSq){const Et=this.fogCullDistSq,nn=this.horizonLineFromTop();ht=ht.filter(Qt=>{const bn=[0,0,0,1],wn=[o.ab,o.ab,0,1],an=this.calculateFogTileMatrix(Qt.tileID.toUnwrapped());o.a6.vec4.transformMat4(bn,bn,an),o.a6.vec4.transformMat4(wn,wn,an);const pn=o.a6.vec4.min([],bn,wn),er=o.a6.vec4.max([],bn,wn),Mn=o.bS(pn,er);if(Mn===0)return!0;let $n=!1;const gr=this._elevation;if(gr&&Mn>Et&&nn!==0){const Zn=this.calculateProjMatrix(Qt.tileID.toUnwrapped());let lr;r.isTerrainDEM||(lr=gr.getMinMaxForTile(Qt.tileID)),lr||(lr={min:Ue,max:je});const zr=o.c3(this.rotation),Dr=[zr[0]*o.ab,zr[1]*o.ab,lr.max];o.a6.vec3.transformMat4(Dr,Dr,Zn),$n=(1-Dr[1])*this.height*.5<nn}return Mn<Et||$n})}return ht.sort((Et,nn)=>Et.distanceSq-nn.distanceSq).map(Et=>Et.tileID)}resize(r,l){this.width=r,this.height=l,this.pixelsToGLUnits=[2/r,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const l=o.ap(r.lat,-o.bT,o.bT),p=this.projection.project(r.lng,l);return new o.P(p.x*this.worldSize,p.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.bD(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,l){let p,b;const S=this.centerPoint;if(this.projection.name==="globe"){const O=this.worldSize;p=(l.x-S.x)/O,b=(l.y-S.y)/O}else{const O=this.pointCoordinate(l),V=this.pointCoordinate(S);p=O.x-V.x,b=O.y-V.y}const E=this.locationCoordinate(r);this.setLocation(new o.a5(E.x-p,E.y-b))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,l){const p=l?o.bD(l,r.lat):void 0,b=this.projection.project(r.lng,r.lat);return new o.a5(b.x,b.y,p)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,l){const p=l??this._centerAltitude,b=[r.x,r.y,0,1],S=[r.x,r.y,1,1];o.a6.vec4.transformMat4(b,b,this.pixelMatrixInverse),o.a6.vec4.transformMat4(S,S,this.pixelMatrixInverse);const E=S[3];o.a6.vec4.scale(b,b,1/b[3]),o.a6.vec4.scale(S,S,1/E);const O=b[2],V=S[2];return{p0:b,p1:S,t:O===V?0:(p-O)/(V-O)}}screenPointToMercatorRay(r){const l=[r.x,r.y,0,1],p=[r.x,r.y,1,1];return o.a6.vec4.transformMat4(l,l,this.pixelMatrixInverse),o.a6.vec4.transformMat4(p,p,this.pixelMatrixInverse),o.a6.vec4.scale(l,l,1/l[3]),o.a6.vec4.scale(p,p,1/p[3]),l[2]=o.bD(l[2],this._center.lat)*this.worldSize,p[2]=o.bD(p[2],this._center.lat)*this.worldSize,o.a6.vec4.scale(l,l,1/this.worldSize),o.a6.vec4.scale(p,p,1/this.worldSize),new o.aj([l[0],l[1],l[2]],o.a6.vec3.normalize([],o.a6.vec3.sub([],p,l)))}rayIntersectionCoordinate(r){const{p0:l,p1:p,t:b}=r,S=o.bD(l[2],this._center.lat),E=o.bD(p[2],this._center.lat);return new o.a5(o.aa(l[0],p[0],b)/this.worldSize,o.aa(l[1],p[1],b)/this.worldSize,o.aa(S,E,b))}pointCoordinate(r,l=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,l)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let l=this.projection.pointCoordinate3D(this,r.x,r.y);if(l)return new o.a5(l[0],l[1],l[2]);let p=0,b=this.horizonLineFromTop();if(r.y>b)return this.pointCoordinate(r);const S=.02*b,E=r.clone();for(let O=0;O<10&&b-p>S;O++){E.y=o.aa(p,b,.66);const V=this.projection.pointCoordinate3D(this,E.x,E.y);V?(b=E.y,l=V):p=E.y}return l?new o.a5(l[0],l[1],l[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=o.bU)return!this.isPointAboveHorizon(r);const l=this.pointCoordinate(r);return l.y>=0&&l.y<=1}_coordinatePoint(r,l){const p=l&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,b=[r.x*this.worldSize,r.y*this.worldSize,p+r.toAltitude(),1];return o.a6.vec4.transformMat4(b,b,this.pixelMatrix),b[3]>0?new o.P(b[0]/b[3],b[1]/b[3]):new o.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:l}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,b=this.width-this._edgeInsets.right,S=this.pointLocation3D(new o.P(l,r)),E=this.pointLocation3D(new o.P(b,r)),O=this.pointLocation3D(new o.P(b,p)),V=this.pointLocation3D(new o.P(l,p));let H=Math.min(S.lng,E.lng,O.lng,V.lng),W=Math.max(S.lng,E.lng,O.lng,V.lng),J=Math.min(S.lat,E.lat,O.lat,V.lat),ee=Math.max(S.lat,E.lat,O.lat,V.lat);const re=Math.pow(2,-this.zoom)/16*270,ve=this.projection.name==="globe"?1:4,_e=(xe,we,ze,Ne,Le)=>{const je=(xe+ze)/2,Ue=(we+Ne)/2,rt=new o.P(je,Ue),{lng:Qe,lat:ot}=this.pointLocation3D(rt),gt=Math.max(0,H-Qe,J-ot,Qe-W,ot-ee);H=Math.min(H,Qe),W=Math.max(W,Qe),J=Math.min(J,ot),ee=Math.max(ee,ot),(Le<ve||gt>re)&&(_e(xe,we,je,Ue,Le+1),_e(je,Ue,ze,Ne,Le+1))};if(_e(l,r,b,r,1),_e(b,r,b,p,1),_e(b,p,l,p,1),_e(l,p,l,r,1),this.projection.name==="globe"){const[xe,we]=o.bV(this);xe?(ee=90,W=180,H=-180):we&&(J=-90,W=180,H=-180)}return new o.as(new o.bK(H,J),new o.bK(W,ee))}_getBoundsRectangular(r,l){const{top:p,left:b}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,O=new o.P(b,p),V=new o.P(E,p),H=new o.P(E,S),W=new o.P(b,S);let J=this.pointCoordinate(O,r),ee=this.pointCoordinate(V,r);const re=this.pointCoordinate(H,l),ve=this.pointCoordinate(W,l),_e=(xe,we)=>(we.y-xe.y)/(we.x-xe.x);return J.y>1&&ee.y>=0?J=new o.a5((1-ve.y)/_e(ve,J)+ve.x,1):J.y<0&&ee.y<=1&&(J=new o.a5(-ve.y/_e(ve,J)+ve.x,0)),ee.y>1&&J.y>=0?ee=new o.a5((1-re.y)/_e(re,ee)+re.x,1):ee.y<0&&J.y<=1&&(ee=new o.a5(-re.y/_e(re,ee)+re.x,0)),new o.as().extend(this.coordinateLocation(J)).extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(ve)).extend(this.coordinateLocation(re))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=r.visibleDemTiles.reduce((p,b)=>{if(b.dem){const S=b.dem.tree;p.min=Math.min(p.min,S.minimums[0]),p.max=Math.max(p.max,S.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*r.exaggeration(),l.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,p=this.height/2-l*(1-this._horizonShift);return r?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-o.bT,this.maxLat=o.bT,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.am(this.minLng)*this.tileSize,this.worldMaxX=o.am(this.maxLng)*this.tileSize,this.worldMinY=o.at(this.maxLat)*this.tileSize,this.worldMaxY=o.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,l){return this.projection.createTileMatrix(this,l,r)}calculateDistanceTileData(r){const l=r.key,p=this._distanceTileDataCache;if(p[l])return p[l];const b=r.canonical,S=1/this.height,E=this.cameraWorldSize,O=E/this.zoomScale(b.z),V=(b.x+Math.pow(2,b.z)*r.wrap)*O,H=b.y*O,W=this.point;W.x*=E/this.worldSize,W.y*=E/this.worldSize;const J=this.angle,ee=Math.sin(-J),re=-Math.cos(-J);return p[l]={bearing:[ee,re],center:[(W.x-V)*S,(W.y-H)*S],scale:O/o.ab*S},p[l]}calculateFogTileMatrix(r){const l=r.key,p=this._fogTileMatrixCache;if(p[l])return p[l];const b=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return o.a6.mat4.multiply(b,this.worldToFogMatrix,b),p[l]=new Float32Array(b),p[l]}calculateProjMatrix(r,l=!1,p=!1){const b=r.key;let S;if(S=p?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,S[b])return S[b];const E=this.calculatePosMatrix(r,this.worldSize);let O;return O=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,o.a6.mat4.multiply(E,O,E),S[b]=new Float32Array(E),S[b]}calculatePixelsToTileUnitsMatrix(r){const l=r.tileID.key,p=this._pixelsToTileUnitsCache;if(p[l])return p[l];const b=o.bW(r,this);return p[l]=b,p[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,l=o.a6.mat4.fromScaling([],[r,r,r]);return o.a6.mat4.multiply(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const l=o.bD(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(l),b=this._camera.forward(),S=o.bD(1,this._center.lat);p[2]/=S,b[2]/=S,o.a6.vec3.normalize(b,b);const E=r.raycast(p,b,r.exaggeration());if(E){const O=o.a6.vec3.scaleAndAdd([],p,b,E),V=new o.a5(O[0],O[1],o.bD(O[2],o.aM(O[1]))),H=(V.z+o.a6.vec3.length([V.x-p[0],V.y-p[1],V.z-p[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=V.toAltitude(),this._center=this.coordinateLocation(V),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const l=this._elevation,p=o.bD(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(p),S=l.getAtPointOrZero(new o.a5(...b)),E=this.pixelsPerMeter/this.worldSize*S,O=this._minimumHeightOverTerrain(),V=b[2]-E;if(V<=O)if(V<0||r){const H=this.locationCoordinate(this._center,this._centerAltitude),W=[b[0],b[1],H.z-b[2]],J=o.a6.vec3.length(W);W[2]-=(O-V)/this._pixelsPerMercatorPixel;const ee=o.a6.vec3.length(W);if(ee===0)return;o.a6.vec3.scale(W,W,J/ee*this._pixelsPerMercatorPixel),this._camera.position=[b[0],b[1],H.z*this._pixelsPerMercatorPixel-W[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const ee=this.center;return ee.lat=o.ap(ee.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(ee.lng=o.ap(ee.lng,this.minLng,this.maxLng)),this.center=ee,void(this._constraining=!1)}const l=this._unmodified,{x:p,y:b}=this.point;let S=0,E=p,O=b;const V=this.width/2,H=this.height/2,W=this.worldMinY*this.scale,J=this.worldMaxY*this.scale;if(b-H<W&&(O=W+H),b+H>J&&(O=J-H),J-W<this.height&&(S=Math.max(S,this.height/(J-W)),O=(J+W)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ee=this.worldMinX*this.scale,re=this.worldMaxX*this.scale,ve=this.worldSize/2-(ee+re)/2;E=(p+ve+this.worldSize)%this.worldSize-ve,E-V<ee&&(E=ee+V),E+V>re&&(E=re-V),re-ee<this.width&&(S=Math.max(S,this.width/(re-ee)),E=(re+ee)/2)}E===p&&O===b||(this.center=this.unproject(new o.P(E,O))),S&&(this.zoom+=this.scaleZoom(S)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,l=this.projection.name==="globe",p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.bD(1,this.center.lat)/o.bD(1,o.c4));const b=o.bX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?p:1,E=this._camera.getWorldToCamera(this.worldSize,S);let O;const V=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(V[8]=2*-r.x/this.width,V[9]=2*r.y/this.height,this.isOrthographic){let ot=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),gt=ot*this.aspect,ht=-gt,ct=-ot;gt-=r.x,ht-=r.x,ot+=r.y,ct+=r.y,O=this._camera.getCameraToClipOrthographic(ht,gt,ct,ot,this._nearZ,this._farZ),((Ct,Kt,cn,qt)=>{for(let yn=0;yn<16;yn++)Ct[yn]=Qc(Kt[yn],cn[yn],qt)})(O,O,V,eu(this.pitch>=15?1:this.pitch/15))}else O=V;const H=o.a6.mat4.mul([],V,E);let W=o.a6.mat4.mul([],O,E);if(this.projection.isReprojectedInTileSpace){const ot=this.locationCoordinate(this.center),gt=o.a6.mat4.identity([]);o.a6.mat4.translate(gt,gt,[ot.x*this.worldSize,ot.y*this.worldSize,0]),o.a6.mat4.multiply(gt,gt,o.bY(this)),o.a6.mat4.translate(gt,gt,[-ot.x*this.worldSize,-ot.y*this.worldSize,0]),o.a6.mat4.multiply(W,W,gt),o.a6.mat4.multiply(H,H,gt),this.inverseAdjustmentMatrix=o.bZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=o.a6.mat4.scale([],W,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=W,this.invProjMatrix=o.a6.mat4.invert(new Float64Array(16),this.projMatrix),l){const ot=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);ot[8]=2*-r.x/this.width,ot[9]=2*r.y/this.height,this.expandedFarZProjMatrix=o.a6.mat4.mul([],ot,E)}else this.expandedFarZProjMatrix=this.projMatrix;const J=o.a6.mat4.invert([],O);this.frustumCorners=o.b_.fromInvProjectionMatrix(J,this.horizonLineFromTop(),this.height),this.cameraFrustum=o.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const ee=new Float32Array(16);o.a6.mat4.identity(ee),o.a6.mat4.scale(ee,ee,[1,-1,1]),o.a6.mat4.rotateX(ee,ee,this._pitch),o.a6.mat4.rotateZ(ee,ee,this.angle);const re=o.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=o.a6.mat4.clone(re);const ve=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;re[8]=2*-r.x/this.width,re[9]=2*(r.y+ve)/this.height,this.skyboxMatrix=o.a6.mat4.multiply(ee,re,ee);const _e=this.point,xe=_e.x,we=_e.y,ze=this.width%2/2,Ne=this.height%2/2,Le=Math.cos(this.angle),je=Math.sin(this.angle),Ue=xe-Math.round(xe)+Le*ze+je*Ne,rt=we-Math.round(we)+Le*Ne+je*ze,Qe=new Float64Array(W);if(o.a6.mat4.translate(Qe,Qe,[Ue>.5?Ue-1:Ue,rt>.5?rt-1:rt,0]),this.alignedProjMatrix=Qe,W=o.a6.mat4.create(),o.a6.mat4.scale(W,W,[this.width/2,-this.height/2,1]),o.a6.mat4.translate(W,W,[1,-1,0]),this.labelPlaneMatrix=W,W=o.a6.mat4.create(),o.a6.mat4.scale(W,W,[1,-1,1]),o.a6.mat4.translate(W,W,[-1,-1,0]),o.a6.mat4.scale(W,W,[2/this.width,2/this.height,1]),this.glCoordMatrix=W,this.pixelMatrix=o.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,H),this._calcFogMatrices(),this._distanceTileDataCache={},W=o.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!W)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=W,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.b$(this);const ot=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.a6.vec3.transformMat4(ot,ot,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=W;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,p=this._camera.position,b=1/this.height/this._pixelsPerMercatorPixel,S=[r,r,l];o.a6.vec3.scale(S,S,b),o.a6.vec3.scale(p,p,-1),o.a6.vec3.multiply(p,p,S);const E=o.a6.mat4.create();o.a6.mat4.translate(E,E,p),o.a6.mat4.scale(E,E,S),this.mercatorFogMatrix=E,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,l,b)}_computeCameraPosition(r){const l=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),b=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-r/this.worldSize*this._centerAltitude;return[b.x/this.worldSize-p[0]*S,b.y/this.worldSize-p[1]*S,r/this.worldSize*this._centerAltitude-p[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],b=r[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),b>0&&(S=Math.min((l-p)/b,1)),this._camera.position=o.a6.vec3.scaleAndAdd([],this._camera.position,r,S),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,l=this._camera.forward(),{pitch:p,bearing:b}=this._camera.getPitchBearing(),S=o.bD(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,E=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.bB(this._maxPitch)),O=Math.max((r[2]-S)/Math.cos(p),E),V=this._zoomFromMercatorZ(O);o.a6.vec3.scaleAndAdd(r,r,l,O),this._pitch=o.ap(p,o.bB(this.minPitch),o.bB(this.maxPitch)),this.angle=o.bA(b,-Math.PI,Math.PI),this._setZoom(o.ap(V,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.a5(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let l=0,p=o.bU,b=0,S=1/0;for(;p-l>1e-6&&p>l;){const E=l+.5*(p-l),O=this.tileSize*Math.pow(2,E),V=this.getCameraToCenterDistance(this.projection,E,O),H=this.scaleZoom(V/(r*this.tileSize)),W=Math.abs(E-H);W<S&&(S=W,b=E),E<H?l=E:p=E}return b}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,l){const p=Math.min(r.x,l.x),b=Math.max(r.x,l.x),S=Math.min(r.y,l.y),E=Math.max(r.y,l.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const O=[new o.P(p,S),new o.P(b,E),new o.P(p,E),new o.P(b,S)],V=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const W of O){const J=this.pointRayIntersection(W);if(J.t<0)return!0;const ee=this.rayIntersectionCoordinate(J);if(ee.x<V||ee.y<0||ee.x>H||ee.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.c0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.P(0,0),new o.P(this.width,this.height))}zoomDeltaToMovement(r,l){const p=o.a6.vec3.length(o.a6.vec3.sub([],this._camera.position,r)),b=this._zoomFromMercatorZ(p)+l;return p-this._mercatorZfromZoom(b)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([l,p,b],S){const E=[l,p,b,1];o.a6.vec4.transformMat4(E,E,S);const O=E[3]=Math.max(E[3],1e-6);return E[0]/=O,E[1]/=O,E[2]/=O,E}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,r))}}getCameraToCenterDistance(r,l=this.zoom,p=this.worldSize){const b=o.bX(r,l,this.width,this.height,1024),S=r.pixelSpaceConversion(this.center.lat,p,b);let E=.5/Math.tan(.5*this._fov)*this.height*S;return this.isOrthographic&&(E=Qc(1,E,eu(this.pitch>=15?1:this.pitch/15))),E}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.a6.mat4.multiply(r,r,this.globeMatrix),r}getFrustum(r){return o.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const qa=(f,r)=>{if(r>0&&f.terrain&&o.w("Cutoff is currently disabled on terrain"),r<=0||f.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=f.transform,p=Math.max(Math.abs(l._zoom-(f.minCutoffZoom-1)),1),b=l.isLODDisabled(!1)?o.a7(60,45,l.pitch):o.a7(30,15,l.pitch),S=l._farZ-l._nearZ,E=r*l.height,O=((1-(V=b))*l.cameraToCenterDistance+V*(l._farZ+E))*p;var V;return{shouldRenderCutoff:b<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(O-l._nearZ)/S,(O-E-l._nearZ)/S]}}},Go={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class vm{constructor(r,l){this.aabb=r,this.lastCascade=l}}class An{add(r,l){const p=this.receivers[r.key];p!==void 0?(p.aabb.min[0]=Math.min(p.aabb.min[0],l.min[0]),p.aabb.min[1]=Math.min(p.aabb.min[1],l.min[1]),p.aabb.min[2]=Math.min(p.aabb.min[2],l.min[2]),p.aabb.max[0]=Math.max(p.aabb.max[0],l.max[0]),p.aabb.max[1]=Math.max(p.aabb.max[1],l.max[1]),p.aabb.max[2]=Math.max(p.aabb.max[2],l.max[2])):this.receivers[r.key]=new vm(l,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,l,p){const b=o.c9.fromPoints(r.points);let S=0;for(const E in this.receivers){const O=this.receivers[E];if(!O||!b.intersectsAabb(O.aabb))continue;O.aabb.min=b.closestPoint(O.aabb.min),O.aabb.max=b.closestPoint(O.aabb.max);const V=O.aabb.getCorners();for(let H=0;H<p.length;H++){let W=!0;for(const J of V){const ee=[J[0]*l,J[1]*l,J[2]];if(o.a6.vec3.transformMat4(ee,ee,p[H].matrix),ee[0]<-1||ee[0]>1||ee[1]<-1||ee[1]>1){W=!1;break}}if(O.lastCascade=H,S=Math.max(S,H),W)break}}return S+1}}class __{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new An,this._depthMode=new or(r.context.gl.LEQUAL,or.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,r.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),r.tp.registerParameter(Go,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(Go,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),r.tp.registerParameter(Go,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),r.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,l){const p=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const b=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||b<=0||(this._shadowLayerCount=p.style.order.reduce((ve,_e)=>{const xe=p.style._mergedLayers[_e];return ve+(xe.hasShadowPass()&&!xe.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const S=p.context,E=Go.shadowMapResolution,O=Go.shadowMapResolution;if(this._cascades.length===0||Go.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ve=0;ve<Go.cascadeCount;++ve){const _e=p._shadowMapDebug,xe=S.gl,we=S.createFramebuffer(E,O,_e,"texture"),ze=new o.T(S,{width:E,height:O,data:null},xe.DEPTH_COMPONENT16);if(we.depthAttachment.set(ze.texture),_e){const Ne=new o.T(S,{width:E,height:O,data:null},xe.RGBA8);we.colorAttachment.set(Ne.texture)}this._cascades.push({framebuffer:we,texture:ze,matrix:[],far:0,boundingSphereRadius:0,frustum:new o.bN,scale:0})}}this.shadowDirection=Xh(l);let V=0;if(r.elevation){const ve=r.elevation,_e=[1e4,-1e4];ve.visibleDemTiles.filter(xe=>xe.dem).forEach(xe=>{const we=xe.dem.tree;_e[0]=Math.min(_e[0],we.minimums[0]),_e[1]=Math.max(_e[1],we.maximums[0])}),_e[0]!==1e4&&(V=(_e[1]-_e[0])*ve.exaggeration())}const H=1.5*r.cameraToCenterDistance,W=3*H,J=new Float64Array(16);for(let ve=0;ve<this._cascades.length;++ve){const _e=this._cascades[ve];let xe=r.height/50,we=1;Go.cascadeCount===1?we=W:ve===0?we=H:(xe=H,we=W);const[ze,Ne]=Qh(r,this.shadowDirection,xe,we,Go.shadowMapResolution,V);_e.scale=r.scale,_e.matrix=ze,_e.boundingSphereRadius=Ne,o.a6.mat4.invert(J,_e.matrix),_e.frustum=o.bN.fromInvProjectionMatrix(J,1,0,!0),_e.far=we}const ee=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[ee].far,this._cascades[ee].far],this._uniformValues.u_shadow_intensity=b,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Go.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Go.shadowMapResolution,this._uniformValues.u_shadowmap_0=Pi.ShadowMap0,this._uniformValues.u_shadowmap_1=Pi.ShadowMap0+1,this._groundShadowTiles=p.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const re=p.transform.elevation;for(const ve of this._groundShadowTiles){let _e={min:0,max:0};if(re){const xe=re.getMinMaxForTile(ve);xe&&(_e=xe)}this.addShadowReceiver(ve.toUnwrapped(),_e.min,_e.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(r){this._enabled=r}drawShadowPass(r,l){if(!this.enabled)return;const p=this.painter,b=p.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(p.transform.getFrustum(0),p.transform.worldSize,this._cascades),b.viewport.set([0,0,Go.shadowMapResolution,Go.shadowMapResolution]);for(let S=0;S<this._numCascadesToRender;++S){p.currentShadowCascade=S,b.bindFramebuffer.set(this._cascades[S].framebuffer.framebuffer),b.clear({color:o.bz.white,depth:1});for(const E of r.order){const O=r._mergedLayers[E];if(!O.hasShadowPass()||O.isHidden(p.transform.zoom))continue;const V=r.getLayerSourceCache(O),H=V?l[V.id]:void 0;(O.type==="model"||H&&H.length)&&p.renderLayer(p,V,O,H)}}p.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const r=this.painter,l=r.style,p=r.context,b=l.directionalLight,S=l.ambientLight;if(!b||!S)return;const E=[],O=qa(r,r.longestCutoffRange);O.shouldRenderCutoff&&E.push("RENDER_CUTOFF");const V=Jh(l,b,S),H=new or(p.gl.LEQUAL,or.ReadOnly,r.depthRangeFor3D);for(const W of this._groundShadowTiles){const J=W.toUnwrapped(),ee=r.isTileAffectedByFog(W),re=r.getOrCreateProgram("groundShadow",{defines:E,overrideFog:ee});this.setupShadows(J,re),r.uploadCommonUniforms(p,re,J,null,O);const ve={u_matrix:r.transform.calculateProjMatrix(J),u_ground_shadow_factor:V};re.draw(r,p.gl.TRIANGLES,H,Mr.disabled,Ur.multiply,yr.disabled,ve,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,{},r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Ur.unblended:Ur.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const l=this.painter.transform,p=l.calculatePosMatrix(r,l.worldSize);return o.a6.mat4.multiply(p,this._cascades[this.painter.currentShadowCascade].matrix,p),Float32Array.from(p)}calculateShadowPassMatrixFromMatrix(r){return o.a6.mat4.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,l,p,b=0){if(!this.enabled)return;const S=this.painter.transform,E=this.painter.context,O=E.gl,V=this._uniformValues,H=new Float64Array(16),W=S.calculatePosMatrix(r,S.worldSize);for(let J=0;J<this._cascades.length;J++)o.a6.mat4.multiply(H,this._cascades[J].matrix,W),V[J===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(H),E.activeTexture.set(O.TEXTURE0+Pi.ShadowMap0+J),this._cascades[J].texture.bind(O.NEAREST,O.CLAMP_TO_EDGE);if(this.useNormalOffset=!!p,this.useNormalOffset){const J=o.c8(r.canonical),ee=2/S.tileSize*o.ab/Go.shadowMapResolution,re=ee*this._cascades[0].boundingSphereRadius,ve=ee*this._cascades[this._cascades.length-1].boundingSphereRadius,_e=(p==="vector-tile"?1:3)/Math.pow(2,b-r.canonical.z-(1-S.zoom+Math.floor(S.zoom)));V.u_shadow_normal_offset=[J,re*_e,ve*_e],V.u_shadow_bias=[6e-5,.0012,.012]}else V.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(E,V)}setupShadowsFromMatrix(r,l,p=!1){if(!this.enabled)return;const b=this.painter.context,S=b.gl,E=this._uniformValues,O=new Float64Array(16);for(let V=0;V<Go.cascadeCount;V++)o.a6.mat4.multiply(O,this._cascades[V].matrix,r),E[V===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(O),b.activeTexture.set(S.TEXTURE0+Pi.ShadowMap0+V),this._cascades[V].texture.bind(S.NEAREST,S.CLAMP_TO_EDGE);if(this.useNormalOffset=p,p){const V=Go.normalOffset;E.u_shadow_normal_offset=[1,V,V],E.u_shadow_bias=[6e-5,.0012,.012]}else E.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(b,E)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,l,p,b){if(b[2]>=0)return{};const S=function(V,H,W){const J=W/(1<<V.canonical.z);return new o.c9([V.canonical.x*J+V.wrap*W,V.canonical.y*J+V.wrap*W,0],[(V.canonical.x+1)*J+V.wrap*W,(V.canonical.y+1)*J+V.wrap*W,H])}(r,l,p).getCorners(),E=l/-b[2];b[0]<0?(o.a6.vec3.add(S[0],S[0],[b[0]*E,0,0]),o.a6.vec3.add(S[3],S[3],[b[0]*E,0,0])):b[0]>0&&(o.a6.vec3.add(S[1],S[1],[b[0]*E,0,0]),o.a6.vec3.add(S[2],S[2],[b[0]*E,0,0])),b[1]<0?(o.a6.vec3.add(S[0],S[0],[0,b[1]*E,0]),o.a6.vec3.add(S[1],S[1],[0,b[1]*E,0])):b[1]>0&&(o.a6.vec3.add(S[2],S[2],[0,b[1]*E,0]),o.a6.vec3.add(S[3],S[3],[0,b[1]*E,0]));const O={};return O.vertices=S,O.planes=[tu(S[1],S[0],S[4]),tu(S[2],S[1],S[5]),tu(S[3],S[2],S[6]),tu(S[0],S[3],S[7])],O}addShadowReceiver(r,l,p){this._receivers.add(r,o.c9.fromTileIdAndHeight(r,l,p))}getMaxCascadeForTile(r){const l=this._receivers.get(r);return l&&l.lastCascade?l.lastCascade:0}}function tu(f,r,l){const p=o.a6.vec3.sub([],l,r),b=o.a6.vec3.sub([],f,r),S=o.a6.vec3.cross([],p,b),E=o.a6.vec3.length(S);return E===0?[0,0,1,0]:(o.a6.vec3.scale(S,S,1/E),[S[0],S[1],S[2],-o.a6.vec3.dot(S,r)])}function Xh(f){const r=f.properties.get("direction"),l=o.c7(r.x,r.y,r.z);l[2]=o.ap(l[2],0,75);const p=o.ca([l[0],l[1],l[2]]);return o.a6.vec3.fromValues(p.x,p.y,p.z)}function Jh(f,r,l){const p=r.properties.get("color"),b=r.properties.get("intensity"),S=r.properties.get("direction"),E=[S.x,S.y,S.z],O=l.properties.get("color"),V=l.properties.get("intensity"),H=Math.max(o.a6.vec3.dot([0,0,1],E),0),W=[0,0,0];o.a6.vec3.scale(W,O.toRenderColor(f.getLut(r.scope)).toArray01Linear().slice(0,3),V);const J=[0,0,0];return o.a6.vec3.scale(J,p.toRenderColor(f.getLut(l.scope)).toArray01Linear().slice(0,3),H*b),o.cb([W[0]>0?W[0]/(W[0]+J[0]):0,W[1]>0?W[1]/(W[1]+J[1]):0,W[2]>0?W[2]/(W[2]+J[2]):0])}function Qh(f,r,l,p,b,S){const E=f.zoom,O=f.scale,V=f.worldSize,H=1/V,W=f.aspect,J=Math.sqrt(1+W*W)*Math.tan(.5*f.fovX),ee=J*J,re=p-l,ve=p+l;let _e,xe;ee>re/ve?(_e=p,xe=p*J):(_e=.5*ve*(1+ee),xe=.5*Math.sqrt(re*re+2*(p*p+l*l)*ee+ve*ve*ee*ee));const we=f.projection.pixelsPerMeter(f.center.lat,V),ze=f._camera.getCameraToWorldMercator(),Ne=[0,0,-_e*H];o.a6.vec3.transformMat4(Ne,Ne,ze);let Le=xe*H;const je=f._edgeInsets;if(!(je.left===0&&je.top===0&&je.right===0&&je.bottom===0||je.left===je.right&&je.top===je.bottom)){const bn=f._camera.getWorldToCamera(f.worldSize,f.projection.zAxisUnit==="meters"?we:1),wn=f._camera.getCameraToClipPerspective(f._fov,f.width/f.height,l,p);wn[8]=2*-f.centerOffset.x/f.width,wn[9]=2*f.centerOffset.y/f.height;const an=new Float64Array(16);o.a6.mat4.mul(an,wn,bn);const pn=new Float64Array(16);o.a6.mat4.invert(pn,an);const er=o.bN.fromInvProjectionMatrix(pn,V,E,!0);for(const Mn of er.points){const $n=((Ue=Mn)[0]/=O,Ue[1]/=O,Ue[2]=o.bD(Ue[2],f._center.lat),Ue);Le=Math.max(Le,o.a6.vec3.len(o.a6.vec3.subtract([],Ne,$n)))}}var Ue;Le*=b/(b-1);const rt=Math.acos(r[2]),Qe=Math.atan2(-r[0],-r[1]),ot=new cc;ot.position=Ne,ot.setPitchBearing(rt,Qe);const gt=ot.getWorldToCamera(V,we),ht=Le*V,ct=Math.min(f._mercatorZfromZoom(17)*V*-2,-2*ht),Ct=ot.getCameraToClipOrthographic(-ht,ht,-ht,ht,ct,(ht+S*we)/r[2]),Kt=new Float64Array(16);o.a6.mat4.multiply(Kt,Ct,gt);const cn=o.a6.vec3.fromValues(Math.floor(1e6*Ne[0])/1e6*V,Math.floor(1e6*Ne[1])/1e6*V,0),qt=.5*b,yn=[0,0,0];o.a6.vec3.transformMat4(yn,cn,Kt),o.a6.vec3.scale(yn,yn,qt);const Et=[Math.floor(yn[0]),Math.floor(yn[1]),Math.floor(yn[2])],nn=[0,0,0];o.a6.vec3.sub(nn,yn,Et),o.a6.vec3.scale(nn,nn,-1/qt);const Qt=new Float64Array(16);return o.a6.mat4.identity(Qt),o.a6.mat4.translate(Qt,Qt,nn),o.a6.mat4.multiply(Kt,Qt,Kt),[Kt,ht]}class Ka extends o.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.numModelsLoading={}}loadModel(r,l){return o.aG(this.requestManager.transformRequest(l,o.R.Model).url).then(p=>{if(!p)return;const b=o.aH(p),S=new o.aI(r,void 0,void 0,b);return S.computeBoundsAndApplyParent(),S}).catch(p=>{if(p&&p.status===404)return null;this.fire(new o.t(new Error(`Could not load model ${r} from ${l}: ${p.message}`)))})}load(r,l){this.models[l]||(this.models[l]={});const p=Object.keys(r);this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+p.length;const b=[];for(const S of p)b.push(this.loadModel(S,r[S]));Promise.allSettled(b).then(S=>{for(let E=0;E<S.length;E++){const{status:O,value:V}=S[E];O==="fulfilled"&&V&&(this.models[l][p[E]]={model:V,numReferences:1})}this.numModelsLoading[l]-=p.length,this.fire(new o.x("data",{dataType:"style"}))}).catch(S=>{this.fire(new o.t(new Error(`Could not load models: ${S.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,l){return!!this.getModel(r,l)}getModel(r,l){return this.models[l]||(this.models[l]={}),this.models[l][r]?this.models[l][r].model:void 0}addModel(r,l,p){this.models[p]||(this.models[p]={}),this.hasModel(r,p)&&this.models[p][r].numReferences++,this.load({[r]:this.requestManager.normalizeModelURL(l)},p)}addModels(r,l){this.models[l]||(this.models[l]={});const p={};for(const b in r)this.models[l][b]={},p[b]=this.requestManager.normalizeModelURL(r[b]);this.load(p,l)}addModelsFromBucket(r,l){this.models[l]||(this.models[l]={});const p={};for(const b of r)this.hasModel(b,l)?this.models[l][b].numReferences++:p[b]=this.requestManager.normalizeModelURL(b);this.load(p,l)}removeModel(r,l){if(this.models[l]&&this.models[l][r]&&(this.models[l][r].numReferences--,this.models[l][r].numReferences===0)){const p=this.models[l][r].model;delete this.models[l][r],p.destroy()}}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,l){this.models[l]||(this.models[l]={});for(const p in this.models[l])this.models[l][p].model&&this.models[l][p].model.upload(r.context)}}const _m=new o.a0({data:new o.a1(o._.colorTheme.data)}),Ss=(f,r)=>xt(f,r&&r.filter(l=>l.identifier!=="source.canvas")),ef=o.ar(to,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),nu=o.ar(to,["setCenter","setZoom","setBearing","setPitch"]),y_={version:8,layers:[],sources:{}},b_={duration:300,delay:0};class Ts extends o.E{constructor(r,l={}){super(),this.map=r,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=o.l({},b_),this._buildingIndex=new cm(this),this.crossTileSymbolIndex=new qh,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=l.styleChanges||new pt,this.dispatcher=l.dispatcher?l.dispatcher:new o.cd(o.ce(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new rn,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new o.cf(r._requestManager,l.localFontFamily?o.cg.all:l.localIdeographFontFamily?o.cg.ideographs:o.cg.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new Ka(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._config=l.config,this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",o.ch());const p=this;this._rtlTextPluginCallback=Ts.registerForPluginStateChange(b=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},(S,E)=>{if(o.ci(S),E&&E.every(O=>O))for(const O in p._sourceCaches){const V=p._sourceCaches[O],H=V.getSource().type;H!=="vector"&&H!=="geojson"||V.reload()}})}),this.on("data",b=>{if(b.dataType!=="source"||b.sourceDataType!=="metadata")return;const S=this.getOwnSource(b.sourceId);if(S&&S.vectorLayerIds)for(const E in this._layers){const O=this._layers[E];O.source===S.id&&this._validateLayer(O)}})}load(r){return r?(typeof r=="string"?this.loadURL(r):this.loadJSON(r),this):this}_getGlobalId(r){if(!r)return null;if(typeof r=="string"){if(o.f(r))return r;const l=o.cj(r);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${o.ck(JSON.stringify(r))}`}_diffStyle(r,l,p){this.globalId=this._getGlobalId(r);const b=(S,E)=>{try{E(null,this.setState(S,p))}catch(O){E(O,!1)}};if(typeof r=="string"){const S=this.map._requestManager.normalizeStyleURL(r),E=this.map._requestManager.transformRequest(S,o.R.Style);o.n(E,(O,V)=>{O?this.fire(new o.t(O)):V&&b(V,l)})}else typeof r=="object"&&b(r,l)}loadURL(r,l={}){this.fire(new o.x("dataloading",{dataType:"style"}));const p=typeof l.validate=="boolean"?l.validate:!o.f(r);this.globalId=this._getGlobalId(r),r=this.map._requestManager.normalizeStyleURL(r,l.accessToken),this.resolvedImports.add(r);const b=this.importsCache.get(r);if(b)return this._load(b,p);const S=this.map._requestManager.transformRequest(r,o.R.Style);this._request=o.n(S,(E,O)=>{if(this._request=null,E)this.fire(new o.t(E));else if(O)return this.importsCache.set(r,O),this._load(O,p)})}loadJSON(r,l={}){this.fire(new o.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(r),this._request=o.q.frame(()=>{this._request=null,this._load(r,l.validate!==!1)})}loadEmpty(){this.fire(new o.x("dataloading",{dataType:"style"})),this._load(y_,!1)}_loadImports(r,l,p){if(this.importDepth>=4)return o.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const b=[];for(const S of r){const E=this._createFragmentStyle(S),O=new Promise(W=>{E.once("style.import.load",W),E.once("error",W)}).then(()=>this.mergeAll());if(b.push(O),this.resolvedImports.has(S.url)){E.loadEmpty();continue}const V=S.data||this.importsCache.get(S.url);V?(E.loadJSON(V,{validate:l}),this._isInternalStyle(V)&&(E.globalId=null)):S.url?E.loadURL(S.url,{validate:l}):E.loadEmpty();const H={style:E,id:S.id,config:S.config};if(p){const W=this.fragments.findIndex(({id:J})=>J===p);this.fragments=this.fragments.slice(0,W).concat(H).concat(this.fragments.slice(W))}else this.fragments.push(H)}return Promise.allSettled(b)}getImportGlobalIds(r=this,l=new Set){for(const p of r.fragments)p.style.globalId&&l.add(p.style.globalId),this.getImportGlobalIds(p.style,l);return[...l.values()]}_createFragmentStyle(r){const l=this.scope?o.av(r.id,this.scope):r.id;let p;const b=this._initialConfig&&this._initialConfig[l];(r.config||b)&&(p=o.l({},r.config,b));const S=new Ts(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:p,configOptions:this.options,configDependentLayers:this._configDependentLayers});return S.setEventedParent(this.map,{style:S}),S}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(r){return this.isRootStyle()&&(r.fragment||!!r.schema&&r.fragment!==!1)}_load(r,l){const p=r.schema;if(this._isInternalStyle(r)){const E=o.l({},y_,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(E,l)}if(this.updateConfig(this._config,p),l&&Ss(this,mo(r)))return;this._loaded=!0,this.stylesheet=o.cl(r);const b=()=>{for(const H in r.sources)this.addSource(H,r.sources[H],{validate:!1,isInitialLoad:!0});r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(r.glyphs,this.scope);const E=um(this.stylesheet.layers);if(this._order=E.map(H=>H.id),this.stylesheet.light&&o.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const H=this.stylesheet.lights[0];this.light=new Tt(H.properties,H.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Tt(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const H of E){const W=o.cq(H,this.scope,this._styleColorTheme.lut,this.options);W.configDependencies.size!==0&&this._configDependentLayers.add(W.fqid),W.setEventedParent(this,{layer:{id:W.id}}),this._layers[W.id]=W,this._serializedLayers[W.id]=W.serialize();const J=this.getOwnLayerSourceCache(W),ee=!!this.directionalLight&&this.directionalLight.shadowsEnabled();J&&W.canCastShadows()&&ee&&(J.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const O=this.stylesheet.terrain;O&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(O,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new o.x("data",{dataType:"style"}));const V=this.isRootStyle();r.imports?this._loadImports(r.imports,l).then(()=>{this._reloadImports(),this.fire(new o.x(V?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new o.x(V?"style.load":"style.import.load")))},S=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=S,S){const E=this._evaluateColorThemeData(S);this._loadColorTheme(E).then(()=>{b()}).catch(O=>{o.w(`Couldn't load color theme from the stylesheet: ${O}`),b()})}else this._styleColorTheme.lut=null,b()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,l,p,b,S,E,O,V;const H={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(W=>{if(W.stylesheet){if(W.light!=null&&(r=W.light),W.stylesheet.lights)for(const J of W.stylesheet.lights)J.type==="ambient"&&W.ambientLight!=null&&(l=W.ambientLight),J.type==="directional"&&W.directionalLight!=null&&(p=W.directionalLight);b=this._prioritizeTerrain(b,W.terrain,W.stylesheet.terrain),W.stylesheet.fog&&W.fog!=null&&(S=W.fog),W.stylesheet.camera!=null&&(V=W.stylesheet.camera),W.stylesheet.projection!=null&&(E=W.stylesheet.projection),W.stylesheet.transition!=null&&(O=W.stylesheet.transition),H[W.scope]=W._styleColorTheme}}),this.light=r,this.ambientLight=l,this.directionalLight=p,this.fog=S,this._styleColorThemeForScope=H,b===null?delete this.terrain:this.terrain=b,this.camera=V||{"camera-projection":"perspective"},this.projection=E||{name:"mercator"},this.transition=o.l({},b_,O),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const l=p=>{for(const b of p.fragments)l(b.style);r(p)};l(this)}_prioritizeTerrain(r,l,p){const b=r&&r.drapeRenderMode===0;return p===null?l&&l.drapeRenderMode===0?l:b?r:null:l!=null&&(!r||b||l&&l.drapeRenderMode===1)?l:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(l=>{r=this._prioritizeTerrain(r,l.terrain,l.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(l=>{l.stylesheet.projection!=null&&(r=l.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},l={},p={};this.forEachFragmentStyle(b=>{for(const S in b._sourceCaches){const E=o.av(S,b.scope);r[E]=b._sourceCaches[S]}for(const S in b._otherSourceCaches){const E=o.av(S,b.scope);l[E]=b._otherSourceCaches[S]}for(const S in b._symbolSourceCaches){const E=o.av(S,b.scope);p[E]=b._symbolSourceCaches[S]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=p}mergeLayers(){const r={},l=[],p={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(S=>{for(const E of S._order){const O=S._layers[E];if(O.type==="slot"){const V=o.cm(E);if(r[V])continue;r[V]=[]}O.slot&&r[O.slot]?r[O.slot].push(O):l.push(O)}}),this._mergedOrder=[];const b=(S=[])=>{for(const E of S)if(E.type==="slot"){const O=o.cm(E.id);r[O]&&b(r[O]),this._mergedSlots.push(O)}else{const O=o.av(E.id,E.scope);this._mergedOrder.push(O),p[O]=E,E.is3D()&&(this._has3DLayers=!0),E.type==="circle"&&(this._hasCircleLayers=!0),E.type==="symbol"&&(this._hasSymbolLayers=!0),E.type==="clip"&&(this._clipLayerPresent=!0)}};b(l),this._mergedOrder.sort((S,E)=>{const O=p[S],V=p[E];return O.hasInitialOcclusionOpacityProperties?V.is3D()?1:0:O.is3D()&&V.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=p,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=o.l({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(r){return r.data?function(l,p,b){const S=o.l({},p);for(const O of Object.keys(o._.colorTheme))S[O]===void 0&&(S[O]=o._.colorTheme[O].default);const E=new o.$(_m,l,new Map(b));return E.setTransitionOrValue(S,b),E.untransitioned().possiblyEvaluate(new o.a3(0))}(this.scope,r,this.options).get("data"):null}_loadColorTheme(r){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((p,b)=>{const S="data:image/png;base64,";if(!r||r.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void p();let E=r;E.startsWith(S)||(E=S+E);const O="mapbox-reserved-lut",V=new Image;V.src=E,V.onerror=()=>{this._styleColorTheme.lutLoading=!1,b(new Error("Failed to load image data"))},V.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void p();this._styleColorTheme.lutLoading=!1;const{width:H,height:W,data:J}=o.q.getImageData(V);if(W>32)return void b(new Error("The height of the image must be less than or equal to 32 pixels."));if(H!==W*W)return void b(new Error("The width of the image must be equal to the height squared."));this.getImage(O)&&this.removeImage(O),this.addImage(O,{data:new o.r({width:H,height:W},J),pixelRatio:1,sdf:!1,version:0});const ee=this.imageManager.getImage(O,this.scope);ee?(this._styleColorTheme.lut={image:ee.data,data:r},p()):b(new Error("Missing LUT image."))}})}getLut(r){const l=this._styleColorThemeForScope[r];return l?l.lut:null}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(l,p,b){let S,E,O;const V=o.q.devicePixelRatio>1?"@2x":"";let H=o.n(p.transformRequest(p.normalizeSpriteURL(l,V,".json"),o.R.SpriteJSON),(ee,re)=>{H=null,O||(O=ee,S=re,J())}),W=o.o(p.transformRequest(p.normalizeSpriteURL(l,V,".png"),o.R.SpriteImage),(ee,re)=>{W=null,O||(O=ee,E=re,J())});function J(){if(O)b(O);else if(S&&E){const ee=o.q.getImageData(E),re={};for(const ve in S){const{width:_e,height:xe,x:we,y:ze,sdf:Ne,pixelRatio:Le,stretchX:je,stretchY:Ue,content:rt}=S[ve],Qe=new o.r({width:_e,height:xe});o.r.copy(ee,Qe,{x:we,y:ze},{x:0,y:0},{width:_e,height:xe},null),re[ve]={data:Qe,pixelRatio:Le,sdf:Ne,stretchX:je,stretchY:Ue,content:rt}}b(null,re)}}return{cancel(){H&&(H.cancel(),H=null),W&&(W.cancel(),W=null)}}}(r,this.map._requestManager,(l,p)=>{if(this._spriteRequest=null,l)this.fire(new o.t(l));else if(p)for(const b in p)this.imageManager.addImage(b,this.scope,p[b]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.x("data",{dataType:"style"}))})}_validateLayer(r){const l=this.getOwnSource(r.source);if(!l)return;const p=r.sourceLayer;p&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(p)===-1)&&this.fire(new o.t(new Error(`Source layer "${p}" does not exist on source "${l.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,l)=>{const p=this.fragments[l];return p&&p.style&&(r.data=p.style.serialize()),r})}_serializeSources(){const r={};for(const l in this._sourceCaches){const p=this._sourceCaches[l].getSource();r[p.id]||(r[p.id]=p.serialize())}return r}_serializeLayers(r){const l=[];for(const p of r){const b=this._layers[p];b&&b.type!=="custom"&&l.push(b.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&r.isDraped(this.getLayerSourceCache(r))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const l=this.getOwnLayer(r);if(l)return l;this.fire(new o.t(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const l=this.getOwnSource(r);if(l)return l;this.fire(new o.t(new Error(`The source '${r}' does not exist in the map's style.`)))}precompilePrograms(r,l){const p=this.map.painter;if(p)for(let b=r.minzoom||0;b<(r.maxzoom||25.5);b++){const S=r.getProgramIds();if(S)for(const E of S){const O=r.getDefaultProgramParams(E,l.zoom,this._styleColorTheme.lut);O&&(p.style=this,this.fog&&(p._fogVisible=!0,O.overrideFog=!0,p.getOrCreateProgram(E,O)),p._fogVisible=!1,O.overrideFog=!1,p.getOrCreateProgram(E,O),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(O.overrideRtt=!0,p.getOrCreateProgram(E,O)))}}}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const l=this.calculateLightsBrightness();r.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l));const p=this._changes.isDirty();let b=!1;if(this._changes.isDirty()){const E=this._changes.getLayerUpdatesByScope();for(const O in E){const{updatedIds:V,removedIds:H}=E[O];(V||H)&&(this._updateWorkerLayers(O,V,H),b=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._changes.reset()}const S={};for(const E in this._mergedSourceCaches){const O=this._mergedSourceCaches[E];S[E]=O.used,O.used=!1,O.tileCoverLift=0}for(const E of this._mergedOrder){const O=this._mergedLayers[E];if(O.recalculate(r,this._availableImages),!O.isHidden(r.zoom)){const V=this.getLayerSourceCache(O);V&&(V.used=!0,V.tileCoverLift=Math.max(V.tileCoverLift,O.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(O,r)}):this.precompilePrograms(O,r))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&b&&this.mergeLayers();for(const E in S){const O=this._mergedSourceCaches[E];S[E]!==O.used&&O.getSource().fire(new o.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:O.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new o.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=this._changes.getUpdatedImages();if(r.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],r);this._changes.resetUpdatedImages()}}_updateWorkerLayers(r,l,p){const b=this.getFragmentStyle(r);b&&this.dispatcher.broadcast("updateLayers",{layers:l?b._serializeLayers(l):[],scope:r,removedIds:p||[],options:b.options})}setState(r,l){if(this._checkLoaded(),Ss(this,mo(r)))return!1;(r=o.cl(r)).layers=um(r.layers);const p=function(E,O){if(!E)return[{command:to.setStyle,args:[O]}];let V=[];try{if(!o.bh(E.version,O.version))return[{command:to.setStyle,args:[O]}];if(o.bh(E.center,O.center)||V.push({command:to.setCenter,args:[O.center]}),o.bh(E.zoom,O.zoom)||V.push({command:to.setZoom,args:[O.zoom]}),o.bh(E.bearing,O.bearing)||V.push({command:to.setBearing,args:[O.bearing]}),o.bh(E.pitch,O.pitch)||V.push({command:to.setPitch,args:[O.pitch]}),o.bh(E.sprite,O.sprite)||V.push({command:to.setSprite,args:[O.sprite]}),o.bh(E.glyphs,O.glyphs)||V.push({command:to.setGlyphs,args:[O.glyphs]}),o.bh(E.imports,O.imports)||function(re=[],ve=[],_e){ve=ve||[];const xe=(re=re||[]).map(ic),we=ve.map(ic),ze=re.reduce(Hc,{}),Ne=ve.reduce(Hc,{}),Le=xe.slice();let je,Ue,rt,Qe;for(je=0,Ue=0;je<xe.length;je++)rt=xe[je],Ne.hasOwnProperty(rt)?Ue++:(_e.push({command:to.removeImport,args:[rt]}),Le.splice(Le.indexOf(rt,Ue),1));for(je=0,Ue=0;je<we.length;je++)rt=we[we.length-1-je],Le[Le.length-1-je]!==rt&&(ze.hasOwnProperty(rt)?(_e.push({command:to.removeImport,args:[rt]}),Le.splice(Le.lastIndexOf(rt,Le.length-Ue),1)):Ue++,Qe=Le[Le.length-je],_e.push({command:to.addImport,args:[Ne[rt],Qe]}),Le.splice(Le.length-je,0,rt));for(const ot of ve){const gt=ze[ot.id];gt&&!o.bh(gt,ot)&&_e.push({command:to.updateImport,args:[ot.id,ot]})}}(E.imports,O.imports,V),o.bh(E.transition,O.transition)||V.push({command:to.setTransition,args:[O.transition]}),o.bh(E.light,O.light)||V.push({command:to.setLight,args:[O.light]}),o.bh(E.fog,O.fog)||V.push({command:to.setFog,args:[O.fog]}),o.bh(E.projection,O.projection)||V.push({command:to.setProjection,args:[O.projection]}),o.bh(E.lights,O.lights)||V.push({command:to.setLights,args:[O.lights]}),o.bh(E.camera,O.camera)||V.push({command:to.setCamera,args:[O.camera]}),!o.bh(E["color-theme"],O["color-theme"]))return[{command:to.setStyle,args:[O]}];const H={},W=[];(function(re,ve,_e,xe){let we;for(we in ve=ve||{},re=re||{})re.hasOwnProperty(we)&&(ve.hasOwnProperty(we)||co(we,_e,xe));for(we in ve){if(!ve.hasOwnProperty(we))continue;const ze=ve[we];re.hasOwnProperty(we)?o.bh(re[we],ze)||(re[we].type==="geojson"&&ze.type==="geojson"&&pr(re,ve,we)?_e.push({command:to.setGeoJSONSourceData,args:[we,ze.data]}):d1(we,ve,_e,xe)):dm(we,ve,_e)}})(E.sources,O.sources,W,H);const J=[];E.layers&&E.layers.forEach(re=>{re.source&&H[re.source]?V.push({command:to.removeLayer,args:[re.id]}):J.push(re)});let ee=E.terrain;ee&&H[ee.source]&&(V.push({command:to.setTerrain,args:[void 0]}),ee=void 0),V=V.concat(W),o.bh(ee,O.terrain)||V.push({command:to.setTerrain,args:[O.terrain]}),function(re,ve,_e){ve=ve||[];const xe=(re=re||[]).map(ic),we=ve.map(ic),ze=re.reduce(Hc,{}),Ne=ve.reduce(Hc,{}),Le=xe.slice(),je=Object.create(null);let Ue,rt,Qe,ot,gt,ht,ct;for(Ue=0,rt=0;Ue<xe.length;Ue++)Qe=xe[Ue],Ne.hasOwnProperty(Qe)?rt++:(_e.push({command:to.removeLayer,args:[Qe]}),Le.splice(Le.indexOf(Qe,rt),1));for(Ue=0,rt=0;Ue<we.length;Ue++)Qe=we[we.length-1-Ue],Le[Le.length-1-Ue]!==Qe&&(ze.hasOwnProperty(Qe)?(_e.push({command:to.removeLayer,args:[Qe]}),Le.splice(Le.lastIndexOf(Qe,Le.length-rt),1)):rt++,ht=Le[Le.length-Ue],_e.push({command:to.addLayer,args:[Ne[Qe],ht]}),Le.splice(Le.length-Ue,0,Qe),je[Qe]=!0);for(Ue=0;Ue<we.length;Ue++)if(Qe=we[Ue],ot=ze[Qe],gt=Ne[Qe],!je[Qe]&&!o.bh(ot,gt))if(o.bh(ot.source,gt.source)&&o.bh(ot["source-layer"],gt["source-layer"])&&o.bh(ot.type,gt.type)){for(ct in vd(ot.layout,gt.layout,_e,Qe,null,to.setLayoutProperty),vd(ot.paint,gt.paint,_e,Qe,null,to.setPaintProperty),o.bh(ot.slot,gt.slot)||_e.push({command:to.setSlot,args:[Qe,gt.slot]}),o.bh(ot.filter,gt.filter)||_e.push({command:to.setFilter,args:[Qe,gt.filter]}),o.bh(ot.minzoom,gt.minzoom)&&o.bh(ot.maxzoom,gt.maxzoom)||_e.push({command:to.setLayerZoomRange,args:[Qe,gt.minzoom,gt.maxzoom]}),ot)ot.hasOwnProperty(ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&ct!=="slot"&&(ct.indexOf("paint.")===0?vd(ot[ct],gt[ct],_e,Qe,ct.slice(6),to.setPaintProperty):o.bh(ot[ct],gt[ct])||_e.push({command:to.setLayerProperty,args:[Qe,ct,gt[ct]]}));for(ct in gt)gt.hasOwnProperty(ct)&&!ot.hasOwnProperty(ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&ct!=="slot"&&(ct.indexOf("paint.")===0?vd(ot[ct],gt[ct],_e,Qe,ct.slice(6),to.setPaintProperty):o.bh(ot[ct],gt[ct])||_e.push({command:to.setLayerProperty,args:[Qe,ct,gt[ct]]}))}else _e.push({command:to.removeLayer,args:[Qe]}),ht=Le[Le.lastIndexOf(Qe)+1],_e.push({command:to.addLayer,args:[gt,ht]})}(J,O.layers,V)}catch(H){console.warn("Unable to compute style diff:",H),V=[{command:to.setStyle,args:[O]}]}return V}(this.serialize(),r).filter(E=>!(E.command in nu));if(p.length===0)return!1;const b=p.filter(E=>!(E.command in ef));if(b.length>0)throw new Error(`Unimplemented: ${b.map(E=>E.command).join(", ")}.`);const S=[];return p.forEach(E=>{S.push(this[E.command].apply(this,E.args))}),l&&Promise.all(S).then(l),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(r,l){return this.getImage(r)?this.fire(new o.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,this.scope,l),this._afterImageUpdated(r),this)}updateImage(r,l){this.imageManager.updateImage(r,this.scope,l)}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._afterImageUpdated(r),this):this.fire(new o.t(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(r),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new o.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(r,l,p={}){return this._checkLoaded(),this._validate(lt,`models.${r}`,l,null,p)||(this.modelManager.addModel(r,l,this.scope),this._changes.setDirty()),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this):this.fire(new o.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,l,p={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(bo,`sources.${r}`,l,null,p))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const b=$c(r,l,this.dispatcher,this);b.scope=this.scope,b.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(b.id),source:b.serialize(),sourceId:b.id}));const S=E=>{const O=(E?"symbol:":"other:")+b.id,V=o.av(O,this.scope),H=this._sourceCaches[O]=new ss(V,b,E);(E?this._symbolSourceCaches:this._otherSourceCaches)[b.id]=H,H.onAdd(this.map)};S(!1),l.type!=="vector"&&l.type!=="geojson"||S(!0),b.onAdd&&b.onAdd(this.map),p.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const l=this.getOwnSource(r);if(!l)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===r)return this.fire(new o.t(new Error(`Source "${r}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new o.t(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const p=this.getOwnSourceCaches(r);for(const b of p){const S=o.cm(b.id);delete this._sourceCaches[S],this._changes.discardSourceCacheUpdate(b.id),b.fire(new o.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,l){this._checkLoaded(),this.getOwnSource(r).setData(l),this._changes.setDirty()}getOwnSource(r){const l=this.getOwnSourceCache(r);return l&&l.getSource()}getOwnSources(){const r=[];for(const l in this._otherSourceCaches){const p=this.getOwnSourceCache(l);p&&r.push(p.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const l in r){const p=r[l]._tiles;for(const b in p){const S=p[b];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const b of r){if(this._validate(fi,"lights",b))return;switch(b.type){case"ambient":if(this.ambientLight){const S=this.ambientLight;S.set(b),S.updateTransitions(l)}else this.ambientLight=new ro(b,Ut||(Ut=new o.a0({color:new o.a1(o._.properties_light_ambient.color),intensity:new o.a1(o._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const S=this.directionalLight;S.set(b),S.updateTransitions(l)}else this.directionalLight=new ro(b,Rn||(Rn=new o.a0({direction:new o.ad(o._.properties_light_directional.direction),color:new o.a1(o._.properties_light_directional.color),intensity:new o.a1(o._.properties_light_directional.intensity),"cast-shadows":new o.a1(o._.properties_light_directional["cast-shadows"]),"shadow-intensity":new o.a1(o._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const p=new o.a3(this.z||0,l);this.ambientLight&&this.ambientLight.recalculate(p),this.directionalLight&&this.directionalLight.recalculate(p),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,l=this.ambientLight;if(!r||!l)return;const p=J=>.2126*(J[0]<=.03928?J[0]/12.92:Math.pow((J[0]+.055)/1.055,2.4))+.7152*(J[1]<=.03928?J[1]/12.92:Math.pow((J[1]+.055)/1.055,2.4))+.0722*(J[2]<=.03928?J[2]/12.92:Math.pow((J[2]+.055)/1.055,2.4)),b=r.properties.get("color").toRenderColor(null).toArray01(),S=r.properties.get("intensity"),E=r.properties.get("direction"),O=1-o.c7(E.x,E.y,E.z)[2]/90,V=p(b)*S*O,H=l.properties.get("color").toRenderColor(null).toArray01(),W=l.properties.get("intensity");return(V+p(H)*W)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(!r)return this;if(o.cn(r)){const l=o.co(r),p=this.fragments.find(({id:S})=>S===l);if(!p)throw new Error(`Style import not found: ${r}`);const b=o.cm(r);return p.style.getFragmentStyle(b)}{const l=this.fragments.find(({id:p})=>p===r);if(!l)throw new Error(`Style import not found: ${r}`);return l.style}}getConfigProperty(r,l){const p=this.getFragmentStyle(r);if(!p)return null;const b=o.av(l,p.scope),S=p.options.get(b),E=S?S.value||S.default:null;return E?E.serialize():null}setConfigProperty(r,l,p){const b=this.getFragmentStyle(r);if(!b)return;const S=b.stylesheet.schema;if(!S||!S[l])return;const E=o.M(p);if(E.result!=="success")return void Ss(this,E.value);const O=E.value.expression,V=o.av(l,b.scope),H=b.options.get(V);if(!H)return;let W;const{minValue:J,maxValue:ee,stepValue:re,type:ve,values:_e}=S[l],xe=o.M(S[l].default);xe.result==="success"&&(W=xe.value.expression),W?(this.options.set(V,{...H,value:O,default:W,minValue:J,maxValue:ee,stepValue:re,type:ve,values:_e}),this.updateConfigDependencies(l)):this.fire(new o.t(new Error(`No schema defined for the config option "${l}" in the "${r}" fragment.`)))}getConfig(r){const l=this.getFragmentStyle(r);if(!l)return null;const p=l.stylesheet.schema;if(!p)return null;const b={};for(const S in p){const E=o.av(S,l.scope),O=l.options.get(E),V=O?O.value||O.default:null;b[S]=V?V.serialize():null}return b}setConfig(r,l){const p=this.getFragmentStyle(r);p&&(p.updateConfig(l,p.stylesheet.schema),this.updateConfigDependencies())}getSchema(r){const l=this.getFragmentStyle(r);return l?l.stylesheet.schema:null}setSchema(r,l){const p=this.getFragmentStyle(r);p&&(p.stylesheet.schema=l,p.updateConfig(p._config,l),this.updateConfigDependencies())}updateConfig(r,l){if(this._config=r,r||l)if(l)for(const p in l){let b,S;const E=o.M(l[p].default);if(E.result==="success"&&(b=E.value.expression),r&&r[p]!==void 0){const ee=o.M(r[p]);ee.result==="success"&&(S=ee.value.expression)}const{minValue:O,maxValue:V,stepValue:H,type:W,values:J}=l[p];if(b){const ee=o.av(p,this.scope);this.options.set(ee,{default:b,value:S,minValue:O,maxValue:V,stepValue:H,type:W,values:J})}else this.fire(new o.t(new Error(`No schema defined for config option "${p}".`)))}else this.fire(new o.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(r){for(const l of this._configDependentLayers){const p=this.getLayer(l);if(p){if(r&&!p.configDependencies.has(r))continue;p.possiblyEvaluateVisibility(),this._updateLayer(p)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(l=>{if(l._styleColorTheme.colorTheme){const p=l._evaluateColorThemeData(l._styleColorTheme.colorTheme);(!l._styleColorTheme.lut&&p!==""||l._styleColorTheme.lut&&p!==l._styleColorTheme.lut.data)&&l.setColorTheme(l._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(r,l,p={}){this._checkLoaded();const b=r.id;if(this._layers[b])return void this.fire(new o.t(new Error(`Layer with id "${b}" already exists on this map`)));let S;if(r.type==="custom"){if(Ss(this,o.cp(r)))return;S=o.cq(r,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof r.source=="object"&&(this.addSource(b,r.source),r=o.cl(r),r=o.l(r,{source:b})),this._validate(Nt,`layers.${b}`,r,{arrayIndex:-1},p))return;S=o.cq(r,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(S),S.setEventedParent(this,{layer:{id:b}}),this._serializedLayers[S.id]=S.serialize()}S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid);let E=this._order.length;if(l){const W=this._order.indexOf(l);if(W===-1)return void this.fire(new o.t(new Error(`Layer with id "${l}" does not exist on this map.`)));S.slot===this._layers[l].slot?E=W:o.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,b),this._layerOrderChanged=!0,this._layers[b]=S;const O=this.getOwnLayerSourceCache(S),V=!!this.directionalLight&&this.directionalLight.shadowsEnabled();O&&S.canCastShadows()&&V&&(O.castsShadows=!0);const H=this._changes.getRemovedLayer(S);if(H&&S.source&&O&&S.type!=="custom"){this._changes.discardLayerRemoval(S);const W=o.av(S.source,S.scope);H.type!==S.type?this._changes.updateSourceCache(W,"clear"):(this._changes.updateSourceCache(W,"reload"),O.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),S.scope=this.scope,this.mergeLayers()}moveLayer(r,l){this._checkLoaded();const p=this._checkLayer(r);if(!p||r===l)return;const b=this._order.indexOf(r);this._order.splice(b,1);let S=this._order.length;if(l){const E=this._order.indexOf(l);if(E===-1)return void this.fire(new o.t(new Error(`Layer with id "${l}" does not exist on this map.`)));p.slot===this._layers[l].slot?S=E:o.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const l=this._checkLayer(r);if(!l)return;l.setEventedParent(null);const p=this._order.indexOf(r);this._order.splice(p,1),delete this._layers[r],delete this._serializedLayers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const b=this.getOwnLayerSourceCache(l);if(b&&b.castsShadows){let S=!1;for(const E in this._layers)if(this._layers[E].source===l.source&&this._layers[E].canCastShadows()){S=!0;break}b.castsShadows=S}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const l in this._layers)if(this._layers[l].type===r)return!0;return!1}setLayerZoomRange(r,l,p){this._checkLoaded();const b=this._checkLayer(r);b&&(b.minzoom===l&&b.maxzoom===p||(l!=null&&(b.minzoom=l),p!=null&&(b.maxzoom=p),this._updateLayer(b)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(r,l){this._checkLoaded();const p=this._checkLayer(r);p&&p.slot!==l&&(p.slot=l,this._updateLayer(p))}setFilter(r,l,p={}){this._checkLoaded();const b=this._checkLayer(r);if(b&&!o.bh(b.filter,l))return l==null?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(Te,`layers.${b.id}.filter`,l,{layerType:b.type},p)||(b.filter=o.cl(l),this._updateLayer(b)))}getFilter(r){const l=this._checkLayer(r);if(l)return o.cl(l.filter)}setLayoutProperty(r,l,p,b={}){this._checkLoaded();const S=this._checkLayer(r);if(S&&!o.bh(S.getLayoutProperty(l),p)){if(p!=null&&(!b||b.validate!==!1)&&Ss(S,Ke.call(mo,{key:`layers.${r}.layout.${l}`,layerType:S.type,objectKey:l,value:p,styleSpec:o._,style:{glyphs:!0,sprite:!0}})))return;S.setLayoutProperty(l,p),S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),this._updateLayer(S)}}getLayoutProperty(r,l){const p=this._checkLayer(r);if(p)return p.getLayoutProperty(l)}setPaintProperty(r,l,p,b={}){this._checkLoaded();const S=this._checkLayer(r);if(!S||o.bh(S.getPaintProperty(l),p)||p!=null&&(!b||b.validate!==!1)&&Ss(S,ke.call(mo,{key:`layers.${r}.paint.${l}`,layerType:S.type,objectKey:l,value:p,styleSpec:o._})))return;const E=S.setPaintProperty(l,p);S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),E&&this._updateLayer(S),this._changes.updatePaintProperties(S)}getPaintProperty(r,l){const p=this._checkLayer(r);if(p)return p.getPaintProperty(l)}setFeatureState(r,l){this._checkLoaded();const p=r.source,b=r.sourceLayer,S=this._checkSource(p);if(!S)return;const E=S.type;if(E==="geojson"&&b)return void this.fire(new o.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(E==="vector"&&!b)return void this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new o.t(new Error("The feature id parameter must be provided.")));const O=this.getOwnSourceCaches(p);for(const V of O)V.setFeatureState(b,r.id,l)}removeFeatureState(r,l){this._checkLoaded();const p=r.source,b=this._checkSource(p);if(!b)return;const S=b.type,E=S==="vector"?r.sourceLayer:void 0;if(S==="vector"&&!E)return void this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new o.t(new Error("A feature id is required to remove its specific state property.")));const O=this.getOwnSourceCaches(p);for(const V of O)V.removeFeatureState(E,r.id,l)}getFeatureState(r){this._checkLoaded();const l=r.source,p=r.sourceLayer,b=this._checkSource(l);if(b){if(b.type!=="vector"||p)return r.id===void 0&&this.fire(new o.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(l)[0].getFeatureState(p,r.id);this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=o.l({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return o.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),l=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return o.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},p=>p!==void 0)}_updateLayer(r){this._changes.updateLayer(r);const l=this.getLayerSourceCache(r),p=o.av(r.source,r.scope),b=this._changes.getUpdatedSourceCaches();r.source&&!b[p]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(p,"reload"),l.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const l=O=>this._mergedLayers[O].is3D(),p=this.order,b={},S=[];for(let O=p.length-1;O>=0;O--){const V=p[O];if(l(V)){b[V]=O;for(const H of r){const W=H[V];if(W)for(const J of W)S.push(J)}}}S.sort((O,V)=>V.intersectionZ-O.intersectionZ);const E=[];for(let O=p.length-1;O>=0;O--){const V=p[O];if(l(V))for(let H=S.length-1;H>=0;H--){const W=S[H].feature;if(W.layer&&b[W.layer.id]<O)break;E.push(W),S.pop()}else for(const H of r){const W=H[V];if(W)for(const J of W)E.push(J.feature)}}return E}queryRenderedFeatures(r,l,p){l&&l.filter&&this._validate(Te,"queryRenderedFeatures.filter",l.filter,null,l),l.scope=this.scope,l.availableImages=this._availableImages,l.serializedLayers=this._serializedLayers;const b={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new o.t(new Error("parameters.layers must be an Array."))),[];for(const H of l.layers){const W=this._mergedLayers[H];if(!W)return this.fire(new o.t(new Error(`The layer '${H}' does not exist in the map's style and cannot be queried for features.`))),[];b[W.source]=!0}}const S=[],E=l.serializedLayers||{},O=l&&l.layers?l.layers.some(H=>{const W=this.getLayer(H);return W&&W.is3D()}):this.has3DLayers(),V=Jn.createFromScreenPoints(r,p);for(const H in this._mergedSourceCaches){const W=this._mergedSourceCaches[H].getSource();if(!W||W.scope!==l.scope)continue;const J=this._mergedSourceCaches[H].getSource().id;l.layers&&!b[J]||S.push(sm(this._mergedSourceCaches[H],this._mergedLayers,E,V,l,p,O,!!this.map._showQueryGeometry))}return this.placement&&S.push(function(H,W,J,ee,re,ve,_e){const xe={},we=ve.queryRenderedSymbols(ee),ze=[];for(const Ne of Object.keys(we).map(Number))ze.push(_e[Ne]);ze.sort(Vc);for(const Ne of ze){const Le=Ne.featureIndex.lookupSymbolFeatures(we[Ne.bucketInstanceId],W,Ne.bucketIndex,Ne.sourceLayerIndex,re.filter,re.layers,re.availableImages,H);for(const je in Le){const Ue=xe[je]=xe[je]||[],rt=Le[je];rt.sort((Qe,ot)=>{const gt=Ne.featureSortOrder;if(gt){const ht=gt.indexOf(Qe.featureIndex);return gt.indexOf(ot.featureIndex)-ht}return ot.featureIndex-Qe.featureIndex});for(const Qe of rt)Ue.push(Qe)}}for(const Ne in xe)xe[Ne].forEach(Le=>{const je=Le.feature,Ue=J(H[Ne]);if(!Ue)return;const rt=Ue.getFeatureState(je.layer["source-layer"],je.id);je.source=je.layer.source,je.layer["source-layer"]&&(je.sourceLayer=je.layer["source-layer"]),je.state=rt});return xe}(this._mergedLayers,E,this.getLayerSourceCache.bind(this),V.screenGeometry,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(r,l){l&&l.filter&&this._validate(Te,"querySourceFeatures.filter",l.filter,null,l);const p=this.getOwnSourceCaches(r);let b=[];for(const S of p)b=b.concat(pd(S,l));return b}addSourceType(r,l,p){return Ts.getSourceType(r)?p(new Error(`A source type called "${r}" already exists.`)):(Ts.setSourceType(r,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:l.workerSourceURL},p):p(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,l,p={}){this._checkLoaded();const b=this.light.getLight();let S=!1;for(const O in r)if(!o.bh(r[O],b[O])){S=!0;break}if(!S)return;const E=this._getTransitionParameters();this.light.setLight(r,l,p),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=o.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&o.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(r,l=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let p=r;const b=r.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof p.source=="object"){const O="terrain-dem-src";this.addSource(O,p.source),p=o.cl(p),p=o.l(p,{source:O})}const S=o.l({},p),E={};if(this.terrain&&b){S.source=this.terrain.get().source;const O=this.terrain?this.getFragmentStyle(this.terrain.scope):null;O&&(E.style=O.serialize())}if(this._validate(_a,"terrain",S,E))return}if(!this.terrain||this.terrain.scope!==this.scope&&!b||this.terrain&&l!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,l),this.fire(new o.x("data",{dataType:"style"}))}else{const S=this.terrain,E=S.get();for(const O of Object.keys(o._.terrain))!p.hasOwnProperty(O)&&o._.terrain[O].default&&(p[O]=o._.terrain[O].default);for(const O in r)if(!o.bh(r[O],E[O])){S.set(r,this.options),this.stylesheet.terrain=r;const V=this._getTransitionParameters({duration:0});S.updateTransitions(V),this.fire(new o.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const l=this.fog=new Wr(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!o.bh(l.get(),r)){l.set(r,this.options),this.stylesheet.fog=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}}else this._createFog(r);this._markersNeedUpdate=!0}setColorTheme(r){this._checkLoaded();const l=()=>{for(const b in this._layers)this._layers[b].lut=this._styleColorTheme.lut;for(const b in this._sourceCaches)this._sourceCaches[b].clearTiles()};if(this._styleColorTheme.colorTheme=r,!r)return this._styleColorTheme.lut=null,void l();const p=this._evaluateColorThemeData(r);this._loadColorTheme(p).then(()=>{this.fire(new o.x("colorthemeset")),l()}).catch(b=>{o.w(`Couldn't set color theme: ${b}`)})}_getTransitionParameters(r){return{now:o.q.now(),transition:o.l(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],l=[];for(const p of this._mergedOrder)this.isLayerDraped(this._mergedLayers[p])?r.push(p):l.push(p);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...l)}_createTerrain(r,l){const p=this.terrain=new Yt(r,l,this.scope,this.options);l===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const b=this._getTransitionParameters({duration:0});p.updateTransitions(b)}_force3DLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="symbol"&&this._updateLayer(l)}}_validate(r,l,p,b,S={}){if(S&&S.validate===!1)return!1;const E=o.l({},this.serialize());return Ss(this,r.call(mo,o.l({key:l,style:E,value:p,styleSpec:o._},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(r){const l=this.getSourceCaches(r);for(const p of l)p.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const l=this.getSourceCaches(r);for(const p of l)p.resume(),p.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}updateSources(r){let l;this.directionalLight&&(l=Xh(this.directionalLight));for(const p in this._mergedSourceCaches)this._mergedSourceCaches[p].update(r,void 0,void 0,l)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const l=this._sourceCaches[r];l.resume(),l.reload()}}_updatePlacement(r,l,p,b,S,E,O=!1){let V=!1,H=!1;const W={},J={};for(const ee of this._mergedOrder){const re=this._mergedLayers[ee];if(re.type!=="symbol")continue;const ve=o.av(re.source,re.scope);let _e=W[ve];if(!_e){const we=this.getLayerSourceCache(re);if(!we)continue;const ze=we.getRenderableIds(!0).map(Ne=>we.getTileByID(Ne));J[ve]=ze.slice(),_e=W[ve]=ze.sort((Ne,Le)=>Le.tileID.overscaledZ-Ne.tileID.overscaledZ||(Ne.tileID.isLessThan(Le.tileID)?-1:1))}const xe=this.crossTileSymbolIndex.addLayer(re,_e,l.center.lng,l.projection);V=V||xe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),O=O||this._layerOrderChanged||b===0,this._layerOrderChanged&&this.fire(new o.x("neworder")),(O||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.q.now(),l.zoom))&&(this.pauseablePlacement=new _d(l,this._mergedOrder,O,p,b,S,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,W,J),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.q.now()),H=!0),V&&this.pauseablePlacement.placement.setStale()),H||V){this._buildingIndex.onNewFrame(l.zoom);for(let ee=0;ee<this._mergedOrder.length;ee++){const re=this._mergedLayers[this._mergedOrder[ee]];if(re.type!=="symbol")continue;const ve=this.isLayerClipped(re);this.placement.updateLayerOpacities(re,W[o.av(re.source,re.scope)],ee,ve?E:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.q.now())}}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,l){this._checkLoaded();const p=this.stylesheet.imports=this.stylesheet.imports||[];if(p.findIndex(({id:S})=>S===r.id)!==-1)return void this.fire(new o.t(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!l)return p.push(r),this._loadImports([r],!0);const b=p.findIndex(({id:S})=>S===l);return b===-1&&this.fire(new o.t(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=p.slice(0,b).concat(r).concat(p.slice(b)),this._loadImports([r],!0,l)}updateImport(r,l){this._checkLoaded();const p=this.stylesheet.imports||[],b=this.getImportIndex(r);return b===-1?this:typeof l=="string"?(this.setImportUrl(r,l),this):(l.url&&l.url!==p[b].url&&this.setImportUrl(r,l.url),o.bh(l.config,p[b].config)||this.setImportConfig(r,l.config),o.bh(l.data,p[b].data)||this.setImportData(r,l.data),this)}moveImport(r,l){this._checkLoaded();let p=this.stylesheet.imports||[];const b=this.getImportIndex(r);if(b===-1)return this;const S=this.getImportIndex(l);if(S===-1)return this;const E=p[b],O=this.fragments[b];return p=p.filter(({id:V})=>V!==r),this.fragments=this.fragments.filter(({id:V})=>V!==r),this.stylesheet.imports=p.slice(0,S).concat(E).concat(p.slice(S)),this.fragments=this.fragments.slice(0,S).concat(O).concat(this.fragments.slice(S)),this.mergeLayers(),this}setImportUrl(r,l){this._checkLoaded();const p=this.stylesheet.imports||[],b=this.getImportIndex(r);if(b===-1)return this;p[b].url=l;const S=this.fragments[b];return S.style=this._createFragmentStyle(p[b]),S.style.on("style.import.load",()=>this.mergeAll()),S.style.loadURL(l),this}setImportData(r,l){this._checkLoaded();const p=this.getImportIndex(r),b=this.stylesheet.imports||[];return p===-1?this:l?(this.fragments[p].style.setState(l),this._reloadImports(),this):(delete b[p].data,this.setImportUrl(r,b[p].url))}setImportConfig(r,l){this._checkLoaded();const p=this.getImportIndex(r),b=this.stylesheet.imports||[];if(p===-1)return this;l?b[p].config=l:delete b[p].config;const S=this.fragments[p],E=S.style.stylesheet&&S.style.stylesheet.schema;return S.config=l,S.style.updateConfig(l,E),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const l=this.stylesheet.imports||[],p=this.getImportIndex(r);p!==-1&&(l.splice(p,1),this.fragments[p].style._remove(),this.fragments.splice(p,1),this._reloadImports())}getImportIndex(r){const l=(this.stylesheet.imports||[]).findIndex(p=>p.id===r);return l===-1&&this.fire(new o.t(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),l}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const l in this._mergedOtherSourceCaches){const p=this._mergedOtherSourceCaches[l];p&&r.push(p.getSource())}return r}getSource(r,l){const p=this.getSourceCache(r,l);return p&&p.getSource()}getLayerSource(r){const l=this.getLayerSourceCache(r);return l&&l.getSource()}getSourceCache(r,l){const p=o.av(r,l);return this._mergedOtherSourceCaches[p]}getLayerSourceCache(r){const l=o.av(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(r){if(r==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[r]&&l.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&l.push(this._mergedSymbolSourceCaches[r]),l}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const l in r){const p=r[l];p==="reload"?this.reloadSource(l):p==="clear"&&this.clearSource(l)}}updateLayers(r){const l=this._changes.getUpdatedPaintProperties();for(const p of l){const b=this.getLayer(p);b&&b.updateTransitions(r)}}getImages(r,l,p){this.imageManager.getImages(l.icons,l.scope,p),this._updateTilesForChangedImages();const b=S=>{S&&S.setDependencies(l.tileID.key,l.type,l.icons)};b(this._otherSourceCaches[l.source]),b(this._symbolSourceCaches[l.source])}getGlyphs(r,l,p){this.glyphManager.getGlyphs(l.stacks,l.scope,p)}getResource(r,l,p){return o.ct(l,p)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const l=[];return this._otherSourceCaches[r]&&l.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&l.push(this._symbolSourceCaches[r]),l}_isSourceCacheLoaded(r){const l=this.getOwnSourceCaches(r);return l.length===0?(this.fire(new o.t(new Error(`There is no source with ID '${r}'`))),!1):l.every(p=>p.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(r,l){if(!this._clipLayerPresent&&r.type!=="fill-extrusion")return!1;const p=r.type==="fill-extrusion"&&r.sourceLayer==="building";if(r.is3D()){if(p||l&&l.type==="batched-model"||r.type==="model")return!0}else if(r.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ts.getSourceType=function(f){return $h[f]},Ts.setSourceType=function(f,r){$h[f]=r},Ts.registerForPluginStateChange=o.cc;var x_=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,ym=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,bm=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,tf="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",w_=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,S_=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,T_=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,C_=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,xm=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,E_=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,bd=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const nf=[];Il(x_,nf),Il(bm,nf),Il(ym,nf);const xd={"_prelude_fog.vertex.glsl":S_,"_prelude_terrain.vertex.glsl":w_,"_prelude_shadow.vertex.glsl":E_,"_prelude_fog.fragment.glsl":T_,"_prelude_shadow.fragment.glsl":bd,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":C_,"_prelude_raster_particle.glsl":xm},ru={};Zr("",w_),Zr(T_,S_),Zr(bd,E_),Zr(C_,""),Zr(xm,"");const wd=Zr(ym,bm),rf=x_;var Ml={background:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Zr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Zr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Zr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Zr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Zr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Zr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Zr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Zr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Zr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Zr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Zr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Zr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Zr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Zr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
}`),terrainRaster:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Zr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Zr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,tf),skyboxGradient:Zr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,tf),skyboxCapture:Zr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Zr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Zr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Zr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),occlusion:Zr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Il(f,r){const l=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of l)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const b=p.split(" ");for(const S of b)r.includes(S)||r.push(S)}}function Zr(f,r){const l=/#include\s+"([^"]+)"/g,p=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let b=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);b&&(b=b.map(H=>{const W=H.split(" ");return W[W.length-1]}),b=[...new Set(b)]);const S={},E=[],O=[];if(f=f.replace(l,(H,W)=>(O.push(W),"")),(r=r.replace(l,(H,W)=>(E.push(W),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let V=[...nf];Il(f,V),Il(r,V);for(const H of[...E,...O])xd[H]||console.error(`Undefined include: ${H}`),ru[H]||(ru[H]=[],Il(xd[H],ru[H])),V=[...V,...ru[H]];return{fragmentSource:f=f.replace(p,(H,W,J,ee,re)=>(S[re]=!0,W==="define"?`
#ifndef HAS_UNIFORM_u_${re}
in ${J} ${ee} ${re};
#else
uniform ${J} ${ee} u_${re};
#endif
`:W==="initialize"?`
#ifdef HAS_UNIFORM_u_${re}
    ${J} ${ee} ${re} = u_${re};
#endif
`:W==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    in ${J} ${ee} ${re};
#endif
`:W==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(p,(H,W,J,ee,re)=>{const ve=ee==="float"?"vec2":ee,_e=re.match(/color/)?"color":ve;return W==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${re}
in ${J} ${ee} a_${re};
#endif
`:S[re]?W==="define"?`
#ifndef HAS_UNIFORM_u_${re}
uniform lowp float u_${re}_t;
in ${J} ${ve} a_${re};
out ${J} ${ee} ${re};
#else
uniform ${J} ${ee} u_${re};
#endif
`:W==="initialize"?_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${re}
    ${re} = a_${re};
#else
    ${J} ${ee} ${re} = u_${re};
#endif
`:`
#ifndef HAS_UNIFORM_u_${re}
    ${re} = unpack_mix_${_e}(a_${re}, u_${re}_t);
#else
    ${J} ${ee} ${re} = u_${re};
#endif
`:W==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    in ${J} ${ee} a_${re};
    out ${J} ${ee} ${re};
#endif
`:W==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    ${re} = a_${re};
#endif
`:void 0:W==="define"?`
#ifndef HAS_UNIFORM_u_${re}
uniform lowp float u_${re}_t;
in ${J} ${ve} a_${re};
#else
uniform ${J} ${ee} u_${re};
#endif
`:W==="define-instanced"?_e==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${re}0;
in vec4 a_${re}1;
in vec4 a_${re}2;
in vec4 a_${re}3;
#else
uniform ${J} ${ee} u_${re};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${J} ${ve} a_${re};
#else
uniform ${J} ${ee} u_${re};
#endif
`:W==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    ${J} ${ee} ${re} = a_${re};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${re}
    ${J} ${ee} ${re} = a_${re};
#else
    ${J} ${ee} ${re} = u_${re};
#endif
`:`
#ifndef HAS_UNIFORM_u_${re}
    ${J} ${ee} ${re} = unpack_mix_${_e}(a_${re}, u_${re}_t);
#else
    ${J} ${ee} ${re} = u_${re};
#endif
`}),staticAttributes:b,usedDefines:V,vertexIncludes:E,fragmentIncludes:O}}class ou{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,l,p,b,S,E,O,V){this.context=r;let H=this.boundPaintVertexBuffers.length!==b.length;for(let J=0;!H&&J<b.length;J++)this.boundPaintVertexBuffers[J]!==b[J]&&(H=!0);let W=this.boundDynamicVertexBuffers.length!==O.length;for(let J=0;!W&&J<O.length;J++)this.boundDynamicVertexBuffers[J]!==O[J]&&(W=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==p||H||W||this.boundIndexBuffer!==S||this.boundVertexOffset!==E)this.freshBind(l,p,b,S,E,O,V);else{r.bindVertexArrayOES.set(this.vao);for(const J of O)J&&(J.bind(),V&&J.instanceCount&&J.setVertexAttribDivisor(r.gl,l,V));S&&S.dynamicDraw&&S.bind()}}freshBind(r,l,p,b,S,E,O){const V=r.numAttributes,H=this.context,W=H.gl;this.vao&&this.destroy(),this.vao=H.gl.createVertexArray(),H.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=b,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=E,l.enableAttributes(W,r),l.bind(),l.setVertexAttribPointers(W,r,S);for(const J of p)J.enableAttributes(W,r),J.bind(),J.setVertexAttribPointers(W,r,S);for(const J of E)J&&(J.enableAttributes(W,r),J.bind(),J.setVertexAttribPointers(W,r,S),O&&J.instanceCount&&J.setVertexAttribDivisor(W,r,O));b&&b.bind(),H.currentNumAttributes=V}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Sd(f,r){const l=Math.pow(2,r.canonical.z),p=r.canonical.y;return[new o.a5(0,p/l).toLngLat().lat,new o.a5(0,(p+1)/l).toLngLat().lat]}function of(f,r,l,p,b,S,E){const O=f.context,V=O.gl,H=l.hillshadeFBO;if(!H)return;f.prepareDrawTile();const W=f.isTileAffectedByFog(r),J=f.getOrCreateProgram("hillshade",{overrideFog:W});O.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,H.colorAttachment.get());const ee=((xe,we,ze,Ne)=>{const Le=ze.paint.get("hillshade-shadow-color"),je=ze.paint.get("hillshade-highlight-color"),Ue=ze.paint.get("hillshade-accent-color"),rt=ze.paint.get("hillshade-emissive-strength");let Qe=o.bB(ze.paint.get("hillshade-illumination-direction"));if(ze.paint.get("hillshade-illumination-anchor")==="viewport")Qe-=xe.transform.angle;else if(xe.style&&xe.style.enable3dLights()&&xe.style.directionalLight){const gt=xe.style.directionalLight.properties.get("direction"),ht=o.c7(gt.x,gt.y,gt.z);Qe=o.bB(ht[1])}const ot=!xe.options.moving;return{u_matrix:Ne||xe.transform.calculateProjMatrix(we.tileID.toUnwrapped(),ot),u_image:0,u_latrange:Sd(0,we.tileID),u_light:[ze.paint.get("hillshade-exaggeration"),Qe],u_shadow:Le.toRenderColor(ze.lut),u_highlight:je.toRenderColor(ze.lut),u_emissive_strength:rt,u_accent:Ue.toRenderColor(ze.lut)}})(f,l,p,f.terrain?r.projMatrix:null);f.uploadCommonUniforms(O,J,r.toUnwrapped());const{tileBoundsBuffer:re,tileBoundsIndexBuffer:ve,tileBoundsSegments:_e}=f.getTileBoundsBuffers(l);J.draw(f,V.TRIANGLES,b,S,E,yr.disabled,ee,p.id,re,ve,_e)}function sf(f,r,l){if(!r.needsDEMTextureUpload)return;const p=f.context,b=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||f.getTileTexture(l.stride);const S=l.getPixels();r.demTexture?r.demTexture.update(S,{premultiply:!1}):r.demTexture=new o.T(p,S,b.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function Td(f,r,l){const p=f.context,b=p.gl;if(!r.dem)return;const S=r.dem;if(p.activeTexture.set(b.TEXTURE1),sf(f,r,S),!r.demTexture)return;r.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);const E=S.dim;p.activeTexture.set(b.TEXTURE0);let O=r.hillshadeFBO;if(!O){const ee=new o.T(p,{width:E,height:E,data:null},b.RGBA8);ee.bind(b.LINEAR,b.CLAMP_TO_EDGE),O=r.hillshadeFBO=p.createFramebuffer(E,E,!0,"renderbuffer"),O.colorAttachment.set(ee.texture)}p.bindFramebuffer.set(O.framebuffer),p.viewport.set([0,0,E,E]);const{tileBoundsBuffer:V,tileBoundsIndexBuffer:H,tileBoundsSegments:W}=f.getMercatorTileBoundsBuffers(),J=[];f.linearFloatFilteringSupported()&&J.push("TERRAIN_DEM_FLOAT_FORMAT"),f.getOrCreateProgram("hillshadePrepare",{defines:J}).draw(f,b.TRIANGLES,or.disabled,Mr.disabled,Ur.unblended,yr.disabled,((ee,re)=>{const ve=re.stride,_e=o.a6.mat4.create();return o.a6.mat4.ortho(_e,0,o.ab,-o.ab,0,0,1),o.a6.mat4.translate(_e,_e,[0,-o.ab,0]),{u_matrix:_e,u_image:1,u_dimension:[ve,ve],u_zoom:ee.overscaledZ}})(r.tileID,S),l.id,V,H,W),r.needsHillshadePrepare=!1}class So{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class wm extends So{getDefault(){return o.bz.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class M_ extends So{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Sm extends So{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class af extends So{getDefault(){return[!0,!0,!0,!0]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Cd extends So{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class I_ extends So{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class k_ extends So{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const l=this.current;(r.func!==l.func||r.ref!==l.ref||r.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class A_ extends So{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class iu extends So{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=r,this.dirty=!1}}class P_ extends So{getDefault(){return[0,1]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class g1 extends So{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=r,this.dirty=!1}}class v1 extends So{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class _1 extends So{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.BLEND):l.disable(l.BLEND),this.current=r,this.dirty=!1}}class Tm extends So{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Cm extends So{getDefault(){return o.bz.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Em extends So{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class Mm extends So{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=r,this.dirty=!1}}class R_ extends So{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class D_ extends So{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let y1=class extends So{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class Ed extends So{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Md extends So{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class L_ extends So{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Cs extends So{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Im extends So{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class lf extends So{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class cf extends So{getDefault(){return null}set(r){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class km extends So{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class Am extends So{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class uf extends So{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Pm extends So{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Id extends So{constructor(r,l){super(r),this.context=r,this.parent=l}getDefault(){return null}}class df extends Id{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Rm extends Id{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class O_ extends Id{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class su extends Rm{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const b1=(f,r,l)=>({u_matrix:f,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:l}),z_=(f,r,l,p,b,S,E,O,V,H,W,J,ee,re,ve,_e)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:l,u_zoom_transition:b,u_merc_center:S,u_image0:0,u_frustum_tl:E,u_frustum_tr:O,u_frustum_br:V,u_frustum_bl:H,u_globe_pos:W,u_globe_radius:J,u_viewport:ee,u_grid_matrix:_e?Float32Array.from(_e):new Float32Array(9),u_skirt_height:re,u_far_z_cutoff:ve});function B_(f,r){return f!=null&&r!=null&&!(!f.hasData()||!r.hasData())&&f.demTexture!=null&&r.demTexture!=null&&f.tileID.key!==r.tileID.key}const au=new class{constructor(){this.operations={}}newMorphing(f,r,l,p,b){if(f in this.operations){const S=this.operations[f];S.to.tileID.key!==l.tileID.key&&(S.queued=l)}else this.operations[f]={startTime:p,phase:0,duration:b,from:r,to:l,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const r=this.operations[f];return{from:r.from,to:r.to,phase:r.phase}}update(f){for(const r in this.operations){const l=this.operations[r];for(l.phase=(f-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,f)){delete this.operations[r];break}}}_nextOp(f,r){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=r,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},F_={0:null,1:"TERRAIN_VERTEX_MORPHING"};function N_(f,r,l){if(r===0)return 0;const p=r<1&&l===514?.25/r:1;return 6*Math.pow(1.5,22-f)*Math.max(r,1)*p}function Dm(f,r){const l=1<<f.z;return!r&&(f.x===0||f.x===l-1)||f.y===0||f.y===l-1}const kd=f=>({u_matrix:f});function hf(f,r,l,p,b){if(b>0){const S=o.q.now(),E=(S-f.timeAdded)/b,O=r?(S-r.timeAdded)/b:-1,V=l.getSource(),H=p.coveringZoomLevel({tileSize:V.tileSize,roundZoom:V.roundZoom}),W=!r||Math.abs(r.tileID.overscaledZ-H)>Math.abs(f.tileID.overscaledZ-H),J=W&&f.refreshedUponExpiration?1:o.ap(W?E:1-O,0,1);return f.refreshedUponExpiration&&E>=1&&(f.refreshedUponExpiration=!1),r?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}class lu extends ss{constructor(r){const l={type:"raster-dem",maxzoom:r.transform.maxZoom},p=new o.cd(o.ce(),null),b=$c("mock-dem",l,p,r.style);super("mock-dem",b,!1),b.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,l){r.state="loaded",l(null)}}class $_ extends ss{constructor(r){const l=$c("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new o.cd(o.ce(),null),r.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,l,p){if(r.freezeTileCoverage)return;this.transform=r;const b=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((S,E)=>{if(S[E.key]="",!this._tiles[E.key]){const O=new ba(E,this._source.tileSize*E.overscaleFactor(),r.tileZoom);O.state="loaded",this._tiles[E.key]=O}return S},{});for(const S in this._tiles)S in b||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(r){const l=this.proxyCachedFBO[r];if(l!==void 0){const p=Object.values(l);this.renderCachePool.push(...p),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Lm extends o.aA{constructor(r,l,p){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=l,this.projMatrix=p}}class Om extends o.cE{constructor(r,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,b,S]=function(V){const H=new o.a_,W=new o.aO,J=131;H.reserve(17161),W.reserve(33800);const ee=o.ab/128,re=o.ab+ee/2,ve=re+ee;for(let xe=-ee;xe<ve;xe+=ee)for(let we=-ee;we<ve;we+=ee){const ze=we<0||we>re||xe<0||xe>re?24575:0,Ne=o.ap(Math.round(we),0,o.ab),Le=o.ap(Math.round(xe),0,o.ab);H.emplaceBack(Ne+ze,Le)}const _e=(xe,we)=>{const ze=we*J+xe;W.emplaceBack(ze+1,ze,ze+J),W.emplaceBack(ze+J,ze+J+1,ze+1)};for(let xe=1;xe<129;xe++)for(let we=1;we<129;we++)_e(we,xe);return[0,129].forEach(xe=>{for(let we=0;we<130;we++)_e(we,xe),_e(xe,we)}),[H,W,32768]}(),E=r.context;this.gridBuffer=E.createVertexBuffer(p,o.b0.members),this.gridIndexBuffer=E.createIndexBuffer(b),this.gridSegments=o.b1.simpleSegment(0,0,p.length,b.length),this.gridNoSkirtSegments=o.b1.simpleSegment(0,0,p.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new $_(l.map),this.orthoMatrix=o.a6.mat4.create(),o.a6.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.ab,0,o.ab,0,1);const O=E.gl;this._overlapStencilMode=new Mr({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new lu(l.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,l,p){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const b=r.terrain.properties,S=r.terrain.drapeRenderMode===0,E=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=o.q.now();const O=r.terrain&&r.terrain.scope,V=b.get("source"),H=S?this._mockSourceCache:r.getSourceCache(V,O);if(!H)return void o.w(`Couldn't find terrain source "${V}".`);if(this.sourceCache=H,this._exaggeration=E?this.calculateExaggeration(l):b.get("exaggeration"),!l.projection.requiresDraping&&E&&this._exaggeration===0)return void this._disable();this.enabled=!0;const W=()=>{this.sourceCache.used&&o.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const J=this.getScaledDemTileSize();this.sourceCache.update(l,J,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,W(),this._initializing=!0),W(),l.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(r){const l=this._previousCameraAltitude,p=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=p;const b=l!=null?p-l:Number.MAX_VALUE;if(Math.abs(b)<2)return this._exaggeration;const S=r.zoom,E=this._style.terrain;if(!this._previousUpdateTimestamp)return E.getExaggeration(S);let O=S-this._previousZoom;const V=this._previousUpdateTimestamp;let H=S;this._evaluationZoom!=null&&(H=this._evaluationZoom,Math.abs(S-H)>.5&&(O=.5*(S-H+O)),O*b<0&&(H+=O)),this._evaluationZoom=H;const W=E.getExaggeration(H),J=W===E.getExaggeration(Math.max(0,H-.1));if(J&&Math.abs(W-this._exaggeration)<.01)return W;let ee=Math.min(.1,.00375*(this._updateTimestamp-V));return(J||W<.1||Math.abs(O)<1e-4)&&(ee=Math.min(.2,4*ee)),o.aa(this._exaggeration,W,ee)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(o.a5.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=l.getIds().map(V=>{const H=l.getTileByID(V).tileID;return H.projMatrix=p.calculateProjMatrix(H.toUnwrapped()),H});(function(V,H){const W=H.transform.pointCoordinate(H.transform.getCameraPoint()),J=new o.P(W.x,W.y);V.sort((ee,re)=>{if(re.overscaledZ-ee.overscaledZ)return re.overscaledZ-ee.overscaledZ;const ve=new o.P(ee.canonical.x+(1<<ee.canonical.z)*ee.wrap,ee.canonical.y),_e=new o.P(re.canonical.x+(1<<re.canonical.z)*re.wrap,re.canonical.y),xe=J.mult(1<<ee.canonical.z);return xe.x-=.5,xe.y-=.5,xe.distSqr(ve)-xe.distSqr(_e)})})(b,this.painter);const S=this.proxyToSource||{};this.proxyToSource={},b.forEach(V=>{this.proxyToSource[V.key]={}}),this.terrainTileForTile={};const E=this._style._mergedSourceCaches;for(const V in E){const H=E[V];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,r[V],S),H.usedForTerrain))continue;const W=r[V];H.getSource().reparseOverscaled&&this._assignTerrainTiles(W)}this.proxiedCoords[l.id]=b.map(V=>new Lm(V,V.key,this.orthoMatrix)),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1;const O={};this._visibleDemTiles=[];for(const V of this.proxyCoords){const H=this.terrainTileForTile[V.key];if(!H)continue;const W=H.tileID.key;W in O||(this._visibleDemTiles.push(H),O[W]=W)}}_assignTerrainTiles(r){this._initializing||r.forEach(l=>{if(this.terrainTileForTile[l.key])return;const p=this._findTileCoveringTileID(l,this.sourceCache);p&&(this.terrainTileForTile[l.key]=p)})}_prepareDEMTextures(){const r=this.painter.context,l=r.gl;for(const p in this.terrainTileForTile){const b=this.terrainTileForTile[p],S=b.dem;!S||b.demTexture&&!b.needsDEMTextureUpload||(r.activeTexture.set(l.TEXTURE1),sf(this.painter,b,S))}}_prepareDemTileUniforms(r,l,p,b){if(!l||l.demTexture==null)return!1;const S=r.tileID.canonical,E=Math.pow(2,l.tileID.canonical.z-S.z),O=b||"";return p[`u_dem_tl${O}`]=[S.x*E%1,S.y*E%1],p[`u_dem_scale${O}`]=E,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let r=0;const l=this._visibleDemTiles.reduce((p,b)=>{if(!b.dem)return p;const S=b.dem.tree.minimums[0];return S>0&&r++,p+S},0);return r?l/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,l=r.gl;r.activeTexture.set(l.TEXTURE2);const p=this._getLoadedAreaMinimum(),b=new o.cF({width:1,height:1},new Float32Array([p]));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(b,{premultiply:!1}):S=this._emptyDEMTexture=new o.T(r,b,l.R32F,{premultiply:!1}),S}setupElevationDraw(r,l,p){const b=this.painter.context,S=b.gl,E={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};E.u_exaggeration=this.exaggeration();let O=null,V=null,H=1;if(p&&p.morphing&&this._useVertexMorphing){const re=p.morphing.srcDemTile,ve=p.morphing.dstDemTile;H=p.morphing.phase,re&&ve&&(this._prepareDemTileUniforms(r,re,E,"_prev")&&(V=re),this._prepareDemTileUniforms(r,ve,E)&&(O=ve))}const W=re=>re&&re.demTexture&&this.painter.linearFloatFilteringSupported()?S.LINEAR:S.NEAREST;let J=null;var ee;if(this.enabled?V&&O?(J=O.demTexture,b.activeTexture.set(S.TEXTURE4),V.demTexture.bind(W(V),S.CLAMP_TO_EDGE),E.u_dem_lerp=H):(O=this.terrainTileForTile[r.tileID.key],J=this._prepareDemTileUniforms(r,O,E)?O.demTexture:this.emptyDEMTexture):J=this.emptyDEMTexture,b.activeTexture.set(S.TEXTURE2),J&&(E.u_dem_size=(ee=J).size[0]===1?1:ee.size[0]-2,J.bind(W(O),S.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(p&&p.useDepthForOcclusion,l,E),p&&p.useMeterToDem&&O){const re=(1<<O.tileID.canonical.z)*o.bD(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;E.u_meter_to_dem=re}if(p&&p.labelPlaneMatrixInv&&(E.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),l.setTerrainUniformValues(b,E),this.painter.transform.projection.name==="globe"){const re=this.globeUniformValues(this.painter.transform,r.tileID.canonical,p&&p.useDenormalizedUpVectorScale);l.setGlobeUniformValues(b,re)}}globeUniformValues(r,l,p){const b=r.projection;return{u_tile_tl_up:b.upVector(l,0,0),u_tile_tr_up:b.upVector(l,o.ab,0),u_tile_br_up:b.upVector(l,o.ab,o.ab),u_tile_bl_up:b.upVector(l,0,o.ab),u_tile_up_scale:p?o.cG(1):b.upVectorScale(l,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const l=this.painter,p=this.painter.context;r.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(b,S,E,O,V){if(b.transform.projection.name==="globe")(function(H,W,J,ee,re){const ve=H.context,_e=ve.gl;let xe,we;const ze=H.transform,Ne=o.cx(H,ve,ze),Le=(Ct,Kt)=>{if(we===Kt)return;const cn=[F_[Kt],"PROJECTION_GLOBE_VIEW"];Ne&&cn.push("CUSTOM_ANTIALIASING");const qt=H.isTileAffectedByFog(Ct);xe=H.getOrCreateProgram("globeRaster",{defines:cn,overrideFog:qt}),we=Kt},je=H.colorModeForRenderPass(),Ue=new or(_e.LEQUAL,or.ReadWrite,H.depthRangeFor3D);au.update(re);const rt=o.cy(ze),Qe=[o.am(ze.center.lng),o.at(ze.center.lat)],ot=H.globeSharedBuffers,gt=[ze.width*o.q.devicePixelRatio,ze.height*o.q.devicePixelRatio],ht=Float32Array.from(ze.globeMatrix),ct={useDenormalizedUpVectorScale:!0};{const Ct=H.transform,Kt=N_(Ct.zoom,W.exaggeration(),W.sourceCache._source.tileSize);we=-1;const cn=_e.TRIANGLES;for(const qt of ee){const yn=J.getTile(qt),Et=Mr.disabled,nn=W.prevTerrainTileForTile[qt.key],Qt=W.terrainTileForTile[qt.key];B_(nn,Qt)&&au.newMorphing(qt.key,nn,Qt,re,250),ve.activeTexture.set(_e.TEXTURE0),yn.texture&&yn.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const bn=au.getMorphValuesForProxy(qt.key),wn=bn?1:0;bn&&o.C(ct,{morphing:{srcDemTile:bn.from,dstDemTile:bn.to,phase:o.cw(bn.phase)}});const an=o.cz(qt.canonical),pn=o.cA(an.getCenter().lat),er=o.cB(qt.canonical,an,pn,Ct.worldSize/Ct._pixelsPerMercatorPixel),Mn=o.b5(o.cC(qt.canonical)),$n=z_(Ct.expandedFarZProjMatrix,ht,rt,Mn,o.a9(Ct.zoom),Qe,Ct.frustumCorners.TL,Ct.frustumCorners.TR,Ct.frustumCorners.BR,Ct.frustumCorners.BL,Ct.globeCenterInViewSpace,Ct.globeRadius,gt,Kt,Ct._farZ,er);if(Le(qt,wn),xe&&(W.setupElevationDraw(yn,xe,ct),H.uploadCommonUniforms(ve,xe,qt.toUnwrapped()),ot)){const[gr,Zn,lr]=ot.getGridBuffers(pn,Kt!==0);xe.draw(H,cn,Ue,Et,je,yr.backCCW,$n,"globe_raster",gr,Zn,lr)}}}if(ot&&(H.renderDefaultNorthPole||H.renderDefaultSouthPole)){const Ct=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ne&&Ct.push("CUSTOM_ANTIALIASING"),xe=H.getOrCreateProgram("globeRaster",{defines:Ct});for(const Kt of ee){const{x:cn,y:qt,z:yn}=Kt.canonical,Et=qt===0,nn=qt===(1<<yn)-1,[Qt,bn,wn,an]=ot.getPoleBuffers(yn,!1);if(an&&(Et||nn)){const pn=J.getTile(Kt);ve.activeTexture.set(_e.TEXTURE0),pn.texture&&pn.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);let er=o.cD(yn,cn,ze);const Mn=o.b5(o.cC(Kt.canonical)),$n=(gr,Zn)=>gr.draw(H,_e.TRIANGLES,Ue,Mr.disabled,je,yr.disabled,z_(ze.expandedFarZProjMatrix,er,er,Mn,0,Qe,ze.frustumCorners.TL,ze.frustumCorners.TR,ze.frustumCorners.BR,ze.frustumCorners.BL,ze.globeCenterInViewSpace,ze.globeRadius,gt,0,ze._farZ),"globe_pole_raster",Zn,wn,an);W.setupElevationDraw(pn,xe,ct),H.uploadCommonUniforms(ve,xe,Kt.toUnwrapped()),Et&&H.renderDefaultNorthPole&&$n(xe,Qt),nn&&H.renderDefaultSouthPole&&(er=o.a6.mat4.scale(o.a6.mat4.create(),er,[1,-1,1]),$n(xe,bn))}}}})(b,S,E,O,V);else{const H=b.context,W=H.gl;let J,ee;const re=b.shadowRenderer,ve=qa(b,b.longestCutoffRange),_e=je=>{if(ee===je)return;const Ue=[];Ue.push(F_[je]),ve.shouldRenderCutoff&&Ue.push("RENDER_CUTOFF"),J=b.getOrCreateProgram("terrainRaster",{defines:Ue}),ee=je},xe=b.colorModeForRenderPass(),we=new or(W.LEQUAL,or.ReadWrite,b.depthRangeFor3D);au.update(V);const ze=b.transform,Ne=N_(ze.zoom,S.exaggeration(),S.sourceCache._source.tileSize);let Le=[0,0,0];if(re){const je=b.style.directionalLight,Ue=b.style.ambientLight;je&&Ue&&(Le=Jh(b.style,je,Ue))}{ee=-1;const je=W.TRIANGLES,[Ue,rt]=[S.gridIndexBuffer,S.gridSegments];for(const Qe of O){const ot=E.getTile(Qe),gt=Mr.disabled,ht=S.prevTerrainTileForTile[Qe.key],ct=S.terrainTileForTile[Qe.key];B_(ht,ct)&&au.newMorphing(Qe.key,ht,ct,V,250),H.activeTexture.set(W.TEXTURE0),ot.texture&&ot.texture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const Ct=au.getMorphValuesForProxy(Qe.key),Kt=Ct?1:0;let cn;Ct&&(cn={morphing:{srcDemTile:Ct.from,dstDemTile:Ct.to,phase:o.cw(Ct.phase)}});const qt=b1(Qe.projMatrix,Dm(Qe.canonical,ze.renderWorldCopies)?Ne/10:Ne,Le);if(_e(Kt),!J)continue;S.setupElevationDraw(ot,J,cn);const yn=Qe.toUnwrapped();re&&re.setupShadows(yn,J),b.uploadCommonUniforms(H,J,yn,null,ve),J.draw(b,je,we,gt,xe,yr.backCCW,qt,"terrain_raster",S.gridBuffer,Ue,rt)}}}}(l,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const l=this.painter,p=this.painter.context,b=this.proxySourceCache,S=this.proxiedCoords[b.id],E=this._drapedRenderBatches.shift(),O=l.style.order,V=[];let H=0;for(const W of S){const J=b.getTileByID(W.proxyTileKey),ee=b.proxyCachedFBO[W.key]?b.proxyCachedFBO[W.key][r]:void 0,re=ee!==void 0?b.renderCache[ee]:this.pool[H++],ve=ee!==void 0;if(J.texture=re.tex,ve&&!re.dirty){V.push(J.tileID);continue}let _e;p.bindFramebuffer.set(re.fb.framebuffer),this.renderedToTile=!1,re.dirty&&(p.clear({color:o.bz.transparent,stencil:0}),re.dirty=!1);for(let xe=E.start;xe<=E.end;++xe){const we=l.style._mergedLayers[O[xe]];if(we.isHidden(l.transform.zoom))continue;const ze=l.style.getLayerSourceCache(we),Ne=ze?this.proxyToSource[W.key][ze.id]:[W];if(!Ne)continue;const Le=Ne;p.viewport.set([0,0,re.fb.width,re.fb.height]),_e!==(ze?ze.id:null)&&(this._setupStencil(re,Ne,we,ze),_e=ze?ze.id:null),l.renderLayer(l,ze,we,Le)}if(this._drapedRenderBatches.length===0)for(const xe of this._pendingGroundEffectLayers){const we=l.style._mergedLayers[O[xe]];if(we.isHidden(l.transform.zoom))continue;const ze=l.style.getLayerSourceCache(we),Ne=ze?this.proxyToSource[W.key][ze.id]:[W];if(!Ne)continue;const Le=Ne;p.viewport.set([0,0,re.fb.width,re.fb.height]),_e!==(ze?ze.id:null)&&(this._setupStencil(re,Ne,we,ze),_e=ze?ze.id:null),l.renderLayer(l,ze,we,Le)}this.renderedToTile?(re.dirty=!0,V.push(J.tileID)):ve||--H,H===5&&(H=0,this.renderToBackBuffer(V))}return this.renderToBackBuffer(V),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),E.end+1}postRender(){}isLayerOrderingCorrect(r){const l=r.order.length;let p=-1,b=l;for(let S=0;S<l;++S)this._style.isLayerDraped(r._mergedLayers[r.order[S]])?p=Math.max(p,S):b=Math.min(b,S);return b>p}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{r=Math.min(r,l.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,l,p){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter(S=>S.dem).map(S=>{const E=S.tileID,O=1<<E.overscaledZ,{x:V,y:H}=E.canonical,W=V/O,J=(V+1)/O,ee=H/O,re=(H+1)/O;return{minx:W,miny:ee,maxx:J,maxy:re,t:S.dem.tree.raycastRoot(W,ee,J,re,r,l,p),tile:S}});b.sort((S,E)=>(S.t!==null?S.t:Number.MAX_VALUE)-(E.t!==null?E.t:Number.MAX_VALUE));for(const S of b){if(S.t==null)return null;const E=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,r,l,p);if(E!=null)return E}return null}_createFBO(){const r=this.painter.context,l=r.gl,p=this.drapeBufferSize;r.activeTexture.set(l.TEXTURE0);const b=new o.T(r,{width:p[0],height:p[1],data:null},l.RGBA8);b.bind(l.LINEAR,l.CLAMP_TO_EDGE);const S=r.createFramebuffer(p[0],p[1],!0,null);return S.colorAttachment.set(b.texture),S.depthAttachment=new su(r,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:S,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const l=this._style._mergedLayers[r],p=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!p&&l.shouldRedrape():!p&&l.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const p of this._style.getSources())if(p instanceof Nh){r=!0;break}if(!r)return;const l={};for(let p=0;p<this._style.order.length;++p){const b=this._style._mergedLayers[this._style.order[p]],S=this._style.getLayerSourceCache(b);if(S&&!l[S.id]&&!b.isHidden(this.painter.transform.zoom)&&b.type==="line"&&b.widthExpression()instanceof o.a4){l[S.id]=!0;for(const E of this.proxyCoords){const O=this.proxyToSource[E.key][S.id];if(O)for(const V of O)this._clearRenderCacheForTile(S.id,V)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const p in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[p]._source instanceof fd){r=!0;break}if(!r)return;const l={};for(let p=0;p<this._style.order.length;++p){const b=this._style._mergedLayers[this._style.order[p]],S=this._style.getLayerSourceCache(b);if(!S||l[S.id]||b.isHidden(this.painter.transform.zoom)||b.type!=="raster")continue;const E=b.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const V=this.proxyToSource[O.key][S.id];if(V)for(const H of V){const W=hf(S.getTile(H),S.findLoadedParent(H,0),S,this.painter.transform,E);(W.opacity!==1||W.mix!==0)&&this._clearRenderCacheForTile(S.id,H)}}}}_setupDrapedRenderBatches(){const r=this._style.order,l=r.length;if(l===0)return;const p=[];this._pendingGroundEffectLayers=[];let b,S=0,E=this._style._mergedLayers[r[S]];for(;!this._style.isLayerDraped(E)&&E.isHidden(this.painter.transform.zoom)&&++S<l;)E=this._style._mergedLayers[r[S]];for(;S<l;++S){const O=this._style._mergedLayers[r[S]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?b===void 0&&(b=S):(O.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(S),b!==void 0&&(p.push({start:b,end:S-1}),b=void 0)))}if(b!==void 0&&p.push({start:b,end:S-1}),p.length!==0){const O=p[p.length-1];this._pendingGroundEffectLayers.every(V=>V>O.end)||o.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=p}_setupRenderCache(r){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const E=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let O=0;O<E.length;++O){const V=Object.values(E[O]);l.renderCachePool.push(...V)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,b=this._tilesDirty;for(let E=p.length-1;E>=0;E--){const O=p[E];if(l.getTileByID(O.key),l.proxyCachedFBO[O.key]!==void 0){const V=r[O.key],H=this.proxyToSource[O.key];let W=0;for(const J in H){const ee=H[J],re=V[J];if(!re||re.length!==ee.length||ee.some((ve,_e)=>ve!==re[_e]||b[J]&&b[J].hasOwnProperty(ve.key))){W=-1;break}++W}for(const J in l.proxyCachedFBO[O.key])l.renderCache[l.proxyCachedFBO[O.key][J]].dirty=W<0||W!==Object.values(V).length}}const S=[...this._drapedRenderBatches];S.sort((E,O)=>O.end-O.start-(E.end-E.start));for(const E of S)for(const O of p){if(l.proxyCachedFBO[O.key])continue;let V=l.renderCachePool.pop();V===void 0&&l.renderCache.length<50&&(V=l.renderCache.length,l.renderCache.push(this._createFBO())),V!==void 0&&(l.proxyCachedFBO[O.key]={},l.proxyCachedFBO[O.key][E.start]=V,l.renderCache[V].dirty=!0)}this._tilesDirty={}}_setupStencil(r,l,p,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,E=S.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let O;if(p.isTileClipped())O=l.length,this._overlapStencilMode.test={func:E.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:E.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):Mr.disabled}_renderTileClippingMasks(r,l){const p=this.painter,b=this.painter.context,S=b.gl;p._tileClippingMaskIDs={},b.setColorMode(Ur.disabled),b.setDepthMode(or.disabled);const E=p.getOrCreateProgram("clippingMask");for(const O of r){const V=p._tileClippingMaskIDs[O.key]=--l;E.draw(p,S.TRIANGLES,or.disabled,new Mr({func:S.ALWAYS,mask:0},V,255,S.KEEP,S.KEEP,S.REPLACE),Ur.disabled,yr.disabled,kd(O.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(r){const l=this.painter.transform;if(r.x<0||r.x>l.width||r.y<0||r.y>l.height)return null;const p=[r.x,r.y,1,1];o.a6.vec4.transformMat4(p,p,l.pixelMatrixInverse),o.a6.vec4.scale(p,p,1/p[3]),p[0]/=l.worldSize,p[1]/=l.worldSize;const b=l._camera.position,S=o.bD(1,l.center.lat),E=[b[0],b[1],b[2]/S,0],O=o.a6.vec3.subtract([],p.slice(0,3),E);o.a6.vec3.normalize(O,O);const V=this.raycast(E,O,this._exaggeration);return V!==null&&V?(o.a6.vec3.scaleAndAdd(E,E,O,V),E[3]=E[2],E[2]*=S,E):null}_setupProxiedCoordsForOrtho(r,l,p){if(r.getSource()instanceof o.aD)return this._setupProxiedCoordsForImageSource(r,l,p);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const b=this.proxiedCoords[r.id]=[],S=this.proxyCoords;for(let V=0;V<S.length;V++){const H=S[V],W=this._findTileCoveringTileID(H,r);if(W){const J=this._createProxiedId(H,W,p[H.key]&&p[H.key][r.id]);b.push(J),this.proxyToSource[H.key][r.id]=[J]}}let E=!1;const O=new Set;for(let V=0;V<l.length;V++){const H=r.getTile(l[V]);if(!H||!H.hasData())continue;const W=this._findTileCoveringTileID(H.tileID,this.proxySourceCache);if(W&&W.tileID.canonical.z!==H.tileID.canonical.z){const J=this.proxyToSource[W.tileID.key][r.id],ee=this._createProxiedId(W.tileID,H,p[W.tileID.key]&&p[W.tileID.key][r.id]);J?J.splice(J.length-1,0,ee):this.proxyToSource[W.tileID.key][r.id]=[ee];const re=this.proxyToSource[W.tileID.key][r.id];O.has(re)||O.add(re),b.push(ee),E=!0}}if(this._sourceTilesOverlap[r.id]=E,E&&this._debugParams.sortTilesHiZFirst)for(const V of O)V.sort((H,W)=>W.overscaledZ-H.overscaledZ)}_setupProxiedCoordsForImageSource(r,l,p){if(!r.getSource().loaded())return;const b=this.proxiedCoords[r.id]=[],S=this.proxyCoords,E=r.getSource(),O=E.tileID;if(!O)return;const V=new o.P(O.x,O.y)._div(1<<O.z),H=E.coordinates.map(o.a5.fromLngLat).reduce((J,ee)=>(J.min.x=Math.min(J.min.x,ee.x-V.x),J.min.y=Math.min(J.min.y,ee.y-V.y),J.max.x=Math.max(J.max.x,ee.x-V.x),J.max.y=Math.max(J.max.y,ee.y-V.y),J),{min:new o.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),W=(J,ee)=>{const re=J.wrap+J.canonical.x/(1<<J.canonical.z),ve=J.canonical.y/(1<<J.canonical.z),_e=o.ab/(1<<J.canonical.z),xe=ee.wrap+ee.canonical.x/(1<<ee.canonical.z),we=ee.canonical.y/(1<<ee.canonical.z);return re+_e<xe+H.min.x||re>xe+H.max.x||ve+_e<we+H.min.y||ve>we+H.max.y};for(let J=0;J<S.length;J++){const ee=S[J];for(let re=0;re<l.length;re++){const ve=r.getTile(l[re]);if(!ve||!ve.hasData()||W(ee,ve.tileID))continue;const _e=this._createProxiedId(ee,ve,p[ee.key]&&p[ee.key][r.id]),xe=this.proxyToSource[ee.key][r.id];xe?xe.push(_e):this.proxyToSource[ee.key][r.id]=[_e],b.push(_e)}}}_createProxiedId(r,l,p){let b=this.orthoMatrix;if(p){const S=p.find(E=>E.key===l.tileID.key);if(S)return S}if(l.tileID.key!==r.key){const S=r.canonical.z-l.tileID.canonical.z;let E,O,V;b=o.a6.mat4.create();const H=l.tileID.wrap-r.wrap<<r.overscaledZ;S>0?(E=o.ab>>S,O=E*((l.tileID.canonical.x<<S)-r.canonical.x+H),V=E*((l.tileID.canonical.y<<S)-r.canonical.y)):(E=o.ab<<-S,O=o.ab*(l.tileID.canonical.x-(r.canonical.x+H<<-S)),V=o.ab*(l.tileID.canonical.y-(r.canonical.y<<-S))),o.a6.mat4.ortho(b,0,E,0,E,0,1),o.a6.mat4.translate(b,b,[O,V,0])}return new Lm(l.tileID,r.key,b)}_findTileCoveringTileID(r,l){let p=l.getTile(r);if(p&&p.hasData())return p;const b=this._findCoveringTileCache[l.id],S=b[r.key];if(p=S?l.getTileByID(S):null,p&&p.hasData()||S===null)return p;let E=p?p.tileID:r,O=E.overscaledZ;const V=l.getSource().minzoom,H=[];if(!S){const J=l.getSource().maxzoom;if(r.canonical.z>=J){const ee=r.canonical.z-J;l.getSource().reparseOverscaled?(O=Math.max(r.canonical.z+2,l.transform.tileZoom),E=new o.aA(O,r.wrap,J,r.canonical.x>>ee,r.canonical.y>>ee)):ee!==0&&(O=J,E=new o.aA(O,r.wrap,J,r.canonical.x>>ee,r.canonical.y>>ee))}E.key!==r.key&&(H.push(E.key),p=l.getTile(E))}const W=J=>{H.forEach(ee=>{b[ee]=J}),H.length=0};for(O-=1;O>=V&&(!p||!p.hasData());O--){p&&W(p.tileID.key);const J=E.calculateScaledKey(O);if(p=l.getTileByID(J),p&&p.hasData())break;const ee=b[J];if(ee===null)break;ee===void 0?H.push(J):p=l.getTileByID(ee)}return W(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,l){let p=this._tilesDirty[r];p||(p=this._tilesDirty[r]={}),p[l.key]=!0}}function zm(f,r,l){const p=function(O,V,H){const W=o.a6.vec3.dot(V,O),J=o.a6.vec3.dot(H,[.2126,.7152,.0722]),ee=(ve,_e,xe)=>(1-xe)*ve+xe*_e,re=ee(1-.3*Math.min(J,1),1,Math.min(W+1,1));return ee(.92,1,Math.asin(o.ap(V[2],-1,1))/Math.PI+.5)*re}(f,[0,0,1],r),b=[0,0,0];o.a6.vec3.scale(b,l.slice(0,3),p);const S=[0,0,0];o.a6.vec3.scale(S,r.slice(0,3),f[2]);const E=[0,0,0];return o.a6.vec3.add(E,b,S),o.cb(E)}const uc=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],V_=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class kl{static cacheKey(r,l,p,b){let S=`${l}${b?b.cacheKey:""}`;for(const E of p)r.usedDefines.includes(E)&&(S+=`/${E}`);return S}constructor(r,l,p,b,S,E){const O=r.gl;this.program=O.createProgram(),this.configuration=b,this.name=l,this.fixedDefines=[...E];const V=b?b.getBinderAttributes():[],H=(p.staticAttributes||[]).concat(V);let W=b?b.defines():[];W=W.concat(E.map(xe=>`#define ${xe}`));const J=`#version 300 es
`;let ee=J+W.concat("precision mediump float;",rf,wd.fragmentSource).join(`
`);for(const xe of p.fragmentIncludes)ee+=`
${xd[xe]}`;ee+=`
${p.fragmentSource}`;let re=J+W.concat("precision highp float;",rf,wd.vertexSource).join(`
`);for(const xe of p.vertexIncludes)re+=`
${xd[xe]}`;re+=`
${p.vertexSource}`;const ve=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(ve,ee),O.compileShader(ve),O.attachShader(this.program,ve);const _e=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(_e,re),O.compileShader(_e),O.attachShader(this.program,_e),this.attributes={},this.numAttributes=H.length;for(let xe=0;xe<this.numAttributes;xe++)if(H[xe]){const we=H[xe].startsWith("a_")?H[xe]:`a_${H[xe]}`;O.bindAttribLocation(this.program,xe,we),this.attributes[we]=xe}O.linkProgram(this.program),O.deleteShader(_e),O.deleteShader(ve),this.fixedUniforms=S(r),this.binderUniforms=b?b.getUniforms(r):[],(E.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(xe=>({u_dem:new o.bJ(xe),u_dem_prev:new o.bJ(xe),u_dem_tl:new o.bG(xe),u_dem_scale:new o.bI(xe),u_dem_tl_prev:new o.bG(xe),u_dem_scale_prev:new o.bI(xe),u_dem_size:new o.bI(xe),u_dem_lerp:new o.bI(xe),u_exaggeration:new o.bI(xe),u_depth:new o.bJ(xe),u_depth_size_inv:new o.bG(xe),u_depth_range_unpack:new o.bG(xe),u_occluder_half_size:new o.bI(xe),u_occlusion_depth_offset:new o.bI(xe),u_meter_to_dem:new o.bI(xe),u_label_plane_matrix_inv:new o.bF(xe)}))(r)),E.includes("GLOBE")&&(this.globeUniforms=(xe=>({u_tile_tl_up:new o.bH(xe),u_tile_tr_up:new o.bH(xe),u_tile_br_up:new o.bH(xe),u_tile_bl_up:new o.bH(xe),u_tile_up_scale:new o.bI(xe)}))(r)),E.includes("FOG")&&(this.fogUniforms=(xe=>({u_fog_matrix:new o.bF(xe),u_fog_range:new o.bG(xe),u_fog_color:new o.c6(xe),u_fog_horizon_blend:new o.bI(xe),u_fog_vertical_limit:new o.bG(xe),u_fog_temporal_offset:new o.bI(xe),u_frustum_tl:new o.bH(xe),u_frustum_tr:new o.bH(xe),u_frustum_br:new o.bH(xe),u_frustum_bl:new o.bH(xe),u_globe_pos:new o.bH(xe),u_globe_radius:new o.bI(xe),u_globe_transition:new o.bI(xe),u_is_globe:new o.bJ(xe),u_viewport:new o.bG(xe)}))(r)),E.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(xe=>({u_cutoff_params:new o.c6(xe)}))(r)),E.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(xe=>({u_lighting_ambient_color:new o.bH(xe),u_lighting_directional_dir:new o.bH(xe),u_lighting_directional_color:new o.bH(xe),u_ground_radiance:new o.bH(xe)}))(r)),E.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(xe=>({u_light_matrix_0:new o.bF(xe),u_light_matrix_1:new o.bF(xe),u_fade_range:new o.bG(xe),u_shadow_normal_offset:new o.bH(xe),u_shadow_intensity:new o.bI(xe),u_shadow_texel_size:new o.bI(xe),u_shadow_map_resolution:new o.bI(xe),u_shadow_direction:new o.bH(xe),u_shadow_bias:new o.bH(xe),u_shadowmap_0:new o.bJ(xe),u_shadowmap_1:new o.bJ(xe)}))(r))}}setTerrainUniformValues(r,l){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b]&&p[b].set(this.program,b,l[b])}}setGlobeUniformValues(r,l){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b]&&p[b].set(this.program,b,l[b])}}setFogUniformValues(r,l){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b].set(this.program,b,l[b])}}setCutoffUniformValues(r,l){if(!this.cutoffUniforms)return;const p=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b].set(this.program,b,l[b])}}setLightsUniformValues(r,l){if(!this.lightsUniforms)return;const p=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b].set(this.program,b,l[b])}}setShadowUniformValues(r,l){if(this.failedToCreate||!this.shadowUniforms)return;const p=this.shadowUniforms;r.program.set(this.program);for(const b in l)p[b].set(this.program,b,l[b])}_drawDebugWireframe(r,l,p,b,S,E,O,V,H,W){const J=r.options.wireframe;if(J.terrain===!1&&J.layers2D===!1&&J.layers3D===!1)return;const ee=r.context;if(!(!(!J.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!J.layers2D||r._terrain&&r._terrain.renderingToTexture||!uc.includes(this.name))||!(!J.layers3D||!V_.includes(this.name))))return;const re=ee.gl,ve=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,S,ee);if(!ve)return;const _e=[...this.fixedDefines];_e.push("DEBUG_WIREFRAME");const xe=r.getOrCreateProgram(this.name,{config:this.configuration,defines:_e});ee.program.set(xe.program);const we=(Le,je,Ue)=>{if(je[Le]&&Ue[Le])for(const rt in je[Le])Ue[Le][rt]&&Ue[Le][rt].set(Ue.program,rt,je[Le][rt].current)};H&&H.setUniforms(xe.program,ee,xe.binderUniforms,O,{zoom:V}),we("fixedUniforms",this,xe),we("terrainUniforms",this,xe),we("globeUniforms",this,xe),we("fogUniforms",this,xe),we("lightsUniforms",this,xe),we("shadowUniforms",this,xe),ve.bind(),ee.setColorMode(new Ur([re.ONE,re.ONE_MINUS_SRC_ALPHA,re.ZERO,re.ONE],o.bz.transparent,[!0,!0,!0,!1])),ee.setDepthMode(new or(l.func===re.LESS?re.LEQUAL:l.func,or.ReadOnly,l.range)),ee.setStencilMode(Mr.disabled);const ze=3*E.primitiveLength*2,Ne=3*E.primitiveOffset*2*2;W&&W>1?re.drawElementsInstanced(re.LINES,ze,re.UNSIGNED_SHORT,Ne,W):re.drawElements(re.LINES,ze,re.UNSIGNED_SHORT,Ne),S.bind(),ee.program.set(this.program),ee.setDepthMode(l),ee.setStencilMode(p),ee.setColorMode(b)}draw(r,l,p,b,S,E,O,V,H,W,J,ee,re,ve,_e,xe){const we=r.context,ze=we.gl;if(this.failedToCreate)return;we.program.set(this.program),we.setDepthMode(p),we.setStencilMode(b),we.setColorMode(S),we.setCullFace(E);for(const je of Object.keys(this.fixedUniforms))this.fixedUniforms[je].set(this.program,je,O[je]);ve&&ve.setUniforms(this.program,we,this.binderUniforms,ee,{zoom:re});const Ne={[ze.POINTS]:1,[ze.LINES]:2,[ze.TRIANGLES]:3,[ze.LINE_STRIP]:1}[l],Le=xe&&xe>0?1:void 0;for(const je of J.get()){const Ue=je.vaos||(je.vaos={});(Ue[V]||(Ue[V]=new ou)).bind(we,this,H,ve?ve.getPaintVertexBuffers():[],W,je.vertexOffset,_e||[],Le),xe&&xe>1?ze.drawElementsInstanced(l,je.primitiveLength*Ne,ze.UNSIGNED_SHORT,je.primitiveOffset*Ne*2,xe):W?ze.drawElements(l,je.primitiveLength*Ne,ze.UNSIGNED_SHORT,je.primitiveOffset*Ne*2):ze.drawArrays(l,je.vertexOffset,je.vertexLength),l===ze.TRIANGLES&&W&&this._drawDebugWireframe(r,p,b,S,W,je,ee,re,ve,xe)}}}function Bm(f,r){const l=Math.pow(2,r.tileID.overscaledZ),p=r.tileSize*Math.pow(2,f.transform.tileZoom)/l,b=p*(r.tileID.canonical.x+r.tileID.wrap*l),S=p*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/o.ak(r,1,f.transform.tileZoom),u_pixel_coord_upper:[b>>16,S>>16],u_pixel_coord_lower:[65535&b,65535&S]}}const ff=o.a6.mat4.create(),Fm=(f,r,l,p,b,S,E,O,V,H,W,J,ee,re,ve,_e)=>{const xe=r.style.light,we=xe.properties.get("position"),ze=[we.x,we.y,we.z],Ne=o.a6.mat3.create();xe.properties.get("anchor")==="viewport"&&(o.a6.mat3.fromRotation(Ne,-r.transform.angle),o.a6.vec3.transformMat3(ze,ze,Ne));const Le=xe.properties.get("color"),je=r.transform,Ue={u_matrix:f,u_lightpos:ze,u_lightintensity:xe.properties.get("intensity"),u_lightcolor:[Le.r,Le.g,Le.b],u_vertical_gradient:+l,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ff,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:b,u_edge_radius:S,u_width_scale:E,u_flood_light_color:ee,u_vertical_scale:re,u_flood_light_intensity:ve,u_ground_shadow_factor:_e};return je.projection.name==="globe"&&(Ue.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],Ue.u_zoom_transition=H,Ue.u_inv_rot_matrix=J,Ue.u_merc_center=W,Ue.u_up_dir=je.projection.upVector(new o.bP(0,0,0),W[0]*o.ab,W[1]*o.ab),Ue.u_height_lift=V),Ue},U_=(f,r,l,p)=>({u_matrix:f,u_edge_radius:r,u_width_scale:l,u_vertical_scale:p}),Nm=(f,r,l,p,b,S,E,O,V,H,W,J,ee,re,ve)=>{const _e=Fm(f,r,l,p,b,S,E,O,H,W,J,ee,re,ve,1,[0,0,0]),xe={u_height_factor:-Math.pow(2,O.overscaledZ)/V.tileSize/8};return o.l(_e,Bm(r,V),xe)},pf=(f,r)=>({u_matrix:f,u_emissive_strength:r}),j_=(f,r,l,p)=>o.l(pf(f,r),Bm(l,p)),H_=(f,r,l)=>({u_matrix:f,u_world:l,u_emissive_strength:r}),Ad=(f,r,l,p,b)=>o.l(j_(f,r,l,p),{u_world:b}),x1=(f,r,l,p)=>{const b=o.ab/l.tileSize;return{u_matrix:f,u_camera_to_center_distance:r.getCameraToCenterDistance(p),u_extrude_scale:[r.pixelsToGLUnits[0]/b,r.pixelsToGLUnits[1]/b]}},G_=(f,r,l=1)=>({u_matrix:f,u_color:r.toRenderColor(null),u_overlay:0,u_overlay_scale:l}),W_=o.a6.mat4.create(),w1=(f,r,l,p,b,S,E)=>{const O=f.transform,V=O.projection.name==="globe",H=V?o.cI(O.zoom,r.canonical)*O._pixelsPerMercatorPixel:o.ak(l,1,S),W={u_matrix:r.projMatrix,u_extrude_scale:H,u_intensity:E,u_inv_rot_matrix:W_,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(V){W.u_inv_rot_matrix=p,W.u_merc_center=b,W.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],W.u_zoom_transition=o.a9(O.zoom);const J=b[0]*o.ab,ee=b[1]*o.ab;W.u_up_dir=O.projection.upVector(new o.bP(0,0,0),J,ee)}return W};function mf(f,[r,l,p,b],[S,E]){if(S===E)return[0,0,0,0];const O=255*(f-1)/(f*(E-S));return[r*O,l*O,p*O,b*O]}function gf(f,r,[l,p]){return l===p?0:.5/f+(r-l)*(f-1)/(f*(p-l))}const Pd=(f,r,l,p,b,S,E,O,V,H,W,J,ee,re,ve,_e,xe,we,ze,Ne,Le)=>({u_matrix:f,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:p,u_grid_matrix:b,u_tl_parent:S,u_scale_parent:H,u_fade_t:W.mix,u_opacity:W.opacity*J.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:J.paint.get("raster-brightness-min"),u_brightness_high:J.paint.get("raster-brightness-max"),u_saturation_factor:o.cJ(J.paint.get("raster-saturation")),u_contrast_factor:o.cK(J.paint.get("raster-contrast")),u_spin_weights:$m(J.paint.get("raster-hue-rotate")),u_perspective_transform:ee,u_raster_elevation:re,u_zoom_transition:E,u_merc_center:O,u_cutoff_params:V,u_colorization_mix:mf(o.cL,_e,we),u_colorization_offset:gf(o.cL,xe,we),u_color_ramp:ve,u_texture_offset:[Ne/(ze+2*Ne),ze/(ze+2*Ne)],u_texture_res:[ze+2*Ne,ze+2*Ne],u_emissive_strength:Le});function $m(f){f*=Math.PI/180;const r=Math.sin(f),l=Math.cos(f);return[(2*l+1)/3,(-Math.sqrt(3)*r-l+1)/3,(Math.sqrt(3)*r-l+1)/3]}const Sa=.05,q_=(f,r,l,p,b,S,E,O,V,H,W,J)=>({u_matrix:f,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:p,u_grid_matrix:b,u_tl_parent:S,u_scale_parent:H,u_fade_t:W.mix,u_opacity:W.opacity,u_image0:0,u_image1:1,u_raster_elevation:J,u_zoom_transition:E,u_merc_center:O,u_cutoff_params:V}),vf=(f,r,l,p,b,S,E,O,V,H)=>({u_particle_texture:f,u_particle_texture_side_len:r,u_tile_offset:l,u_velocity:p,u_color_ramp:S,u_velocity_res:b,u_max_speed:E,u_uv_offset:O,u_data_scale:[255*V[0],255*V[1]],u_data_offset:H,u_particle_pos_scale:1.1,u_particle_pos_offset:[Sa,Sa]}),_f=(f,r,l,p,b,S,E,O,V,H)=>({u_particle_texture:f,u_particle_texture_side_len:r,u_velocity:l,u_velocity_res:p,u_max_speed:b,u_speed_factor:S,u_reset_rate:E,u_rand_seed:Math.random(),u_uv_offset:O,u_data_scale:[255*V[0],255*V[1]],u_data_offset:H,u_particle_pos_scale:1.1,u_particle_pos_offset:[Sa,Sa]}),yf=o.a6.mat4.create(),Vm=(f,r,l,p,b,S,E,O,V,H,W,J,ee,re,ve,_e,xe,we,ze,Ne,Le)=>{const je=b.transform,Ue={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:je.getCameraToCenterDistance(ze),u_rotate_symbol:+l,u_aspect_ratio:je.width/je.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:E,u_coord_matrix:O,u_is_text:+H,u_elevation_from_sea:V?1:0,u_pitch_with_map:+p,u_texsize:W,u_texsize_icon:J,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:yf,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:yf,u_up_vector:[0,-1,0],u_color_adj_mat:Ne,u_icon_transition:Le||0,u_gamma_scale:p?b.transform.getCameraToCenterDistance(ze)*Math.cos(b.terrain?0:b.transform._pitch):1,u_device_pixel_ratio:o.q.devicePixelRatio,u_is_halo:+ee};return ze.name==="globe"&&(Ue.u_tile_id=[re.canonical.x,re.canonical.y,1<<re.canonical.z],Ue.u_zoom_transition=ve,Ue.u_inv_rot_matrix=xe,Ue.u_merc_center=_e,Ue.u_camera_forward=je._camera.forward(),Ue.u_ecef_origin=o.cM(je.globeMatrix,re.toUnwrapped()),Ue.u_tile_matrix=Float32Array.from(je.globeMatrix),Ue.u_up_vector=we),Ue},K_=(f,r,l,p)=>({u_matrix:f,u_emissive_strength:r,u_opacity:l,u_color:p}),dc=(f,r,l,p,b,S,E,O,V)=>o.l(function(H,W,J,ee,re,ve){const{width:_e,height:xe}=ee.imageManager.getPixelSize(W),we=Math.pow(2,ve.tileID.overscaledZ),ze=ve.tileSize*Math.pow(2,ee.transform.tileZoom)/we,Ne=ze*(ve.tileID.canonical.x+ve.tileID.wrap*we),Le=ze*ve.tileID.canonical.y;return{u_image:0,u_pattern_tl:J.tl,u_pattern_br:J.br,u_texsize:[_e,xe],u_pattern_size:J.displaySize,u_pattern_units_to_pixels:re?[ee.transform.width,-1*ee.transform.height]:[1/o.ak(ve,1,ee.transform.tileZoom),1/o.ak(ve,1,ee.transform.tileZoom)],u_pixel_coord_upper:[Ne>>16,Le>>16],u_pixel_coord_lower:[65535&Ne,65535&Le]}}(0,S,E,p,O,V),{u_matrix:f,u_emissive_strength:r,u_opacity:l}),cu=new Float32Array(o.a6.mat4.identity([])),Gn=(f,r,l,p,b,S,E,O,V,H,W,J,ee,re=[0,0,0],ve)=>{const _e=b.style.light,xe=_e.properties.get("position"),we=[-xe.x,-xe.y,xe.z],ze=o.a6.mat3.create();_e.properties.get("anchor")==="viewport"&&(o.a6.mat3.fromRotation(ze,-b.transform.angle),o.a6.vec3.transformMat3(we,we,ze));const Ne=W.alphaMode==="MASK",Le=_e.properties.get("color").toRenderColor(null),je=ee.paint.get("model-ambient-occlusion-intensity"),Ue=ee.paint.get("model-color").constantOr(o.bz.white).toRenderColor(null),rt=ee.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:f,u_lighting_matrix:r,u_normal_matrix:l,u_node_matrix:p||cu,u_lightpos:we,u_lightintensity:_e.properties.get("intensity"),u_lightcolor:[Le.r,Le.g,Le.b],u_camera_pos:re,u_opacity:S,u_baseTextureIsAlpha:0,u_alphaMask:+Ne,u_alphaCutoff:W.alphaCutoff,u_baseColorFactor:[E.r,E.g,E.b,E.a],u_emissiveFactor:[O[0],O[1],O[2],1],u_metallicFactor:V,u_roughnessFactor:H,u_baseColorTexture:Pi.BaseColor,u_metallicRoughnessTexture:Pi.MetallicRoughness,u_normalTexture:Pi.Normal,u_occlusionTexture:Pi.Occlusion,u_emissionTexture:Pi.Emission,u_lutTexture:Pi.LUT,u_color_mix:[Ue.r,Ue.g,Ue.b,rt],u_aoIntensity:je,u_emissive_strength:J,u_occlusionTextureTransform:ve||[0,0,0,0]}},Um=(f,r=cu,l=cu)=>({u_matrix:f,u_instance:r,u_node_matrix:l}),Z_={fillExtrusion:f=>({u_matrix:new o.bF(f),u_lightpos:new o.bH(f),u_lightintensity:new o.bI(f),u_lightcolor:new o.bH(f),u_vertical_gradient:new o.bI(f),u_opacity:new o.bI(f),u_edge_radius:new o.bI(f),u_width_scale:new o.bI(f),u_ao:new o.bG(f),u_tile_id:new o.bH(f),u_zoom_transition:new o.bI(f),u_inv_rot_matrix:new o.bF(f),u_merc_center:new o.bG(f),u_up_dir:new o.bH(f),u_height_lift:new o.bI(f),u_flood_light_color:new o.bH(f),u_vertical_scale:new o.bI(f),u_flood_light_intensity:new o.bI(f),u_ground_shadow_factor:new o.bH(f)}),fillExtrusionDepth:f=>({u_matrix:new o.bF(f),u_edge_radius:new o.bI(f),u_width_scale:new o.bI(f),u_vertical_scale:new o.bI(f)}),fillExtrusionPattern:f=>({u_matrix:new o.bF(f),u_lightpos:new o.bH(f),u_lightintensity:new o.bI(f),u_lightcolor:new o.bH(f),u_vertical_gradient:new o.bI(f),u_height_factor:new o.bI(f),u_edge_radius:new o.bI(f),u_width_scale:new o.bI(f),u_ao:new o.bG(f),u_tile_id:new o.bH(f),u_zoom_transition:new o.bI(f),u_inv_rot_matrix:new o.bF(f),u_merc_center:new o.bG(f),u_up_dir:new o.bH(f),u_height_lift:new o.bI(f),u_image:new o.bJ(f),u_texsize:new o.bG(f),u_pixel_coord_upper:new o.bG(f),u_pixel_coord_lower:new o.bG(f),u_tile_units_to_pixels:new o.bI(f),u_opacity:new o.bI(f)}),fillExtrusionGroundEffect:f=>({u_matrix:new o.bF(f),u_opacity:new o.bI(f),u_ao_pass:new o.bI(f),u_meter_to_tile:new o.bI(f),u_ao:new o.bG(f),u_flood_light_intensity:new o.bI(f),u_flood_light_color:new o.bH(f),u_attenuation:new o.bI(f),u_edge_radius:new o.bI(f),u_fb:new o.bJ(f),u_fb_size:new o.bI(f),u_dynamic_offset:new o.bI(f)}),fill:f=>({u_matrix:new o.bF(f),u_emissive_strength:new o.bI(f)}),fillPattern:f=>({u_matrix:new o.bF(f),u_emissive_strength:new o.bI(f),u_image:new o.bJ(f),u_texsize:new o.bG(f),u_pixel_coord_upper:new o.bG(f),u_pixel_coord_lower:new o.bG(f),u_tile_units_to_pixels:new o.bI(f)}),fillOutline:f=>({u_matrix:new o.bF(f),u_emissive_strength:new o.bI(f),u_world:new o.bG(f)}),fillOutlinePattern:f=>({u_matrix:new o.bF(f),u_emissive_strength:new o.bI(f),u_world:new o.bG(f),u_image:new o.bJ(f),u_texsize:new o.bG(f),u_pixel_coord_upper:new o.bG(f),u_pixel_coord_lower:new o.bG(f),u_tile_units_to_pixels:new o.bI(f)}),circle:o.cN,collisionBox:f=>({u_matrix:new o.bF(f),u_camera_to_center_distance:new o.bI(f),u_extrude_scale:new o.bG(f)}),collisionCircle:f=>({u_matrix:new o.bF(f),u_inv_matrix:new o.bF(f),u_camera_to_center_distance:new o.bI(f),u_viewport_size:new o.bG(f)}),debug:f=>({u_color:new o.cu(f),u_matrix:new o.bF(f),u_overlay:new o.bJ(f),u_overlay_scale:new o.bI(f)}),clippingMask:f=>({u_matrix:new o.bF(f)}),heatmap:f=>({u_extrude_scale:new o.bI(f),u_intensity:new o.bI(f),u_matrix:new o.bF(f),u_inv_rot_matrix:new o.bF(f),u_merc_center:new o.bG(f),u_tile_id:new o.bH(f),u_zoom_transition:new o.bI(f),u_up_dir:new o.bH(f)}),heatmapTexture:f=>({u_image:new o.bJ(f),u_color_ramp:new o.bJ(f),u_opacity:new o.bI(f)}),hillshade:f=>({u_matrix:new o.bF(f),u_image:new o.bJ(f),u_latrange:new o.bG(f),u_light:new o.bG(f),u_shadow:new o.cu(f),u_highlight:new o.cu(f),u_emissive_strength:new o.bI(f),u_accent:new o.cu(f)}),hillshadePrepare:f=>({u_matrix:new o.bF(f),u_image:new o.bJ(f),u_dimension:new o.bG(f),u_zoom:new o.bI(f)}),line:o.cO,linePattern:o.cP,raster:f=>({u_matrix:new o.bF(f),u_normalize_matrix:new o.bF(f),u_globe_matrix:new o.bF(f),u_merc_matrix:new o.bF(f),u_grid_matrix:new o.cv(f),u_tl_parent:new o.bG(f),u_scale_parent:new o.bI(f),u_fade_t:new o.bI(f),u_opacity:new o.bI(f),u_image0:new o.bJ(f),u_image1:new o.bJ(f),u_brightness_low:new o.bI(f),u_brightness_high:new o.bI(f),u_saturation_factor:new o.bI(f),u_contrast_factor:new o.bI(f),u_spin_weights:new o.bH(f),u_perspective_transform:new o.bG(f),u_raster_elevation:new o.bI(f),u_zoom_transition:new o.bI(f),u_merc_center:new o.bG(f),u_cutoff_params:new o.c6(f),u_colorization_mix:new o.c6(f),u_colorization_offset:new o.bI(f),u_color_ramp:new o.bJ(f),u_texture_offset:new o.bG(f),u_texture_res:new o.bG(f),u_emissive_strength:new o.bI(f)}),rasterParticle:f=>({u_matrix:new o.bF(f),u_normalize_matrix:new o.bF(f),u_globe_matrix:new o.bF(f),u_merc_matrix:new o.bF(f),u_grid_matrix:new o.cv(f),u_tl_parent:new o.bG(f),u_scale_parent:new o.bI(f),u_fade_t:new o.bI(f),u_opacity:new o.bI(f),u_image0:new o.bJ(f),u_image1:new o.bJ(f),u_raster_elevation:new o.bI(f),u_zoom_transition:new o.bI(f),u_merc_center:new o.bG(f),u_cutoff_params:new o.c6(f)}),rasterParticleTexture:f=>({u_texture:new o.bJ(f),u_opacity:new o.bI(f)}),rasterParticleDraw:f=>({u_particle_texture:new o.bJ(f),u_particle_texture_side_len:new o.bI(f),u_tile_offset:new o.bG(f),u_velocity:new o.bJ(f),u_color_ramp:new o.bJ(f),u_velocity_res:new o.bG(f),u_max_speed:new o.bI(f),u_uv_offset:new o.bG(f),u_data_scale:new o.bG(f),u_data_offset:new o.bI(f),u_particle_pos_scale:new o.bI(f),u_particle_pos_offset:new o.bG(f)}),rasterParticleUpdate:f=>({u_particle_texture:new o.bJ(f),u_particle_texture_side_len:new o.bI(f),u_velocity:new o.bJ(f),u_velocity_res:new o.bG(f),u_max_speed:new o.bI(f),u_speed_factor:new o.bI(f),u_reset_rate:new o.bI(f),u_rand_seed:new o.bI(f),u_uv_offset:new o.bG(f),u_data_scale:new o.bG(f),u_data_offset:new o.bI(f),u_particle_pos_scale:new o.bI(f),u_particle_pos_offset:new o.bG(f)}),symbol:f=>({u_is_size_zoom_constant:new o.bJ(f),u_is_size_feature_constant:new o.bJ(f),u_size_t:new o.bI(f),u_size:new o.bI(f),u_camera_to_center_distance:new o.bI(f),u_rotate_symbol:new o.bJ(f),u_aspect_ratio:new o.bI(f),u_fade_change:new o.bI(f),u_matrix:new o.bF(f),u_label_plane_matrix:new o.bF(f),u_coord_matrix:new o.bF(f),u_is_text:new o.bJ(f),u_elevation_from_sea:new o.bJ(f),u_pitch_with_map:new o.bJ(f),u_texsize:new o.bG(f),u_texsize_icon:new o.bG(f),u_texture:new o.bJ(f),u_texture_icon:new o.bJ(f),u_gamma_scale:new o.bI(f),u_device_pixel_ratio:new o.bI(f),u_tile_id:new o.bH(f),u_zoom_transition:new o.bI(f),u_inv_rot_matrix:new o.bF(f),u_merc_center:new o.bG(f),u_camera_forward:new o.bH(f),u_tile_matrix:new o.bF(f),u_up_vector:new o.bH(f),u_ecef_origin:new o.bH(f),u_is_halo:new o.bJ(f),u_icon_transition:new o.bI(f),u_color_adj_mat:new o.bF(f)}),background:f=>({u_matrix:new o.bF(f),u_emissive_strength:new o.bI(f),u_opacity:new o.bI(f),u_color:new o.cu(f)}),backgroundPattern:f=>({u_matrix:new o.bF(f),u_emissive_strength:new o.bI(f),u_opacity:new o.bI(f),u_image:new o.bJ(f),u_pattern_tl:new o.bG(f),u_pattern_br:new o.bG(f),u_texsize:new o.bG(f),u_pattern_size:new o.bG(f),u_pixel_coord_upper:new o.bG(f),u_pixel_coord_lower:new o.bG(f),u_pattern_units_to_pixels:new o.bG(f)}),terrainRaster:f=>({u_matrix:new o.bF(f),u_image0:new o.bJ(f),u_skirt_height:new o.bI(f),u_ground_shadow_factor:new o.bH(f)}),skybox:f=>({u_matrix:new o.bF(f),u_sun_direction:new o.bH(f),u_cubemap:new o.bJ(f),u_opacity:new o.bI(f),u_temporal_offset:new o.bI(f)}),skyboxGradient:f=>({u_matrix:new o.bF(f),u_color_ramp:new o.bJ(f),u_center_direction:new o.bH(f),u_radius:new o.bI(f),u_opacity:new o.bI(f),u_temporal_offset:new o.bI(f)}),skyboxCapture:f=>({u_matrix_3f:new o.cv(f),u_sun_direction:new o.bH(f),u_sun_intensity:new o.bI(f),u_color_tint_r:new o.c6(f),u_color_tint_m:new o.c6(f),u_luminance:new o.bI(f)}),globeRaster:f=>({u_proj_matrix:new o.bF(f),u_globe_matrix:new o.bF(f),u_normalize_matrix:new o.bF(f),u_merc_matrix:new o.bF(f),u_zoom_transition:new o.bI(f),u_merc_center:new o.bG(f),u_image0:new o.bJ(f),u_grid_matrix:new o.cv(f),u_skirt_height:new o.bI(f),u_far_z_cutoff:new o.bI(f),u_frustum_tl:new o.bH(f),u_frustum_tr:new o.bH(f),u_frustum_br:new o.bH(f),u_frustum_bl:new o.bH(f),u_globe_pos:new o.bH(f),u_globe_radius:new o.bI(f),u_viewport:new o.bG(f)}),globeAtmosphere:f=>({u_frustum_tl:new o.bH(f),u_frustum_tr:new o.bH(f),u_frustum_br:new o.bH(f),u_frustum_bl:new o.bH(f),u_horizon:new o.bI(f),u_transition:new o.bI(f),u_fadeout_range:new o.bI(f),u_color:new o.c6(f),u_high_color:new o.c6(f),u_space_color:new o.c6(f),u_temporal_offset:new o.bI(f),u_horizon_angle:new o.bI(f)}),model:f=>({u_matrix:new o.bF(f),u_lighting_matrix:new o.bF(f),u_normal_matrix:new o.bF(f),u_node_matrix:new o.bF(f),u_lightpos:new o.bH(f),u_lightintensity:new o.bI(f),u_lightcolor:new o.bH(f),u_camera_pos:new o.bH(f),u_opacity:new o.bI(f),u_baseColorFactor:new o.c6(f),u_emissiveFactor:new o.c6(f),u_metallicFactor:new o.bI(f),u_roughnessFactor:new o.bI(f),u_baseTextureIsAlpha:new o.bJ(f),u_alphaMask:new o.bJ(f),u_alphaCutoff:new o.bI(f),u_baseColorTexture:new o.bJ(f),u_metallicRoughnessTexture:new o.bJ(f),u_normalTexture:new o.bJ(f),u_occlusionTexture:new o.bJ(f),u_emissionTexture:new o.bJ(f),u_lutTexture:new o.bJ(f),u_color_mix:new o.c6(f),u_aoIntensity:new o.bI(f),u_emissive_strength:new o.bI(f),u_occlusionTextureTransform:new o.c6(f)}),modelDepth:f=>({u_matrix:new o.bF(f),u_instance:new o.bF(f),u_node_matrix:new o.bF(f)}),groundShadow:f=>({u_matrix:new o.bF(f),u_ground_shadow_factor:new o.bH(f)}),stars:f=>({u_matrix:new o.bF(f),u_up:new o.bH(f),u_right:new o.bH(f),u_intensity_multiplier:new o.bI(f)}),occlusion:f=>({u_matrix:new o.bF(f),u_anchorPos:new o.bH(f),u_screenSizePx:new o.bG(f),u_occluderSizePx:new o.bG(f),u_color:new o.c6(f)})};class cs{constructor(r,l,p,b){this.id=cs.uniqueIdxCounter,cs.uniqueIdxCounter++,this.context=r;const S=r.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||b||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=cs.uniqueIdxCounter,cs.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}cs.uniqueIdxCounter=0;const hc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Xn{constructor(r,l,p,b,S,E){this.length=l.length,this.attributes=p,this.itemSize=l.bytesPerElement,this.dynamicDraw=b,this.instanceCount=E,this.context=r;const O=r.gl;this.buffer=O.createBuffer(),r.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||S||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,l){for(let p=0;p<this.attributes.length;p++){const b=l.attributes[this.attributes[p].name];b!==void 0&&r.enableVertexAttribArray(b)}}setVertexAttribPointers(r,l,p){for(let b=0;b<this.attributes.length;b++){const S=this.attributes[b],E=l.attributes[S.name];E!==void 0&&r.vertexAttribPointer(E,S.components,r[hc[S.type]],!1,this.itemSize,S.offset+this.itemSize*(p||0))}}setVertexAttribDivisor(r,l,p){for(let b=0;b<this.attributes.length;b++){const S=l.attributes[this.attributes[b].name];S!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(S,p)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class bf{constructor(r,l,p,b,S){this.context=r,this.width=l,this.height=p;const E=this.framebuffer=r.gl.createFramebuffer();b&&(this.colorAttachment=new df(r,E)),S&&(this.depthAttachmentType=S,this.depthAttachment=S==="renderbuffer"?new Rm(r,E):new O_(r,E))}destroy(){const r=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&r.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&r.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&r.deleteTexture(l)}r.deleteFramebuffer(this.framebuffer)}}class S1{constructor(r,l){this.gl=r,this.clearColor=new wm(this),this.clearDepth=new M_(this),this.clearStencil=new Sm(this),this.colorMask=new af(this),this.depthMask=new Cd(this),this.stencilMask=new I_(this),this.stencilFunc=new k_(this),this.stencilOp=new A_(this),this.stencilTest=new iu(this),this.depthRange=new P_(this),this.depthTest=new g1(this),this.depthFunc=new v1(this),this.blend=new _1(this),this.blendFunc=new Tm(this),this.blendColor=new Cm(this),this.blendEquation=new Em(this),this.cullFace=new Mm(this),this.cullFaceSide=new R_(this),this.frontFace=new D_(this),this.program=new y1(this),this.activeTexture=new Ed(this),this.viewport=new Md(this),this.bindFramebuffer=new L_(this),this.bindRenderbuffer=new Cs(this),this.bindTexture=new Im(this),this.bindVertexBuffer=new lf(this),this.bindElementBuffer=new cf(this),this.bindVertexArrayOES=new km(this),this.pixelStoreUnpack=new Am(this),this.pixelStoreUnpackPremultiplyAlpha=new uf(this),this.pixelStoreUnpackFlipY=new Pm(this),this.options=l?{...l}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,l,p){return new cs(this,r,l,p)}createVertexBuffer(r,l,p,b,S){return new Xn(this,r,l,p,b,S)}createRenderbuffer(r,l,p){const b=this.gl,S=b.createRenderbuffer();return this.bindRenderbuffer.set(S),b.renderbufferStorage(b.RENDERBUFFER,r,l,p),this.bindRenderbuffer.set(null),S}createFramebuffer(r,l,p,b){return new bf(this,r,l,p,b)}clear({color:r,depth:l,stencil:p,colorMask:b}){const S=this.gl;let E=0;r&&(E|=S.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set(b||[!0,!0,!0,!0])),l!==void 0&&(E|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),p!==void 0&&(E|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),S.clear(E)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){o.bh(r.blendFunction,Ur.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let xf;function wf(f,r,l,p,b,S,E){const O=f.context,V=O.gl,H=f.transform,W=f.getOrCreateProgram("collisionBox"),J=[];let ee=0,re=0;for(let Le=0;Le<p.length;Le++){const je=p[Le],Ue=r.getTile(je),rt=Ue.getBucket(l);if(!rt)continue;const Qe=p_(je,rt,H);let ot=Qe;b[0]===0&&b[1]===0||(ot=f.translatePosMatrix(Qe,Ue,b,S));const gt=E?rt.textCollisionBox:rt.iconCollisionBox,ht=rt.collisionCircleArray;if(ht.length>0){const ct=o.a6.mat4.create(),Ct=ot;o.a6.mat4.mul(ct,rt.placementInvProjMatrix,H.glCoordMatrix),o.a6.mat4.mul(ct,ct,rt.placementViewportMatrix),J.push({circleArray:ht,circleOffset:re,transform:Ct,invTransform:ct,projection:rt.getProjection()}),ee+=ht.length/4,re=ee}gt&&(f.terrain&&f.terrain.setupElevationDraw(Ue,W),W.draw(f,V.LINES,or.disabled,Mr.disabled,f.colorModeForRenderPass(),yr.disabled,x1(ot,H,Ue,rt.getProjection()),l.id,gt.layoutVertexBuffer,gt.indexBuffer,gt.segments,null,H.zoom,null,[gt.collisionVertexBuffer,gt.collisionVertexBufferExt]))}if(!E||!J.length)return;const ve=f.getOrCreateProgram("collisionCircle"),_e=new o.cQ;_e.resize(4*ee),_e._trim();let xe=0;for(const Le of J)for(let je=0;je<Le.circleArray.length/4;je++){const Ue=4*je,rt=Le.circleArray[Ue+0],Qe=Le.circleArray[Ue+1],ot=Le.circleArray[Ue+2],gt=Le.circleArray[Ue+3];_e.emplace(xe++,rt,Qe,ot,gt,0),_e.emplace(xe++,rt,Qe,ot,gt,1),_e.emplace(xe++,rt,Qe,ot,gt,2),_e.emplace(xe++,rt,Qe,ot,gt,3)}(!xf||xf.length<2*ee)&&(xf=function(Le){const je=2*Le,Ue=new o.aO;Ue.resize(je),Ue._trim();for(let rt=0;rt<je;rt++){const Qe=6*rt;Ue.uint16[Qe+0]=4*rt+0,Ue.uint16[Qe+1]=4*rt+1,Ue.uint16[Qe+2]=4*rt+2,Ue.uint16[Qe+3]=4*rt+2,Ue.uint16[Qe+4]=4*rt+3,Ue.uint16[Qe+5]=4*rt+0}return Ue}(ee));const we=O.createIndexBuffer(xf,!0),ze=O.createVertexBuffer(_e,o.cR.members,!0);for(const Le of J){const je={u_matrix:Le.transform,u_inv_matrix:Le.invTransform,u_camera_to_center_distance:(Ne=H).getCameraToCenterDistance(Le.projection),u_viewport_size:[Ne.width,Ne.height]};ve.draw(f,V.TRIANGLES,or.disabled,Mr.disabled,f.colorModeForRenderPass(),yr.disabled,je,l.id,ze,we,o.b1.simpleSegment(0,2*Le.circleOffset,Le.circleArray.length,Le.circleArray.length/2),null,H.zoom)}var Ne;ze.destroy(),we.destroy()}const Rd=o.a6.mat4.create();function jm(f){const r=f._camera.getWorldToCamera(f.worldSize,1),l=o.a6.mat4.multiply([],r,f.globeMatrix);o.a6.mat4.invert(l,l);const p=[0,0,0],b=[0,1,0,0];return o.a6.vec4.transformMat4(b,b,l),p[0]=b[0],p[1]=b[1],p[2]=b[2],o.a6.vec3.normalize(p,p),p}function T1({width:f,height:r,anchor:l,textOffset:p,textScale:b},S){const{horizontalAlign:E,verticalAlign:O}=o.bx(l),V=-(E-.5)*f,H=-(O-.5)*r,W=o.bw(l,p);return new o.P((V/b+W[0])*S,(H/b+W[1])*S)}function C1(f,r,l,p,b,S,E,O,V,H,W){const J=f.text.placedSymbolArray,ee=f.text.dynamicLayoutVertexArray,re=f.icon.dynamicLayoutVertexArray,ve={},_e=f.getProjection(),xe=Cl(O,_e,S),we=S.elevation,ze=_e.upVectorScale(O.canonical,S.center.lat,S.worldSize).metersToTile;ee.clear();for(let Ne=0;Ne<J.length;Ne++){const Le=J.get(Ne),{tileAnchorX:je,tileAnchorY:Ue,numGlyphs:rt}=Le,Qe=Le.hidden||!Le.crossTileID||f.allowVerticalPlacement&&!Le.placedOrientation?null:p[Le.crossTileID];if(Qe){let ot=0,gt=0,ht=0;if(we){const Qt=we?we.getAtTileOffset(O,je,Ue):0,[bn,wn,an]=_e.upVector(O.canonical,je,Ue);ot=Qt*bn*ze,gt=Qt*wn*ze,ht=Qt*an*ze}let[ct,Ct,Kt,cn]=$i(Le.projectedAnchorX+ot,Le.projectedAnchorY+gt,Le.projectedAnchorZ+ht,l?xe:E);const qt=Jr(S.getCameraToCenterDistance(_e),cn);let yn=b.evaluateSizeForFeature(f.textSizeData,H,Le)*qt/o.bq;l&&(yn*=f.tilePixelRatio/V);const Et=T1(Qe,yn);l?({x:ct,y:Ct,z:Kt}=_e.projectTilePoint(je+Et.x,Ue+Et.y,O.canonical),[ct,Ct,Kt]=$i(ct+ot,Ct+gt,Kt+ht,E)):(r&&Et._rotate(-S.angle),ct+=Et.x,Ct+=Et.y,Kt=0);const nn=f.allowVerticalPlacement&&Le.placedOrientation===o.bk.vertical?Math.PI/2:0;for(let Qt=0;Qt<rt;Qt++)o.bn(ee,ct,Ct,Kt,nn);W&&Le.associatedIconIndex>=0&&(ve[Le.associatedIconIndex]={x:ct,y:Ct,z:Kt,angle:nn})}else wa(rt,ee)}if(W){re.clear();const Ne=f.icon.placedSymbolArray;for(let Le=0;Le<Ne.length;Le++){const je=Ne.get(Le),{numGlyphs:Ue}=je,rt=ve[Le];if(je.hidden||!rt)wa(Ue,re);else{const{x:Qe,y:ot,z:gt,angle:ht}=rt;for(let ct=0;ct<Ue;ct++)o.bn(re,Qe,ot,gt,ht)}}f.icon.dynamicLayoutVertexBuffer.updateData(re)}f.text.dynamicLayoutVertexBuffer.updateData(ee)}function Dd(f,r,l,p,b,S,E={}){const O=l.paint.get("icon-translate"),V=l.paint.get("text-translate"),H=l.paint.get("icon-translate-anchor"),W=l.paint.get("text-translate-anchor"),J=l.layout.get("icon-rotation-alignment"),ee=l.layout.get("text-rotation-alignment"),re=l.layout.get("icon-pitch-alignment"),ve=l.layout.get("text-pitch-alignment"),_e=l.layout.get("icon-keep-upright"),xe=l.layout.get("text-keep-upright"),we=l.paint.get("icon-color-saturation"),ze=l.paint.get("icon-color-contrast"),Ne=l.paint.get("icon-color-brightness-min"),Le=l.paint.get("icon-color-brightness-max"),je=l.paint.get("symbol-elevation-reference")==="sea",Ue=l.paint.get("text-occlusion-opacity").constantOr(0),rt=f.context,Qe=rt.gl,ot=f.transform,gt=J==="map",ht=ee==="map",ct=re==="map",Ct=ve==="map",Kt=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let cn=!1;const qt=f.depthModeForSublayer(0,or.ReadOnly),yn=[o.am(ot.center.lng),o.at(ot.center.lat)],Et=l.layout.get("text-variable-anchor"),nn=ot.projection.name==="globe",Qt=[],bn=[0,-1,0];for(const wn of p){const an=r.getTile(wn),pn=an.getBucket(l);if(!pn||pn.projection.name==="mercator"&&nn||pn.fullyClipped)continue;const er=pn.projection.name==="globe",Mn=er?o.a9(ot.zoom):0,$n=Cl(wn,pn.getProjection(),ot),gr=ot.calculatePixelsToTileUnitsMatrix(an),Zn=Et&&pn.hasTextData(),lr=pn.hasIconTextFit()&&Zn&&pn.hasIconData(),zr=pn.getProjection().createInversionMatrix(ot,wn.canonical),Dr=vo=>{ot.depthOcclusionForSymbolsAndCircles&&(l.hasInitialOcclusionOpacityProperties||f.terrain)&&(vo.push("DEPTH_D24"),vo.push("DEPTH_OCCLUSION"))},po=()=>{const vo=gt&&l.layout.get("symbol-placement")!=="point",Lr=[];Dr(Lr);const io=vo||lr,uo=l.paint.get("icon-image-cross-fade").constantOr(0);f.terrainRenderModeElevated()&&ct&&Lr.push("PITCH_WITH_MAP_TERRAIN"),er&&(Lr.push("PROJECTION_GLOBE_VIEW"),io&&Lr.push("PROJECTED_POS_ON_VIEWPORT")),uo>0&&Lr.push("ICON_TRANSITION"),pn.icon.zOffsetVertexBuffer&&Lr.push("Z_OFFSET"),we===0&&ze===0&&Ne===0&&Le===1||Lr.push("COLOR_ADJUSTMENT"),pn.sdfIcons&&Lr.push("RENDER_SDF");const Yo=pn.icon.programConfigurations.get(l.id),oi=f.getOrCreateProgram("symbol",{config:Yo,defines:Lr}),Yr=an.imageAtlasTexture?an.imageAtlasTexture.size:[0,0],gi=pn.iconSizeData,bi=o.bj(gi,ot.zoom),vi=ct||ot.pitch!==0,Po=qr($n,an.tileID.canonical,ct,gt,ot,pn.getProjection(),gr),Ji=as($n,an.tileID.canonical,ct,gt,ot,pn.getProjection(),gr),Qi=f.translatePosMatrix(Ji,an,O,H,!0),Us=f.translatePosMatrix($n,an,O,H),Ms=io?Rd:Po,ds=gt&&!ct&&!vo;let js=bn;!nn&&!ot.mercatorFromTransition||gt||(js=jm(ot));const Qa=er?js:bn,zl=l.getColorAdjustmentMatrix(we,ze,Ne,Le),Ma=Vm(gi.kind,bi,ds,ct,f,Us,Ms,Qi,je,!1,Yr,[0,0],!0,wn,Mn,yn,zr,Qa,pn.getProjection(),zl,uo),bu=an.imageAtlasTexture?an.imageAtlasTexture:null,xu=l.layout.get("icon-size").constantOr(0)!==1||pn.iconsNeedLinear,Nf=pn.sdfIcons||f.options.rotating||f.options.zooming||xu||vi?Qe.LINEAR:Qe.NEAREST,wu=pn.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,Ro=f.terrain&&ct&&vo?o.a6.mat4.invert(o.a6.mat4.create(),Po):Rd;if(vo&&pn.icon){const _c=ot.elevation,$1=_c?_c.getAtTileOffsetFunc(wn,ot.center.lat,ot.worldSize,pn.getProjection()):null,py=Kr($n,an.tileID.canonical,ct,gt,ot,pn.getProjection(),gr);Gc(pn,$n,f,!1,py,Ji,ct,_e,$1,wn)}return{program:oi,buffers:pn.icon,uniformValues:Ma,atlasTexture:bu,atlasTextureIcon:null,atlasInterpolation:Nf,atlasInterpolationIcon:null,isSDF:pn.sdfIcons,hasHalo:wu,tile:an,labelPlaneMatrixInv:Ro}},To=()=>{const vo=ht&&l.layout.get("symbol-placement")!=="point",Lr=[],io=vo||Et||lr;f.terrainRenderModeElevated()&&Ct&&Lr.push("PITCH_WITH_MAP_TERRAIN"),er&&(Lr.push("PROJECTION_GLOBE_VIEW"),io&&Lr.push("PROJECTED_POS_ON_VIEWPORT")),pn.text.zOffsetVertexBuffer&&Lr.push("Z_OFFSET"),pn.iconsInText&&Lr.push("RENDER_TEXT_AND_SYMBOL"),Lr.push("RENDER_SDF"),Dr(Lr);const uo=pn.text.programConfigurations.get(l.id),Yo=f.getOrCreateProgram("symbol",{config:uo,defines:Lr});let oi,Yr=[0,0],gi=null;const bi=pn.textSizeData;pn.iconsInText&&(Yr=an.imageAtlasTexture?an.imageAtlasTexture.size:[0,0],gi=an.imageAtlasTexture?an.imageAtlasTexture:null,oi=Ct||ot.pitch!==0||f.options.rotating||f.options.zooming||bi.kind==="composite"||bi.kind==="camera"?Qe.LINEAR:Qe.NEAREST);const vi=an.glyphAtlasTexture?an.glyphAtlasTexture.size:[0,0],Po=o.bj(bi,ot.zoom),Ji=qr($n,an.tileID.canonical,Ct,ht,ot,pn.getProjection(),gr),Qi=as($n,an.tileID.canonical,Ct,ht,ot,pn.getProjection(),gr),Us=f.translatePosMatrix(Qi,an,V,W,!0),Ms=f.translatePosMatrix($n,an,V,W),ds=io?Rd:Ji,js=ht&&!Ct&&!vo;let Qa=bn;!nn&&!ot.mercatorFromTransition||ht||(Qa=jm(ot));const zl=Vm(bi.kind,Po,js,Ct,f,Ms,ds,Us,je,!0,vi,Yr,!0,wn,Mn,yn,zr,er?Qa:bn,pn.getProjection(),Ue),Ma=an.glyphAtlasTexture?an.glyphAtlasTexture:null,bu=Qe.LINEAR,xu=l.paint.get("text-halo-width").constantOr(1)!==0,Nf=f.terrain&&Ct&&vo?o.a6.mat4.invert(o.a6.mat4.create(),Ji):Rd;if(vo&&pn.text){const wu=ot.elevation,Ro=wu?wu.getAtTileOffsetFunc(wn,ot.center.lat,ot.worldSize,pn.getProjection()):null,_c=Kr($n,an.tileID.canonical,Ct,ht,ot,pn.getProjection(),gr);Gc(pn,$n,f,!0,_c,Qi,Ct,xe,Ro,wn)}return{program:Yo,buffers:pn.text,uniformValues:zl,atlasTexture:Ma,atlasTextureIcon:gi,atlasInterpolation:bu,atlasInterpolationIcon:oi,isSDF:!0,hasHalo:xu,tile:an,labelPlaneMatrixInv:Nf}},Lo=pn.icon.segments.get().length,Vs=pn.text.segments.get().length,ri=Lo&&!E.onlyText?po():null,jr=Vs&&!E.onlyIcons?To():null,xo=l.paint.get("icon-opacity").constantOr(1),Vo=l.paint.get("text-opacity").constantOr(1);if(Kt&&pn.canOverlap){cn=!0;const vo=xo&&!E.onlyText?pn.icon.segments.get():[],Lr=Vo&&!E.onlyIcons?pn.text.segments.get():[];for(const io of vo)Qt.push({segments:new o.b1([io]),sortKey:io.sortKey,state:ri});for(const io of Lr)Qt.push({segments:new o.b1([io]),sortKey:io.sortKey,state:jr})}else E.onlyText||Qt.push({segments:xo?pn.icon.segments:new o.b1([]),sortKey:0,state:ri}),E.onlyIcons||Qt.push({segments:Vo?pn.text.segments:new o.b1([]),sortKey:0,state:jr})}cn&&Qt.sort((wn,an)=>wn.sortKey-an.sortKey);for(const wn of Qt){const an=wn.state;if(an)if(f.terrain?f.terrain.setupElevationDraw(an.tile,an.program,{useDepthForOcclusion:ot.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:an.labelPlaneMatrixInv}):f.setupDepthForOcclusion(ot.depthOcclusionForSymbolsAndCircles,an.program),rt.activeTexture.set(Qe.TEXTURE0),an.atlasTexture&&an.atlasTexture.bind(an.atlasInterpolation,Qe.CLAMP_TO_EDGE,!0),an.atlasTextureIcon&&(rt.activeTexture.set(Qe.TEXTURE1),an.atlasTextureIcon&&an.atlasTextureIcon.bind(an.atlasInterpolationIcon,Qe.CLAMP_TO_EDGE,!0)),f.uploadCommonLightUniforms(f.context,an.program),an.hasHalo){const pn=an.uniformValues;pn.u_is_halo=1,Ld(an.buffers,wn.segments,l,f,an.program,qt,b,S,pn,2),pn.u_is_halo=0}else{if(an.isSDF){const pn=an.uniformValues;an.hasHalo&&(pn.u_is_halo=1,Ld(an.buffers,wn.segments,l,f,an.program,qt,b,S,pn,1)),pn.u_is_halo=0}Ld(an.buffers,wn.segments,l,f,an.program,qt,b,S,an.uniformValues,1)}}}function Ld(f,r,l,p,b,S,E,O,V,H){const W=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.iconTransitioningVertexBuffer,f.globeExtVertexBuffer,f.zOffsetVertexBuffer];b.draw(p,p.context.gl.TRIANGLES,S,E,O,yr.disabled,V,l.id,f.layoutVertexBuffer,f.indexBuffer,r,l.paint,p.transform.zoom,f.programConfigurations.get(l.id),W,H)}function Sf(f,r,l,p,b,S,E){const O=f.context.gl,V=l.paint.get("fill-pattern"),H=l.is3D(),W=H?f.stencilModeFor3D():Mr.disabled,J=V&&V.constantOr(1);let ee,re,ve,_e,xe;E?(re=J&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ee=O.LINES):(re=J?"fillPattern":"fill",ee=O.TRIANGLES);for(const we of p){const ze=r.getTile(we);if(J&&!ze.patternsLoaded())continue;const Ne=ze.getBucket(l);if(!Ne)continue;f.prepareDrawTile();const Le=Ne.programConfigurations.get(l.id),je=f.isTileAffectedByFog(we),Ue=f.getOrCreateProgram(re,{config:Le,overrideFog:je});J&&(f.context.activeTexture.set(O.TEXTURE0),ze.imageAtlasTexture&&ze.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Le.updatePaintBuffers());const rt=V.constantOr(null);if(rt&&ze.imageAtlas){const gt=ze.imageAtlas.patternPositions[rt.toString()];gt&&Le.setConstantPatternPositions(gt)}const Qe=f.translatePosMatrix(we.projMatrix,ze,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor")),ot=l.paint.get("fill-emissive-strength");if(E){_e=Ne.indexBuffer2,xe=Ne.segments2;const gt=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];ve=re==="fillOutlinePattern"&&J?Ad(Qe,ot,f,ze,gt):H_(Qe,ot,gt)}else _e=Ne.indexBuffer,xe=Ne.segments,ve=J?j_(Qe,ot,f,ze):pf(Qe,ot);f.uploadCommonUniforms(f.context,Ue,we.toUnwrapped()),Ue.draw(f,ee,b,H?W:f.stencilModeForClipping(we),S,yr.disabled,ve,l.id,Ne.layoutVertexBuffer,_e,xe,l.paint,f.transform.zoom,Le,void 0)}}function uu(f,r,l,p,b,S,E,O){l.resetLayerRenderingStats(f);const V=f.context,H=V.gl,W=f.transform,J=l.paint.get("fill-extrusion-pattern"),ee=J.constantOr(1),re=l.paint.get("fill-extrusion-opacity"),ve=f.style.enable3dLights(),_e=l.paint.get(ve&&!ee?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),xe=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),_e],we=l.layout.get("fill-extrusion-edge-radius"),ze=we>0&&!l.paint.get("fill-extrusion-rounded-roof"),Ne=ze?0:we,Le=W.projection.name==="globe"?o.c_():0,je=W.projection.name==="globe",Ue=je?o.a9(W.zoom):0,rt=[o.am(W.center.lng),o.at(W.center.lat)],Qe=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(l.lut).toArray01().slice(0,3),ot=l.paint.get("fill-extrusion-flood-light-intensity"),gt=l.paint.get("fill-extrusion-vertical-scale"),ht=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,ct=qa(f,l.paint.get("fill-extrusion-cutoff-fade-range")),Ct=[];let Kt;je&&Ct.push("PROJECTION_GLOBE_VIEW"),xe[0]>0&&Ct.push("FAUX_AO"),ze&&Ct.push("ZERO_ROOF_RADIUS"),O&&Ct.push("HAS_CENTROID"),ot>0&&Ct.push("FLOOD_LIGHT"),ct.shouldRenderCutoff&&Ct.push("RENDER_CUTOFF"),ht&&Ct.push("RENDER_WALL_MODE");const cn=f.renderPass==="shadow",qt=f.shadowRenderer,yn=cn&&!!qt;f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!0);let Et=[0,0,0];if(qt){const bn=f.style.directionalLight,wn=f.style.ambientLight;bn&&wn&&(Et=Jh(f.style,bn,wn)),Kt=Ct.concat(["SHADOWS_SINGLE_CASCADE"])}const nn=yn?"fillExtrusionDepth":ee?"fillExtrusionPattern":"fillExtrusion",Qt=l.getLayerRenderingStats();for(const bn of p){const wn=r.getTile(bn),an=wn.getBucket(l);if(!an||an.projection.name!==W.projection.name)continue;let pn=!1;qt&&(pn=qt.getMaxCascadeForTile(bn.toUnwrapped())===0);const er=f.isTileAffectedByFog(bn),Mn=an.programConfigurations.get(l.id),$n=f.getOrCreateProgram(nn,{config:Mn,defines:pn?Kt:Ct,overrideFog:er});if(f.terrain&&f.terrain.setupElevationDraw(wn,$n,{useMeterToDem:!0}),!an.centroidVertexBuffer){const To=$n.attributes.a_centroid_pos;To!==void 0&&H.vertexAttrib2f(To,0,0)}!cn&&qt&&qt.setupShadows(wn.tileID.toUnwrapped(),$n,"vector-tile",wn.tileID.overscaledZ),ee&&(f.context.activeTexture.set(H.TEXTURE0),wn.imageAtlasTexture&&wn.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),Mn.updatePaintBuffers());const gr=J.constantOr(null);if(gr&&wn.imageAtlas){const To=wn.imageAtlas.patternPositions[gr.toString()];To&&Mn.setConstantPatternPositions(To)}const Zn=l.paint.get("fill-extrusion-vertical-gradient"),lr=1/an.tileToMeter;let zr;if(cn&&qt){if(Wm(wn.tileID,an,f))continue;const To=qt.calculateShadowPassMatrixFromTile(wn.tileID.toUnwrapped());zr=U_(To,Ne,lr,gt)}else{const To=f.translatePosMatrix(bn.expandedProjMatrix,wn,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Lo=W.projection.createInversionMatrix(W,bn.canonical);zr=ee?Nm(To,f,Zn,re,xe,Ne,lr,bn,wn,Le,Ue,rt,Lo,Qe,gt):Fm(To,f,Zn,re,xe,Ne,lr,bn,Le,Ue,rt,Lo,Qe,gt,ot,Et)}f.uploadCommonUniforms(V,$n,bn.toUnwrapped(),null,ct);let Dr=an.segments;if(W.projection.name==="mercator"&&!cn&&(Dr=an.getVisibleSegments(wn.tileID,f.terrain,f.transform.getFrustum(0)),!Dr.get().length))continue;if(Qt)if(cn)for(const To of Dr.get())Qt.numRenderedVerticesInShadowPass+=To.primitiveLength;else for(const To of Dr.get())Qt.numRenderedVerticesInTransparentPass+=To.primitiveLength;const po=[];(f.terrain||O)&&po.push(an.centroidVertexBuffer),je&&po.push(an.layoutVertexExtBuffer),ht&&po.push(an.wallVertexBuffer),$n.draw(f,V.gl.TRIANGLES,b,S,E,yr.backCCW,zr,l.id,an.layoutVertexBuffer,an.indexBuffer,Dr,l.paint,f.transform.zoom,Mn,po)}f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!1)}function wi(f,r,l,p,b,S,E,O,V,H,W,J,ee,re,ve,_e,xe,we,ze){const Ne=f.context,Le=Ne.gl,je=f.transform,Ue=f.transform.zoom,rt=[],Qe=qa(f,l.paint.get("fill-extrusion-cutoff-fade-range"));H==="clear"?(rt.push("CLEAR_SUBPASS"),ze&&(rt.push("CLEAR_FROM_TEXTURE"),Ne.activeTexture.set(Le.TEXTURE0),ze.bind(Le.LINEAR,Le.CLAMP_TO_EDGE))):H==="sdf"&&rt.push("SDF_SUBPASS"),xe&&rt.push("HAS_CENTROID"),Qe.shouldRenderCutoff&&rt.push("RENDER_CUTOFF");const ot=l.layout.get("fill-extrusion-edge-radius"),gt=(ht,ct,Ct,Kt,cn)=>{const qt=ct.programConfigurations.get(l.id),yn=f.isTileAffectedByFog(ht),Et=f.getOrCreateProgram("fillExtrusionGroundEffect",{config:qt,defines:rt,overrideFog:yn}),nn=((bn,wn,an,pn,er,Mn,$n,gr,Zn,lr,zr)=>({u_matrix:wn,u_opacity:an,u_ao_pass:pn?1:0,u_meter_to_tile:er,u_ao:Mn,u_flood_light_intensity:$n,u_flood_light_color:gr,u_attenuation:Zn,u_edge_radius:lr,u_fb:0,u_fb_size:zr,u_dynamic_offset:1}))(0,Kt,W,V,cn,[J,ee*cn],re,ve,_e,Ue>=17?0:ot*cn,ze?ze.size[0]:0),Qt=[];xe&&Qt.push(ct.hiddenByLandmarkVertexBuffer),f.uploadCommonUniforms(Ne,Et,ht.toUnwrapped(),null,Qe),Et.draw(f,Ne.gl.TRIANGLES,b,S,E,O,nn,l.id,ct.vertexBuffer,ct.indexBuffer,Ct,l.paint,Ue,qt,Qt)};for(const ht of p){const ct=r.getTile(ht),Ct=ct.getBucket(l);if(!Ct||Ct.projection.name!==je.projection.name||!Ct.groundEffect||Ct.groundEffect&&!Ct.groundEffect.hasData())continue;const Kt=Ct.groundEffect,cn=1/Ct.tileToMeter;{const qt=f.translatePosMatrix(ht.projMatrix,ct,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),yn=Kt.getDefaultSegment();gt(ht,Kt,yn,qt,cn)}if(we)for(let qt=0;qt<4;qt++){const yn=o.c$[qt](ht),Et=r.getTile(yn);if(!Et)continue;const nn=Et.getBucket(l);if(!nn||nn.projection.name!==je.projection.name||!nn.groundEffect||nn.groundEffect&&!nn.groundEffect.hasData())continue;const Qt=nn.groundEffect;let bn,wn;qt===0?(bn=[-o.ab,0,0],wn=1):qt===1?(bn=[o.ab,0,0],wn=0):qt===2?(bn=[0,-o.ab,0],wn=3):(bn=[0,o.ab,0],wn=2);const an=Qt.regionSegments[wn];if(!an)continue;const pn=new Float32Array(16);o.a6.mat4.translate(pn,ht.projMatrix,bn),gt(ht,Qt,an,f.translatePosMatrix(pn,ct,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),cn)}}}function Al(f,r,l,p,b,S,E){p.centroidVertexArray.length===0&&p.createCentroidsBuffer();const O=S?S.findDEMTileFor(l):null;if(!(O&&O.dem||E))return;const V=we=>new o.P(Math.ceil((we+o.d2)*o.d3),0),H=we=>{const ze=r.getSource().minzoom,Ne=je=>{const Ue=r.getTileByID(je);if(Ue&&Ue.hasData())return Ue.getBucket(b)},Le=[0,-1,1];for(const je of Le){if(we.overscaledZ+je<ze)continue;const Ue=Ne(we.calculateScaledKey(we.overscaledZ+je));if(Ue)return Ue}},W=[0,0,0],J=(we,ze)=>(W[0]=Math.min(we.min.y,ze.min.y),W[1]=Math.max(we.max.y,ze.max.y),W[2]=o.ab-ze.min.x>we.max.x?ze.min.x-o.ab:we.max.x,W),ee=(we,ze)=>(W[0]=Math.min(we.min.x,ze.min.x),W[1]=Math.max(we.max.x,ze.max.x),W[2]=o.ab-ze.min.y>we.max.y?ze.min.y-o.ab:we.max.y,W),re=[(we,ze)=>J(we,ze),(we,ze)=>J(ze,we),(we,ze)=>ee(we,ze),(we,ze)=>ee(ze,we)],ve=(we,ze,Ne,Le,je,Ue,rt)=>{if(!S)return 0;const Qe=[[Ue?Ne:we,Ue?we:Ne,0],[Ue?Ne:ze,Ue?ze:Ne,0]],ot=rt<0?o.ab+rt:rt,gt=[Ue?ot:(we+ze)/2,Ue?(we+ze)/2:ot,0];return Ne===0&&rt<0||Ne!==0&&rt>0?S.getForTilePoints(je,[gt],!0,Le):Qe.push(gt),S.getForTilePoints(l,Qe,!0,O),Math.max(Qe[0][2],Qe[1][2],gt[2])/S.exaggeration()};for(let we=0;we<4;we++){const ze=p.borderFeatureIndices[we];if(ze.length===0)continue;const Ne=o.c$[we](l),Le=H(Ne);if(!(Le&&Le instanceof o.d0)||p.borderDoneWithNeighborZ[we]===Le.canonical.z)continue;Le.centroidVertexArray.length===0&&Le.createCentroidsBuffer();const je=S?S.findDEMTileFor(Ne):null;if(!(je&&je.dem||E))continue;const Ue=(we<2?1:5)-we,rt=Le.borderDoneWithNeighborZ[Ue]!==p.canonical.z,Qe=Le.borderFeatureIndices[Ue];let ot=0;if(p.canonical.z!==Le.canonical.z){for(const gt of ze)p.showCentroid(p.featuresOnBorder[gt]);if(rt)for(const gt of Qe)Le.showCentroid(Le.featuresOnBorder[gt]);p.borderDoneWithNeighborZ[we]=Le.canonical.z,Le.borderDoneWithNeighborZ[Ue]=p.canonical.z}for(const gt of ze){const ht=p.featuresOnBorder[gt],ct=p.centroidData[ht.centroidDataIndex],Ct=ht.borders[we];let Kt;for(;ot<Qe.length;){Kt=Le.featuresOnBorder[Qe[ot]];const cn=Kt.borders[Ue];if(cn[1]>Ct[0]+3||cn[0]>Ct[0]-3)break;Le.showCentroid(Kt),ot++}if(Kt&&ot<Qe.length){const cn=ot;let qt=0;for(;!(Kt.borders[Ue][0]>Ct[1]-3)&&(qt++,++ot!==Qe.length);)Kt=Le.featuresOnBorder[Qe[ot]];Kt=Le.featuresOnBorder[Qe[cn]];let yn=!1;if(qt>=1){const Qt=Kt.borders[Ue];Math.abs(Ct[0]-Qt[0])<3&&Math.abs(Ct[1]-Qt[1])<3&&(qt=1,yn=!0,ot=cn+1)}else if(qt===0){p.showCentroid(ht);continue}const Et=Le.centroidData[Kt.centroidDataIndex];E&&yn&&(((_e=ct).flags|(xe=Et).flags)&o.d1?(_e.flags|=o.d1,xe.flags|=o.d1):(_e.flags&=~o.d1,xe.flags&=~o.d1));const nn=ht.intersectsCount()>1||Kt.intersectsCount()>1;if(qt>1)ot=cn,ct.centroidXY=Et.centroidXY=new o.P(0,0);else if(je&&je.dem&&!nn){const Qt=re[we](ct,Et),bn=we%2?o.ab-1:0,wn=ve(Qt[0],Math.min(o.ab-1,Qt[1]),bn,je,Ne,we<2,Qt[2]);ct.centroidXY=Et.centroidXY=V(wn)}else nn?ct.centroidXY=Et.centroidXY=new o.P(0,0):(ct.centroidXY=p.encodeBorderCentroid(ht),Et.centroidXY=Le.encodeBorderCentroid(Kt));p.writeCentroidToBuffer(ct),Le.writeCentroidToBuffer(Et)}else p.showCentroid(ht)}p.borderDoneWithNeighborZ[we]=Le.canonical.z,Le.borderDoneWithNeighborZ[Ue]=p.canonical.z}var _e,xe;(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(f)}const Y_=[1,0,0],Hm=[0,1,0],Gm=[0,0,1];function Wm(f,r,l){const p=l.transform,b=l.shadowRenderer;if(!b)return!0;const S=f.toUnwrapped(),E=p.tileSize*b._cascades[l.currentShadowCascade].scale;let O=r.maxHeight;if(p.elevation){const _e=p.elevation.getMinMaxForTile(f);_e&&(O+=_e.max)}const V=[...b.shadowDirection];V[2]=-V[2];const H=b.computeSimplifiedTileShadowVolume(S,O,E,V);if(!H)return!1;const W=[Y_,Hm,Gm,V,[V[0],0,V[2]],[0,V[1],V[2]]],J=p.projection.name==="globe",ee=p.scaleZoom(E),re=o.bN.fromInvProjectionMatrix(p.invProjMatrix,p.worldSize,ee,!J),ve=b.getCurrentCascadeFrustum();return re.intersectsPrecise(H.vertices,H.planes,W)===0||ve.intersectsPrecise(H.vertices,H.planes,W)===0}function qm(f){return[f[0]*o.d4,f[1]*o.d4,f[2]*o.d4,0]}function us(f,r,l,p,b,S,E,O,V){const H=p.getSource(),W=l.globeSharedBuffers;if(!W)return;let J,ee,re;if(r&&(J=p.getTile(r)),H instanceof o.aD?(ee=H.texture,re=o.cD(0,0,l.transform)):J&&r&&(ee=J.texture,re=o.cD(r.canonical.z,r.canonical.x,l.transform)),!ee||!re)return;f||(re=o.a6.mat4.scale(o.a6.mat4.create(),re,[1,-1,1]));const ve=l.context,_e=ve.gl,xe=b.paint.get("raster-resampling")==="nearest"?_e.NEAREST:_e.LINEAR,we=l.colorModeForDrapableLayerRenderPass(S),ze=E.defines;ze.push("GLOBE_POLES");const Ne=new or(_e.LEQUAL,or.ReadWrite,l.depthRangeFor3D),Le=Float32Array.from(l.transform.expandedFarZProjMatrix),je=Float32Array.from(o.b5(o.cC(new o.bP(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),ve.activeTexture.set(_e.TEXTURE0),ee.bind(xe,_e.CLAMP_TO_EDGE),ve.activeTexture.set(_e.TEXTURE1),ee.bind(xe,_e.CLAMP_TO_EDGE),ee.useMipmap&&ve.extTextureFilterAnisotropic&&l.transform.pitch>20&&_e.texParameterf(_e.TEXTURE_2D,ve.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ve.extTextureFilterAnisotropicMax);const[Ue,rt,Qe,ot]=r?W.getPoleBuffers(r.canonical.z,!1):W.getPoleBuffers(0,!0),gt=b.paint.get("raster-elevation");let ht;f?(ht=Ue,l.renderDefaultNorthPole=gt!==0):(ht=rt,l.renderDefaultSouthPole=gt!==0);const ct=qm(E.mix),Ct=((cn,qt,yn,Et,nn,Qt,bn,wn,an,pn,er,Mn,$n)=>Pd(cn,qt,yn,new Float32Array(16),new Float32Array(9),[0,0],Et,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Qt,[0,0],wn,2,pn,er,Mn,1,0,$n))(Le,je,re,o.a9(l.transform.zoom),0,b,0,gt,0,ct,E.offset,E.range,S),Kt=l.getOrCreateProgram("raster",{defines:ze});l.uploadCommonUniforms(ve,Kt,null),Kt.draw(l,_e.TRIANGLES,Ne,V,we,O,Ct,b.id,ht,Qe,ot)}function Ko(f){const r=f._nearZ,l=f.projection.farthestPixelDistance(f),p=l-r,b=.2*f.height,S=r+b;return[r,l,(S-b-r)/p,(S-r)/p]}function Tf(f,r,l,p){if(f)return r instanceof Nc&&f instanceof Vh?r.getTextureDescriptor(f,l,!0):{texture:f.texture,mix:qm(p.mix),offset:p.offset,buffer:0,tileSize:1}}var Km=o.d5([{name:"a_index",type:"Int16",components:1}]);class X_{constructor(r,l,p,b){const S={width:p[0],height:p[1],data:null},E=r.gl;this.targetColorTexture=new o.T(r,S,E.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new o.T(r,S,E.RGBA8,{useMipmap:!1}),this.context=r,this.updateParticleTexture(l,b),this.lastInvalidatedAt=0}updateParticleTexture(r,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const p=this.context.gl,b=l.width*l.height;this.particleTexture0=new o.T(this.context,l,p.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new o.T(this.context,l,p.RGBA8,{premultiply:!1,useMipmap:!1});const S=new o.d6;S.reserve(b);for(let E=0;E<b;E++)S.emplaceBack(E);this.particleIndexBuffer=this.context.createVertexBuffer(S,Km.members,!0),this.particleSegment=o.b1.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=o.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function J_(f,r,l){if(!f)return null;const p=r.getTextureDescriptor(f,l,!0);if(!p)return null;let{texture:b,mix:S,offset:E,tileSize:O,buffer:V,format:H}=p;if(!b||!H)return null;let W=!1;return H==="uint32"&&(W=!0,S[3]=0,S=mf(o.d7,S,[0,l.paint.get("raster-particle-max-speed")]),E=gf(o.d7,E,[0,l.paint.get("raster-particle-max-speed")])),{texture:b,textureOffset:[V/(O+2*V),O/(O+2*V)],tileSize:O,scalarData:W,scale:S,offset:E,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[H]]}}function Q_(f){const r=f._nearZ,l=f.projection.farthestPixelDistance(f),p=l-r,b=.2*f.height,S=r+b;return[r,l,(S-b-r)/p,(S-r)/p]}const E1=new o.bz(1,0,0,1),du=new o.bz(0,1,0,1),hu=new o.bz(0,0,1,1),Sn=new o.bz(1,0,1,1),Qn=new o.bz(0,1,1,1);function ia(f,r,l,p,b,S,E){const O=f.context,V=f.transform,H=O.gl,W=V.projection.name==="globe",J=W?["PROJECTION_GLOBE_VIEW"]:[];let ee=o.a6.mat4.clone(l.projMatrix);if(W&&o.a9(V.zoom)>0){const ct=o.b4(l.canonical,V),Ct=o.d8(ct);ee=o.a6.mat4.multiply(new Float32Array(16),V.globeMatrix,Ct),o.a6.mat4.multiply(ee,V.projMatrix,ee)}const re=o.a6.mat4.create();re[12]+=2*b/(o.q.devicePixelRatio*V.width),re[13]+=2*S/(o.q.devicePixelRatio*V.height),o.a6.mat4.multiply(ee,re,ee);const ve=f.getOrCreateProgram("debug",{defines:J}),_e=r.getTileByID(l.key);f.terrain&&f.terrain.setupElevationDraw(_e,ve);const xe=or.disabled,we=Mr.disabled,ze=f.colorModeForRenderPass(),Ne="$debug";O.activeTexture.set(H.TEXTURE0),f.emptyTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),W?_e._makeGlobeTileDebugBuffers(f.context,V):_e._makeDebugTileBoundsBuffers(f.context,V.projection);const Le=_e._tileDebugBuffer||f.debugBuffer,je=_e._tileDebugIndexBuffer||f.debugIndexBuffer,Ue=_e._tileDebugSegments||f.debugSegments;if(ve.draw(f,H.LINE_STRIP,xe,we,ze,yr.disabled,G_(ee,p),Ne,Le,je,Ue,null,null,null,[_e._globeTileDebugBorderBuffer]),E){const ct=_e.latestRawTileData,Ct=Math.floor((ct&&ct.byteLength||0)/1024);let Kt=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(Kt+=` => ${l.overscaledZ}`),Kt+=` ${_e.state}`,Kt+=` ${Ct}kb`,function(cn,qt){cn.initDebugOverlayCanvas();const yn=cn.debugOverlayCanvas,Et=cn.context.gl,nn=cn.debugOverlayCanvas.getContext("2d");nn.clearRect(0,0,yn.width,yn.height),nn.shadowColor="white",nn.shadowBlur=2,nn.lineWidth=1.5,nn.strokeStyle="white",nn.textBaseline="top",nn.font="bold 36px Open Sans, sans-serif",nn.fillText(qt,5,5),nn.strokeText(qt,5,5),cn.debugOverlayTexture.update(yn),cn.debugOverlayTexture.bind(Et.LINEAR,Et.CLAMP_TO_EDGE)}(f,Kt)}const rt=r.getTile(l).tileSize,Qe=512/Math.min(rt,512)*(l.overscaledZ/V.zoom)*.5,ot=_e._tileDebugTextBuffer||f.debugBuffer,gt=_e._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,ht=_e._tileDebugTextSegments||f.debugSegments;ve.draw(f,H.TRIANGLES,xe,we,Ur.alphaBlended,yr.disabled,G_(ee,o.bz.transparent,Qe),Ne,ot,gt,ht,null,null,null,[_e._globeTileDebugTextBuffer])}function $o(f,r,l,p){Od(f,0,r+l/2,f.transform.width,l,p)}function Dt(f,r,l,p){Od(f,r-l/2,0,l,f.transform.height,p)}function Od(f,r,l,p,b,S){const E=f.context,O=E.gl;O.enable(O.SCISSOR_TEST),O.scissor(r*o.q.devicePixelRatio,l*o.q.devicePixelRatio,p*o.q.devicePixelRatio,b*o.q.devicePixelRatio),E.clear({color:S}),O.disable(O.SCISSOR_TEST)}const Cf=o.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Zm}=Cf;function sa(f,r,l,p){f.emplaceBack(r,l,p)}class Ym{constructor(r){this.vertexArray=new o.d9,this.indices=new o.aO,sa(this.vertexArray,-1,-1,1),sa(this.vertexArray,1,-1,1),sa(this.vertexArray,-1,1,1),sa(this.vertexArray,1,1,1),sa(this.vertexArray,-1,-1,-1),sa(this.vertexArray,1,-1,-1),sa(this.vertexArray,-1,1,-1),sa(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,Zm),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=o.b1.simpleSegment(0,0,36,12)}}function fc(f,r,l,p,b,S){const E=f.context.gl,O=r.paint.get("sky-atmosphere-color"),V=r.paint.get("sky-atmosphere-halo-color"),H=r.paint.get("sky-atmosphere-sun-intensity"),W=((J,ee,re,ve,_e)=>({u_matrix_3f:J,u_sun_direction:ee,u_sun_intensity:re,u_color_tint_r:[ve.r,ve.g,ve.b,ve.a],u_color_tint_m:[_e.r,_e.g,_e.b,_e.a],u_luminance:5e-5}))(o.a6.mat3.fromMat4(o.a6.mat3.create(),p),b,H,O,V);E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+S,r.skyboxTexture,0),l.draw(f,E.TRIANGLES,or.disabled,Mr.disabled,Ur.unblended,yr.frontCW,W,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const fu=o.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class M1{constructor(r){const l=new o.da;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const p=new o.aO;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(l,fu.members),this.indexBuffer=r.createIndexBuffer(p),this.segments=o.b1.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const I1=o.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class ey{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Ef{constructor(r){this.colorModeAlphaBlendedWriteRGB=new Ur([1,ws,1,ws],o.bz.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Ur([1,0,1,0],o.bz.transparent,[!1,!1,!1,!0]),this.params=new ey,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const l=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new M1(l);const p=this.params.sizeRange,b=this.params.intensityRange,S=function(W){const J=o.dd(30),ee=[];for(let re=0;re<W;++re){const ve=2*Math.PI*J(),_e=Math.acos(1-2*J())-.5*Math.PI;ee.push(o.a6.vec3.fromValues(Math.cos(_e)*Math.cos(ve),Math.cos(_e)*Math.sin(ve),Math.sin(_e)))}return ee}(this.params.starsCount),E=o.dd(300),O=new o.db,V=new o.aO;let H=0;for(let W=0;W<S.length;++W){const J=o.a6.vec3.scale([],S[W],200),ee=Math.max(0,1+.01*p*(1*E()-.5)),re=Math.max(0,1+.01*b*(1*E()-.5));O.emplaceBack(J[0],J[1],J[2],-1,-1,ee,re),O.emplaceBack(J[0],J[1],J[2],1,-1,ee,re),O.emplaceBack(J[0],J[1],J[2],1,1,ee,re),O.emplaceBack(J[0],J[1],J[2],-1,1,ee,re),V.emplaceBack(H+0,H+1,H+2),V.emplaceBack(H+0,H+2,H+3),H+=4}this.starsVx=l.createVertexBuffer(O,I1.members),this.starsIdx=l.createIndexBuffer(V),this.starsSegments=o.b1.simpleSegment(0,0,O.length,V.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,l){const p=r.context,b=p.gl,S=r.transform,E=new or(b.LEQUAL,or.ReadOnly,[0,1]),O=o.a9(S.zoom),V=r.style.getLut(l.scope),H=l.properties.get("color").toRenderColor(V).toArray01(),W=l.properties.get("high-color").toRenderColor(V).toArray01(),J=l.properties.get("space-color").toRenderColor(V).toArray01PremultipliedAlpha(),ee=5e-4,re=o.dc(l.properties.get("horizon-blend"),0,1,ee,.25),ve=o.cx(r,p,S)&&re===ee?S.worldSize/(2*Math.PI*1.025)-1:S.globeRadius,_e=r.frameCounter/1e3%1,xe=o.a6.vec3.length(S.globeCenterInViewSpace),we=Math.sqrt(Math.pow(xe,2)-Math.pow(ve,2)),ze=Math.acos(we/xe),Ne=Le=>{const je=S.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Le&&je.push("ALPHA_PASS");const Ue=r.getOrCreateProgram("globeAtmosphere",{defines:je}),rt=((ot,gt,ht,ct,Ct,Kt,cn,qt,yn,Et,nn,Qt)=>({u_frustum_tl:ot,u_frustum_tr:gt,u_frustum_br:ht,u_frustum_bl:ct,u_horizon:Ct,u_transition:Kt,u_fadeout_range:cn,u_color:qt,u_high_color:yn,u_space_color:Et,u_temporal_offset:nn,u_horizon_angle:Qt}))(S.frustumCorners.TL,S.frustumCorners.TR,S.frustumCorners.BR,S.frustumCorners.BL,S.frustumCorners.horizon,O,re,H,W,J,_e,ze);r.uploadCommonUniforms(p,Ue);const Qe=this.atmosphereBuffer;Qe&&Ue.draw(r,b.TRIANGLES,E,Mr.disabled,Le?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,yr.backCW,rt,Le?"atmosphere_glow_alpha":"atmosphere_glow",Qe.vertexBuffer,Qe.indexBuffer,Qe.segments)};Ne(!1),Ne(!0)}drawStars(r,l){const p=o.ap(l.properties.get("star-intensity"),0,1);if(p===0)return;const b=r.context,S=b.gl,E=r.transform,O=r.getOrCreateProgram("stars"),V=o.a6.quat.identity([]);o.a6.quat.rotateX(V,V,-E._pitch),o.a6.quat.rotateZ(V,V,-E.angle),o.a6.quat.rotateX(V,V,o.bB(E._center.lat)),o.a6.quat.rotateY(V,V,-o.bB(E._center.lng));const H=o.a6.mat4.fromQuat(new Float32Array(16),V),W=o.a6.mat4.multiply([],E.starsProjMatrix,H),J=o.a6.mat3.fromMat4([],H),ee=o.a6.mat3.invert([],J),re=[0,1,0];o.a6.vec3.transformMat3(re,re,ee),o.a6.vec3.scale(re,re,this.params.sizeMultiplier);const ve=[1,0,0];o.a6.vec3.transformMat3(ve,ve,ee),o.a6.vec3.scale(ve,ve,this.params.sizeMultiplier);const _e=(xe=re,we=ve,ze=p,{u_matrix:Float32Array.from(W),u_up:xe,u_right:we,u_intensity_multiplier:ze});var xe,we,ze;r.uploadCommonUniforms(b,O),this.starsVx&&this.starsIdx&&O.draw(r,S.TRIANGLES,or.disabled,Mr.disabled,this.colorModeAlphaBlendedWriteRGB,yr.disabled,_e,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Mf(f,r){const l=[...f],p=r.cameraWorldSizeForFog/r.worldSize,b=o.a6.mat4.identity([]);return o.a6.mat4.scale(b,b,[p,p,1]),o.a6.mat4.multiply(l,b,l),o.a6.mat4.multiply(l,r.worldToFogMatrix,l),l}function If(f,r,l,p,b){const S=l.material,E=p.context,{baseColorTexture:O,metallicRoughnessTexture:V}=S.pbrMetallicRoughness,{normalTexture:H,occlusionTexture:W,emissionTexture:J}=S;function ee(re,ve,_e){if(re&&(f.push(ve),E.activeTexture.set(E.gl.TEXTURE0+_e),re.gfxTexture)){const{minFilter:xe,magFilter:we,wrapS:ze,wrapT:Ne}=re.sampler;re.gfxTexture.bindExtraParam(xe,we,ze,Ne)}}ee(O,"HAS_TEXTURE_u_baseColorTexture",Pi.BaseColor),ee(V,"HAS_TEXTURE_u_metallicRoughnessTexture",Pi.MetallicRoughness),ee(H,"HAS_TEXTURE_u_normalTexture",Pi.Normal),ee(W,"HAS_TEXTURE_u_occlusionTexture",Pi.Occlusion),ee(J,"HAS_TEXTURE_u_emissionTexture",Pi.Emission),b&&(b.texture||(b.texture=new o.df(p.context,b.image,[b.image.height,b.image.height,b.image.height],E.gl.RGBA8)),E.activeTexture.set(E.gl.TEXTURE0+Pi.LUT),b.texture&&b.texture.bind(E.gl.LINEAR,E.gl.CLAMP_TO_EDGE),f.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(f.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(l.texcoordBuffer)),l.colorBuffer&&(f.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(l.colorBuffer)),l.normalBuffer&&(f.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(l.normalBuffer)),l.pbrBuffer&&(f.push("HAS_ATTRIBUTE_a_pbr"),f.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(l.pbrBuffer)),S.alphaMode!=="OPAQUE"&&S.alphaMode!=="MASK"||f.push("UNPREMULT_TEXTURE_IN_SHADER"),S.defined||f.push("DIFFUSE_SHADED"),f.push("USE_STANDARD_DERIVATIVES")}function zd(f,r,l,p,b,S){const E=l.paint.get("model-opacity"),O=r.context,V=new or(r.context.gl.LEQUAL,or.ReadWrite,r.depthRangeFor3D),H=r.transform,W=f.mesh,J=W.material,ee=J.pbrMetallicRoughness,re=r.style.fog;let ve;ve=r.transform.projection.zAxisUnit==="pixels"?[...f.nodeModelMatrix]:o.a6.mat4.multiply([],p.zScaleMatrix,f.nodeModelMatrix),o.a6.mat4.multiply(ve,p.negCameraPosMatrix,ve);const _e=o.a6.mat4.invert([],ve);o.a6.mat4.transpose(_e,_e);const xe=l.paint.get("model-emissive-strength").constantOr(0),we=Gn(new Float32Array(f.worldViewProjection),new Float32Array(ve),new Float32Array(_e),null,r,E,ee.baseColorFactor.toRenderColor(null),J.emissiveFactor,ee.metallicFactor,ee.roughnessFactor,J,xe,l),ze={defines:[]},Ne=[];If(ze.defines,Ne,W,r,l.lut);const Le=r.shadowRenderer;Le&&(Le.useNormalOffset=!1);let je=null;if(re){const Qe=Mf(f.nodeModelMatrix,r.transform);if(je=new Float32Array(Qe),H.projection.name!=="globe"){const ot=W.aabb.min,gt=W.aabb.max,[ht,ct]=re.getOpacityForBounds(Qe,ot[0],ot[1],gt[0],gt[1]);ze.overrideFog=ht>=vn||ct>=vn}}const Ue=qa(r,l.paint.get("model-cutoff-fade-range"));Ue.shouldRenderCutoff&&ze.defines.push("RENDER_CUTOFF");const rt=r.getOrCreateProgram("model",ze);r.uploadCommonUniforms(O,rt,null,je,Ue),r.renderPass!=="shadow"&&Le&&Le.setupShadowsFromMatrix(f.nodeModelMatrix,rt),rt.draw(r,O.gl.TRIANGLES,V,b,S,W.material.doubleSided?yr.disabled:yr.backCCW,we,l.id,W.vertexBuffer,W.indexBuffer,W.segments,l.paint,r.transform.zoom,void 0,Ne)}function Bd(f,r,l,p,b,S,E){let O;O=f.projection.name==="globe"?o.dg(l,f):[...l],o.a6.mat4.multiply(O,O,r.matrix);const V=o.a6.mat4.multiply([],p,O);if(r.meshes)for(const H of r.meshes){if(H.material.alphaMode!=="BLEND"){E.push({mesh:H,depth:0,modelIndex:b,worldViewProjection:V,nodeModelMatrix:O});continue}const W=o.a6.vec3.transformMat4([],H.centroid,V);W[2]>0&&S.push({mesh:H,depth:W[2],modelIndex:b,worldViewProjection:V,nodeModelMatrix:O})}if(r.children)for(const H of r.children)Bd(f,H,l,p,b,S,E)}function pu(f,r,l,p){const b=l.shadowRenderer;if(!b)return;const S=b.getShadowPassDepthMode(),E=b.getShadowPassColorMode(),O=b.calculateShadowPassMatrixFromMatrix(r),V=Um(O);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,S,Mr.disabled,E,yr.backCCW,V,p.id,f.vertexBuffer,f.indexBuffer,f.segments,p.paint,l.transform.zoom,void 0,void 0)}function ty(f,r,l){const p=r.updateZoomBasedPaintProperties(),b=function(S,E,O){let V,H,W,J=S.terrain?S.terrain.exaggeration():0;if(S.terrain&&J>0){const ee=S.terrain,re=ee.findDEMTileFor(O);re&&re.dem?V=o.di.create(ee,O,re):J=0}if(J===0&&(E.terrainElevationMin=0,E.terrainElevationMax=0),J===E.validForExaggeration&&(J===0||V&&V._demTile&&V._demTile.tileID===E.validForDEMTile.id&&V._dem._timestamp===E.validForDEMTile.timestamp))return!1;for(const ee in E.instancesPerModel){const re=E.instancesPerModel[ee];for(let ve=0;ve<re.instancedDataArray.length;++ve){const _e=(V?J*V.getElevationAt(0|re.instancedDataArray.float32[16*ve],0|re.instancedDataArray.float32[16*ve+1],!0,!0):0)+re.instancesEvaluatedElevation[ve];re.instancedDataArray.float32[16*ve+6]=_e,H=H?Math.min(E.terrainElevationMin,_e):_e,W=W?Math.max(E.terrainElevationMax,_e):_e}}return E.terrainElevationMin=H||0,E.terrainElevationMax=W||0,E.validForExaggeration=J,E.validForDEMTile=V&&V._demTile?{id:V._demTile.tileID,timestamp:V._dem._timestamp}:{id:void 0,timestamp:0},!0}(f,r,l);(p||b)&&(r.uploaded=!1,r.upload(f.context))}const aa={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new o.c9([0,0,0],[o.ab,o.ab,0])};function k1(f,r){const l=1<<f.canonical.z,p=r.getFreeCameraOptions().position,b=r.elevation,S=f.canonical.x/l,E=(f.canonical.x+1)/l,O=f.canonical.y/l,V=(f.canonical.y+1)/l;let H=r._centerAltitude;if(b){const re=b.getMinMaxForTile(f);re&&re.max>H&&(H=re.max)}const W=o.ap(p.x,S,E)-p.x,J=o.ap(p.y,O,V)-p.y,ee=o.bD(H,r.center.lat)-p.z;return r._zoomFromMercatorZ(Math.sqrt(W*W+J*J+ee*ee))}function Ui(f,r,l,p,b,S,E){const O=f.context,V=f.renderPass==="shadow",H=f.shadowRenderer,W=V&&H?H.getShadowPassDepthMode():new or(O.gl.LEQUAL,or.ReadWrite,f.depthRangeFor3D),J=f.isTileAffectedByFog(S);if(l.meshes)for(const ee of l.meshes){const re=["MODEL_POSITION_ON_GPU"],ve=[];let _e,xe,we;p.instancedDataArray.length>20&&re.push("INSTANCED_ARRAYS");const ze=qa(f,r.paint.get("model-cutoff-fade-range"));if(ze.shouldRenderCutoff&&re.push("RENDER_CUTOFF"),V&&H)_e=f.getOrCreateProgram("modelDepth",{defines:re}),xe=Um(E.shadowTileMatrix,E.shadowTileMatrix,Float32Array.from(l.matrix)),we=H.getShadowPassColorMode();else{If(re,ve,ee,f,r.lut),_e=f.getOrCreateProgram("model",{defines:re,overrideFog:J});const Le=ee.material,je=Le.pbrMetallicRoughness,Ue=r.paint.get("model-opacity"),rt=r.paint.get("model-emissive-strength").constantOr(0);xe=Gn(S.expandedProjMatrix,Float32Array.from(l.matrix),new Float32Array(16),null,f,Ue,je.baseColorFactor.toRenderColor(null),Le.emissiveFactor,je.metallicFactor,je.roughnessFactor,Le,rt,r,b),H&&(E.shadowUniformsInitialized?_e.setShadowUniformValues(O,H.getShadowUniformValues()):(H.setupShadows(S.toUnwrapped(),_e,"model-tile",S.overscaledZ),E.shadowUniformsInitialized=!0)),we=ze.shouldRenderCutoff||Ue<1||Le.alphaMode!=="OPAQUE"?Ur.alphaBlended:Ur.unblended}f.uploadCommonUniforms(O,_e,S.toUnwrapped(),null,ze);const Ne=ee.material.doubleSided?yr.disabled:yr.backCCW;if(p.instancedDataArray.length>20)ve.push(p.instancedDataBuffer),_e.draw(f,O.gl.TRIANGLES,W,Mr.disabled,we,Ne,xe,r.id,ee.vertexBuffer,ee.indexBuffer,ee.segments,r.paint,f.transform.zoom,void 0,ve,p.instancedDataArray.length);else{const Le=V?"u_instance":"u_normal_matrix";for(let je=0;je<p.instancedDataArray.length;++je)xe[Le]=new Float32Array(p.instancedDataArray.arrayBuffer,64*je,16),_e.draw(f,O.gl.TRIANGLES,W,Mr.disabled,we,Ne,xe,r.id,ee.vertexBuffer,ee.indexBuffer,ee.segments,r.paint,f.transform.zoom,void 0,ve)}}if(l.children)for(const ee of l.children)Ui(f,r,ee,p,b,S,E)}const A1=[1,-1,1];function Fd(f,r,l,p){if(!l.modelManager)return!0;const b=l.modelManager;if(!l.shadowRenderer)return!0;const S=l.shadowRenderer,E=r.aabb;let O=!0,V=f.maxHeight;if(V===0){let W=0;for(const J in f.instancesPerModel){const ee=b.getModel(J,p);ee?W=Math.max(W,Math.max(Math.max(ee.aabb.max[0],ee.aabb.max[1]),ee.aabb.max[2])):O=!1}V=f.maxScale*W*1.41+f.maxVerticalOffset,O&&(f.maxHeight=V)}E.max[2]=V,E.min[2]+=f.terrainElevationMin,E.max[2]+=f.terrainElevationMax,o.a6.vec3.transformMat4(E.min,E.min,r.tileMatrix),o.a6.vec3.transformMat4(E.max,E.max,r.tileMatrix);const H=E.intersects(S.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(f.isInsideFirstShadowMapFrustum=H===2),H===0}function zo(f,r){const l=f.uniformValues.u_cutoff_params[0],p=f.uniformValues.u_cutoff_params[1],b=f.uniformValues.u_cutoff_params[2],S=f.uniformValues.u_cutoff_params[3];return p===l||S===b?1:o.ap(((r-l)/(p-l)-b)/(S-b),0,1)}function oo(f,r,l,p){if(r.pitch<20)return 1;const b=r.getWorldToCameraMatrix();o.a6.mat4.multiply(b,b,f);const S=o.a6.vec4.fromValues(l.min[0],l.min[1],l.min[2],1);let E=o.a6.vec4.transformMat4(o.a6.vec4.create(),S,b),O=E,V=E;S[1]=l.max[1],E=o.a6.vec4.transformMat4(o.a6.vec4.create(),S,b),O=E[1]<O[1]?E:O,V=E[1]>V[1]?E:V,S[0]=l.max[0],E=o.a6.vec4.transformMat4(o.a6.vec4.create(),S,b),O=E[1]<O[1]?E:O,V=E[1]>V[1]?E:V,S[1]=l.min[1],E=o.a6.vec4.transformMat4(o.a6.vec4.create(),S,b),O=E[1]<O[1]?E:O,V=E[1]>V[1]?E:V;const H=o.ap(p[0],0,1),W=100*r.pixelsPerMeter*o.ap(p[1],0,1),J=o.ap(p[2],0,1),ee=o.a6.vec4.lerp(o.a6.vec4.create(),O,V,H),re=Math.tan(.5*r.fovX),ve=-ee[2]*re;if(W===0)return ee[1]<-Math.abs(ve)?J:1;const _e=(-Math.abs(ve)-ee[1])/W,xe=(ze,Ne,Le)=>(1-Le)*ze+Le*Ne,we=o.ap(xe(1,J,_e),J,1);return xe(1,we,o.ap((r.pitch-20)/20,0,1))}class ny{}class Pl{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,l,p){{const J=this._storage.get(l.id);if(J)return J.lastUsedFrameIdx=r,J.buf}const b=p.gl,S=b.getBufferParameter(b.ELEMENT_ARRAY_BUFFER,b.BUFFER_SIZE),E=new ArrayBuffer(S),O=new Int16Array(E);b.getBufferSubData(b.ELEMENT_ARRAY_BUFFER,0,new Int16Array(E));const V=new o.dk;for(let J=0;J<S/2;J+=3){const ee=O[J],re=O[J+1],ve=O[J+2];V.emplaceBack(ee,re),V.emplaceBack(re,ve),V.emplaceBack(ve,ee)}const H=p.bindVertexArrayOES.current,W=new ny;return W.buf=new cs(p,V),W.lastUsedFrameIdx=r,this._storage.set(l.id,W),p.bindVertexArrayOES.set(H),W.buf}update(r){for(const[l,p]of this._storage)r-p.lastUsedFrameIdx>30&&(p.buf.destroy(),this._storage.delete(l))}destroy(){for(const[r,l]of this._storage)l.buf.destroy(),this._storage.delete(r)}}class kf{constructor(r){this.occluderSize=30,this.depthOffset=-1e-4,r.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),r.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Rl={symbol:function(f,r,l,p,b){if(f.renderPass!=="translucent")return;const S=Mr.disabled,E=f.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(H,W,J,ee,re,ve,_e){const xe=W.transform,we=re==="map",ze=ve==="map";for(const Ne of H){const Le=ee.getTile(Ne),je=Le.getBucket(J);if(!je||!je.text||!je.text.segments.get().length)continue;const Ue=o.bj(je.textSizeData,xe.zoom),rt=Cl(Ne,je.getProjection(),xe),Qe=xe.calculatePixelsToTileUnitsMatrix(Le),ot=qr(rt,Le.tileID.canonical,ze,we,xe,je.getProjection(),Qe),gt=je.hasIconTextFit()&&je.hasIconData();if(Ue){const ht=Math.pow(2,xe.zoom-Le.tileID.overscaledZ);C1(je,we,ze,_e,o.cS,xe,ot,Ne,ht,Ue,gt)}}}(p,f,l,r,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),b);const O=l.paint.get("icon-opacity").constantOr(1)!==0,V=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(O||V)?Dd(f,r,l,p,S,E):(O&&Dd(f,r,l,p,S,E,{onlyIcons:!0}),V&&Dd(f,r,l,p,S,E,{onlyText:!0})),r.map.showCollisionBoxes&&(wf(f,r,l,p,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),wf(f,r,l,p,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(f,r,l,p){if(f.renderPass!=="translucent")return;const b=l.paint.get("circle-opacity"),S=l.paint.get("circle-stroke-width"),E=l.paint.get("circle-stroke-opacity"),O=l.layout.get("circle-sort-key").constantOr(1)!==void 0,V=l.paint.get("circle-emissive-strength");if(b.constantOr(1)===0&&(S.constantOr(1)===0||E.constantOr(1)===0))return;const H=f.context,W=H.gl,J=f.transform,ee=f.depthModeForSublayer(0,or.ReadOnly),re=Mr.disabled,ve=f.colorModeForDrapableLayerRenderPass(V),_e=J.projection.name==="globe",xe=[o.am(J.center.lng),o.at(J.center.lat)],we=[];for(let Ne=0;Ne<p.length;Ne++){const Le=p[Ne],je=r.getTile(Le),Ue=je.getBucket(l);if(!Ue||Ue.projection.name!==J.projection.name)continue;const rt=Ue.programConfigurations.get(l.id),Qe=o.cT(l),ot=f.isTileAffectedByFog(Le);_e&&Qe.push("PROJECTION_GLOBE_VIEW"),Qe.push("DEPTH_D24"),f.terrain&&J.depthOcclusionForSymbolsAndCircles&&Qe.push("DEPTH_OCCLUSION");const gt=f.getOrCreateProgram("circle",{config:rt,defines:Qe,overrideFog:ot}),ht=Ue.layoutVertexBuffer,ct=Ue.globeExtVertexBuffer,Ct=Ue.indexBuffer,Kt=J.projection.createInversionMatrix(J,Le.canonical),cn={programConfiguration:rt,program:gt,layoutVertexBuffer:ht,globeExtVertexBuffer:ct,indexBuffer:Ct,uniformValues:o.cU(f,Le,je,Kt,xe,l),tile:je};if(O){const qt=Ue.segments.get();for(const yn of qt)we.push({segments:new o.b1([yn]),sortKey:yn.sortKey,state:cn})}else we.push({segments:Ue.segments,sortKey:0,state:cn})}O&&we.sort((Ne,Le)=>Ne.sortKey-Le.sortKey);const ze={useDepthForOcclusion:J.depthOcclusionForSymbolsAndCircles};for(const Ne of we){const{programConfiguration:Le,program:je,layoutVertexBuffer:Ue,globeExtVertexBuffer:rt,indexBuffer:Qe,uniformValues:ot,tile:gt}=Ne.state,ht=Ne.segments;f.terrain&&f.terrain.setupElevationDraw(gt,je,ze),f.uploadCommonUniforms(H,je,gt.tileID.toUnwrapped()),je.draw(f,W.TRIANGLES,ee,re,ve,yr.disabled,ot,l.id,Ue,Qe,ht,l.paint,J.zoom,Le,[rt])}},heatmap:function(f,r,l,p){if(l.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const b=f.context,S=b.gl,E=Mr.disabled,O=new Ur([S.ONE,S.ONE,S.ONE,S.ONE],o.bz.transparent,[!0,!0,!0,!0]);(function(re,ve,_e,xe){const we=re.gl,ze=ve.width*xe,Ne=ve.height*xe;re.activeTexture.set(we.TEXTURE1),re.viewport.set([0,0,ze,Ne]);let Le=_e.heatmapFbo;if(!Le||Le&&(Le.width!==ze||Le.height!==Ne)){Le&&Le.destroy();const je=we.createTexture();we.bindTexture(we.TEXTURE_2D,je),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_S,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_T,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MIN_FILTER,we.LINEAR),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MAG_FILTER,we.LINEAR),Le=_e.heatmapFbo=re.createFramebuffer(ze,Ne,!0,null),function(Ue,rt,Qe,ot,gt,ht){const ct=Ue.gl;ct.texImage2D(ct.TEXTURE_2D,0,Ue.extRenderToTextureHalfFloat?ct.RGBA16F:ct.RGBA,gt,ht,0,ct.RGBA,Ue.extRenderToTextureHalfFloat?ct.HALF_FLOAT:ct.UNSIGNED_BYTE,null),ot.colorAttachment.set(Qe)}(re,0,je,Le,ze,Ne)}else we.bindTexture(we.TEXTURE_2D,Le.colorAttachment.get()),re.bindFramebuffer.set(Le.framebuffer)})(b,f,l,f.transform.projection.name==="globe"?.5:.25),b.clear({color:o.bz.transparent});const V=f.transform,H=V.projection.name==="globe",W=H?["PROJECTION_GLOBE_VIEW"]:[],J=H?yr.frontCCW:yr.disabled,ee=[o.am(V.center.lng),o.at(V.center.lat)];for(let re=0;re<p.length;re++){const ve=p[re];if(r.hasRenderableParent(ve))continue;const _e=r.getTile(ve),xe=_e.getBucket(l);if(!xe||xe.projection.name!==V.projection.name)continue;const we=f.isTileAffectedByFog(ve),ze=xe.programConfigurations.get(l.id),Ne=f.getOrCreateProgram("heatmap",{config:ze,defines:W,overrideFog:we}),{zoom:Le}=f.transform;f.terrain&&f.terrain.setupElevationDraw(_e,Ne),f.uploadCommonUniforms(b,Ne,ve.toUnwrapped());const je=V.projection.createInversionMatrix(V,ve.canonical);Ne.draw(f,S.TRIANGLES,or.disabled,E,O,J,w1(f,ve,_e,je,ee,Le,l.paint.get("heatmap-intensity")),l.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,l.paint,f.transform.zoom,ze,H?[xe.globeExtVertexBuffer]:null)}b.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(b,S){const E=b.context,O=E.gl,V=S.heatmapFbo;if(!V)return;E.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,V.colorAttachment.get()),E.activeTexture.set(O.TEXTURE1);let H=S.colorRampTexture;H||(H=S.colorRampTexture=new o.T(E,S.colorRamp,O.RGBA8)),H.bind(O.LINEAR,O.CLAMP_TO_EDGE),b.getOrCreateProgram("heatmapTexture").draw(b,O.TRIANGLES,or.disabled,Mr.disabled,b.colorModeForRenderPass(),yr.disabled,((W,J,ee,re)=>({u_image:0,u_color_ramp:1,u_opacity:J.paint.get("heatmap-opacity")}))(0,S),S.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,S.paint,b.transform.zoom)}(f,l))},line:function(f,r,l,p){if(f.renderPass!=="translucent")return;const b=l.paint.get("line-opacity"),S=l.paint.get("line-width");if(b.constantOr(1)===0||S.constantOr(1)===0)return;const E=l.paint.get("line-emissive-strength"),O=l.paint.get("line-occlusion-opacity"),V=f.context,H=V.gl,W=l.layout.get("line-z-offset"),J=!W.isConstant()||!!W.constantOr(0),ee=J?new or(f.depthOcclusion?H.GREATER:H.LEQUAL,or.ReadOnly,f.depthRangeFor3D):f.depthModeForSublayer(0,or.ReadOnly),re=f.colorModeForDrapableLayerRenderPass(E),ve=f.terrain&&f.terrain.renderingToTexture,_e=ve?1:o.q.devicePixelRatio,xe=l.paint.get("line-dasharray"),we=xe.constantOr(1),ze=l.layout.get("line-cap"),Ne=xe.constantOr(null),Le=ze.constantOr(null),je=l.paint.get("line-pattern"),Ue=je.constantOr(1),rt=je.constantOr(null),Qe=l.paint.get("line-opacity").constantOr(1);let ot=!Ue&&Qe!==1||f.depthOcclusion&&O>0&&O<1;const gt=l.paint.get("line-gradient"),ht=Ue?"linePattern":"line",ct=o.cV(l);let Ct;if(ve&&f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(ot=!1),O!==0&&f.depthOcclusion){const cn=l.paint._values["line-opacity"];cn&&cn.value&&cn.value.kind==="constant"?Ct=cn.value:o.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}if(J&&(f.forceTerrainMode=!0),!J&&O!==0&&f.terrain&&!ve)return void o.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const Kt=ot&&J?f.stencilModeFor3D():Mr.disabled;for(const cn of p){const qt=r.getTile(cn);if(Ue&&!qt.patternsLoaded())continue;const yn=qt.getBucket(l);if(!yn)continue;f.prepareDrawTile();const Et=yn.programConfigurations.get(l.id),nn=f.isTileAffectedByFog(cn),Qt=f.getOrCreateProgram(ht,{config:Et,defines:J?[...ct,"ELEVATED"]:ct,overrideFog:nn});if(rt&&qt.imageAtlas){const Mn=qt.imageAtlas.patternPositions[rt.toString()];Mn&&Et.setConstantPatternPositions(Mn)}if(!Ue&&Ne&&Le&&qt.lineAtlas){const Mn=qt.lineAtlas.getDash(Ne,Le);Mn&&Et.setConstantPatternPositions(Mn)}let[bn,wn]=l.paint.get("line-trim-offset");(Le==="round"||Le==="square")&&bn!==wn&&(bn===0&&(bn-=1),wn===1&&(wn+=1));const an=ve?cn.projMatrix:null,pn=Ue?o.cW(f,qt,l,an,_e,[bn,wn]):o.cX(f,qt,l,an,yn.lineClipsArray.length,_e,[bn,wn]);if(gt){const Mn=yn.gradients[l.id];let $n=Mn.texture;if(l.gradientVersion!==Mn.version){let gr=256;if(l.stepInterpolant){const Zn=r.getSource().maxzoom,lr=cn.canonical.z===Zn?Math.ceil(1<<f.transform.maxZoom-cn.canonical.z):1;gr=o.ap(o.cY(yn.maxLineLength/o.ab*1024*lr),256,V.maxTextureSize)}Mn.gradient=o.cZ({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:gr,image:Mn.gradient||void 0,clips:yn.lineClipsArray}),Mn.texture?Mn.texture.update(Mn.gradient):Mn.texture=new o.T(V,Mn.gradient,H.RGBA8),Mn.version=l.gradientVersion,$n=Mn.texture}V.activeTexture.set(H.TEXTURE1),$n.bind(l.stepInterpolant?H.NEAREST:H.LINEAR,H.CLAMP_TO_EDGE)}we&&(V.activeTexture.set(H.TEXTURE0),qt.lineAtlasTexture&&qt.lineAtlasTexture.bind(H.LINEAR,H.REPEAT),Et.updatePaintBuffers()),Ue&&(V.activeTexture.set(H.TEXTURE0),qt.imageAtlasTexture&&qt.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),Et.updatePaintBuffers()),J&&f.terrain.setupElevationDraw(qt,Qt),f.uploadCommonUniforms(V,Qt,cn.toUnwrapped());const er=Mn=>{Ct!=null&&(Ct.value=Qe*O),Qt.draw(f,H.TRIANGLES,ee,Mn,re,yr.disabled,pn,l.id,yn.layoutVertexBuffer,yn.indexBuffer,yn.segments,l.paint,f.transform.zoom,Et,[yn.layoutVertexBuffer2,yn.patternVertexBuffer,yn.zOffsetVertexBuffer]),Ct!=null&&(Ct.value=Qe)};if(ot&&!J){const Mn=f.stencilModeForClipping(cn).ref;Mn===0&&ve&&V.clear({stencil:0});const $n={func:H.EQUAL,mask:255};pn.u_alpha_discard_threshold=.8,er(new Mr($n,Mn,255,H.KEEP,H.KEEP,H.INVERT)),pn.u_alpha_discard_threshold=0,er(new Mr($n,Mn,255,H.KEEP,H.KEEP,H.KEEP))}else ot&&J&&(pn.u_alpha_discard_threshold=.001),er(J?Kt:f.stencilModeForClipping(cn))}ot&&(f.resetStencilClippingMasks(),ve&&V.clear({stencil:0})),O===0||f.depthOcclusion||ve||f.layersWithOcclusionOpacity.push(f.currentLayer),J&&(f.forceTerrainMode=!1)},fill:function(f,r,l,p){const b=l.paint.get("fill-color"),S=l.paint.get("fill-opacity"),E=l.is3D(),O=new or(f.context.gl.LEQUAL,or.ReadWrite,f.depthRangeFor3D);if(S.constantOr(1)===0)return;const V=l.paint.get("fill-emissive-strength"),H=f.colorModeForDrapableLayerRenderPass(V),W=l.paint.get("fill-pattern"),J=f.opaquePassEnabledForLayer()&&!W.constantOr(1)&&b.constantOr(o.bz.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===J){const ee=E?O:f.depthModeForSublayer(1,f.renderPass==="opaque"?or.ReadWrite:or.ReadOnly);Sf(f,r,l,p,ee,H,!1)}if(!E&&f.renderPass==="translucent"&&l.paint.get("fill-antialias")){const ee=E?O:f.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,or.ReadOnly);Sf(f,r,l,p,ee,H,!0)}},"fill-extrusion":function(f,r,l,p){const b=l.paint.get("fill-extrusion-opacity"),S=f.context,E=S.gl,O=f.terrain,V=O&&O.renderingToTexture;if(b===0)return;const H=f.conflationActive&&f.style.isLayerClipped(l,r.getSource()),W=f.style.order.indexOf(l.fqid);if(H&&function(J,ee,re,ve,_e){for(const xe of ve){const we=ee.getTile(xe).getBucket(re);we&&(we.updateReplacement(xe,J.replacementSource,_e),we.uploadCentroid(J.context))}}(f,r,l,p,W),O||H)for(const J of p){const ee=r.getTile(J).getBucket(l);ee&&Al(f.context,r,J,ee,l,O,H)}if(f.renderPass==="shadow"&&f.shadowRenderer){const J=f.shadowRenderer;if(O&&b<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof o.a4)return;const ee=J.getShadowPassDepthMode(),re=J.getShadowPassColorMode();uu(f,r,l,p,ee,Mr.disabled,re,H)}else if(f.renderPass==="translucent"){const J=!l.paint.get("fill-extrusion-pattern").constantOr(1),ee=l.paint.get("fill-extrusion-color").constantOr(o.bz.white);if(!V&&ee.a!==0){const re=new or(f.context.gl.LEQUAL,or.ReadWrite,f.depthRangeFor3D);b===1&&J?uu(f,r,l,p,re,Mr.disabled,Ur.unblended,H):(uu(f,r,l,p,re,Mr.disabled,Ur.disabled,H),uu(f,r,l,p,re,f.stencilModeFor3D(),f.colorModeForRenderPass(),H),f.resetStencilClippingMasks())}if(f.style.enable3dLights()&&J&&(!O&&f.transform.projection.name!=="globe"||V)){const re=l.paint.get("fill-extrusion-opacity"),ve=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),_e=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),xe=l.paint.get("fill-extrusion-flood-light-intensity"),we=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(l.lut).toArray01().slice(0,3),ze=ve>0&&_e>0,Ne=xe>0,Le=(Ue,rt,Qe)=>(1-Qe)*Ue+Qe*rt,je=Ue=>{const rt=f.depthModeForSublayer(1,or.ReadOnly,E.LEQUAL,!0),Qe=l.paint.get(Ue?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ot=Le(.1,3,Qe),gt=f._showOverdrawInspector;if(!gt){const ht=new Mr({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),ct=new Ur([E.ONE,E.ONE,E.ONE,E.ONE],o.bz.transparent,[!1,!1,!1,!0],E.MIN);wi(f,r,l,p,rt,ht,ct,yr.disabled,Ue,"sdf",re,ve,_e,xe,we,ot,H,!1)}{const ht=gt?Mr.disabled:new Mr({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),ct=gt?f.colorModeForRenderPass():new Ur([E.ONE_MINUS_DST_ALPHA,E.DST_ALPHA,E.ONE,E.ONE],o.bz.transparent,[!0,!0,!0,!0]);wi(f,r,l,p,rt,ht,ct,yr.disabled,Ue,"color",re,ve,_e,xe,we,ot,H,!1)}};if(V){const Ue=(rt,Qe,ot)=>{const gt=f.depthModeForSublayer(1,or.ReadOnly,E.LEQUAL,!1),ht=l.paint.get(rt?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ct=Le(.1,3,ht);{const Ct=new Ur([E.ONE,E.ONE,E.ONE,E.ONE],o.bz.transparent,[!1,!1,!1,!0]);wi(f,r,l,p,gt,Mr.disabled,Ct,yr.disabled,rt,"clear",re,ve,_e,xe,we,ct,H,Qe)}{const Ct=new Mr({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),Kt=new Ur([E.ONE,E.ONE,E.ONE,E.ONE],o.bz.transparent,[!1,!1,!1,!0],E.MIN);wi(f,r,l,p,gt,Ct,Kt,yr.disabled,rt,"sdf",re,ve,_e,xe,we,ct,H,Qe)}{const Ct=rt?E.ZERO:E.ONE_MINUS_DST_ALPHA,Kt=new Mr({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),cn=new Ur([Ct,E.DST_ALPHA,E.ONE_MINUS_DST_ALPHA,E.ZERO],o.bz.transparent,[!0,!0,!0,!0]);wi(f,r,l,p,gt,Kt,cn,yr.disabled,rt,"color",re,ve,_e,xe,we,ct,H,Qe)}{const Ct=new Ur([E.ONE,E.ONE,E.ONE,rt?E.ZERO:E.ONE],o.bz.transparent,[!1,!1,!1,!0],rt?E.FUNC_ADD:E.MAX);wi(f,r,l,p,gt,Mr.disabled,Ct,yr.disabled,rt,"clear",re,ve,_e,xe,we,ct,H,Qe,ot)}};if(ze||Ne){let rt;if(f.prepareDrawTile(),O){const Qe=O.drapeBufferSize[0],ot=O.drapeBufferSize[1];rt=O.framebufferCopyTexture,rt&&(!rt||rt.size[0]===Qe&&rt.size[1]===ot)||(rt&&rt.destroy(),rt=O.framebufferCopyTexture=new o.T(S,new o.r({width:Qe,height:ot}),E.RGBA8)),rt.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.copyTexImage2D(E.TEXTURE_2D,0,E.RGBA,0,0,Qe,ot,0)}ze&&Ue(!0,!1,rt),Ne&&Ue(!1,!0,rt)}}else ze&&je(!0),Ne&&je(!1),(ze||Ne)&&f.resetStencilClippingMasks()}}},hillshade:function(f,r,l,p){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent"||f.style.disableElevatedTerrain)return;const b=f.context,S=f.terrain&&f.terrain.renderingToTexture,[E,O]=f.renderPass!=="translucent"||S?[{},p]:f.stencilConfigForOverlap(p);for(const V of O){const H=r.getTile(V);if(H.needsHillshadePrepare&&f.renderPass==="offscreen")Td(f,H,l);else if(f.renderPass==="translucent"){const W=f.depthModeForSublayer(0,or.ReadOnly),J=l.paint.get("hillshade-emissive-strength"),ee=f.colorModeForDrapableLayerRenderPass(J),re=S&&f.terrain?f.terrain.stencilModeForRTTOverlap(V):E[V.overscaledZ];of(f,V,H,l,W,re,ee)}}b.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,r,l,p,b,S){if(f.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const E=f.transform.projection.name==="globe",O=l.paint.get("raster-elevation")!==0,V=O&&E;if(f.renderElevatedRasterBackface&&!V)return;const H=f.context,W=H.gl,J=r.getSource(),ee=function(Ue,rt,Qe,ot){const gt=rt.paint.get("raster-color"),ht=Ue.type==="raster-array",ct=[],Ct=rt.paint.get("raster-resampling"),Kt=rt.paint.get("raster-color-mix");let cn=rt.paint.get("raster-color-range");const qt=[Kt[0],Kt[1],Kt[2],0],yn=Kt[3];let Et=Ct==="nearest"?ot.NEAREST:ot.LINEAR;if(ht&&(ct.push("RASTER_ARRAY"),gt||ct.push("RASTER_COLOR"),Ct==="linear"&&ct.push("RASTER_ARRAY_LINEAR"),Et=ot.NEAREST,!cn&&Ue.rasterLayers)){const nn=Ue.rasterLayers.find(({id:Qt})=>Qt===rt.sourceLayer);nn&&nn.fields&&nn.fields.range&&(cn=nn.fields.range)}if(cn=cn||[0,1],gt){ct.push("RASTER_COLOR"),Qe.activeTexture.set(ot.TEXTURE2),rt.updateColorRamp(cn);let nn=rt.colorRampTexture;nn||(nn=rt.colorRampTexture=new o.T(Qe,rt.colorRamp,ot.RGBA8)),nn.bind(ot.LINEAR,ot.CLAMP_TO_EDGE)}return{mix:qt,range:cn,offset:yn,defines:ct,resampling:Et}}(J,l,H,W);if(J instanceof o.aD&&!p.length&&!E)return;const re=l.paint.get("raster-emissive-strength"),ve=f.colorModeForDrapableLayerRenderPass(re),_e=f.terrain&&f.terrain.renderingToTexture,xe=!f.options.moving,we=l.paint.get("raster-resampling")==="nearest"?W.NEAREST:W.LINEAR;if(J instanceof o.aD&&!p.length&&(J.onNorthPole||J.onSouthPole)){const Ue=O?f.stencilModeFor3D():Mr.disabled;return void us(!!J.onNorthPole,null,f,r,l,re,ee,yr.disabled,Ue)}if(!p.length)return;const[ze,Ne]=J instanceof o.aD||_e?[{},p]:f.stencilConfigForOverlap(p),Le=Ne[Ne.length-1].overscaledZ;V&&ee.defines.push("PROJECTION_GLOBE_VIEW"),O&&ee.defines.push("RENDER_CUTOFF");const je=(Ue,rt,Qe)=>{for(const ot of Ue){const gt=ot.toUnwrapped(),ht=r.getTile(ot);if(_e&&(!ht||!ht.hasData()))continue;H.activeTexture.set(W.TEXTURE0);const ct=Tf(ht,J,l,ee);if(!ct||!ct.texture)continue;const{texture:Ct,mix:Kt,offset:cn,tileSize:qt,buffer:yn}=ct;let Et,nn;_e?(Et=or.disabled,nn=ot.projMatrix):O?(Et=new or(W.LEQUAL,or.ReadWrite,f.depthRangeFor3D),nn=E?Float32Array.from(f.transform.expandedFarZProjMatrix):f.transform.calculateProjMatrix(gt,xe)):(Et=f.depthModeForSublayer(ot.overscaledZ-Le,l.paint.get("raster-opacity")===1?or.ReadWrite:or.ReadOnly,W.LESS),nn=f.transform.calculateProjMatrix(gt,xe));const Qt=f.terrain&&_e?f.terrain.stencilModeForRTTOverlap(ot):ze[ot.overscaledZ],bn=S?0:l.paint.get("raster-fade-duration");ht.registerFadeDuration(bn);const wn=r.findLoadedParent(ot,0),an=hf(ht,wn,r,f.transform,bn);let pn,er;f.terrain&&f.terrain.prepareDrawTile(),H.activeTexture.set(W.TEXTURE0),Ct.bind(we,W.CLAMP_TO_EDGE),H.activeTexture.set(W.TEXTURE1),wn?(wn.texture&&wn.texture.bind(we,W.CLAMP_TO_EDGE),pn=Math.pow(2,wn.tileID.overscaledZ-ht.tileID.overscaledZ),er=[ht.tileID.canonical.x*pn%1,ht.tileID.canonical.y*pn%1]):Ct.bind(we,W.CLAMP_TO_EDGE),Ct.useMipmap&&H.extTextureFilterAnisotropic&&f.transform.pitch>20&&W.texParameterf(W.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax);const Mn=f.transform;let $n;const gr=O?Ko(Mn):[0,0,0,0];let Zn,lr,zr,Dr,po,To=0;if(V&&J instanceof o.aD&&J.coordinates.length>3)Zn=Float32Array.from(o.b5(o.cC(new o.bP(0,0,0)))),lr=Float32Array.from(Mn.globeMatrix),zr=Float32Array.from(o.cy(Mn)),Dr=[o.am(Mn.center.lng),o.at(Mn.center.lat)],$n=J.elevatedGlobePerspectiveTransform,po=J.elevatedGlobeGridMatrix||new Float32Array(9);else if(V){const jr=o.cz(ot.canonical);To=o.cA(jr.getCenter().lat),Zn=Float32Array.from(o.b5(o.cC(ot.canonical))),lr=Float32Array.from(Mn.globeMatrix),zr=Float32Array.from(o.cy(Mn)),Dr=[o.am(Mn.center.lng),o.at(Mn.center.lat)],$n=[0,0],po=Float32Array.from(o.cB(ot.canonical,jr,To,Mn.worldSize/Mn._pixelsPerMercatorPixel))}else $n=J instanceof o.aD?J.perspectiveTransform:[0,0],Zn=new Float32Array(16),lr=new Float32Array(9),zr=new Float32Array(16),Dr=[0,0],po=new Float32Array(9);const Lo=Pd(nn,Zn,lr,zr,po,er||[0,0],o.a9(f.transform.zoom),Dr,gr,pn||1,an,l,$n,O?l.paint.get("raster-elevation"):0,2,Kt,cn,ee.range,qt,yn,re),Vs=f.isTileAffectedByFog(ot),ri=f.getOrCreateProgram("raster",{defines:ee.defines,overrideFog:Vs});if(f.uploadCommonUniforms(H,ri,gt),J instanceof o.aD){const jr=J.elevatedGlobeVertexBuffer,xo=J.elevatedGlobeIndexBuffer;if(_e||!E)J.boundsBuffer&&J.boundsSegments&&ri.draw(f,W.TRIANGLES,Et,Mr.disabled,ve,yr.disabled,Lo,l.id,J.boundsBuffer,f.quadTriangleIndexBuffer,J.boundsSegments);else if(jr&&xo){const Vo=Mn.zoom<=o.c2?J.elevatedGlobeSegments:J.getSegmentsForLongitude(Mn.center.lng);Vo&&ri.draw(f,W.TRIANGLES,Et,Mr.disabled,ve,rt,Lo,l.id,jr,xo,Vo)}}else if(V){Et=new or(W.LEQUAL,or.ReadOnly,f.depthRangeFor3D);const jr=f.globeSharedBuffers;if(jr){const[xo,Vo,vo]=jr.getGridBuffers(To,!1);ri.draw(f,W.TRIANGLES,Et,Qe||Qt,f.colorModeForRenderPass(),rt,Lo,l.id,xo,Vo,vo)}}else{const{tileBoundsBuffer:jr,tileBoundsIndexBuffer:xo,tileBoundsSegments:Vo}=f.getTileBoundsBuffers(ht);ri.draw(f,W.TRIANGLES,Et,Qt,ve,yr.disabled,Lo,l.id,jr,xo,Vo)}}if(!(J instanceof o.aD)&&V)for(const ot of Ue){const gt=ot.canonical.y===(1<<ot.canonical.z)-1;ot.canonical.y===0&&us(!0,ot,f,r,l,re,ee,rt,Qe||Mr.disabled),gt&&us(!1,ot,f,r,l,re,ee,rt===yr.frontCW?yr.backCW:yr.frontCW,Qe||Mr.disabled)}};V?je(Ne,f.renderElevatedRasterBackface?yr.backCW:yr.frontCW,f.stencilModeFor3D()):je(Ne,yr.disabled,void 0),f.resetStencilClippingMasks()},"raster-particle":function(f,r,l,p,b,S){f.renderPass==="offscreen"&&function(E,O,V,H){if(!H.length)return;const W=E.context,J=W.gl,ee=O.getSource();if(!(ee instanceof Nc))return;const re=Math.ceil(Math.sqrt(V.paint.get("raster-particle-count")));let ve=V.particlePositionRGBAImage;if(!ve||ve.width!==re){const Ne=function(Le){const je=Le*Le,Ue=new Uint8Array(4*je),rt=function(ot){return ot|=0,ot=Math.imul(2747636419^ot,2654435769),ot=Math.imul(ot^ot>>>16,2654435769),((ot=Math.imul(ot^ot>>>16,2654435769))>>>0)/4294967296},Qe=1/1.1;for(let ot=0;ot<je;ot++){const gt=Qe*(rt(2*ot+0)+Sa),ht=Qe*(rt(2*ot+1)+Sa),ct=255*gt%1,Ct=255*ht%1,Kt=ct,cn=ht-Ct/255,qt=Ct;Ue[4*ot+0]=255*(gt-ct/255),Ue[4*ot+1]=255*Kt,Ue[4*ot+2]=255*cn,Ue[4*ot+3]=255*qt}return Ue}(re);ve=V.particlePositionRGBAImage=new o.r({width:re,height:re},Ne)}let _e=V.particleFramebuffer;_e?_e.width!==re&&(_e.destroy(),_e=V.particleFramebuffer=W.createFramebuffer(re,re,!0,null)):_e=V.particleFramebuffer=W.createFramebuffer(re,re,!0,null);const xe=[];for(const Ne of H){const Le=O.getTile(Ne);if(!(Le instanceof Vh))continue;const je=J_(Le,ee,V);if(!je)continue;const Ue=[Le.tileSize,Le.tileSize];let rt=V.tileFramebuffer;rt||(rt=V.tileFramebuffer=W.createFramebuffer(Ue[0],Ue[1],!0,null));let Qe=Le.rasterParticleState;Qe||(Qe=Le.rasterParticleState=new X_(W,Ne,Ue,ve));const ot=Qe.update(V.lastInvalidatedAt);Qe.particleTextureDimension!==re&&Qe.updateParticleTexture(Ne,ve);const gt=Qe.targetColorTexture;Qe.targetColorTexture=Qe.backgroundColorTexture,Qe.backgroundColorTexture=gt;const ht=Qe.particleTexture0;Qe.particleTexture0=Qe.particleTexture1,Qe.particleTexture1=ht,xe.push([Ne,je,Qe,ot])}if(xe.length===0)return;const we=o.q.now(),ze=V.previousDrawTimestamp?.001*(we-V.previousDrawTimestamp):.0167;if(V.previousDrawTimestamp=we,V.hasColorMap()){W.activeTexture.set(J.TEXTURE0+2);let Ne=V.colorRampTexture;Ne||(Ne=V.colorRampTexture=new o.T(W,V.colorRamp,J.RGBA8)),Ne.bind(J.LINEAR,J.CLAMP_TO_EDGE)}W.bindFramebuffer.set(V.tileFramebuffer.framebuffer),function(Ne,Le,je){const Ue=Ne.context,rt=Ue.gl,Qe=Le.tileFramebuffer;Ue.activeTexture.set(rt.TEXTURE0);const ot={u_texture:0,u_opacity:1.05*(ht=Le.paint.get("raster-particle-fade-opacity-factor"))/(ht+.05)},gt=Ne.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var ht;for(const ct of je){const[,,Ct,Kt]=ct;Qe.colorAttachment.set(Ct.targetColorTexture.texture),Ue.viewport.set([0,0,Qe.width,Qe.height]),Ue.clear({color:o.bz.transparent}),Kt&&(Ct.backgroundColorTexture.bind(rt.NEAREST,rt.CLAMP_TO_EDGE),gt.draw(Ne,rt.TRIANGLES,or.disabled,Mr.disabled,Ur.alphaBlended,yr.disabled,ot,Le.id,Ne.viewportBuffer,Ne.quadTriangleIndexBuffer,Ne.viewportSegments))}}(E,V,xe),function(Ne,Le,je,Ue){const rt=Ne.context,Qe=rt.gl,ot=je.tileFramebuffer,gt=Ne.transform.projection.name==="globe",ht=je.paint.get("raster-particle-max-speed");for(const ct of Ue){const[Ct,Kt,cn]=ct;rt.activeTexture.set(Qe.TEXTURE0+0),Kt.texture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE),ot.colorAttachment.set(cn.targetColorTexture.texture);const qt=Ne.getOrCreateProgram("rasterParticleDraw",{defines:Kt.defines,overrideFog:!1});rt.activeTexture.set(Qe.TEXTURE0+1);const yn=Kt.scalarData?[]:[0,1,2,3].map(Qt=>o.c$[Qt](Ct));yn.push(Ct);const Et=Ct.canonical.x,nn=Ct.canonical.y;for(const Qt of yn){const bn=Le.getTile(gt?Qt.wrapped():Qt);if(!bn)continue;const wn=bn.rasterParticleState;if(!wn)continue;const an=Qt.canonical.x+(1<<Qt.canonical.z)*(Qt.wrap-Ct.wrap),pn=Qt.canonical.y;wn.particleTexture0.bind(Qe.NEAREST,Qe.CLAMP_TO_EDGE);const er=vf(1,wn.particleTexture0.size[0],[an-Et,pn-nn],0,Kt.texture.size,2,ht,Kt.textureOffset,Kt.scale,Kt.offset);qt.draw(Ne,Qe.POINTS,or.disabled,Mr.disabled,Ur.alphaBlended,yr.disabled,er,je.id,wn.particleIndexBuffer,void 0,wn.particleSegment)}}}(E,O,V,xe),W.bindFramebuffer.set(V.particleFramebuffer.framebuffer),function(Ne,Le,je,Ue){const rt=Ne.context,Qe=rt.gl,ot=Le.paint.get("raster-particle-max-speed"),gt=Ue*Le.paint.get("raster-particle-speed-factor")*.15,ht=function(Ct){return Math.pow(Ct,6)}(.01+1*Le.paint.get("raster-particle-reset-rate-factor")),ct=Le.particleFramebuffer;rt.viewport.set([0,0,ct.width,ct.height]);for(const Ct of je){const[,Kt,cn]=Ct;rt.activeTexture.set(Qe.TEXTURE0+0),Kt.texture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE),rt.activeTexture.set(Qe.TEXTURE0+1);const qt=cn.particleTexture0;qt.bind(Qe.NEAREST,Qe.CLAMP_TO_EDGE);const yn=_f(1,qt.size[0],0,Kt.texture.size,ot,gt,ht,Kt.textureOffset,Kt.scale,Kt.offset);ct.colorAttachment.set(cn.particleTexture1.texture),rt.clear({color:o.bz.transparent}),Ne.getOrCreateProgram("rasterParticleUpdate",{defines:Kt.defines}).draw(Ne,Qe.TRIANGLES,or.disabled,Mr.disabled,Ur.unblended,yr.disabled,yn,Le.id,Ne.viewportBuffer,Ne.quadTriangleIndexBuffer,Ne.viewportSegments)}}(E,V,xe,ze)}(f,r,l,p),f.renderPass==="translucent"&&(function(E,O,V,H,W){const J=E.context,ee=J.gl,re=O.getSource().tileSize,ve=5*(1-o.a7(o.bU,o.bU+1,E.transform.zoom))*re+V.paint.get("raster-particle-elevation"),_e=!E.options.moving,xe=E.transform.projection.name==="globe";if(!H.length)return;const[we,ze]=E.stencilConfigForOverlap(H),Ne=[];xe&&Ne.push("PROJECTION_GLOBE_VIEW");const Le=E.stencilModeFor3D();for(const je of ze){const Ue=je.toUnwrapped(),rt=O.getTile(je);if(!rt.rasterParticleState)continue;const Qe=rt.rasterParticleState,ot=100;rt.registerFadeDuration(ot);const gt=O.findLoadedParent(je,0),ht=hf(rt,gt,O,E.transform,ot);let ct,Ct;E.terrain&&E.terrain.prepareDrawTile(),J.activeTexture.set(ee.TEXTURE0),Qe.targetColorTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),J.activeTexture.set(ee.TEXTURE1),gt&&gt.rasterParticleState?(gt.rasterParticleState.targetColorTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),ct=Math.pow(2,gt.tileID.overscaledZ-rt.tileID.overscaledZ),Ct=[rt.tileID.canonical.x*ct%1,rt.tileID.canonical.y*ct%1]):Qe.targetColorTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const Kt=xe?Float32Array.from(E.transform.expandedFarZProjMatrix):E.transform.calculateProjMatrix(Ue,_e),cn=E.transform,qt=Q_(cn),yn=o.cz(je.canonical),Et=o.cA(yn.getCenter().lat);let nn,Qt,bn,wn,an;xe?(nn=Float32Array.from(o.b5(o.cC(je.canonical))),Qt=Float32Array.from(cn.globeMatrix),bn=Float32Array.from(o.cy(cn)),wn=[o.am(cn.center.lng),o.at(cn.center.lat)],an=Float32Array.from(o.cB(je.canonical,yn,Et,cn.worldSize/cn._pixelsPerMercatorPixel))):(nn=new Float32Array(16),Qt=new Float32Array(9),bn=new Float32Array(16),wn=[0,0],an=new Float32Array(9));const pn=q_(Kt,nn,Qt,bn,an,Ct||[0,0],o.a9(E.transform.zoom),wn,qt,ct||1,ht,ve),er=E.isTileAffectedByFog(je),Mn=E.getOrCreateProgram("rasterParticle",{defines:Ne,overrideFog:er});if(E.uploadCommonUniforms(J,Mn,Ue),xe){const $n=new or(ee.LEQUAL,or.ReadOnly,E.depthRangeFor3D),gr=0,Zn=E.globeSharedBuffers;if(Zn){const[lr,zr,Dr]=Zn.getGridBuffers(Et,gr!==0);Mn.draw(E,ee.TRIANGLES,$n,Le,Ur.alphaBlended,E.renderElevatedRasterBackface?yr.frontCCW:yr.backCCW,pn,V.id,lr,zr,Dr)}}else{const $n=E.depthModeForSublayer(0,or.ReadOnly),gr=we[je.overscaledZ],{tileBoundsBuffer:Zn,tileBoundsIndexBuffer:lr,tileBoundsSegments:zr}=E.getTileBoundsBuffers(rt);Mn.draw(E,ee.TRIANGLES,$n,gr,Ur.alphaBlended,yr.disabled,pn,V.id,Zn,lr,zr)}}E.resetStencilClippingMasks()}(f,r,l,p),f.style.map.triggerRepaint())},background:function(f,r,l,p){const b=l.paint.get("background-color"),S=l.paint.get("background-opacity"),E=l.paint.get("background-emissive-strength"),O=l.paint.get("background-pitch-alignment")==="viewport";if(S===0)return;const V=f.context,H=V.gl,W=f.transform,J=W.tileSize,ee=l.paint.get("background-pattern");let re;if(ee!==void 0&&(ee===null||(re=f.imageManager.getPattern(ee.toString(),l.scope,f.style.getLut(l.scope)),!re)))return;const ve=!ee&&b.a===1&&S===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==ve)return;const _e=Mr.disabled,xe=f.depthModeForSublayer(0,ve==="opaque"?or.ReadWrite:or.ReadOnly),we=f.colorModeForDrapableLayerRenderPass(E),ze=ee?"backgroundPattern":"background";let Ne,Le=p;if(Le||(Ne=f.getBackgroundTiles(),Le=Object.values(Ne).map(je=>je.tileID)),ee&&(V.activeTexture.set(H.TEXTURE0),f.imageManager.bind(f.context,l.scope)),O){const je=f.getOrCreateProgram(ze,{overrideFog:!1,overrideRtt:!0}),Ue=new Float32Array(o.a6.mat4.identity([])),rt=new o.aA(0,0,0,0,0),Qe=ee?dc(Ue,E,S,f,0,l.scope,re,O,{tileID:rt,tileSize:J}):K_(Ue,E,S,b.toRenderColor(l.lut));je.draw(f,H.TRIANGLES,xe,_e,we,yr.disabled,Qe,l.id,f.viewportBuffer,f.quadTriangleIndexBuffer,f.viewportSegments)}else for(const je of Le){const Ue=f.isTileAffectedByFog(je),rt=f.getOrCreateProgram(ze,{overrideFog:Ue}),Qe=je.toUnwrapped(),ot=p?je.projMatrix:f.transform.calculateProjMatrix(Qe);f.prepareDrawTile();const gt=r?r.getTile(je):Ne?Ne[je.key]:new ba(je,J,W.zoom,f),ht=ee?dc(ot,E,S,f,0,l.scope,re,O,{tileID:je,tileSize:J}):K_(ot,E,S,b.toRenderColor(l.lut));f.uploadCommonUniforms(V,rt,Qe);const{tileBoundsBuffer:ct,tileBoundsIndexBuffer:Ct,tileBoundsSegments:Kt}=f.getTileBoundsBuffers(gt);rt.draw(f,H.TRIANGLES,xe,_e,we,yr.disabled,ht,l.id,ct,Ct,Kt)}},sky:function(f,r,l){const p=f._atmosphere?o.a9(f.transform.zoom):1,b=l.paint.get("sky-opacity")*p;if(b===0)return;const S=f.context,E=l.paint.get("sky-type"),O=new or(S.gl.LEQUAL,or.ReadOnly,[0,1]),V=f.frameCounter/1e3%1;E==="atmosphere"?f.renderPass==="offscreen"?l.needsSkyboxCapture(f)&&(function(H,W,J,ee){const re=H.context,ve=re.gl;let _e=W.skyboxFbo;if(!_e){_e=W.skyboxFbo=re.createFramebuffer(32,32,!0,null),W.skyboxGeometry=new Ym(re),W.skyboxTexture=re.gl.createTexture(),ve.bindTexture(ve.TEXTURE_CUBE_MAP,W.skyboxTexture),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_S,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_T,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MAG_FILTER,ve.LINEAR);for(let Ne=0;Ne<6;++Ne)ve.texImage2D(ve.TEXTURE_CUBE_MAP_POSITIVE_X+Ne,0,ve.RGBA,32,32,0,ve.RGBA,ve.UNSIGNED_BYTE,null)}re.bindFramebuffer.set(_e.framebuffer),re.viewport.set([0,0,32,32]);const xe=W.getCenter(H,!0),we=H.getOrCreateProgram("skyboxCapture"),ze=new Float64Array(16);o.a6.mat4.identity(ze),o.a6.mat4.rotateY(ze,ze,.5*-Math.PI),fc(H,W,we,ze,xe,0),o.a6.mat4.identity(ze),o.a6.mat4.rotateY(ze,ze,.5*Math.PI),fc(H,W,we,ze,xe,1),o.a6.mat4.identity(ze),o.a6.mat4.rotateX(ze,ze,.5*-Math.PI),fc(H,W,we,ze,xe,2),o.a6.mat4.identity(ze),o.a6.mat4.rotateX(ze,ze,.5*Math.PI),fc(H,W,we,ze,xe,3),o.a6.mat4.identity(ze),fc(H,W,we,ze,xe,4),o.a6.mat4.identity(ze),o.a6.mat4.rotateY(ze,ze,Math.PI),fc(H,W,we,ze,xe,5),re.viewport.set([0,0,H.width,H.height])}(f,l),l.markSkyboxValid(f)):f.renderPass==="sky"&&function(H,W,J,ee,re){const ve=H.context,_e=ve.gl,xe=H.transform,we=H.getOrCreateProgram("skybox");ve.activeTexture.set(_e.TEXTURE0),_e.bindTexture(_e.TEXTURE_CUBE_MAP,W.skyboxTexture);const ze=((Ne,Le,je,Ue,rt)=>({u_matrix:Ne,u_sun_direction:Le,u_cubemap:0,u_opacity:Ue,u_temporal_offset:rt}))(xe.skyboxMatrix,W.getCenter(H,!1),0,ee,re);H.uploadCommonUniforms(ve,we),we.draw(H,_e.TRIANGLES,J,Mr.disabled,H.colorModeForRenderPass(),yr.backCW,ze,"skybox",W.skyboxGeometry.vertexBuffer,W.skyboxGeometry.indexBuffer,W.skyboxGeometry.segment)}(f,l,O,b,V):E==="gradient"&&f.renderPass==="sky"&&function(H,W,J,ee,re){const ve=H.context,_e=ve.gl,xe=H.transform,we=H.getOrCreateProgram("skyboxGradient");W.skyboxGeometry||(W.skyboxGeometry=new Ym(ve)),ve.activeTexture.set(_e.TEXTURE0);let ze=W.colorRampTexture;ze||(ze=W.colorRampTexture=new o.T(ve,W.colorRamp,_e.RGBA8)),ze.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const Ne=((Le,je,Ue,rt,Qe)=>({u_matrix:Le,u_color_ramp:0,u_center_direction:je,u_radius:o.bB(Ue),u_opacity:rt,u_temporal_offset:Qe}))(xe.skyboxMatrix,W.getCenter(H,!1),W.paint.get("sky-gradient-radius"),ee,re);H.uploadCommonUniforms(ve,we),we.draw(H,_e.TRIANGLES,J,Mr.disabled,H.colorModeForRenderPass(),yr.backCW,Ne,"skyboxGradient",W.skyboxGeometry.vertexBuffer,W.skyboxGeometry.indexBuffer,W.skyboxGeometry.segment)}(f,l,O,b,V)},debug:function(f,r,l,p,b,S){for(let E=0;E<l.length;E++)if(b){const H=new o.bz(p.r*.8,p.g*.8,p.b*.8,1);ia(f,r,l[E],p,-1,-1,S),ia(f,r,l[E],p,-1,1,S),ia(f,r,l[E],p,1,1,S),ia(f,r,l[E],p,1,-1,S),ia(f,r,l[E],H,0,0,S)}else ia(f,r,l[E],p,0,0,S)},custom:function(f,r,l,p){const b=f.context,S=l.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&l.isDraped(r)){if(f.renderPass==="offscreen"){const E=S.prerender;if(E){if(f.setCustomLayerDefaults(),b.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const O=f.transform.pointMerc;E.call(S,b.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),o.a9(f.transform.zoom),[O.x,O.y],f.transform.pixelsPerMeterRatio)}else E.call(S,b.gl,f.transform.customLayerMatrix());b.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const O=S.renderToTile;if(O){const V=p[0].canonical,H=new o.a5(V.x+p[0].wrap*(1<<V.z),V.y,V.z);b.setDepthMode(or.disabled),b.setStencilMode(Mr.disabled),b.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),O.call(S,b.gl,H),b.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),b.setColorMode(f.colorModeForRenderPass()),b.setStencilMode(Mr.disabled);const E=S.renderingMode==="3d"?new or(f.context.gl.LEQUAL,or.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,or.ReadOnly);if(b.setDepthMode(E),f.transform.projection.name==="globe"){const O=f.transform.pointMerc;S.render(b.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),o.a9(f.transform.zoom),[O.x,O.y],f.transform.pixelsPerMeterRatio)}else S.render(b.gl,f.transform.customLayerMatrix());b.setDirty(),f.setBaseState(),b.bindFramebuffer.set(null)}}else o.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(f,r,l,p){if(f.renderPass==="opaque")return;const b=l.paint.get("model-opacity");if(b===0)return;const S=l.paint.get("model-cast-shadows");if(f.renderPass==="shadow"&&(!S||f.terrain&&b<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof o.a4))return;const E=f.shadowRenderer,O=l.paint.get("model-receive-shadows");E&&(E.useNormalOffset=!0,O||(E.enabled=!1));const V=()=>{E&&(E.useNormalOffset=!0,O||(E.enabled=!0))},H=r.getSource();if(f.renderPass==="light-beam"&&H.type!=="batched-model")return;if(H.type==="vector"||H.type==="geojson")return function(we,ze,Ne,Le,je){const Ue=we.transform;if(Ue.projection.name!=="mercator")return void o.w(`Drawing 3D models for ${Ue.projection.name} projection is not yet implemented`);const rt=Ue.getFreeCameraOptions().position;if(!we.modelManager)return;const Qe=we.modelManager;Ne.modelManager=Qe;const ot=we.shadowRenderer;if(!Ne._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const gt=Ne._unevaluatedLayout._values["model-id"],ht={...Ne.layout.get("model-id").parameters},ct=we.style.order.indexOf(Ne.fqid);for(const Ct of Le){const Kt=ze.getTile(Ct).getBucket(Ne);if(!Kt||Kt.projection.name!==Ue.projection.name)continue;const cn=Kt.getModelUris();cn&&!Kt.modelsRequested&&(Qe.addModelsFromBucket(cn,je),Kt.modelsRequested=!0);const qt=k1(Ct,Ue);ht.zoom=qt;const yn=gt.possiblyEvaluate(ht);if(ty(we,Kt,Ct),aa.shadowUniformsInitialized=!1,aa.useSingleShadowCascade=!!ot&&ot.getMaxCascadeForTile(Ct.toUnwrapped())===0,we.renderPass==="shadow"&&ot){if(we.currentShadowCascade===1&&Kt.isInsideFirstShadowMapFrustum)continue;const Qt=Ue.calculatePosMatrix(Ct.toUnwrapped(),Ue.worldSize);if(aa.tileMatrix.set(Qt),aa.shadowTileMatrix=Float32Array.from(ot.calculateShadowPassMatrixFromMatrix(Qt)),aa.aabb.min.fill(0),aa.aabb.max[0]=aa.aabb.max[1]=o.ab,aa.aabb.max[2]=0,Fd(Kt,aa,we,Ne.scope))continue}const Et=1<<Ct.canonical.z,nn=[((rt.x-Ct.wrap)*Et-Ct.canonical.x)*o.ab,(rt.y*Et-Ct.canonical.y)*o.ab,rt.z*Et*o.ab];we.conflationActive&&Object.keys(Kt.instancesPerModel).length>0&&we.style.isLayerClipped(Ne,ze.getSource())&&Kt.updateReplacement(Ct,we.replacementSource,ct,je)&&(Kt.uploaded=!1,Kt.upload(we.context));for(let Qt in Kt.instancesPerModel){const bn=Kt.instancesPerModel[Qt];bn.features.length>0&&(Qt=yn.evaluate(bn.features[0].feature,{}));const wn=Qe.getModel(Qt,je);if(wn&&wn.uploaded)for(const an of wn.nodes)Ui(we,Ne,an,bn,nn,Ct,aa)}}}(f,r,l,p,H.type==="vector"?l.scope:""),void V();if(!H.loaded())return;if(H.type==="batched-model")return function(we,ze,Ne,Le){Ne.resetLayerRenderingStats(we);const je=we.context,Ue=we.transform,rt=we.style.fog,Qe=we.shadowRenderer;if(Ue.projection.name!=="mercator")return void o.w(`Drawing 3D landmark models for ${Ue.projection.name} projection is not yet implemented`);const ot=we.transform.getFreeCameraOptions().position,gt=o.a6.vec3.scale([],[ot.x,ot.y,ot.z],we.transform.worldSize),ht=o.a6.vec3.negate([],gt),ct=o.a6.mat4.identity([]),Ct=o.de(Ue.center.lat,Ue.zoom),Kt=o.a6.mat4.fromScaling([],[1,1,1/Ct]);o.a6.mat4.translate(ct,ct,ht);const cn=Ne.paint.get("model-opacity"),qt=new or(je.gl.LEQUAL,or.ReadWrite,we.depthRangeFor3D),yn=new or(je.gl.LEQUAL,or.ReadOnly,we.depthRangeFor3D),Et=new o.c9([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),nn=we.renderPass==="shadow",Qt=nn&&Qe?Qe.getCurrentCascadeFrustum():Ue.getFrustum(Ue.scaleZoom(Ue.worldSize)),bn=Ne.paint.get("model-front-cutoff"),wn=bn[2]<1,an=qa(we,Ne.paint.get("model-cutoff-fade-range")),pn=Ne.getLayerRenderingStats();(function(er,Mn,$n,gr){const Zn=er.terrain?er.terrain.exaggeration():0,lr=er.transform.zoom;for(const zr of gr){const Dr=Mn.getTile(zr).getBucket($n);Dr&&(er.conflationActive&&Dr.updateReplacement(zr,er.replacementSource),Dr.evaluateScale(er,$n),er.terrain&&Zn>0&&Dr.elevationUpdate(er.terrain,Zn,zr,$n.source),Dr.needsReEvaluation(er,lr,$n)&&Dr.evaluate($n))}})(we,ze,Ne,Le),function(){let er,Mn,$n;wn?(er=Le.length-1,Mn=-1,$n=-1):(er=0,Mn=Le.length,$n=1);const gr=new Float64Array(16),Zn=o.a6.vec3.create(),lr=new o.P(0,0);for(let zr=er;zr!==Mn;zr+=$n){const Dr=Le[zr],po=ze.getTile(Dr).getBucket(Ne);if(!po||!po.uploaded)continue;let To=!1;Qe&&(To=Qe.getMaxCascadeForTile(Dr.toUnwrapped())===0);const Lo=Ue.calculatePosMatrix(Dr.toUnwrapped(),Ue.worldSize),Vs=po.modelTraits;!nn&&wn&&(o.a6.mat4.invert(gr,Lo),o.a6.vec3.transformMat4(Zn,gt,gr),lr.x=Zn[0],lr.y=Zn[1]);const ri=[];for(const jr of po.getNodesInfo()){if(jr.hiddenByReplacement||!jr.node.meshes)continue;const xo=jr.node;let Vo=0;we.terrain&&xo.elevation&&(Vo=xo.elevation*we.terrain.exaggeration());const vo=(()=>{const Po=jr.aabb;return Et.min=[...Po.min],Et.max=[...Po.max],Et.min[2]+=Vo,Et.max[2]+=Vo,o.a6.vec3.transformMat4(Et.min,Et.min,Lo),o.a6.vec3.transformMat4(Et.max,Et.max,Lo),Et})(),Lr=jr.evaluatedScale;if(Lr[0]<=1&&Lr[1]<=1&&Lr[2]<=1&&vo.intersects(Qt)===0)continue;if(!nn&&wn){const Po=.16666666666666666;jr.cameraCollisionOpacity=gt[0]>vo.min[0]&&gt[0]<vo.max[0]&&gt[1]>vo.min[1]&&gt[1]<vo.max[1]&&gt[2]*Ct<vo.max[2]&&xo.footprint&&o.bu(lr,xo.footprint)?Math.max(jr.cameraCollisionOpacity-Po,0):Math.min(1,jr.cameraCollisionOpacity+Po)}const io=[...Lo],uo=xo.anchor?xo.anchor[0]:0,Yo=xo.anchor?xo.anchor[1]:0;o.a6.mat4.translate(io,io,[uo*(Lr[0]-1),Yo*(Lr[1]-1),Vo]),o.a6.vec3.exactEquals(Lr,o.dh)||o.a6.mat4.scale(io,io,Lr);const oi=o.a6.mat4.multiply([],io,xo.matrix),Yr=o.a6.mat4.multiply([],Ue.expandedFarZProjMatrix,oi),gi=o.a6.mat4.multiply([],Ue.expandedFarZProjMatrix,io),bi=o.a6.vec4.transformMat4([],[uo,Yo,Vo,1],Yr)[2];xo.hidden=!1;let vi=cn;nn||(wn&&(vi*=jr.cameraCollisionOpacity,vi*=oo(io,Ue,jr.aabb,bn)),vi*=zo(an,bi)),vi!==0?ri.push({nodeInfo:jr,depth:bi,opacity:vi,wvpForNode:Yr,wvpForTile:gi,nodeModelMatrix:oi,tileModelMatrix:io}):xo.hidden=!0}nn||ri.sort((jr,xo)=>!wn||jr.opacity===1&&xo.opacity===1?jr.depth<xo.depth?-1:1:jr.opacity===1?-1:xo.opacity===1?1:jr.depth>xo.depth?-1:1);for(const jr of ri){const xo=jr.nodeInfo,Vo=xo.node;let vo=o.a6.mat4.multiply([],Kt,jr.tileModelMatrix);o.a6.mat4.multiply(vo,ct,vo);const Lr=o.a6.mat4.invert([],vo);o.a6.mat4.transpose(Lr,Lr),o.a6.mat4.scale(Lr,Lr,A1),vo=o.a6.mat4.multiply(vo,vo,Vo.matrix);const io=we.renderPass==="light-beam",uo=Vs&o.dj.HasMapboxMeshFeatures,Yo=uo?0:xo.evaluatedRMEA[0][2];for(let oi=0;oi<Vo.meshes.length;++oi){const Yr=Vo.meshes[oi],gi=oi===Vo.lightMeshIndex;let bi=jr.wvpForNode;if(gi){if(!io&&!we.terrain&&we.shadowRenderer){we.currentLayer<we.firstLightBeamLayer&&(we.firstLightBeamLayer=we.currentLayer);continue}bi=jr.wvpForTile}else if(io)continue;const vi={defines:[]},Po=[];if(If(vi.defines,Po,Yr,we,Ne.lut),uo||vi.defines.push("DIFFUSE_SHADED"),To&&vi.defines.push("SHADOWS_SINGLE_CASCADE"),pn&&(nn?pn.numRenderedVerticesInShadowPass+=Yr.vertexArray.length:pn.numRenderedVerticesInTransparentPass+=Yr.vertexArray.length),nn){pu(Yr,jr.nodeModelMatrix,we,Ne);continue}let Ji=null;if(rt){const Qa=Mf(jr.nodeModelMatrix,we.transform);if(Ji=new Float32Array(Qa),Ue.projection.name!=="globe"){const zl=Yr.aabb.min,Ma=Yr.aabb.max,[bu,xu]=rt.getOpacityForBounds(Qa,zl[0],zl[1],Ma[0],Ma[1]);vi.overrideFog=bu>=vn||xu>=vn}}const Qi=Yr.material;let Us;Qi.occlusionTexture&&Qi.occlusionTexture.offsetScale&&(Us=Qi.occlusionTexture.offsetScale,vi.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!nn&&Qe&&(Qe.useNormalOffset=!!Yr.normalBuffer);const Ms=we.getOrCreateProgram("model",vi);!nn&&Qe&&Qe.setupShadowsFromMatrix(jr.tileModelMatrix,Ms,Qe.useNormalOffset),we.uploadCommonUniforms(je,Ms,null,Ji);const ds=Qi.pbrMetallicRoughness;ds.metallicFactor=.9,ds.roughnessFactor=.5;const js=Gn(new Float32Array(bi),new Float32Array(vo),new Float32Array(Lr),new Float32Array(Vo.matrix),we,jr.opacity,ds.baseColorFactor.toRenderColor(null),Qi.emissiveFactor,ds.metallicFactor,ds.roughnessFactor,Qi,Yo,Ne,[0,0,0],Us);!gi&&(xo.hasTranslucentParts||jr.opacity<1)&&Ms.draw(we,je.gl.TRIANGLES,qt,Mr.disabled,Ur.disabled,yr.backCCW,js,Ne.id,Yr.vertexBuffer,Yr.indexBuffer,Yr.segments,Ne.paint,we.transform.zoom,void 0,Po),Ms.draw(we,je.gl.TRIANGLES,gi?yn:qt,Mr.disabled,gi||jr.opacity<1||xo.hasTranslucentParts?Ur.alphaBlended:Ur.unblended,yr.backCCW,js,Ne.id,Yr.vertexBuffer,Yr.indexBuffer,Yr.segments,Ne.paint,we.transform.zoom,void 0,Po)}}}}()}(f,r,l,p),void V();if(H.type!=="model")return;const W=H.getModels(),J=[],ee=f.transform.getFreeCameraOptions().position,re=o.a6.vec3.scale([],[ee.x,ee.y,ee.z],f.transform.worldSize);o.a6.vec3.negate(re,re);const ve=[],_e=[];let xe=0;for(const we of W){const ze=l.paint.get("model-rotation").constantOr(null),Ne=l.paint.get("model-scale").constantOr(null),Le=l.paint.get("model-translation").constantOr(null);we.computeModelMatrix(f,ze,Ne,Le,!0,!0,!1);const je=o.a6.mat4.identity([]),Ue=o.de(we.position.lat,f.transform.zoom),rt=o.a6.mat4.fromScaling([],[1,1,1/Ue]);o.a6.mat4.translate(je,je,re),J.push({zScaleMatrix:rt,negCameraPosMatrix:je});for(const Qe of we.nodes)Bd(f.transform,Qe,we.matrix,f.transform.expandedFarZProjMatrix,xe,ve,_e);xe++}if(ve.sort((we,ze)=>ze.depth-we.depth),f.renderPass!=="shadow"){if(b===1)for(const we of _e)zd(we,f,l,J[we.modelIndex],Mr.disabled,f.colorModeForRenderPass());else{for(const we of _e)zd(we,f,l,J[we.modelIndex],Mr.disabled,Ur.disabled);for(const we of _e)zd(we,f,l,J[we.modelIndex],f.stencilModeFor3D(),f.colorModeForRenderPass());f.resetStencilClippingMasks()}for(const we of ve)zd(we,f,l,J[we.modelIndex],Mr.disabled,f.colorModeForRenderPass());V()}else{for(const we of _e)pu(we.mesh,we.nodeModelMatrix,f,l);for(const we of ve)pu(we.mesh,we.nodeModelMatrix,f,l);V()}}},Af={model:function(f,r,l){const p=r.getSource();if(!p.loaded())return;if(p.type==="vector"||p.type==="geojson")return void(l.modelManager&&l.modelManager.upload(l,p.type==="vector"?f.scope:""));if(p.type==="batched-model"||p.type!=="model")return;const b=p.getModels();for(const S of b)S.upload(l.context)},raster:function(f,r,l){const p=r.getSource();if(!(p instanceof Nc&&p.loaded()))return;const b=f.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!b)return;const S=f.paint.get("raster-array-band")||p.getInitialBand(b);if(S==null)return;const E=r.getIds().map(O=>r.getTileByID(O));for(const O of E)O.updateNeeded(b,S)&&p.prepareTile(O,b,S)},"raster-particle":function(f,r,l){const p=r.getSource();if(!(p instanceof Nc&&p.loaded()))return;const b=f.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!b)return;const S=f.paint.get("raster-particle-array-band")||p.getInitialBand(b);if(S==null)return;const E=r.getIds().map(O=>r.getTileByID(O));for(const O of E)O.updateNeeded(b,S)&&p.prepareTile(O,b,S)}};class Xm{constructor(r,l,p,b){this.context=new S1(r,l),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=b,this._timeStamp=o.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const S=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const O of S)this._debugParams.enabledLayers[O]=!0;b.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),b.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),b.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const O of S)b.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],O);this.occlusionParams=new kf(b),this.setup(),this.numSublayers=ss.maxUnderzooming+ss.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new o.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new __(this),this._wireframeDebugCache=new Pl,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const E=new o.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new o.T(this.context,E,r.RGBA8),this._clippingActiveLastFrame=!1}updateTerrain(r,l){const p=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Om(this,r));const b=this._terrain;this.transform.elevation=p?b:null,b.update(r,this.transform,l),this.transform.elevation&&!b.enabled&&(this.transform.elevation=null)}_updateFog(r){const l=r.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,b]=l.getFovAdjustedRange(this.transform._fov);if(p>b)return void(this.transform.fogCullDistSq=null);const S=p+.78*(b-p);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(r){r&&!this._terrain&&(this._terrain=new Om(this,this.style)),this._forceTerrainMode=r}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,l){if(this.width=r*o.q.devicePixelRatio,this.height=l*o.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._mergedLayers[p].resize()}setup(){const r=this.context,l=new o.a_;l.emplaceBack(0,0),l.emplaceBack(o.ab,0),l.emplaceBack(0,o.ab),l.emplaceBack(o.ab,o.ab),this.tileExtentBuffer=r.createVertexBuffer(l,o.b0.members),this.tileExtentSegments=o.b1.simpleSegment(0,0,4,2);const p=new o.a_;p.emplaceBack(0,0),p.emplaceBack(o.ab,0),p.emplaceBack(0,o.ab),p.emplaceBack(o.ab,o.ab),this.debugBuffer=r.createVertexBuffer(p,o.b0.members),this.debugSegments=o.b1.simpleSegment(0,0,4,5);const b=new o.a_;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(-1,1),b.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(b,o.b0.members),this.viewportSegments=o.b1.simpleSegment(0,0,4,2);const S=new o.aN;S.emplaceBack(0,0,0,0),S.emplaceBack(o.ab,0,o.ab,0),S.emplaceBack(0,o.ab,0,o.ab),S.emplaceBack(o.ab,o.ab,o.ab,o.ab),this.mercatorBoundsBuffer=r.createVertexBuffer(S,o.b3.members),this.mercatorBoundsSegments=o.b1.simpleSegment(0,0,4,2);const E=new o.aO;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(E);const O=new o.a$;for(const H of[0,1,3,2,0])O.emplaceBack(H);this.debugIndexBuffer=r.createIndexBuffer(O),this.emptyTexture=new o.T(r,new o.r({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA8),this.identityMat=o.a6.mat4.create();const V=this.context.gl;this.stencilClearMode=new Mr({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,or.disabled,this.stencilClearMode,Ur.disabled,yr.disabled,kd(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,l,p){if(!l||this.currentStencilSource===l.id||!r.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const V of p)if(this._tileClippingMaskIDs[V.key]===void 0){O=!0;break}if(!O)return}this.currentStencilSource=l.id;const b=this.context,S=b.gl;this.nextStencilID+p.length>256&&this.clearStencil(),b.setColorMode(Ur.disabled),b.setDepthMode(or.disabled);const E=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of p){const V=l.getTile(O),H=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:W,tileBoundsIndexBuffer:J,tileBoundsSegments:ee}=this.getTileBoundsBuffers(V);E.draw(this,S.TRIANGLES,or.disabled,new Mr({func:S.ALWAYS,mask:0},H,255,S.KEEP,S.KEEP,S.REPLACE),Ur.disabled,yr.disabled,kd(O.projMatrix),"$clipping",W,J,ee)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,l=this.context.gl;return new Mr({func:l.NOTEQUAL,mask:255},r,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const l=this.context.gl;return new Mr({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(r){const l=this.context.gl,p=r.sort((E,O)=>O.overscaledZ-E.overscaledZ),b=p[p.length-1].overscaledZ,S=p[0].overscaledZ-b+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const E={};for(let O=0;O<S;O++)E[O+b]=new Mr({func:l.GEQUAL,mask:255},O+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=S,[E,p]}return[{[b]:Mr.disabled},p]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Ur([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new o.bz(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ur.unblended:Ur.alphaBlended}colorModeForDrapableLayerRenderPass(r){const l=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Ur([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new o.bz(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,l,p,b=!1){if(this.depthOcclusion)return new or(this.context.gl.GREATER,or.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!b)return or.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new or(p||this.context.gl.LEQUAL,l,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const r=this.context.gl,l=Math.ceil(this.width),p=Math.ceil(this.height),b=this.context.bindFramebuffer.get(),S=r.getParameter(r.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===p||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&p!==0&&(this.depthFBO=new bf(this.context,l,p,!1,"texture"),this.depthTexture=new o.T(this.context,{width:l,height:p,data:null},r.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(b),r.bindTexture(r.TEXTURE_2D,S),this.depthFBO&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),r.blitFramebuffer(0,0,l,p,0,0,l,p,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((r,l)=>r+l/this._fpsHistory.length,0))}render(r,l){const p=o.q.now();this._dt=p-this._timeStamp,this._timeStamp=p,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=r.map.repaint,this.style=r,this.options=l;const b=this.style._mergedLayers,S=this.style.order.filter(ht=>{const ct=b[ht];return!(ct.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[ct.type]});let E=!1,O=!1;for(const ht of S){const ct=b[ht];ct.type==="circle"&&(E=!0),ct.type==="symbol"&&(ct.hasInitialOcclusionOpacityProperties?O=!0:E=!0)}const V=S.map(ht=>b[ht]),H=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(o.q.now()),this.imageManager.beginFrame();let W=0,J=!1;for(const ht in H){const ct=H[ht];ct.used&&(ct.prepare(this.context),ct.getSource().usedInConflation&&++W)}let ee=!1;for(const ht of V)ht.isHidden(this.transform.zoom)||(ht.type==="clip"&&(ee=!0),this.prepareLayer(ht));const re={},ve={},_e={},xe={},we={};for(const ht in H){const ct=H[ht];re[ht]=ct.getVisibleCoordinates(),ve[ht]=re[ht].slice().reverse(),_e[ht]=ct.getVisibleCoordinates(!0).reverse(),xe[ht]=ct.getShadowCasterCoordinates(),we[ht]=ct.sortCoordinatesByDistance(re[ht])}const ze=ht=>{const ct=this.style.getLayerSourceCache(ht);return ct&&ct.used?ct.getSource():null};if(W||ee||this._clippingActiveLastFrame){const ht=[],ct=[];let Ct=0;for(const Kt of V)this.isSourceForClippingOrConflation(Kt,ze(Kt))&&(ht.push(Kt),ct.push(Ct)),Ct++;if(ht&&(ee||ht.length>1)||this._clippingActiveLastFrame){ee=!1;const Kt=[];for(let cn=0;cn<ht.length;cn++){const qt=ht[cn],yn=ct[cn],Et=this.style.getLayerSourceCache(qt);if(!Et||!Et.used||!Et.getSource().usedInConflation&&qt.type!=="clip")continue;let nn=o.dn,Qt=o.bs.None;const bn=[];let wn=!0;if(qt.type==="clip"){nn=yn;for(const an of qt.layout.get("clip-layer-types"))Qt|=an==="model"?o.bs.Model:an==="symbol"?o.bs.Symbol:o.bs.FillExtrusion;for(const an of qt.layout.get("clip-layer-scope"))bn.push(an);qt.isHidden(this.transform.zoom)?wn=!1:ee=!0}wn&&Kt.push({layer:qt.fqid,cache:Et,order:nn,clipMask:Qt,clipScope:bn})}this.replacementSource.setSources(Kt),J=!0}}this._clippingActiveLastFrame=ee,J||this.replacementSource.clear(),this.conflationActive=J,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let ht=0;ht<V.length;ht++){const ct=V[ht],Ct=ct.cutoffRange();if(this.longestCutoffRange=Math.max(Ct,this.longestCutoffRange),Ct>0){const Kt=ze(ct);Kt&&(this.minCutoffZoom=Math.max(Kt.minzoom,this.minCutoffZoom)),ct.minzoom&&(this.minCutoffZoom=Math.max(ct.minzoom,this.minCutoffZoom))}ct.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=ht),this._lastOcclusionLayer=ht)}const Ne=this.style&&this.style.fog;Ne?(this._fogVisible=Ne.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ne.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(_e),this.opaquePassCutoff=0);const Le=this._shadowRenderer;if(Le){Le.updateShadowParameters(this.transform,this.style.directionalLight);for(const ht in H)for(const ct of re[ht]){let Ct={min:0,max:0};this.terrain&&(Ct=this.terrain.getMinMaxForTile(ct)||Ct),Le.addShadowReceiver(ct.toUnwrapped(),Ct.min,Ct.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Ef(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!At.has(this.context.gl))return;this.renderPass="offscreen";for(const ht of V){const ct=r.getLayerSourceCache(ht);if(!ht.hasOffscreenPass()||ht.isHidden(this.transform.zoom))continue;const Ct=ct?ve[ct.id]:void 0;(ht.type==="custom"||ht.type==="raster"||ht.type==="raster-particle"||ht.isSky()||Ct&&Ct.length)&&this.renderLayer(this,ct,ht,Ct)}this.depthRangeFor3D=[0,1-(V.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,xe)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const je=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ue=(()=>{if(l.showOverdrawInspector)return o.bz.black;const ht=this.style.fog;if(ht&&this.transform.projection.supportsFog){const ct=this.style.getLut(ht.scope);if(!je){const Ct=ht.properties.get("color").toRenderColor(ct).toArray01();return new o.bz(...Ct)}if(je){const Ct=ht.properties.get("space-color").toRenderColor(ct).toArray01();return new o.bz(...Ct)}}return o.bz.transparent})();if(this.context.clear({color:Ue,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&je&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){const ht=V[this.currentLayer],ct=r.getLayerSourceCache(ht);if(ht.isSky())continue;const Ct=ct?(ht.is3D()?we:ve)[ct.id]:void 0;this._renderTileClippingMasks(ht,ct,Ct),this.renderLayer(this,ct,ht,Ct)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&je&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||o.a9(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){const ht=V[this.currentLayer],ct=r.getLayerSourceCache(ht);ht.isSky()&&this.renderLayer(this,ct,ht,ct?ve[ct.id]:void 0)}function rt(ht,ct){let Ct;return ct&&(Ct=(ht.type==="symbol"?_e:ht.is3D()?we:ve)[ct.id]),Ct}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<S.length;){const ht=V[this.currentLayer];if(ht.type==="raster"||ht.type==="raster-particle"){const ct=r.getLayerSourceCache(ht);this.renderLayer(this,ct,ht,rt(ht,ct))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Qe=0;Le&&(Qe=Le.getShadowCastingLayerCount());let ot=!1,gt=-1;for(let ht=0;ht<S.length;++ht){const ct=V[ht];ct.isHidden(this.transform.zoom)||ct.is3D()&&(gt=ht)}for(O&&gt===-1&&(E=!0);this.currentLayer<S.length;){const ht=V[this.currentLayer],ct=r.getLayerSourceCache(ht);if(ht.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(ht)){if(ht.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(E&&!ot&&this.terrain&&!this.transform.isOrthographic&&(ot=!0,this.blitDepth()),O&&gt!==-1&&this.currentLayer===gt+1&&!this.transform.isOrthographic&&this.blitDepth(),ht.is3D()||this.terrain||this._renderTileClippingMasks(ht,ct,ct?re[ct.id]:void 0),this.renderLayer(this,ct,ht,rt(ht,ct)),!this.terrain&&Le&&Qe>0&&ht.hasShadowPass()&&--Qe==0&&(Le.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Ct=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Ct;this.currentLayer++){const Kt=V[this.currentLayer];if(!Kt.hasLightBeamPass())continue;const cn=r.getLayerSourceCache(Kt);this.renderLayer(this,cn,Kt,cn?ve[cn.id]:void 0)}this.currentLayer=Ct,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Ct=this.currentLayer;this.depthOcclusion=!0;for(const Kt of this.layersWithOcclusionOpacity){this.currentLayer=Kt;const cn=V[this.currentLayer],qt=r.getLayerSourceCache(cn),yn=qt?ve[qt.id]:void 0;cn.is3D()||this.terrain||this._renderTileClippingMasks(cn,qt,qt?re[qt.id]:void 0),this.renderLayer(this,qt,cn,yn)}this.depthOcclusion=!1,this.currentLayer=Ct,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ht=null;V.forEach(ct=>{const Ct=r.getLayerSourceCache(ct);Ct&&!ct.isHidden(this.transform.zoom)&&Ct.getVisibleCoordinates().length&&(!ht||ht.getSource().maxzoom<Ct.getSource().maxzoom)&&(ht=Ct)}),ht&&this.options.showTileBoundaries&&Rl.debug(this,ht,ht.getVisibleCoordinates(),o.bz.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Rl.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new o.bz(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(ht){const ct=ht.transform.padding;$o(ht,ht.transform.height-(ct.top||0),3,E1),$o(ht,ct.bottom||0,3,du),Dt(ht,ct.left||0,3,hu),Dt(ht,ht.transform.width-(ct.right||0),3,Sn);const Ct=ht.transform.centerPoint;(function(Kt,cn,qt,yn){Od(Kt,cn-1,qt-10,2,20,yn),Od(Kt,cn-10,qt-1,20,2,yn)})(ht,Ct.x,ht.transform.height-Ct.y,Qn)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),J||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:l}=this.transform.projection,p=!l||!l.includes(r.type);if(Af[r.type]&&(p||this.terrain&&r.type==="custom")){const b=this.style.getLayerSourceCache(r);Af[r.type](r,b,this)}this.gpuTimingEnd()}renderLayer(r,l,p,b){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||p.type==="model"||p.type==="raster"||p.type==="raster-particle"||b&&b.length)&&(this.id=p.id,this.gpuTimingStart(p),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(p.type)&&(!r.terrain||p.type!=="custom")||p.type==="clip"||Rl[p.type](r,l,p,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,p=this.context.gl;let b=this.gpuTimers[r.id];b||(b=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:p.createQuery()}),b.calls++,p.beginQuery(l.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,l=this.context.gl,p=l.createQuery();this.deferredRenderGpuTimeQueries.push(p),l.beginQuery(r.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const l={};for(const p in r){const b=r[p],S=this.context.extTimerQuery,E=S.getQueryParameter(b.query,this.context.gl.QUERY_RESULT)/1e6;S.deleteQueryEXT(b.query),l[p]=E}return l}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.extTimerQuery,p=this.context.gl;let b=0;for(const S of r)b+=l.getQueryParameter(S,p.QUERY_RESULT)/1e6,l.deleteQueryEXT(S);return b}translatePosMatrix(r,l,p,b,S){if(!p[0]&&!p[1])return r;const E=S?b==="map"?this.transform.angle:0:b==="viewport"?-this.transform.angle:0;if(E){const H=Math.sin(E),W=Math.cos(E);p=[p[0]*W-p[1]*H,p[0]*H+p[1]*W]}const O=[S?p[0]:o.ak(l,p[0],this.transform.zoom),S?p[1]:o.ak(l,p[1],this.transform.zoom),0],V=new Float32Array(16);return o.a6.mat4.translate(V,r,O),V}saveTileTexture(r){const l=r.size[0],p=this._tileTextures[l];p?p.push(r):this._tileTextures[l]=[r]}getTileTexture(r){const l=this._tileTextures[r];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,l,p){const b=p===void 0?this.terrain&&this.terrain.renderingToTexture:p,S=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(S.push("LIGHTING_3D_MODE"),S.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):b||S.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||S.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?S.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):S.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(S.push("TERRAIN"),this.linearFloatFilteringSupported()&&S.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&S.push("GLOBE"),!this._fogVisible||b||l!==void 0&&!l||S.push("FOG","FOG_DITHERING"),b&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}getOrCreateProgram(r,l){this.cache=this.cache||{};const p=l&&l.defines||[],b=l&&l.config,S=this.currentGlobalDefines(r,l&&l.overrideFog,l&&l.overrideRtt).concat(p),E=kl.cacheKey(Ml[r],r,S,b);return this.cache[E]||(this.cache[E]=new kl(this.context,r,Ml[r],b,Z_[r],S)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,l){if(this.style.enable3dLights()){const p=this.style.directionalLight,b=this.style.ambientLight;if(p&&b){const S=((E,O,V)=>{const H=E.properties.get("direction"),W=E.properties.get("color").toRenderColor(V.getLut(E.scope)).toArray01(),J=E.properties.get("intensity"),ee=O.properties.get("color").toRenderColor(V.getLut(O.scope)).toArray01(),re=O.properties.get("intensity"),ve=[H.x,H.y,H.z],_e=o.cH(ee,re),xe=o.cH(W,J);return{u_lighting_ambient_color:_e,u_lighting_directional_dir:ve,u_lighting_directional_color:xe,u_ground_radiance:zm(ve,xe,_e)}})(p,b,this.style);l.setLightsUniformValues(r,S)}}}uploadCommonUniforms(r,l,p,b,S){if(this.uploadCommonLightUniforms(r,l),this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const O=E.getOpacity(this.transform.pitch),V=((H,W,J,ee,re,ve,_e,xe,we,ze,Ne,Le)=>{const je=H.transform,Ue=W.properties.get("color").toRenderColor(H.style.getLut(W.scope)).toArray01();Ue[3]=ee;const rt=H.frameCounter/1e3%1,[Qe,ot]=W.properties.get("vertical-range");return{u_fog_matrix:J?je.calculateFogTileMatrix(J):Le||H.identityMat,u_fog_range:W.getFovAdjustedRange(je._fov),u_fog_color:Ue,u_fog_horizon_blend:W.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Qe,ot),ot],u_fog_temporal_offset:rt,u_frustum_tl:re,u_frustum_tr:ve,u_frustum_br:_e,u_frustum_bl:xe,u_globe_pos:we,u_globe_radius:ze,u_viewport:Ne,u_globe_transition:o.a9(je.zoom),u_is_globe:+(je.projection.name==="globe")}})(this,E,p,O,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.q.devicePixelRatio,this.transform.height*o.q.devicePixelRatio],b);l.setFogUniformValues(r,V)}S&&l.setCutoffUniformValues(r,S.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,l=r.createTexture();return r.bindTexture(r.TEXTURE_2D,l),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,l=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const b of p)l[b.key]=r[b.key]||new ba(b,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(r,l){return!(!r.is3D()||r.type!=="clip"&&(r.minzoom&&r.minzoom>this.transform.zoom||(this.style._clipLayerPresent||r.sourceLayer!=="building")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[r.key];return l||(this._cachedTileFogOpacities[r.key]=l=this.style.fog.getOpacityForTile(r)),l[0]>=vn||l[1]>=vn}setupDepthForOcclusion(r,l,p){const b=this.context,S=b.gl,E=!!p;var O;p||(p={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),b.activeTexture.set(S.TEXTURE3),r&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),p.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],p.u_depth_range_unpack=[2/((O=this.depthRangeFor3D)[1]-O[0]),-1-2*O[0]/(O[1]-O[0])],p.u_occluder_half_size=.5*this.occlusionParams.occluderSize,p.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),b.activeTexture.set(S.TEXTURE0),E||l.setTerrainUniformValues(b,p)}}function Za(f,r){let l=!1,p=null;const b=()=>{p=null,l&&(f(),p=setTimeout(b,r),l=!1)};return()=>(l=!0,p||b(),p)}class Dl{constructor(r){this._hashName=r&&encodeURIComponent(r),o.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Za(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const l=Ya(r);if(this._hashName){const p=this._hashName;let b=!1;const S=location.hash.slice(1).split("&").map(E=>{const O=E.split("=")[0];return O===p?(b=!0,`${O}=${l}`):E}).filter(E=>E);return b||S.push(`${p}=${l}`),`#${S.join("&")}`}return`#${l}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(l=p)}),(l&&l[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(p=>isNaN(p))){const p=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(l[3]||0):r.getBearing();return r.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Ya(f,r){const l=f.getCenter(),p=Math.round(100*f.getZoom())/100,b=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,b),E=Math.round(l.lng*S)/S,O=Math.round(l.lat*S)/S,V=f.getBearing(),H=f.getPitch();let W=r?`/${E}/${O}/${p}`:`${p}/${O}/${E}`;return(V||H)&&(W+="/"+Math.round(10*V)/10),H&&(W+=`/${Math.round(H)}`),W}const pc={linearity:.3,easing:o.dp(0,0,.3,1)},Pf=o.l({deceleration:2500,maxSpeed:1400},pc),Jm=o.l({deceleration:20,maxSpeed:1400},pc),Qm=o.l({deceleration:1e3,maxSpeed:360},pc),eg=o.l({deceleration:1e3,maxSpeed:90},pc);class Ll{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.q.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,l=o.q.now();for(;r.length>0&&l-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)l.zoom+=S.zoomDelta||0,l.bearing+=S.bearingDelta||0,l.pitch+=S.pitchDelta||0,S.panDelta&&l.pan._add(S.panDelta),S.around&&(l.around=S.around),S.pinchAround&&(l.pinchAround=S.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(l.pan.mag()){const S=mc(l.pan.mag(),p,o.l({},Pf,r||{}));b.offset=l.pan.mult(S.amount/l.pan.mag()),b.center=this._map.transform.center,mu(b,S)}if(l.zoom){const S=mc(l.zoom,p,Jm);b.zoom=this._map.transform.zoom+S.amount,mu(b,S)}if(l.bearing){const S=mc(l.bearing,p,Qm);b.bearing=this._map.transform.bearing+o.ap(S.amount,-179,179),mu(b,S)}if(l.pitch){const S=mc(l.pitch,p,eg);b.pitch=this._map.transform.pitch+S.amount,mu(b,S)}if(b.zoom||b.bearing){const S=l.pinchAround===void 0?l.around:l.pinchAround;b.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),b.noMoveStart=!0,b}}function mu(f,r){(!f.duration||f.duration<r.duration)&&(f.duration=r.duration,f.easing=r.easing)}function mc(f,r,l){const{maxSpeed:p,linearity:b,deceleration:S}=l,E=o.ap(f*b/(r/1e3),-p,p),O=Math.abs(E)/(S*b);return{easing:l.easing,duration:1e3*O,amount:E*(O/2)}}class Xi extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p,b={}){const S=pe(l.getCanvasContainer(),p),E=l.unproject(S);super(r,o.l({point:S,lngLat:E,originalEvent:p},b)),this._defaultPrevented=!1,this.target=l}}class gu extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p){const b=r==="touchend"?p.changedTouches:p.touches,S=ge(l.getCanvasContainer(),b),E=S.map(V=>l.unproject(V)),O=S.reduce((V,H,W,J)=>V.add(H.div(J.length)),new o.P(0,0));super(r,{points:S,point:O,lngLats:E,lngLat:l.unproject(O),originalEvent:p}),this._defaultPrevented=!1}}class Ii extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class tg{constructor(r,l){this._map=r,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new Ii(this._map,r))}mousedown(r,l){return this._mousedownPos=l,this._firePreventable(new Xi(r.type,this._map,r))}mouseup(r){this._map.fire(new Xi(r.type,this._map,r))}preclick(r){const l=o.l({},r);l.type="preclick",this._map.fire(new Xi(l.type,this._map,l))}click(r,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(r),this._map.fire(new Xi(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new Xi(r.type,this._map,r))}mouseover(r){this._map.fire(new Xi(r.type,this._map,r))}mouseout(r){this._map.fire(new Xi(r.type,this._map,r))}touchstart(r){return this._firePreventable(new gu(r.type,this._map,r))}touchmove(r){this._map.fire(new gu(r.type,this._map,r))}touchend(r){this._map.fire(new gu(r.type,this._map,r))}touchcancel(r){this._map.fire(new gu(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ng{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new Xi(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Xi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new Xi(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vu{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,l){this.isEnabled()&&r.shiftKey&&r.button===0&&(X(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(r,l){if(!this._active)return;const p=l,b=this._startPos,S=this._lastPos;if(!b||!S||S.equals(p)||!this._box&&p.dist(b)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=G("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const E=Math.min(b.x,p.x),O=Math.max(b.x,p.x),V=Math.min(b.y,p.y),H=Math.max(b.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${E}px,${V}px)`,this._box.style.width=O-E+"px",this._box.style.height=H-V+"px")})}mouseupWindow(r,l){if(!this._active)return;const p=this._startPos,b=l;if(p&&r.button===0){if(this.reset(),le(),p.x!==b.x||p.y!==b.y)return this._map.fire(new o.x("boxzoomend",{originalEvent:r})),{cameraAnimation:S=>S.fitScreenCoordinates(p,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ie(),delete this._startPos,delete this._lastPos}_fireEvent(r,l){return this._map.fire(new o.x(r,{originalEvent:l}))}}function Xa(f,r){const l={};for(let p=0;p<f.length;p++)l[f[p].identifier]=r[p];return l}class rg{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,l,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),p.length===this.numTouches&&(this.centroid=function(b){const S=new o.P(0,0);for(const E of b)S._add(E);return S.div(b.length)}(l),this.touches=Xa(p,l)))}touchmove(r,l,p){if(this.aborted||!this.centroid)return;const b=Xa(p,l);for(const S in this.touches){const E=b[S];(!E||E.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(r,l,p){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class Nd{constructor(r){this.singleTap=new rg(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,l,p){this.singleTap.touchstart(r,l,p)}touchmove(r,l,p){this.singleTap.touchmove(r,l,p)}touchend(r,l,p){const b=this.singleTap.touchend(r,l,p);if(b){const S=r.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(b)<30;if(S&&E||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class og{constructor(){this._zoomIn=new Nd({numTouches:1,numTaps:2}),this._zoomOut=new Nd({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,l,p){this._zoomIn.touchstart(r,l,p),this._zoomOut.touchstart(r,l,p)}touchmove(r,l,p){this._zoomIn.touchmove(r,l,p),this._zoomOut.touchmove(r,l,p)}touchend(r,l,p){const b=this._zoomIn.touchend(r,l,p),S=this._zoomOut.touchend(r,l,p);return b?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(b)},{originalEvent:r})}):S?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(S)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const $d={0:1,2:2};class Vd{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,l){return!1}_move(r,l){return{}}mousedown(r,l){if(this._lastPoint)return;const p=he(r);this._correctButton(r,p)&&(this._lastPoint=l,this._eventButton=p)}mousemoveWindow(r,l){const p=this._lastPoint;if(p){if(r.preventDefault(),this._eventButton!=null&&function(b,S){const E=$d[S];return b.buttons===void 0||(b.buttons&E)!==E}(r,this._eventButton))this.reset();else if(this._moved||!(l.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(p,l)}}mouseupWindow(r){this._lastPoint&&he(r)===this._eventButton&&(this._moved&&le(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rf extends Vd{mousedown(r,l){super.mousedown(r,l),this._lastPoint&&(this._active=!0)}_correctButton(r,l){return l===0&&!r.ctrlKey}_move(r,l){return{around:l,panDelta:l.sub(r)}}}class Df extends Vd{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const p=.8*(l.x-r.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(r){r.preventDefault()}}class Lf extends Vd{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const p=-.5*(l.y-r.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(r){r.preventDefault()}}class ry{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),o.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}touchstart(r,l,p){return this._calculateTransform(r,l,p)}touchmove(r,l,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!o.dq())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,l,p)}}touchend(r,l,p){this._calculateTransform(r,l,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,l,p){p.length>0&&(this._active=!0);const b=Xa(p,l),S=new o.P(0,0),E=new o.P(0,0);let O=0;for(const H in b){const W=b[H],J=this._touches[H];J&&(S._add(W),E._add(W.sub(J)),O++,b[H]=W)}if(this._touches=b,O<this._minTouches||!E.mag())return;const V=E.div(O);return this._sum._add(V),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(O),panDelta:V}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=G("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Of{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,l,p){return{}}touchstart(r,l,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([l[0],l[1]]))}touchmove(r,l,p){const b=this._firstTwoTouches;if(!b)return;r.preventDefault();const[S,E]=b,O=Ud(p,l,S),V=Ud(p,l,E);if(!O||!V)return;const H=this._aroundCenter?null:O.add(V).div(2);return this._move([O,V],H,r)}touchend(r,l,p){if(!this._firstTwoTouches)return;const[b,S]=this._firstTwoTouches,E=Ud(p,l,b),O=Ud(p,l,S);E&&O||(this._active&&le(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ud(f,r,l){for(let p=0;p<f.length;p++)if(f[p].identifier===l)return r[p]}function ig(f,r){return Math.log(f/r)/Math.LN2}class oy extends Of{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,l){const p=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(ig(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ig(this._distance,p),pinchAround:l}}}function sg(f,r){return 180*f.angleWith(r)/Math.PI}class iy extends Of{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,l){const p=this._vector;if(this._vector=r[0].sub(r[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:sg(this._vector,p),pinchAround:l}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const l=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const b=sg(r,p);return Math.abs(b)<l}}function zf(f){return Math.abs(f.y)>Math.abs(f.x)}class sy extends Of{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,zf(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,l,p){const b=this._lastPoints;if(!b)return;const S=r[0].sub(b[0]),E=r[1].sub(b[1]);return this._map._cooperativeGestures&&!o.dq()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(S,E,p.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(S.y+E.y)/2*-.5})}gestureBeginsVertically(r,l,p){if(this._valid!==void 0)return this._valid;const b=r.mag()>=2,S=l.mag()>=2;if(!b&&!S)return;if(!b||!S)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const E=r.y>0==l.y>0;return zf(r)&&zf(l)&&E}}const ay={panStep:100,bearingStep:15,pitchStep:10};class ly{constructor(){const r=ay;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let l=0,p=0,b=0,S=0,E=0;switch(r.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:r.shiftKey?p=-1:(r.preventDefault(),S=-1);break;case 39:r.shiftKey?p=1:(r.preventDefault(),S=1);break;case 38:r.shiftKey?b=1:(r.preventDefault(),E=-1);break;case 40:r.shiftKey?b=-1:(r.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(p=0,b=0),{cameraAnimation:O=>{const V=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:cy,zoom:l?Math.round(V)+l*(r.shiftKey?2:1):V,bearing:O.getBearing()+p*this._bearingStep,pitch:O.getPitch()+b*this._pitchStep,offset:[-S*this._panStep,-E*this._panStep],center:O.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function cy(f){return f*(2-f)}const ag=4.000244140625,P1=1/450;class R1{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=P1,o.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||o.dq()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const p=o.q.now(),b=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,l!==0&&l%ag==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(b*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),r.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=r,this._delta-=l,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=pe(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const H=this._type==="wheel"&&Math.abs(this._delta)>ag?this._wheelZoomRate:this._defaultZoomRate;let W=2/(1+Math.exp(-Math.abs(this._delta*H)));this._delta<0&&W!==0&&(W=1/W);const J=l(),ee=Math.pow(2,J),re=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):ee;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(re*W))),this._type==="wheel"&&(this._startZoom=J,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:l(),b=this._startZoom,S=this._easing;let E,O=!1;if(this._type==="wheel"&&b&&S){const H=Math.min((o.q.now()-this._lastWheelEventTime)/200,1),W=S(H);E=o.aa(b,p,W),H<1?this._frameId||(this._frameId=!0):O=!0}else E=p,O=!0;this._active=!0,O&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let V=E-l();return V*this._lastDelta<0&&(V=0),{noInertia:!0,needsRenderFrame:!O,zoomDelta:V,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let l=o.dr;if(this._prevEase){const p=this._prevEase,b=(o.q.now()-p.start)/p.duration,S=p.easing(b+.01)-p.easing(b),E=.27/Math.sqrt(S*S+1e-4)*.01,O=Math.sqrt(.0729-E*E);l=o.dp(E,O,.25,1)}return this._prevEase={start:o.q.now(),duration:r,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=G("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Zo{constructor(r,l){this._clickZoom=r,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class uy{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,l){return r.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(r.shiftKey?-1:1),around:p.unproject(l)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class D1{constructor(){this._tap=new Nd({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,l,p){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=l[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(r,l,p))}touchmove(r,l,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const b=l[0],S=b.y-this._swipePoint.y;return this._swipePoint=b,r.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(r,l,p)}touchend(r,l,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(r,l,p)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class L1{constructor(r,l,p){this._el=r,this._mousePan=l,this._touchPan=p}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class jd{constructor(r,l,p){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=l,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class dy{constructor(r,l,p,b){this._el=r,this._touchZoom=l,this._touchRotate=p,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const _u=f=>f.zoom||f.drag||f.pitch||f.rotate;class Bf extends o.x{}class Ja{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,l){const p=o.a6.vec3.sub([],l,r);this.radius=o.a6.vec3.length(p[2]<0?o.a6.vec3.div([],p,this.constants):[p[0],p[1],0])}projectRay(r){o.a6.vec3.div(r,r,this.constants),o.a6.vec3.normalize(r,r),o.a6.vec3.mul(r,r,this.constants);const l=o.a6.vec3.scale([],r,this.radius);if(l[2]>0){const p=o.a6.vec3.scale([],[0,0,1],o.a6.vec3.dot(l,[0,0,1])),b=o.a6.vec3.scale([],o.a6.vec3.normalize([],[l[0],l[1],0]),this.radius),S=o.a6.vec3.add([],l,o.a6.vec3.scale([],o.a6.vec3.sub([],o.a6.vec3.add([],b,p),l),2));l[0]=S[0],l[1]=S[1]}return l}}function gc(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class ji{constructor(r,l){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ll(r),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ja,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),o.aJ(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[b,S,E]of this._listeners){const O=b===document?this.handleWindowEvent:this.handleEvent;b.addEventListener(S,O,E)}}destroy(){for(const[r,l,p]of this._listeners){const b=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(l,b,p)}}_addDefaultHandlers(r){const l=this._map,p=l.getCanvasContainer();this._add("mapEvent",new tg(l,r));const b=l.boxZoom=new vu(l,r);this._add("boxZoom",b);const S=new og,E=new uy;l.doubleClickZoom=new Zo(E,S),this._add("tapZoom",S),this._add("clickZoom",E);const O=new D1;this._add("tapDragZoom",O);const V=l.touchPitch=new sy(l);this._add("touchPitch",V);const H=new Df(r),W=new Lf(r);l.dragRotate=new jd(r,H,W),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",W,["mouseRotate"]);const J=new Rf(r),ee=new ry(l,r);l.dragPan=new L1(p,J,ee),this._add("mousePan",J),this._add("touchPan",ee,["touchZoom","touchRotate"]);const re=new iy,ve=new oy;l.touchZoomRotate=new dy(p,ve,re,O),this._add("touchRotate",re,["touchPan","touchZoom"]),this._add("touchZoom",ve,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ng(l));const _e=l.scrollZoom=new R1(l,this);this._add("scrollZoom",_e,["mousePan"]);const xe=l.keyboard=new ly;this._add("keyboard",xe);for(const we of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[we]&&l[we].enable(r[we])}_add(r,l,p){this._handlers.push({handlerName:r,handler:l,allowed:p}),this._handlersById[r]=l}stop(r){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!_u(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,l,p){for(const b in r)if(b!==p&&(!l||l.indexOf(b)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const l=[];for(const p of r)this._el.contains(p.target)&&l.push(p);return l}handleEvent(r,l){this._updatingCamera=!0;const p=r.type==="renderFrame",b=p?void 0:r,S={needsRenderFrame:!1},E={},O={},V=r.touches?this._getMapTouches(r.touches):void 0,H=V?ge(this._el,V):p?void 0:pe(this._el,r);for(const{handlerName:ee,handler:re,allowed:ve}of this._handlers){if(!re.isEnabled())continue;let _e;this._blockedByActive(O,ve,ee)?re.reset():re[l||r.type]&&(_e=re[l||r.type](r,H,V),this.mergeHandlerResult(S,E,_e,ee,b),_e&&_e.needsRenderFrame&&this._triggerRenderFrame()),(_e||re.isActive())&&(O[ee]=re)}const W={};for(const ee in this._previousActiveHandlers)O[ee]||(W[ee]=b);this._previousActiveHandlers=O,(Object.keys(W).length||gc(S))&&(this._changes.push([S,E,W]),this._triggerRenderFrame()),(Object.keys(O).length||gc(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=S;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))}mergeHandlerResult(r,l,p,b,S){if(!p)return;o.l(r,p);const E={handlerName:b,originalEvent:p.originalEvent||S};p.zoomDelta!==void 0&&(l.zoom=E),p.panDelta!==void 0&&(l.drag=E),p.pitchDelta!==void 0&&(l.pitch=E),p.bearingDelta!==void 0&&(l.rotate=E)}_applyChanges(){const r={},l={},p={};for(const[b,S,E]of this._changes)b.panDelta&&(r.panDelta=(r.panDelta||new o.P(0,0))._add(b.panDelta)),b.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+b.pitchDelta),b.around!==void 0&&(r.around=b.around),b.aroundCoord!==void 0&&(r.aroundCoord=b.aroundCoord),b.pinchAround!==void 0&&(r.pinchAround=b.pinchAround),b.noInertia&&(r.noInertia=b.noInertia),o.l(l,S),o.l(p,E);this._updateMapTransform(r,l,p),this._changes=[]}_updateMapTransform(r,l,p){const b=this._map,S=b.transform,E=ze=>[ze.x,ze.y,ze.z];if((ze=>{const Ne=this._eventsInProgress.drag;return Ne&&!this._handlersById[Ne.handlerName].isActive()})()&&!gc(r)){const ze=S.zoom;S.cameraElevationReference="sea",this._originalZoom!=null&&S._orthographicProjectionAtLowPitch&&S.projection.name!=="globe"&&S.pitch===0?(S.cameraElevationReference="ground",S.zoom=this._originalZoom):(S.recenterOnTerrain(),S.cameraElevationReference="ground"),ze!==S.zoom&&this._map._update(!0)}if(S._isCameraConstrained&&b._stop(!0),!gc(r))return void this._fireEvents(l,p,!0);let{panDelta:O,zoomDelta:V,bearingDelta:H,pitchDelta:W,around:J,aroundCoord:ee,pinchAround:re}=r;S._isCameraConstrained&&(V>0&&(V=0),S._isCameraConstrained=!1),re!==void 0&&(J=re),(V||(ze=>l[ze]&&!this._eventsInProgress[ze])("drag"))&&J&&(this._dragOrigin=E(S.pointCoordinate3D(J)),this._originalZoom=S.zoom,this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",b._stop(!0),J=J||b.transform.centerPoint,H&&(S.bearing+=H),W&&(S.pitch+=W),S._updateCameraState();const ve=[0,0,0];if(O)if(S.projection.name==="mercator"){const ze=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(J).dir),Ne=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(J.sub(O)).dir);ve[0]=Ne[0]-ze[0],ve[1]=Ne[1]-ze[1]}else{const ze=S.pointCoordinate(J);if(S.projection.name==="globe"){O=O.rotate(-S.angle);const Ne=S._pixelsPerMercatorPixel/S.worldSize;ve[0]=-O.x*o.ds(o.aM(ze.y))*Ne,ve[1]=-O.y*o.ds(S.center.lat)*Ne}else{const Ne=S.pointCoordinate(J.sub(O));ze&&Ne&&(ve[0]=Ne.x-ze.x,ve[1]=Ne.y-ze.y)}}const _e=S.zoom,xe=[0,0,0];if(V){const ze=E(ee||S.pointCoordinate3D(J)),Ne={dir:o.a6.vec3.normalize([],o.a6.vec3.sub([],ze,S._camera.position))};if(Ne.dir[2]<0){const Le=S.zoomDeltaToMovement(ze,V);o.a6.vec3.scale(xe,Ne.dir,Le)}}const we=o.a6.vec3.add(ve,ve,xe);S._translateCameraConstrained(we),V&&Math.abs(S.zoom-_e)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(l,p,!0)}_fireEvents(r,l,p){const b=_u(this._eventsInProgress),S=_u(r),E={};for(const W in r){const{originalEvent:J}=r[W];this._eventsInProgress[W]||(E[`${W}start`]=J),this._eventsInProgress[W]=r[W]}!b&&S&&this._fireEvent("movestart",S.originalEvent);for(const W in E)this._fireEvent(W,E[W]);S&&this._fireEvent("move",S.originalEvent);for(const W in r){const{originalEvent:J}=r[W];this._fireEvent(W,J)}const O={};let V;for(const W in this._eventsInProgress){const{handlerName:J,originalEvent:ee}=this._eventsInProgress[W];this._handlersById[J].isActive()||(delete this._eventsInProgress[W],V=l[J]||ee,O[`${W}end`]=V)}for(const W in O)this._fireEvent(W,O[W]);const H=_u(this._eventsInProgress);if(p&&(b||S)&&!H){this._updatingCamera=!0;const W=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),J=ee=>ee!==0&&-this._bearingSnap<ee&&ee<this._bearingSnap;W?(J(W.bearing||this._map.getBearing())&&(W.bearing=0),this._map.easeTo(W,{originalEvent:V})):(this._map.fire(new o.x("moveend",{originalEvent:V})),J(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,l){this._map.fire(new o.x(r,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Bf("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ta="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class lg extends o.E{constructor(r,l){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,o.aJ(["_renderFrameCallback"],this)}getCenter(){return new o.bK(this.transform.center.lng,this.transform.center.lat)}setCenter(r,l){return this.jumpTo({center:r},l)}panBy(r,l,p){return r=o.P.convert(r).mult(-1),this.panTo(this.transform.center,o.l({offset:r},l),p)}panTo(r,l,p){return this.easeTo(o.l({center:r},l),p)}getZoom(){return this.transform.zoom}setZoom(r,l){return this.jumpTo({zoom:r},l),this}zoomTo(r,l,p){return this.easeTo(o.l({zoom:r},l),p)}zoomIn(r,l){return this.zoomTo(this.getZoom()+1,r,l),this}zoomOut(r,l){return this.zoomTo(this.getZoom()-1,r,l),this}getBearing(){return this.transform.bearing}setBearing(r,l){return this.jumpTo({bearing:r},l),this}getPadding(){return this.transform.padding}setPadding(r,l){return this.jumpTo({padding:r},l),this}rotateTo(r,l,p){return this.easeTo(o.l({bearing:r},l),p)}resetNorth(r,l){return this.rotateTo(0,o.l({duration:1e3},r),l),this}resetNorthPitch(r,l){return this.easeTo(o.l({bearing:0,pitch:0,duration:1e3},r),l),this}snapToNorth(r,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,l):this}getPitch(){return this.transform.pitch}setPitch(r,l){return this.jumpTo({pitch:r},l),this}cameraForBounds(r,l){r=o.as.convert(r);const p=l&&l.bearing||0,b=l&&l.pitch||0,S=r.getNorthWest(),E=r.getSouthEast();return this._cameraForBounds(this.transform,S,E,p,b,l)}_extendPadding(r){const l={top:0,right:0,bottom:0,left:0};return r==null?o.l({},l,this.transform.padding):typeof r=="number"?{top:r,bottom:r,right:r,left:r}:o.l({},l,r)}_extendCameraOptions(r){return(r=o.l({offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=this._extendPadding(r.padding),r}_minimumAABBFrustumDistance(r,l){const p=l.max[0]-l.min[0],b=l.max[1]-l.min[1];return p/b>r.aspect?p/(2*Math.tan(.5*r.fovX)*r.aspect):b/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,l,p,b,S,E){const O=r.clone(),V=this._extendCameraOptions(E);O.bearing=b,O.pitch=S;const H=o.bK.convert(l),W=o.bK.convert(p),J=.5*(H.lat+W.lat),ee=.5*(H.lng+W.lng),re=o.dt(J,ee),ve=o.a6.vec3.normalize([],re),_e=o.a6.vec3.normalize([],o.a6.vec3.cross([],ve,[0,1,0])),xe=o.a6.vec3.cross([],_e,ve),we=[_e[0],_e[1],_e[2],0,xe[0],xe[1],xe[2],0,ve[0],ve[1],ve[2],0,0,0,0,1],ze=[re,o.dt(H.lat,H.lng),o.dt(W.lat,H.lng),o.dt(W.lat,W.lng),o.dt(H.lat,W.lng),o.dt(J,H.lng),o.dt(J,W.lng),o.dt(H.lat,ee),o.dt(W.lat,ee)];let Ne=o.c9.fromPoints(ze.map(Qt=>[o.a6.vec3.dot(_e,Qt),o.a6.vec3.dot(xe,Qt),o.a6.vec3.dot(ve,Qt)]));const Le=o.a6.vec3.transformMat4([],Ne.center,we);o.a6.vec3.squaredLength(Le)===0&&o.a6.vec3.set(Le,0,0,1),o.a6.vec3.normalize(Le,Le),o.a6.vec3.scale(Le,Le,o.aq),O.center=o.du(Le);const je=O.getWorldToCameraMatrix(),Ue=o.a6.mat4.invert(new Float64Array(16),je);Ne=o.c9.applyTransform(Ne,o.a6.mat4.multiply([],je,we));const rt=this._extendAABB(Ne,O,V,b);if(!rt)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ne=rt,o.a6.vec3.transformMat4(Le,Le,je);const Qe=.5*(Ne.max[2]-Ne.min[2]),ot=this._minimumAABBFrustumDistance(O,Ne),gt=o.a6.vec3.scale([],[0,0,1],Qe),ht=o.a6.vec3.add(gt,Le,gt),ct=ot+(O.pitch===0?0:o.a6.vec3.distance(Le,ht)),Ct=O.globeCenterInViewSpace,Kt=o.a6.vec3.sub([],Le,[Ct[0],Ct[1],Ct[2]]);o.a6.vec3.normalize(Kt,Kt),o.a6.vec3.scale(Kt,Kt,ct);const cn=o.a6.vec3.add([],Le,Kt);o.a6.vec3.transformMat4(cn,cn,Ue);const qt=o.dw/o.aq,yn=o.a6.vec3.length(cn),Et=o.bD(Math.max(yn*qt-o.dw,Number.EPSILON),0),nn=Math.min(O.zoomFromMercatorZAdjusted(Et),V.maxZoom);return nn>.5*(o.c2+o.bU)?(O.setProjection({name:"mercator"}),O.zoom=nn,this._cameraForBounds(O,l,p,b,S,E)):{center:O.center,zoom:nn,bearing:b,pitch:S}}_extendAABB(r,l,p,b){const S=.5*((p.padding.left||0)+(p.padding.right||0)),E=.5*((p.padding.top||0)+(p.padding.bottom||0)),O=E,V=S,H=S,W=E,J=l.width-(V+H),ee=l.height-(O+W),re=o.a6.vec3.sub([],r.max,r.min),ve=Math.min(J/re[0],ee/re[1]),_e=Math.min(l.scaleZoom(l.scale*ve),p.maxZoom);if(isNaN(_e))return null;const xe=l.scale/l.zoomScale(_e),we=new o.c9([r.min[0]-V*xe,r.min[1]-W*xe,r.min[2]],[r.max[0]+H*xe,r.max[1]+O*xe,r.max[2]]),ze=(typeof p.offset.x=="number"&&typeof p.offset.y=="number"?new o.P(p.offset.x,p.offset.y):o.P.convert(p.offset)).rotate(-o.bB(b));return we.center[0]-=ze.x*xe,we.center[1]+=ze.y*xe,we}queryTerrainElevation(r,l){const p=this.transform.elevation;return p?(l=o.l({},{exaggerated:!0},l),p.getAtPoint(o.a5.fromLngLat(r),null,l.exaggerated)):null}_cameraForBounds(r,l,p,b,S,E){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,l,p,b,S,E);const O=r.clone(),V=this._extendCameraOptions(E);O.bearing=b,O.pitch=S;const H=o.bK.convert(l),W=o.bK.convert(p),J=new o.bK(H.lng,W.lat),ee=new o.bK(W.lng,H.lat),re=O.project(H),ve=O.project(W),_e=this.queryTerrainElevation(H),xe=this.queryTerrainElevation(W),we=this.queryTerrainElevation(J),ze=this.queryTerrainElevation(ee),Ne=[[re.x,re.y,Math.min(_e||0,xe||0,we||0,ze||0)],[ve.x,ve.y,Math.max(_e||0,xe||0,we||0,ze||0)]];let Le=o.c9.fromPoints(Ne);const je=O.getWorldToCameraMatrix(),Ue=o.a6.mat4.invert(new Float64Array(16),je);Le=o.c9.applyTransform(Le,je);const rt=this._extendAABB(Le,O,V,b);if(!rt)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Le=rt;const Qe=.5*o.a6.vec3.sub([],Le.max,Le.min)[2],ot=this._minimumAABBFrustumDistance(O,Le),gt=[0,0,1,0];o.a6.vec4.transformMat4(gt,gt,je),o.a6.vec4.normalize(gt,gt);const ht=o.a6.vec3.scale([],gt,ot+Qe),ct=o.a6.vec3.add([],Le.center,ht);o.a6.vec3.transformMat4(Le.center,Le.center,Ue),o.a6.vec3.transformMat4(ct,ct,Ue);const Ct=O.unproject(new o.P(Le.center[0],Le.center[1])),Kt=o.dv(O.projection,Ct),cn=Math.pow(2,Kt),qt=Math.min(O._zoomFromMercatorZ(ct[2]*O.pixelsPerMeter*cn/O.worldSize),V.maxZoom);return O.mercatorFromTransition&&qt<.5*(o.c2+o.bU)?(O.setProjection({name:"globe"}),O.zoom=qt,this._cameraForBounds(O,l,p,b,S,E)):{center:Ct,zoom:qt,bearing:b,pitch:S}}fitBounds(r,l,p){const b=this.cameraForBounds(r,l);return this._fitInternal(b,l,p)}fitScreenCoordinates(r,l,p,b,S){const E=o.P.convert(r),O=o.P.convert(l),V=new o.P(Math.min(E.x,O.x),Math.min(E.y,O.y)),H=new o.P(Math.max(E.x,O.x),Math.max(E.y,O.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(E,O))return this;const W=this.transform.pointLocation3D(V),J=this.transform.pointLocation3D(H),ee=this.transform.pointLocation3D(new o.P(V.x,H.y)),re=this.transform.pointLocation3D(new o.P(H.x,V.y)),ve=[Math.min(W.lng,J.lng,ee.lng,re.lng),Math.min(W.lat,J.lat,ee.lat,re.lat)],_e=[Math.max(W.lng,J.lng,ee.lng,re.lng),Math.max(W.lat,J.lat,ee.lat,re.lat)],xe=b&&b.pitch?b.pitch:this.getPitch(),we=this._cameraForBounds(this.transform,ve,_e,p,xe,b);return this._fitInternal(we,b,S)}_fitInternal(r,l,p){return r?(l=o.l(r,l)).linear?this.easeTo(l,p):this.flyTo(l,p):this}jumpTo(r,l){this.stop();const p=r.preloadOnly?this.transform.clone():this.transform;let b=!1,S=!1,E=!1;"zoom"in r&&p.zoom!==+r.zoom&&(b=!0,p.zoom=+r.zoom),r.center!==void 0&&(p.center=o.bK.convert(r.center)),"bearing"in r&&p.bearing!==+r.bearing&&(S=!0,p.bearing=+r.bearing),"pitch"in r&&p.pitch!==+r.pitch&&(E=!0,p.pitch=+r.pitch);const O=typeof r.padding=="number"?this._extendPadding(r.padding):r.padding;if(r.padding!=null&&!p.isPaddingEqual(O))if(r.retainPadding===!1){const V=p.clone();V.padding=O,p.setLocationAtPoint(p.center,V.centerPoint)}else p.padding=O;return r.preloadOnly?(this._preloadTiles(p),this):(this.fire(new o.x("movestart",l)).fire(new o.x("move",l)),b&&this.fire(new o.x("zoomstart",l)).fire(new o.x("zoom",l)).fire(new o.x("zoomend",l)),S&&this.fire(new o.x("rotatestart",l)).fire(new o.x("rotate",l)).fire(new o.x("rotateend",l)),E&&this.fire(new o.x("pitchstart",l)).fire(new o.x("pitch",l)).fire(new o.x("pitchend",l)),this.fire(new o.x("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.w(Ta),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,l){const p=this.transform;if(!p.projection.supportsFreeCamera)return o.w(Ta),this;this.stop();const b=p.zoom,S=p.pitch,E=p.bearing;p.setFreeCameraOptions(r);const O=b!==p.zoom,V=S!==p.pitch,H=E!==p.bearing;return this.fire(new o.x("movestart",l)).fire(new o.x("move",l)),O&&this.fire(new o.x("zoomstart",l)).fire(new o.x("zoom",l)).fire(new o.x("zoomend",l)),H&&this.fire(new o.x("rotatestart",l)).fire(new o.x("rotate",l)).fire(new o.x("rotateend",l)),V&&this.fire(new o.x("pitchstart",l)).fire(new o.x("pitch",l)).fire(new o.x("pitchend",l)),this.fire(new o.x("moveend",l)),this}easeTo(r,l){this._stop(!1,r.easeId),((r=o.l({offset:[0,0],duration:500,easing:o.dr},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const p=this.transform,b=this.getZoom(),S=this.getBearing(),E=this.getPitch(),O=this.getPadding(),V="zoom"in r?+r.zoom:b,H="bearing"in r?this._normalizeBearing(r.bearing,S):S,W="pitch"in r?+r.pitch:E,J=this._extendPadding(r.padding),ee=o.P.convert(r.offset);let re,ve,_e;if(p.projection.name==="globe"){const gt=o.a5.fromLngLat(p.center),ht=ee.rotate(-p.angle);gt.x+=ht.x/p.worldSize,gt.y+=ht.y/p.worldSize;const ct=gt.toLngLat(),Ct=o.bK.convert(r.center||ct);this._normalizeCenter(Ct),re=p.centerPoint.add(ht),ve=new o.P(gt.x,gt.y).mult(p.worldSize),_e=new o.P(o.am(Ct.lng),o.at(Ct.lat)).mult(p.worldSize).sub(ve)}else{re=p.centerPoint.add(ee);const gt=p.pointLocation(re),ht=o.bK.convert(r.center||gt);this._normalizeCenter(ht),ve=p.project(gt),_e=p.project(ht).sub(ve)}const xe=p.zoomScale(V-b);let we,ze;r.around&&(we=o.bK.convert(r.around),ze=p.locationPoint(we));const Ne=this._zooming||V!==b,Le=this._rotating||S!==H,je=this._pitching||W!==E,Ue=!p.isPaddingEqual(J),rt=r.retainPadding===!1?p.clone():p,Qe=gt=>ht=>{if(Ne&&(gt.zoom=o.aa(b,V,ht)),Le&&(gt.bearing=o.aa(S,H,ht)),je&&(gt.pitch=o.aa(E,W,ht)),Ue&&(rt.interpolatePadding(O,J,ht),re=rt.centerPoint.add(ee)),we)gt.setLocationAtPoint(we,ze);else{const ct=gt.zoomScale(gt.zoom-b),Ct=V>b?Math.min(2,xe):Math.max(.5,xe),Kt=Math.pow(Ct,1-ht),cn=gt.unproject(ve.add(_e.mult(ht*Kt)).mult(ct));gt.setLocationAtPoint(gt.renderWorldCopies?cn.wrap():cn,re)}return r.preloadOnly||this._fireMoveEvents(l),gt};if(r.preloadOnly){const gt=this._emulate(Qe,r.duration,p);return this._preloadTiles(gt),this}const ot={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ne,this._rotating=Le,this._pitching=je,this._padding=Ue,this._easeId=r.easeId,this._prepareEase(l,r.noMoveStart,ot),this._ease(Qe(p),gt=>{p.cameraElevationReference==="sea"&&p.recenterOnTerrain(),this._afterEase(l,gt)},r),this}_prepareEase(r,l,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||p.moving||this.fire(new o.x("movestart",r)),this._zooming&&!p.zooming&&this.fire(new o.x("zoomstart",r)),this._rotating&&!p.rotating&&this.fire(new o.x("rotatestart",r)),this._pitching&&!p.pitching&&this.fire(new o.x("pitchstart",r))}_fireMoveEvents(r){this.fire(new o.x("move",r)),this._zooming&&this.fire(new o.x("zoom",r)),this._rotating&&this.fire(new o.x("rotate",r)),this._pitching&&this.fire(new o.x("pitch",r))}_afterEase(r,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,b=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new o.x("zoomend",r)),b&&this.fire(new o.x("rotateend",r)),S&&this.fire(new o.x("pitchend",r)),this.fire(new o.x("moveend",r))}flyTo(r,l){if(this._prefersReducedMotion(r)){const Qt=o.ar(r,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Qt,l)}this.stop(),r=o.l({offset:[0,0],speed:1.2,curve:1.42,easing:o.dr},r);const p=this.transform,b=this.getZoom(),S=this.getBearing(),E=this.getPitch(),O=this.getPadding(),V="zoom"in r?o.ap(+r.zoom,p.minZoom,p.maxZoom):b,H="bearing"in r?this._normalizeBearing(r.bearing,S):S,W="pitch"in r?+r.pitch:E,J=this._extendPadding(r.padding),ee=p.zoomScale(V-b),re=o.P.convert(r.offset);let ve=p.centerPoint.add(re);const _e=p.pointLocation(ve),xe=o.bK.convert(r.center||_e);this._normalizeCenter(xe);const we=p.project(_e),ze=p.project(xe).sub(we);let Ne=r.curve;const Le=Math.max(p.width,p.height),je=Le/ee,Ue=ze.mag();if("minZoom"in r){const Qt=o.ap(Math.min(r.minZoom,b,V),p.minZoom,p.maxZoom),bn=Le/p.zoomScale(Qt-b);Ne=Math.sqrt(bn/Ue*2)}const rt=Ne*Ne;function Qe(Qt){const bn=(je*je-Le*Le+(Qt?-1:1)*rt*rt*Ue*Ue)/(2*(Qt?je:Le)*rt*Ue);return Math.log(Math.sqrt(bn*bn+1)-bn)}function ot(Qt){return(Math.exp(Qt)-Math.exp(-Qt))/2}function gt(Qt){return(Math.exp(Qt)+Math.exp(-Qt))/2}const ht=Qe(0);let ct=function(Qt){return gt(ht)/gt(ht+Ne*Qt)},Ct=function(Qt){return Le*((gt(ht)*(ot(bn=ht+Ne*Qt)/gt(bn))-ot(ht))/rt)/Ue;var bn},Kt=(Qe(1)-ht)/Ne;if(Math.abs(Ue)<1e-6||!isFinite(Kt)){if(Math.abs(Le-je)<1e-6)return this.easeTo(r,l);const Qt=je<Le?-1:1;Kt=Math.abs(Math.log(je/Le))/Ne,Ct=function(){return 0},ct=function(bn){return Math.exp(Qt*Ne*bn)}}r.duration="duration"in r?+r.duration:1e3*Kt/("screenSpeed"in r?+r.screenSpeed/Ne:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const cn=S!==H,qt=W!==E,yn=!p.isPaddingEqual(J),Et=r.retainPadding===!1?p.clone():p,nn=Qt=>bn=>{const wn=bn*Kt,an=1/ct(wn);Qt.zoom=bn===1?V:b+Qt.scaleZoom(an),cn&&(Qt.bearing=o.aa(S,H,bn)),qt&&(Qt.pitch=o.aa(E,W,bn)),yn&&(Et.interpolatePadding(O,J,bn),ve=Et.centerPoint.add(re));const pn=bn===1?xe:Qt.unproject(we.add(ze.mult(Ct(wn))).mult(an));return Qt.setLocationAtPoint(Qt.renderWorldCopies?pn.wrap():pn,ve),Qt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(l),Qt};if(r.preloadOnly){const Qt=this._emulate(nn,r.duration,p);return this._preloadTiles(Qt),this}return this._zooming=!0,this._rotating=cn,this._pitching=qt,this._padding=yn,this._prepareEase(l,!1),this._ease(nn(p),()=>this._afterEase(l),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(r){}_cancelRenderFrame(r){}_stop(r,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,l)}if(!r){const p=this.handlers;p&&p.stop(!1)}return this}_ease(r,l,p){p.animate===!1||p.duration===0?(r(1),l()):(this._easeStart=o.q.now(),this._easeOptions=p,this._onEaseFrame=r,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((o.q.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,l){r=o.bA(r,-180,180);const p=Math.abs(r-l);return Math.abs(r-360-l)<p&&(r-=360),Math.abs(r+360-l)<p&&(r+=360),r}_normalizeCenter(r){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const p=r.lng-l.center.lng;r.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&o.q.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,l,p){const b=Math.ceil(15*l/1e3),S=[],E=r(p.clone());for(let O=0;O<=b;O++){const V=E(O/b);S.push(V.clone())}return S}_preloadTiles(r,l){}}class Ff{constructor(r={}){this.options=r,o.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const l=this.options&&this.options.compact,p=r._getUIString("AttributionControl.ToggleAttribution");this._map=r,this._container=G("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=G("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",p);const b=G("span","mapboxgl-ctrl-icon",this._compactButton);return b.setAttribute("aria-hidden","true"),b.setAttribute("title",p),this._innerContainer=G("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.e.ACCESS_TOKEN}];if(r){const p=l.reduce((b,S,E)=>(S.value&&(b+=`${S.key}=${S.value}${E<l.length-1?"&":""}`),b),"?");r.href=`${o.e.FEEDBACK_URL}/${p}#${Ya(this._map,!0)}`,r.rel="noopener nofollow"}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const l=this._map.style._mergedSourceCaches;for(const b in l){const S=l[b];if(S.used){const E=S.getSource();E.attribution&&r.indexOf(E.attribution)<0&&r.push(E.attribution)}}r.sort((b,S)=>b.length-S.length),r=r.filter((b,S)=>{for(let E=S+1;E<r.length;E++)if(r[E].indexOf(b)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const p=r.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,r.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class cg{constructor(){o.aJ(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=G("div","mapboxgl-ctrl");const l=G("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const l in r){const p=r[l].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class hy{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const l=++this._id;return this._queue.push({callback:r,id:l,cancelled:!1}),l}remove(r){const l=this._currentlyRunning,p=l?this._queue.concat(l):this._queue;for(const b of p)if(b.id===r)return void(b.cancelled=!0)}run(r=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const p of l)if(!p.cancelled&&(p.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Hd{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const l=o.cw((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,l,p){this._start=this.getValue(l),this._end=r,this._startTime=l,this._endTime=l+p}}const O1={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class z1{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class ug{constructor(r){this.map=r,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(r,l){if(this.typeById.has(r))throw new Error(`Interaction id "${r}" already exists.`);const{type:p,filter:b}=l;if(b){const E=o.M(b,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(E.result==="error")throw new Error(E.value.map(O=>`${O.key}: ${O.message}`).join(", "));this.filters.set(r,E.value)}const S=this.interactionsByType.get(p)||new Map;S.size===0&&(this.map.on(p,this.handleType),this.interactionsByType.set(p,S)),S.set(r,l),this.typeById.set(r,p)}remove(r){const l=this.typeById.get(r);if(!l)return;this.typeById.delete(r),this.filters.delete(r);const p=this.interactionsByType.get(l);p&&(p.delete(r),p.size===0&&this.map.off(l,this.handleType))}handleType(r){const l=r.features||this.map.queryRenderedFeatures(r.point);if(!l)return;const p=this.interactionsByType.get(r.type),b={zoom:0};for(const[S,E]of p){const O=this.filters.get(S),{handler:V,layers:H}=E;for(const W of l)if((!H||H.includes(W.layer.id))&&(!O||O.evaluate(b,W))&&V({id:S,feature:W,interaction:E})!==!1)break}}}const dg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0},Gd={showCompass:!0,showZoom:!0,visualizePitch:!1};class yu{constructor(r,l,p=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new Df({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,p&&(this.mousePitch=new Lf({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),o.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(r,l){this.mouseRotate.mousedown(r,l),this.mousePitch&&this.mousePitch.mousedown(r,l),X()}move(r,l){const p=this.map,b=this.mouseRotate.mousemoveWindow(r,l),S=b&&b.bearingDelta;if(S&&p.setBearing(p.getBearing()+S),this.mousePitch){const E=this.mousePitch.mousemoveWindow(r,l),O=E&&E.pitchDelta;O&&p.setPitch(p.getPitch()+O)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ie(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(o.l({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),pe(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,pe(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ge(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=ge(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Ca(f,r,l){if(f=new o.bK(f.lng,f.lat),r){const p=new o.bK(f.lng-360,f.lat),b=new o.bK(f.lng+360,f.lat),S=360*Math.ceil(Math.abs(f.lng-l.center.lng)/360),E=l.locationPoint(f).distSqr(r),O=r.x<0||r.y<0||r.x>l.width||r.y>l.height;l.locationPoint(p).distSqr(r)<E&&(O||Math.abs(p.lng-l.center.lng)<S)?f=p:l.locationPoint(b).distSqr(r)<E&&(O||Math.abs(b.lng-l.center.lng)<S)&&(f=b)}for(;Math.abs(f.lng-l.center.lng)>180;){const p=l.locationPoint(f);if(p.x>=0&&p.y>=0&&p.x<=l.width&&p.y<=l.height)break;f.lng>l.center.lng?f.lng-=360:f.lng+=360}return f}const Es={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ea extends o.E{constructor(r,l){if(super(),(r instanceof HTMLElement||l)&&(r=o.l({element:r},l)),o.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=o.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=G("div");const S=41,E=27,O=U("svg",{display:"block",height:S*this._scale+"px",width:E*this._scale+"px",viewBox:`0 0 ${E} ${S}`},this._element),V=U("radialGradient",{id:"shadowGradient"},U("defs",{},O));U("stop",{offset:"10%","stop-opacity":.4},V),U("stop",{offset:"100%","stop-opacity":.05},V),U("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},O),U("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},O),U("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},O),U("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},O),this._offset=o.P.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const p=this._element.classList;for(const S in Es)p.remove(`mapboxgl-marker-anchor-${S}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`);const b=r&&r.className?r.className.trim().split(/\s+/):[];p.add(...b),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=o.bK.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const b=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const l=r.code,p=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(r){const l=r.originalEvent.target,p=this._element;this._popup&&(l===p||p.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,l=this._pos;if(!r||!l)return!1;const p=r.unproject(l),b=r.getFreeCameraOptions();if(!b.position)return!1;const S=b.position.toLngLat();return S.distanceTo(p)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const l=this._pos;if(!l||l.x<0||l.x>r.transform.width||l.y<0||l.y>r.transform.height)return void this._clearFadeTimer();const p=r.unproject(l);let b;r._showingGlobe()&&o.dz(r.transform,this._lngLat)?b=0:(b=1-r._queryFogOpacity(p),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(b*=this._occludedOpacity)),this._element.style.opacity=`${b}`,this._element.style.pointerEvents=b>0?"auto":"none",this._popup&&this._popup._setOpacity(b),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Es[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const r=this._pos,l=this._map,p=this.getPitchAlignment();if(!l||!r||p!=="map")return"";if(!l._showingGlobe()){const V=l.getPitch();return V?`rotateX(${V}deg)`:""}const b=o.c0(o.dA(l.transform,this._lngLat)),S=r.sub(o.dB(l.transform)),E=Math.abs(S.x)+Math.abs(S.y);if(E===0)return"";const O=b/E;return`rotateX(${-S.y*O}deg) rotateY(${S.x*O}deg)`}_calculateZTransform(){const r=this._pos,l=this._map;if(!l||!r)return"";let p=0;const b=this.getRotationAlignment();if(b==="map")if(l._showingGlobe()){const S=l.project(new o.bK(this._lngLat.lng,this._lngLat.lat+.001)),E=l.project(new o.bK(this._lngLat.lng,this._lngLat.lat-.001)).sub(S);p=o.c0(Math.atan2(E.y,E.x))-90}else p=-l.getBearing();else if(b==="horizon"){const S=o.a7(4,6,l.getZoom()),E=o.dB(l.transform);E.y+=S*l.transform.height;const O=r.sub(E),V=o.c0(Math.atan2(O.y,O.x));p=(V>90?V-270:V+90)*(1-S)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=Ca(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=o.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const l=this._map;if(!l)return;const p=this._pointerdownPos,b=this._positionDelta;if(p&&b){if(!this._isDragging){const S=this._clickTolerance||l._clickTolerance;if(r.point.dist(p)<S)return;this._isDragging=!0}this._pos=r.point.sub(b),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.x("dragstart"))),this.fire(new o.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.x("dragend")),this._state="inactive"}_addDragHandler(r){const l=this._map,p=this._pos;l&&p&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(p),this._pointerdownPos=r.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const l=this._map;return l&&(r?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const vc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ol={maxWidth:100,unit:"metric"},B1={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},F1={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},N1=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function fy(f=new o.P(0,0),r="bottom"){if(typeof f=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(r){case"top":return new o.P(0,f);case"top-left":return new o.P(l,l);case"top-right":return new o.P(-l,l);case"bottom":return new o.P(0,-f);case"bottom-left":return new o.P(l,-l);case"bottom-right":return new o.P(-l,-l);case"left":return new o.P(f,0);case"right":return new o.P(-f,0)}return new o.P(0,0)}return f instanceof o.P||Array.isArray(f)?o.P.convert(f):o.P.convert(f[r]||[0,0])}return{version:C,supported:F.supported,setRTLTextPlugin:o.dC,getRTLTextPluginStatus:o.dD,Map:class extends lg{constructor(f){A.mark(k.create);const r=f;if((f=o.l({},dg,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&o.dx(window)&&(f.antialias=!1,o.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Yh(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._repaint=!!f.repaint,this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new hy,this._domRenderTaskQueue=new hy,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.aP(),this._locale=o.l({},O1,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._tessellationStep=f.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=f.precompilePrograms,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Hd(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._requestManager=new Ie(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,this._contextCreateOptions=f.contextCreateOptions?{...f.contextCreateOptions}:{},typeof f.container=="string"){const l=document.getElementById(f.container);if(!l)throw new Error(`Container '${f.container.toString()}' not found.`);this._container=l}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&o.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),o.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new z1),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new ji(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,(f.style||!f.testMode)&&this.setStyle(f.style||o.e.DEFAULT_STYLE,{config:f.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),f.hash&&(this._hash=new Dl(typeof f.hash=="string"&&f.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch});const l=f.bounds;l&&(this.resize(),this.fitBounds(l,o.l({},f.fitBoundsOptions,{duration:0})))}this.resize(),f.attributionControl&&this.addControl(new Ff({customAttribution:f.customAttribution})),this._logoControl=new cg,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new o.x(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new o.x(`${l.dataType}dataloading`,l))}),this._interactions=new ug(this)}_getMapId(){return this._mapId}addControl(f,r){if(r===void 0&&(r=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new o.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=f.onAdd(this);this._controls.push(f);const p=this._controlPositions[r];return r.indexOf("bottom")!==-1?p.insertBefore(l,p.firstChild):p.appendChild(l),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new o.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(f);return r>-1&&this._controls.splice(r,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new o.x("movestart",f)).fire(new o.x("move",f)),this.fire(new o.x("resize",f)),r&&this.fire(new o.x("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(o.as.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new o.x("zoomstart")).fire(new o.x("zoom")).fire(new o.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new o.x("zoomstart")).fire(new o.x("zoom")).fire(new o.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new o.x("pitchstart")).fire(new o.x("pitch")).fire(new o.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new o.x("pitchstart")).fire(new o.x("pitch")).fire(new o.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(r=>r==="auto"?navigator.language:r):f}setLanguage(f){const r=this._parseLanguage(f);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,r=f.projection.name;let l;r==="globe"&&f.zoom>=o.bU?(f.setMercatorFromTransition(),l=!0):r==="mercator"&&f.zoom<o.bU&&(f.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,r){return this._updateProjection(f||r||{name:"mercator"})}_updateProjection(f){let r;return r=f.name==="globe"&&this.transform.zoom>=o.bU?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(f){return this.transform.locationPoint3D(o.bK.convert(f))}unproject(f){return this.transform.pointLocation3D(o.P.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,r,l){if(f==="mouseenter"||f==="mouseover"){let p=!1;const b=E=>{const O=r.filter(H=>this.getLayer(H)),V=O.length?this.queryRenderedFeatures(E.point,{layers:O}):[];V.length?p||(p=!0,l.call(this,new Xi(f,this,E.originalEvent,{features:V}))):p=!1},S=()=>{p=!1};return{layers:new Set(r),listener:l,delegates:{mousemove:b,mouseout:S}}}if(f==="mouseleave"||f==="mouseout"){let p=!1;const b=E=>{const O=r.filter(V=>this.getLayer(V));(O.length?this.queryRenderedFeatures(E.point,{layers:O}):[]).length?p=!0:p&&(p=!1,l.call(this,new Xi(f,this,E.originalEvent)))},S=E=>{p&&(p=!1,l.call(this,new Xi(f,this,E.originalEvent)))};return{layers:new Set(r),listener:l,delegates:{mousemove:b,mouseout:S}}}{const p=b=>{const S=r.filter(O=>this.getLayer(O)),E=S.length?this.queryRenderedFeatures(b.point,{layers:S}):[];E.length&&(b.features=E,l.call(this,b),delete b.features)};return{layers:new Set(r),listener:l,delegates:{[f]:p}}}}on(f,r,l){if(typeof r=="function"||l===void 0)return super.on(f,r);if(Array.isArray(r)||(r=[r]),r){for(const b of r)if(!this._isValidId(b))return this}const p=this._createDelegatedListener(f,r,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(p);for(const b in p.delegates)this.on(b,p.delegates[b]);return this}once(f,r,l){if(typeof r=="function"||l===void 0)return super.once(f,r);if(Array.isArray(r)||(r=[r]),r){for(const b of r)if(!this._isValidId(b))return this}const p=this._createDelegatedListener(f,r,l);for(const b in p.delegates)this.once(b,p.delegates[b]);return this}off(f,r,l){if(typeof r=="function"||l===void 0)return super.off(f,r);const p=new Set(Array.isArray(r)?r:[r]);for(const E of p)if(!this._isValidId(E))return this;const b=(E,O)=>{if(E.size!==O.size)return!1;for(const V of E)if(!O.has(V))return!1;return!0},S=this._delegatedListeners?this._delegatedListeners[f]:void 0;return S&&(E=>{for(let O=0;O<E.length;O++){const V=E[O];if(V.listener===l&&b(V.layers,p)){for(const H in V.delegates)this.off(H,V.delegates[H]);return E.splice(O,1),this}}})(S),this}queryRenderedFeatures(f,r){if(!this.style)return[];if(r!==void 0||f===void 0||f instanceof o.P||Array.isArray(f)||(r=f,f=void 0),f=f||[[0,0],[this.transform.width,this.transform.height]],(r=r||{}).layers&&Array.isArray(r.layers)){for(const l of r.layers)if(!this._isValidId(l))return[]}return this.style.queryRenderedFeatures(f,r,this.transform)}querySourceFeatures(f,r){return this._isValidId(f)?this.style.querySourceFeatures(f,r):[]}isPointOnSurface(f){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&o.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.P.convert(f))}addInteraction(f,r){return this._interactions.add(f,r),this}removeInteraction(f){return this._interactions.remove(f),this}setStyle(f,r){return r=o.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&f&&r.diff!==!1&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(f,(l,p)=>{l?(o.w(`Unable to perform style diff: ${String(l.message||l.error||l)}. Rebuilding the style from scratch.`),this._updateStyle(f,r)):p&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(f,r))}_getUIString(f){const r=this._locale[f];if(r==null)throw new Error(`Missing UI string '${f}'`);return r}_updateStyle(f,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f){const l=o.l({},r);r&&r.config&&(l.initialConfig=r.config,delete l.config),this.style=new Ts(this,l).load(f),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ts(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.w("There is no style added to the map."),!1)}_isValidId(f){return f==null?(this.fire(new o.t(new Error("IDs can't be empty."))),!1):!o.cn(f)||(this.fire(new o.t(new Error(`IDs can't contain special symbols: "${f}".`))),!1)}addSource(f,r){return this._isValidId(f)?(this._lazyInitEmptyStyle(),this.style.addSource(f,r),this._update(!0)):this}isSourceLoaded(f){return!!this._isValidId(f)&&!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(f,r,l){this._lazyInitEmptyStyle(),this.style.addSourceType(f,r,l)}removeSource(f){return this._isValidId(f)?(this.style.removeSource(f),this._updateTerrain(),this._update(!0)):this}getSource(f){return this._isValidId(f)?this.style.getOwnSource(f):null}addImage(f,r,{pixelRatio:l=1,sdf:p=!1,stretchX:b,stretchY:S,content:E}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:O,height:V,data:H}=o.q.getImageData(r);this.style.addImage(f,{data:new o.r({width:O,height:V},H),pixelRatio:l,stretchX:b,stretchY:S,content:E,sdf:p,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new o.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:V}=r,H=r;this.style.addImage(f,{data:new o.r({width:O,height:V},new Uint8Array(H.data)),pixelRatio:l,stretchX:b,stretchY:S,content:E,sdf:p,version:0,userImage:H}),H.onAdd&&H.onAdd(this,f)}}updateImage(f,r){this._lazyInitEmptyStyle();const l=this.style.getImage(f);if(!l)return void this.fire(new o.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?o.q.getImageData(r):r,{width:b,height:S,data:E}=p;if(b===void 0||S===void 0)return void this.fire(new o.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==l.data.width||S!==l.data.height)return void this.fire(new o.t(new Error(`The width and height of the updated image (${b}, ${S})
                must be that same as the previous version of the image
                (${l.data.width}, ${l.data.height})`)));const O=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);l.data.replace(E,O),this.style.updateImage(f,l)}hasImage(f){return f?!!this.style&&!!this.style.getImage(f):(this.fire(new o.t(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,r){o.o(this._requestManager.transformRequest(f,o.R.Image),(l,p)=>{r(l,p instanceof HTMLImageElement?o.q.getImageData(p):p)})}listImages(){return this.style.listImages()}addModel(f,r){this._lazyInitEmptyStyle(),this.style.addModel(f,r)}hasModel(f){return f?this.style.hasModel(f):(this.fire(new o.t(new Error("Missing required model id"))),!1)}removeModel(f){this.style.removeModel(f)}listModels(){return this.style.listModels()}addLayer(f,r){return this._isValidId(f.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(f,r),this._update(!0)):this}getSlot(f){const r=this.getLayer(f);return r&&r.slot||null}setSlot(f,r){return this.style.setSlot(f,r),this.style.mergeLayers(),this._update(!0)}addImport(f,r){return this.style.addImport(f,r),this}updateImport(f,r){return typeof r!="string"&&r.id!==f?(this.removeImport(f),this.addImport(r)):(this.style.updateImport(f,r),this._update(!0))}removeImport(f){return this.style.removeImport(f),this}moveImport(f,r){return this.style.moveImport(f,r),this._update(!0)}moveLayer(f,r){return this._isValidId(f)?(this.style.moveLayer(f,r),this._update(!0)):this}removeLayer(f){return this._isValidId(f)?(this.style.removeLayer(f),this._update(!0)):this}getLayer(f){if(!this._isValidId(f))return null;const r=this.style.getOwnLayer(f);return r?r.type==="custom"?r.implementation:r.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(f,r,l){return this._isValidId(f)?(this.style.setLayerZoomRange(f,r,l),this._update(!0)):this}setFilter(f,r,l={}){return this._isValidId(f)?(this.style.setFilter(f,r,l),this._update(!0)):this}getFilter(f){return this._isValidId(f)?this.style.getFilter(f):null}setPaintProperty(f,r,l,p={}){return this._isValidId(f)?(this.style.setPaintProperty(f,r,l,p),this._update(!0)):this}getPaintProperty(f,r){return this._isValidId(f)?this.style.getPaintProperty(f,r):null}setLayoutProperty(f,r,l,p={}){return this._isValidId(f)?(this.style.setLayoutProperty(f,r,l,p),this._update(!0)):this}getLayoutProperty(f,r){return this._isValidId(f)?this.style.getLayoutProperty(f,r):null}getSchema(f){return this.style.getSchema(f)}setSchema(f,r){return this.style.setSchema(f,r),this._update(!0)}getConfig(f){return this.style.getConfig(f)}setConfig(f,r){return this.style.setConfig(f,r),this._update(!0)}getConfigProperty(f,r){return this.style.getConfigProperty(f,r)}setConfigProperty(f,r,l){return this.style.setConfigProperty(f,r,l),this._update(!0)}setLights(f){if(this._lazyInitEmptyStyle(),f&&f.length===1&&f[0].type==="flat"){const r=f[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(f),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const f=this.style.getLights()||[];return f.length===0&&f.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),f}setLight(f,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:f}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(f){return this._lazyInitEmptyStyle(),this.style.setColorTheme(f),this._update(!0)}setCamera(f){return this.style.setCamera(f),this._triggerCameraUpdate(f)}_triggerCameraUpdate(f){return this._update(this.transform.setOrthographicProjectionAtLowPitch(f["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.bK.convert(f),this.transform):0}setFeatureState(f,r){return this._isValidId(f.source)?(this.style.setFeatureState(f,r),this._update()):this}removeFeatureState(f,r){return this._isValidId(f.source)?(this.style.removeFeatureState(f,r),this._update()):this}getFeatureState(f){return this._isValidId(f.source)?this.style.getFeatureState(f):null}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let l,p,b,S=this._container;for(;S&&(!p||!b);){const E=window.getComputedStyle(S).transform;E&&E!=="none"&&(l=E.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(p=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(b=l[3])),S=S.parentElement}this._containerWidth=p?Math.abs(f/p):f,this._containerHeight=b?Math.abs(r/b):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=G("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=G("div","mapboxgl-canvas-container",f);this._canvas=G("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=G("div","mapboxgl-control-container",f),p=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(b=>{p[b]=G("div",`mapboxgl-ctrl-${b}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,r){const l=o.q.devicePixelRatio||1;this._canvas.width=l*Math.ceil(f),this._canvas.height=l*Math.ceil(r),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${r}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const r=this._markers.indexOf(f);r!==-1&&this._markers.splice(r,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const r=this._popups.indexOf(f);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const f=o.l({},F.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",f);r?(He(r,!0),this.painter=new Xm(r,this._contextCreateOptions,this.transform,this._tp),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.m.testSupport(r)):this.fire(new o.t(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.x("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new o.x("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let r;this.fire(new o.x("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,p=o.q.now(),b=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=b.createQuery(),b.beginQuery(l.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const H=this.transform.zoom,W=this.transform.pitch,J=o.q.now(),ee=new o.a3(H,{now:J,fadeDuration:S,pitch:W,transition:this.style.transition});this.style.update(ee)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(p),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(p);const O=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,this.painter.replacementSource);if(O&&(this._placementDirty=O.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,A.mark(k.load),this.fire(new o.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const H=o.q.now()-p;b.endQuery(l.TIME_ELAPSED_EXT),setTimeout(()=>{const W=b.getQueryParameter(r,b.QUERY_RESULT)/1e6;b.deleteQuery(r),this.fire(new o.x("gpu-timing-frame",{cpuTime:H,gpuTime:W}))},50)}if(this.listens("gpu-timing-layer")){const H=this.painter.collectGpuTimers();setTimeout(()=>{const W=this.painter.queryGpuTimers(H);this.fire(new o.x("gpu-timing-layer",{layerTimes:W}))},50)}if(this.listens("gpu-timing-deferred-render")){const H=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const W=this.painter.queryGpuTimeDeferredRender(H);this.fire(new o.x("gpu-timing-deferred-render",{gpuTime:W}))},50)}const V=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(V||this._repaint)this.triggerRepaint();else{const H=this.idle();if(H&&(E=this._updateAverageElevation(p,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),H&&(this.fire(new o.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const W=this._calculateSpeedIndex();this.fire(new o.x("speedindexcompleted",{speedIndex:W})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||V||(this._fullyLoaded=!0,A.mark(k.fullLoad),this._performanceMetricsCollection&&Ht(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const r of this._markers)f&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!f||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(f,r=!1){const l=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const p=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(p||(r||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const b=this.transform.averageElevation;let S=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=f;const E=Math.abs(b-S);if(E>1){if(this._isInitialLoad||p)return this._averageElevation.jumpTo(S),l(S);this._averageElevation.easeTo(S,f,300)}else if(E>1e-4)return this._averageElevation.jumpTo(S),l(S)}return!!this._averageElevation.isEasing(f)&&l(this._averageElevation.getValue(f))}_authenticate(){Pe(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===Ye||f.status===401)){const r=this.painter.context.gl;He(r,!1),this._logoControl instanceof cg&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Lt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&mt(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const l=this.painter.context.gl,p=l.createFramebuffer();function b(S){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,S,0);const E=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,E),E}return l.bindFramebuffer(l.FRAMEBUFFER,p),this._canvasPixelComparison(b(f),r.canvasCopies.map(b),r.timeStamps)}_canvasPixelComparison(f,r,l){let p=l[1]-l[0];const b=f.length/4;for(let S=0;S<r.length;S++){const E=r[S];let O=0;for(let V=0;V<E.length;V+=4)E[V]===f[V]&&E[V+1]===f[V+1]&&E[V+2]===f[V+2]&&E[V+3]===f[V+3]&&(O+=1);p+=(l[S+2]-l[S+1])*(1-O/b)}return p}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),At.delete(this.painter.context.gl),Tn.remove(),ut.remove(),this._removed=!0,this.fire(new o.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=o.q.frame(r=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(r)}))}_preloadTiles(f){const r=this.style?this.style.getSourceCaches():[];return o.bf(r,(l,p)=>l._preloadTiles(f,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(f){this._showParseStatus!==f&&(this._showParseStatus=f,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(f){this._showLayers2DWireframe!==f&&(this._showLayers2DWireframe=f,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(f){this._showLayers3DWireframe!==f&&(this._showLayers3DWireframe=f,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,this._tp.refreshUI(),f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,this._tp.refreshUI(),f&&this._update())}_setCacheLimits(f,r){o.dy(f,r)}get version(){return C}},NavigationControl:class{constructor(f={}){this.options=o.l({},Gd,f),this._container=G("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(o.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),G("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),G("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:r}):l.resetNorth({},{originalEvent:r}))}),this._compassIcon=G("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const r=f.getZoom(),l=r===f.getMaxZoom(),p=r===f.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new yu(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,r){const l=G("button",f,this._container);return l.type="button",l.addEventListener("click",r),l}_setButtonTitle(f,r){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${r}`);f.setAttribute("aria-label",l),f.firstElementChild&&f.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends o.E{constructor(f={}){super();const r=navigator.geolocation;this.options=o.l({geolocation:r},vc,f),o.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Za(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=G("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const r=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,f(l)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(l=>r(l.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(f){const r=this._map.getMaxBounds(),l=f.coords;return!!r&&(l.longitude<r.getWest()||l.longitude>r.getEast()||l.latitude<r.getSouth()||l.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new o.x("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.x("geolocate",f)),this._finish()}}_updateCamera(f){const r=new o.bK(f.coords.longitude,f.coords.latitude),l=f.coords.accuracy,p=this._map.getBearing(),b=o.l({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(l),b,{geolocateSource:!0})}_updateMarker(f){if(f){const r=new o.bK(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,r=o.bD(1,f._center.lat)*f.worldSize,l=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.x("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=G("button","mapboxgl-ctrl-geolocate",this._container),G("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=G("div","mapboxgl-user-location"),this._dotElement.appendChild(G("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(G("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ea({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=G("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ea({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.x("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ff,ScaleControl:class{constructor(f={}){this.options=o.l({},Ol,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,r=this._map,l=r._containerHeight/2,p=r._containerWidth/2-f/2,b=r.unproject([p,l]),S=r.unproject([p+f,l]),E=b.distanceTo(S);if(this.options.unit==="imperial"){const O=3.2808*E;O>5280?this._setScale(f,O/5280,"mile"):this._setScale(f,O,"foot")}else this.options.unit==="nautical"?this._setScale(f,E/1852,"nautical-mile"):E>=1e3?this._setScale(f,E/1e3,"kilometer"):this._setScale(f,E,"meter")}_setScale(f,r,l){this._map._requestDomTask(()=>{const p=function(S){const E=Math.pow(10,`${Math.floor(S)}`.length-1);let O=S/E;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:function(V){const H=Math.pow(10,Math.ceil(-Math.log(V)/Math.LN10));return Math.round(V*H)/H}(O),E*O}(r),b=p/r;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(p):`${p}&nbsp;${B1[l]}`,this._container.style.width=f*b+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=G("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f={}){this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:o.w("Full screen control 'container' must be a DOM element.")),o.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=G("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=G("button","mapboxgl-ctrl-fullscreen",this._controlContainer);G("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.E{constructor(f){super(),this.options=o.l(Object.create(F1),f),o.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new o.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new o.x("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=o.bK.convert(f),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const r=document.createDocumentFragment(),l=document.createElement("body");let p;for(l.innerHTML=f;p=l.firstChild,p;)r.appendChild(p);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=G("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(f),this.options.closeButton){const l=this._closeButton=G("button","mapboxgl-popup-close-button",r);l.type="button",l.setAttribute("aria-label","Close popup"),l.setAttribute("aria-hidden","true"),l.innerHTML="&#215;",l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let r;return this._classList.delete(f)?r=!1:(this._classList.add(f),r=!0),this._updateClassList(),r}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const r=this._map,l=this._container,p=this._pos;if(!r||!l||!p)return"bottom";const b=l.offsetWidth,S=l.offsetHeight,E=p.x<b/2,O=p.x>r.transform.width-b/2;if(p.y+f<S)return E?"top-left":O?"top-right":"top";if(p.y>r.transform.height-S){if(E)return"bottom-left";if(O)return"bottom-right"}return E?"left":O?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),f.className=r.join(" ")}_update(f){const r=this._map,l=this._content;if(!r||!this._lngLat&&!this._trackPointer||!l)return;let p=this._container;if(p||(p=this._container=G("div","mapboxgl-popup",r.getContainer()),this._tip=G("div","mapboxgl-popup-tip",p),p.appendChild(l)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ca(this._lngLat,this._pos,r.transform)),!this._trackPointer||f){const b=this._pos=this._trackPointer&&f instanceof o.P?f:r.project(this._lngLat),S=fy(this.options.offset),E=this._anchor=this._getAnchor(S.y),O=fy(this.options.offset,E),V=b.add(O).round();r._requestDomTask(()=>{this._container&&E&&(this._container.style.transform=`${Es[E]} translate(${V.x}px,${V.y}px)`)})}if(!this._marker&&r._showingGlobe()){const b=o.dz(r.transform,this._lngLat)?0:1;this._setOpacity(b)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(N1);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:Ea,Style:Ts,LngLat:o.bK,LngLatBounds:o.as,Point:o.P,MercatorCoordinate:o.a5,FreeCameraOptions:El,Evented:o.E,config:o.e,prewarm:o.dE,clearPrewarmedResources:o.dF,get accessToken(){return o.e.ACCESS_TOKEN},set accessToken(f){o.e.ACCESS_TOKEN=f},get baseApiUrl(){return o.e.API_URL},set baseApiUrl(f){o.e.API_URL=f},get workerCount(){return o.dG.workerCount},set workerCount(f){o.dG.workerCount=f},get maxParallelImageRequests(){return o.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){o.e.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){o.dH(f)},get workerUrl(){return o.dI.workerUrl},set workerUrl(f){o.dI.workerUrl=f},get workerClass(){return o.dI.workerClass},set workerClass(f){o.dI.workerClass=f},get workerParams(){return o.dI.workerParams},set workerParams(f){o.dI.workerParams=f},get dracoUrl(){return o.dJ()},set dracoUrl(f){o.dK(f)},get meshoptUrl(){return o.dL()},set meshoptUrl(f){o.dM(f)},setNow:o.q.setNow,restoreNow:o.q.restoreNow}});var x=m;return x})})(FL);var H$=FL.exports;const TA=ec(H$),G$={class:"control-panel"},W$={key:0,class:"progress-overlay"},q$={__name:"App",setup(e){TA.accessToken="pk.eyJ1IjoibHZ1c2xmY29vIiwiYSI6ImNsbzJ0Zjd2ejBiN3AydmxlN25pa3E5c3cifQ.qNGUVfyvKHJZqfKlaH_5XQ";const t=be(null),i=be(!0),a=be("2010s"),d=be(0),m=[{color:"#f56c6c",percentage:20},{color:"#e6a23c",percentage:50},{color:"#67c23a",percentage:100}];vr(()=>{t.value=new TA.Map({container:"mapContainer",style:{version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://khms0.google.com/kh/v=988?x={x}&y={y}&z={z}"],tileSize:256}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles"}]},center:[121.544,31.221],zoom:14,pitch:60,bearing:130}),t.value.on("load",()=>{x()})});const _=async(C,k)=>{const A=await fetch(C),z=A.headers.get("content-length");if(!z)return console.error("无法获取文件大小，进度条可能无法更新"),await A.json();const N=parseInt(z,10);let $=0;const F=A.body.getReader(),G=[];for(;;){const{done:te,value:Z}=await F.read();if(te)break;G.push(Z),$+=Z.length,k($/N)}const U=new Blob(G);return JSON.parse(await U.text())},x=async()=>{t.value.getLayer("3d-buildings")&&t.value.removeLayer("3d-buildings"),t.value.getSource("geojson-source")&&t.value.removeSource("geojson-source");const C=`/pudong_${a.value}.json`,k=await _(C,A=>{d.value=Math.round(A*100)});t.value.addSource("geojson-source",{type:"geojson",data:k}),t.value.addLayer({id:"3d-buildings",source:"geojson-source",type:"fill-extrusion",paint:{"fill-extrusion-color":["interpolate",["linear"],["*",["get","Height"],5],0,"rgb(255, 235, 238)",30,"rgb(255, 193, 193)",60,"rgb(244, 67, 54)",100,"rgb(183, 28, 28)"],"fill-extrusion-height":["*",5,["get","Height"]],"fill-extrusion-opacity":.9}}),d.value=0},o=()=>{i.value=!i.value;const C=i.value?"visible":"none";t.value.setLayoutProperty("3d-buildings","visibility",C)};return(C,k)=>{const A=Er("el-progress");return se(),Ae("div",null,[k[3]||(k[3]=Ve("div",{id:"mapContainer",class:"map-container"},null,-1)),Ve("div",G$,[mr(Ve("select",{"onUpdate:modelValue":k[0]||(k[0]=z=>a.value=z),onChange:x,class:"year-select"},k[1]||(k[1]=[Ve("option",{value:"2010s"},"2010s",-1),Ve("option",{value:"2020s"},"2020s",-1)]),544),[[B$,a.value]]),Ve("button",{class:"toggle-button",onClick:o},fn(i.value?"隐藏围栏":"显示围栏"),1)]),d.value>0&&d.value<=100?(se(),Ae("div",W$,[k[2]||(k[2]=Ve("h1",null,"加载建筑物中...",-1)),qe(A,{type:"dashboard",percentage:d.value,color:m},null,8,["percentage"])])):bt("",!0)])}}},K$='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',Z$=e=>getComputedStyle(e).position==="fixed"?!1:e.offsetParent!==null,CA=e=>Array.from(e.querySelectorAll(K$)).filter(t=>Qw(t)&&Z$(t)),Qw=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.tabIndex<0||e.hasAttribute("disabled")||e.getAttribute("aria-disabled")==="true")return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},I0=function(e,t,...i){let a;t.includes("mouse")||t.includes("click")?a="MouseEvents":t.includes("key")?a="KeyboardEvent":a="HTMLEvents";const d=document.createEvent(a);return d.initEvent(t,...i),e.dispatchEvent(d),e},$L=e=>!e.getAttribute("aria-owns"),VL=(e,t,i)=>{const{parentNode:a}=e;if(!a)return null;const d=a.querySelectorAll(i),m=Array.prototype.indexOf.call(d,e);return d[m+t]||null},k0=e=>{e&&(e.focus(),!$L(e)&&e.click())},ai=(e,t,{checkForDefaultPrevented:i=!0}={})=>d=>{const m=e==null?void 0:e(d);if(i===!1||!m)return t==null?void 0:t(d)},EA=e=>t=>t.pointerType==="mouse"?e(t):void 0;var Y$=Object.defineProperty,X$=Object.defineProperties,J$=Object.getOwnPropertyDescriptors,MA=Object.getOwnPropertySymbols,Q$=Object.prototype.hasOwnProperty,eV=Object.prototype.propertyIsEnumerable,IA=(e,t,i)=>t in e?Y$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,tV=(e,t)=>{for(var i in t||(t={}))Q$.call(t,i)&&IA(e,i,t[i]);if(MA)for(var i of MA(t))eV.call(t,i)&&IA(e,i,t[i]);return e},nV=(e,t)=>X$(e,J$(t));function eS(e,t){var i;const a=Uo();return ns(()=>{a.value=e()},nV(tV({},t),{flush:(i=void 0)!=null?i:"sync"})),Wp(a)}var kA;const Hr=typeof window<"u",rV=e=>typeof e<"u",tS=e=>typeof e=="function",oV=e=>typeof e=="string",kp=()=>{},nS=Hr&&((kA=window==null?void 0:window.navigator)==null?void 0:kA.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function ed(e){return typeof e=="function"?e():y(e)}function UL(e,t){function i(...a){return new Promise((d,m)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(d).catch(m)})}return i}function iV(e,t={}){let i,a,d=kp;const m=x=>{clearTimeout(x),d(),d=kp};return x=>{const o=ed(e),C=ed(t.maxWait);return i&&m(i),o<=0||C!==void 0&&C<=0?(a&&(m(a),a=null),Promise.resolve(x())):new Promise((k,A)=>{d=t.rejectOnCancel?A:k,C&&!a&&(a=setTimeout(()=>{i&&m(i),a=null,k(x())},C)),i=setTimeout(()=>{a&&m(a),a=null,k(x())},o)})}}function sV(e,t=!0,i=!0,a=!1){let d=0,m,_=!0,x=kp,o;const C=()=>{m&&(clearTimeout(m),m=void 0,x(),x=kp)};return A=>{const z=ed(e),N=Date.now()-d,$=()=>o=A();return C(),z<=0?(d=Date.now(),$()):(N>z&&(i||!_)?(d=Date.now(),$()):t&&(o=new Promise((F,G)=>{x=a?G:F,m=setTimeout(()=>{d=Date.now(),_=!0,F($()),C()},Math.max(0,z-N))})),!i&&!m&&(m=setTimeout(()=>_=!0,z)),_=!1,o)}}function aV(e){return e}function lV(e,t){let i,a,d;const m=be(!0),_=()=>{m.value=!0,d()};Wt(e,_,{flush:"sync"});const x=tS(t)?t:t.get,o=tS(t)?void 0:t.set,C=t5((k,A)=>(a=k,d=A,{get(){return m.value&&(i=x(),m.value=!1),a(),i},set(z){o==null||o(z)}}));return Object.isExtensible(C)&&(C.trigger=_),C}function Xv(e){return _D()?(yD(e),!0):!1}function cV(e,t=200,i={}){return UL(iV(t,i),e)}function uV(e,t=200,i={}){const a=be(e.value),d=cV(()=>{a.value=e.value},t,i);return Wt(e,()=>d()),a}function jL(e,t=200,i=!1,a=!0,d=!1){return UL(sV(t,i,a,d),e)}function LT(e,t=!0){Cr()?vr(e):t?e():Vn(e)}function Th(e,t,i={}){const{immediate:a=!0}=i,d=be(!1);let m=null;function _(){m&&(clearTimeout(m),m=null)}function x(){d.value=!1,_()}function o(...C){_(),d.value=!0,m=setTimeout(()=>{d.value=!1,m=null,e(...C)},ed(t))}return a&&(d.value=!0,Hr&&o()),Xv(x),{isPending:Wp(d),start:o,stop:x}}function Ls(e){var t;const i=ed(e);return(t=i==null?void 0:i.$el)!=null?t:i}const ud=Hr?window:void 0,dV=Hr?window.document:void 0;function yo(...e){let t,i,a,d;if(oV(e[0])||Array.isArray(e[0])?([i,a,d]=e,t=ud):[t,i,a,d]=e,!t)return kp;Array.isArray(i)||(i=[i]),Array.isArray(a)||(a=[a]);const m=[],_=()=>{m.forEach(k=>k()),m.length=0},x=(k,A,z,N)=>(k.addEventListener(A,z,N),()=>k.removeEventListener(A,z,N)),o=Wt(()=>[Ls(t),ed(d)],([k,A])=>{_(),k&&m.push(...i.flatMap(z=>a.map(N=>x(k,z,N,A))))},{immediate:!0,flush:"post"}),C=()=>{o(),_()};return Xv(C),C}let AA=!1;function OT(e,t,i={}){const{window:a=ud,ignore:d=[],capture:m=!0,detectIframe:_=!1}=i;if(!a)return;nS&&!AA&&(AA=!0,Array.from(a.document.body.children).forEach(z=>z.addEventListener("click",kp)));let x=!0;const o=z=>d.some(N=>{if(typeof N=="string")return Array.from(a.document.querySelectorAll(N)).some($=>$===z.target||z.composedPath().includes($));{const $=Ls(N);return $&&(z.target===$||z.composedPath().includes($))}}),k=[yo(a,"click",z=>{const N=Ls(e);if(!(!N||N===z.target||z.composedPath().includes(N))){if(z.detail===0&&(x=!o(z)),!x){x=!0;return}t(z)}},{passive:!0,capture:m}),yo(a,"pointerdown",z=>{const N=Ls(e);N&&(x=!z.composedPath().includes(N)&&!o(z))},{passive:!0}),_&&yo(a,"blur",z=>{var N;const $=Ls(e);((N=a.document.activeElement)==null?void 0:N.tagName)==="IFRAME"&&!($!=null&&$.contains(a.document.activeElement))&&t(z)})].filter(Boolean);return()=>k.forEach(z=>z())}function hV(e={}){var t;const{window:i=ud}=e,a=(t=e.document)!=null?t:i==null?void 0:i.document,d=lV(()=>null,()=>a==null?void 0:a.activeElement);return i&&(yo(i,"blur",m=>{m.relatedTarget===null&&d.trigger()},!0),yo(i,"focus",d.trigger,!0)),d}function HL(e,t=!1){const i=be(),a=()=>i.value=!!e();return a(),LT(a,t),i}function fV(e){return JSON.parse(JSON.stringify(e))}const PA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},RA="__vueuse_ssr_handlers__";PA[RA]=PA[RA]||{};function pV(e,t,{window:i=ud,initialValue:a=""}={}){const d=be(a),m=Q(()=>{var _;return Ls(t)||((_=i==null?void 0:i.document)==null?void 0:_.documentElement)});return Wt([m,()=>ed(e)],([_,x])=>{var o;if(_&&i){const C=(o=i.getComputedStyle(_).getPropertyValue(x))==null?void 0:o.trim();d.value=C||a}},{immediate:!0}),Wt(d,_=>{var x;(x=m.value)!=null&&x.style&&m.value.style.setProperty(ed(e),_)}),d}function mV({document:e=dV}={}){if(!e)return be("visible");const t=be(e.visibilityState);return yo(e,"visibilitychange",()=>{t.value=e.visibilityState}),t}var DA=Object.getOwnPropertySymbols,gV=Object.prototype.hasOwnProperty,vV=Object.prototype.propertyIsEnumerable,_V=(e,t)=>{var i={};for(var a in e)gV.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(e!=null&&DA)for(var a of DA(e))t.indexOf(a)<0&&vV.call(e,a)&&(i[a]=e[a]);return i};function qo(e,t,i={}){const a=i,{window:d=ud}=a,m=_V(a,["window"]);let _;const x=HL(()=>d&&"ResizeObserver"in d),o=()=>{_&&(_.disconnect(),_=void 0)},C=Wt(()=>Ls(e),A=>{o(),x.value&&d&&A&&(_=new ResizeObserver(t),_.observe(A,m))},{immediate:!0,flush:"post"}),k=()=>{o(),C()};return Xv(k),{isSupported:x,stop:k}}function LA(e,t={}){const{reset:i=!0,windowResize:a=!0,windowScroll:d=!0,immediate:m=!0}=t,_=be(0),x=be(0),o=be(0),C=be(0),k=be(0),A=be(0),z=be(0),N=be(0);function $(){const F=Ls(e);if(!F){i&&(_.value=0,x.value=0,o.value=0,C.value=0,k.value=0,A.value=0,z.value=0,N.value=0);return}const G=F.getBoundingClientRect();_.value=G.height,x.value=G.bottom,o.value=G.left,C.value=G.right,k.value=G.top,A.value=G.width,z.value=G.x,N.value=G.y}return qo(e,$),Wt(()=>Ls(e),F=>!F&&$()),d&&yo("scroll",$,{capture:!0,passive:!0}),a&&yo("resize",$,{passive:!0}),LT(()=>{m&&$()}),{height:_,bottom:x,left:o,right:C,top:k,width:A,x:z,y:N,update:$}}var OA=Object.getOwnPropertySymbols,yV=Object.prototype.hasOwnProperty,bV=Object.prototype.propertyIsEnumerable,xV=(e,t)=>{var i={};for(var a in e)yV.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(e!=null&&OA)for(var a of OA(e))t.indexOf(a)<0&&bV.call(e,a)&&(i[a]=e[a]);return i};function GL(e,t,i={}){const a=i,{window:d=ud}=a,m=xV(a,["window"]);let _;const x=HL(()=>d&&"MutationObserver"in d),o=()=>{_&&(_.disconnect(),_=void 0)},C=Wt(()=>Ls(e),A=>{o(),x.value&&d&&A&&(_=new MutationObserver(t),_.observe(A,m))},{immediate:!0}),k=()=>{o(),C()};return Xv(k),{isSupported:x,stop:k}}var zA;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(zA||(zA={}));var wV=Object.defineProperty,BA=Object.getOwnPropertySymbols,SV=Object.prototype.hasOwnProperty,TV=Object.prototype.propertyIsEnumerable,FA=(e,t,i)=>t in e?wV(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,CV=(e,t)=>{for(var i in t||(t={}))SV.call(t,i)&&FA(e,i,t[i]);if(BA)for(var i of BA(t))TV.call(t,i)&&FA(e,i,t[i]);return e};const EV={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};CV({linear:aV},EV);function WL(e,t,i,a={}){var d,m,_;const{clone:x=!1,passive:o=!1,eventName:C,deep:k=!1,defaultValue:A}=a,z=Cr(),N=i||(z==null?void 0:z.emit)||((d=z==null?void 0:z.$emit)==null?void 0:d.bind(z))||((_=(m=z==null?void 0:z.proxy)==null?void 0:m.$emit)==null?void 0:_.bind(z==null?void 0:z.proxy));let $=C;t||(t="modelValue"),$=C||$||`update:${t.toString()}`;const F=U=>x?tS(x)?x(U):fV(U):U,G=()=>rV(e[t])?F(e[t]):A;if(o){const U=G(),te=be(U);return Wt(()=>e[t],Z=>te.value=F(Z)),Wt(te,Z=>{(Z!==e[t]||k)&&N($,Z)},{deep:k}),te}else return Q({get(){return G()},set(U){N($,U)}})}function MV({window:e=ud}={}){if(!e)return be(!1);const t=be(e.document.hasFocus());return yo(e,"blur",()=>{t.value=!1}),yo(e,"focus",()=>{t.value=!0}),t}function IV(e={}){const{window:t=ud,initialWidth:i=1/0,initialHeight:a=1/0,listenOrientation:d=!0,includeScrollbar:m=!0}=e,_=be(i),x=be(a),o=()=>{t&&(m?(_.value=t.innerWidth,x.value=t.innerHeight):(_.value=t.document.documentElement.clientWidth,x.value=t.document.documentElement.clientHeight))};return o(),LT(o),yo("resize",o,{passive:!0}),d&&yo("orientationchange",o,{passive:!0}),{width:_,height:x}}const zT=()=>Hr&&/firefox/i.test(window.navigator.userAgent),kV=(e,t)=>{if(!Hr||!e||!t)return!1;const i=e.getBoundingClientRect();let a;return t instanceof Element?a=t.getBoundingClientRect():a={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},i.top<a.bottom&&i.bottom>a.top&&i.right>a.left&&i.left<a.right},NA=e=>{let t=0,i=e;for(;i;)t+=i.offsetTop,i=i.offsetParent;return t},rS=(e,t)=>Math.abs(NA(e)-NA(t)),BT=e=>{let t,i;return e.type==="touchend"?(i=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(i=e.touches[0].clientY,t=e.touches[0].clientX):(i=e.clientY,t=e.clientX),{clientX:t,clientY:i}};function AV(e,t,i,a){const d=i-t;return e/=a/2,e<1?d/2*e*e*e+t:d/2*((e-=2)*e*e+2)+t}var qL=typeof global=="object"&&global&&global.Object===Object&&global,PV=typeof self=="object"&&self&&self.Object===Object&&self,bl=qL||PV||Function("return this")(),Va=bl.Symbol,KL=Object.prototype,RV=KL.hasOwnProperty,DV=KL.toString,Kg=Va?Va.toStringTag:void 0;function LV(e){var t=RV.call(e,Kg),i=e[Kg];try{e[Kg]=void 0;var a=!0}catch{}var d=DV.call(e);return a&&(t?e[Kg]=i:delete e[Kg]),d}var OV=Object.prototype,zV=OV.toString;function BV(e){return zV.call(e)}var FV="[object Null]",NV="[object Undefined]",$A=Va?Va.toStringTag:void 0;function Lh(e){return e==null?e===void 0?NV:FV:$A&&$A in Object(e)?LV(e):BV(e)}function ql(e){return e!=null&&typeof e=="object"}var $V="[object Symbol]";function Ob(e){return typeof e=="symbol"||ql(e)&&Lh(e)==$V}function FT(e,t){for(var i=-1,a=e==null?0:e.length,d=Array(a);++i<a;)d[i]=t(e[i],i,e);return d}var Bs=Array.isArray,VV=1/0,VA=Va?Va.prototype:void 0,UA=VA?VA.toString:void 0;function ZL(e){if(typeof e=="string")return e;if(Bs(e))return FT(e,ZL)+"";if(Ob(e))return UA?UA.call(e):"";var t=e+"";return t=="0"&&1/e==-VV?"-0":t}var UV=/\s/;function jV(e){for(var t=e.length;t--&&UV.test(e.charAt(t)););return t}var HV=/^\s+/;function GV(e){return e&&e.slice(0,jV(e)+1).replace(HV,"")}function Fs(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var jA=NaN,WV=/^[-+]0x[0-9a-f]+$/i,qV=/^0b[01]+$/i,KV=/^0o[0-7]+$/i,ZV=parseInt;function HA(e){if(typeof e=="number")return e;if(Ob(e))return jA;if(Fs(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Fs(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=GV(e);var i=qV.test(e);return i||KV.test(e)?ZV(e.slice(2),i?2:8):WV.test(e)?jA:+e}function NT(e){return e}var YV="[object AsyncFunction]",XV="[object Function]",JV="[object GeneratorFunction]",QV="[object Proxy]";function $T(e){if(!Fs(e))return!1;var t=Lh(e);return t==XV||t==JV||t==YV||t==QV}var dw=bl["__core-js_shared__"],GA=function(){var e=/[^.]+$/.exec(dw&&dw.keys&&dw.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function e3(e){return!!GA&&GA in e}var t3=Function.prototype,n3=t3.toString;function Oh(e){if(e!=null){try{return n3.call(e)}catch{}try{return e+""}catch{}}return""}var r3=/[\\^$.*+?()[\]{}|]/g,o3=/^\[object .+?Constructor\]$/,i3=Function.prototype,s3=Object.prototype,a3=i3.toString,l3=s3.hasOwnProperty,c3=RegExp("^"+a3.call(l3).replace(r3,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function u3(e){if(!Fs(e)||e3(e))return!1;var t=$T(e)?c3:o3;return t.test(Oh(e))}function d3(e,t){return e==null?void 0:e[t]}function zh(e,t){var i=d3(e,t);return u3(i)?i:void 0}var oS=zh(bl,"WeakMap"),WA=Object.create,h3=function(){function e(){}return function(t){if(!Fs(t))return{};if(WA)return WA(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}();function f3(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function p3(){}function YL(e,t){var i=-1,a=e.length;for(t||(t=Array(a));++i<a;)t[i]=e[i];return t}var m3=800,g3=16,v3=Date.now;function _3(e){var t=0,i=0;return function(){var a=v3(),d=g3-(a-i);if(i=a,d>0){if(++t>=m3)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function y3(e){return function(){return e}}var tb=function(){try{var e=zh(Object,"defineProperty");return e({},"",{}),e}catch{}}(),b3=tb?function(e,t){return tb(e,"toString",{configurable:!0,enumerable:!1,value:y3(t),writable:!0})}:NT,XL=_3(b3);function x3(e,t){for(var i=-1,a=e==null?0:e.length;++i<a&&t(e[i],i,e)!==!1;);return e}function JL(e,t,i,a){for(var d=e.length,m=i+(a?1:-1);a?m--:++m<d;)if(t(e[m],m,e))return m;return-1}function w3(e){return e!==e}function S3(e,t,i){for(var a=i-1,d=e.length;++a<d;)if(e[a]===t)return a;return-1}function T3(e,t,i){return t===t?S3(e,t,i):JL(e,w3,i)}function C3(e,t){var i=e==null?0:e.length;return!!i&&T3(e,t,0)>-1}var E3=9007199254740991,M3=/^(?:0|[1-9]\d*)$/;function zb(e,t){var i=typeof e;return t=t??E3,!!t&&(i=="number"||i!="symbol"&&M3.test(e))&&e>-1&&e%1==0&&e<t}function VT(e,t,i){t=="__proto__"&&tb?tb(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function Jv(e,t){return e===t||e!==e&&t!==t}var I3=Object.prototype,k3=I3.hasOwnProperty;function UT(e,t,i){var a=e[t];(!(k3.call(e,t)&&Jv(a,i))||i===void 0&&!(t in e))&&VT(e,t,i)}function Kp(e,t,i,a){var d=!i;i||(i={});for(var m=-1,_=t.length;++m<_;){var x=t[m],o=void 0;o===void 0&&(o=e[x]),d?VT(i,x,o):UT(i,x,o)}return i}var qA=Math.max;function QL(e,t,i){return t=qA(t===void 0?e.length-1:t,0),function(){for(var a=arguments,d=-1,m=qA(a.length-t,0),_=Array(m);++d<m;)_[d]=a[t+d];d=-1;for(var x=Array(t+1);++d<t;)x[d]=a[d];return x[t]=i(_),f3(e,this,x)}}function eO(e,t){return XL(QL(e,t,NT),e+"")}var A3=9007199254740991;function jT(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=A3}function Zp(e){return e!=null&&jT(e.length)&&!$T(e)}function P3(e,t,i){if(!Fs(i))return!1;var a=typeof t;return(a=="number"?Zp(i)&&zb(t,i.length):a=="string"&&t in i)?Jv(i[t],e):!1}function R3(e){return eO(function(t,i){var a=-1,d=i.length,m=d>1?i[d-1]:void 0,_=d>2?i[2]:void 0;for(m=e.length>3&&typeof m=="function"?(d--,m):void 0,_&&P3(i[0],i[1],_)&&(m=d<3?void 0:m,d=1),t=Object(t);++a<d;){var x=i[a];x&&e(t,x,a,m)}return t})}var D3=Object.prototype;function HT(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||D3;return e===i}function L3(e,t){for(var i=-1,a=Array(e);++i<e;)a[i]=t(i);return a}var O3="[object Arguments]";function KA(e){return ql(e)&&Lh(e)==O3}var tO=Object.prototype,z3=tO.hasOwnProperty,B3=tO.propertyIsEnumerable,Cv=KA(function(){return arguments}())?KA:function(e){return ql(e)&&z3.call(e,"callee")&&!B3.call(e,"callee")};function F3(){return!1}var nO=typeof pa=="object"&&pa&&!pa.nodeType&&pa,ZA=nO&&typeof ma=="object"&&ma&&!ma.nodeType&&ma,N3=ZA&&ZA.exports===nO,YA=N3?bl.Buffer:void 0,$3=YA?YA.isBuffer:void 0,Ev=$3||F3,V3="[object Arguments]",U3="[object Array]",j3="[object Boolean]",H3="[object Date]",G3="[object Error]",W3="[object Function]",q3="[object Map]",K3="[object Number]",Z3="[object Object]",Y3="[object RegExp]",X3="[object Set]",J3="[object String]",Q3="[object WeakMap]",e8="[object ArrayBuffer]",t8="[object DataView]",n8="[object Float32Array]",r8="[object Float64Array]",o8="[object Int8Array]",i8="[object Int16Array]",s8="[object Int32Array]",a8="[object Uint8Array]",l8="[object Uint8ClampedArray]",c8="[object Uint16Array]",u8="[object Uint32Array]",hi={};hi[n8]=hi[r8]=hi[o8]=hi[i8]=hi[s8]=hi[a8]=hi[l8]=hi[c8]=hi[u8]=!0;hi[V3]=hi[U3]=hi[e8]=hi[j3]=hi[t8]=hi[H3]=hi[G3]=hi[W3]=hi[q3]=hi[K3]=hi[Z3]=hi[Y3]=hi[X3]=hi[J3]=hi[Q3]=!1;function d8(e){return ql(e)&&jT(e.length)&&!!hi[Lh(e)]}function GT(e){return function(t){return e(t)}}var rO=typeof pa=="object"&&pa&&!pa.nodeType&&pa,uv=rO&&typeof ma=="object"&&ma&&!ma.nodeType&&ma,h8=uv&&uv.exports===rO,hw=h8&&qL.process,Ap=function(){try{var e=uv&&uv.require&&uv.require("util").types;return e||hw&&hw.binding&&hw.binding("util")}catch{}}(),XA=Ap&&Ap.isTypedArray,WT=XA?GT(XA):d8,f8=Object.prototype,p8=f8.hasOwnProperty;function oO(e,t){var i=Bs(e),a=!i&&Cv(e),d=!i&&!a&&Ev(e),m=!i&&!a&&!d&&WT(e),_=i||a||d||m,x=_?L3(e.length,String):[],o=x.length;for(var C in e)(t||p8.call(e,C))&&!(_&&(C=="length"||d&&(C=="offset"||C=="parent")||m&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||zb(C,o)))&&x.push(C);return x}function iO(e,t){return function(i){return e(t(i))}}var m8=iO(Object.keys,Object),g8=Object.prototype,v8=g8.hasOwnProperty;function _8(e){if(!HT(e))return m8(e);var t=[];for(var i in Object(e))v8.call(e,i)&&i!="constructor"&&t.push(i);return t}function Qv(e){return Zp(e)?oO(e):_8(e)}function y8(e){var t=[];if(e!=null)for(var i in Object(e))t.push(i);return t}var b8=Object.prototype,x8=b8.hasOwnProperty;function w8(e){if(!Fs(e))return y8(e);var t=HT(e),i=[];for(var a in e)a=="constructor"&&(t||!x8.call(e,a))||i.push(a);return i}function e_(e){return Zp(e)?oO(e,!0):w8(e)}var S8=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,T8=/^\w*$/;function qT(e,t){if(Bs(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||Ob(e)?!0:T8.test(e)||!S8.test(e)||t!=null&&e in Object(t)}var Mv=zh(Object,"create");function C8(){this.__data__=Mv?Mv(null):{},this.size=0}function E8(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var M8="__lodash_hash_undefined__",I8=Object.prototype,k8=I8.hasOwnProperty;function A8(e){var t=this.__data__;if(Mv){var i=t[e];return i===M8?void 0:i}return k8.call(t,e)?t[e]:void 0}var P8=Object.prototype,R8=P8.hasOwnProperty;function D8(e){var t=this.__data__;return Mv?t[e]!==void 0:R8.call(t,e)}var L8="__lodash_hash_undefined__";function O8(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Mv&&t===void 0?L8:t,this}function Ch(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}Ch.prototype.clear=C8;Ch.prototype.delete=E8;Ch.prototype.get=A8;Ch.prototype.has=D8;Ch.prototype.set=O8;function z8(){this.__data__=[],this.size=0}function Bb(e,t){for(var i=e.length;i--;)if(Jv(e[i][0],t))return i;return-1}var B8=Array.prototype,F8=B8.splice;function N8(e){var t=this.__data__,i=Bb(t,e);if(i<0)return!1;var a=t.length-1;return i==a?t.pop():F8.call(t,i,1),--this.size,!0}function $8(e){var t=this.__data__,i=Bb(t,e);return i<0?void 0:t[i][1]}function V8(e){return Bb(this.__data__,e)>-1}function U8(e,t){var i=this.__data__,a=Bb(i,e);return a<0?(++this.size,i.push([e,t])):i[a][1]=t,this}function Oc(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}Oc.prototype.clear=z8;Oc.prototype.delete=N8;Oc.prototype.get=$8;Oc.prototype.has=V8;Oc.prototype.set=U8;var Iv=zh(bl,"Map");function j8(){this.size=0,this.__data__={hash:new Ch,map:new(Iv||Oc),string:new Ch}}function H8(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Fb(e,t){var i=e.__data__;return H8(t)?i[typeof t=="string"?"string":"hash"]:i.map}function G8(e){var t=Fb(this,e).delete(e);return this.size-=t?1:0,t}function W8(e){return Fb(this,e).get(e)}function q8(e){return Fb(this,e).has(e)}function K8(e,t){var i=Fb(this,e),a=i.size;return i.set(e,t),this.size+=i.size==a?0:1,this}function zc(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}zc.prototype.clear=j8;zc.prototype.delete=G8;zc.prototype.get=W8;zc.prototype.has=q8;zc.prototype.set=K8;var Z8="Expected a function";function Nb(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Z8);var i=function(){var a=arguments,d=t?t.apply(this,a):a[0],m=i.cache;if(m.has(d))return m.get(d);var _=e.apply(this,a);return i.cache=m.set(d,_)||m,_};return i.cache=new(Nb.Cache||zc),i}Nb.Cache=zc;var Y8=500;function X8(e){var t=Nb(e,function(a){return i.size===Y8&&i.clear(),a}),i=t.cache;return t}var J8=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Q8=/\\(\\)?/g,eU=X8(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(J8,function(i,a,d,m){t.push(d?m.replace(Q8,"$1"):a||i)}),t});function tU(e){return e==null?"":ZL(e)}function Yp(e,t){return Bs(e)?e:qT(e,t)?[e]:eU(tU(e))}var nU=1/0;function Xp(e){if(typeof e=="string"||Ob(e))return e;var t=e+"";return t=="0"&&1/e==-nU?"-0":t}function $b(e,t){t=Yp(t,e);for(var i=0,a=t.length;e!=null&&i<a;)e=e[Xp(t[i++])];return i&&i==a?e:void 0}function mi(e,t,i){var a=e==null?void 0:$b(e,t);return a===void 0?i:a}function KT(e,t){for(var i=-1,a=t.length,d=e.length;++i<a;)e[d+i]=t[i];return e}var JA=Va?Va.isConcatSpreadable:void 0;function rU(e){return Bs(e)||Cv(e)||!!(JA&&e&&e[JA])}function t_(e,t,i,a,d){var m=-1,_=e.length;for(i||(i=rU),d||(d=[]);++m<_;){var x=e[m];t>0&&i(x)?t>1?t_(x,t-1,i,a,d):KT(d,x):a||(d[d.length]=x)}return d}function sO(e){var t=e==null?0:e.length;return t?t_(e,1):[]}function aO(e){return XL(QL(e,void 0,sO),e+"")}var ZT=iO(Object.getPrototypeOf,Object),oU="[object Object]",iU=Function.prototype,sU=Object.prototype,lO=iU.toString,aU=sU.hasOwnProperty,lU=lO.call(Object);function cO(e){if(!ql(e)||Lh(e)!=oU)return!1;var t=ZT(e);if(t===null)return!0;var i=aU.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&lO.call(i)==lU}function cU(e,t,i){var a=-1,d=e.length;t<0&&(t=-t>d?0:d+t),i=i>d?d:i,i<0&&(i+=d),d=t>i?0:i-t>>>0,t>>>=0;for(var m=Array(d);++a<d;)m[a]=e[a+t];return m}function ms(){if(!arguments.length)return[];var e=arguments[0];return Bs(e)?e:[e]}function uU(){this.__data__=new Oc,this.size=0}function dU(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function hU(e){return this.__data__.get(e)}function fU(e){return this.__data__.has(e)}var pU=200;function mU(e,t){var i=this.__data__;if(i instanceof Oc){var a=i.__data__;if(!Iv||a.length<pU-1)return a.push([e,t]),this.size=++i.size,this;i=this.__data__=new zc(a)}return i.set(e,t),this.size=i.size,this}function pl(e){var t=this.__data__=new Oc(e);this.size=t.size}pl.prototype.clear=uU;pl.prototype.delete=dU;pl.prototype.get=hU;pl.prototype.has=fU;pl.prototype.set=mU;function gU(e,t){return e&&Kp(t,Qv(t),e)}function vU(e,t){return e&&Kp(t,e_(t),e)}var uO=typeof pa=="object"&&pa&&!pa.nodeType&&pa,QA=uO&&typeof ma=="object"&&ma&&!ma.nodeType&&ma,_U=QA&&QA.exports===uO,eP=_U?bl.Buffer:void 0,tP=eP?eP.allocUnsafe:void 0;function dO(e,t){if(t)return e.slice();var i=e.length,a=tP?tP(i):new e.constructor(i);return e.copy(a),a}function yU(e,t){for(var i=-1,a=e==null?0:e.length,d=0,m=[];++i<a;){var _=e[i];t(_,i,e)&&(m[d++]=_)}return m}function hO(){return[]}var bU=Object.prototype,xU=bU.propertyIsEnumerable,nP=Object.getOwnPropertySymbols,YT=nP?function(e){return e==null?[]:(e=Object(e),yU(nP(e),function(t){return xU.call(e,t)}))}:hO;function wU(e,t){return Kp(e,YT(e),t)}var SU=Object.getOwnPropertySymbols,fO=SU?function(e){for(var t=[];e;)KT(t,YT(e)),e=ZT(e);return t}:hO;function TU(e,t){return Kp(e,fO(e),t)}function pO(e,t,i){var a=t(e);return Bs(e)?a:KT(a,i(e))}function iS(e){return pO(e,Qv,YT)}function mO(e){return pO(e,e_,fO)}var sS=zh(bl,"DataView"),aS=zh(bl,"Promise"),xp=zh(bl,"Set"),rP="[object Map]",CU="[object Object]",oP="[object Promise]",iP="[object Set]",sP="[object WeakMap]",aP="[object DataView]",EU=Oh(sS),MU=Oh(Iv),IU=Oh(aS),kU=Oh(xp),AU=Oh(oS),cl=Lh;(sS&&cl(new sS(new ArrayBuffer(1)))!=aP||Iv&&cl(new Iv)!=rP||aS&&cl(aS.resolve())!=oP||xp&&cl(new xp)!=iP||oS&&cl(new oS)!=sP)&&(cl=function(e){var t=Lh(e),i=t==CU?e.constructor:void 0,a=i?Oh(i):"";if(a)switch(a){case EU:return aP;case MU:return rP;case IU:return oP;case kU:return iP;case AU:return sP}return t});var PU=Object.prototype,RU=PU.hasOwnProperty;function DU(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&RU.call(e,"index")&&(i.index=e.index,i.input=e.input),i}var nb=bl.Uint8Array;function XT(e){var t=new e.constructor(e.byteLength);return new nb(t).set(new nb(e)),t}function LU(e,t){var i=t?XT(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}var OU=/\w*$/;function zU(e){var t=new e.constructor(e.source,OU.exec(e));return t.lastIndex=e.lastIndex,t}var lP=Va?Va.prototype:void 0,cP=lP?lP.valueOf:void 0;function BU(e){return cP?Object(cP.call(e)):{}}function gO(e,t){var i=t?XT(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var FU="[object Boolean]",NU="[object Date]",$U="[object Map]",VU="[object Number]",UU="[object RegExp]",jU="[object Set]",HU="[object String]",GU="[object Symbol]",WU="[object ArrayBuffer]",qU="[object DataView]",KU="[object Float32Array]",ZU="[object Float64Array]",YU="[object Int8Array]",XU="[object Int16Array]",JU="[object Int32Array]",QU="[object Uint8Array]",ej="[object Uint8ClampedArray]",tj="[object Uint16Array]",nj="[object Uint32Array]";function rj(e,t,i){var a=e.constructor;switch(t){case WU:return XT(e);case FU:case NU:return new a(+e);case qU:return LU(e,i);case KU:case ZU:case YU:case XU:case JU:case QU:case ej:case tj:case nj:return gO(e,i);case $U:return new a;case VU:case HU:return new a(e);case UU:return zU(e);case jU:return new a;case GU:return BU(e)}}function vO(e){return typeof e.constructor=="function"&&!HT(e)?h3(ZT(e)):{}}var oj="[object Map]";function ij(e){return ql(e)&&cl(e)==oj}var uP=Ap&&Ap.isMap,sj=uP?GT(uP):ij,aj="[object Set]";function lj(e){return ql(e)&&cl(e)==aj}var dP=Ap&&Ap.isSet,cj=dP?GT(dP):lj,uj=1,dj=2,hj=4,_O="[object Arguments]",fj="[object Array]",pj="[object Boolean]",mj="[object Date]",gj="[object Error]",yO="[object Function]",vj="[object GeneratorFunction]",_j="[object Map]",yj="[object Number]",bO="[object Object]",bj="[object RegExp]",xj="[object Set]",wj="[object String]",Sj="[object Symbol]",Tj="[object WeakMap]",Cj="[object ArrayBuffer]",Ej="[object DataView]",Mj="[object Float32Array]",Ij="[object Float64Array]",kj="[object Int8Array]",Aj="[object Int16Array]",Pj="[object Int32Array]",Rj="[object Uint8Array]",Dj="[object Uint8ClampedArray]",Lj="[object Uint16Array]",Oj="[object Uint32Array]",ii={};ii[_O]=ii[fj]=ii[Cj]=ii[Ej]=ii[pj]=ii[mj]=ii[Mj]=ii[Ij]=ii[kj]=ii[Aj]=ii[Pj]=ii[_j]=ii[yj]=ii[bO]=ii[bj]=ii[xj]=ii[wj]=ii[Sj]=ii[Rj]=ii[Dj]=ii[Lj]=ii[Oj]=!0;ii[gj]=ii[yO]=ii[Tj]=!1;function wp(e,t,i,a,d,m){var _,x=t&uj,o=t&dj,C=t&hj;if(i&&(_=d?i(e,a,d,m):i(e)),_!==void 0)return _;if(!Fs(e))return e;var k=Bs(e);if(k){if(_=DU(e),!x)return YL(e,_)}else{var A=cl(e),z=A==yO||A==vj;if(Ev(e))return dO(e,x);if(A==bO||A==_O||z&&!d){if(_=o||z?{}:vO(e),!x)return o?TU(e,vU(_,e)):wU(e,gU(_,e))}else{if(!ii[A])return d?e:{};_=rj(e,A,x)}}m||(m=new pl);var N=m.get(e);if(N)return N;m.set(e,_),cj(e)?e.forEach(function(G){_.add(wp(G,t,i,G,e,m))}):sj(e)&&e.forEach(function(G,U){_.set(U,wp(G,t,i,U,e,m))});var $=C?o?mO:iS:o?e_:Qv,F=k?void 0:$(e);return x3(F||e,function(G,U){F&&(U=G,G=e[U]),UT(_,U,wp(G,t,i,U,e,m))}),_}var zj=4;function hP(e){return wp(e,zj)}var Bj=1,Fj=4;function rb(e){return wp(e,Bj|Fj)}var Nj="__lodash_hash_undefined__";function $j(e){return this.__data__.set(e,Nj),this}function Vj(e){return this.__data__.has(e)}function kv(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new zc;++t<i;)this.add(e[t])}kv.prototype.add=kv.prototype.push=$j;kv.prototype.has=Vj;function Uj(e,t){for(var i=-1,a=e==null?0:e.length;++i<a;)if(t(e[i],i,e))return!0;return!1}function xO(e,t){return e.has(t)}var jj=1,Hj=2;function wO(e,t,i,a,d,m){var _=i&jj,x=e.length,o=t.length;if(x!=o&&!(_&&o>x))return!1;var C=m.get(e),k=m.get(t);if(C&&k)return C==t&&k==e;var A=-1,z=!0,N=i&Hj?new kv:void 0;for(m.set(e,t),m.set(t,e);++A<x;){var $=e[A],F=t[A];if(a)var G=_?a(F,$,A,t,e,m):a($,F,A,e,t,m);if(G!==void 0){if(G)continue;z=!1;break}if(N){if(!Uj(t,function(U,te){if(!xO(N,te)&&($===U||d($,U,i,a,m)))return N.push(te)})){z=!1;break}}else if(!($===F||d($,F,i,a,m))){z=!1;break}}return m.delete(e),m.delete(t),z}function Gj(e){var t=-1,i=Array(e.size);return e.forEach(function(a,d){i[++t]=[d,a]}),i}function JT(e){var t=-1,i=Array(e.size);return e.forEach(function(a){i[++t]=a}),i}var Wj=1,qj=2,Kj="[object Boolean]",Zj="[object Date]",Yj="[object Error]",Xj="[object Map]",Jj="[object Number]",Qj="[object RegExp]",eH="[object Set]",tH="[object String]",nH="[object Symbol]",rH="[object ArrayBuffer]",oH="[object DataView]",fP=Va?Va.prototype:void 0,fw=fP?fP.valueOf:void 0;function iH(e,t,i,a,d,m,_){switch(i){case oH:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case rH:return!(e.byteLength!=t.byteLength||!m(new nb(e),new nb(t)));case Kj:case Zj:case Jj:return Jv(+e,+t);case Yj:return e.name==t.name&&e.message==t.message;case Qj:case tH:return e==t+"";case Xj:var x=Gj;case eH:var o=a&Wj;if(x||(x=JT),e.size!=t.size&&!o)return!1;var C=_.get(e);if(C)return C==t;a|=qj,_.set(e,t);var k=wO(x(e),x(t),a,d,m,_);return _.delete(e),k;case nH:if(fw)return fw.call(e)==fw.call(t)}return!1}var sH=1,aH=Object.prototype,lH=aH.hasOwnProperty;function cH(e,t,i,a,d,m){var _=i&sH,x=iS(e),o=x.length,C=iS(t),k=C.length;if(o!=k&&!_)return!1;for(var A=o;A--;){var z=x[A];if(!(_?z in t:lH.call(t,z)))return!1}var N=m.get(e),$=m.get(t);if(N&&$)return N==t&&$==e;var F=!0;m.set(e,t),m.set(t,e);for(var G=_;++A<o;){z=x[A];var U=e[z],te=t[z];if(a)var Z=_?a(te,U,z,t,e,m):a(U,te,z,e,t,m);if(!(Z===void 0?U===te||d(U,te,i,a,m):Z)){F=!1;break}G||(G=z=="constructor")}if(F&&!G){var q=e.constructor,X=t.constructor;q!=X&&"constructor"in e&&"constructor"in t&&!(typeof q=="function"&&q instanceof q&&typeof X=="function"&&X instanceof X)&&(F=!1)}return m.delete(e),m.delete(t),F}var uH=1,pP="[object Arguments]",mP="[object Array]",s0="[object Object]",dH=Object.prototype,gP=dH.hasOwnProperty;function hH(e,t,i,a,d,m){var _=Bs(e),x=Bs(t),o=_?mP:cl(e),C=x?mP:cl(t);o=o==pP?s0:o,C=C==pP?s0:C;var k=o==s0,A=C==s0,z=o==C;if(z&&Ev(e)){if(!Ev(t))return!1;_=!0,k=!1}if(z&&!k)return m||(m=new pl),_||WT(e)?wO(e,t,i,a,d,m):iH(e,t,o,i,a,d,m);if(!(i&uH)){var N=k&&gP.call(e,"__wrapped__"),$=A&&gP.call(t,"__wrapped__");if(N||$){var F=N?e.value():e,G=$?t.value():t;return m||(m=new pl),d(F,G,i,a,m)}}return z?(m||(m=new pl),cH(e,t,i,a,d,m)):!1}function Vb(e,t,i,a,d){return e===t?!0:e==null||t==null||!ql(e)&&!ql(t)?e!==e&&t!==t:hH(e,t,i,a,Vb,d)}var fH=1,pH=2;function mH(e,t,i,a){var d=i.length,m=d;if(e==null)return!m;for(e=Object(e);d--;){var _=i[d];if(_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++d<m;){_=i[d];var x=_[0],o=e[x],C=_[1];if(_[2]){if(o===void 0&&!(x in e))return!1}else{var k=new pl,A;if(!(A===void 0?Vb(C,o,fH|pH,a,k):A))return!1}}return!0}function SO(e){return e===e&&!Fs(e)}function gH(e){for(var t=Qv(e),i=t.length;i--;){var a=t[i],d=e[a];t[i]=[a,d,SO(d)]}return t}function TO(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==void 0||e in Object(i))}}function vH(e){var t=gH(e);return t.length==1&&t[0][2]?TO(t[0][0],t[0][1]):function(i){return i===e||mH(i,e,t)}}function _H(e,t){return e!=null&&t in Object(e)}function yH(e,t,i){t=Yp(t,e);for(var a=-1,d=t.length,m=!1;++a<d;){var _=Xp(t[a]);if(!(m=e!=null&&i(e,_)))break;e=e[_]}return m||++a!=d?m:(d=e==null?0:e.length,!!d&&jT(d)&&zb(_,d)&&(Bs(e)||Cv(e)))}function CO(e,t){return e!=null&&yH(e,t,_H)}var bH=1,xH=2;function wH(e,t){return qT(e)&&SO(t)?TO(Xp(e),t):function(i){var a=mi(i,e);return a===void 0&&a===t?CO(i,e):Vb(t,a,bH|xH)}}function SH(e){return function(t){return t==null?void 0:t[e]}}function TH(e){return function(t){return $b(t,e)}}function CH(e){return qT(e)?SH(Xp(e)):TH(e)}function EO(e){return typeof e=="function"?e:e==null?NT:typeof e=="object"?Bs(e)?wH(e[0],e[1]):vH(e):CH(e)}function EH(e){return function(t,i,a){for(var d=-1,m=Object(t),_=a(t),x=_.length;x--;){var o=_[++d];if(i(m[o],o,m)===!1)break}return t}}var MO=EH();function MH(e,t){return e&&MO(e,t,Qv)}function IH(e,t){return function(i,a){if(i==null)return i;if(!Zp(i))return e(i,a);for(var d=i.length,m=-1,_=Object(i);++m<d&&a(_[m],m,_)!==!1;);return i}}var kH=IH(MH),pw=function(){return bl.Date.now()},AH="Expected a function",PH=Math.max,RH=Math.min;function Js(e,t,i){var a,d,m,_,x,o,C=0,k=!1,A=!1,z=!0;if(typeof e!="function")throw new TypeError(AH);t=HA(t)||0,Fs(i)&&(k=!!i.leading,A="maxWait"in i,m=A?PH(HA(i.maxWait)||0,t):m,z="trailing"in i?!!i.trailing:z);function N(ie){var de=a,le=d;return a=d=void 0,C=ie,_=e.apply(le,de),_}function $(ie){return C=ie,x=setTimeout(U,t),k?N(ie):_}function F(ie){var de=ie-o,le=ie-C,pe=t-de;return A?RH(pe,m-le):pe}function G(ie){var de=ie-o,le=ie-C;return o===void 0||de>=t||de<0||A&&le>=m}function U(){var ie=pw();if(G(ie))return te(ie);x=setTimeout(U,F(ie))}function te(ie){return x=void 0,z&&a?N(ie):(a=d=void 0,_)}function Z(){x!==void 0&&clearTimeout(x),C=0,a=o=d=x=void 0}function q(){return x===void 0?_:te(pw())}function X(){var ie=pw(),de=G(ie);if(a=arguments,d=this,o=ie,de){if(x===void 0)return $(o);if(A)return clearTimeout(x),x=setTimeout(U,t),N(o)}return x===void 0&&(x=setTimeout(U,t)),_}return X.cancel=Z,X.flush=q,X}function lS(e,t,i){(i!==void 0&&!Jv(e[t],i)||i===void 0&&!(t in e))&&VT(e,t,i)}function IO(e){return ql(e)&&Zp(e)}function cS(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function DH(e){return Kp(e,e_(e))}function LH(e,t,i,a,d,m,_){var x=cS(e,i),o=cS(t,i),C=_.get(o);if(C){lS(e,i,C);return}var k=m?m(x,o,i+"",e,t,_):void 0,A=k===void 0;if(A){var z=Bs(o),N=!z&&Ev(o),$=!z&&!N&&WT(o);k=o,z||N||$?Bs(x)?k=x:IO(x)?k=YL(x):N?(A=!1,k=dO(o,!0)):$?(A=!1,k=gO(o,!0)):k=[]:cO(o)||Cv(o)?(k=x,Cv(x)?k=DH(x):(!Fs(x)||$T(x))&&(k=vO(o))):A=!1}A&&(_.set(o,k),d(k,o,a,m,_),_.delete(o)),lS(e,i,k)}function kO(e,t,i,a,d){e!==t&&MO(t,function(m,_){if(d||(d=new pl),Fs(m))LH(e,t,_,i,kO,a,d);else{var x=a?a(cS(e,_),m,_+"",e,t,d):void 0;x===void 0&&(x=m),lS(e,_,x)}},e_)}function OH(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function AO(e,t,i){var a=e==null?0:e.length;if(!a)return-1;var d=a-1;return JL(e,EO(t),d,!0)}function zH(e,t){var i=-1,a=Zp(e)?Array(e.length):[];return kH(e,function(d,m,_){a[++i]=t(d,m,_)}),a}function BH(e,t){var i=Bs(e)?FT:zH;return i(e,EO(t))}function FH(e,t){return t_(BH(e,t),1)}var NH=1/0;function $H(e){var t=e==null?0:e.length;return t?t_(e,NH):[]}function Av(e){for(var t=-1,i=e==null?0:e.length,a={};++t<i;){var d=e[t];a[d[0]]=d[1]}return a}function VH(e,t){return t.length<2?e:$b(e,cU(t,0,-1))}function Gi(e,t){return Vb(e,t)}function ki(e){return e==null}function PO(e){return e===void 0}var RO=R3(function(e,t,i){kO(e,t,i)});function UH(e,t){return t=Yp(t,e),e=VH(e,t),e==null||delete e[Xp(OH(t))]}function jH(e){return cO(e)?void 0:e}var HH=1,GH=2,WH=4,qH=aO(function(e,t){var i={};if(e==null)return i;var a=!1;t=FT(t,function(m){return m=Yp(m,e),a||(a=m.length>1),m}),Kp(e,mO(e),i),a&&(i=wp(i,HH|GH|WH,jH));for(var d=t.length;d--;)UH(i,t[d]);return i});function DO(e,t,i,a){if(!Fs(e))return e;t=Yp(t,e);for(var d=-1,m=t.length,_=m-1,x=e;x!=null&&++d<m;){var o=Xp(t[d]),C=i;if(o==="__proto__"||o==="constructor"||o==="prototype")return e;if(d!=_){var k=x[o];C=void 0,C===void 0&&(C=Fs(k)?k:zb(t[d+1])?[]:{})}UT(x,o,C),x=x[o]}return e}function KH(e,t,i){for(var a=-1,d=t.length,m={};++a<d;){var _=t[a],x=$b(e,_);i(x,_)&&DO(m,Yp(_,e),x)}return m}function ZH(e,t){return KH(e,t,function(i,a){return CO(e,a)})}var dl=aO(function(e,t){return e==null?{}:ZH(e,t)});function YH(e,t,i){return e==null?e:DO(e,t,i)}var XH="Expected a function";function vh(e,t,i){var a=!0,d=!0;if(typeof e!="function")throw new TypeError(XH);return Fs(i)&&(a="leading"in i?!!i.leading:a,d="trailing"in i?!!i.trailing:d),Js(e,t,{leading:a,maxWait:t,trailing:d})}var JH=1/0,QH=xp&&1/JT(new xp([,-0]))[1]==JH?function(e){return new xp(e)}:p3,eG=200;function tG(e,t,i){var a=-1,d=C3,m=e.length,_=!0,x=[],o=x;if(m>=eG){var C=QH(e);if(C)return JT(C);_=!1,d=xO,o=new kv}else o=x;e:for(;++a<m;){var k=e[a],A=k;if(k=k!==0?k:0,_&&A===A){for(var z=o.length;z--;)if(o[z]===A)continue e;x.push(k)}else d(o,A,i)||(o!==x&&o.push(A),x.push(k))}return x}var mw=eO(function(e){return tG(t_(e,1,IO,!0))});const Bo=e=>e===void 0,ko=e=>typeof e=="boolean",Wn=e=>typeof e=="number",da=e=>!e&&e!==0||on(e)&&e.length===0||Tr(e)&&!Object.keys(e).length,ga=e=>typeof Element>"u"?!1:e instanceof Element,Eh=e=>ki(e),nG=e=>zn(e)?!Number.isNaN(Number(e)):!1,Ub=e=>e===window,td=e=>Hr?window.requestAnimationFrame(e):setTimeout(e,16),Mh=e=>Hr?window.cancelAnimationFrame(e):clearTimeout(e),QT=(e="")=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),jl=e=>Kv(e),Pp=e=>Object.keys(e),rG=e=>Object.entries(e),A0=(e,t,i)=>({get value(){return mi(e,t,i)},set value(a){YH(e,t,a)}});class oG extends Error{constructor(t){super(t),this.name="ElementPlusError"}}function Ci(e,t){throw new oG(`[${e}] ${t}`)}const LO=(e="")=>e.split(" ").filter(t=>!!t.trim()),Ks=(e,t)=>{if(!e||!t)return!1;if(t.includes(" "))throw new Error("className should not contain space.");return e.classList.contains(t)},Oa=(e,t)=>{!e||!t.trim()||e.classList.add(...LO(t))},_s=(e,t)=>{!e||!t.trim()||e.classList.remove(...LO(t))},Uu=(e,t)=>{var i;if(!Hr||!e||!t)return"";let a=Xs(t);a==="float"&&(a="cssFloat");try{const d=e.style[a];if(d)return d;const m=(i=document.defaultView)==null?void 0:i.getComputedStyle(e,"");return m?m[a]:""}catch{return e.style[a]}};function li(e,t="px"){if(!e)return"";if(Wn(e)||nG(e))return`${e}${t}`;if(zn(e))return e}const iG=(e,t)=>{if(!Hr)return!1;const i={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(t)],a=Uu(e,i);return["scroll","auto","overlay"].some(d=>a.includes(d))},eC=(e,t)=>{if(!Hr)return;let i=e;for(;i;){if([window,document,document.documentElement].includes(i))return window;if(iG(i,t))return i;i=i.parentNode}return i};let a0;const OO=e=>{var t;if(!Hr)return 0;if(a0!==void 0)return a0;const i=document.createElement("div");i.className=`${e}-scrollbar__wrap`,i.style.visibility="hidden",i.style.width="100px",i.style.position="absolute",i.style.top="-9999px",document.body.appendChild(i);const a=i.offsetWidth;i.style.overflow="scroll";const d=document.createElement("div");d.style.width="100%",i.appendChild(d);const m=d.offsetWidth;return(t=i.parentNode)==null||t.removeChild(i),a0=a-m,a0};function tC(e,t){if(!Hr)return;if(!t){e.scrollTop=0;return}const i=[];let a=t.offsetParent;for(;a!==null&&e!==a&&e.contains(a);)i.push(a),a=a.offsetParent;const d=t.offsetTop+i.reduce((o,C)=>o+C.offsetTop,0),m=d+t.offsetHeight,_=e.scrollTop,x=_+e.clientHeight;d<_?e.scrollTop=d:m>x&&(e.scrollTop=m-e.clientHeight)}function sG(e,t,i,a,d){const m=Date.now();let _;const x=()=>{const C=Date.now()-m,k=AV(C>a?a:C,t,i,a);Ub(e)?e.scrollTo(window.pageXOffset,k):e.scrollTop=k,C<a?_=td(x):Fn(d)&&d()};return x(),()=>{_&&Mh(_)}}const vP=(e,t)=>Ub(t)?e.ownerDocument.documentElement:t,_P=e=>Ub(e)?window.scrollY:e.scrollTop,l0=e=>{if(!Hr||e==="")return null;if(zn(e))try{return document.querySelector(e)}catch{return null}return e};/*! Element Plus Icons Vue v2.3.1 */var aG=Ge({name:"ArrowDown",__name:"arrow-down",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),Bc=aG,lG=Ge({name:"ArrowLeft",__name:"arrow-left",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),nd=lG,cG=Ge({name:"ArrowRight",__name:"arrow-right",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),Os=cG,uG=Ge({name:"ArrowUp",__name:"arrow-up",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),nC=uG,dG=Ge({name:"Back",__name:"back",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64"}),Ve("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312z"})]))}}),hG=dG,fG=Ge({name:"Calendar",__name:"calendar",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64"})]))}}),pG=fG,mG=Ge({name:"CaretRight",__name:"caret-right",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"})]))}}),zO=mG,gG=Ge({name:"CaretTop",__name:"caret-top",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"})]))}}),vG=gG,_G=Ge({name:"Check",__name:"check",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),n_=_G,yG=Ge({name:"CircleCheckFilled",__name:"circle-check-filled",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),bG=yG,xG=Ge({name:"CircleCheck",__name:"circle-check",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Ve("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),rC=xG,wG=Ge({name:"CircleCloseFilled",__name:"circle-close-filled",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),oC=wG,SG=Ge({name:"CircleClose",__name:"circle-close",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),Ve("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),dd=SG,TG=Ge({name:"Clock",__name:"clock",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Ve("path",{fill:"currentColor",d:"M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32"}),Ve("path",{fill:"currentColor",d:"M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32"})]))}}),BO=TG,CG=Ge({name:"Close",__name:"close",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),vl=CG,EG=Ge({name:"DArrowLeft",__name:"d-arrow-left",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})]))}}),rd=EG,MG=Ge({name:"DArrowRight",__name:"d-arrow-right",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})]))}}),od=MG,IG=Ge({name:"Delete",__name:"delete",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),kG=IG,AG=Ge({name:"Document",__name:"document",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),PG=AG,RG=Ge({name:"FullScreen",__name:"full-screen",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),DG=RG,LG=Ge({name:"Hide",__name:"hide",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),Ve("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),OG=LG,zG=Ge({name:"InfoFilled",__name:"info-filled",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),iC=zG,BG=Ge({name:"Loading",__name:"loading",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),Kl=BG,FG=Ge({name:"Minus",__name:"minus",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),NG=FG,$G=Ge({name:"MoreFilled",__name:"more-filled",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224"})]))}}),yP=$G,VG=Ge({name:"More",__name:"more",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96"})]))}}),UG=VG,jG=Ge({name:"PictureFilled",__name:"picture-filled",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M96 896a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h832a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zm315.52-228.48-68.928-68.928a32 32 0 0 0-45.248 0L128 768.064h778.688l-242.112-290.56a32 32 0 0 0-49.216 0L458.752 665.408a32 32 0 0 1-47.232 2.112M256 384a96 96 0 1 0 192.064-.064A96 96 0 0 0 256 384"})]))}}),HG=jG,GG=Ge({name:"Plus",__name:"plus",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),FO=GG,WG=Ge({name:"QuestionFilled",__name:"question-filled",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"})]))}}),qG=WG,KG=Ge({name:"RefreshLeft",__name:"refresh-left",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"})]))}}),ZG=KG,YG=Ge({name:"RefreshRight",__name:"refresh-right",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"})]))}}),XG=YG,JG=Ge({name:"ScaleToOriginal",__name:"scale-to-original",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118M512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412M512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512"})]))}}),QG=JG,eW=Ge({name:"Search",__name:"search",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704"})]))}}),tW=eW,nW=Ge({name:"SortDown",__name:"sort-down",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M576 96v709.568L333.312 562.816A32 32 0 1 0 288 608l297.408 297.344A32 32 0 0 0 640 882.688V96a32 32 0 0 0-64 0"})]))}}),rW=nW,oW=Ge({name:"SortUp",__name:"sort-up",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M384 141.248V928a32 32 0 1 0 64 0V218.56l242.688 242.688A32 32 0 1 0 736 416L438.592 118.656A32 32 0 0 0 384 141.248"})]))}}),iW=oW,sW=Ge({name:"StarFilled",__name:"star-filled",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M283.84 867.84 512 747.776l228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72z"})]))}}),c0=sW,aW=Ge({name:"Star",__name:"star",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m512 747.84 228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72zM313.6 924.48a70.4 70.4 0 0 1-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 0 1 128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 0 1 126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0 1 39.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 0 1-102.144 74.24L512 820.096l-198.4 104.32z"})]))}}),lW=aW,cW=Ge({name:"SuccessFilled",__name:"success-filled",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),NO=cW,uW=Ge({name:"View",__name:"view",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),dW=uW,hW=Ge({name:"WarningFilled",__name:"warning-filled",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),jb=hW,fW=Ge({name:"ZoomIn",__name:"zoom-in",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),$O=fW,pW=Ge({name:"ZoomOut",__name:"zoom-out",setup(e){return(t,i)=>(se(),Ae("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704M352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64"})]))}}),mW=pW;const VO="__epPropKey",at=e=>e,gW=e=>Tr(e)&&!!e[VO],xl=(e,t)=>{if(!Tr(e)||gW(e))return e;const{values:i,required:a,default:d,type:m,validator:_}=e,o={type:m,required:!!a,validator:i||_?C=>{let k=!1,A=[];if(i&&(A=Array.from(i),Qr(e,"default")&&A.push(d),k||(k=A.includes(C))),_&&(k||(k=_(C))),!k&&A.length>0){const z=[...new Set(A)].map(N=>JSON.stringify(N)).join(", ");c$(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${z}], got value ${JSON.stringify(C)}.`)}return k}:void 0,[VO]:!0};return Qr(e,"default")&&(o.default=d),o},ln=e=>Av(Object.entries(e).map(([t,i])=>[t,xl(i,t)])),wo=at([String,Object,Function]),sC={Close:vl},aC={Close:vl,SuccessFilled:NO,InfoFilled:iC,WarningFilled:jb,CircleCloseFilled:oC},id={success:NO,warning:jb,error:oC,info:iC},lC={validating:Kl,success:rC,error:dd},cr=(e,t)=>{if(e.install=i=>{for(const a of[e,...Object.values(t??{})])i.component(a.name,a)},t)for(const[i,a]of Object.entries(t))e[i]=a;return e},UO=(e,t)=>(e.install=i=>{e._context=i._context,i.config.globalProperties[t]=e},e),vW=(e,t)=>(e.install=i=>{i.directive(t,e)},e),Jo=e=>(e.install=_o,e),Hb=(...e)=>t=>{e.forEach(i=>{Fn(i)?i(t):i.value=t})},En={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},_W=["year","years","month","months","date","dates","week","datetime","datetimerange","daterange","monthrange","yearrange"],gw=["sun","mon","tue","wed","thu","fri","sat"],xr="update:modelValue",No="change",zs="input",bP=Symbol("INSTALLED_KEY"),tc=["","default","small","large"],jO=e=>["",...tc].includes(e);var Da=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(Da||{});function uS(e){return Ho(e)&&e.type===Bn}function yW(e){return Ho(e)&&e.type===Oi}function bW(e){return Ho(e)&&!uS(e)&&!yW(e)}const xW=e=>{if(!Ho(e))return{};const t=e.props||{},i=(Ho(e.type)?e.type.props:void 0)||{},a={};return Object.keys(i).forEach(d=>{Qr(i[d],"default")&&(a[d]=i[d].default)}),Object.keys(t).forEach(d=>{a[Xs(d)]=t[d]}),a},wW=e=>{if(!on(e)||e.length>1)throw new Error("expect to receive a single Vue element child");return e[0]},qu=e=>{const t=on(e)?e:[e],i=[];return t.forEach(a=>{var d;on(a)?i.push(...qu(a)):Ho(a)&&((d=a.component)!=null&&d.subTree)?i.push(a,...qu(a.component.subTree)):Ho(a)&&on(a.children)?i.push(...qu(a.children)):i.push(a)}),i},xP=e=>[...new Set(e)],Ds=e=>!e&&e!==0?[]:on(e)?e:[e],SW=e=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(e),Xo=e=>e;function TW(e){let t=0;const i=(...a)=>{t&&Mh(t),t=td(()=>{e(...a),t=0})};return i.cancel=()=>{Mh(t),t=0},i}const CW=["class","style"],EW=/^on[A-Z]/,Gb=(e={})=>{const{excludeListeners:t=!1,excludeKeys:i}=e,a=Q(()=>((i==null?void 0:i.value)||[]).concat(CW)),d=Cr();return Q(d?()=>{var m;return Av(Object.entries((m=d.proxy)==null?void 0:m.$attrs).filter(([_])=>!a.value.includes(_)&&!(t&&EW.test(_))))}:()=>({}))},Ku=({from:e,replacement:t,scope:i,version:a,ref:d,type:m="API"},_)=>{Wt(()=>y(_),x=>{},{immediate:!0})},HO=(e,t,i,a)=>{let d={offsetX:0,offsetY:0};const m=C=>{const k=C.clientX,A=C.clientY,{offsetX:z,offsetY:N}=d,$=e.value.getBoundingClientRect(),F=$.left,G=$.top,U=$.width,te=$.height,Z=document.documentElement.clientWidth,q=document.documentElement.clientHeight,X=-F+z,ie=-G+N,de=Z-F-U+z,le=q-G-te+N,pe=he=>{let ue=z+he.clientX-k,Re=N+he.clientY-A;a!=null&&a.value||(ue=Math.min(Math.max(ue,X),de),Re=Math.min(Math.max(Re,ie),le)),d={offsetX:ue,offsetY:Re},e.value&&(e.value.style.transform=`translate(${li(ue)}, ${li(Re)})`)},ge=()=>{document.removeEventListener("mousemove",pe),document.removeEventListener("mouseup",ge)};document.addEventListener("mousemove",pe),document.addEventListener("mouseup",ge)},_=()=>{t.value&&e.value&&t.value.addEventListener("mousedown",m)},x=()=>{t.value&&e.value&&t.value.removeEventListener("mousedown",m)},o=()=>{d={offsetX:0,offsetY:0},e.value&&(e.value.style.transform="none")};return vr(()=>{ns(()=>{i.value?_():x()})}),Io(()=>{x()}),{resetPosition:o}};var MW={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color.",alphaLabel:"pick alpha value"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},mention:{loading:"Loading"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const IW=e=>(t,i)=>kW(t,i,y(e)),kW=(e,t,i)=>mi(i,e,e).replace(/\{(\w+)\}/g,(a,d)=>{var m;return`${(m=t==null?void 0:t[d])!=null?m:`{${d}}`}`}),AW=e=>{const t=Q(()=>y(e).name),i=Fo(e)?e:be(e);return{lang:t,locale:i,t:IW(e)}},GO=Symbol("localeContextKey"),Gr=e=>{const t=e||kn(GO,be());return AW(Q(()=>t.value||MW))},dv="el",PW="is-",oh=(e,t,i,a,d)=>{let m=`${e}-${t}`;return i&&(m+=`-${i}`),a&&(m+=`__${a}`),d&&(m+=`--${d}`),m},WO=Symbol("namespaceContextKey"),cC=e=>{const t=e||(Cr()?kn(WO,be(dv)):be(dv));return Q(()=>y(t)||dv)},Jt=(e,t)=>{const i=cC(t);return{namespace:i,b:(F="")=>oh(i.value,e,F,"",""),e:F=>F?oh(i.value,e,"",F,""):"",m:F=>F?oh(i.value,e,"","",F):"",be:(F,G)=>F&&G?oh(i.value,e,F,G,""):"",em:(F,G)=>F&&G?oh(i.value,e,"",F,G):"",bm:(F,G)=>F&&G?oh(i.value,e,F,"",G):"",bem:(F,G,U)=>F&&G&&U?oh(i.value,e,F,G,U):"",is:(F,...G)=>{const U=G.length>=1?G[0]:!0;return F&&U?`${PW}${F}`:""},cssVar:F=>{const G={};for(const U in F)F[U]&&(G[`--${i.value}-${U}`]=F[U]);return G},cssVarName:F=>`--${i.value}-${F}`,cssVarBlock:F=>{const G={};for(const U in F)F[U]&&(G[`--${i.value}-${e}-${U}`]=F[U]);return G},cssVarBlockName:F=>`--${i.value}-${e}-${F}`}},uC=(e,t={})=>{Fo(e)||Ci("[useLockscreen]","You need to pass a ref param to this function");const i=t.ns||Jt("popup"),a=Q(()=>i.bm("parent","hidden"));if(!Hr||Ks(document.body,a.value))return;let d=0,m=!1,_="0";const x=()=>{setTimeout(()=>{typeof document>"u"||(_s(document==null?void 0:document.body,a.value),m&&document&&(document.body.style.width=_))},200)};Wt(e,o=>{if(!o){x();return}m=!Ks(document.body,a.value),m&&(_=document.body.style.width),d=OO(i.namespace.value);const C=document.documentElement.clientHeight<document.body.scrollHeight,k=Uu(document.body,"overflowY");d>0&&(C||k==="scroll")&&m&&(document.body.style.width=`calc(100% - ${d}px)`),Oa(document.body,a.value)}),yD(()=>x())},RW=xl({type:at(Boolean),default:null}),DW=xl({type:at(Function)}),LW=e=>{const t=`update:${e}`,i=`onUpdate:${e}`,a=[t],d={[e]:RW,[i]:DW};return{useModelToggle:({indicator:_,toggleReason:x,shouldHideWhenRouteChanges:o,shouldProceed:C,onShow:k,onHide:A})=>{const z=Cr(),{emit:N}=z,$=z.props,F=Q(()=>Fn($[i])),G=Q(()=>$[e]===null),U=de=>{_.value!==!0&&(_.value=!0,x&&(x.value=de),Fn(k)&&k(de))},te=de=>{_.value!==!1&&(_.value=!1,x&&(x.value=de),Fn(A)&&A(de))},Z=de=>{if($.disabled===!0||Fn(C)&&!C())return;const le=F.value&&Hr;le&&N(t,!0),(G.value||!le)&&U(de)},q=de=>{if($.disabled===!0||!Hr)return;const le=F.value&&Hr;le&&N(t,!1),(G.value||!le)&&te(de)},X=de=>{ko(de)&&($.disabled&&de?F.value&&N(t,!1):_.value!==de&&(de?U():te()))},ie=()=>{_.value?q():Z()};return Wt(()=>$[e],X),o&&z.appContext.config.globalProperties.$route!==void 0&&Wt(()=>({...z.proxy.$route}),()=>{o.value&&_.value&&q()}),vr(()=>{X($[e])}),{hide:q,show:Z,toggle:ie,hasUpdateHandler:F}},useModelToggleProps:d,useModelToggleEmits:a}},qO=e=>{const t=Cr();return Q(()=>{var i,a;return(a=(i=t==null?void 0:t.proxy)==null?void 0:i.$props)==null?void 0:a[e]})};var Zs="top",Ua="bottom",ja="right",Ys="left",dC="auto",r_=[Zs,Ua,ja,Ys],Rp="start",Pv="end",OW="clippingParents",KO="viewport",Zg="popper",zW="reference",wP=r_.reduce(function(e,t){return e.concat([t+"-"+Rp,t+"-"+Pv])},[]),Fc=[].concat(r_,[dC]).reduce(function(e,t){return e.concat([t,t+"-"+Rp,t+"-"+Pv])},[]),BW="beforeRead",FW="read",NW="afterRead",$W="beforeMain",VW="main",UW="afterMain",jW="beforeWrite",HW="write",GW="afterWrite",WW=[BW,FW,NW,$W,VW,UW,jW,HW,GW];function Zl(e){return e?(e.nodeName||"").toLowerCase():null}function wl(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Dp(e){var t=wl(e).Element;return e instanceof t||e instanceof Element}function Na(e){var t=wl(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function hC(e){if(typeof ShadowRoot>"u")return!1;var t=wl(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function qW(e){var t=e.state;Object.keys(t.elements).forEach(function(i){var a=t.styles[i]||{},d=t.attributes[i]||{},m=t.elements[i];!Na(m)||!Zl(m)||(Object.assign(m.style,a),Object.keys(d).forEach(function(_){var x=d[_];x===!1?m.removeAttribute(_):m.setAttribute(_,x===!0?"":x)}))})}function KW(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach(function(a){var d=t.elements[a],m=t.attributes[a]||{},_=Object.keys(t.styles.hasOwnProperty(a)?t.styles[a]:i[a]),x=_.reduce(function(o,C){return o[C]="",o},{});!Na(d)||!Zl(d)||(Object.assign(d.style,x),Object.keys(m).forEach(function(o){d.removeAttribute(o)}))})}}var ZO={name:"applyStyles",enabled:!0,phase:"write",fn:qW,effect:KW,requires:["computeStyles"]};function Gl(e){return e.split("-")[0]}var _h=Math.max,ob=Math.min,Lp=Math.round;function Op(e,t){t===void 0&&(t=!1);var i=e.getBoundingClientRect(),a=1,d=1;if(Na(e)&&t){var m=e.offsetHeight,_=e.offsetWidth;_>0&&(a=Lp(i.width)/_||1),m>0&&(d=Lp(i.height)/m||1)}return{width:i.width/a,height:i.height/d,top:i.top/d,right:i.right/a,bottom:i.bottom/d,left:i.left/a,x:i.left/a,y:i.top/d}}function fC(e){var t=Op(e),i=e.offsetWidth,a=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-a)<=1&&(a=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:a}}function YO(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&hC(i)){var a=t;do{if(a&&e.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function Pc(e){return wl(e).getComputedStyle(e)}function ZW(e){return["table","td","th"].indexOf(Zl(e))>=0}function hd(e){return((Dp(e)?e.ownerDocument:e.document)||window.document).documentElement}function Wb(e){return Zl(e)==="html"?e:e.assignedSlot||e.parentNode||(hC(e)?e.host:null)||hd(e)}function SP(e){return!Na(e)||Pc(e).position==="fixed"?null:e.offsetParent}function YW(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,i=navigator.userAgent.indexOf("Trident")!==-1;if(i&&Na(e)){var a=Pc(e);if(a.position==="fixed")return null}var d=Wb(e);for(hC(d)&&(d=d.host);Na(d)&&["html","body"].indexOf(Zl(d))<0;){var m=Pc(d);if(m.transform!=="none"||m.perspective!=="none"||m.contain==="paint"||["transform","perspective"].indexOf(m.willChange)!==-1||t&&m.willChange==="filter"||t&&m.filter&&m.filter!=="none")return d;d=d.parentNode}return null}function o_(e){for(var t=wl(e),i=SP(e);i&&ZW(i)&&Pc(i).position==="static";)i=SP(i);return i&&(Zl(i)==="html"||Zl(i)==="body"&&Pc(i).position==="static")?t:i||YW(e)||t}function pC(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function hv(e,t,i){return _h(e,ob(t,i))}function XW(e,t,i){var a=hv(e,t,i);return a>i?i:a}function XO(){return{top:0,right:0,bottom:0,left:0}}function JO(e){return Object.assign({},XO(),e)}function QO(e,t){return t.reduce(function(i,a){return i[a]=e,i},{})}var JW=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,JO(typeof e!="number"?e:QO(e,r_))};function QW(e){var t,i=e.state,a=e.name,d=e.options,m=i.elements.arrow,_=i.modifiersData.popperOffsets,x=Gl(i.placement),o=pC(x),C=[Ys,ja].indexOf(x)>=0,k=C?"height":"width";if(!(!m||!_)){var A=JW(d.padding,i),z=fC(m),N=o==="y"?Zs:Ys,$=o==="y"?Ua:ja,F=i.rects.reference[k]+i.rects.reference[o]-_[o]-i.rects.popper[k],G=_[o]-i.rects.reference[o],U=o_(m),te=U?o==="y"?U.clientHeight||0:U.clientWidth||0:0,Z=F/2-G/2,q=A[N],X=te-z[k]-A[$],ie=te/2-z[k]/2+Z,de=hv(q,ie,X),le=o;i.modifiersData[a]=(t={},t[le]=de,t.centerOffset=de-ie,t)}}function e9(e){var t=e.state,i=e.options,a=i.element,d=a===void 0?"[data-popper-arrow]":a;d!=null&&(typeof d=="string"&&(d=t.elements.popper.querySelector(d),!d)||!YO(t.elements.popper,d)||(t.elements.arrow=d))}var t9={name:"arrow",enabled:!0,phase:"main",fn:QW,effect:e9,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function zp(e){return e.split("-")[1]}var n9={top:"auto",right:"auto",bottom:"auto",left:"auto"};function r9(e){var t=e.x,i=e.y,a=window,d=a.devicePixelRatio||1;return{x:Lp(t*d)/d||0,y:Lp(i*d)/d||0}}function TP(e){var t,i=e.popper,a=e.popperRect,d=e.placement,m=e.variation,_=e.offsets,x=e.position,o=e.gpuAcceleration,C=e.adaptive,k=e.roundOffsets,A=e.isFixed,z=_.x,N=z===void 0?0:z,$=_.y,F=$===void 0?0:$,G=typeof k=="function"?k({x:N,y:F}):{x:N,y:F};N=G.x,F=G.y;var U=_.hasOwnProperty("x"),te=_.hasOwnProperty("y"),Z=Ys,q=Zs,X=window;if(C){var ie=o_(i),de="clientHeight",le="clientWidth";if(ie===wl(i)&&(ie=hd(i),Pc(ie).position!=="static"&&x==="absolute"&&(de="scrollHeight",le="scrollWidth")),ie=ie,d===Zs||(d===Ys||d===ja)&&m===Pv){q=Ua;var pe=A&&ie===X&&X.visualViewport?X.visualViewport.height:ie[de];F-=pe-a.height,F*=o?1:-1}if(d===Ys||(d===Zs||d===Ua)&&m===Pv){Z=ja;var ge=A&&ie===X&&X.visualViewport?X.visualViewport.width:ie[le];N-=ge-a.width,N*=o?1:-1}}var he=Object.assign({position:x},C&&n9),ue=k===!0?r9({x:N,y:F}):{x:N,y:F};if(N=ue.x,F=ue.y,o){var Re;return Object.assign({},he,(Re={},Re[q]=te?"0":"",Re[Z]=U?"0":"",Re.transform=(X.devicePixelRatio||1)<=1?"translate("+N+"px, "+F+"px)":"translate3d("+N+"px, "+F+"px, 0)",Re))}return Object.assign({},he,(t={},t[q]=te?F+"px":"",t[Z]=U?N+"px":"",t.transform="",t))}function o9(e){var t=e.state,i=e.options,a=i.gpuAcceleration,d=a===void 0?!0:a,m=i.adaptive,_=m===void 0?!0:m,x=i.roundOffsets,o=x===void 0?!0:x,C={placement:Gl(t.placement),variation:zp(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:d,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,TP(Object.assign({},C,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:_,roundOffsets:o})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,TP(Object.assign({},C,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:o})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var e4={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:o9,data:{}},u0={passive:!0};function i9(e){var t=e.state,i=e.instance,a=e.options,d=a.scroll,m=d===void 0?!0:d,_=a.resize,x=_===void 0?!0:_,o=wl(t.elements.popper),C=[].concat(t.scrollParents.reference,t.scrollParents.popper);return m&&C.forEach(function(k){k.addEventListener("scroll",i.update,u0)}),x&&o.addEventListener("resize",i.update,u0),function(){m&&C.forEach(function(k){k.removeEventListener("scroll",i.update,u0)}),x&&o.removeEventListener("resize",i.update,u0)}}var t4={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:i9,data:{}},s9={left:"right",right:"left",bottom:"top",top:"bottom"};function P0(e){return e.replace(/left|right|bottom|top/g,function(t){return s9[t]})}var a9={start:"end",end:"start"};function CP(e){return e.replace(/start|end/g,function(t){return a9[t]})}function mC(e){var t=wl(e),i=t.pageXOffset,a=t.pageYOffset;return{scrollLeft:i,scrollTop:a}}function gC(e){return Op(hd(e)).left+mC(e).scrollLeft}function l9(e){var t=wl(e),i=hd(e),a=t.visualViewport,d=i.clientWidth,m=i.clientHeight,_=0,x=0;return a&&(d=a.width,m=a.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(_=a.offsetLeft,x=a.offsetTop)),{width:d,height:m,x:_+gC(e),y:x}}function c9(e){var t,i=hd(e),a=mC(e),d=(t=e.ownerDocument)==null?void 0:t.body,m=_h(i.scrollWidth,i.clientWidth,d?d.scrollWidth:0,d?d.clientWidth:0),_=_h(i.scrollHeight,i.clientHeight,d?d.scrollHeight:0,d?d.clientHeight:0),x=-a.scrollLeft+gC(e),o=-a.scrollTop;return Pc(d||i).direction==="rtl"&&(x+=_h(i.clientWidth,d?d.clientWidth:0)-m),{width:m,height:_,x,y:o}}function vC(e){var t=Pc(e),i=t.overflow,a=t.overflowX,d=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+d+a)}function n4(e){return["html","body","#document"].indexOf(Zl(e))>=0?e.ownerDocument.body:Na(e)&&vC(e)?e:n4(Wb(e))}function fv(e,t){var i;t===void 0&&(t=[]);var a=n4(e),d=a===((i=e.ownerDocument)==null?void 0:i.body),m=wl(a),_=d?[m].concat(m.visualViewport||[],vC(a)?a:[]):a,x=t.concat(_);return d?x:x.concat(fv(Wb(_)))}function dS(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function u9(e){var t=Op(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function EP(e,t){return t===KO?dS(l9(e)):Dp(t)?u9(t):dS(c9(hd(e)))}function d9(e){var t=fv(Wb(e)),i=["absolute","fixed"].indexOf(Pc(e).position)>=0,a=i&&Na(e)?o_(e):e;return Dp(a)?t.filter(function(d){return Dp(d)&&YO(d,a)&&Zl(d)!=="body"}):[]}function h9(e,t,i){var a=t==="clippingParents"?d9(e):[].concat(t),d=[].concat(a,[i]),m=d[0],_=d.reduce(function(x,o){var C=EP(e,o);return x.top=_h(C.top,x.top),x.right=ob(C.right,x.right),x.bottom=ob(C.bottom,x.bottom),x.left=_h(C.left,x.left),x},EP(e,m));return _.width=_.right-_.left,_.height=_.bottom-_.top,_.x=_.left,_.y=_.top,_}function r4(e){var t=e.reference,i=e.element,a=e.placement,d=a?Gl(a):null,m=a?zp(a):null,_=t.x+t.width/2-i.width/2,x=t.y+t.height/2-i.height/2,o;switch(d){case Zs:o={x:_,y:t.y-i.height};break;case Ua:o={x:_,y:t.y+t.height};break;case ja:o={x:t.x+t.width,y:x};break;case Ys:o={x:t.x-i.width,y:x};break;default:o={x:t.x,y:t.y}}var C=d?pC(d):null;if(C!=null){var k=C==="y"?"height":"width";switch(m){case Rp:o[C]=o[C]-(t[k]/2-i[k]/2);break;case Pv:o[C]=o[C]+(t[k]/2-i[k]/2);break}}return o}function Rv(e,t){t===void 0&&(t={});var i=t,a=i.placement,d=a===void 0?e.placement:a,m=i.boundary,_=m===void 0?OW:m,x=i.rootBoundary,o=x===void 0?KO:x,C=i.elementContext,k=C===void 0?Zg:C,A=i.altBoundary,z=A===void 0?!1:A,N=i.padding,$=N===void 0?0:N,F=JO(typeof $!="number"?$:QO($,r_)),G=k===Zg?zW:Zg,U=e.rects.popper,te=e.elements[z?G:k],Z=h9(Dp(te)?te:te.contextElement||hd(e.elements.popper),_,o),q=Op(e.elements.reference),X=r4({reference:q,element:U,strategy:"absolute",placement:d}),ie=dS(Object.assign({},U,X)),de=k===Zg?ie:q,le={top:Z.top-de.top+F.top,bottom:de.bottom-Z.bottom+F.bottom,left:Z.left-de.left+F.left,right:de.right-Z.right+F.right},pe=e.modifiersData.offset;if(k===Zg&&pe){var ge=pe[d];Object.keys(le).forEach(function(he){var ue=[ja,Ua].indexOf(he)>=0?1:-1,Re=[Zs,Ua].indexOf(he)>=0?"y":"x";le[he]+=ge[Re]*ue})}return le}function f9(e,t){t===void 0&&(t={});var i=t,a=i.placement,d=i.boundary,m=i.rootBoundary,_=i.padding,x=i.flipVariations,o=i.allowedAutoPlacements,C=o===void 0?Fc:o,k=zp(a),A=k?x?wP:wP.filter(function($){return zp($)===k}):r_,z=A.filter(function($){return C.indexOf($)>=0});z.length===0&&(z=A);var N=z.reduce(function($,F){return $[F]=Rv(e,{placement:F,boundary:d,rootBoundary:m,padding:_})[Gl(F)],$},{});return Object.keys(N).sort(function($,F){return N[$]-N[F]})}function p9(e){if(Gl(e)===dC)return[];var t=P0(e);return[CP(e),t,CP(t)]}function m9(e){var t=e.state,i=e.options,a=e.name;if(!t.modifiersData[a]._skip){for(var d=i.mainAxis,m=d===void 0?!0:d,_=i.altAxis,x=_===void 0?!0:_,o=i.fallbackPlacements,C=i.padding,k=i.boundary,A=i.rootBoundary,z=i.altBoundary,N=i.flipVariations,$=N===void 0?!0:N,F=i.allowedAutoPlacements,G=t.options.placement,U=Gl(G),te=U===G,Z=o||(te||!$?[P0(G)]:p9(G)),q=[G].concat(Z).reduce(function(ut,Lt){return ut.concat(Gl(Lt)===dC?f9(t,{placement:Lt,boundary:k,rootBoundary:A,padding:C,flipVariations:$,allowedAutoPlacements:F}):Lt)},[]),X=t.rects.reference,ie=t.rects.popper,de=new Map,le=!0,pe=q[0],ge=0;ge<q.length;ge++){var he=q[ge],ue=Gl(he),Re=zp(he)===Rp,Ye=[Zs,Ua].indexOf(ue)>=0,Ie=Ye?"width":"height",fe=Rv(t,{placement:he,boundary:k,rootBoundary:A,altBoundary:z,padding:C}),Me=Ye?Re?ja:Ys:Re?Ua:Zs;X[Ie]>ie[Ie]&&(Me=P0(Me));var Se=P0(Me),ye=[];if(m&&ye.push(fe[ue]<=0),x&&ye.push(fe[Me]<=0,fe[Se]<=0),ye.every(function(ut){return ut})){pe=he,le=!1;break}de.set(he,ye)}if(le)for(var Ce=$?3:1,Fe=function(ut){var Lt=q.find(function(Ft){var mt=de.get(Ft);if(mt)return mt.slice(0,ut).every(function(jt){return jt})});if(Lt)return pe=Lt,"break"},it=Ce;it>0;it--){var We=Fe(it);if(We==="break")break}t.placement!==pe&&(t.modifiersData[a]._skip=!0,t.placement=pe,t.reset=!0)}}var g9={name:"flip",enabled:!0,phase:"main",fn:m9,requiresIfExists:["offset"],data:{_skip:!1}};function MP(e,t,i){return i===void 0&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function IP(e){return[Zs,ja,Ua,Ys].some(function(t){return e[t]>=0})}function v9(e){var t=e.state,i=e.name,a=t.rects.reference,d=t.rects.popper,m=t.modifiersData.preventOverflow,_=Rv(t,{elementContext:"reference"}),x=Rv(t,{altBoundary:!0}),o=MP(_,a),C=MP(x,d,m),k=IP(o),A=IP(C);t.modifiersData[i]={referenceClippingOffsets:o,popperEscapeOffsets:C,isReferenceHidden:k,hasPopperEscaped:A},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":k,"data-popper-escaped":A})}var _9={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:v9};function y9(e,t,i){var a=Gl(e),d=[Ys,Zs].indexOf(a)>=0?-1:1,m=typeof i=="function"?i(Object.assign({},t,{placement:e})):i,_=m[0],x=m[1];return _=_||0,x=(x||0)*d,[Ys,ja].indexOf(a)>=0?{x,y:_}:{x:_,y:x}}function b9(e){var t=e.state,i=e.options,a=e.name,d=i.offset,m=d===void 0?[0,0]:d,_=Fc.reduce(function(k,A){return k[A]=y9(A,t.rects,m),k},{}),x=_[t.placement],o=x.x,C=x.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=o,t.modifiersData.popperOffsets.y+=C),t.modifiersData[a]=_}var x9={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:b9};function w9(e){var t=e.state,i=e.name;t.modifiersData[i]=r4({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var o4={name:"popperOffsets",enabled:!0,phase:"read",fn:w9,data:{}};function S9(e){return e==="x"?"y":"x"}function T9(e){var t=e.state,i=e.options,a=e.name,d=i.mainAxis,m=d===void 0?!0:d,_=i.altAxis,x=_===void 0?!1:_,o=i.boundary,C=i.rootBoundary,k=i.altBoundary,A=i.padding,z=i.tether,N=z===void 0?!0:z,$=i.tetherOffset,F=$===void 0?0:$,G=Rv(t,{boundary:o,rootBoundary:C,padding:A,altBoundary:k}),U=Gl(t.placement),te=zp(t.placement),Z=!te,q=pC(U),X=S9(q),ie=t.modifiersData.popperOffsets,de=t.rects.reference,le=t.rects.popper,pe=typeof F=="function"?F(Object.assign({},t.rects,{placement:t.placement})):F,ge=typeof pe=="number"?{mainAxis:pe,altAxis:pe}:Object.assign({mainAxis:0,altAxis:0},pe),he=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,ue={x:0,y:0};if(ie){if(m){var Re,Ye=q==="y"?Zs:Ys,Ie=q==="y"?Ua:ja,fe=q==="y"?"height":"width",Me=ie[q],Se=Me+G[Ye],ye=Me-G[Ie],Ce=N?-le[fe]/2:0,Fe=te===Rp?de[fe]:le[fe],it=te===Rp?-le[fe]:-de[fe],We=t.elements.arrow,ut=N&&We?fC(We):{width:0,height:0},Lt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:XO(),Ft=Lt[Ye],mt=Lt[Ie],jt=hv(0,de[fe],ut[fe]),Ht=Z?de[fe]/2-Ce-jt-Ft-ge.mainAxis:Fe-jt-Ft-ge.mainAxis,Tn=Z?-de[fe]/2+Ce+jt+mt+ge.mainAxis:it+jt+mt+ge.mainAxis,Pe=t.elements.arrow&&o_(t.elements.arrow),At=Pe?q==="y"?Pe.clientTop||0:Pe.clientLeft||0:0,He=(Re=he==null?void 0:he[q])!=null?Re:0,pt=Me+Ht-He-At,et=Me+Tn-He,rn=hv(N?ob(Se,pt):Se,Me,N?_h(ye,et):ye);ie[q]=rn,ue[q]=rn-Me}if(x){var kt,zt=q==="x"?Zs:Ys,Mt=q==="x"?Ua:ja,en=ie[X],sn=X==="y"?"height":"width",dn=en+G[zt],Pn=en-G[Mt],Ot=[Zs,Ys].indexOf(U)!==-1,Zt=(kt=he==null?void 0:he[X])!=null?kt:0,jn=Ot?dn:en-de[sn]-le[sn]-Zt+ge.altAxis,ir=Ot?en+de[sn]+le[sn]-Zt-ge.altAxis:Pn,ur=N&&Ot?XW(jn,en,ir):hv(N?jn:dn,en,N?ir:Pn);ie[X]=ur,ue[X]=ur-en}t.modifiersData[a]=ue}}var C9={name:"preventOverflow",enabled:!0,phase:"main",fn:T9,requiresIfExists:["offset"]};function E9(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function M9(e){return e===wl(e)||!Na(e)?mC(e):E9(e)}function I9(e){var t=e.getBoundingClientRect(),i=Lp(t.width)/e.offsetWidth||1,a=Lp(t.height)/e.offsetHeight||1;return i!==1||a!==1}function k9(e,t,i){i===void 0&&(i=!1);var a=Na(t),d=Na(t)&&I9(t),m=hd(t),_=Op(e,d),x={scrollLeft:0,scrollTop:0},o={x:0,y:0};return(a||!a&&!i)&&((Zl(t)!=="body"||vC(m))&&(x=M9(t)),Na(t)?(o=Op(t,!0),o.x+=t.clientLeft,o.y+=t.clientTop):m&&(o.x=gC(m))),{x:_.left+x.scrollLeft-o.x,y:_.top+x.scrollTop-o.y,width:_.width,height:_.height}}function A9(e){var t=new Map,i=new Set,a=[];e.forEach(function(m){t.set(m.name,m)});function d(m){i.add(m.name);var _=[].concat(m.requires||[],m.requiresIfExists||[]);_.forEach(function(x){if(!i.has(x)){var o=t.get(x);o&&d(o)}}),a.push(m)}return e.forEach(function(m){i.has(m.name)||d(m)}),a}function P9(e){var t=A9(e);return WW.reduce(function(i,a){return i.concat(t.filter(function(d){return d.phase===a}))},[])}function R9(e){var t;return function(){return t||(t=new Promise(function(i){Promise.resolve().then(function(){t=void 0,i(e())})})),t}}function D9(e){var t=e.reduce(function(i,a){var d=i[a.name];return i[a.name]=d?Object.assign({},d,a,{options:Object.assign({},d.options,a.options),data:Object.assign({},d.data,a.data)}):a,i},{});return Object.keys(t).map(function(i){return t[i]})}var kP={placement:"bottom",modifiers:[],strategy:"absolute"};function AP(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function _C(e){e===void 0&&(e={});var t=e,i=t.defaultModifiers,a=i===void 0?[]:i,d=t.defaultOptions,m=d===void 0?kP:d;return function(_,x,o){o===void 0&&(o=m);var C={placement:"bottom",orderedModifiers:[],options:Object.assign({},kP,m),modifiersData:{},elements:{reference:_,popper:x},attributes:{},styles:{}},k=[],A=!1,z={state:C,setOptions:function(F){var G=typeof F=="function"?F(C.options):F;$(),C.options=Object.assign({},m,C.options,G),C.scrollParents={reference:Dp(_)?fv(_):_.contextElement?fv(_.contextElement):[],popper:fv(x)};var U=P9(D9([].concat(a,C.options.modifiers)));return C.orderedModifiers=U.filter(function(te){return te.enabled}),N(),z.update()},forceUpdate:function(){if(!A){var F=C.elements,G=F.reference,U=F.popper;if(AP(G,U)){C.rects={reference:k9(G,o_(U),C.options.strategy==="fixed"),popper:fC(U)},C.reset=!1,C.placement=C.options.placement,C.orderedModifiers.forEach(function(le){return C.modifiersData[le.name]=Object.assign({},le.data)});for(var te=0;te<C.orderedModifiers.length;te++){if(C.reset===!0){C.reset=!1,te=-1;continue}var Z=C.orderedModifiers[te],q=Z.fn,X=Z.options,ie=X===void 0?{}:X,de=Z.name;typeof q=="function"&&(C=q({state:C,options:ie,name:de,instance:z})||C)}}}},update:R9(function(){return new Promise(function(F){z.forceUpdate(),F(C)})}),destroy:function(){$(),A=!0}};if(!AP(_,x))return z;z.setOptions(o).then(function(F){!A&&o.onFirstUpdate&&o.onFirstUpdate(F)});function N(){C.orderedModifiers.forEach(function(F){var G=F.name,U=F.options,te=U===void 0?{}:U,Z=F.effect;if(typeof Z=="function"){var q=Z({state:C,name:G,instance:z,options:te}),X=function(){};k.push(q||X)}})}function $(){k.forEach(function(F){return F()}),k=[]}return z}}_C();var L9=[t4,o4,e4,ZO];_C({defaultModifiers:L9});var O9=[t4,o4,e4,ZO,x9,g9,C9,t9,_9],z9=_C({defaultModifiers:O9});const B9=(e,t,i={})=>{const a={name:"updateState",enabled:!0,phase:"write",fn:({state:o})=>{const C=F9(o);Object.assign(_.value,C)},requires:["computeStyles"]},d=Q(()=>{const{onFirstUpdate:o,placement:C,strategy:k,modifiers:A}=y(i);return{onFirstUpdate:o,placement:C||"bottom",strategy:k||"absolute",modifiers:[...A||[],a,{name:"applyStyles",enabled:!1}]}}),m=Uo(),_=be({styles:{popper:{position:y(d).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),x=()=>{m.value&&(m.value.destroy(),m.value=void 0)};return Wt(d,o=>{const C=y(m);C&&C.setOptions(o)},{deep:!0}),Wt([e,t],([o,C])=>{x(),!(!o||!C)&&(m.value=z9(o,C,y(d)))}),Io(()=>{x()}),{state:Q(()=>{var o;return{...((o=y(m))==null?void 0:o.state)||{}}}),styles:Q(()=>y(_).styles),attributes:Q(()=>y(_).attributes),update:()=>{var o;return(o=y(m))==null?void 0:o.update()},forceUpdate:()=>{var o;return(o=y(m))==null?void 0:o.forceUpdate()},instanceRef:Q(()=>y(m))}};function F9(e){const t=Object.keys(e.elements),i=Av(t.map(d=>[d,e.styles[d]||{}])),a=Av(t.map(d=>[d,e.attributes[d]]));return{styles:i,attributes:a}}const yC=e=>{if(!e)return{onClick:_o,onMousedown:_o,onMouseup:_o};let t=!1,i=!1;return{onClick:_=>{t&&i&&e(_),t=i=!1},onMousedown:_=>{t=_.target===_.currentTarget},onMouseup:_=>{i=_.target===_.currentTarget}}},N9=(e,t=0)=>{if(t===0)return e;const i=Tr(t)&&!!t.initVal,a=be(i);let d=null;const m=x=>{if(Bo(x)){a.value=e.value;return}d&&clearTimeout(d),d=setTimeout(()=>{a.value=e.value},x)},_=x=>{x==="leading"?Wn(t)?m(t):m(t.leading):Tr(t)?m(t.trailing):a.value=!1};return vr(()=>_("leading")),Wt(()=>e.value,x=>{_(x?"leading":"trailing")}),a};function PP(){let e;const t=(a,d)=>{i(),e=window.setTimeout(a,d)},i=()=>window.clearTimeout(e);return Xv(()=>i()),{registerTimeout:t,cancelTimeout:i}}const RP={prefix:Math.floor(Math.random()*1e4),current:0},$9=Symbol("elIdInjection"),bC=()=>Cr()?kn($9,RP):RP,Wi=e=>{const t=bC(),i=cC();return eS(()=>y(e)||`${i.value}-id-${t.prefix}-${t.current++}`)};let lp=[];const DP=e=>{e.code===En.esc&&lp.forEach(t=>t(e))},V9=e=>{vr(()=>{lp.length===0&&document.addEventListener("keydown",DP),Hr&&lp.push(e)}),Io(()=>{lp=lp.filter(t=>t!==e),lp.length===0&&Hr&&document.removeEventListener("keydown",DP)})},i4=()=>{const e=cC(),t=bC(),i=Q(()=>`${e.value}-popper-container-${t.prefix}`),a=Q(()=>`#${i.value}`);return{id:i,selector:a}},U9=e=>{const t=document.createElement("div");return t.id=e,document.body.appendChild(t),t},j9=()=>{const{id:e,selector:t}=i4();return Pb(()=>{Hr&&(document.body.querySelector(t.value)||U9(e.value))}),{id:e,selector:t}},H9=ln({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),G9=({showAfter:e,hideAfter:t,autoClose:i,open:a,close:d})=>{const{registerTimeout:m}=PP(),{registerTimeout:_,cancelTimeout:x}=PP();return{onOpen:k=>{m(()=>{a(k);const A=y(i);Wn(A)&&A>0&&_(()=>{d(k)},A)},y(e))},onClose:k=>{x(),m(()=>{d(k)},y(t))}}},s4=Symbol("elForwardRef"),W9=e=>{Br(s4,{setForwardRef:i=>{e.value=i}})},q9=e=>({mounted(t){e(t)},updated(t){e(t)},unmounted(){e(null)}}),LP={current:0},OP=be(0),a4=2e3,zP=Symbol("elZIndexContextKey"),l4=Symbol("zIndexContextKey"),Jp=e=>{const t=Cr()?kn(zP,LP):LP,i=e||(Cr()?kn(l4,void 0):void 0),a=Q(()=>{const _=y(i);return Wn(_)?_:a4}),d=Q(()=>a.value+OP.value),m=()=>(t.current++,OP.value=t.current,d.value);return!Hr&&kn(zP),{initialZIndex:a,currentZIndex:d,nextZIndex:m}},Bp=Math.min,yh=Math.max,ib=Math.round,d0=Math.floor,Wl=e=>({x:e,y:e}),K9={left:"right",right:"left",bottom:"top",top:"bottom"},Z9={start:"end",end:"start"};function hS(e,t,i){return yh(e,Bp(t,i))}function i_(e,t){return typeof e=="function"?e(t):e}function Ih(e){return e.split("-")[0]}function s_(e){return e.split("-")[1]}function c4(e){return e==="x"?"y":"x"}function xC(e){return e==="y"?"height":"width"}function Fp(e){return["top","bottom"].includes(Ih(e))?"y":"x"}function wC(e){return c4(Fp(e))}function Y9(e,t,i){i===void 0&&(i=!1);const a=s_(e),d=wC(e),m=xC(d);let _=d==="x"?a===(i?"end":"start")?"right":"left":a==="start"?"bottom":"top";return t.reference[m]>t.floating[m]&&(_=sb(_)),[_,sb(_)]}function X9(e){const t=sb(e);return[fS(e),t,fS(t)]}function fS(e){return e.replace(/start|end/g,t=>Z9[t])}function J9(e,t,i){const a=["left","right"],d=["right","left"],m=["top","bottom"],_=["bottom","top"];switch(e){case"top":case"bottom":return i?t?d:a:t?a:d;case"left":case"right":return t?m:_;default:return[]}}function Q9(e,t,i,a){const d=s_(e);let m=J9(Ih(e),i==="start",a);return d&&(m=m.map(_=>_+"-"+d),t&&(m=m.concat(m.map(fS)))),m}function sb(e){return e.replace(/left|right|bottom|top/g,t=>K9[t])}function eq(e){return{top:0,right:0,bottom:0,left:0,...e}}function u4(e){return typeof e!="number"?eq(e):{top:e,right:e,bottom:e,left:e}}function ab(e){const{x:t,y:i,width:a,height:d}=e;return{width:a,height:d,top:i,left:t,right:t+a,bottom:i+d,x:t,y:i}}function BP(e,t,i){let{reference:a,floating:d}=e;const m=Fp(t),_=wC(t),x=xC(_),o=Ih(t),C=m==="y",k=a.x+a.width/2-d.width/2,A=a.y+a.height/2-d.height/2,z=a[x]/2-d[x]/2;let N;switch(o){case"top":N={x:k,y:a.y-d.height};break;case"bottom":N={x:k,y:a.y+a.height};break;case"right":N={x:a.x+a.width,y:A};break;case"left":N={x:a.x-d.width,y:A};break;default:N={x:a.x,y:a.y}}switch(s_(t)){case"start":N[_]-=z*(i&&C?-1:1);break;case"end":N[_]+=z*(i&&C?-1:1);break}return N}const tq=async(e,t,i)=>{const{placement:a="bottom",strategy:d="absolute",middleware:m=[],platform:_}=i,x=m.filter(Boolean),o=await(_.isRTL==null?void 0:_.isRTL(t));let C=await _.getElementRects({reference:e,floating:t,strategy:d}),{x:k,y:A}=BP(C,a,o),z=a,N={},$=0;for(let F=0;F<x.length;F++){const{name:G,fn:U}=x[F],{x:te,y:Z,data:q,reset:X}=await U({x:k,y:A,initialPlacement:a,placement:z,strategy:d,middlewareData:N,rects:C,platform:_,elements:{reference:e,floating:t}});k=te??k,A=Z??A,N={...N,[G]:{...N[G],...q}},X&&$<=50&&($++,typeof X=="object"&&(X.placement&&(z=X.placement),X.rects&&(C=X.rects===!0?await _.getElementRects({reference:e,floating:t,strategy:d}):X.rects),{x:k,y:A}=BP(C,z,o)),F=-1)}return{x:k,y:A,placement:z,strategy:d,middlewareData:N}};async function SC(e,t){var i;t===void 0&&(t={});const{x:a,y:d,platform:m,rects:_,elements:x,strategy:o}=e,{boundary:C="clippingAncestors",rootBoundary:k="viewport",elementContext:A="floating",altBoundary:z=!1,padding:N=0}=i_(t,e),$=u4(N),G=x[z?A==="floating"?"reference":"floating":A],U=ab(await m.getClippingRect({element:(i=await(m.isElement==null?void 0:m.isElement(G)))==null||i?G:G.contextElement||await(m.getDocumentElement==null?void 0:m.getDocumentElement(x.floating)),boundary:C,rootBoundary:k,strategy:o})),te=A==="floating"?{x:a,y:d,width:_.floating.width,height:_.floating.height}:_.reference,Z=await(m.getOffsetParent==null?void 0:m.getOffsetParent(x.floating)),q=await(m.isElement==null?void 0:m.isElement(Z))?await(m.getScale==null?void 0:m.getScale(Z))||{x:1,y:1}:{x:1,y:1},X=ab(m.convertOffsetParentRelativeRectToViewportRelativeRect?await m.convertOffsetParentRelativeRectToViewportRelativeRect({elements:x,rect:te,offsetParent:Z,strategy:o}):te);return{top:(U.top-X.top+$.top)/q.y,bottom:(X.bottom-U.bottom+$.bottom)/q.y,left:(U.left-X.left+$.left)/q.x,right:(X.right-U.right+$.right)/q.x}}const nq=e=>({name:"arrow",options:e,async fn(t){const{x:i,y:a,placement:d,rects:m,platform:_,elements:x,middlewareData:o}=t,{element:C,padding:k=0}=i_(e,t)||{};if(C==null)return{};const A=u4(k),z={x:i,y:a},N=wC(d),$=xC(N),F=await _.getDimensions(C),G=N==="y",U=G?"top":"left",te=G?"bottom":"right",Z=G?"clientHeight":"clientWidth",q=m.reference[$]+m.reference[N]-z[N]-m.floating[$],X=z[N]-m.reference[N],ie=await(_.getOffsetParent==null?void 0:_.getOffsetParent(C));let de=ie?ie[Z]:0;(!de||!await(_.isElement==null?void 0:_.isElement(ie)))&&(de=x.floating[Z]||m.floating[$]);const le=q/2-X/2,pe=de/2-F[$]/2-1,ge=Bp(A[U],pe),he=Bp(A[te],pe),ue=ge,Re=de-F[$]-he,Ye=de/2-F[$]/2+le,Ie=hS(ue,Ye,Re),fe=!o.arrow&&s_(d)!=null&&Ye!==Ie&&m.reference[$]/2-(Ye<ue?ge:he)-F[$]/2<0,Me=fe?Ye<ue?Ye-ue:Ye-Re:0;return{[N]:z[N]+Me,data:{[N]:Ie,centerOffset:Ye-Ie-Me,...fe&&{alignmentOffset:Me}},reset:fe}}}),rq=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var i,a;const{placement:d,middlewareData:m,rects:_,initialPlacement:x,platform:o,elements:C}=t,{mainAxis:k=!0,crossAxis:A=!0,fallbackPlacements:z,fallbackStrategy:N="bestFit",fallbackAxisSideDirection:$="none",flipAlignment:F=!0,...G}=i_(e,t);if((i=m.arrow)!=null&&i.alignmentOffset)return{};const U=Ih(d),te=Fp(x),Z=Ih(x)===x,q=await(o.isRTL==null?void 0:o.isRTL(C.floating)),X=z||(Z||!F?[sb(x)]:X9(x)),ie=$!=="none";!z&&ie&&X.push(...Q9(x,F,$,q));const de=[x,...X],le=await SC(t,G),pe=[];let ge=((a=m.flip)==null?void 0:a.overflows)||[];if(k&&pe.push(le[U]),A){const Ye=Y9(d,_,q);pe.push(le[Ye[0]],le[Ye[1]])}if(ge=[...ge,{placement:d,overflows:pe}],!pe.every(Ye=>Ye<=0)){var he,ue;const Ye=(((he=m.flip)==null?void 0:he.index)||0)+1,Ie=de[Ye];if(Ie)return{data:{index:Ye,overflows:ge},reset:{placement:Ie}};let fe=(ue=ge.filter(Me=>Me.overflows[0]<=0).sort((Me,Se)=>Me.overflows[1]-Se.overflows[1])[0])==null?void 0:ue.placement;if(!fe)switch(N){case"bestFit":{var Re;const Me=(Re=ge.filter(Se=>{if(ie){const ye=Fp(Se.placement);return ye===te||ye==="y"}return!0}).map(Se=>[Se.placement,Se.overflows.filter(ye=>ye>0).reduce((ye,Ce)=>ye+Ce,0)]).sort((Se,ye)=>Se[1]-ye[1])[0])==null?void 0:Re[0];Me&&(fe=Me);break}case"initialPlacement":fe=x;break}if(d!==fe)return{reset:{placement:fe}}}return{}}}};async function oq(e,t){const{placement:i,platform:a,elements:d}=e,m=await(a.isRTL==null?void 0:a.isRTL(d.floating)),_=Ih(i),x=s_(i),o=Fp(i)==="y",C=["left","top"].includes(_)?-1:1,k=m&&o?-1:1,A=i_(t,e);let{mainAxis:z,crossAxis:N,alignmentAxis:$}=typeof A=="number"?{mainAxis:A,crossAxis:0,alignmentAxis:null}:{mainAxis:A.mainAxis||0,crossAxis:A.crossAxis||0,alignmentAxis:A.alignmentAxis};return x&&typeof $=="number"&&(N=x==="end"?$*-1:$),o?{x:N*k,y:z*C}:{x:z*C,y:N*k}}const iq=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var i,a;const{x:d,y:m,placement:_,middlewareData:x}=t,o=await oq(t,e);return _===((i=x.offset)==null?void 0:i.placement)&&(a=x.arrow)!=null&&a.alignmentOffset?{}:{x:d+o.x,y:m+o.y,data:{...o,placement:_}}}}},sq=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:i,y:a,placement:d}=t,{mainAxis:m=!0,crossAxis:_=!1,limiter:x={fn:G=>{let{x:U,y:te}=G;return{x:U,y:te}}},...o}=i_(e,t),C={x:i,y:a},k=await SC(t,o),A=Fp(Ih(d)),z=c4(A);let N=C[z],$=C[A];if(m){const G=z==="y"?"top":"left",U=z==="y"?"bottom":"right",te=N+k[G],Z=N-k[U];N=hS(te,N,Z)}if(_){const G=A==="y"?"top":"left",U=A==="y"?"bottom":"right",te=$+k[G],Z=$-k[U];$=hS(te,$,Z)}const F=x.fn({...t,[z]:N,[A]:$});return{...F,data:{x:F.x-i,y:F.y-a,enabled:{[z]:m,[A]:_}}}}}};function qb(){return typeof window<"u"}function Qp(e){return d4(e)?(e.nodeName||"").toLowerCase():"#document"}function va(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function nc(e){var t;return(t=(d4(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function d4(e){return qb()?e instanceof Node||e instanceof va(e).Node:!1}function _l(e){return qb()?e instanceof Element||e instanceof va(e).Element:!1}function Yl(e){return qb()?e instanceof HTMLElement||e instanceof va(e).HTMLElement:!1}function FP(e){return!qb()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof va(e).ShadowRoot}function a_(e){const{overflow:t,overflowX:i,overflowY:a,display:d}=yl(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+i)&&!["inline","contents"].includes(d)}function aq(e){return["table","td","th"].includes(Qp(e))}function Kb(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function TC(e){const t=CC(),i=_l(e)?yl(e):e;return i.transform!=="none"||i.perspective!=="none"||(i.containerType?i.containerType!=="normal":!1)||!t&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!t&&(i.filter?i.filter!=="none":!1)||["transform","perspective","filter"].some(a=>(i.willChange||"").includes(a))||["paint","layout","strict","content"].some(a=>(i.contain||"").includes(a))}function lq(e){let t=sd(e);for(;Yl(t)&&!Np(t);){if(TC(t))return t;if(Kb(t))return null;t=sd(t)}return null}function CC(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Np(e){return["html","body","#document"].includes(Qp(e))}function yl(e){return va(e).getComputedStyle(e)}function Zb(e){return _l(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function sd(e){if(Qp(e)==="html")return e;const t=e.assignedSlot||e.parentNode||FP(e)&&e.host||nc(e);return FP(t)?t.host:t}function h4(e){const t=sd(e);return Np(t)?e.ownerDocument?e.ownerDocument.body:e.body:Yl(t)&&a_(t)?t:h4(t)}function Dv(e,t,i){var a;t===void 0&&(t=[]),i===void 0&&(i=!0);const d=h4(e),m=d===((a=e.ownerDocument)==null?void 0:a.body),_=va(d);if(m){const x=pS(_);return t.concat(_,_.visualViewport||[],a_(d)?d:[],x&&i?Dv(x):[])}return t.concat(d,Dv(d,[],i))}function pS(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function f4(e){const t=yl(e);let i=parseFloat(t.width)||0,a=parseFloat(t.height)||0;const d=Yl(e),m=d?e.offsetWidth:i,_=d?e.offsetHeight:a,x=ib(i)!==m||ib(a)!==_;return x&&(i=m,a=_),{width:i,height:a,$:x}}function EC(e){return _l(e)?e:e.contextElement}function Sp(e){const t=EC(e);if(!Yl(t))return Wl(1);const i=t.getBoundingClientRect(),{width:a,height:d,$:m}=f4(t);let _=(m?ib(i.width):i.width)/a,x=(m?ib(i.height):i.height)/d;return(!_||!Number.isFinite(_))&&(_=1),(!x||!Number.isFinite(x))&&(x=1),{x:_,y:x}}const cq=Wl(0);function p4(e){const t=va(e);return!CC()||!t.visualViewport?cq:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function uq(e,t,i){return t===void 0&&(t=!1),!i||t&&i!==va(e)?!1:t}function kh(e,t,i,a){t===void 0&&(t=!1),i===void 0&&(i=!1);const d=e.getBoundingClientRect(),m=EC(e);let _=Wl(1);t&&(a?_l(a)&&(_=Sp(a)):_=Sp(e));const x=uq(m,i,a)?p4(m):Wl(0);let o=(d.left+x.x)/_.x,C=(d.top+x.y)/_.y,k=d.width/_.x,A=d.height/_.y;if(m){const z=va(m),N=a&&_l(a)?va(a):a;let $=z,F=pS($);for(;F&&a&&N!==$;){const G=Sp(F),U=F.getBoundingClientRect(),te=yl(F),Z=U.left+(F.clientLeft+parseFloat(te.paddingLeft))*G.x,q=U.top+(F.clientTop+parseFloat(te.paddingTop))*G.y;o*=G.x,C*=G.y,k*=G.x,A*=G.y,o+=Z,C+=q,$=va(F),F=pS($)}}return ab({width:k,height:A,x:o,y:C})}function MC(e,t){const i=Zb(e).scrollLeft;return t?t.left+i:kh(nc(e)).left+i}function m4(e,t,i){i===void 0&&(i=!1);const a=e.getBoundingClientRect(),d=a.left+t.scrollLeft-(i?0:MC(e,a)),m=a.top+t.scrollTop;return{x:d,y:m}}function dq(e){let{elements:t,rect:i,offsetParent:a,strategy:d}=e;const m=d==="fixed",_=nc(a),x=t?Kb(t.floating):!1;if(a===_||x&&m)return i;let o={scrollLeft:0,scrollTop:0},C=Wl(1);const k=Wl(0),A=Yl(a);if((A||!A&&!m)&&((Qp(a)!=="body"||a_(_))&&(o=Zb(a)),Yl(a))){const N=kh(a);C=Sp(a),k.x=N.x+a.clientLeft,k.y=N.y+a.clientTop}const z=_&&!A&&!m?m4(_,o,!0):Wl(0);return{width:i.width*C.x,height:i.height*C.y,x:i.x*C.x-o.scrollLeft*C.x+k.x+z.x,y:i.y*C.y-o.scrollTop*C.y+k.y+z.y}}function hq(e){return Array.from(e.getClientRects())}function fq(e){const t=nc(e),i=Zb(e),a=e.ownerDocument.body,d=yh(t.scrollWidth,t.clientWidth,a.scrollWidth,a.clientWidth),m=yh(t.scrollHeight,t.clientHeight,a.scrollHeight,a.clientHeight);let _=-i.scrollLeft+MC(e);const x=-i.scrollTop;return yl(a).direction==="rtl"&&(_+=yh(t.clientWidth,a.clientWidth)-d),{width:d,height:m,x:_,y:x}}function pq(e,t){const i=va(e),a=nc(e),d=i.visualViewport;let m=a.clientWidth,_=a.clientHeight,x=0,o=0;if(d){m=d.width,_=d.height;const C=CC();(!C||C&&t==="fixed")&&(x=d.offsetLeft,o=d.offsetTop)}return{width:m,height:_,x,y:o}}function mq(e,t){const i=kh(e,!0,t==="fixed"),a=i.top+e.clientTop,d=i.left+e.clientLeft,m=Yl(e)?Sp(e):Wl(1),_=e.clientWidth*m.x,x=e.clientHeight*m.y,o=d*m.x,C=a*m.y;return{width:_,height:x,x:o,y:C}}function NP(e,t,i){let a;if(t==="viewport")a=pq(e,i);else if(t==="document")a=fq(nc(e));else if(_l(t))a=mq(t,i);else{const d=p4(e);a={x:t.x-d.x,y:t.y-d.y,width:t.width,height:t.height}}return ab(a)}function g4(e,t){const i=sd(e);return i===t||!_l(i)||Np(i)?!1:yl(i).position==="fixed"||g4(i,t)}function gq(e,t){const i=t.get(e);if(i)return i;let a=Dv(e,[],!1).filter(x=>_l(x)&&Qp(x)!=="body"),d=null;const m=yl(e).position==="fixed";let _=m?sd(e):e;for(;_l(_)&&!Np(_);){const x=yl(_),o=TC(_);!o&&x.position==="fixed"&&(d=null),(m?!o&&!d:!o&&x.position==="static"&&!!d&&["absolute","fixed"].includes(d.position)||a_(_)&&!o&&g4(e,_))?a=a.filter(k=>k!==_):d=x,_=sd(_)}return t.set(e,a),a}function vq(e){let{element:t,boundary:i,rootBoundary:a,strategy:d}=e;const _=[...i==="clippingAncestors"?Kb(t)?[]:gq(t,this._c):[].concat(i),a],x=_[0],o=_.reduce((C,k)=>{const A=NP(t,k,d);return C.top=yh(A.top,C.top),C.right=Bp(A.right,C.right),C.bottom=Bp(A.bottom,C.bottom),C.left=yh(A.left,C.left),C},NP(t,x,d));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}}function _q(e){const{width:t,height:i}=f4(e);return{width:t,height:i}}function yq(e,t,i){const a=Yl(t),d=nc(t),m=i==="fixed",_=kh(e,!0,m,t);let x={scrollLeft:0,scrollTop:0};const o=Wl(0);if(a||!a&&!m)if((Qp(t)!=="body"||a_(d))&&(x=Zb(t)),a){const z=kh(t,!0,m,t);o.x=z.x+t.clientLeft,o.y=z.y+t.clientTop}else d&&(o.x=MC(d));const C=d&&!a&&!m?m4(d,x):Wl(0),k=_.left+x.scrollLeft-o.x-C.x,A=_.top+x.scrollTop-o.y-C.y;return{x:k,y:A,width:_.width,height:_.height}}function vw(e){return yl(e).position==="static"}function $P(e,t){if(!Yl(e)||yl(e).position==="fixed")return null;if(t)return t(e);let i=e.offsetParent;return nc(e)===i&&(i=i.ownerDocument.body),i}function v4(e,t){const i=va(e);if(Kb(e))return i;if(!Yl(e)){let d=sd(e);for(;d&&!Np(d);){if(_l(d)&&!vw(d))return d;d=sd(d)}return i}let a=$P(e,t);for(;a&&aq(a)&&vw(a);)a=$P(a,t);return a&&Np(a)&&vw(a)&&!TC(a)?i:a||lq(e)||i}const bq=async function(e){const t=this.getOffsetParent||v4,i=this.getDimensions,a=await i(e.floating);return{reference:yq(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}};function xq(e){return yl(e).direction==="rtl"}const wq={convertOffsetParentRelativeRectToViewportRelativeRect:dq,getDocumentElement:nc,getClippingRect:vq,getOffsetParent:v4,getElementRects:bq,getClientRects:hq,getDimensions:_q,getScale:Sp,isElement:_l,isRTL:xq};function Sq(e,t){let i=null,a;const d=nc(e);function m(){var x;clearTimeout(a),(x=i)==null||x.disconnect(),i=null}function _(x,o){x===void 0&&(x=!1),o===void 0&&(o=1),m();const{left:C,top:k,width:A,height:z}=e.getBoundingClientRect();if(x||t(),!A||!z)return;const N=d0(k),$=d0(d.clientWidth-(C+A)),F=d0(d.clientHeight-(k+z)),G=d0(C),te={rootMargin:-N+"px "+-$+"px "+-F+"px "+-G+"px",threshold:yh(0,Bp(1,o))||1};let Z=!0;function q(X){const ie=X[0].intersectionRatio;if(ie!==o){if(!Z)return _();ie?_(!1,ie):a=setTimeout(()=>{_(!1,1e-7)},1e3)}Z=!1}try{i=new IntersectionObserver(q,{...te,root:d.ownerDocument})}catch{i=new IntersectionObserver(q,te)}i.observe(e)}return _(!0),m}function Tq(e,t,i,a){a===void 0&&(a={});const{ancestorScroll:d=!0,ancestorResize:m=!0,elementResize:_=typeof ResizeObserver=="function",layoutShift:x=typeof IntersectionObserver=="function",animationFrame:o=!1}=a,C=EC(e),k=d||m?[...C?Dv(C):[],...Dv(t)]:[];k.forEach(U=>{d&&U.addEventListener("scroll",i,{passive:!0}),m&&U.addEventListener("resize",i)});const A=C&&x?Sq(C,i):null;let z=-1,N=null;_&&(N=new ResizeObserver(U=>{let[te]=U;te&&te.target===C&&N&&(N.unobserve(t),cancelAnimationFrame(z),z=requestAnimationFrame(()=>{var Z;(Z=N)==null||Z.observe(t)})),i()}),C&&!o&&N.observe(C),N.observe(t));let $,F=o?kh(e):null;o&&G();function G(){const U=kh(e);F&&(U.x!==F.x||U.y!==F.y||U.width!==F.width||U.height!==F.height)&&i(),F=U,$=requestAnimationFrame(G)}return i(),()=>{var U;k.forEach(te=>{d&&te.removeEventListener("scroll",i),m&&te.removeEventListener("resize",i)}),A==null||A(),(U=N)==null||U.disconnect(),N=null,o&&cancelAnimationFrame($)}}const Cq=SC,_4=iq,Eq=sq,Mq=rq,y4=nq,b4=(e,t,i)=>{const a=new Map,d={platform:wq,...i},m={...d.platform,_c:a};return tq(e,t,{...d,platform:m})};ln({});const Iq=e=>{if(!Hr)return;if(!e)return e;const t=Ls(e);return t||(Fo(e)?t:e)},kq=({middleware:e,placement:t,strategy:i})=>{const a=be(),d=be(),m=be(),_=be(),x=be({}),o={x:m,y:_,placement:t,strategy:i,middlewareData:x},C=async()=>{if(!Hr)return;const k=Iq(a),A=Ls(d);if(!k||!A)return;const z=await b4(k,A,{placement:y(t),strategy:y(i),middleware:y(e)});Pp(o).forEach(N=>{o[N].value=z[N]})};return vr(()=>{ns(()=>{C()})}),{...o,update:C,referenceRef:a,contentRef:d}},Aq=({arrowRef:e,padding:t})=>({name:"arrow",options:{element:e,padding:t},fn(i){const a=y(e);return a?y4({element:a,padding:t}).fn(i):{}}});function Pq(e){let t;function i(){if(e.value==null)return;const{selectionStart:d,selectionEnd:m,value:_}=e.value;if(d==null||m==null)return;const x=_.slice(0,Math.max(0,d)),o=_.slice(Math.max(0,m));t={selectionStart:d,selectionEnd:m,value:_,beforeTxt:x,afterTxt:o}}function a(){if(e.value==null||t==null)return;const{value:d}=e.value,{beforeTxt:m,afterTxt:_,selectionStart:x}=t;if(m==null||_==null||x==null)return;let o=d.length;if(d.endsWith(_))o=d.length-_.length;else if(d.startsWith(m))o=m.length;else{const C=m[x-1],k=d.indexOf(C,x-1);k!==-1&&(o=k+1)}e.value.setSelectionRange(o,o)}return[i,a]}const Rq=(e,t,i)=>qu(e.subTree).filter(m=>{var _;return Ho(m)&&((_=m.type)==null?void 0:_.name)===t&&!!m.component}).map(m=>m.component.uid).map(m=>i[m]).filter(m=>!!m),IC=(e,t)=>{const i={},a=Uo([]);return{children:a,addChild:_=>{i[_.uid]=_,a.value=Rq(e,t,i)},removeChild:_=>{delete i[_],a.value=a.value.filter(x=>x.uid!==_)}}},Ei=xl({type:String,values:tc,required:!1}),x4=Symbol("size"),w4=()=>{const e=kn(x4,{});return Q(()=>y(e.size)||"")};function Bh(e,{beforeFocus:t,afterFocus:i,beforeBlur:a,afterBlur:d}={}){const m=Cr(),{emit:_}=m,x=Uo(),o=be(!1),C=z=>{Fn(t)&&t(z)||o.value||(o.value=!0,_("focus",z),i==null||i())},k=z=>{var N;Fn(a)&&a(z)||z.relatedTarget&&((N=x.value)!=null&&N.contains(z.relatedTarget))||(o.value=!1,_("blur",z),d==null||d())},A=()=>{var z,N;(z=x.value)!=null&&z.contains(document.activeElement)&&x.value!==document.activeElement||(N=e.value)==null||N.focus()};return Wt(x,z=>{z&&z.setAttribute("tabindex","-1")}),yo(x,"focus",C,!0),yo(x,"blur",k,!0),yo(x,"click",A,!0),{isFocused:o,wrapperRef:x,handleFocus:C,handleBlur:k}}function Yb({afterComposition:e,emit:t}){const i=be(!1),a=x=>{t==null||t("compositionstart",x),i.value=!0},d=x=>{var o;t==null||t("compositionupdate",x);const C=(o=x.target)==null?void 0:o.value,k=C[C.length-1]||"";i.value=!SW(k)},m=x=>{t==null||t("compositionend",x),i.value&&(i.value=!1,Vn(()=>e(x)))};return{isComposing:i,handleComposition:x=>{x.type==="compositionend"?m(x):d(x)},handleCompositionStart:a,handleCompositionUpdate:d,handleCompositionEnd:m}}const S4=Symbol("emptyValuesContextKey"),Dq=["",void 0,null],Lq=void 0,em=ln({emptyValues:Array,valueOnClear:{type:[String,Number,Boolean,Function],default:void 0,validator:e=>Fn(e)?!e():!e}}),Xb=(e,t)=>{const i=Cr()?kn(S4,be({})):be({}),a=Q(()=>e.emptyValues||i.value.emptyValues||Dq),d=Q(()=>Fn(e.valueOnClear)?e.valueOnClear():e.valueOnClear!==void 0?e.valueOnClear:Fn(i.value.valueOnClear)?i.value.valueOnClear():i.value.valueOnClear!==void 0?i.value.valueOnClear:t!==void 0?t:Lq),m=_=>a.value.includes(_);return a.value.includes(d.value),{emptyValues:a,valueOnClear:d,isEmptyValue:m}},Oq=ln({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),qi=e=>dl(Oq,e),T4=Symbol(),lb=be();function Jb(e,t=void 0){const i=Cr()?kn(T4,lb):lb;return e?Q(()=>{var a,d;return(d=(a=i.value)==null?void 0:a[e])!=null?d:t}):i}function Qb(e,t){const i=Jb(),a=Jt(e,Q(()=>{var x;return((x=i.value)==null?void 0:x.namespace)||dv})),d=Gr(Q(()=>{var x;return(x=i.value)==null?void 0:x.locale})),m=Jp(Q(()=>{var x;return((x=i.value)==null?void 0:x.zIndex)||a4})),_=Q(()=>{var x;return y(t)||((x=i.value)==null?void 0:x.size)||""});return kC(Q(()=>y(i)||{})),{ns:a,locale:d,zIndex:m,size:_}}const kC=(e,t,i=!1)=>{var a;const d=!!Cr(),m=d?Jb():void 0,_=(a=t==null?void 0:t.provide)!=null?a:d?Br:void 0;if(!_)return;const x=Q(()=>{const o=y(e);return m!=null&&m.value?zq(m.value,o):o});return _(T4,x),_(GO,Q(()=>x.value.locale)),_(WO,Q(()=>x.value.namespace)),_(l4,Q(()=>x.value.zIndex)),_(x4,{size:Q(()=>x.value.size||"")}),_(S4,Q(()=>({emptyValues:x.value.emptyValues,valueOnClear:x.value.valueOnClear}))),(i||!lb.value)&&(lb.value=x.value),x},zq=(e,t)=>{const i=[...new Set([...Pp(e),...Pp(t)])],a={};for(const d of i)a[d]=t[d]!==void 0?t[d]:e[d];return a},Bq=ln({a11y:{type:Boolean,default:!0},locale:{type:at(Object)},size:Ei,button:{type:at(Object)},experimentalFeatures:{type:at(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:at(Object)},zIndex:Number,namespace:{type:String,default:"el"},...em}),ll={},Fq=Ge({name:"ElConfigProvider",props:Bq,setup(e,{slots:t}){Wt(()=>e.message,a=>{Object.assign(ll,a??{})},{immediate:!0,deep:!0});const i=kC(e);return()=>_t(t,"default",{config:i==null?void 0:i.value})}}),Nq=cr(Fq),$q="2.8.8",Vq=(e=[])=>({version:$q,install:(i,a)=>{i[bP]||(i[bP]=!0,e.forEach(d=>i.use(d)),a&&kC(a,i,!0))}}),Uq=ln({zIndex:{type:at([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),jq={scroll:({scrollTop:e,fixed:t})=>Wn(e)&&ko(t),[No]:e=>ko(e)};var hn=(e,t)=>{const i=e.__vccOpts||e;for(const[a,d]of t)i[a]=d;return i};const C4="ElAffix",Hq=Ge({name:C4}),Gq=Ge({...Hq,props:Uq,emits:jq,setup(e,{expose:t,emit:i}){const a=e,d=Jt("affix"),m=Uo(),_=Uo(),x=Uo(),{height:o}=IV(),{height:C,width:k,top:A,bottom:z,update:N}=LA(_,{windowScroll:!1}),$=LA(m),F=be(!1),G=be(0),U=be(0),te=Q(()=>({height:F.value?`${C.value}px`:"",width:F.value?`${k.value}px`:""})),Z=Q(()=>{if(!F.value)return{};const ie=a.offset?li(a.offset):0;return{height:`${C.value}px`,width:`${k.value}px`,top:a.position==="top"?ie:"",bottom:a.position==="bottom"?ie:"",transform:U.value?`translateY(${U.value}px)`:"",zIndex:a.zIndex}}),q=()=>{if(!x.value)return;G.value=x.value instanceof Window?document.documentElement.scrollTop:x.value.scrollTop||0;const{position:ie,target:de,offset:le}=a,pe=le+C.value;if(ie==="top")if(de){const ge=$.bottom.value-pe;F.value=le>A.value&&$.bottom.value>0,U.value=ge<0?ge:0}else F.value=le>A.value;else if(de){const ge=o.value-$.top.value-pe;F.value=o.value-le<z.value&&o.value>$.top.value,U.value=ge<0?-ge:0}else F.value=o.value-le<z.value},X=()=>{N(),i("scroll",{scrollTop:G.value,fixed:F.value})};return Wt(F,ie=>i("change",ie)),vr(()=>{var ie;a.target?(m.value=(ie=document.querySelector(a.target))!=null?ie:void 0,m.value||Ci(C4,`Target does not exist: ${a.target}`)):m.value=document.documentElement,x.value=eC(_.value,!0),N()}),yo(x,"scroll",X),ns(q),t({update:q,updateRoot:N}),(ie,de)=>(se(),Ae("div",{ref_key:"root",ref:_,class:ce(y(d).b()),style:Nn(y(te))},[Ve("div",{class:ce({[y(d).m("fixed")]:F.value}),style:Nn(y(Z))},[_t(ie.$slots,"default")],6)],6))}});var Wq=hn(Gq,[["__file","affix.vue"]]);const qq=cr(Wq),Kq=ln({size:{type:at([Number,String])},color:{type:String}}),Zq=Ge({name:"ElIcon",inheritAttrs:!1}),Yq=Ge({...Zq,props:Kq,setup(e){const t=e,i=Jt("icon"),a=Q(()=>{const{size:d,color:m}=t;return!d&&!m?{}:{fontSize:Bo(d)?void 0:li(d),"--color":m}});return(d,m)=>(se(),Ae("i",kr({class:y(i).b(),style:y(a)},d.$attrs),[_t(d.$slots,"default")],16))}});var Xq=hn(Yq,[["__file","icon.vue"]]);const Dn=cr(Xq),Jq=["light","dark"],Qq=ln({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:Pp(id),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:Jq,default:"light"}}),e7={close:e=>e instanceof MouseEvent},t7=Ge({name:"ElAlert"}),n7=Ge({...t7,props:Qq,emits:e7,setup(e,{emit:t}){const i=e,{Close:a}=aC,d=Ai(),m=Jt("alert"),_=be(!0),x=Q(()=>id[i.type]),o=Q(()=>[m.e("icon"),{[m.is("big")]:!!i.description||!!d.default}]),C=Q(()=>({"with-description":i.description||d.default})),k=A=>{_.value=!1,t("close",A)};return(A,z)=>(se(),It(Fi,{name:y(m).b("fade"),persisted:""},{default:st(()=>[mr(Ve("div",{class:ce([y(m).b(),y(m).m(A.type),y(m).is("center",A.center),y(m).is(A.effect)]),role:"alert"},[A.showIcon&&y(x)?(se(),It(y(Dn),{key:0,class:ce(y(o))},{default:st(()=>[(se(),It(Ir(y(x))))]),_:1},8,["class"])):bt("v-if",!0),Ve("div",{class:ce(y(m).e("content"))},[A.title||A.$slots.title?(se(),Ae("span",{key:0,class:ce([y(m).e("title"),y(C)])},[_t(A.$slots,"title",{},()=>[$r(fn(A.title),1)])],2)):bt("v-if",!0),A.$slots.default||A.description?(se(),Ae("p",{key:1,class:ce(y(m).e("description"))},[_t(A.$slots,"default",{},()=>[$r(fn(A.description),1)])],2)):bt("v-if",!0),A.closable?(se(),Ae(Bn,{key:2},[A.closeText?(se(),Ae("div",{key:0,class:ce([y(m).e("close-btn"),y(m).is("customed")]),onClick:k},fn(A.closeText),3)):(se(),It(y(Dn),{key:1,class:ce(y(m).e("close-btn")),onClick:k},{default:st(()=>[qe(y(a))]),_:1},8,["class"]))],64)):bt("v-if",!0)],2)],2),[[no,_.value]])]),_:3},8,["name"]))}});var r7=hn(n7,[["__file","alert.vue"]]);const o7=cr(r7),Fh=Symbol("formContextKey"),Xl=Symbol("formItemContextKey"),xi=(e,t={})=>{const i=be(void 0),a=t.prop?i:qO("size"),d=t.global?i:w4(),m=t.form?{size:void 0}:kn(Fh,void 0),_=t.formItem?{size:void 0}:kn(Xl,void 0);return Q(()=>a.value||y(e)||(_==null?void 0:_.size)||(m==null?void 0:m.size)||d.value||"")},ys=e=>{const t=qO("disabled"),i=kn(Fh,void 0);return Q(()=>t.value||y(e)||(i==null?void 0:i.disabled)||!1)},bs=()=>{const e=kn(Fh,void 0),t=kn(Xl,void 0);return{form:e,formItem:t}},Sl=(e,{formItemContext:t,disableIdGeneration:i,disableIdManagement:a})=>{i||(i=be(!1)),a||(a=be(!1));const d=be();let m;const _=Q(()=>{var x;return!!(!(e.label||e.ariaLabel)&&t&&t.inputIds&&((x=t.inputIds)==null?void 0:x.length)<=1)});return vr(()=>{m=Wt([fo(e,"id"),i],([x,o])=>{const C=x??(o?void 0:Wi().value);C!==d.value&&(t!=null&&t.removeInputId&&(d.value&&t.removeInputId(d.value),!(a!=null&&a.value)&&!o&&C&&t.addInputId(C)),d.value=C)},{immediate:!0})}),cd(()=>{m&&m(),t!=null&&t.removeInputId&&d.value&&t.removeInputId(d.value)}),{isLabeledByFormItem:_,inputId:d}},i7=ln({size:{type:String,values:tc},disabled:Boolean}),s7=ln({...i7,model:Object,rules:{type:at(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),a7={validate:(e,t,i)=>(on(e)||zn(e))&&ko(t)&&zn(i)};function l7(){const e=be([]),t=Q(()=>{if(!e.value.length)return"0";const m=Math.max(...e.value);return m?`${m}px`:""});function i(m){const _=e.value.indexOf(m);return _===-1&&t.value,_}function a(m,_){if(m&&_){const x=i(_);e.value.splice(x,1,m)}else m&&e.value.push(m)}function d(m){const _=i(m);_>-1&&e.value.splice(_,1)}return{autoLabelWidth:t,registerLabelWidth:a,deregisterLabelWidth:d}}const h0=(e,t)=>{const i=ms(t);return i.length>0?e.filter(a=>a.prop&&i.includes(a.prop)):e},c7="ElForm",u7=Ge({name:c7}),d7=Ge({...u7,props:s7,emits:a7,setup(e,{expose:t,emit:i}){const a=e,d=[],m=xi(),_=Jt("form"),x=Q(()=>{const{labelPosition:Z,inline:q}=a;return[_.b(),_.m(m.value||"default"),{[_.m(`label-${Z}`)]:Z,[_.m("inline")]:q}]}),o=Z=>d.find(q=>q.prop===Z),C=Z=>{d.push(Z)},k=Z=>{Z.prop&&d.splice(d.indexOf(Z),1)},A=(Z=[])=>{a.model&&h0(d,Z).forEach(q=>q.resetField())},z=(Z=[])=>{h0(d,Z).forEach(q=>q.clearValidate())},N=Q(()=>!!a.model),$=Z=>{if(d.length===0)return[];const q=h0(d,Z);return q.length?q:[]},F=async Z=>U(void 0,Z),G=async(Z=[])=>{if(!N.value)return!1;const q=$(Z);if(q.length===0)return!0;let X={};for(const ie of q)try{await ie.validate("")}catch(de){X={...X,...de}}return Object.keys(X).length===0?!0:Promise.reject(X)},U=async(Z=[],q)=>{const X=!Fn(q);try{const ie=await G(Z);return ie===!0&&await(q==null?void 0:q(ie)),ie}catch(ie){if(ie instanceof Error)throw ie;const de=ie;return a.scrollToError&&te(Object.keys(de)[0]),await(q==null?void 0:q(!1,de)),X&&Promise.reject(de)}},te=Z=>{var q;const X=h0(d,Z)[0];X&&((q=X.$el)==null||q.scrollIntoView(a.scrollIntoViewOptions))};return Wt(()=>a.rules,()=>{a.validateOnRuleChange&&F().catch(Z=>void 0)},{deep:!0}),Br(Fh,ao({...Bi(a),emit:i,resetFields:A,clearValidate:z,validateField:U,getField:o,addField:C,removeField:k,...l7()})),t({validate:F,validateField:U,resetFields:A,clearValidate:z,scrollToField:te,fields:d}),(Z,q)=>(se(),Ae("form",{class:ce(y(x))},[_t(Z.$slots,"default")],2))}});var h7=hn(d7,[["__file","form.vue"]]);function uh(){return uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},uh.apply(this,arguments)}function f7(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Lv(e,t)}function mS(e){return mS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},mS(e)}function Lv(e,t){return Lv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,d){return a.__proto__=d,a},Lv(e,t)}function p7(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function R0(e,t,i){return p7()?R0=Reflect.construct.bind():R0=function(d,m,_){var x=[null];x.push.apply(x,m);var o=Function.bind.apply(d,x),C=new o;return _&&Lv(C,_.prototype),C},R0.apply(null,arguments)}function m7(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function gS(e){var t=typeof Map=="function"?new Map:void 0;return gS=function(a){if(a===null||!m7(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(a))return t.get(a);t.set(a,d)}function d(){return R0(a,arguments,mS(this).constructor)}return d.prototype=Object.create(a.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),Lv(d,a)},gS(e)}var g7=/%[sdj%]/g,v7=function(){};function vS(e){if(!e||!e.length)return null;var t={};return e.forEach(function(i){var a=i.field;t[a]=t[a]||[],t[a].push(i)}),t}function fa(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];var d=0,m=i.length;if(typeof e=="function")return e.apply(null,i);if(typeof e=="string"){var _=e.replace(g7,function(x){if(x==="%%")return"%";if(d>=m)return x;switch(x){case"%s":return String(i[d++]);case"%d":return Number(i[d++]);case"%j":try{return JSON.stringify(i[d++])}catch{return"[Circular]"}break;default:return x}});return _}return e}function _7(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function Ni(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||_7(t)&&typeof e=="string"&&!e)}function y7(e,t,i){var a=[],d=0,m=e.length;function _(x){a.push.apply(a,x||[]),d++,d===m&&i(a)}e.forEach(function(x){t(x,_)})}function VP(e,t,i){var a=0,d=e.length;function m(_){if(_&&_.length){i(_);return}var x=a;a=a+1,x<d?t(e[x],m):i([])}m([])}function b7(e){var t=[];return Object.keys(e).forEach(function(i){t.push.apply(t,e[i]||[])}),t}var UP=function(e){f7(t,e);function t(i,a){var d;return d=e.call(this,"Async Validation Error")||this,d.errors=i,d.fields=a,d}return t}(gS(Error));function x7(e,t,i,a,d){if(t.first){var m=new Promise(function(z,N){var $=function(U){return a(U),U.length?N(new UP(U,vS(U))):z(d)},F=b7(e);VP(F,i,$)});return m.catch(function(z){return z}),m}var _=t.firstFields===!0?Object.keys(e):t.firstFields||[],x=Object.keys(e),o=x.length,C=0,k=[],A=new Promise(function(z,N){var $=function(G){if(k.push.apply(k,G),C++,C===o)return a(k),k.length?N(new UP(k,vS(k))):z(d)};x.length||(a(k),z(d)),x.forEach(function(F){var G=e[F];_.indexOf(F)!==-1?VP(G,i,$):y7(G,i,$)})});return A.catch(function(z){return z}),A}function w7(e){return!!(e&&e.message!==void 0)}function S7(e,t){for(var i=e,a=0;a<t.length;a++){if(i==null)return i;i=i[t[a]]}return i}function jP(e,t){return function(i){var a;return e.fullFields?a=S7(t,e.fullFields):a=t[i.field||e.fullField],w7(i)?(i.field=i.field||e.fullField,i.fieldValue=a,i):{message:typeof i=="function"?i():i,fieldValue:a,field:i.field||e.fullField}}}function HP(e,t){if(t){for(var i in t)if(t.hasOwnProperty(i)){var a=t[i];typeof a=="object"&&typeof e[i]=="object"?e[i]=uh({},e[i],a):e[i]=a}}return e}var E4=function(t,i,a,d,m,_){t.required&&(!a.hasOwnProperty(t.field)||Ni(i,_||t.type))&&d.push(fa(m.messages.required,t.fullField))},T7=function(t,i,a,d,m){(/^\s+$/.test(i)||i==="")&&d.push(fa(m.messages.whitespace,t.fullField))},f0,C7=function(){if(f0)return f0;var e="[a-fA-F\\d:]",t=function(q){return q&&q.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},i="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",a="[a-fA-F\\d]{1,4}",d=(`
(?:
(?:`+a+":){7}(?:"+a+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+a+":){6}(?:"+i+"|:"+a+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+a+":){5}(?::"+i+"|(?::"+a+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+a+":){4}(?:(?::"+a+"){0,1}:"+i+"|(?::"+a+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+a+":){3}(?:(?::"+a+"){0,2}:"+i+"|(?::"+a+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+a+":){2}(?:(?::"+a+"){0,3}:"+i+"|(?::"+a+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+a+":){1}(?:(?::"+a+"){0,4}:"+i+"|(?::"+a+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+a+"){0,5}:"+i+"|(?::"+a+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),m=new RegExp("(?:^"+i+"$)|(?:^"+d+"$)"),_=new RegExp("^"+i+"$"),x=new RegExp("^"+d+"$"),o=function(q){return q&&q.exact?m:new RegExp("(?:"+t(q)+i+t(q)+")|(?:"+t(q)+d+t(q)+")","g")};o.v4=function(Z){return Z&&Z.exact?_:new RegExp(""+t(Z)+i+t(Z),"g")},o.v6=function(Z){return Z&&Z.exact?x:new RegExp(""+t(Z)+d+t(Z),"g")};var C="(?:(?:[a-z]+:)?//)",k="(?:\\S+(?::\\S*)?@)?",A=o.v4().source,z=o.v6().source,N="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",$="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",F="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",G="(?::\\d{2,5})?",U='(?:[/?#][^\\s"]*)?',te="(?:"+C+"|www\\.)"+k+"(?:localhost|"+A+"|"+z+"|"+N+$+F+")"+G+U;return f0=new RegExp("(?:^"+te+"$)","i"),f0},GP={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},ev={integer:function(t){return ev.number(t)&&parseInt(t,10)===t},float:function(t){return ev.number(t)&&!ev.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!ev.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(GP.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(C7())},hex:function(t){return typeof t=="string"&&!!t.match(GP.hex)}},E7=function(t,i,a,d,m){if(t.required&&i===void 0){E4(t,i,a,d,m);return}var _=["integer","float","array","regexp","object","method","email","number","date","url","hex"],x=t.type;_.indexOf(x)>-1?ev[x](i)||d.push(fa(m.messages.types[x],t.fullField,t.type)):x&&typeof i!==t.type&&d.push(fa(m.messages.types[x],t.fullField,t.type))},M7=function(t,i,a,d,m){var _=typeof t.len=="number",x=typeof t.min=="number",o=typeof t.max=="number",C=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,k=i,A=null,z=typeof i=="number",N=typeof i=="string",$=Array.isArray(i);if(z?A="number":N?A="string":$&&(A="array"),!A)return!1;$&&(k=i.length),N&&(k=i.replace(C,"_").length),_?k!==t.len&&d.push(fa(m.messages[A].len,t.fullField,t.len)):x&&!o&&k<t.min?d.push(fa(m.messages[A].min,t.fullField,t.min)):o&&!x&&k>t.max?d.push(fa(m.messages[A].max,t.fullField,t.max)):x&&o&&(k<t.min||k>t.max)&&d.push(fa(m.messages[A].range,t.fullField,t.min,t.max))},tp="enum",I7=function(t,i,a,d,m){t[tp]=Array.isArray(t[tp])?t[tp]:[],t[tp].indexOf(i)===-1&&d.push(fa(m.messages[tp],t.fullField,t[tp].join(", ")))},k7=function(t,i,a,d,m){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(i)||d.push(fa(m.messages.pattern.mismatch,t.fullField,i,t.pattern));else if(typeof t.pattern=="string"){var _=new RegExp(t.pattern);_.test(i)||d.push(fa(m.messages.pattern.mismatch,t.fullField,i,t.pattern))}}},Ao={required:E4,whitespace:T7,type:E7,range:M7,enum:I7,pattern:k7},A7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(Ni(i,"string")&&!t.required)return a();Ao.required(t,i,d,_,m,"string"),Ni(i,"string")||(Ao.type(t,i,d,_,m),Ao.range(t,i,d,_,m),Ao.pattern(t,i,d,_,m),t.whitespace===!0&&Ao.whitespace(t,i,d,_,m))}a(_)},P7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(Ni(i)&&!t.required)return a();Ao.required(t,i,d,_,m),i!==void 0&&Ao.type(t,i,d,_,m)}a(_)},R7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(i===""&&(i=void 0),Ni(i)&&!t.required)return a();Ao.required(t,i,d,_,m),i!==void 0&&(Ao.type(t,i,d,_,m),Ao.range(t,i,d,_,m))}a(_)},D7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(Ni(i)&&!t.required)return a();Ao.required(t,i,d,_,m),i!==void 0&&Ao.type(t,i,d,_,m)}a(_)},L7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(Ni(i)&&!t.required)return a();Ao.required(t,i,d,_,m),Ni(i)||Ao.type(t,i,d,_,m)}a(_)},O7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(Ni(i)&&!t.required)return a();Ao.required(t,i,d,_,m),i!==void 0&&(Ao.type(t,i,d,_,m),Ao.range(t,i,d,_,m))}a(_)},z7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(Ni(i)&&!t.required)return a();Ao.required(t,i,d,_,m),i!==void 0&&(Ao.type(t,i,d,_,m),Ao.range(t,i,d,_,m))}a(_)},B7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(i==null&&!t.required)return a();Ao.required(t,i,d,_,m,"array"),i!=null&&(Ao.type(t,i,d,_,m),Ao.range(t,i,d,_,m))}a(_)},F7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(Ni(i)&&!t.required)return a();Ao.required(t,i,d,_,m),i!==void 0&&Ao.type(t,i,d,_,m)}a(_)},N7="enum",$7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(Ni(i)&&!t.required)return a();Ao.required(t,i,d,_,m),i!==void 0&&Ao[N7](t,i,d,_,m)}a(_)},V7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(Ni(i,"string")&&!t.required)return a();Ao.required(t,i,d,_,m),Ni(i,"string")||Ao.pattern(t,i,d,_,m)}a(_)},U7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(Ni(i,"date")&&!t.required)return a();if(Ao.required(t,i,d,_,m),!Ni(i,"date")){var o;i instanceof Date?o=i:o=new Date(i),Ao.type(t,o,d,_,m),o&&Ao.range(t,o.getTime(),d,_,m)}}a(_)},j7=function(t,i,a,d,m){var _=[],x=Array.isArray(i)?"array":typeof i;Ao.required(t,i,d,_,m,x),a(_)},_w=function(t,i,a,d,m){var _=t.type,x=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ni(i,_)&&!t.required)return a();Ao.required(t,i,d,x,m,_),Ni(i,_)||Ao.type(t,i,d,x,m)}a(x)},H7=function(t,i,a,d,m){var _=[],x=t.required||!t.required&&d.hasOwnProperty(t.field);if(x){if(Ni(i)&&!t.required)return a();Ao.required(t,i,d,_,m)}a(_)},pv={string:A7,method:P7,number:R7,boolean:D7,regexp:L7,integer:O7,float:z7,array:B7,object:F7,enum:$7,pattern:V7,date:U7,url:_w,hex:_w,email:_w,required:j7,any:H7};function _S(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var yS=_S(),l_=function(){function e(i){this.rules=null,this._messages=yS,this.define(i)}var t=e.prototype;return t.define=function(a){var d=this;if(!a)throw new Error("Cannot configure a schema with no rules");if(typeof a!="object"||Array.isArray(a))throw new Error("Rules must be an object");this.rules={},Object.keys(a).forEach(function(m){var _=a[m];d.rules[m]=Array.isArray(_)?_:[_]})},t.messages=function(a){return a&&(this._messages=HP(_S(),a)),this._messages},t.validate=function(a,d,m){var _=this;d===void 0&&(d={}),m===void 0&&(m=function(){});var x=a,o=d,C=m;if(typeof o=="function"&&(C=o,o={}),!this.rules||Object.keys(this.rules).length===0)return C&&C(null,x),Promise.resolve(x);function k(F){var G=[],U={};function te(q){if(Array.isArray(q)){var X;G=(X=G).concat.apply(X,q)}else G.push(q)}for(var Z=0;Z<F.length;Z++)te(F[Z]);G.length?(U=vS(G),C(G,U)):C(null,x)}if(o.messages){var A=this.messages();A===yS&&(A=_S()),HP(A,o.messages),o.messages=A}else o.messages=this.messages();var z={},N=o.keys||Object.keys(this.rules);N.forEach(function(F){var G=_.rules[F],U=x[F];G.forEach(function(te){var Z=te;typeof Z.transform=="function"&&(x===a&&(x=uh({},x)),U=x[F]=Z.transform(U)),typeof Z=="function"?Z={validator:Z}:Z=uh({},Z),Z.validator=_.getValidationMethod(Z),Z.validator&&(Z.field=F,Z.fullField=Z.fullField||F,Z.type=_.getType(Z),z[F]=z[F]||[],z[F].push({rule:Z,value:U,source:x,field:F}))})});var $={};return x7(z,o,function(F,G){var U=F.rule,te=(U.type==="object"||U.type==="array")&&(typeof U.fields=="object"||typeof U.defaultField=="object");te=te&&(U.required||!U.required&&F.value),U.field=F.field;function Z(ie,de){return uh({},de,{fullField:U.fullField+"."+ie,fullFields:U.fullFields?[].concat(U.fullFields,[ie]):[ie]})}function q(ie){ie===void 0&&(ie=[]);var de=Array.isArray(ie)?ie:[ie];!o.suppressWarning&&de.length&&e.warning("async-validator:",de),de.length&&U.message!==void 0&&(de=[].concat(U.message));var le=de.map(jP(U,x));if(o.first&&le.length)return $[U.field]=1,G(le);if(!te)G(le);else{if(U.required&&!F.value)return U.message!==void 0?le=[].concat(U.message).map(jP(U,x)):o.error&&(le=[o.error(U,fa(o.messages.required,U.field))]),G(le);var pe={};U.defaultField&&Object.keys(F.value).map(function(ue){pe[ue]=U.defaultField}),pe=uh({},pe,F.rule.fields);var ge={};Object.keys(pe).forEach(function(ue){var Re=pe[ue],Ye=Array.isArray(Re)?Re:[Re];ge[ue]=Ye.map(Z.bind(null,ue))});var he=new e(ge);he.messages(o.messages),F.rule.options&&(F.rule.options.messages=o.messages,F.rule.options.error=o.error),he.validate(F.value,F.rule.options||o,function(ue){var Re=[];le&&le.length&&Re.push.apply(Re,le),ue&&ue.length&&Re.push.apply(Re,ue),G(Re.length?Re:null)})}}var X;if(U.asyncValidator)X=U.asyncValidator(U,F.value,q,F.source,o);else if(U.validator){try{X=U.validator(U,F.value,q,F.source,o)}catch(ie){console.error==null||console.error(ie),o.suppressValidatorError||setTimeout(function(){throw ie},0),q(ie.message)}X===!0?q():X===!1?q(typeof U.message=="function"?U.message(U.fullField||U.field):U.message||(U.fullField||U.field)+" fails"):X instanceof Array?q(X):X instanceof Error&&q(X.message)}X&&X.then&&X.then(function(){return q()},function(ie){return q(ie)})},function(F){k(F)},x)},t.getType=function(a){if(a.type===void 0&&a.pattern instanceof RegExp&&(a.type="pattern"),typeof a.validator!="function"&&a.type&&!pv.hasOwnProperty(a.type))throw new Error(fa("Unknown rule type %s",a.type));return a.type||"string"},t.getValidationMethod=function(a){if(typeof a.validator=="function")return a.validator;var d=Object.keys(a),m=d.indexOf("message");return m!==-1&&d.splice(m,1),d.length===1&&d[0]==="required"?pv.required:pv[this.getType(a)]||void 0},e}();l_.register=function(t,i){if(typeof i!="function")throw new Error("Cannot register a validator by type, validator is not a function");pv[t]=i};l_.warning=v7;l_.messages=yS;l_.validators=pv;const G7=["","error","validating","success"],W7=ln({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:at([String,Array])},required:{type:Boolean,default:void 0},rules:{type:at([Object,Array])},error:String,validateStatus:{type:String,values:G7},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:tc}}),WP="ElLabelWrap";var q7=Ge({name:WP,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const i=kn(Fh,void 0),a=kn(Xl);a||Ci(WP,"usage: <el-form-item><label-wrap /></el-form-item>");const d=Jt("form"),m=be(),_=be(0),x=()=>{var k;if((k=m.value)!=null&&k.firstElementChild){const A=window.getComputedStyle(m.value.firstElementChild).width;return Math.ceil(Number.parseFloat(A))}else return 0},o=(k="update")=>{Vn(()=>{t.default&&e.isAutoWidth&&(k==="update"?_.value=x():k==="remove"&&(i==null||i.deregisterLabelWidth(_.value)))})},C=()=>o("update");return vr(()=>{C()}),Io(()=>{o("remove")}),Jl(()=>C()),Wt(_,(k,A)=>{e.updateAll&&(i==null||i.registerLabelWidth(k,A))}),qo(Q(()=>{var k,A;return(A=(k=m.value)==null?void 0:k.firstElementChild)!=null?A:null}),C),()=>{var k,A;if(!t)return null;const{isAutoWidth:z}=e;if(z){const N=i==null?void 0:i.autoLabelWidth,$=a==null?void 0:a.hasLabel,F={};if($&&N&&N!=="auto"){const G=Math.max(0,Number.parseInt(N,10)-_.value),te=(a.labelPosition||i.labelPosition)==="left"?"marginRight":"marginLeft";G&&(F[te]=`${G}px`)}return qe("div",{ref:m,class:[d.be("item","label-wrap")],style:F},[(k=t.default)==null?void 0:k.call(t)])}else return qe(Bn,{ref:m},[(A=t.default)==null?void 0:A.call(t)])}}});const K7=Ge({name:"ElFormItem"}),Z7=Ge({...K7,props:W7,setup(e,{expose:t}){const i=e,a=Ai(),d=kn(Fh,void 0),m=kn(Xl,void 0),_=xi(void 0,{formItem:!1}),x=Jt("form-item"),o=Wi().value,C=be([]),k=be(""),A=uV(k,100),z=be(""),N=be();let $,F=!1;const G=Q(()=>i.labelPosition||(d==null?void 0:d.labelPosition)),U=Q(()=>{if(G.value==="top")return{};const jt=li(i.labelWidth||(d==null?void 0:d.labelWidth)||"");return jt?{width:jt}:{}}),te=Q(()=>{if(G.value==="top"||d!=null&&d.inline)return{};if(!i.label&&!i.labelWidth&&ge)return{};const jt=li(i.labelWidth||(d==null?void 0:d.labelWidth)||"");return!i.label&&!a.label?{marginLeft:jt}:{}}),Z=Q(()=>[x.b(),x.m(_.value),x.is("error",k.value==="error"),x.is("validating",k.value==="validating"),x.is("success",k.value==="success"),x.is("required",Ie.value||i.required),x.is("no-asterisk",d==null?void 0:d.hideRequiredAsterisk),(d==null?void 0:d.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[x.m("feedback")]:d==null?void 0:d.statusIcon,[x.m(`label-${G.value}`)]:G.value}]),q=Q(()=>ko(i.inlineMessage)?i.inlineMessage:(d==null?void 0:d.inlineMessage)||!1),X=Q(()=>[x.e("error"),{[x.em("error","inline")]:q.value}]),ie=Q(()=>i.prop?zn(i.prop)?i.prop:i.prop.join("."):""),de=Q(()=>!!(i.label||a.label)),le=Q(()=>i.for||(C.value.length===1?C.value[0]:void 0)),pe=Q(()=>!le.value&&de.value),ge=!!m,he=Q(()=>{const jt=d==null?void 0:d.model;if(!(!jt||!i.prop))return A0(jt,i.prop).value}),ue=Q(()=>{const{required:jt}=i,Ht=[];i.rules&&Ht.push(...ms(i.rules));const Tn=d==null?void 0:d.rules;if(Tn&&i.prop){const Pe=A0(Tn,i.prop).value;Pe&&Ht.push(...ms(Pe))}if(jt!==void 0){const Pe=Ht.map((At,He)=>[At,He]).filter(([At])=>Object.keys(At).includes("required"));if(Pe.length>0)for(const[At,He]of Pe)At.required!==jt&&(Ht[He]={...At,required:jt});else Ht.push({required:jt})}return Ht}),Re=Q(()=>ue.value.length>0),Ye=jt=>ue.value.filter(Tn=>!Tn.trigger||!jt?!0:on(Tn.trigger)?Tn.trigger.includes(jt):Tn.trigger===jt).map(({trigger:Tn,...Pe})=>Pe),Ie=Q(()=>ue.value.some(jt=>jt.required)),fe=Q(()=>{var jt;return A.value==="error"&&i.showMessage&&((jt=d==null?void 0:d.showMessage)!=null?jt:!0)}),Me=Q(()=>`${i.label||""}${(d==null?void 0:d.labelSuffix)||""}`),Se=jt=>{k.value=jt},ye=jt=>{var Ht,Tn;const{errors:Pe,fields:At}=jt;(!Pe||!At)&&console.error(jt),Se("error"),z.value=Pe?(Tn=(Ht=Pe==null?void 0:Pe[0])==null?void 0:Ht.message)!=null?Tn:`${i.prop} is required`:"",d==null||d.emit("validate",i.prop,!1,z.value)},Ce=()=>{Se("success"),d==null||d.emit("validate",i.prop,!0,"")},Fe=async jt=>{const Ht=ie.value;return new l_({[Ht]:jt}).validate({[Ht]:he.value},{firstFields:!0}).then(()=>(Ce(),!0)).catch(Pe=>(ye(Pe),Promise.reject(Pe)))},it=async(jt,Ht)=>{if(F||!i.prop)return!1;const Tn=Fn(Ht);if(!Re.value)return Ht==null||Ht(!1),!1;const Pe=Ye(jt);return Pe.length===0?(Ht==null||Ht(!0),!0):(Se("validating"),Fe(Pe).then(()=>(Ht==null||Ht(!0),!0)).catch(At=>{const{fields:He}=At;return Ht==null||Ht(!1,He),Tn?!1:Promise.reject(He)}))},We=()=>{Se(""),z.value="",F=!1},ut=async()=>{const jt=d==null?void 0:d.model;if(!jt||!i.prop)return;const Ht=A0(jt,i.prop);F=!0,Ht.value=hP($),await Vn(),We(),F=!1},Lt=jt=>{C.value.includes(jt)||C.value.push(jt)},Ft=jt=>{C.value=C.value.filter(Ht=>Ht!==jt)};Wt(()=>i.error,jt=>{z.value=jt||"",Se(jt?"error":"")},{immediate:!0}),Wt(()=>i.validateStatus,jt=>Se(jt||""));const mt=ao({...Bi(i),$el:N,size:_,validateState:k,labelId:o,inputIds:C,isGroup:pe,hasLabel:de,fieldValue:he,addInputId:Lt,removeInputId:Ft,resetField:ut,clearValidate:We,validate:it});return Br(Xl,mt),vr(()=>{i.prop&&(d==null||d.addField(mt),$=hP(he.value))}),Io(()=>{d==null||d.removeField(mt)}),t({size:_,validateMessage:z,validateState:k,validate:it,clearValidate:We,resetField:ut}),(jt,Ht)=>{var Tn;return se(),Ae("div",{ref_key:"formItemRef",ref:N,class:ce(y(Z)),role:y(pe)?"group":void 0,"aria-labelledby":y(pe)?y(o):void 0},[qe(y(q7),{"is-auto-width":y(U).width==="auto","update-all":((Tn=y(d))==null?void 0:Tn.labelWidth)==="auto"},{default:st(()=>[y(de)?(se(),It(Ir(y(le)?"label":"div"),{key:0,id:y(o),for:y(le),class:ce(y(x).e("label")),style:Nn(y(U))},{default:st(()=>[_t(jt.$slots,"label",{label:y(Me)},()=>[$r(fn(y(Me)),1)])]),_:3},8,["id","for","class","style"])):bt("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),Ve("div",{class:ce(y(x).e("content")),style:Nn(y(te))},[_t(jt.$slots,"default"),qe(DL,{name:`${y(x).namespace.value}-zoom-in-top`},{default:st(()=>[y(fe)?_t(jt.$slots,"error",{key:0,error:z.value},()=>[Ve("div",{class:ce(y(X))},fn(z.value),3)]):bt("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}});var M4=hn(Z7,[["__file","form-item.vue"]]);const Y7=cr(h7,{FormItem:M4}),X7=Jo(M4);let sl;const J7=`
  height:0 !important;
  visibility:hidden !important;
  ${zT()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,Q7=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function eK(e){const t=window.getComputedStyle(e),i=t.getPropertyValue("box-sizing"),a=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),d=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:Q7.map(_=>`${_}:${t.getPropertyValue(_)}`).join(";"),paddingSize:a,borderSize:d,boxSizing:i}}function qP(e,t=1,i){var a;sl||(sl=document.createElement("textarea"),document.body.appendChild(sl));const{paddingSize:d,borderSize:m,boxSizing:_,contextStyle:x}=eK(e);sl.setAttribute("style",`${x};${J7}`),sl.value=e.value||e.placeholder||"";let o=sl.scrollHeight;const C={};_==="border-box"?o=o+m:_==="content-box"&&(o=o-d),sl.value="";const k=sl.scrollHeight-d;if(Wn(t)){let A=k*t;_==="border-box"&&(A=A+d+m),o=Math.max(A,o),C.minHeight=`${A}px`}if(Wn(i)){let A=k*i;_==="border-box"&&(A=A+d+m),o=Math.min(A,o)}return C.height=`${o}px`,(a=sl.parentNode)==null||a.removeChild(sl),sl=void 0,C}const AC=ln({id:{type:String,default:void 0},size:Ei,disabled:Boolean,modelValue:{type:at([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:at([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:Boolean,clearable:Boolean,showPassword:Boolean,showWordLimit:Boolean,suffixIcon:{type:wo},prefixIcon:{type:wo},containerRole:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:at([Object,Array,String]),default:()=>Xo({})},autofocus:Boolean,rows:{type:Number,default:2},...qi(["ariaLabel"])}),tK={[xr]:e=>zn(e),input:e=>zn(e),change:e=>zn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,mouseleave:e=>e instanceof MouseEvent,mouseenter:e=>e instanceof MouseEvent,keydown:e=>e instanceof Event,compositionstart:e=>e instanceof CompositionEvent,compositionupdate:e=>e instanceof CompositionEvent,compositionend:e=>e instanceof CompositionEvent},nK=Ge({name:"ElInput",inheritAttrs:!1}),rK=Ge({...nK,props:AC,emits:tK,setup(e,{expose:t,emit:i}){const a=e,d=Dh(),m=Gb(),_=Ai(),x=Q(()=>[a.type==="textarea"?F.b():$.b(),$.m(z.value),$.is("disabled",N.value),$.is("exceed",it.value),{[$.b("group")]:_.prepend||_.append,[$.m("prefix")]:_.prefix||a.prefixIcon,[$.m("suffix")]:_.suffix||a.suffixIcon||a.clearable||a.showPassword,[$.bm("suffix","password-clear")]:Se.value&&ye.value,[$.b("hidden")]:a.type==="hidden"},d.class]),o=Q(()=>[$.e("wrapper"),$.is("focus",le.value)]),{form:C,formItem:k}=bs(),{inputId:A}=Sl(a,{formItemContext:k}),z=xi(),N=ys(),$=Jt("input"),F=Jt("textarea"),G=Uo(),U=Uo(),te=be(!1),Z=be(!1),q=be(),X=Uo(a.inputStyle),ie=Q(()=>G.value||U.value),{wrapperRef:de,isFocused:le,handleFocus:pe,handleBlur:ge}=Bh(ie,{beforeFocus(){return N.value},afterBlur(){var Ot;a.validateEvent&&((Ot=k==null?void 0:k.validate)==null||Ot.call(k,"blur").catch(Zt=>void 0))}}),he=Q(()=>{var Ot;return(Ot=C==null?void 0:C.statusIcon)!=null?Ot:!1}),ue=Q(()=>(k==null?void 0:k.validateState)||""),Re=Q(()=>ue.value&&lC[ue.value]),Ye=Q(()=>Z.value?dW:OG),Ie=Q(()=>[d.style]),fe=Q(()=>[a.inputStyle,X.value,{resize:a.resize}]),Me=Q(()=>ki(a.modelValue)?"":String(a.modelValue)),Se=Q(()=>a.clearable&&!N.value&&!a.readonly&&!!Me.value&&(le.value||te.value)),ye=Q(()=>a.showPassword&&!N.value&&!!Me.value&&(!!Me.value||le.value)),Ce=Q(()=>a.showWordLimit&&!!a.maxlength&&(a.type==="text"||a.type==="textarea")&&!N.value&&!a.readonly&&!a.showPassword),Fe=Q(()=>Me.value.length),it=Q(()=>!!Ce.value&&Fe.value>Number(a.maxlength)),We=Q(()=>!!_.suffix||!!a.suffixIcon||Se.value||a.showPassword||Ce.value||!!ue.value&&he.value),[ut,Lt]=Pq(G);qo(U,Ot=>{if(jt(),!Ce.value||a.resize!=="both")return;const Zt=Ot[0],{width:jn}=Zt.contentRect;q.value={right:`calc(100% - ${jn+15+6}px)`}});const Ft=()=>{const{type:Ot,autosize:Zt}=a;if(!(!Hr||Ot!=="textarea"||!U.value))if(Zt){const jn=Tr(Zt)?Zt.minRows:void 0,ir=Tr(Zt)?Zt.maxRows:void 0,ur=qP(U.value,jn,ir);X.value={overflowY:"hidden",...ur},Vn(()=>{U.value.offsetHeight,X.value=ur})}else X.value={minHeight:qP(U.value).minHeight}},jt=(Ot=>{let Zt=!1;return()=>{var jn;if(Zt||!a.autosize)return;((jn=U.value)==null?void 0:jn.offsetParent)===null||(Ot(),Zt=!0)}})(Ft),Ht=()=>{const Ot=ie.value,Zt=a.formatter?a.formatter(Me.value):Me.value;!Ot||Ot.value===Zt||(Ot.value=Zt)},Tn=async Ot=>{ut();let{value:Zt}=Ot.target;if(a.formatter&&(Zt=a.parser?a.parser(Zt):Zt),!At.value){if(Zt===Me.value){Ht();return}i(xr,Zt),i("input",Zt),await Vn(),Ht(),Lt()}},Pe=Ot=>{i("change",Ot.target.value)},{isComposing:At,handleCompositionStart:He,handleCompositionUpdate:pt,handleCompositionEnd:et}=Yb({emit:i,afterComposition:Tn}),rn=()=>{Z.value=!Z.value,kt()},kt=async()=>{var Ot;await Vn(),(Ot=ie.value)==null||Ot.focus()},zt=()=>{var Ot;return(Ot=ie.value)==null?void 0:Ot.blur()},Mt=Ot=>{te.value=!1,i("mouseleave",Ot)},en=Ot=>{te.value=!0,i("mouseenter",Ot)},sn=Ot=>{i("keydown",Ot)},dn=()=>{var Ot;(Ot=ie.value)==null||Ot.select()},Pn=()=>{i(xr,""),i("change",""),i("clear"),i("input","")};return Wt(()=>a.modelValue,()=>{var Ot;Vn(()=>Ft()),a.validateEvent&&((Ot=k==null?void 0:k.validate)==null||Ot.call(k,"change").catch(Zt=>void 0))}),Wt(Me,()=>Ht()),Wt(()=>a.type,async()=>{await Vn(),Ht(),Ft()}),vr(()=>{!a.formatter&&a.parser,Ht(),Vn(Ft)}),t({input:G,textarea:U,ref:ie,textareaStyle:fe,autosize:fo(a,"autosize"),isComposing:At,focus:kt,blur:zt,select:dn,clear:Pn,resizeTextarea:Ft}),(Ot,Zt)=>(se(),Ae("div",{class:ce([y(x),{[y($).bm("group","append")]:Ot.$slots.append,[y($).bm("group","prepend")]:Ot.$slots.prepend}]),style:Nn(y(Ie)),onMouseenter:en,onMouseleave:Mt},[bt(" input "),Ot.type!=="textarea"?(se(),Ae(Bn,{key:0},[bt(" prepend slot "),Ot.$slots.prepend?(se(),Ae("div",{key:0,class:ce(y($).be("group","prepend"))},[_t(Ot.$slots,"prepend")],2)):bt("v-if",!0),Ve("div",{ref_key:"wrapperRef",ref:de,class:ce(y(o))},[bt(" prefix slot "),Ot.$slots.prefix||Ot.prefixIcon?(se(),Ae("span",{key:0,class:ce(y($).e("prefix"))},[Ve("span",{class:ce(y($).e("prefix-inner"))},[_t(Ot.$slots,"prefix"),Ot.prefixIcon?(se(),It(y(Dn),{key:0,class:ce(y($).e("icon"))},{default:st(()=>[(se(),It(Ir(Ot.prefixIcon)))]),_:1},8,["class"])):bt("v-if",!0)],2)],2)):bt("v-if",!0),Ve("input",kr({id:y(A),ref_key:"input",ref:G,class:y($).e("inner")},y(m),{minlength:Ot.minlength,maxlength:Ot.maxlength,type:Ot.showPassword?Z.value?"text":"password":Ot.type,disabled:y(N),readonly:Ot.readonly,autocomplete:Ot.autocomplete,tabindex:Ot.tabindex,"aria-label":Ot.ariaLabel,placeholder:Ot.placeholder,style:Ot.inputStyle,form:Ot.form,autofocus:Ot.autofocus,role:Ot.containerRole,onCompositionstart:y(He),onCompositionupdate:y(pt),onCompositionend:y(et),onInput:Tn,onChange:Pe,onKeydown:sn}),null,16,["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus","role","onCompositionstart","onCompositionupdate","onCompositionend"]),bt(" suffix slot "),y(We)?(se(),Ae("span",{key:1,class:ce(y($).e("suffix"))},[Ve("span",{class:ce(y($).e("suffix-inner"))},[!y(Se)||!y(ye)||!y(Ce)?(se(),Ae(Bn,{key:0},[_t(Ot.$slots,"suffix"),Ot.suffixIcon?(se(),It(y(Dn),{key:0,class:ce(y($).e("icon"))},{default:st(()=>[(se(),It(Ir(Ot.suffixIcon)))]),_:1},8,["class"])):bt("v-if",!0)],64)):bt("v-if",!0),y(Se)?(se(),It(y(Dn),{key:1,class:ce([y($).e("icon"),y($).e("clear")]),onMousedown:Yn(y(_o),["prevent"]),onClick:Pn},{default:st(()=>[qe(y(dd))]),_:1},8,["class","onMousedown"])):bt("v-if",!0),y(ye)?(se(),It(y(Dn),{key:2,class:ce([y($).e("icon"),y($).e("password")]),onClick:rn},{default:st(()=>[(se(),It(Ir(y(Ye))))]),_:1},8,["class"])):bt("v-if",!0),y(Ce)?(se(),Ae("span",{key:3,class:ce(y($).e("count"))},[Ve("span",{class:ce(y($).e("count-inner"))},fn(y(Fe))+" / "+fn(Ot.maxlength),3)],2)):bt("v-if",!0),y(ue)&&y(Re)&&y(he)?(se(),It(y(Dn),{key:4,class:ce([y($).e("icon"),y($).e("validateIcon"),y($).is("loading",y(ue)==="validating")])},{default:st(()=>[(se(),It(Ir(y(Re))))]),_:1},8,["class"])):bt("v-if",!0)],2)],2)):bt("v-if",!0)],2),bt(" append slot "),Ot.$slots.append?(se(),Ae("div",{key:1,class:ce(y($).be("group","append"))},[_t(Ot.$slots,"append")],2)):bt("v-if",!0)],64)):(se(),Ae(Bn,{key:1},[bt(" textarea "),Ve("textarea",kr({id:y(A),ref_key:"textarea",ref:U,class:[y(F).e("inner"),y($).is("focus",y(le))]},y(m),{minlength:Ot.minlength,maxlength:Ot.maxlength,tabindex:Ot.tabindex,disabled:y(N),readonly:Ot.readonly,autocomplete:Ot.autocomplete,style:y(fe),"aria-label":Ot.ariaLabel,placeholder:Ot.placeholder,form:Ot.form,autofocus:Ot.autofocus,rows:Ot.rows,role:Ot.containerRole,onCompositionstart:y(He),onCompositionupdate:y(pt),onCompositionend:y(et),onInput:Tn,onFocus:y(pe),onBlur:y(ge),onChange:Pe,onKeydown:sn}),null,16,["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus","rows","role","onCompositionstart","onCompositionupdate","onCompositionend","onFocus","onBlur"]),y(Ce)?(se(),Ae("span",{key:0,style:Nn(q.value),class:ce(y($).e("count"))},fn(y(Fe))+" / "+fn(Ot.maxlength),7)):bt("v-if",!0)],64))],38))}});var oK=hn(rK,[["__file","input.vue"]]);const vs=cr(oK),np=4,I4={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},iK=({move:e,size:t,bar:i})=>({[i.size]:t,transform:`translate${i.axis}(${e}%)`}),PC=Symbol("scrollbarContextKey"),sK=ln({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),aK="Thumb",lK=Ge({__name:"thumb",props:sK,setup(e){const t=e,i=kn(PC),a=Jt("scrollbar");i||Ci(aK,"can not inject scrollbar context");const d=be(),m=be(),_=be({}),x=be(!1);let o=!1,C=!1,k=Hr?document.onselectstart:null;const A=Q(()=>I4[t.vertical?"vertical":"horizontal"]),z=Q(()=>iK({size:t.size,move:t.move,bar:A.value})),N=Q(()=>d.value[A.value.offset]**2/i.wrapElement[A.value.scrollSize]/t.ratio/m.value[A.value.offset]),$=ie=>{var de;if(ie.stopPropagation(),ie.ctrlKey||[1,2].includes(ie.button))return;(de=window.getSelection())==null||de.removeAllRanges(),G(ie);const le=ie.currentTarget;le&&(_.value[A.value.axis]=le[A.value.offset]-(ie[A.value.client]-le.getBoundingClientRect()[A.value.direction]))},F=ie=>{if(!m.value||!d.value||!i.wrapElement)return;const de=Math.abs(ie.target.getBoundingClientRect()[A.value.direction]-ie[A.value.client]),le=m.value[A.value.offset]/2,pe=(de-le)*100*N.value/d.value[A.value.offset];i.wrapElement[A.value.scroll]=pe*i.wrapElement[A.value.scrollSize]/100},G=ie=>{ie.stopImmediatePropagation(),o=!0,document.addEventListener("mousemove",U),document.addEventListener("mouseup",te),k=document.onselectstart,document.onselectstart=()=>!1},U=ie=>{if(!d.value||!m.value||o===!1)return;const de=_.value[A.value.axis];if(!de)return;const le=(d.value.getBoundingClientRect()[A.value.direction]-ie[A.value.client])*-1,pe=m.value[A.value.offset]-de,ge=(le-pe)*100*N.value/d.value[A.value.offset];i.wrapElement[A.value.scroll]=ge*i.wrapElement[A.value.scrollSize]/100},te=()=>{o=!1,_.value[A.value.axis]=0,document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",te),X(),C&&(x.value=!1)},Z=()=>{C=!1,x.value=!!t.size},q=()=>{C=!0,x.value=o};Io(()=>{X(),document.removeEventListener("mouseup",te)});const X=()=>{document.onselectstart!==k&&(document.onselectstart=k)};return yo(fo(i,"scrollbarElement"),"mousemove",Z),yo(fo(i,"scrollbarElement"),"mouseleave",q),(ie,de)=>(se(),It(Fi,{name:y(a).b("fade"),persisted:""},{default:st(()=>[mr(Ve("div",{ref_key:"instance",ref:d,class:ce([y(a).e("bar"),y(a).is(y(A).key)]),onMousedown:F},[Ve("div",{ref_key:"thumb",ref:m,class:ce(y(a).e("thumb")),style:Nn(y(z)),onMousedown:$},null,38)],34),[[no,ie.always||x.value]])]),_:1},8,["name"]))}});var KP=hn(lK,[["__file","thumb.vue"]]);const cK=ln({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),uK=Ge({__name:"bar",props:cK,setup(e,{expose:t}){const i=e,a=kn(PC),d=be(0),m=be(0),_=be(""),x=be(""),o=be(1),C=be(1);return t({handleScroll:z=>{if(z){const N=z.offsetHeight-np,$=z.offsetWidth-np;m.value=z.scrollTop*100/N*o.value,d.value=z.scrollLeft*100/$*C.value}},update:()=>{const z=a==null?void 0:a.wrapElement;if(!z)return;const N=z.offsetHeight-np,$=z.offsetWidth-np,F=N**2/z.scrollHeight,G=$**2/z.scrollWidth,U=Math.max(F,i.minSize),te=Math.max(G,i.minSize);o.value=F/(N-F)/(U/(N-U)),C.value=G/($-G)/(te/($-te)),x.value=U+np<N?`${U}px`:"",_.value=te+np<$?`${te}px`:""}}),(z,N)=>(se(),Ae(Bn,null,[qe(KP,{move:d.value,ratio:C.value,size:_.value,always:z.always},null,8,["move","ratio","size","always"]),qe(KP,{move:m.value,ratio:o.value,size:x.value,vertical:"",always:z.always},null,8,["move","ratio","size","always"])],64))}});var dK=hn(uK,[["__file","bar.vue"]]);const hK=ln({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:at([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},tabindex:{type:[String,Number],default:void 0},id:String,role:String,...qi(["ariaLabel","ariaOrientation"])}),fK={scroll:({scrollTop:e,scrollLeft:t})=>[e,t].every(Wn)},pK="ElScrollbar",mK=Ge({name:pK}),gK=Ge({...mK,props:hK,emits:fK,setup(e,{expose:t,emit:i}){const a=e,d=Jt("scrollbar");let m,_,x=0,o=0;const C=be(),k=be(),A=be(),z=be(),N=Q(()=>{const X={};return a.height&&(X.height=li(a.height)),a.maxHeight&&(X.maxHeight=li(a.maxHeight)),[a.wrapStyle,X]}),$=Q(()=>[a.wrapClass,d.e("wrap"),{[d.em("wrap","hidden-default")]:!a.native}]),F=Q(()=>[d.e("view"),a.viewClass]),G=()=>{var X;k.value&&((X=z.value)==null||X.handleScroll(k.value),x=k.value.scrollTop,o=k.value.scrollLeft,i("scroll",{scrollTop:k.value.scrollTop,scrollLeft:k.value.scrollLeft}))};function U(X,ie){Tr(X)?k.value.scrollTo(X):Wn(X)&&Wn(ie)&&k.value.scrollTo(X,ie)}const te=X=>{Wn(X)&&(k.value.scrollTop=X)},Z=X=>{Wn(X)&&(k.value.scrollLeft=X)},q=()=>{var X;(X=z.value)==null||X.update()};return Wt(()=>a.noresize,X=>{X?(m==null||m(),_==null||_()):({stop:m}=qo(A,q),_=yo("resize",q))},{immediate:!0}),Wt(()=>[a.maxHeight,a.height],()=>{a.native||Vn(()=>{var X;q(),k.value&&((X=z.value)==null||X.handleScroll(k.value))})}),Br(PC,ao({scrollbarElement:C,wrapElement:k})),CT(()=>{k.value&&(k.value.scrollTop=x,k.value.scrollLeft=o)}),vr(()=>{a.native||Vn(()=>{q()})}),Jl(()=>q()),t({wrapRef:k,update:q,scrollTo:U,setScrollTop:te,setScrollLeft:Z,handleScroll:G}),(X,ie)=>(se(),Ae("div",{ref_key:"scrollbarRef",ref:C,class:ce(y(d).b())},[Ve("div",{ref_key:"wrapRef",ref:k,class:ce(y($)),style:Nn(y(N)),tabindex:X.tabindex,onScroll:G},[(se(),It(Ir(X.tag),{id:X.id,ref_key:"resizeRef",ref:A,class:ce(y(F)),style:Nn(X.viewStyle),role:X.role,"aria-label":X.ariaLabel,"aria-orientation":X.ariaOrientation},{default:st(()=>[_t(X.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],46,["tabindex"]),X.native?bt("v-if",!0):(se(),It(dK,{key:0,ref_key:"barRef",ref:z,always:X.always,"min-size":X.minSize},null,8,["always","min-size"]))],2))}});var vK=hn(gK,[["__file","scrollbar.vue"]]);const rc=cr(vK),RC=Symbol("popper"),k4=Symbol("popperContent"),_K=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],A4=ln({role:{type:String,values:_K,default:"tooltip"}}),yK=Ge({name:"ElPopper",inheritAttrs:!1}),bK=Ge({...yK,props:A4,setup(e,{expose:t}){const i=e,a=be(),d=be(),m=be(),_=be(),x=Q(()=>i.role),o={triggerRef:a,popperInstanceRef:d,contentRef:m,referenceRef:_,role:x};return t(o),Br(RC,o),(C,k)=>_t(C.$slots,"default")}});var xK=hn(bK,[["__file","popper.vue"]]);const P4=ln({arrowOffset:{type:Number,default:5}}),wK=Ge({name:"ElPopperArrow",inheritAttrs:!1}),SK=Ge({...wK,props:P4,setup(e,{expose:t}){const i=e,a=Jt("popper"),{arrowOffset:d,arrowRef:m,arrowStyle:_}=kn(k4,void 0);return Wt(()=>i.arrowOffset,x=>{d.value=x}),Io(()=>{m.value=void 0}),t({arrowRef:m}),(x,o)=>(se(),Ae("span",{ref_key:"arrowRef",ref:m,class:ce(y(a).e("arrow")),style:Nn(y(_)),"data-popper-arrow":""},null,6))}});var TK=hn(SK,[["__file","arrow.vue"]]);const CK="ElOnlyChild",R4=Ge({name:CK,setup(e,{slots:t,attrs:i}){var a;const d=kn(s4),m=q9((a=d==null?void 0:d.setForwardRef)!=null?a:_o);return()=>{var _;const x=(_=t.default)==null?void 0:_.call(t,i);if(!x||x.length>1)return null;const o=D4(x);return o?mr(Ac(o,i),[[m]]):null}}});function D4(e){if(!e)return null;const t=e;for(const i of t){if(Tr(i))switch(i.type){case Oi:continue;case qp:case"svg":return ZP(i);case Bn:return D4(i.children);default:return i}return ZP(i)}return null}function ZP(e){const t=Jt("only-child");return qe("span",{class:t.e("content")},[e])}const L4=ln({virtualRef:{type:at(Object)},virtualTriggering:Boolean,onMouseenter:{type:at(Function)},onMouseleave:{type:at(Function)},onClick:{type:at(Function)},onKeydown:{type:at(Function)},onFocus:{type:at(Function)},onBlur:{type:at(Function)},onContextmenu:{type:at(Function)},id:String,open:Boolean}),EK=Ge({name:"ElPopperTrigger",inheritAttrs:!1}),MK=Ge({...EK,props:L4,setup(e,{expose:t}){const i=e,{role:a,triggerRef:d}=kn(RC,void 0);W9(d);const m=Q(()=>x.value?i.id:void 0),_=Q(()=>{if(a&&a.value==="tooltip")return i.open&&i.id?i.id:void 0}),x=Q(()=>{if(a&&a.value!=="tooltip")return a.value}),o=Q(()=>x.value?`${i.open}`:void 0);let C;const k=["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"];return vr(()=>{Wt(()=>i.virtualRef,A=>{A&&(d.value=Ls(A))},{immediate:!0}),Wt(d,(A,z)=>{C==null||C(),C=void 0,ga(A)&&(k.forEach(N=>{var $;const F=i[N];F&&(A.addEventListener(N.slice(2).toLowerCase(),F),($=z==null?void 0:z.removeEventListener)==null||$.call(z,N.slice(2).toLowerCase(),F))}),Qw(A)&&(C=Wt([m,_,x,o],N=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(($,F)=>{ki(N[F])?A.removeAttribute($):A.setAttribute($,N[F])})},{immediate:!0}))),ga(z)&&Qw(z)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(N=>z.removeAttribute(N))},{immediate:!0})}),Io(()=>{if(C==null||C(),C=void 0,d.value&&ga(d.value)){const A=d.value;k.forEach(z=>{const N=i[z];N&&A.removeEventListener(z.slice(2).toLowerCase(),N)}),d.value=void 0}}),t({triggerRef:d}),(A,z)=>A.virtualTriggering?bt("v-if",!0):(se(),It(y(R4),kr({key:0},A.$attrs,{"aria-controls":y(m),"aria-describedby":y(_),"aria-expanded":y(o),"aria-haspopup":y(x)}),{default:st(()=>[_t(A.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var IK=hn(MK,[["__file","trigger.vue"]]);const yw="focus-trap.focus-after-trapped",bw="focus-trap.focus-after-released",kK="focus-trap.focusout-prevented",YP={cancelable:!0,bubbles:!1},AK={cancelable:!0,bubbles:!1},XP="focusAfterTrapped",JP="focusAfterReleased",DC=Symbol("elFocusTrap"),LC=be(),e1=be(0),OC=be(0);let p0=0;const O4=e=>{const t=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const d=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||d?NodeFilter.FILTER_SKIP:a.tabIndex>=0||a===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)t.push(i.currentNode);return t},QP=(e,t)=>{for(const i of e)if(!PK(i,t))return i},PK=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},RK=e=>{const t=O4(e),i=QP(t,e),a=QP(t.reverse(),e);return[i,a]},DK=e=>e instanceof HTMLInputElement&&"select"in e,zu=(e,t)=>{if(e&&e.focus){const i=document.activeElement;e.focus({preventScroll:!0}),OC.value=window.performance.now(),e!==i&&DK(e)&&t&&e.select()}};function eR(e,t){const i=[...e],a=e.indexOf(t);return a!==-1&&i.splice(a,1),i}const LK=()=>{let e=[];return{push:a=>{const d=e[0];d&&a!==d&&d.pause(),e=eR(e,a),e.unshift(a)},remove:a=>{var d,m;e=eR(e,a),(m=(d=e[0])==null?void 0:d.resume)==null||m.call(d)}}},OK=(e,t=!1)=>{const i=document.activeElement;for(const a of e)if(zu(a,t),document.activeElement!==i)return},tR=LK(),zK=()=>e1.value>OC.value,m0=()=>{LC.value="pointer",e1.value=window.performance.now()},nR=()=>{LC.value="keyboard",e1.value=window.performance.now()},BK=()=>(vr(()=>{p0===0&&(document.addEventListener("mousedown",m0),document.addEventListener("touchstart",m0),document.addEventListener("keydown",nR)),p0++}),Io(()=>{p0--,p0<=0&&(document.removeEventListener("mousedown",m0),document.removeEventListener("touchstart",m0),document.removeEventListener("keydown",nR))}),{focusReason:LC,lastUserFocusTimestamp:e1,lastAutomatedFocusTimestamp:OC}),g0=e=>new CustomEvent(kK,{...AK,detail:e}),FK=Ge({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[XP,JP,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const i=be();let a,d;const{focusReason:m}=BK();V9($=>{e.trapped&&!_.paused&&t("release-requested",$)});const _={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},x=$=>{if(!e.loop&&!e.trapped||_.paused)return;const{code:F,altKey:G,ctrlKey:U,metaKey:te,currentTarget:Z,shiftKey:q}=$,{loop:X}=e,ie=F===En.tab&&!G&&!U&&!te,de=document.activeElement;if(ie&&de){const le=Z,[pe,ge]=RK(le);if(pe&&ge){if(!q&&de===ge){const ue=g0({focusReason:m.value});t("focusout-prevented",ue),ue.defaultPrevented||($.preventDefault(),X&&zu(pe,!0))}else if(q&&[pe,le].includes(de)){const ue=g0({focusReason:m.value});t("focusout-prevented",ue),ue.defaultPrevented||($.preventDefault(),X&&zu(ge,!0))}}else if(de===le){const ue=g0({focusReason:m.value});t("focusout-prevented",ue),ue.defaultPrevented||$.preventDefault()}}};Br(DC,{focusTrapRef:i,onKeydown:x}),Wt(()=>e.focusTrapEl,$=>{$&&(i.value=$)},{immediate:!0}),Wt([i],([$],[F])=>{$&&($.addEventListener("keydown",x),$.addEventListener("focusin",k),$.addEventListener("focusout",A)),F&&(F.removeEventListener("keydown",x),F.removeEventListener("focusin",k),F.removeEventListener("focusout",A))});const o=$=>{t(XP,$)},C=$=>t(JP,$),k=$=>{const F=y(i);if(!F)return;const G=$.target,U=$.relatedTarget,te=G&&F.contains(G);e.trapped||U&&F.contains(U)||(a=U),te&&t("focusin",$),!_.paused&&e.trapped&&(te?d=G:zu(d,!0))},A=$=>{const F=y(i);if(!(_.paused||!F))if(e.trapped){const G=$.relatedTarget;!ki(G)&&!F.contains(G)&&setTimeout(()=>{if(!_.paused&&e.trapped){const U=g0({focusReason:m.value});t("focusout-prevented",U),U.defaultPrevented||zu(d,!0)}},0)}else{const G=$.target;G&&F.contains(G)||t("focusout",$)}};async function z(){await Vn();const $=y(i);if($){tR.push(_);const F=$.contains(document.activeElement)?a:document.activeElement;if(a=F,!$.contains(F)){const U=new Event(yw,YP);$.addEventListener(yw,o),$.dispatchEvent(U),U.defaultPrevented||Vn(()=>{let te=e.focusStartEl;zn(te)||(zu(te),document.activeElement!==te&&(te="first")),te==="first"&&OK(O4($),!0),(document.activeElement===F||te==="container")&&zu($)})}}}function N(){const $=y(i);if($){$.removeEventListener(yw,o);const F=new CustomEvent(bw,{...YP,detail:{focusReason:m.value}});$.addEventListener(bw,C),$.dispatchEvent(F),!F.defaultPrevented&&(m.value=="keyboard"||!zK()||$.contains(document.activeElement))&&zu(a??document.body),$.removeEventListener(bw,C),tR.remove(_)}}return vr(()=>{e.trapped&&z(),Wt(()=>e.trapped,$=>{$?z():N()})}),Io(()=>{e.trapped&&N(),i.value&&(i.value.removeEventListener("keydown",x),i.value.removeEventListener("focusin",k),i.value.removeEventListener("focusout",A),i.value=void 0)}),{onKeydown:x}}});function NK(e,t,i,a,d,m){return _t(e.$slots,"default",{handleKeydown:e.onKeydown})}var c_=hn(FK,[["render",NK],["__file","focus-trap.vue"]]);const $K=["fixed","absolute"],VK=ln({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:at(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:Fc,default:"bottom"},popperOptions:{type:at(Object),default:()=>({})},strategy:{type:String,values:$K,default:"absolute"}}),z4=ln({...VK,id:String,style:{type:at([String,Array,Object])},className:{type:at([String,Array,Object])},effect:{type:at(String),default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:at([String,Array,Object])},popperStyle:{type:at([String,Array,Object])},referenceEl:{type:at(Object)},triggerTargetEl:{type:at(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},virtualTriggering:Boolean,zIndex:Number,...qi(["ariaLabel"])}),UK={mouseenter:e=>e instanceof MouseEvent,mouseleave:e=>e instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},jK=(e,t=[])=>{const{placement:i,strategy:a,popperOptions:d}=e,m={placement:i,strategy:a,...d,modifiers:[...GK(e),...t]};return WK(m,d==null?void 0:d.modifiers),m},HK=e=>{if(Hr)return Ls(e)};function GK(e){const{offset:t,gpuAcceleration:i,fallbackPlacements:a}=e;return[{name:"offset",options:{offset:[0,t??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:a}},{name:"computeStyles",options:{gpuAcceleration:i}}]}function WK(e,t){t&&(e.modifiers=[...e.modifiers,...t??[]])}const qK=0,KK=e=>{const{popperInstanceRef:t,contentRef:i,triggerRef:a,role:d}=kn(RC,void 0),m=be(),_=be(),x=Q(()=>({name:"eventListeners",enabled:!!e.visible})),o=Q(()=>{var U;const te=y(m),Z=(U=y(_))!=null?U:qK;return{name:"arrow",enabled:!PO(te),options:{element:te,padding:Z}}}),C=Q(()=>({onFirstUpdate:()=>{$()},...jK(e,[y(o),y(x)])})),k=Q(()=>HK(e.referenceEl)||y(a)),{attributes:A,state:z,styles:N,update:$,forceUpdate:F,instanceRef:G}=B9(k,i,C);return Wt(G,U=>t.value=U),vr(()=>{Wt(()=>{var U;return(U=y(k))==null?void 0:U.getBoundingClientRect()},()=>{$()})}),{attributes:A,arrowRef:m,contentRef:i,instanceRef:G,state:z,styles:N,role:d,forceUpdate:F,update:$}},ZK=(e,{attributes:t,styles:i,role:a})=>{const{nextZIndex:d}=Jp(),m=Jt("popper"),_=Q(()=>y(t).popper),x=be(Wn(e.zIndex)?e.zIndex:d()),o=Q(()=>[m.b(),m.is("pure",e.pure),m.is(e.effect),e.popperClass]),C=Q(()=>[{zIndex:y(x)},y(i).popper,e.popperStyle||{}]),k=Q(()=>a.value==="dialog"?"false":void 0),A=Q(()=>y(i).arrow||{});return{ariaModal:k,arrowStyle:A,contentAttrs:_,contentClass:o,contentStyle:C,contentZIndex:x,updateZIndex:()=>{x.value=Wn(e.zIndex)?e.zIndex:d()}}},YK=(e,t)=>{const i=be(!1),a=be();return{focusStartRef:a,trapped:i,onFocusAfterReleased:C=>{var k;((k=C.detail)==null?void 0:k.focusReason)!=="pointer"&&(a.value="first",t("blur"))},onFocusAfterTrapped:()=>{t("focus")},onFocusInTrap:C=>{e.visible&&!i.value&&(C.target&&(a.value=C.target),i.value=!0)},onFocusoutPrevented:C=>{e.trapping||(C.detail.focusReason==="pointer"&&C.preventDefault(),i.value=!1)},onReleaseRequested:()=>{i.value=!1,t("close")}}},XK=Ge({name:"ElPopperContent"}),JK=Ge({...XK,props:z4,emits:UK,setup(e,{expose:t,emit:i}){const a=e,{focusStartRef:d,trapped:m,onFocusAfterReleased:_,onFocusAfterTrapped:x,onFocusInTrap:o,onFocusoutPrevented:C,onReleaseRequested:k}=YK(a,i),{attributes:A,arrowRef:z,contentRef:N,styles:$,instanceRef:F,role:G,update:U}=KK(a),{ariaModal:te,arrowStyle:Z,contentAttrs:q,contentClass:X,contentStyle:ie,updateZIndex:de}=ZK(a,{styles:$,attributes:A,role:G}),le=kn(Xl,void 0),pe=be();Br(k4,{arrowStyle:Z,arrowRef:z,arrowOffset:pe}),le&&Br(Xl,{...le,addInputId:_o,removeInputId:_o});let ge;const he=(Re=!0)=>{U(),Re&&de()},ue=()=>{he(!1),a.visible&&a.focusOnShow?m.value=!0:a.visible===!1&&(m.value=!1)};return vr(()=>{Wt(()=>a.triggerTargetEl,(Re,Ye)=>{ge==null||ge(),ge=void 0;const Ie=y(Re||N.value),fe=y(Ye||N.value);ga(Ie)&&(ge=Wt([G,()=>a.ariaLabel,te,()=>a.id],Me=>{["role","aria-label","aria-modal","id"].forEach((Se,ye)=>{ki(Me[ye])?Ie.removeAttribute(Se):Ie.setAttribute(Se,Me[ye])})},{immediate:!0})),fe!==Ie&&ga(fe)&&["role","aria-label","aria-modal","id"].forEach(Me=>{fe.removeAttribute(Me)})},{immediate:!0}),Wt(()=>a.visible,ue,{immediate:!0})}),Io(()=>{ge==null||ge(),ge=void 0}),t({popperContentRef:N,popperInstanceRef:F,updatePopper:he,contentStyle:ie}),(Re,Ye)=>(se(),Ae("div",kr({ref_key:"contentRef",ref:N},y(q),{style:y(ie),class:y(X),tabindex:"-1",onMouseenter:Ie=>Re.$emit("mouseenter",Ie),onMouseleave:Ie=>Re.$emit("mouseleave",Ie)}),[qe(y(c_),{trapped:y(m),"trap-on-focus-in":!0,"focus-trap-el":y(N),"focus-start-el":y(d),onFocusAfterTrapped:y(x),onFocusAfterReleased:y(_),onFocusin:y(o),onFocusoutPrevented:y(C),onReleaseRequested:y(k)},{default:st(()=>[_t(Re.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16,["onMouseenter","onMouseleave"]))}});var QK=hn(JK,[["__file","content.vue"]]);const B4=cr(xK),t1=Symbol("elTooltip"),Li=ln({...H9,...z4,appendTo:{type:at([String,Object])},content:{type:String,default:""},rawContent:Boolean,persistent:Boolean,visible:{type:at(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean,...qi(["ariaLabel"])}),Ov=ln({...L4,disabled:Boolean,trigger:{type:at([String,Array]),default:"hover"},triggerKeys:{type:at(Array),default:()=>[En.enter,En.numpadEnter,En.space]}}),{useModelToggleProps:eZ,useModelToggleEmits:tZ,useModelToggle:nZ}=LW("visible"),rZ=ln({...A4,...eZ,...Li,...Ov,...P4,showArrow:{type:Boolean,default:!0}}),oZ=[...tZ,"before-show","before-hide","show","hide","open","close"],iZ=(e,t)=>on(e)?e.includes(t):e===t,rp=(e,t,i)=>a=>{iZ(y(e),t)&&i(a)},sZ=Ge({name:"ElTooltipTrigger"}),aZ=Ge({...sZ,props:Ov,setup(e,{expose:t}){const i=e,a=Jt("tooltip"),{controlled:d,id:m,open:_,onOpen:x,onClose:o,onToggle:C}=kn(t1,void 0),k=be(null),A=()=>{if(y(d)||i.disabled)return!0},z=fo(i,"trigger"),N=ai(A,rp(z,"hover",x)),$=ai(A,rp(z,"hover",o)),F=ai(A,rp(z,"click",q=>{q.button===0&&C(q)})),G=ai(A,rp(z,"focus",x)),U=ai(A,rp(z,"focus",o)),te=ai(A,rp(z,"contextmenu",q=>{q.preventDefault(),C(q)})),Z=ai(A,q=>{const{code:X}=q;i.triggerKeys.includes(X)&&(q.preventDefault(),C(q))});return t({triggerRef:k}),(q,X)=>(se(),It(y(IK),{id:y(m),"virtual-ref":q.virtualRef,open:y(_),"virtual-triggering":q.virtualTriggering,class:ce(y(a).e("trigger")),onBlur:y(U),onClick:y(F),onContextmenu:y(te),onFocus:y(G),onMouseenter:y(N),onMouseleave:y($),onKeydown:y(Z)},{default:st(()=>[_t(q.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var lZ=hn(aZ,[["__file","trigger.vue"]]);const cZ=ln({to:{type:at([String,Object]),required:!0},disabled:Boolean}),uZ=Ge({__name:"teleport",props:cZ,setup(e){return(t,i)=>t.disabled?_t(t.$slots,"default",{key:0}):(se(),It(p5,{key:1,to:t.to},[_t(t.$slots,"default")],8,["to"]))}});var dZ=hn(uZ,[["__file","teleport.vue"]]);const tm=cr(dZ),hZ=Ge({name:"ElTooltipContent",inheritAttrs:!1}),fZ=Ge({...hZ,props:Li,setup(e,{expose:t}){const i=e,{selector:a}=i4(),d=Jt("tooltip"),m=be(null);let _;const{controlled:x,id:o,open:C,trigger:k,onClose:A,onOpen:z,onShow:N,onHide:$,onBeforeShow:F,onBeforeHide:G}=kn(t1,void 0),U=Q(()=>i.transition||`${d.namespace.value}-fade-in-linear`),te=Q(()=>i.persistent);Io(()=>{_==null||_()});const Z=Q(()=>y(te)?!0:y(C)),q=Q(()=>i.disabled?!1:y(C)),X=Q(()=>i.appendTo||a.value),ie=Q(()=>{var fe;return(fe=i.style)!=null?fe:{}}),de=be(!0),le=()=>{$(),de.value=!0},pe=()=>{if(y(x))return!0},ge=ai(pe,()=>{i.enterable&&y(k)==="hover"&&z()}),he=ai(pe,()=>{y(k)==="hover"&&A()}),ue=()=>{var fe,Me;(Me=(fe=m.value)==null?void 0:fe.updatePopper)==null||Me.call(fe),F==null||F()},Re=()=>{G==null||G()},Ye=()=>{N(),_=OT(Q(()=>{var fe;return(fe=m.value)==null?void 0:fe.popperContentRef}),()=>{if(y(x))return;y(k)!=="hover"&&A()})},Ie=()=>{i.virtualTriggering||A()};return Wt(()=>y(C),fe=>{fe?de.value=!1:_==null||_()},{flush:"post"}),Wt(()=>i.content,()=>{var fe,Me;(Me=(fe=m.value)==null?void 0:fe.updatePopper)==null||Me.call(fe)}),t({contentRef:m}),(fe,Me)=>(se(),It(y(tm),{disabled:!fe.teleported,to:y(X)},{default:st(()=>[qe(Fi,{name:y(U),onAfterLeave:le,onBeforeEnter:ue,onAfterEnter:Ye,onBeforeLeave:Re},{default:st(()=>[y(Z)?mr((se(),It(y(QK),kr({key:0,id:y(o),ref_key:"contentRef",ref:m},fe.$attrs,{"aria-label":fe.ariaLabel,"aria-hidden":de.value,"boundaries-padding":fe.boundariesPadding,"fallback-placements":fe.fallbackPlacements,"gpu-acceleration":fe.gpuAcceleration,offset:fe.offset,placement:fe.placement,"popper-options":fe.popperOptions,strategy:fe.strategy,effect:fe.effect,enterable:fe.enterable,pure:fe.pure,"popper-class":fe.popperClass,"popper-style":[fe.popperStyle,y(ie)],"reference-el":fe.referenceEl,"trigger-target-el":fe.triggerTargetEl,visible:y(q),"z-index":fe.zIndex,onMouseenter:y(ge),onMouseleave:y(he),onBlur:Ie,onClose:y(A)}),{default:st(()=>[_t(fe.$slots,"default")]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[no,y(q)]]):bt("v-if",!0)]),_:3},8,["name"])]),_:3},8,["disabled","to"]))}});var pZ=hn(fZ,[["__file","content.vue"]]);const mZ=Ge({name:"ElTooltip"}),gZ=Ge({...mZ,props:rZ,emits:oZ,setup(e,{expose:t,emit:i}){const a=e;j9();const d=Wi(),m=be(),_=be(),x=()=>{var U;const te=y(m);te&&((U=te.popperInstanceRef)==null||U.update())},o=be(!1),C=be(),{show:k,hide:A,hasUpdateHandler:z}=nZ({indicator:o,toggleReason:C}),{onOpen:N,onClose:$}=G9({showAfter:fo(a,"showAfter"),hideAfter:fo(a,"hideAfter"),autoClose:fo(a,"autoClose"),open:k,close:A}),F=Q(()=>ko(a.visible)&&!z.value);Br(t1,{controlled:F,id:d,open:Wp(o),trigger:fo(a,"trigger"),onOpen:U=>{N(U)},onClose:U=>{$(U)},onToggle:U=>{y(o)?$(U):N(U)},onShow:()=>{i("show",C.value)},onHide:()=>{i("hide",C.value)},onBeforeShow:()=>{i("before-show",C.value)},onBeforeHide:()=>{i("before-hide",C.value)},updatePopper:x}),Wt(()=>a.disabled,U=>{U&&o.value&&(o.value=!1)});const G=U=>{var te,Z;const q=(Z=(te=_.value)==null?void 0:te.contentRef)==null?void 0:Z.popperContentRef,X=(U==null?void 0:U.relatedTarget)||document.activeElement;return q&&q.contains(X)};return JD(()=>o.value&&A()),t({popperRef:m,contentRef:_,isFocusInsideContent:G,updatePopper:x,onOpen:N,onClose:$,hide:A}),(U,te)=>(se(),It(y(B4),{ref_key:"popperRef",ref:m,role:U.role},{default:st(()=>[qe(lZ,{disabled:U.disabled,trigger:U.trigger,"trigger-keys":U.triggerKeys,"virtual-ref":U.virtualRef,"virtual-triggering":U.virtualTriggering},{default:st(()=>[U.$slots.default?_t(U.$slots,"default",{key:0}):bt("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),qe(pZ,{ref_key:"contentRef",ref:_,"aria-label":U.ariaLabel,"boundaries-padding":U.boundariesPadding,content:U.content,disabled:U.disabled,effect:U.effect,enterable:U.enterable,"fallback-placements":U.fallbackPlacements,"hide-after":U.hideAfter,"gpu-acceleration":U.gpuAcceleration,offset:U.offset,persistent:U.persistent,"popper-class":U.popperClass,"popper-style":U.popperStyle,placement:U.placement,"popper-options":U.popperOptions,pure:U.pure,"raw-content":U.rawContent,"reference-el":U.referenceEl,"trigger-target-el":U.triggerTargetEl,"show-after":U.showAfter,strategy:U.strategy,teleported:U.teleported,transition:U.transition,"virtual-triggering":U.virtualTriggering,"z-index":U.zIndex,"append-to":U.appendTo},{default:st(()=>[_t(U.$slots,"content",{},()=>[U.rawContent?(se(),Ae("span",{key:0,innerHTML:U.content},null,8,["innerHTML"])):(se(),Ae("span",{key:1},fn(U.content),1))]),U.showArrow?(se(),It(y(TK),{key:0,"arrow-offset":U.arrowOffset},null,8,["arrow-offset"])):bt("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var vZ=hn(gZ,[["__file","tooltip.vue"]]);const os=cr(vZ),_Z=ln({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:at(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:at([Function,Array]),default:_o},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:Li.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...qi(["ariaLabel"])}),yZ={[xr]:e=>zn(e),[zs]:e=>zn(e),[No]:e=>zn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:e=>Tr(e)},F4="ElAutocomplete",bZ=Ge({name:F4,inheritAttrs:!1}),xZ=Ge({...bZ,props:_Z,emits:yZ,setup(e,{expose:t,emit:i}){const a=e,d=Gb(),m=Dh(),_=ys(),x=Jt("autocomplete"),o=be(),C=be(),k=be(),A=be();let z=!1,N=!1;const $=be([]),F=be(-1),G=be(""),U=be(!1),te=be(!1),Z=be(!1),q=Wi(),X=Q(()=>m.style),ie=Q(()=>($.value.length>0||Z.value)&&U.value),de=Q(()=>!a.hideLoading&&Z.value),le=Q(()=>o.value?Array.from(o.value.$el.querySelectorAll("input")):[]),pe=()=>{ie.value&&(G.value=`${o.value.$el.offsetWidth}px`)},ge=()=>{F.value=-1},he=async mt=>{if(te.value)return;const jt=Ht=>{Z.value=!1,!te.value&&(on(Ht)?($.value=Ht,F.value=a.highlightFirstItem?0:-1):Ci(F4,"autocomplete suggestions must be an array"))};if(Z.value=!0,on(a.fetchSuggestions))jt(a.fetchSuggestions);else{const Ht=await a.fetchSuggestions(mt,jt);on(Ht)&&jt(Ht)}},ue=Js(he,a.debounce),Re=mt=>{const jt=!!mt;if(i(zs,mt),i(xr,mt),te.value=!1,U.value||(U.value=jt),!a.triggerOnFocus&&!mt){te.value=!0,$.value=[];return}ue(mt)},Ye=mt=>{var jt;_.value||(((jt=mt.target)==null?void 0:jt.tagName)!=="INPUT"||le.value.includes(document.activeElement))&&(U.value=!0)},Ie=mt=>{i(No,mt)},fe=mt=>{N?N=!1:(U.value=!0,i("focus",mt),a.triggerOnFocus&&!z&&ue(String(a.modelValue)))},Me=mt=>{setTimeout(()=>{var jt;if((jt=k.value)!=null&&jt.isFocusInsideContent()){N=!0;return}U.value&&Fe(),i("blur",mt)})},Se=()=>{U.value=!1,i(xr,""),i("clear")},ye=async()=>{ie.value&&F.value>=0&&F.value<$.value.length?ut($.value[F.value]):a.selectWhenUnmatched&&(i("select",{value:a.modelValue}),$.value=[],F.value=-1)},Ce=mt=>{ie.value&&(mt.preventDefault(),mt.stopPropagation(),Fe())},Fe=()=>{U.value=!1},it=()=>{var mt;(mt=o.value)==null||mt.focus()},We=()=>{var mt;(mt=o.value)==null||mt.blur()},ut=async mt=>{i(zs,mt[a.valueKey]),i(xr,mt[a.valueKey]),i("select",mt),$.value=[],F.value=-1},Lt=mt=>{if(!ie.value||Z.value)return;if(mt<0){F.value=-1;return}mt>=$.value.length&&(mt=$.value.length-1);const jt=C.value.querySelector(`.${x.be("suggestion","wrap")}`),Tn=jt.querySelectorAll(`.${x.be("suggestion","list")} li`)[mt],Pe=jt.scrollTop,{offsetTop:At,scrollHeight:He}=Tn;At+He>Pe+jt.clientHeight&&(jt.scrollTop+=He),At<Pe&&(jt.scrollTop-=He),F.value=mt,o.value.ref.setAttribute("aria-activedescendant",`${q.value}-item-${F.value}`)},Ft=OT(A,()=>{ie.value&&Fe()});return Io(()=>{Ft==null||Ft()}),vr(()=>{o.value.ref.setAttribute("role","textbox"),o.value.ref.setAttribute("aria-autocomplete","list"),o.value.ref.setAttribute("aria-controls","id"),o.value.ref.setAttribute("aria-activedescendant",`${q.value}-item-${F.value}`),z=o.value.ref.hasAttribute("readonly")}),t({highlightedIndex:F,activated:U,loading:Z,inputRef:o,popperRef:k,suggestions:$,handleSelect:ut,handleKeyEnter:ye,focus:it,blur:We,close:Fe,highlight:Lt,getData:he}),(mt,jt)=>(se(),It(y(os),{ref_key:"popperRef",ref:k,visible:y(ie),placement:mt.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[y(x).e("popper"),mt.popperClass],teleported:mt.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${y(x).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:pe,onHide:ge},{content:st(()=>[Ve("div",{ref_key:"regionRef",ref:C,class:ce([y(x).b("suggestion"),y(x).is("loading",y(de))]),style:Nn({[mt.fitInputWidth?"width":"minWidth"]:G.value,outline:"none"}),role:"region"},[qe(y(rc),{id:y(q),tag:"ul","wrap-class":y(x).be("suggestion","wrap"),"view-class":y(x).be("suggestion","list"),role:"listbox"},{default:st(()=>[y(de)?(se(),Ae("li",{key:0},[_t(mt.$slots,"loading",{},()=>[qe(y(Dn),{class:ce(y(x).is("loading"))},{default:st(()=>[qe(y(Kl))]),_:1},8,["class"])])])):(se(!0),Ae(Bn,{key:1},Fr($.value,(Ht,Tn)=>(se(),Ae("li",{id:`${y(q)}-item-${Tn}`,key:Tn,class:ce({highlighted:F.value===Tn}),role:"option","aria-selected":F.value===Tn,onClick:Pe=>ut(Ht)},[_t(mt.$slots,"default",{item:Ht},()=>[$r(fn(Ht[mt.valueKey]),1)])],10,["id","aria-selected","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:st(()=>[Ve("div",{ref_key:"listboxRef",ref:A,class:ce([y(x).b(),mt.$attrs.class]),style:Nn(y(X)),role:"combobox","aria-haspopup":"listbox","aria-expanded":y(ie),"aria-owns":y(q)},[qe(y(vs),kr({ref_key:"inputRef",ref:o},y(d),{clearable:mt.clearable,disabled:y(_),name:mt.name,"model-value":mt.modelValue,"aria-label":mt.ariaLabel,onInput:Re,onChange:Ie,onFocus:fe,onBlur:Me,onClear:Se,onKeydown:[Mo(Yn(Ht=>Lt(F.value-1),["prevent"]),["up"]),Mo(Yn(Ht=>Lt(F.value+1),["prevent"]),["down"]),Mo(ye,["enter"]),Mo(Fe,["tab"]),Mo(Ce,["esc"])],onMousedown:Ye}),$a({_:2},[mt.$slots.prepend?{name:"prepend",fn:st(()=>[_t(mt.$slots,"prepend")])}:void 0,mt.$slots.append?{name:"append",fn:st(()=>[_t(mt.$slots,"append")])}:void 0,mt.$slots.prefix?{name:"prefix",fn:st(()=>[_t(mt.$slots,"prefix")])}:void 0,mt.$slots.suffix?{name:"suffix",fn:st(()=>[_t(mt.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,["aria-expanded","aria-owns"])]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var wZ=hn(xZ,[["__file","autocomplete.vue"]]);const SZ=cr(wZ),TZ=ln({size:{type:[Number,String],values:tc,default:"",validator:e=>Wn(e)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:wo},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:at(String),default:"cover"}}),CZ={error:e=>e instanceof Event},EZ=Ge({name:"ElAvatar"}),MZ=Ge({...EZ,props:TZ,emits:CZ,setup(e,{emit:t}){const i=e,a=Jt("avatar"),d=be(!1),m=Q(()=>{const{size:C,icon:k,shape:A}=i,z=[a.b()];return zn(C)&&z.push(a.m(C)),k&&z.push(a.m("icon")),A&&z.push(a.m(A)),z}),_=Q(()=>{const{size:C}=i;return Wn(C)?a.cssVarBlock({size:li(C)||""}):void 0}),x=Q(()=>({objectFit:i.fit}));Wt(()=>i.src,()=>d.value=!1);function o(C){d.value=!0,t("error",C)}return(C,k)=>(se(),Ae("span",{class:ce(y(m)),style:Nn(y(_))},[(C.src||C.srcSet)&&!d.value?(se(),Ae("img",{key:0,src:C.src,alt:C.alt,srcset:C.srcSet,style:Nn(y(x)),onError:o},null,44,["src","alt","srcset"])):C.icon?(se(),It(y(Dn),{key:1},{default:st(()=>[(se(),It(Ir(C.icon)))]),_:1})):_t(C.$slots,"default",{key:2})],6))}});var IZ=hn(MZ,[["__file","avatar.vue"]]);const kZ=cr(IZ),AZ={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},PZ={click:e=>e instanceof MouseEvent},RZ=(e,t,i)=>{const a=Uo(),d=Uo(),m=be(!1),_=()=>{a.value&&(m.value=a.value.scrollTop>=e.visibilityHeight)},x=C=>{var k;(k=a.value)==null||k.scrollTo({top:0,behavior:"smooth"}),t("click",C)},o=jL(_,300,!0);return yo(d,"scroll",o),vr(()=>{var C;d.value=document,a.value=document.documentElement,e.target&&(a.value=(C=document.querySelector(e.target))!=null?C:void 0,a.value||Ci(i,`target does not exist: ${e.target}`),d.value=a.value),_()}),{visible:m,handleClick:x}},N4="ElBacktop",DZ=Ge({name:N4}),LZ=Ge({...DZ,props:AZ,emits:PZ,setup(e,{emit:t}){const i=e,a=Jt("backtop"),{handleClick:d,visible:m}=RZ(i,t,N4),_=Q(()=>({right:`${i.right}px`,bottom:`${i.bottom}px`}));return(x,o)=>(se(),It(Fi,{name:`${y(a).namespace.value}-fade-in`},{default:st(()=>[y(m)?(se(),Ae("div",{key:0,style:Nn(y(_)),class:ce(y(a).b()),onClick:Yn(y(d),["stop"])},[_t(x.$slots,"default",{},()=>[qe(y(Dn),{class:ce(y(a).e("icon"))},{default:st(()=>[qe(y(vG))]),_:1},8,["class"])])],14,["onClick"])):bt("v-if",!0)]),_:3},8,["name"]))}});var OZ=hn(LZ,[["__file","backtop.vue"]]);const zZ=cr(OZ),BZ=ln({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"},showZero:{type:Boolean,default:!0},color:String,badgeStyle:{type:at([String,Object,Array])},offset:{type:at(Array),default:[0,0]},badgeClass:{type:String}}),FZ=Ge({name:"ElBadge"}),NZ=Ge({...FZ,props:BZ,setup(e,{expose:t}){const i=e,a=Jt("badge"),d=Q(()=>i.isDot?"":Wn(i.value)&&Wn(i.max)?i.max<i.value?`${i.max}+`:`${i.value}`:`${i.value}`),m=Q(()=>{var _,x,o,C,k;return[{backgroundColor:i.color,marginRight:li(-((x=(_=i.offset)==null?void 0:_[0])!=null?x:0)),marginTop:li((C=(o=i.offset)==null?void 0:o[1])!=null?C:0)},(k=i.badgeStyle)!=null?k:{}]});return t({content:d}),(_,x)=>(se(),Ae("div",{class:ce(y(a).b())},[_t(_.$slots,"default"),qe(Fi,{name:`${y(a).namespace.value}-zoom-in-center`,persisted:""},{default:st(()=>[mr(Ve("sup",{class:ce([y(a).e("content"),y(a).em("content",_.type),y(a).is("fixed",!!_.$slots.default),y(a).is("dot",_.isDot),y(a).is("hide-zero",!_.showZero&&i.value===0),_.badgeClass]),style:Nn(y(m)),textContent:fn(y(d))},null,14,["textContent"]),[[no,!_.hidden&&(y(d)||_.isDot)]])]),_:1},8,["name"])],2))}});var $Z=hn(NZ,[["__file","badge.vue"]]);const $4=cr($Z),V4=Symbol("breadcrumbKey"),VZ=ln({separator:{type:String,default:"/"},separatorIcon:{type:wo}}),UZ=Ge({name:"ElBreadcrumb"}),jZ=Ge({...UZ,props:VZ,setup(e){const t=e,{t:i}=Gr(),a=Jt("breadcrumb"),d=be();return Br(V4,t),vr(()=>{const m=d.value.querySelectorAll(`.${a.e("item")}`);m.length&&m[m.length-1].setAttribute("aria-current","page")}),(m,_)=>(se(),Ae("div",{ref_key:"breadcrumb",ref:d,class:ce(y(a).b()),"aria-label":y(i)("el.breadcrumb.label"),role:"navigation"},[_t(m.$slots,"default")],10,["aria-label"]))}});var HZ=hn(jZ,[["__file","breadcrumb.vue"]]);const GZ=ln({to:{type:at([String,Object]),default:""},replace:Boolean}),WZ=Ge({name:"ElBreadcrumbItem"}),qZ=Ge({...WZ,props:GZ,setup(e){const t=e,i=Cr(),a=kn(V4,void 0),d=Jt("breadcrumb"),m=i.appContext.config.globalProperties.$router,_=be(),x=()=>{!t.to||!m||(t.replace?m.replace(t.to):m.push(t.to))};return(o,C)=>{var k,A;return se(),Ae("span",{class:ce(y(d).e("item"))},[Ve("span",{ref_key:"link",ref:_,class:ce([y(d).e("inner"),y(d).is("link",!!o.to)]),role:"link",onClick:x},[_t(o.$slots,"default")],2),(k=y(a))!=null&&k.separatorIcon?(se(),It(y(Dn),{key:0,class:ce(y(d).e("separator"))},{default:st(()=>[(se(),It(Ir(y(a).separatorIcon)))]),_:1},8,["class"])):(se(),Ae("span",{key:1,class:ce(y(d).e("separator")),role:"presentation"},fn((A=y(a))==null?void 0:A.separator),3))],2)}}});var U4=hn(qZ,[["__file","breadcrumb-item.vue"]]);const KZ=cr(HZ,{BreadcrumbItem:U4}),ZZ=Jo(U4),j4=Symbol("buttonGroupContextKey"),YZ=(e,t)=>{Ku({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},Q(()=>e.type==="text"));const i=kn(j4,void 0),a=Jb("button"),{form:d}=bs(),m=xi(Q(()=>i==null?void 0:i.size)),_=ys(),x=be(),o=Ai(),C=Q(()=>e.type||(i==null?void 0:i.type)||""),k=Q(()=>{var $,F,G;return(G=(F=e.autoInsertSpace)!=null?F:($=a.value)==null?void 0:$.autoInsertSpace)!=null?G:!1}),A=Q(()=>e.tag==="button"?{ariaDisabled:_.value||e.loading,disabled:_.value||e.loading,autofocus:e.autofocus,type:e.nativeType}:{}),z=Q(()=>{var $;const F=($=o.default)==null?void 0:$.call(o);if(k.value&&(F==null?void 0:F.length)===1){const G=F[0];if((G==null?void 0:G.type)===qp){const U=G.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(U.trim())}}return!1});return{_disabled:_,_size:m,_type:C,_ref:x,_props:A,shouldAddSpace:z,handleClick:$=>{if(_.value||e.loading){$.stopPropagation();return}e.nativeType==="reset"&&(d==null||d.resetFields()),t("click",$)}}},bS=["default","primary","success","warning","info","danger","text",""],XZ=["button","submit","reset"],xS=ln({size:Ei,disabled:Boolean,type:{type:String,values:bS,default:""},icon:{type:wo},nativeType:{type:String,values:XZ,default:"button"},loading:Boolean,loadingIcon:{type:wo,default:()=>Kl},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:at([String,Object]),default:"button"}}),JZ={click:e=>e instanceof MouseEvent};function rs(e,t){QZ(e)&&(e="100%");var i=eY(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),i&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function v0(e){return Math.min(1,Math.max(0,e))}function QZ(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function eY(e){return typeof e=="string"&&e.indexOf("%")!==-1}function H4(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function _0(e){return e<=1?"".concat(Number(e)*100,"%"):e}function dh(e){return e.length===1?"0"+e:String(e)}function tY(e,t,i){return{r:rs(e,255)*255,g:rs(t,255)*255,b:rs(i,255)*255}}function rR(e,t,i){e=rs(e,255),t=rs(t,255),i=rs(i,255);var a=Math.max(e,t,i),d=Math.min(e,t,i),m=0,_=0,x=(a+d)/2;if(a===d)_=0,m=0;else{var o=a-d;switch(_=x>.5?o/(2-a-d):o/(a+d),a){case e:m=(t-i)/o+(t<i?6:0);break;case t:m=(i-e)/o+2;break;case i:m=(e-t)/o+4;break}m/=6}return{h:m,s:_,l:x}}function xw(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*(6*i):i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function nY(e,t,i){var a,d,m;if(e=rs(e,360),t=rs(t,100),i=rs(i,100),t===0)d=i,m=i,a=i;else{var _=i<.5?i*(1+t):i+t-i*t,x=2*i-_;a=xw(x,_,e+1/3),d=xw(x,_,e),m=xw(x,_,e-1/3)}return{r:a*255,g:d*255,b:m*255}}function oR(e,t,i){e=rs(e,255),t=rs(t,255),i=rs(i,255);var a=Math.max(e,t,i),d=Math.min(e,t,i),m=0,_=a,x=a-d,o=a===0?0:x/a;if(a===d)m=0;else{switch(a){case e:m=(t-i)/x+(t<i?6:0);break;case t:m=(i-e)/x+2;break;case i:m=(e-t)/x+4;break}m/=6}return{h:m,s:o,v:_}}function rY(e,t,i){e=rs(e,360)*6,t=rs(t,100),i=rs(i,100);var a=Math.floor(e),d=e-a,m=i*(1-t),_=i*(1-d*t),x=i*(1-(1-d)*t),o=a%6,C=[i,_,m,m,x,i][o],k=[x,i,i,_,m,m][o],A=[m,m,x,i,i,_][o];return{r:C*255,g:k*255,b:A*255}}function iR(e,t,i,a){var d=[dh(Math.round(e).toString(16)),dh(Math.round(t).toString(16)),dh(Math.round(i).toString(16))];return a&&d[0].startsWith(d[0].charAt(1))&&d[1].startsWith(d[1].charAt(1))&&d[2].startsWith(d[2].charAt(1))?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0):d.join("")}function oY(e,t,i,a,d){var m=[dh(Math.round(e).toString(16)),dh(Math.round(t).toString(16)),dh(Math.round(i).toString(16)),dh(iY(a))];return d&&m[0].startsWith(m[0].charAt(1))&&m[1].startsWith(m[1].charAt(1))&&m[2].startsWith(m[2].charAt(1))&&m[3].startsWith(m[3].charAt(1))?m[0].charAt(0)+m[1].charAt(0)+m[2].charAt(0)+m[3].charAt(0):m.join("")}function iY(e){return Math.round(parseFloat(e)*255).toString(16)}function sR(e){return ua(e)/255}function ua(e){return parseInt(e,16)}function sY(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var wS={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function aY(e){var t={r:0,g:0,b:0},i=1,a=null,d=null,m=null,_=!1,x=!1;return typeof e=="string"&&(e=uY(e)),typeof e=="object"&&(wc(e.r)&&wc(e.g)&&wc(e.b)?(t=tY(e.r,e.g,e.b),_=!0,x=String(e.r).substr(-1)==="%"?"prgb":"rgb"):wc(e.h)&&wc(e.s)&&wc(e.v)?(a=_0(e.s),d=_0(e.v),t=rY(e.h,a,d),_=!0,x="hsv"):wc(e.h)&&wc(e.s)&&wc(e.l)&&(a=_0(e.s),m=_0(e.l),t=nY(e.h,a,m),_=!0,x="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(i=e.a)),i=H4(i),{ok:_,format:e.format||x,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:i}}var lY="[-\\+]?\\d+%?",cY="[-\\+]?\\d*\\.\\d+%?",ju="(?:".concat(cY,")|(?:").concat(lY,")"),ww="[\\s|\\(]+(".concat(ju,")[,|\\s]+(").concat(ju,")[,|\\s]+(").concat(ju,")\\s*\\)?"),Sw="[\\s|\\(]+(".concat(ju,")[,|\\s]+(").concat(ju,")[,|\\s]+(").concat(ju,")[,|\\s]+(").concat(ju,")\\s*\\)?"),al={CSS_UNIT:new RegExp(ju),rgb:new RegExp("rgb"+ww),rgba:new RegExp("rgba"+Sw),hsl:new RegExp("hsl"+ww),hsla:new RegExp("hsla"+Sw),hsv:new RegExp("hsv"+ww),hsva:new RegExp("hsva"+Sw),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function uY(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var t=!1;if(wS[e])e=wS[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var i=al.rgb.exec(e);return i?{r:i[1],g:i[2],b:i[3]}:(i=al.rgba.exec(e),i?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=al.hsl.exec(e),i?{h:i[1],s:i[2],l:i[3]}:(i=al.hsla.exec(e),i?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=al.hsv.exec(e),i?{h:i[1],s:i[2],v:i[3]}:(i=al.hsva.exec(e),i?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=al.hex8.exec(e),i?{r:ua(i[1]),g:ua(i[2]),b:ua(i[3]),a:sR(i[4]),format:t?"name":"hex8"}:(i=al.hex6.exec(e),i?{r:ua(i[1]),g:ua(i[2]),b:ua(i[3]),format:t?"name":"hex"}:(i=al.hex4.exec(e),i?{r:ua(i[1]+i[1]),g:ua(i[2]+i[2]),b:ua(i[3]+i[3]),a:sR(i[4]+i[4]),format:t?"name":"hex8"}:(i=al.hex3.exec(e),i?{r:ua(i[1]+i[1]),g:ua(i[2]+i[2]),b:ua(i[3]+i[3]),format:t?"name":"hex"}:!1)))))))))}function wc(e){return!!al.CSS_UNIT.exec(String(e))}var G4=function(){function e(t,i){t===void 0&&(t=""),i===void 0&&(i={});var a;if(t instanceof e)return t;typeof t=="number"&&(t=sY(t)),this.originalInput=t;var d=aY(t);this.originalInput=t,this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.roundA=Math.round(100*this.a)/100,this.format=(a=i.format)!==null&&a!==void 0?a:d.format,this.gradientType=i.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=d.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},e.prototype.getLuminance=function(){var t=this.toRgb(),i,a,d,m=t.r/255,_=t.g/255,x=t.b/255;return m<=.03928?i=m/12.92:i=Math.pow((m+.055)/1.055,2.4),_<=.03928?a=_/12.92:a=Math.pow((_+.055)/1.055,2.4),x<=.03928?d=x/12.92:d=Math.pow((x+.055)/1.055,2.4),.2126*i+.7152*a+.0722*d},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(t){return this.a=H4(t),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var t=this.toHsl().s;return t===0},e.prototype.toHsv=function(){var t=oR(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}},e.prototype.toHsvString=function(){var t=oR(this.r,this.g,this.b),i=Math.round(t.h*360),a=Math.round(t.s*100),d=Math.round(t.v*100);return this.a===1?"hsv(".concat(i,", ").concat(a,"%, ").concat(d,"%)"):"hsva(".concat(i,", ").concat(a,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var t=rR(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}},e.prototype.toHslString=function(){var t=rR(this.r,this.g,this.b),i=Math.round(t.h*360),a=Math.round(t.s*100),d=Math.round(t.l*100);return this.a===1?"hsl(".concat(i,", ").concat(a,"%, ").concat(d,"%)"):"hsla(".concat(i,", ").concat(a,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(t){return t===void 0&&(t=!1),iR(this.r,this.g,this.b,t)},e.prototype.toHexString=function(t){return t===void 0&&(t=!1),"#"+this.toHex(t)},e.prototype.toHex8=function(t){return t===void 0&&(t=!1),oY(this.r,this.g,this.b,this.a,t)},e.prototype.toHex8String=function(t){return t===void 0&&(t=!1),"#"+this.toHex8(t)},e.prototype.toHexShortString=function(t){return t===void 0&&(t=!1),this.a===1?this.toHexString(t):this.toHex8String(t)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var t=Math.round(this.r),i=Math.round(this.g),a=Math.round(this.b);return this.a===1?"rgb(".concat(t,", ").concat(i,", ").concat(a,")"):"rgba(".concat(t,", ").concat(i,", ").concat(a,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var t=function(i){return"".concat(Math.round(rs(i,255)*100),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var t=function(i){return Math.round(rs(i,255)*100)};return this.a===1?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var t="#"+iR(this.r,this.g,this.b,!1),i=0,a=Object.entries(wS);i<a.length;i++){var d=a[i],m=d[0],_=d[1];if(t===_)return m}return!1},e.prototype.toString=function(t){var i=!!t;t=t??this.format;var a=!1,d=this.a<1&&this.a>=0,m=!i&&d&&(t.startsWith("hex")||t==="name");return m?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(a=this.toRgbString()),t==="prgb"&&(a=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(a=this.toHexString()),t==="hex3"&&(a=this.toHexString(!0)),t==="hex4"&&(a=this.toHex8String(!0)),t==="hex8"&&(a=this.toHex8String()),t==="name"&&(a=this.toName()),t==="hsl"&&(a=this.toHslString()),t==="hsv"&&(a=this.toHsvString()),a||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.l+=t/100,i.l=v0(i.l),new e(i)},e.prototype.brighten=function(t){t===void 0&&(t=10);var i=this.toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(255*-(t/100)))),i.g=Math.max(0,Math.min(255,i.g-Math.round(255*-(t/100)))),i.b=Math.max(0,Math.min(255,i.b-Math.round(255*-(t/100)))),new e(i)},e.prototype.darken=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.l-=t/100,i.l=v0(i.l),new e(i)},e.prototype.tint=function(t){return t===void 0&&(t=10),this.mix("white",t)},e.prototype.shade=function(t){return t===void 0&&(t=10),this.mix("black",t)},e.prototype.desaturate=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.s-=t/100,i.s=v0(i.s),new e(i)},e.prototype.saturate=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.s+=t/100,i.s=v0(i.s),new e(i)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var i=this.toHsl(),a=(i.h+t)%360;return i.h=a<0?360+a:a,new e(i)},e.prototype.mix=function(t,i){i===void 0&&(i=50);var a=this.toRgb(),d=new e(t).toRgb(),m=i/100,_={r:(d.r-a.r)*m+a.r,g:(d.g-a.g)*m+a.g,b:(d.b-a.b)*m+a.b,a:(d.a-a.a)*m+a.a};return new e(_)},e.prototype.analogous=function(t,i){t===void 0&&(t=6),i===void 0&&(i=30);var a=this.toHsl(),d=360/i,m=[this];for(a.h=(a.h-(d*t>>1)+720)%360;--t;)a.h=(a.h+d)%360,m.push(new e(a));return m},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){t===void 0&&(t=6);for(var i=this.toHsv(),a=i.h,d=i.s,m=i.v,_=[],x=1/t;t--;)_.push(new e({h:a,s:d,v:m})),m=(m+x)%1;return _},e.prototype.splitcomplement=function(){var t=this.toHsl(),i=t.h;return[this,new e({h:(i+72)%360,s:t.s,l:t.l}),new e({h:(i+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var i=this.toRgb(),a=new e(t).toRgb(),d=i.a+a.a*(1-i.a);return new e({r:(i.r*i.a+a.r*a.a*(1-i.a))/d,g:(i.g*i.a+a.g*a.a*(1-i.a))/d,b:(i.b*i.a+a.b*a.a*(1-i.a))/d,a:d})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var i=this.toHsl(),a=i.h,d=[this],m=360/t,_=1;_<t;_++)d.push(new e({h:(a+_*m)%360,s:i.s,l:i.l}));return d},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function Lu(e,t=20){return e.mix("#141414",t).toString()}function dY(e){const t=ys(),i=Jt("button");return Q(()=>{let a={},d=e.color;if(d){const m=d.match(/var\((.*?)\)/);m&&(d=window.getComputedStyle(window.document.documentElement).getPropertyValue(m[1]));const _=new G4(d),x=e.dark?_.tint(20).toString():Lu(_,20);if(e.plain)a=i.cssVarBlock({"bg-color":e.dark?Lu(_,90):_.tint(90).toString(),"text-color":d,"border-color":e.dark?Lu(_,50):_.tint(50).toString(),"hover-text-color":`var(${i.cssVarName("color-white")})`,"hover-bg-color":d,"hover-border-color":d,"active-bg-color":x,"active-text-color":`var(${i.cssVarName("color-white")})`,"active-border-color":x}),t.value&&(a[i.cssVarBlockName("disabled-bg-color")]=e.dark?Lu(_,90):_.tint(90).toString(),a[i.cssVarBlockName("disabled-text-color")]=e.dark?Lu(_,50):_.tint(50).toString(),a[i.cssVarBlockName("disabled-border-color")]=e.dark?Lu(_,80):_.tint(80).toString());else{const o=e.dark?Lu(_,30):_.tint(30).toString(),C=_.isDark()?`var(${i.cssVarName("color-white")})`:`var(${i.cssVarName("color-black")})`;if(a=i.cssVarBlock({"bg-color":d,"text-color":C,"border-color":d,"hover-bg-color":o,"hover-text-color":C,"hover-border-color":o,"active-bg-color":x,"active-border-color":x}),t.value){const k=e.dark?Lu(_,50):_.tint(50).toString();a[i.cssVarBlockName("disabled-bg-color")]=k,a[i.cssVarBlockName("disabled-text-color")]=e.dark?"rgba(255, 255, 255, 0.5)":`var(${i.cssVarName("color-white")})`,a[i.cssVarBlockName("disabled-border-color")]=k}}}return a})}const hY=Ge({name:"ElButton"}),fY=Ge({...hY,props:xS,emits:JZ,setup(e,{expose:t,emit:i}){const a=e,d=dY(a),m=Jt("button"),{_ref:_,_size:x,_type:o,_disabled:C,_props:k,shouldAddSpace:A,handleClick:z}=YZ(a,i),N=Q(()=>[m.b(),m.m(o.value),m.m(x.value),m.is("disabled",C.value),m.is("loading",a.loading),m.is("plain",a.plain),m.is("round",a.round),m.is("circle",a.circle),m.is("text",a.text),m.is("link",a.link),m.is("has-bg",a.bg)]);return t({ref:_,size:x,type:o,disabled:C,shouldAddSpace:A}),($,F)=>(se(),It(Ir($.tag),kr({ref_key:"_ref",ref:_},y(k),{class:y(N),style:y(d),onClick:y(z)}),{default:st(()=>[$.loading?(se(),Ae(Bn,{key:0},[$.$slots.loading?_t($.$slots,"loading",{key:0}):(se(),It(y(Dn),{key:1,class:ce(y(m).is("loading"))},{default:st(()=>[(se(),It(Ir($.loadingIcon)))]),_:1},8,["class"]))],64)):$.icon||$.$slots.icon?(se(),It(y(Dn),{key:1},{default:st(()=>[$.icon?(se(),It(Ir($.icon),{key:0})):_t($.$slots,"icon",{key:1})]),_:3})):bt("v-if",!0),$.$slots.default?(se(),Ae("span",{key:2,class:ce({[y(m).em("text","expand")]:y(A)})},[_t($.$slots,"default")],2)):bt("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var pY=hn(fY,[["__file","button.vue"]]);const mY={size:xS.size,type:xS.type},gY=Ge({name:"ElButtonGroup"}),vY=Ge({...gY,props:mY,setup(e){const t=e;Br(j4,ao({size:fo(t,"size"),type:fo(t,"type")}));const i=Jt("button");return(a,d)=>(se(),Ae("div",{class:ce(y(i).b("group"))},[_t(a.$slots,"default")],2))}});var W4=hn(vY,[["__file","button-group.vue"]]);const zi=cr(pY,{ButtonGroup:W4}),q4=Jo(W4);var K4={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Ql,function(){var i=1e3,a=6e4,d=36e5,m="millisecond",_="second",x="minute",o="hour",C="day",k="week",A="month",z="quarter",N="year",$="date",F="Invalid Date",G=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,U=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,te={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Ye){var Ie=["th","st","nd","rd"],fe=Ye%100;return"["+Ye+(Ie[(fe-20)%10]||Ie[fe]||Ie[0])+"]"}},Z=function(Ye,Ie,fe){var Me=String(Ye);return!Me||Me.length>=Ie?Ye:""+Array(Ie+1-Me.length).join(fe)+Ye},q={s:Z,z:function(Ye){var Ie=-Ye.utcOffset(),fe=Math.abs(Ie),Me=Math.floor(fe/60),Se=fe%60;return(Ie<=0?"+":"-")+Z(Me,2,"0")+":"+Z(Se,2,"0")},m:function Ye(Ie,fe){if(Ie.date()<fe.date())return-Ye(fe,Ie);var Me=12*(fe.year()-Ie.year())+(fe.month()-Ie.month()),Se=Ie.clone().add(Me,A),ye=fe-Se<0,Ce=Ie.clone().add(Me+(ye?-1:1),A);return+(-(Me+(fe-Se)/(ye?Se-Ce:Ce-Se))||0)},a:function(Ye){return Ye<0?Math.ceil(Ye)||0:Math.floor(Ye)},p:function(Ye){return{M:A,y:N,w:k,d:C,D:$,h:o,m:x,s:_,ms:m,Q:z}[Ye]||String(Ye||"").toLowerCase().replace(/s$/,"")},u:function(Ye){return Ye===void 0}},X="en",ie={};ie[X]=te;var de="$isDayjsObject",le=function(Ye){return Ye instanceof ue||!(!Ye||!Ye[de])},pe=function Ye(Ie,fe,Me){var Se;if(!Ie)return X;if(typeof Ie=="string"){var ye=Ie.toLowerCase();ie[ye]&&(Se=ye),fe&&(ie[ye]=fe,Se=ye);var Ce=Ie.split("-");if(!Se&&Ce.length>1)return Ye(Ce[0])}else{var Fe=Ie.name;ie[Fe]=Ie,Se=Fe}return!Me&&Se&&(X=Se),Se||!Me&&X},ge=function(Ye,Ie){if(le(Ye))return Ye.clone();var fe=typeof Ie=="object"?Ie:{};return fe.date=Ye,fe.args=arguments,new ue(fe)},he=q;he.l=pe,he.i=le,he.w=function(Ye,Ie){return ge(Ye,{locale:Ie.$L,utc:Ie.$u,x:Ie.$x,$offset:Ie.$offset})};var ue=function(){function Ye(fe){this.$L=pe(fe.locale,null,!0),this.parse(fe),this.$x=this.$x||fe.x||{},this[de]=!0}var Ie=Ye.prototype;return Ie.parse=function(fe){this.$d=function(Me){var Se=Me.date,ye=Me.utc;if(Se===null)return new Date(NaN);if(he.u(Se))return new Date;if(Se instanceof Date)return new Date(Se);if(typeof Se=="string"&&!/Z$/i.test(Se)){var Ce=Se.match(G);if(Ce){var Fe=Ce[2]-1||0,it=(Ce[7]||"0").substring(0,3);return ye?new Date(Date.UTC(Ce[1],Fe,Ce[3]||1,Ce[4]||0,Ce[5]||0,Ce[6]||0,it)):new Date(Ce[1],Fe,Ce[3]||1,Ce[4]||0,Ce[5]||0,Ce[6]||0,it)}}return new Date(Se)}(fe),this.init()},Ie.init=function(){var fe=this.$d;this.$y=fe.getFullYear(),this.$M=fe.getMonth(),this.$D=fe.getDate(),this.$W=fe.getDay(),this.$H=fe.getHours(),this.$m=fe.getMinutes(),this.$s=fe.getSeconds(),this.$ms=fe.getMilliseconds()},Ie.$utils=function(){return he},Ie.isValid=function(){return this.$d.toString()!==F},Ie.isSame=function(fe,Me){var Se=ge(fe);return this.startOf(Me)<=Se&&Se<=this.endOf(Me)},Ie.isAfter=function(fe,Me){return ge(fe)<this.startOf(Me)},Ie.isBefore=function(fe,Me){return this.endOf(Me)<ge(fe)},Ie.$g=function(fe,Me,Se){return he.u(fe)?this[Me]:this.set(Se,fe)},Ie.unix=function(){return Math.floor(this.valueOf()/1e3)},Ie.valueOf=function(){return this.$d.getTime()},Ie.startOf=function(fe,Me){var Se=this,ye=!!he.u(Me)||Me,Ce=he.p(fe),Fe=function(Ht,Tn){var Pe=he.w(Se.$u?Date.UTC(Se.$y,Tn,Ht):new Date(Se.$y,Tn,Ht),Se);return ye?Pe:Pe.endOf(C)},it=function(Ht,Tn){return he.w(Se.toDate()[Ht].apply(Se.toDate("s"),(ye?[0,0,0,0]:[23,59,59,999]).slice(Tn)),Se)},We=this.$W,ut=this.$M,Lt=this.$D,Ft="set"+(this.$u?"UTC":"");switch(Ce){case N:return ye?Fe(1,0):Fe(31,11);case A:return ye?Fe(1,ut):Fe(0,ut+1);case k:var mt=this.$locale().weekStart||0,jt=(We<mt?We+7:We)-mt;return Fe(ye?Lt-jt:Lt+(6-jt),ut);case C:case $:return it(Ft+"Hours",0);case o:return it(Ft+"Minutes",1);case x:return it(Ft+"Seconds",2);case _:return it(Ft+"Milliseconds",3);default:return this.clone()}},Ie.endOf=function(fe){return this.startOf(fe,!1)},Ie.$set=function(fe,Me){var Se,ye=he.p(fe),Ce="set"+(this.$u?"UTC":""),Fe=(Se={},Se[C]=Ce+"Date",Se[$]=Ce+"Date",Se[A]=Ce+"Month",Se[N]=Ce+"FullYear",Se[o]=Ce+"Hours",Se[x]=Ce+"Minutes",Se[_]=Ce+"Seconds",Se[m]=Ce+"Milliseconds",Se)[ye],it=ye===C?this.$D+(Me-this.$W):Me;if(ye===A||ye===N){var We=this.clone().set($,1);We.$d[Fe](it),We.init(),this.$d=We.set($,Math.min(this.$D,We.daysInMonth())).$d}else Fe&&this.$d[Fe](it);return this.init(),this},Ie.set=function(fe,Me){return this.clone().$set(fe,Me)},Ie.get=function(fe){return this[he.p(fe)]()},Ie.add=function(fe,Me){var Se,ye=this;fe=Number(fe);var Ce=he.p(Me),Fe=function(ut){var Lt=ge(ye);return he.w(Lt.date(Lt.date()+Math.round(ut*fe)),ye)};if(Ce===A)return this.set(A,this.$M+fe);if(Ce===N)return this.set(N,this.$y+fe);if(Ce===C)return Fe(1);if(Ce===k)return Fe(7);var it=(Se={},Se[x]=a,Se[o]=d,Se[_]=i,Se)[Ce]||1,We=this.$d.getTime()+fe*it;return he.w(We,this)},Ie.subtract=function(fe,Me){return this.add(-1*fe,Me)},Ie.format=function(fe){var Me=this,Se=this.$locale();if(!this.isValid())return Se.invalidDate||F;var ye=fe||"YYYY-MM-DDTHH:mm:ssZ",Ce=he.z(this),Fe=this.$H,it=this.$m,We=this.$M,ut=Se.weekdays,Lt=Se.months,Ft=Se.meridiem,mt=function(Tn,Pe,At,He){return Tn&&(Tn[Pe]||Tn(Me,ye))||At[Pe].slice(0,He)},jt=function(Tn){return he.s(Fe%12||12,Tn,"0")},Ht=Ft||function(Tn,Pe,At){var He=Tn<12?"AM":"PM";return At?He.toLowerCase():He};return ye.replace(U,function(Tn,Pe){return Pe||function(At){switch(At){case"YY":return String(Me.$y).slice(-2);case"YYYY":return he.s(Me.$y,4,"0");case"M":return We+1;case"MM":return he.s(We+1,2,"0");case"MMM":return mt(Se.monthsShort,We,Lt,3);case"MMMM":return mt(Lt,We);case"D":return Me.$D;case"DD":return he.s(Me.$D,2,"0");case"d":return String(Me.$W);case"dd":return mt(Se.weekdaysMin,Me.$W,ut,2);case"ddd":return mt(Se.weekdaysShort,Me.$W,ut,3);case"dddd":return ut[Me.$W];case"H":return String(Fe);case"HH":return he.s(Fe,2,"0");case"h":return jt(1);case"hh":return jt(2);case"a":return Ht(Fe,it,!0);case"A":return Ht(Fe,it,!1);case"m":return String(it);case"mm":return he.s(it,2,"0");case"s":return String(Me.$s);case"ss":return he.s(Me.$s,2,"0");case"SSS":return he.s(Me.$ms,3,"0");case"Z":return Ce}return null}(Tn)||Ce.replace(":","")})},Ie.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Ie.diff=function(fe,Me,Se){var ye,Ce=this,Fe=he.p(Me),it=ge(fe),We=(it.utcOffset()-this.utcOffset())*a,ut=this-it,Lt=function(){return he.m(Ce,it)};switch(Fe){case N:ye=Lt()/12;break;case A:ye=Lt();break;case z:ye=Lt()/3;break;case k:ye=(ut-We)/6048e5;break;case C:ye=(ut-We)/864e5;break;case o:ye=ut/d;break;case x:ye=ut/a;break;case _:ye=ut/i;break;default:ye=ut}return Se?ye:he.a(ye)},Ie.daysInMonth=function(){return this.endOf(A).$D},Ie.$locale=function(){return ie[this.$L]},Ie.locale=function(fe,Me){if(!fe)return this.$L;var Se=this.clone(),ye=pe(fe,Me,!0);return ye&&(Se.$L=ye),Se},Ie.clone=function(){return he.w(this.$d,this)},Ie.toDate=function(){return new Date(this.valueOf())},Ie.toJSON=function(){return this.isValid()?this.toISOString():null},Ie.toISOString=function(){return this.$d.toISOString()},Ie.toString=function(){return this.$d.toUTCString()},Ye}(),Re=ue.prototype;return ge.prototype=Re,[["$ms",m],["$s",_],["$m",x],["$H",o],["$W",C],["$M",A],["$y",N],["$D",$]].forEach(function(Ye){Re[Ye[1]]=function(Ie){return this.$g(Ie,Ye[0],Ye[1])}}),ge.extend=function(Ye,Ie){return Ye.$i||(Ye(Ie,ue,ge),Ye.$i=!0),ge},ge.locale=pe,ge.isDayjs=le,ge.unix=function(Ye){return ge(1e3*Ye)},ge.en=ie[X],ge.Ls=ie,ge.p={},ge})})(K4);var _Y=K4.exports;const sr=ec(_Y);var Z4={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Ql,function(){var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},a=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,d=/\d/,m=/\d\d/,_=/\d\d?/,x=/\d*[^-_:/,()\s\d]+/,o={},C=function(G){return(G=+G)+(G>68?1900:2e3)},k=function(G){return function(U){this[G]=+U}},A=[/[+-]\d\d:?(\d\d)?|Z/,function(G){(this.zone||(this.zone={})).offset=function(U){if(!U||U==="Z")return 0;var te=U.match(/([+-]|\d\d)/g),Z=60*te[1]+(+te[2]||0);return Z===0?0:te[0]==="+"?-Z:Z}(G)}],z=function(G){var U=o[G];return U&&(U.indexOf?U:U.s.concat(U.f))},N=function(G,U){var te,Z=o.meridiem;if(Z){for(var q=1;q<=24;q+=1)if(G.indexOf(Z(q,0,U))>-1){te=q>12;break}}else te=G===(U?"pm":"PM");return te},$={A:[x,function(G){this.afternoon=N(G,!1)}],a:[x,function(G){this.afternoon=N(G,!0)}],Q:[d,function(G){this.month=3*(G-1)+1}],S:[d,function(G){this.milliseconds=100*+G}],SS:[m,function(G){this.milliseconds=10*+G}],SSS:[/\d{3}/,function(G){this.milliseconds=+G}],s:[_,k("seconds")],ss:[_,k("seconds")],m:[_,k("minutes")],mm:[_,k("minutes")],H:[_,k("hours")],h:[_,k("hours")],HH:[_,k("hours")],hh:[_,k("hours")],D:[_,k("day")],DD:[m,k("day")],Do:[x,function(G){var U=o.ordinal,te=G.match(/\d+/);if(this.day=te[0],U)for(var Z=1;Z<=31;Z+=1)U(Z).replace(/\[|\]/g,"")===G&&(this.day=Z)}],w:[_,k("week")],ww:[m,k("week")],M:[_,k("month")],MM:[m,k("month")],MMM:[x,function(G){var U=z("months"),te=(z("monthsShort")||U.map(function(Z){return Z.slice(0,3)})).indexOf(G)+1;if(te<1)throw new Error;this.month=te%12||te}],MMMM:[x,function(G){var U=z("months").indexOf(G)+1;if(U<1)throw new Error;this.month=U%12||U}],Y:[/[+-]?\d+/,k("year")],YY:[m,function(G){this.year=C(G)}],YYYY:[/\d{4}/,k("year")],Z:A,ZZ:A};function F(G){var U,te;U=G,te=o&&o.formats;for(var Z=(G=U.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(ge,he,ue){var Re=ue&&ue.toUpperCase();return he||te[ue]||i[ue]||te[Re].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(Ye,Ie,fe){return Ie||fe.slice(1)})})).match(a),q=Z.length,X=0;X<q;X+=1){var ie=Z[X],de=$[ie],le=de&&de[0],pe=de&&de[1];Z[X]=pe?{regex:le,parser:pe}:ie.replace(/^\[|\]$/g,"")}return function(ge){for(var he={},ue=0,Re=0;ue<q;ue+=1){var Ye=Z[ue];if(typeof Ye=="string")Re+=Ye.length;else{var Ie=Ye.regex,fe=Ye.parser,Me=ge.slice(Re),Se=Ie.exec(Me)[0];fe.call(he,Se),ge=ge.replace(Se,"")}}return function(ye){var Ce=ye.afternoon;if(Ce!==void 0){var Fe=ye.hours;Ce?Fe<12&&(ye.hours+=12):Fe===12&&(ye.hours=0),delete ye.afternoon}}(he),he}}return function(G,U,te){te.p.customParseFormat=!0,G&&G.parseTwoDigitYear&&(C=G.parseTwoDigitYear);var Z=U.prototype,q=Z.parse;Z.parse=function(X){var ie=X.date,de=X.utc,le=X.args;this.$u=de;var pe=le[1];if(typeof pe=="string"){var ge=le[2]===!0,he=le[3]===!0,ue=ge||he,Re=le[2];he&&(Re=le[2]),o=this.$locale(),!ge&&Re&&(o=te.Ls[Re]),this.$d=function(Me,Se,ye,Ce){try{if(["x","X"].indexOf(Se)>-1)return new Date((Se==="X"?1e3:1)*Me);var Fe=F(Se)(Me),it=Fe.year,We=Fe.month,ut=Fe.day,Lt=Fe.hours,Ft=Fe.minutes,mt=Fe.seconds,jt=Fe.milliseconds,Ht=Fe.zone,Tn=Fe.week,Pe=new Date,At=ut||(it||We?1:Pe.getDate()),He=it||Pe.getFullYear(),pt=0;it&&!We||(pt=We>0?We-1:Pe.getMonth());var et,rn=Lt||0,kt=Ft||0,zt=mt||0,Mt=jt||0;return Ht?new Date(Date.UTC(He,pt,At,rn,kt,zt,Mt+60*Ht.offset*1e3)):ye?new Date(Date.UTC(He,pt,At,rn,kt,zt,Mt)):(et=new Date(He,pt,At,rn,kt,zt,Mt),Tn&&(et=Ce(et).week(Tn).toDate()),et)}catch{return new Date("")}}(ie,pe,de,te),this.init(),Re&&Re!==!0&&(this.$L=this.locale(Re).$L),ue&&ie!=this.format(pe)&&(this.$d=new Date("")),o={}}else if(pe instanceof Array)for(var Ye=pe.length,Ie=1;Ie<=Ye;Ie+=1){le[1]=pe[Ie-1];var fe=te.apply(this,le);if(fe.isValid()){this.$d=fe.$d,this.$L=fe.$L,this.init();break}Ie===Ye&&(this.$d=new Date(""))}else q.call(this,X)}}})})(Z4);var yY=Z4.exports;const zC=ec(yY),aR=["hours","minutes","seconds"],SS="HH:mm:ss",cp="YYYY-MM-DD",bY={date:cp,dates:cp,week:"gggg[w]ww",year:"YYYY",years:"YYYY",month:"YYYY-MM",months:"YYYY-MM",datetime:`${cp} ${SS}`,monthrange:"YYYY-MM",yearrange:"YYYY",daterange:cp,datetimerange:`${cp} ${SS}`},Tw=(e,t)=>[e>0?e-1:void 0,e,e<t?e+1:void 0],Zu=e=>Array.from(Array.from({length:e}).keys()),Y4=e=>e.replace(/\W?m{1,2}|\W?ZZ/g,"").replace(/\W?h{1,2}|\W?s{1,3}|\W?a/gi,"").trim(),X4=e=>e.replace(/\W?D{1,2}|\W?Do|\W?d{1,4}|\W?M{1,4}|\W?Y{2,4}/g,"").trim(),lR=function(e,t){const i=Yu(e),a=Yu(t);return i&&a?e.getTime()===t.getTime():!i&&!a?e===t:!1},cR=function(e,t){const i=on(e),a=on(t);return i&&a?e.length!==t.length?!1:e.every((d,m)=>lR(d,t[m])):!i&&!a?lR(e,t):!1},uR=function(e,t,i){const a=da(t)||t==="x"?sr(e).locale(i):sr(e,t).locale(i);return a.isValid()?a:void 0},dR=function(e,t,i){return da(t)?e:t==="x"?+e:sr(e).locale(i).format(t)},Cw=(e,t)=>{var i;const a=[],d=t==null?void 0:t();for(let m=0;m<e;m++)a.push((i=d==null?void 0:d.includes(m))!=null?i:!1);return a},J4=ln({disabledHours:{type:at(Function)},disabledMinutes:{type:at(Function)},disabledSeconds:{type:at(Function)}}),Q4=ln({visible:Boolean,actualVisible:{type:Boolean,default:void 0},format:{type:String,default:""}}),BC=ln({id:{type:at([Array,String])},name:{type:at([Array,String])},popperClass:{type:String,default:""},format:String,valueFormat:String,dateFormat:String,timeFormat:String,type:{type:String,default:""},clearable:{type:Boolean,default:!0},clearIcon:{type:at([String,Object]),default:dd},editable:{type:Boolean,default:!0},prefixIcon:{type:at([String,Object]),default:""},size:Ei,readonly:Boolean,disabled:Boolean,placeholder:{type:String,default:""},popperOptions:{type:at(Object),default:()=>({})},modelValue:{type:at([Date,Array,String,Number]),default:""},rangeSeparator:{type:String,default:"-"},startPlaceholder:String,endPlaceholder:String,defaultValue:{type:at([Date,Array])},defaultTime:{type:at([Date,Array])},isRange:Boolean,...J4,disabledDate:{type:Function},cellClassName:{type:Function},shortcuts:{type:Array,default:()=>[]},arrowControl:Boolean,tabindex:{type:at([String,Number]),default:0},validateEvent:{type:Boolean,default:!0},unlinkPanels:Boolean,placement:{type:at(String),values:Fc,default:"bottom"},fallbackPlacements:{type:at(Array),default:["bottom","top","right","left"]},...em,...qi(["ariaLabel"]),showNow:{type:Boolean,default:!0}}),xY=ln({id:{type:at(Array)},name:{type:at(Array)},modelValue:{type:at([Array,String])},startPlaceholder:String,endPlaceholder:String}),wY=Ge({name:"PickerRangeTrigger",inheritAttrs:!1}),SY=Ge({...wY,props:xY,emits:["mouseenter","mouseleave","click","touchstart","focus","blur","startInput","endInput","startChange","endChange"],setup(e,{expose:t,emit:i}){const a=Gb(),d=Jt("date"),m=Jt("range"),_=be(),x=be(),{wrapperRef:o,isFocused:C}=Bh(_),k=q=>{i("click",q)},A=q=>{i("mouseenter",q)},z=q=>{i("mouseleave",q)},N=q=>{i("mouseenter",q)},$=q=>{i("startInput",q)},F=q=>{i("endInput",q)},G=q=>{i("startChange",q)},U=q=>{i("endChange",q)};return t({focus:()=>{var q;(q=_.value)==null||q.focus()},blur:()=>{var q,X;(q=_.value)==null||q.blur(),(X=x.value)==null||X.blur()}}),(q,X)=>(se(),Ae("div",{ref_key:"wrapperRef",ref:o,class:ce([y(d).is("active",y(C)),q.$attrs.class]),style:Nn(q.$attrs.style),onClick:k,onMouseenter:A,onMouseleave:z,onTouchstart:N},[_t(q.$slots,"prefix"),Ve("input",kr(y(a),{id:q.id&&q.id[0],ref_key:"inputRef",ref:_,name:q.name&&q.name[0],placeholder:q.startPlaceholder,value:q.modelValue&&q.modelValue[0],class:y(m).b("input"),onInput:$,onChange:G}),null,16,["id","name","placeholder","value"]),_t(q.$slots,"range-separator"),Ve("input",kr(y(a),{id:q.id&&q.id[1],ref_key:"endInputRef",ref:x,name:q.name&&q.name[1],placeholder:q.endPlaceholder,value:q.modelValue&&q.modelValue[1],class:y(m).b("input"),onInput:F,onChange:U}),null,16,["id","name","placeholder","value"]),_t(q.$slots,"suffix")],38))}});var TY=hn(SY,[["__file","picker-range-trigger.vue"]]);const CY=Ge({name:"Picker"}),EY=Ge({...CY,props:BC,emits:["update:modelValue","change","focus","blur","clear","calendar-change","panel-change","visible-change","keydown"],setup(e,{expose:t,emit:i}){const a=e,d=Dh(),{lang:m}=Gr(),_=Jt("date"),x=Jt("input"),o=Jt("range"),{form:C,formItem:k}=bs(),A=kn("ElPopperOptions",{}),{valueOnClear:z}=Xb(a,null),N=be(),$=be(),F=be(!1),G=be(!1),U=be(null);let te=!1;const{isFocused:Z,handleFocus:q,handleBlur:X}=Bh($,{beforeFocus(){return a.readonly||ye.value},afterFocus(){F.value=!0},beforeBlur(Ze){var gn;return!te&&((gn=N.value)==null?void 0:gn.isFocusInsideContent(Ze))},afterBlur(){en(),F.value=!1,te=!1,a.validateEvent&&(k==null||k.validate("blur").catch(Ze=>void 0))}}),ie=Q(()=>[_.b("editor"),_.bm("editor",a.type),x.e("wrapper"),_.is("disabled",ye.value),_.is("active",F.value),o.b("editor"),rn?o.bm("editor",rn.value):"",d.class]),de=Q(()=>[x.e("icon"),o.e("close-icon"),jt.value?"":o.e("close-icon--hidden")]);Wt(F,Ze=>{Ze?Vn(()=>{Ze&&(U.value=a.modelValue)}):(Mt.value=null,Vn(()=>{le(a.modelValue)}))});const le=(Ze,gn)=>{(gn||!cR(Ze,U.value))&&(i("change",Ze),a.validateEvent&&(k==null||k.validate("change").catch(rr=>void 0)))},pe=Ze=>{if(!cR(a.modelValue,Ze)){let gn;on(Ze)?gn=Ze.map(rr=>dR(rr,a.valueFormat,m.value)):Ze&&(gn=dR(Ze,a.valueFormat,m.value)),i("update:modelValue",Ze&&gn,m.value)}},ge=Ze=>{i("keydown",Ze)},he=Q(()=>$.value?Array.from($.value.$el.querySelectorAll("input")):[]),ue=(Ze,gn,rr)=>{const Hn=he.value;Hn.length&&(!rr||rr==="min"?(Hn[0].setSelectionRange(Ze,gn),Hn[0].focus()):rr==="max"&&(Hn[1].setSelectionRange(Ze,gn),Hn[1].focus()))},Re=(Ze="",gn=!1)=>{F.value=gn;let rr;on(Ze)?rr=Ze.map(Hn=>Hn.toDate()):rr=Ze&&Ze.toDate(),Mt.value=null,pe(rr)},Ye=()=>{G.value=!0},Ie=()=>{i("visible-change",!0)},fe=()=>{G.value=!1,F.value=!1,i("visible-change",!1)},Me=()=>{F.value=!0},Se=()=>{F.value=!1},ye=Q(()=>a.disabled||(C==null?void 0:C.disabled)),Ce=Q(()=>{let Ze;if(Tn.value?wr.value.getDefaultValue&&(Ze=wr.value.getDefaultValue()):on(a.modelValue)?Ze=a.modelValue.map(gn=>uR(gn,a.valueFormat,m.value)):Ze=uR(a.modelValue,a.valueFormat,m.value),wr.value.getRangeAvailableTime){const gn=wr.value.getRangeAvailableTime(Ze);Gi(gn,Ze)||(Ze=gn,Tn.value||pe(on(Ze)?Ze.map(rr=>rr.toDate()):Ze.toDate()))}return on(Ze)&&Ze.some(gn=>!gn)&&(Ze=[]),Ze}),Fe=Q(()=>{if(!wr.value.panelReady)return"";const Ze=dn(Ce.value);return on(Mt.value)?[Mt.value[0]||Ze&&Ze[0]||"",Mt.value[1]||Ze&&Ze[1]||""]:Mt.value!==null?Mt.value:!We.value&&Tn.value||!F.value&&Tn.value?"":Ze?ut.value||Lt.value||Ft.value?Ze.join(", "):Ze:""}),it=Q(()=>a.type.includes("time")),We=Q(()=>a.type.startsWith("time")),ut=Q(()=>a.type==="dates"),Lt=Q(()=>a.type==="months"),Ft=Q(()=>a.type==="years"),mt=Q(()=>a.prefixIcon||(it.value?BO:pG)),jt=be(!1),Ht=Ze=>{a.readonly||ye.value||(jt.value&&(Ze.stopPropagation(),wr.value.handleClear?wr.value.handleClear():pe(z.value),le(z.value,!0),jt.value=!1,fe()),i("clear"))},Tn=Q(()=>{const{modelValue:Ze}=a;return!Ze||on(Ze)&&!Ze.filter(Boolean).length}),Pe=async Ze=>{var gn;a.readonly||ye.value||(((gn=Ze.target)==null?void 0:gn.tagName)!=="INPUT"||Z.value)&&(F.value=!0)},At=()=>{a.readonly||ye.value||!Tn.value&&a.clearable&&(jt.value=!0)},He=()=>{jt.value=!1},pt=Ze=>{var gn;a.readonly||ye.value||(((gn=Ze.touches[0].target)==null?void 0:gn.tagName)!=="INPUT"||Z.value)&&(F.value=!0)},et=Q(()=>a.type.includes("range")),rn=xi(),kt=Q(()=>{var Ze,gn;return(gn=(Ze=y(N))==null?void 0:Ze.popperRef)==null?void 0:gn.contentRef}),zt=OT($,Ze=>{const gn=y(kt),rr=Ls($);gn&&(Ze.target===gn||Ze.composedPath().includes(gn))||Ze.target===rr||rr&&Ze.composedPath().includes(rr)||(F.value=!1)});Io(()=>{zt==null||zt()});const Mt=be(null),en=()=>{if(Mt.value){const Ze=sn(Fe.value);Ze&&Pn(Ze)&&(pe(on(Ze)?Ze.map(gn=>gn.toDate()):Ze.toDate()),Mt.value=null)}Mt.value===""&&(pe(z.value),le(z.value),Mt.value=null)},sn=Ze=>Ze?wr.value.parseUserInput(Ze):null,dn=Ze=>Ze?wr.value.formatToString(Ze):null,Pn=Ze=>wr.value.isValidValue(Ze),Ot=async Ze=>{if(a.readonly||ye.value)return;const{code:gn}=Ze;if(ge(Ze),gn===En.esc){F.value===!0&&(F.value=!1,Ze.preventDefault(),Ze.stopPropagation());return}if(gn===En.down&&(wr.value.handleFocusPicker&&(Ze.preventDefault(),Ze.stopPropagation()),F.value===!1&&(F.value=!0,await Vn()),wr.value.handleFocusPicker)){wr.value.handleFocusPicker();return}if(gn===En.tab){te=!0;return}if(gn===En.enter||gn===En.numpadEnter){(Mt.value===null||Mt.value===""||Pn(sn(Fe.value)))&&(en(),F.value=!1),Ze.stopPropagation();return}if(Mt.value){Ze.stopPropagation();return}wr.value.handleKeydownInput&&wr.value.handleKeydownInput(Ze)},Zt=Ze=>{Mt.value=Ze,F.value||(F.value=!0)},jn=Ze=>{const gn=Ze.target;Mt.value?Mt.value=[gn.value,Mt.value[1]]:Mt.value=[gn.value,null]},ir=Ze=>{const gn=Ze.target;Mt.value?Mt.value=[Mt.value[0],gn.value]:Mt.value=[null,gn.value]},ur=()=>{var Ze;const gn=Mt.value,rr=sn(gn&&gn[0]),Hn=y(Ce);if(rr&&rr.isValid()){Mt.value=[dn(rr),((Ze=Fe.value)==null?void 0:Ze[1])||null];const eo=[rr,Hn&&(Hn[1]||null)];Pn(eo)&&(pe(eo),Mt.value=null)}},ar=()=>{var Ze;const gn=y(Mt),rr=sn(gn&&gn[1]),Hn=y(Ce);if(rr&&rr.isValid()){Mt.value=[((Ze=y(Fe))==null?void 0:Ze[0])||null,dn(rr)];const eo=[Hn&&Hn[0],rr];Pn(eo)&&(pe(eo),Mt.value=null)}},wr=be({}),Xr=Ze=>{wr.value[Ze[0]]=Ze[1],wr.value.panelReady=!0},Rt=Ze=>{i("calendar-change",Ze)},_n=(Ze,gn,rr)=>{i("panel-change",Ze,gn,rr)},dt=()=>{var Ze;(Ze=$.value)==null||Ze.focus()},tn=()=>{var Ze;(Ze=$.value)==null||Ze.blur()};return Br("EP_PICKER_BASE",{props:a}),t({focus:dt,blur:tn,handleOpen:Me,handleClose:Se,onPick:Re}),(Ze,gn)=>(se(),It(y(os),kr({ref_key:"refPopper",ref:N,visible:F.value,effect:"light",pure:"",trigger:"click"},Ze.$attrs,{role:"dialog",teleported:"",transition:`${y(_).namespace.value}-zoom-in-top`,"popper-class":[`${y(_).namespace.value}-picker__popper`,Ze.popperClass],"popper-options":y(A),"fallback-placements":Ze.fallbackPlacements,"gpu-acceleration":!1,placement:Ze.placement,"stop-popper-mouse-event":!1,"hide-after":0,persistent:"",onBeforeShow:Ye,onShow:Ie,onHide:fe}),{default:st(()=>[y(et)?(se(),It(TY,{key:1,id:Ze.id,ref_key:"inputRef",ref:$,"model-value":y(Fe),name:Ze.name,disabled:y(ye),readonly:!Ze.editable||Ze.readonly,"start-placeholder":Ze.startPlaceholder,"end-placeholder":Ze.endPlaceholder,class:ce(y(ie)),style:Nn(Ze.$attrs.style),"aria-label":Ze.ariaLabel,tabindex:Ze.tabindex,autocomplete:"off",role:"combobox",onClick:Pe,onFocus:y(q),onBlur:y(X),onStartInput:jn,onStartChange:ur,onEndInput:ir,onEndChange:ar,onMousedown:Pe,onMouseenter:At,onMouseleave:He,onTouchstartPassive:pt,onKeydown:Ot},{prefix:st(()=>[y(mt)?(se(),It(y(Dn),{key:0,class:ce([y(x).e("icon"),y(o).e("icon")])},{default:st(()=>[(se(),It(Ir(y(mt))))]),_:1},8,["class"])):bt("v-if",!0)]),"range-separator":st(()=>[_t(Ze.$slots,"range-separator",{},()=>[Ve("span",{class:ce(y(o).b("separator"))},fn(Ze.rangeSeparator),3)])]),suffix:st(()=>[Ze.clearIcon?(se(),It(y(Dn),{key:0,class:ce(y(de)),onMousedown:Yn(y(_o),["prevent"]),onClick:Ht},{default:st(()=>[(se(),It(Ir(Ze.clearIcon)))]),_:1},8,["class","onMousedown"])):bt("v-if",!0)]),_:3},8,["id","model-value","name","disabled","readonly","start-placeholder","end-placeholder","class","style","aria-label","tabindex","onFocus","onBlur"])):(se(),It(y(vs),{key:0,id:Ze.id,ref_key:"inputRef",ref:$,"container-role":"combobox","model-value":y(Fe),name:Ze.name,size:y(rn),disabled:y(ye),placeholder:Ze.placeholder,class:ce([y(_).b("editor"),y(_).bm("editor",Ze.type),Ze.$attrs.class]),style:Nn(Ze.$attrs.style),readonly:!Ze.editable||Ze.readonly||y(ut)||y(Lt)||y(Ft)||Ze.type==="week","aria-label":Ze.ariaLabel,tabindex:Ze.tabindex,"validate-event":!1,onInput:Zt,onFocus:y(q),onBlur:y(X),onKeydown:Ot,onChange:en,onMousedown:Pe,onMouseenter:At,onMouseleave:He,onTouchstartPassive:pt,onClick:Yn(()=>{},["stop"])},{prefix:st(()=>[y(mt)?(se(),It(y(Dn),{key:0,class:ce(y(x).e("icon")),onMousedown:Yn(Pe,["prevent"]),onTouchstartPassive:pt},{default:st(()=>[(se(),It(Ir(y(mt))))]),_:1},8,["class","onMousedown"])):bt("v-if",!0)]),suffix:st(()=>[jt.value&&Ze.clearIcon?(se(),It(y(Dn),{key:0,class:ce(`${y(x).e("icon")} clear-icon`),onMousedown:Yn(y(_o),["prevent"]),onClick:Ht},{default:st(()=>[(se(),It(Ir(Ze.clearIcon)))]),_:1},8,["class","onMousedown"])):bt("v-if",!0)]),_:1},8,["id","model-value","name","size","disabled","placeholder","class","style","readonly","aria-label","tabindex","onFocus","onBlur","onClick"]))]),content:st(()=>[_t(Ze.$slots,"default",{visible:F.value,actualVisible:G.value,parsedValue:y(Ce),format:Ze.format,dateFormat:Ze.dateFormat,timeFormat:Ze.timeFormat,unlinkPanels:Ze.unlinkPanels,type:Ze.type,defaultValue:Ze.defaultValue,showNow:Ze.showNow,onPick:Re,onSelectRange:ue,onSetPickerOption:Xr,onCalendarChange:Rt,onPanelChange:_n,onMousedown:Yn(()=>{},["stop"])})]),_:3},16,["visible","transition","popper-class","popper-options","fallback-placements","placement"]))}});var e2=hn(EY,[["__file","picker.vue"]]);const MY=ln({...Q4,datetimeRole:String,parsedValue:{type:at(Object)}}),t2=({getAvailableHours:e,getAvailableMinutes:t,getAvailableSeconds:i})=>{const a=(_,x,o,C)=>{const k={hour:e,minute:t,second:i};let A=_;return["hour","minute","second"].forEach(z=>{if(k[z]){let N;const $=k[z];switch(z){case"minute":{N=$(A.hour(),x,C);break}case"second":{N=$(A.hour(),A.minute(),x,C);break}default:{N=$(x,C);break}}if(N!=null&&N.length&&!N.includes(A[z]())){const F=o?0:N.length-1;A=A[z](N[F])}}}),A},d={};return{timePickerOptions:d,getAvailableTime:a,onSetOption:([_,x])=>{d[_]=x}}},Ew=e=>{const t=(a,d)=>a||d,i=a=>a!==!0;return e.map(t).filter(i)},n2=(e,t,i)=>({getHoursList:(_,x)=>Cw(24,e&&(()=>e==null?void 0:e(_,x))),getMinutesList:(_,x,o)=>Cw(60,t&&(()=>t==null?void 0:t(_,x,o))),getSecondsList:(_,x,o,C)=>Cw(60,i&&(()=>i==null?void 0:i(_,x,o,C)))}),r2=(e,t,i)=>{const{getHoursList:a,getMinutesList:d,getSecondsList:m}=n2(e,t,i);return{getAvailableHours:(C,k)=>Ew(a(C,k)),getAvailableMinutes:(C,k,A)=>Ew(d(C,k,A)),getAvailableSeconds:(C,k,A,z)=>Ew(m(C,k,A,z))}},o2=e=>{const t=be(e.parsedValue);return Wt(()=>e.visible,i=>{i||(t.value=e.parsedValue)}),t},Bu=new Map;if(Hr){let e;document.addEventListener("mousedown",t=>e=t),document.addEventListener("mouseup",t=>{if(e){for(const i of Bu.values())for(const{documentHandler:a}of i)a(t,e);e=void 0}})}function hR(e,t){let i=[];return on(t.arg)?i=t.arg:ga(t.arg)&&i.push(t.arg),function(a,d){const m=t.instance.popperRef,_=a.target,x=d==null?void 0:d.target,o=!t||!t.instance,C=!_||!x,k=e.contains(_)||e.contains(x),A=e===_,z=i.length&&i.some($=>$==null?void 0:$.contains(_))||i.length&&i.includes(x),N=m&&(m.contains(_)||m.contains(x));o||C||k||A||z||N||t.value(a,d)}}const Rc={beforeMount(e,t){Bu.has(e)||Bu.set(e,[]),Bu.get(e).push({documentHandler:hR(e,t),bindingFn:t.value})},updated(e,t){Bu.has(e)||Bu.set(e,[]);const i=Bu.get(e),a=i.findIndex(m=>m.bindingFn===t.oldValue),d={documentHandler:hR(e,t),bindingFn:t.value};a>=0?i.splice(a,1,d):i.push(d)},unmounted(e){Bu.delete(e)}},IY=100,kY=600,cb={beforeMount(e,t){const i=t.value,{interval:a=IY,delay:d=kY}=Fn(i)?{}:i;let m,_;const x=()=>Fn(i)?i():i.handler(),o=()=>{_&&(clearTimeout(_),_=void 0),m&&(clearInterval(m),m=void 0)};e.addEventListener("mousedown",C=>{C.button===0&&(o(),x(),document.addEventListener("mouseup",()=>o(),{once:!0}),_=setTimeout(()=>{m=setInterval(()=>{x()},a)},d))})}},TS="_trap-focus-children",hh=[],fR=e=>{if(hh.length===0)return;const t=hh[hh.length-1][TS];if(t.length>0&&e.code===En.tab){if(t.length===1){e.preventDefault(),document.activeElement!==t[0]&&t[0].focus();return}const i=e.shiftKey,a=e.target===t[0],d=e.target===t[t.length-1];a&&i&&(e.preventDefault(),t[t.length-1].focus()),d&&!i&&(e.preventDefault(),t[0].focus())}},AY={beforeMount(e){e[TS]=CA(e),hh.push(e),hh.length<=1&&document.addEventListener("keydown",fR)},updated(e){Vn(()=>{e[TS]=CA(e)})},unmounted(){hh.shift(),hh.length===0&&document.removeEventListener("keydown",fR)}};var pR=!1,lh,CS,ES,D0,L0,i2,O0,MS,IS,kS,s2,AS,PS,a2,l2;function Ws(){if(!pR){pR=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),i=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(AS=/\b(iPhone|iP[ao]d)/.exec(e),PS=/\b(iP[ao]d)/.exec(e),kS=/Android/i.exec(e),a2=/FBAN\/\w+;/i.exec(e),l2=/Mobile/i.exec(e),s2=!!/Win64/.exec(e),t){lh=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,lh&&document&&document.documentMode&&(lh=document.documentMode);var a=/(?:Trident\/(\d+.\d+))/.exec(e);i2=a?parseFloat(a[1])+4:lh,CS=t[2]?parseFloat(t[2]):NaN,ES=t[3]?parseFloat(t[3]):NaN,D0=t[4]?parseFloat(t[4]):NaN,D0?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),L0=t&&t[1]?parseFloat(t[1]):NaN):L0=NaN}else lh=CS=ES=L0=D0=NaN;if(i){if(i[1]){var d=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);O0=d?parseFloat(d[1].replace("_",".")):!0}else O0=!1;MS=!!i[2],IS=!!i[3]}else O0=MS=IS=!1}}var RS={ie:function(){return Ws()||lh},ieCompatibilityMode:function(){return Ws()||i2>lh},ie64:function(){return RS.ie()&&s2},firefox:function(){return Ws()||CS},opera:function(){return Ws()||ES},webkit:function(){return Ws()||D0},safari:function(){return RS.webkit()},chrome:function(){return Ws()||L0},windows:function(){return Ws()||MS},osx:function(){return Ws()||O0},linux:function(){return Ws()||IS},iphone:function(){return Ws()||AS},mobile:function(){return Ws()||AS||PS||kS||l2},nativeApp:function(){return Ws()||a2},android:function(){return Ws()||kS},ipad:function(){return Ws()||PS}},PY=RS,y0=!!(typeof window<"u"&&window.document&&window.document.createElement),RY={canUseDOM:y0,canUseWorkers:typeof Worker<"u",canUseEventListeners:y0&&!!(window.addEventListener||window.attachEvent),canUseViewport:y0&&!!window.screen,isInWorker:!y0},c2=RY,u2;c2.canUseDOM&&(u2=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function DY(e,t){if(!c2.canUseDOM||t&&!("addEventListener"in document))return!1;var i="on"+e,a=i in document;if(!a){var d=document.createElement("div");d.setAttribute(i,"return;"),a=typeof d[i]=="function"}return!a&&u2&&e==="wheel"&&(a=document.implementation.hasFeature("Events.wheel","3.0")),a}var LY=DY,mR=10,gR=40,vR=800;function d2(e){var t=0,i=0,a=0,d=0;return"detail"in e&&(i=e.detail),"wheelDelta"in e&&(i=-e.wheelDelta/120),"wheelDeltaY"in e&&(i=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=i,i=0),a=t*mR,d=i*mR,"deltaY"in e&&(d=e.deltaY),"deltaX"in e&&(a=e.deltaX),(a||d)&&e.deltaMode&&(e.deltaMode==1?(a*=gR,d*=gR):(a*=vR,d*=vR)),a&&!t&&(t=a<1?-1:1),d&&!i&&(i=d<1?-1:1),{spinX:t,spinY:i,pixelX:a,pixelY:d}}d2.getEventType=function(){return PY.firefox()?"DOMMouseScroll":LY("wheel")?"wheel":"mousewheel"};var OY=d2;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const zY=function(e,t){if(e&&e.addEventListener){const i=function(a){const d=OY(a);t&&Reflect.apply(t,this,[a,d])};e.addEventListener("wheel",i,{passive:!0})}},BY={beforeMount(e,t){zY(e,t.value)}},FY=ln({role:{type:String,required:!0},spinnerDate:{type:at(Object),required:!0},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:at(String),default:""},...J4}),NY=Ge({__name:"basic-time-spinner",props:FY,emits:["change","select-range","set-option"],setup(e,{emit:t}){const i=e,a=kn("EP_PICKER_BASE"),{isRange:d}=a.props,m=Jt("time"),{getHoursList:_,getMinutesList:x,getSecondsList:o}=n2(i.disabledHours,i.disabledMinutes,i.disabledSeconds);let C=!1;const k=be(),A=be(),z=be(),N=be(),$={hours:A,minutes:z,seconds:N},F=Q(()=>i.showSeconds?aR:aR.slice(0,2)),G=Q(()=>{const{spinnerDate:Fe}=i,it=Fe.hour(),We=Fe.minute(),ut=Fe.second();return{hours:it,minutes:We,seconds:ut}}),U=Q(()=>{const{hours:Fe,minutes:it}=y(G),{role:We,spinnerDate:ut}=i,Lt=d?void 0:ut;return{hours:_(We,Lt),minutes:x(Fe,We,Lt),seconds:o(Fe,it,We,Lt)}}),te=Q(()=>{const{hours:Fe,minutes:it,seconds:We}=y(G);return{hours:Tw(Fe,23),minutes:Tw(it,59),seconds:Tw(We,59)}}),Z=Js(Fe=>{C=!1,ie(Fe)},200),q=Fe=>{if(!!!i.amPmMode)return"";const We=i.amPmMode==="A";let ut=Fe<12?" am":" pm";return We&&(ut=ut.toUpperCase()),ut},X=Fe=>{let it;switch(Fe){case"hours":it=[0,2];break;case"minutes":it=[3,5];break;case"seconds":it=[6,8];break}const[We,ut]=it;t("select-range",We,ut),k.value=Fe},ie=Fe=>{pe(Fe,y(G)[Fe])},de=()=>{ie("hours"),ie("minutes"),ie("seconds")},le=Fe=>Fe.querySelector(`.${m.namespace.value}-scrollbar__wrap`),pe=(Fe,it)=>{if(i.arrowControl)return;const We=y($[Fe]);We&&We.$el&&(le(We.$el).scrollTop=Math.max(0,it*ge(Fe)))},ge=Fe=>{const it=y($[Fe]),We=it==null?void 0:it.$el.querySelector("li");return We&&Number.parseFloat(Uu(We,"height"))||0},he=()=>{Re(1)},ue=()=>{Re(-1)},Re=Fe=>{k.value||X("hours");const it=k.value,We=y(G)[it],ut=k.value==="hours"?24:60,Lt=Ye(it,We,Fe,ut);Ie(it,Lt),pe(it,Lt),Vn(()=>X(it))},Ye=(Fe,it,We,ut)=>{let Lt=(it+We+ut)%ut;const Ft=y(U)[Fe];for(;Ft[Lt]&&Lt!==it;)Lt=(Lt+We+ut)%ut;return Lt},Ie=(Fe,it)=>{if(y(U)[Fe][it])return;const{hours:Lt,minutes:Ft,seconds:mt}=y(G);let jt;switch(Fe){case"hours":jt=i.spinnerDate.hour(it).minute(Ft).second(mt);break;case"minutes":jt=i.spinnerDate.hour(Lt).minute(it).second(mt);break;case"seconds":jt=i.spinnerDate.hour(Lt).minute(Ft).second(it);break}t("change",jt)},fe=(Fe,{value:it,disabled:We})=>{We||(Ie(Fe,it),X(Fe),pe(Fe,it))},Me=Fe=>{const it=y($[Fe]);if(!it)return;C=!0,Z(Fe);const We=Math.min(Math.round((le(it.$el).scrollTop-(Se(Fe)*.5-10)/ge(Fe)+3)/ge(Fe)),Fe==="hours"?23:59);Ie(Fe,We)},Se=Fe=>y($[Fe]).$el.offsetHeight,ye=()=>{const Fe=it=>{const We=y($[it]);We&&We.$el&&(le(We.$el).onscroll=()=>{Me(it)})};Fe("hours"),Fe("minutes"),Fe("seconds")};vr(()=>{Vn(()=>{!i.arrowControl&&ye(),de(),i.role==="start"&&X("hours")})});const Ce=(Fe,it)=>{$[it].value=Fe??void 0};return t("set-option",[`${i.role}_scrollDown`,Re]),t("set-option",[`${i.role}_emitSelectRange`,X]),Wt(()=>i.spinnerDate,()=>{C||de()}),(Fe,it)=>(se(),Ae("div",{class:ce([y(m).b("spinner"),{"has-seconds":Fe.showSeconds}])},[Fe.arrowControl?bt("v-if",!0):(se(!0),Ae(Bn,{key:0},Fr(y(F),We=>(se(),It(y(rc),{key:We,ref_for:!0,ref:ut=>Ce(ut,We),class:ce(y(m).be("spinner","wrapper")),"wrap-style":"max-height: inherit;","view-class":y(m).be("spinner","list"),noresize:"",tag:"ul",onMouseenter:ut=>X(We),onMousemove:ut=>ie(We)},{default:st(()=>[(se(!0),Ae(Bn,null,Fr(y(U)[We],(ut,Lt)=>(se(),Ae("li",{key:Lt,class:ce([y(m).be("spinner","item"),y(m).is("active",Lt===y(G)[We]),y(m).is("disabled",ut)]),onClick:Ft=>fe(We,{value:Lt,disabled:ut})},[We==="hours"?(se(),Ae(Bn,{key:0},[$r(fn(("0"+(Fe.amPmMode?Lt%12||12:Lt)).slice(-2))+fn(q(Lt)),1)],64)):(se(),Ae(Bn,{key:1},[$r(fn(("0"+Lt).slice(-2)),1)],64))],10,["onClick"]))),128))]),_:2},1032,["class","view-class","onMouseenter","onMousemove"]))),128)),Fe.arrowControl?(se(!0),Ae(Bn,{key:1},Fr(y(F),We=>(se(),Ae("div",{key:We,class:ce([y(m).be("spinner","wrapper"),y(m).is("arrow")]),onMouseenter:ut=>X(We)},[mr((se(),It(y(Dn),{class:ce(["arrow-up",y(m).be("spinner","arrow")])},{default:st(()=>[qe(y(nC))]),_:1},8,["class"])),[[y(cb),ue]]),mr((se(),It(y(Dn),{class:ce(["arrow-down",y(m).be("spinner","arrow")])},{default:st(()=>[qe(y(Bc))]),_:1},8,["class"])),[[y(cb),he]]),Ve("ul",{class:ce(y(m).be("spinner","list"))},[(se(!0),Ae(Bn,null,Fr(y(te)[We],(ut,Lt)=>(se(),Ae("li",{key:Lt,class:ce([y(m).be("spinner","item"),y(m).is("active",ut===y(G)[We]),y(m).is("disabled",y(U)[We][ut])])},[y(Wn)(ut)?(se(),Ae(Bn,{key:0},[We==="hours"?(se(),Ae(Bn,{key:0},[$r(fn(("0"+(Fe.amPmMode?ut%12||12:ut)).slice(-2))+fn(q(ut)),1)],64)):(se(),Ae(Bn,{key:1},[$r(fn(("0"+ut).slice(-2)),1)],64))],64)):bt("v-if",!0)],2))),128))],2)],42,["onMouseenter"]))),128)):bt("v-if",!0)],2))}});var DS=hn(NY,[["__file","basic-time-spinner.vue"]]);const $Y=Ge({__name:"panel-time-pick",props:MY,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const i=e,a=kn("EP_PICKER_BASE"),{arrowControl:d,disabledHours:m,disabledMinutes:_,disabledSeconds:x,defaultValue:o}=a.props,{getAvailableHours:C,getAvailableMinutes:k,getAvailableSeconds:A}=r2(m,_,x),z=Jt("time"),{t:N,lang:$}=Gr(),F=be([0,2]),G=o2(i),U=Q(()=>Bo(i.actualVisible)?`${z.namespace.value}-zoom-in-top`:""),te=Q(()=>i.format.includes("ss")),Z=Q(()=>i.format.includes("A")?"A":i.format.includes("a")?"a":""),q=Se=>{const ye=sr(Se).locale($.value),Ce=Ye(ye);return ye.isSame(Ce)},X=()=>{t("pick",G.value,!1)},ie=(Se=!1,ye=!1)=>{ye||t("pick",i.parsedValue,Se)},de=Se=>{if(!i.visible)return;const ye=Ye(Se).millisecond(0);t("pick",ye,!0)},le=(Se,ye)=>{t("select-range",Se,ye),F.value=[Se,ye]},pe=Se=>{const ye=[0,3].concat(te.value?[6]:[]),Ce=["hours","minutes"].concat(te.value?["seconds"]:[]),it=(ye.indexOf(F.value[0])+Se+ye.length)%ye.length;he.start_emitSelectRange(Ce[it])},ge=Se=>{const ye=Se.code,{left:Ce,right:Fe,up:it,down:We}=En;if([Ce,Fe].includes(ye)){pe(ye===Ce?-1:1),Se.preventDefault();return}if([it,We].includes(ye)){const ut=ye===it?-1:1;he.start_scrollDown(ut),Se.preventDefault();return}},{timePickerOptions:he,onSetOption:ue,getAvailableTime:Re}=t2({getAvailableHours:C,getAvailableMinutes:k,getAvailableSeconds:A}),Ye=Se=>Re(Se,i.datetimeRole||"",!0),Ie=Se=>Se?sr(Se,i.format).locale($.value):null,fe=Se=>Se?Se.format(i.format):null,Me=()=>sr(o).locale($.value);return t("set-picker-option",["isValidValue",q]),t("set-picker-option",["formatToString",fe]),t("set-picker-option",["parseUserInput",Ie]),t("set-picker-option",["handleKeydownInput",ge]),t("set-picker-option",["getRangeAvailableTime",Ye]),t("set-picker-option",["getDefaultValue",Me]),(Se,ye)=>(se(),It(Fi,{name:y(U)},{default:st(()=>[Se.actualVisible||Se.visible?(se(),Ae("div",{key:0,class:ce(y(z).b("panel"))},[Ve("div",{class:ce([y(z).be("panel","content"),{"has-seconds":y(te)}])},[qe(DS,{ref:"spinner",role:Se.datetimeRole||"start","arrow-control":y(d),"show-seconds":y(te),"am-pm-mode":y(Z),"spinner-date":Se.parsedValue,"disabled-hours":y(m),"disabled-minutes":y(_),"disabled-seconds":y(x),onChange:de,onSetOption:y(ue),onSelectRange:le},null,8,["role","arrow-control","show-seconds","am-pm-mode","spinner-date","disabled-hours","disabled-minutes","disabled-seconds","onSetOption"])],2),Ve("div",{class:ce(y(z).be("panel","footer"))},[Ve("button",{type:"button",class:ce([y(z).be("panel","btn"),"cancel"]),onClick:X},fn(y(N)("el.datepicker.cancel")),3),Ve("button",{type:"button",class:ce([y(z).be("panel","btn"),"confirm"]),onClick:Ce=>ie()},fn(y(N)("el.datepicker.confirm")),11,["onClick"])],2)],2)):bt("v-if",!0)]),_:1},8,["name"]))}});var ub=hn($Y,[["__file","panel-time-pick.vue"]]);const VY=ln({...Q4,parsedValue:{type:at(Array)}}),UY=Ge({__name:"panel-time-range",props:VY,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const i=e,a=(Pe,At)=>{const He=[];for(let pt=Pe;pt<=At;pt++)He.push(pt);return He},{t:d,lang:m}=Gr(),_=Jt("time"),x=Jt("picker"),o=kn("EP_PICKER_BASE"),{arrowControl:C,disabledHours:k,disabledMinutes:A,disabledSeconds:z,defaultValue:N}=o.props,$=Q(()=>[_.be("range-picker","body"),_.be("panel","content"),_.is("arrow",C),q.value?"has-seconds":""]),F=Q(()=>[_.be("range-picker","body"),_.be("panel","content"),_.is("arrow",C),q.value?"has-seconds":""]),G=Q(()=>i.parsedValue[0]),U=Q(()=>i.parsedValue[1]),te=o2(i),Z=()=>{t("pick",te.value,!1)},q=Q(()=>i.format.includes("ss")),X=Q(()=>i.format.includes("A")?"A":i.format.includes("a")?"a":""),ie=(Pe=!1)=>{t("pick",[G.value,U.value],Pe)},de=Pe=>{ge(Pe.millisecond(0),U.value)},le=Pe=>{ge(G.value,Pe.millisecond(0))},pe=Pe=>{const At=Pe.map(pt=>sr(pt).locale(m.value)),He=Fe(At);return At[0].isSame(He[0])&&At[1].isSame(He[1])},ge=(Pe,At)=>{t("pick",[Pe,At],!0)},he=Q(()=>G.value>U.value),ue=be([0,2]),Re=(Pe,At)=>{t("select-range",Pe,At,"min"),ue.value=[Pe,At]},Ye=Q(()=>q.value?11:8),Ie=(Pe,At)=>{t("select-range",Pe,At,"max");const He=y(Ye);ue.value=[Pe+He,At+He]},fe=Pe=>{const At=q.value?[0,3,6,11,14,17]:[0,3,8,11],He=["hours","minutes"].concat(q.value?["seconds"]:[]),et=(At.indexOf(ue.value[0])+Pe+At.length)%At.length,rn=At.length/2;et<rn?Lt.start_emitSelectRange(He[et]):Lt.end_emitSelectRange(He[et-rn])},Me=Pe=>{const At=Pe.code,{left:He,right:pt,up:et,down:rn}=En;if([He,pt].includes(At)){fe(At===He?-1:1),Pe.preventDefault();return}if([et,rn].includes(At)){const kt=At===et?-1:1,zt=ue.value[0]<Ye.value?"start":"end";Lt[`${zt}_scrollDown`](kt),Pe.preventDefault();return}},Se=(Pe,At)=>{const He=k?k(Pe):[],pt=Pe==="start",rn=(At||(pt?U.value:G.value)).hour(),kt=pt?a(rn+1,23):a(0,rn-1);return mw(He,kt)},ye=(Pe,At,He)=>{const pt=A?A(Pe,At):[],et=At==="start",rn=He||(et?U.value:G.value),kt=rn.hour();if(Pe!==kt)return pt;const zt=rn.minute(),Mt=et?a(zt+1,59):a(0,zt-1);return mw(pt,Mt)},Ce=(Pe,At,He,pt)=>{const et=z?z(Pe,At,He):[],rn=He==="start",kt=pt||(rn?U.value:G.value),zt=kt.hour(),Mt=kt.minute();if(Pe!==zt||At!==Mt)return et;const en=kt.second(),sn=rn?a(en+1,59):a(0,en-1);return mw(et,sn)},Fe=([Pe,At])=>[Ft(Pe,"start",!0,At),Ft(At,"end",!1,Pe)],{getAvailableHours:it,getAvailableMinutes:We,getAvailableSeconds:ut}=r2(Se,ye,Ce),{timePickerOptions:Lt,getAvailableTime:Ft,onSetOption:mt}=t2({getAvailableHours:it,getAvailableMinutes:We,getAvailableSeconds:ut}),jt=Pe=>Pe?on(Pe)?Pe.map(At=>sr(At,i.format).locale(m.value)):sr(Pe,i.format).locale(m.value):null,Ht=Pe=>Pe?on(Pe)?Pe.map(At=>At.format(i.format)):Pe.format(i.format):null,Tn=()=>{if(on(N))return N.map(At=>sr(At).locale(m.value));const Pe=sr(N).locale(m.value);return[Pe,Pe.add(60,"m")]};return t("set-picker-option",["formatToString",Ht]),t("set-picker-option",["parseUserInput",jt]),t("set-picker-option",["isValidValue",pe]),t("set-picker-option",["handleKeydownInput",Me]),t("set-picker-option",["getDefaultValue",Tn]),t("set-picker-option",["getRangeAvailableTime",Fe]),(Pe,At)=>Pe.actualVisible?(se(),Ae("div",{key:0,class:ce([y(_).b("range-picker"),y(x).b("panel")])},[Ve("div",{class:ce(y(_).be("range-picker","content"))},[Ve("div",{class:ce(y(_).be("range-picker","cell"))},[Ve("div",{class:ce(y(_).be("range-picker","header"))},fn(y(d)("el.datepicker.startTime")),3),Ve("div",{class:ce(y($))},[qe(DS,{ref:"minSpinner",role:"start","show-seconds":y(q),"am-pm-mode":y(X),"arrow-control":y(C),"spinner-date":y(G),"disabled-hours":Se,"disabled-minutes":ye,"disabled-seconds":Ce,onChange:de,onSetOption:y(mt),onSelectRange:Re},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),Ve("div",{class:ce(y(_).be("range-picker","cell"))},[Ve("div",{class:ce(y(_).be("range-picker","header"))},fn(y(d)("el.datepicker.endTime")),3),Ve("div",{class:ce(y(F))},[qe(DS,{ref:"maxSpinner",role:"end","show-seconds":y(q),"am-pm-mode":y(X),"arrow-control":y(C),"spinner-date":y(U),"disabled-hours":Se,"disabled-minutes":ye,"disabled-seconds":Ce,onChange:le,onSetOption:y(mt),onSelectRange:Ie},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),Ve("div",{class:ce(y(_).be("panel","footer"))},[Ve("button",{type:"button",class:ce([y(_).be("panel","btn"),"cancel"]),onClick:He=>Z()},fn(y(d)("el.datepicker.cancel")),11,["onClick"]),Ve("button",{type:"button",class:ce([y(_).be("panel","btn"),"confirm"]),disabled:y(he),onClick:He=>ie()},fn(y(d)("el.datepicker.confirm")),11,["disabled","onClick"])],2)],2)):bt("v-if",!0)}});var jY=hn(UY,[["__file","panel-time-range.vue"]]);sr.extend(zC);var HY=Ge({name:"ElTimePicker",install:null,props:{...BC,isRange:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,t){const i=be(),[a,d]=e.isRange?["timerange",jY]:["time",ub],m=_=>t.emit("update:modelValue",_);return Br("ElPopperOptions",e.popperOptions),t.expose({focus:()=>{var _;(_=i.value)==null||_.focus()},blur:()=>{var _;(_=i.value)==null||_.blur()},handleOpen:()=>{var _;(_=i.value)==null||_.handleOpen()},handleClose:()=>{var _;(_=i.value)==null||_.handleClose()}}),()=>{var _;const x=(_=e.format)!=null?_:SS;return qe(e2,kr(e,{ref:i,type:a,format:x,"onUpdate:modelValue":m}),{default:o=>qe(d,o,null)})}}});const GY=cr(HY),WY=(e,t)=>{const i=e.subtract(1,"month").endOf("month").date();return Zu(t).map((a,d)=>i-(t-d-1))},qY=e=>{const t=e.daysInMonth();return Zu(t).map((i,a)=>a+1)},KY=e=>Zu(e.length/7).map(t=>{const i=t*7;return e.slice(i,i+7)}),ZY=ln({selectedDay:{type:at(Object)},range:{type:at(Array)},date:{type:at(Object),required:!0},hideHeader:{type:Boolean}}),YY={pick:e=>Tr(e)};var h2={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Ql,function(){return function(i,a,d){var m=a.prototype,_=function(A){return A&&(A.indexOf?A:A.s)},x=function(A,z,N,$,F){var G=A.name?A:A.$locale(),U=_(G[z]),te=_(G[N]),Z=U||te.map(function(X){return X.slice(0,$)});if(!F)return Z;var q=G.weekStart;return Z.map(function(X,ie){return Z[(ie+(q||0))%7]})},o=function(){return d.Ls[d.locale()]},C=function(A,z){return A.formats[z]||function(N){return N.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function($,F,G){return F||G.slice(1)})}(A.formats[z.toUpperCase()])},k=function(){var A=this;return{months:function(z){return z?z.format("MMMM"):x(A,"months")},monthsShort:function(z){return z?z.format("MMM"):x(A,"monthsShort","months",3)},firstDayOfWeek:function(){return A.$locale().weekStart||0},weekdays:function(z){return z?z.format("dddd"):x(A,"weekdays")},weekdaysMin:function(z){return z?z.format("dd"):x(A,"weekdaysMin","weekdays",2)},weekdaysShort:function(z){return z?z.format("ddd"):x(A,"weekdaysShort","weekdays",3)},longDateFormat:function(z){return C(A.$locale(),z)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};m.localeData=function(){return k.bind(this)()},d.localeData=function(){var A=o();return{firstDayOfWeek:function(){return A.weekStart||0},weekdays:function(){return d.weekdays()},weekdaysShort:function(){return d.weekdaysShort()},weekdaysMin:function(){return d.weekdaysMin()},months:function(){return d.months()},monthsShort:function(){return d.monthsShort()},longDateFormat:function(z){return C(A,z)},meridiem:A.meridiem,ordinal:A.ordinal}},d.months=function(){return x(o(),"months")},d.monthsShort=function(){return x(o(),"monthsShort","months",3)},d.weekdays=function(A){return x(o(),"weekdays",null,null,A)},d.weekdaysShort=function(A){return x(o(),"weekdaysShort","weekdays",3,A)},d.weekdaysMin=function(A){return x(o(),"weekdaysMin","weekdays",2,A)}}})})(h2);var XY=h2.exports;const f2=ec(XY),JY=(e,t)=>{sr.extend(f2);const i=sr.localeData().firstDayOfWeek(),{t:a,lang:d}=Gr(),m=sr().locale(d.value),_=Q(()=>!!e.range&&!!e.range.length),x=Q(()=>{let z=[];if(_.value){const[N,$]=e.range,F=Zu($.date()-N.date()+1).map(te=>({text:N.date()+te,type:"current"}));let G=F.length%7;G=G===0?0:7-G;const U=Zu(G).map((te,Z)=>({text:Z+1,type:"next"}));z=F.concat(U)}else{const N=e.date.startOf("month").day(),$=WY(e.date,(N-i+7)%7).map(te=>({text:te,type:"prev"})),F=qY(e.date).map(te=>({text:te,type:"current"}));z=[...$,...F];const G=7-(z.length%7||7),U=Zu(G).map((te,Z)=>({text:Z+1,type:"next"}));z=z.concat(U)}return KY(z)}),o=Q(()=>{const z=i;return z===0?gw.map(N=>a(`el.datepicker.weeks.${N}`)):gw.slice(z).concat(gw.slice(0,z)).map(N=>a(`el.datepicker.weeks.${N}`))}),C=(z,N)=>{switch(N){case"prev":return e.date.startOf("month").subtract(1,"month").date(z);case"next":return e.date.startOf("month").add(1,"month").date(z);case"current":return e.date.date(z)}};return{now:m,isInRange:_,rows:x,weekDays:o,getFormattedDate:C,handlePickDay:({text:z,type:N})=>{const $=C(z,N);t("pick",$)},getSlotData:({text:z,type:N})=>{const $=C(z,N);return{isSelected:$.isSame(e.selectedDay),type:`${N}-month`,day:$.format("YYYY-MM-DD"),date:$.toDate()}}}},QY=Ge({name:"DateTable"}),eX=Ge({...QY,props:ZY,emits:YY,setup(e,{expose:t,emit:i}){const a=e,{isInRange:d,now:m,rows:_,weekDays:x,getFormattedDate:o,handlePickDay:C,getSlotData:k}=JY(a,i),A=Jt("calendar-table"),z=Jt("calendar-day"),N=({text:$,type:F})=>{const G=[F];if(F==="current"){const U=o($,F);U.isSame(a.selectedDay,"day")&&G.push(z.is("selected")),U.isSame(m,"day")&&G.push(z.is("today"))}return G};return t({getFormattedDate:o}),($,F)=>(se(),Ae("table",{class:ce([y(A).b(),y(A).is("range",y(d))]),cellspacing:"0",cellpadding:"0"},[$.hideHeader?bt("v-if",!0):(se(),Ae("thead",{key:0},[(se(!0),Ae(Bn,null,Fr(y(x),G=>(se(),Ae("th",{key:G},fn(G),1))),128))])),Ve("tbody",null,[(se(!0),Ae(Bn,null,Fr(y(_),(G,U)=>(se(),Ae("tr",{key:U,class:ce({[y(A).e("row")]:!0,[y(A).em("row","hide-border")]:U===0&&$.hideHeader})},[(se(!0),Ae(Bn,null,Fr(G,(te,Z)=>(se(),Ae("td",{key:Z,class:ce(N(te)),onClick:q=>y(C)(te)},[Ve("div",{class:ce(y(z).b())},[_t($.$slots,"date-cell",{data:y(k)(te)},()=>[Ve("span",null,fn(te.text),1)])],2)],10,["onClick"]))),128))],2))),128))])],2))}});var _R=hn(eX,[["__file","date-table.vue"]]);const tX=(e,t)=>{const i=e.endOf("month"),a=t.startOf("month"),m=i.isSame(a,"week")?a.add(1,"week"):a;return[[e,i],[m.startOf("week"),t]]},nX=(e,t)=>{const i=e.endOf("month"),a=e.add(1,"month").startOf("month"),d=i.isSame(a,"week")?a.add(1,"week"):a,m=d.endOf("month"),_=t.startOf("month"),x=m.isSame(_,"week")?_.add(1,"week"):_;return[[e,i],[d.startOf("week"),m],[x.startOf("week"),t]]},rX=(e,t,i)=>{const{lang:a}=Gr(),d=be(),m=sr().locale(a.value),_=Q({get(){return e.modelValue?o.value:d.value},set(G){if(!G)return;d.value=G;const U=G.toDate();t(zs,U),t(xr,U)}}),x=Q(()=>{if(!e.range||!on(e.range)||e.range.length!==2||e.range.some(Z=>!Yu(Z)))return[];const G=e.range.map(Z=>sr(Z).locale(a.value)),[U,te]=G;return U.isAfter(te)?[]:U.isSame(te,"month")?N(U,te):U.add(1,"month").month()!==te.month()?[]:N(U,te)}),o=Q(()=>e.modelValue?sr(e.modelValue).locale(a.value):_.value||(x.value.length?x.value[0][0]:m)),C=Q(()=>o.value.subtract(1,"month").date(1)),k=Q(()=>o.value.add(1,"month").date(1)),A=Q(()=>o.value.subtract(1,"year").date(1)),z=Q(()=>o.value.add(1,"year").date(1)),N=(G,U)=>{const te=G.startOf("week"),Z=U.endOf("week"),q=te.get("month"),X=Z.get("month");return q===X?[[te,Z]]:(q+1)%12===X?tX(te,Z):q+2===X||(q+1)%11===X?nX(te,Z):[]},$=G=>{_.value=G};return{calculateValidatedDateRange:N,date:o,realSelectedDay:_,pickDay:$,selectDate:G=>{const te={"prev-month":C.value,"next-month":k.value,"prev-year":A.value,"next-year":z.value,today:m}[G];te.isSame(o.value,"day")||$(te)},validatedRange:x}},oX=e=>on(e)&&e.length===2&&e.every(t=>Yu(t)),iX=ln({modelValue:{type:Date},range:{type:at(Array),validator:oX}}),sX={[xr]:e=>Yu(e),[zs]:e=>Yu(e)},aX="ElCalendar",lX=Ge({name:aX}),cX=Ge({...lX,props:iX,emits:sX,setup(e,{expose:t,emit:i}){const a=e,d=Jt("calendar"),{calculateValidatedDateRange:m,date:_,pickDay:x,realSelectedDay:o,selectDate:C,validatedRange:k}=rX(a,i),{t:A}=Gr(),z=Q(()=>{const N=`el.datepicker.month${_.value.format("M")}`;return`${_.value.year()} ${A("el.datepicker.year")} ${A(N)}`});return t({selectedDay:o,pickDay:x,selectDate:C,calculateValidatedDateRange:m}),(N,$)=>(se(),Ae("div",{class:ce(y(d).b())},[Ve("div",{class:ce(y(d).e("header"))},[_t(N.$slots,"header",{date:y(z)},()=>[Ve("div",{class:ce(y(d).e("title"))},fn(y(z)),3),y(k).length===0?(se(),Ae("div",{key:0,class:ce(y(d).e("button-group"))},[qe(y(q4),null,{default:st(()=>[qe(y(zi),{size:"small",onClick:F=>y(C)("prev-month")},{default:st(()=>[$r(fn(y(A)("el.datepicker.prevMonth")),1)]),_:1},8,["onClick"]),qe(y(zi),{size:"small",onClick:F=>y(C)("today")},{default:st(()=>[$r(fn(y(A)("el.datepicker.today")),1)]),_:1},8,["onClick"]),qe(y(zi),{size:"small",onClick:F=>y(C)("next-month")},{default:st(()=>[$r(fn(y(A)("el.datepicker.nextMonth")),1)]),_:1},8,["onClick"])]),_:1})],2)):bt("v-if",!0)])],2),y(k).length===0?(se(),Ae("div",{key:0,class:ce(y(d).e("body"))},[qe(_R,{date:y(_),"selected-day":y(o),onPick:y(x)},$a({_:2},[N.$slots["date-cell"]?{name:"date-cell",fn:st(F=>[_t(N.$slots,"date-cell",ul(Xu(F)))])}:void 0]),1032,["date","selected-day","onPick"])],2)):(se(),Ae("div",{key:1,class:ce(y(d).e("body"))},[(se(!0),Ae(Bn,null,Fr(y(k),(F,G)=>(se(),It(_R,{key:G,date:F[0],"selected-day":y(o),range:F,"hide-header":G!==0,onPick:y(x)},$a({_:2},[N.$slots["date-cell"]?{name:"date-cell",fn:st(U=>[_t(N.$slots,"date-cell",ul(Xu(U)))])}:void 0]),1032,["date","selected-day","range","hide-header","onPick"]))),128))],2))],2))}});var uX=hn(cX,[["__file","calendar.vue"]]);const dX=cr(uX),hX=ln({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:at([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),fX=Ge({name:"ElCard"}),pX=Ge({...fX,props:hX,setup(e){const t=Jt("card");return(i,a)=>(se(),Ae("div",{class:ce([y(t).b(),y(t).is(`${i.shadow}-shadow`)])},[i.$slots.header||i.header?(se(),Ae("div",{key:0,class:ce(y(t).e("header"))},[_t(i.$slots,"header",{},()=>[$r(fn(i.header),1)])],2)):bt("v-if",!0),Ve("div",{class:ce([y(t).e("body"),i.bodyClass]),style:Nn(i.bodyStyle)},[_t(i.$slots,"default")],6),i.$slots.footer||i.footer?(se(),Ae("div",{key:1,class:ce(y(t).e("footer"))},[_t(i.$slots,"footer",{},()=>[$r(fn(i.footer),1)])],2)):bt("v-if",!0)],2))}});var mX=hn(pX,[["__file","card.vue"]]);const gX=cr(mX),vX=ln({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},cardScale:{type:Number,default:.83},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0},motionBlur:Boolean}),_X={change:(e,t)=>[e,t].every(Wn)},p2=Symbol("carouselContextKey"),LS="ElCarouselItem",yR=300,yX=(e,t,i)=>{const{children:a,addChild:d,removeChild:m}=IC(Cr(),LS),_=Ai(),x=be(-1),o=be(null),C=be(!1),k=be(),A=be(0),z=be(!0),N=be(!0),$=be(!1),F=Q(()=>e.arrow!=="never"&&!y(te)),G=Q(()=>a.value.some(Ft=>Ft.props.label.toString().length>0)),U=Q(()=>e.type==="card"),te=Q(()=>e.direction==="vertical"),Z=Q(()=>e.height!=="auto"?{height:e.height}:{height:`${A.value}px`,overflow:"hidden"}),q=vh(Ft=>{ge(Ft)},yR,{trailing:!0}),X=vh(Ft=>{ye(Ft)},yR),ie=Ft=>z.value?x.value<=1?Ft<=1:Ft>1:!0;function de(){o.value&&(clearInterval(o.value),o.value=null)}function le(){e.interval<=0||!e.autoplay||o.value||(o.value=setInterval(()=>pe(),e.interval))}const pe=()=>{N.value||($.value=!0),N.value=!1,x.value<a.value.length-1?x.value=x.value+1:e.loop?x.value=0:$.value=!1};function ge(Ft){if(N.value||($.value=!0),N.value=!1,zn(Ft)){const Ht=a.value.filter(Tn=>Tn.props.name===Ft);Ht.length>0&&(Ft=a.value.indexOf(Ht[0]))}if(Ft=Number(Ft),Number.isNaN(Ft)||Ft!==Math.floor(Ft))return;const mt=a.value.length,jt=x.value;Ft<0?x.value=e.loop?mt-1:0:Ft>=mt?x.value=e.loop?0:mt-1:x.value=Ft,jt===x.value&&he(jt),it()}function he(Ft){a.value.forEach((mt,jt)=>{mt.translateItem(jt,x.value,Ft)})}function ue(Ft,mt){var jt,Ht,Tn,Pe;const At=y(a),He=At.length;if(He===0||!Ft.states.inStage)return!1;const pt=mt+1,et=mt-1,rn=He-1,kt=At[rn].states.active,zt=At[0].states.active,Mt=(Ht=(jt=At[pt])==null?void 0:jt.states)==null?void 0:Ht.active,en=(Pe=(Tn=At[et])==null?void 0:Tn.states)==null?void 0:Pe.active;return mt===rn&&zt||Mt?"left":mt===0&&kt||en?"right":!1}function Re(){C.value=!0,e.pauseOnHover&&de()}function Ye(){C.value=!1,le()}function Ie(){$.value=!1}function fe(Ft){y(te)||a.value.forEach((mt,jt)=>{Ft===ue(mt,jt)&&(mt.states.hover=!0)})}function Me(){y(te)||a.value.forEach(Ft=>{Ft.states.hover=!1})}function Se(Ft){Ft!==x.value&&(N.value||($.value=!0)),x.value=Ft}function ye(Ft){e.trigger==="hover"&&Ft!==x.value&&(x.value=Ft,N.value||($.value=!0))}function Ce(){ge(x.value-1)}function Fe(){ge(x.value+1)}function it(){de(),e.pauseOnHover||le()}function We(Ft){e.height==="auto"&&(A.value=Ft)}function ut(){var Ft;const mt=(Ft=_.default)==null?void 0:Ft.call(_);if(!mt)return null;const Ht=qu(mt).filter(Tn=>Ho(Tn)&&Tn.type.name===LS);return(Ht==null?void 0:Ht.length)===2&&e.loop&&!U.value?(z.value=!0,Ht):(z.value=!1,null)}Wt(()=>x.value,(Ft,mt)=>{he(mt),z.value&&(Ft=Ft%2,mt=mt%2),mt>-1&&t("change",Ft,mt)}),Wt(()=>e.autoplay,Ft=>{Ft?le():de()}),Wt(()=>e.loop,()=>{ge(x.value)}),Wt(()=>e.interval,()=>{it()});const Lt=Uo();return vr(()=>{Wt(()=>a.value,()=>{a.value.length>0&&ge(e.initialIndex)},{immediate:!0}),Lt.value=qo(k.value,()=>{he()}),le()}),Io(()=>{de(),k.value&&Lt.value&&Lt.value.stop()}),Br(p2,{root:k,isCardType:U,isVertical:te,items:a,loop:e.loop,cardScale:e.cardScale,addItem:d,removeItem:m,setActiveItem:ge,setContainerHeight:We}),{root:k,activeIndex:x,arrowDisplay:F,hasLabel:G,hover:C,isCardType:U,isTransitioning:$,items:a,isVertical:te,containerStyle:Z,isItemsTwoLength:z,handleButtonEnter:fe,handleTransitionEnd:Ie,handleButtonLeave:Me,handleIndicatorClick:Se,handleMouseEnter:Re,handleMouseLeave:Ye,setActiveItem:ge,prev:Ce,next:Fe,PlaceholderItem:ut,isTwoLengthShow:ie,throttledArrowClick:q,throttledIndicatorHover:X}},bX="ElCarousel",xX=Ge({name:bX}),wX=Ge({...xX,props:vX,emits:_X,setup(e,{expose:t,emit:i}){const a=e,{root:d,activeIndex:m,arrowDisplay:_,hasLabel:x,hover:o,isCardType:C,items:k,isVertical:A,containerStyle:z,handleButtonEnter:N,handleButtonLeave:$,isTransitioning:F,handleIndicatorClick:G,handleMouseEnter:U,handleMouseLeave:te,handleTransitionEnd:Z,setActiveItem:q,prev:X,next:ie,PlaceholderItem:de,isTwoLengthShow:le,throttledArrowClick:pe,throttledIndicatorHover:ge}=yX(a,i),he=Jt("carousel"),{t:ue}=Gr(),Re=Q(()=>{const fe=[he.b(),he.m(a.direction)];return y(C)&&fe.push(he.m("card")),fe}),Ye=Q(()=>{const fe=[he.e("container")];return a.motionBlur&&y(F)&&k.value.length>1&&fe.push(y(A)?`${he.namespace.value}-transitioning-vertical`:`${he.namespace.value}-transitioning`),fe}),Ie=Q(()=>{const fe=[he.e("indicators"),he.em("indicators",a.direction)];return y(x)&&fe.push(he.em("indicators","labels")),a.indicatorPosition==="outside"&&fe.push(he.em("indicators","outside")),y(A)&&fe.push(he.em("indicators","right")),fe});return t({activeIndex:m,setActiveItem:q,prev:X,next:ie}),(fe,Me)=>(se(),Ae("div",{ref_key:"root",ref:d,class:ce(y(Re)),onMouseenter:Yn(y(U),["stop"]),onMouseleave:Yn(y(te),["stop"])},[y(_)?(se(),It(Fi,{key:0,name:"carousel-arrow-left",persisted:""},{default:st(()=>[mr(Ve("button",{type:"button",class:ce([y(he).e("arrow"),y(he).em("arrow","left")]),"aria-label":y(ue)("el.carousel.leftArrow"),onMouseenter:Se=>y(N)("left"),onMouseleave:y($),onClick:Yn(Se=>y(pe)(y(m)-1),["stop"])},[qe(y(Dn),null,{default:st(()=>[qe(y(nd))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[no,(fe.arrow==="always"||y(o))&&(a.loop||y(m)>0)]])]),_:1})):bt("v-if",!0),y(_)?(se(),It(Fi,{key:1,name:"carousel-arrow-right",persisted:""},{default:st(()=>[mr(Ve("button",{type:"button",class:ce([y(he).e("arrow"),y(he).em("arrow","right")]),"aria-label":y(ue)("el.carousel.rightArrow"),onMouseenter:Se=>y(N)("right"),onMouseleave:y($),onClick:Yn(Se=>y(pe)(y(m)+1),["stop"])},[qe(y(Dn),null,{default:st(()=>[qe(y(Os))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[no,(fe.arrow==="always"||y(o))&&(a.loop||y(m)<y(k).length-1)]])]),_:1})):bt("v-if",!0),Ve("div",{class:ce(y(Ye)),style:Nn(y(z)),onTransitionend:y(Z)},[qe(y(de)),_t(fe.$slots,"default")],46,["onTransitionend"]),fe.indicatorPosition!=="none"?(se(),Ae("ul",{key:2,class:ce(y(Ie))},[(se(!0),Ae(Bn,null,Fr(y(k),(Se,ye)=>mr((se(),Ae("li",{key:ye,class:ce([y(he).e("indicator"),y(he).em("indicator",fe.direction),y(he).is("active",ye===y(m))]),onMouseenter:Ce=>y(ge)(ye),onClick:Yn(Ce=>y(G)(ye),["stop"])},[Ve("button",{class:ce(y(he).e("button")),"aria-label":y(ue)("el.carousel.indicator",{index:ye+1})},[y(x)?(se(),Ae("span",{key:0},fn(Se.props.label),1)):bt("v-if",!0)],10,["aria-label"])],42,["onMouseenter","onClick"])),[[no,y(le)(ye)]])),128))],2)):bt("v-if",!0),a.motionBlur?(se(),Ae("svg",{key:3,xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{display:"none"}},[Ve("defs",null,[Ve("filter",{id:"elCarouselHorizontal"},[Ve("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"12,0"})]),Ve("filter",{id:"elCarouselVertical"},[Ve("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"0,10"})])])])):bt("v-if",!0)],42,["onMouseenter","onMouseleave"]))}});var SX=hn(wX,[["__file","carousel.vue"]]);const TX=ln({name:{type:String,default:""},label:{type:[String,Number],default:""}}),CX=e=>{const t=kn(p2),i=Cr(),a=be(),d=be(!1),m=be(0),_=be(1),x=be(!1),o=be(!1),C=be(!1),k=be(!1),{isCardType:A,isVertical:z,cardScale:N}=t;function $(Z,q,X){const ie=X-1,de=q-1,le=q+1,pe=X/2;return q===0&&Z===ie?-1:q===ie&&Z===0?X:Z<de&&q-Z>=pe?X+1:Z>le&&Z-q>=pe?-2:Z}function F(Z,q){var X,ie;const de=y(z)?((X=t.root.value)==null?void 0:X.offsetHeight)||0:((ie=t.root.value)==null?void 0:ie.offsetWidth)||0;return C.value?de*((2-N)*(Z-q)+1)/4:Z<q?-(1+N)*de/4:(3+N)*de/4}function G(Z,q,X){const ie=t.root.value;return ie?((X?ie.offsetHeight:ie.offsetWidth)||0)*(Z-q):0}const U=(Z,q,X)=>{var ie;const de=y(A),le=(ie=t.items.value.length)!=null?ie:Number.NaN,pe=Z===q;!de&&!Bo(X)&&(k.value=pe||Z===X),!pe&&le>2&&t.loop&&(Z=$(Z,q,le));const ge=y(z);x.value=pe,de?(C.value=Math.round(Math.abs(Z-q))<=1,m.value=F(Z,q),_.value=y(x)?1:N):m.value=G(Z,q,ge),o.value=!0,pe&&a.value&&t.setContainerHeight(a.value.offsetHeight)};function te(){if(t&&y(A)){const Z=t.items.value.findIndex(({uid:q})=>q===i.uid);t.setActiveItem(Z)}}return vr(()=>{t.addItem({props:e,states:ao({hover:d,translate:m,scale:_,active:x,ready:o,inStage:C,animating:k}),uid:i.uid,translateItem:U})}),cd(()=>{t.removeItem(i.uid)}),{carouselItemRef:a,active:x,animating:k,hover:d,inStage:C,isVertical:z,translate:m,isCardType:A,scale:_,ready:o,handleItemClick:te}},EX=Ge({name:LS}),MX=Ge({...EX,props:TX,setup(e){const t=e,i=Jt("carousel"),{carouselItemRef:a,active:d,animating:m,hover:_,inStage:x,isVertical:o,translate:C,isCardType:k,scale:A,ready:z,handleItemClick:N}=CX(t),$=Q(()=>[i.e("item"),i.is("active",d.value),i.is("in-stage",x.value),i.is("hover",_.value),i.is("animating",m.value),{[i.em("item","card")]:k.value,[i.em("item","card-vertical")]:k.value&&o.value}]),F=Q(()=>{const U=`${`translate${y(o)?"Y":"X"}`}(${y(C)}px)`,te=`scale(${y(A)})`;return{transform:[U,te].join(" ")}});return(G,U)=>mr((se(),Ae("div",{ref_key:"carouselItemRef",ref:a,class:ce(y($)),style:Nn(y(F)),onClick:y(N)},[y(k)?mr((se(),Ae("div",{key:0,class:ce(y(i).e("mask"))},null,2)),[[no,!y(d)]]):bt("v-if",!0),_t(G.$slots,"default")],14,["onClick"])),[[no,y(z)]])}});var m2=hn(MX,[["__file","carousel-item.vue"]]);const IX=cr(SX,{CarouselItem:m2}),kX=Jo(m2),g2={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},value:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueValue:{type:[String,Number],default:void 0},falseValue:{type:[String,Number],default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},border:Boolean,size:Ei,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0},...qi(["ariaControls"])},v2={[xr]:e=>zn(e)||Wn(e)||ko(e),change:e=>zn(e)||Wn(e)||ko(e)},nm=Symbol("checkboxGroupContextKey"),AX=({model:e,isChecked:t})=>{const i=kn(nm,void 0),a=Q(()=>{var m,_;const x=(m=i==null?void 0:i.max)==null?void 0:m.value,o=(_=i==null?void 0:i.min)==null?void 0:_.value;return!Bo(x)&&e.value.length>=x&&!t.value||!Bo(o)&&e.value.length<=o&&t.value});return{isDisabled:ys(Q(()=>(i==null?void 0:i.disabled.value)||a.value)),isLimitDisabled:a}},PX=(e,{model:t,isLimitExceeded:i,hasOwnLabel:a,isDisabled:d,isLabeledByFormItem:m})=>{const _=kn(nm,void 0),{formItem:x}=bs(),{emit:o}=Cr();function C($){var F,G,U,te;return[!0,e.trueValue,e.trueLabel].includes($)?(G=(F=e.trueValue)!=null?F:e.trueLabel)!=null?G:!0:(te=(U=e.falseValue)!=null?U:e.falseLabel)!=null?te:!1}function k($,F){o("change",C($),F)}function A($){if(i.value)return;const F=$.target;o("change",C(F.checked),$)}async function z($){i.value||!a.value&&!d.value&&m.value&&($.composedPath().some(U=>U.tagName==="LABEL")||(t.value=C([!1,e.falseValue,e.falseLabel].includes(t.value)),await Vn(),k(t.value,$)))}const N=Q(()=>(_==null?void 0:_.validateEvent)||e.validateEvent);return Wt(()=>e.modelValue,()=>{N.value&&(x==null||x.validate("change").catch($=>void 0))}),{handleChange:A,onClickRoot:z}},RX=e=>{const t=be(!1),{emit:i}=Cr(),a=kn(nm,void 0),d=Q(()=>Bo(a)===!1),m=be(!1),_=Q({get(){var x,o;return d.value?(x=a==null?void 0:a.modelValue)==null?void 0:x.value:(o=e.modelValue)!=null?o:t.value},set(x){var o,C;d.value&&on(x)?(m.value=((o=a==null?void 0:a.max)==null?void 0:o.value)!==void 0&&x.length>(a==null?void 0:a.max.value)&&x.length>_.value.length,m.value===!1&&((C=a==null?void 0:a.changeEvent)==null||C.call(a,x))):(i(xr,x),t.value=x)}});return{model:_,isGroup:d,isLimitExceeded:m}},DX=(e,t,{model:i})=>{const a=kn(nm,void 0),d=be(!1),m=Q(()=>Eh(e.value)?e.label:e.value),_=Q(()=>{const k=i.value;return ko(k)?k:on(k)?Tr(m.value)?k.map(Eo).some(A=>Gi(A,m.value)):k.map(Eo).includes(m.value):k!=null?k===e.trueValue||k===e.trueLabel:!!k}),x=xi(Q(()=>{var k;return(k=a==null?void 0:a.size)==null?void 0:k.value}),{prop:!0}),o=xi(Q(()=>{var k;return(k=a==null?void 0:a.size)==null?void 0:k.value})),C=Q(()=>!!t.default||!Eh(m.value));return{checkboxButtonSize:x,isChecked:_,isFocused:d,checkboxSize:o,hasOwnLabel:C,actualValue:m}},_2=(e,t)=>{const{formItem:i}=bs(),{model:a,isGroup:d,isLimitExceeded:m}=RX(e),{isFocused:_,isChecked:x,checkboxButtonSize:o,checkboxSize:C,hasOwnLabel:k,actualValue:A}=DX(e,t,{model:a}),{isDisabled:z}=AX({model:a,isChecked:x}),{inputId:N,isLabeledByFormItem:$}=Sl(e,{formItemContext:i,disableIdGeneration:k,disableIdManagement:d}),{handleChange:F,onClickRoot:G}=PX(e,{model:a,isLimitExceeded:m,hasOwnLabel:k,isDisabled:z,isLabeledByFormItem:$});return(()=>{function te(){var Z,q;on(a.value)&&!a.value.includes(A.value)?a.value.push(A.value):a.value=(q=(Z=e.trueValue)!=null?Z:e.trueLabel)!=null?q:!0}e.checked&&te()})(),Ku({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},Q(()=>d.value&&Eh(e.value))),Ku({from:"true-label",replacement:"true-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},Q(()=>!!e.trueLabel)),Ku({from:"false-label",replacement:"false-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},Q(()=>!!e.falseLabel)),{inputId:N,isLabeledByFormItem:$,isChecked:x,isDisabled:z,isFocused:_,checkboxButtonSize:o,checkboxSize:C,hasOwnLabel:k,model:a,actualValue:A,handleChange:F,onClickRoot:G}},LX=Ge({name:"ElCheckbox"}),OX=Ge({...LX,props:g2,emits:v2,setup(e){const t=e,i=Ai(),{inputId:a,isLabeledByFormItem:d,isChecked:m,isDisabled:_,isFocused:x,checkboxSize:o,hasOwnLabel:C,model:k,actualValue:A,handleChange:z,onClickRoot:N}=_2(t,i),$=Jt("checkbox"),F=Q(()=>[$.b(),$.m(o.value),$.is("disabled",_.value),$.is("bordered",t.border),$.is("checked",m.value)]),G=Q(()=>[$.e("input"),$.is("disabled",_.value),$.is("checked",m.value),$.is("indeterminate",t.indeterminate),$.is("focus",x.value)]);return(U,te)=>(se(),It(Ir(!y(C)&&y(d)?"span":"label"),{class:ce(y(F)),"aria-controls":U.indeterminate?U.ariaControls:null,onClick:y(N)},{default:st(()=>{var Z,q,X,ie;return[Ve("span",{class:ce(y(G))},[U.trueValue||U.falseValue||U.trueLabel||U.falseLabel?mr((se(),Ae("input",{key:0,id:y(a),"onUpdate:modelValue":de=>Fo(k)?k.value=de:null,class:ce(y($).e("original")),type:"checkbox",indeterminate:U.indeterminate,name:U.name,tabindex:U.tabindex,disabled:y(_),"true-value":(q=(Z=U.trueValue)!=null?Z:U.trueLabel)!=null?q:!0,"false-value":(ie=(X=U.falseValue)!=null?X:U.falseLabel)!=null?ie:!1,onChange:y(z),onFocus:de=>x.value=!0,onBlur:de=>x.value=!1,onClick:Yn(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[eb,y(k)]]):mr((se(),Ae("input",{key:1,id:y(a),"onUpdate:modelValue":de=>Fo(k)?k.value=de:null,class:ce(y($).e("original")),type:"checkbox",indeterminate:U.indeterminate,disabled:y(_),value:y(A),name:U.name,tabindex:U.tabindex,onChange:y(z),onFocus:de=>x.value=!0,onBlur:de=>x.value=!1,onClick:Yn(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","disabled","value","name","tabindex","onChange","onFocus","onBlur","onClick"])),[[eb,y(k)]]),Ve("span",{class:ce(y($).e("inner"))},null,2)],2),y(C)?(se(),Ae("span",{key:0,class:ce(y($).e("label"))},[_t(U.$slots,"default"),U.$slots.default?bt("v-if",!0):(se(),Ae(Bn,{key:0},[$r(fn(U.label),1)],64))],2)):bt("v-if",!0)]}),_:3},8,["class","aria-controls","onClick"]))}});var zX=hn(OX,[["__file","checkbox.vue"]]);const BX=Ge({name:"ElCheckboxButton"}),FX=Ge({...BX,props:g2,emits:v2,setup(e){const t=e,i=Ai(),{isFocused:a,isChecked:d,isDisabled:m,checkboxButtonSize:_,model:x,actualValue:o,handleChange:C}=_2(t,i),k=kn(nm,void 0),A=Jt("checkbox"),z=Q(()=>{var $,F,G,U;const te=(F=($=k==null?void 0:k.fill)==null?void 0:$.value)!=null?F:"";return{backgroundColor:te,borderColor:te,color:(U=(G=k==null?void 0:k.textColor)==null?void 0:G.value)!=null?U:"",boxShadow:te?`-1px 0 0 0 ${te}`:void 0}}),N=Q(()=>[A.b("button"),A.bm("button",_.value),A.is("disabled",m.value),A.is("checked",d.value),A.is("focus",a.value)]);return($,F)=>{var G,U,te,Z;return se(),Ae("label",{class:ce(y(N))},[$.trueValue||$.falseValue||$.trueLabel||$.falseLabel?mr((se(),Ae("input",{key:0,"onUpdate:modelValue":q=>Fo(x)?x.value=q:null,class:ce(y(A).be("button","original")),type:"checkbox",name:$.name,tabindex:$.tabindex,disabled:y(m),"true-value":(U=(G=$.trueValue)!=null?G:$.trueLabel)!=null?U:!0,"false-value":(Z=(te=$.falseValue)!=null?te:$.falseLabel)!=null?Z:!1,onChange:y(C),onFocus:q=>a.value=!0,onBlur:q=>a.value=!1,onClick:Yn(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[eb,y(x)]]):mr((se(),Ae("input",{key:1,"onUpdate:modelValue":q=>Fo(x)?x.value=q:null,class:ce(y(A).be("button","original")),type:"checkbox",name:$.name,tabindex:$.tabindex,disabled:y(m),value:y(o),onChange:y(C),onFocus:q=>a.value=!0,onBlur:q=>a.value=!1,onClick:Yn(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","value","onChange","onFocus","onBlur","onClick"])),[[eb,y(x)]]),$.$slots.default||$.label?(se(),Ae("span",{key:2,class:ce(y(A).be("button","inner")),style:Nn(y(d)?y(z):void 0)},[_t($.$slots,"default",{},()=>[$r(fn($.label),1)])],6)):bt("v-if",!0)],2)}}});var y2=hn(FX,[["__file","checkbox-button.vue"]]);const NX=ln({modelValue:{type:at(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:Ei,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0},...qi(["ariaLabel"])}),$X={[xr]:e=>on(e),change:e=>on(e)},VX=Ge({name:"ElCheckboxGroup"}),UX=Ge({...VX,props:NX,emits:$X,setup(e,{emit:t}){const i=e,a=Jt("checkbox"),{formItem:d}=bs(),{inputId:m,isLabeledByFormItem:_}=Sl(i,{formItemContext:d}),x=async C=>{t(xr,C),await Vn(),t("change",C)},o=Q({get(){return i.modelValue},set(C){x(C)}});return Br(nm,{...dl(Bi(i),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:o,changeEvent:x}),Wt(()=>i.modelValue,()=>{i.validateEvent&&(d==null||d.validate("change").catch(C=>void 0))}),(C,k)=>{var A;return se(),It(Ir(C.tag),{id:y(m),class:ce(y(a).b("group")),role:"group","aria-label":y(_)?void 0:C.ariaLabel||"checkbox-group","aria-labelledby":y(_)?(A=y(d))==null?void 0:A.labelId:void 0},{default:st(()=>[_t(C.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var b2=hn(UX,[["__file","checkbox-group.vue"]]);const Ha=cr(zX,{CheckboxButton:y2,CheckboxGroup:b2}),jX=Jo(y2),x2=Jo(b2),w2=ln({modelValue:{type:[String,Number,Boolean],default:void 0},size:Ei,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),HX=ln({...w2,border:Boolean}),S2={[xr]:e=>zn(e)||Wn(e)||ko(e),[No]:e=>zn(e)||Wn(e)||ko(e)},T2=Symbol("radioGroupKey"),C2=(e,t)=>{const i=be(),a=kn(T2,void 0),d=Q(()=>!!a),m=Q(()=>Eh(e.value)?e.label:e.value),_=Q({get(){return d.value?a.modelValue:e.modelValue},set(A){d.value?a.changeEvent(A):t&&t(xr,A),i.value.checked=e.modelValue===m.value}}),x=xi(Q(()=>a==null?void 0:a.size)),o=ys(Q(()=>a==null?void 0:a.disabled)),C=be(!1),k=Q(()=>o.value||d.value&&_.value!==m.value?-1:0);return Ku({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},Q(()=>d.value&&Eh(e.value))),{radioRef:i,isGroup:d,radioGroup:a,focus:C,size:x,disabled:o,tabIndex:k,modelValue:_,actualValue:m}},GX=Ge({name:"ElRadio"}),WX=Ge({...GX,props:HX,emits:S2,setup(e,{emit:t}){const i=e,a=Jt("radio"),{radioRef:d,radioGroup:m,focus:_,size:x,disabled:o,modelValue:C,actualValue:k}=C2(i,t);function A(){Vn(()=>t("change",C.value))}return(z,N)=>{var $;return se(),Ae("label",{class:ce([y(a).b(),y(a).is("disabled",y(o)),y(a).is("focus",y(_)),y(a).is("bordered",z.border),y(a).is("checked",y(C)===y(k)),y(a).m(y(x))])},[Ve("span",{class:ce([y(a).e("input"),y(a).is("disabled",y(o)),y(a).is("checked",y(C)===y(k))])},[mr(Ve("input",{ref_key:"radioRef",ref:d,"onUpdate:modelValue":F=>Fo(C)?C.value=F:null,class:ce(y(a).e("original")),value:y(k),name:z.name||(($=y(m))==null?void 0:$.name),disabled:y(o),checked:y(C)===y(k),type:"radio",onFocus:F=>_.value=!0,onBlur:F=>_.value=!1,onChange:A,onClick:Yn(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","checked","onFocus","onBlur","onClick"]),[[LL,y(C)]]),Ve("span",{class:ce(y(a).e("inner"))},null,2)],2),Ve("span",{class:ce(y(a).e("label")),onKeydown:Yn(()=>{},["stop"])},[_t(z.$slots,"default",{},()=>[$r(fn(z.label),1)])],42,["onKeydown"])],2)}}});var qX=hn(WX,[["__file","radio.vue"]]);const KX=ln({...w2}),ZX=Ge({name:"ElRadioButton"}),YX=Ge({...ZX,props:KX,setup(e){const t=e,i=Jt("radio"),{radioRef:a,focus:d,size:m,disabled:_,modelValue:x,radioGroup:o,actualValue:C}=C2(t),k=Q(()=>({backgroundColor:(o==null?void 0:o.fill)||"",borderColor:(o==null?void 0:o.fill)||"",boxShadow:o!=null&&o.fill?`-1px 0 0 0 ${o.fill}`:"",color:(o==null?void 0:o.textColor)||""}));return(A,z)=>{var N;return se(),Ae("label",{class:ce([y(i).b("button"),y(i).is("active",y(x)===y(C)),y(i).is("disabled",y(_)),y(i).is("focus",y(d)),y(i).bm("button",y(m))])},[mr(Ve("input",{ref_key:"radioRef",ref:a,"onUpdate:modelValue":$=>Fo(x)?x.value=$:null,class:ce(y(i).be("button","original-radio")),value:y(C),type:"radio",name:A.name||((N=y(o))==null?void 0:N.name),disabled:y(_),onFocus:$=>d.value=!0,onBlur:$=>d.value=!1,onClick:Yn(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","onFocus","onBlur","onClick"]),[[LL,y(x)]]),Ve("span",{class:ce(y(i).be("button","inner")),style:Nn(y(x)===y(C)?y(k):{}),onKeydown:Yn(()=>{},["stop"])},[_t(A.$slots,"default",{},()=>[$r(fn(A.label),1)])],46,["onKeydown"])],2)}}});var E2=hn(YX,[["__file","radio-button.vue"]]);const XX=ln({id:{type:String,default:void 0},size:Ei,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0},...qi(["ariaLabel"])}),JX=S2,QX=Ge({name:"ElRadioGroup"}),eJ=Ge({...QX,props:XX,emits:JX,setup(e,{emit:t}){const i=e,a=Jt("radio"),d=Wi(),m=be(),{formItem:_}=bs(),{inputId:x,isLabeledByFormItem:o}=Sl(i,{formItemContext:_}),C=A=>{t(xr,A),Vn(()=>t("change",A))};vr(()=>{const A=m.value.querySelectorAll("[type=radio]"),z=A[0];!Array.from(A).some(N=>N.checked)&&z&&(z.tabIndex=0)});const k=Q(()=>i.name||d.value);return Br(T2,ao({...Bi(i),changeEvent:C,name:k})),Wt(()=>i.modelValue,()=>{i.validateEvent&&(_==null||_.validate("change").catch(A=>void 0))}),(A,z)=>(se(),Ae("div",{id:y(x),ref_key:"radioGroupRef",ref:m,class:ce(y(a).b("group")),role:"radiogroup","aria-label":y(o)?void 0:A.ariaLabel||"radio-group","aria-labelledby":y(o)?y(_).labelId:void 0},[_t(A.$slots,"default")],10,["id","aria-label","aria-labelledby"]))}});var M2=hn(eJ,[["__file","radio-group.vue"]]);const I2=cr(qX,{RadioButton:E2,RadioGroup:M2}),tJ=Jo(M2),nJ=Jo(E2);var rJ=Ge({name:"NodeContent",setup(){return{ns:Jt("cascader-node")}},render(){const{ns:e}=this,{node:t,panel:i}=this.$parent,{data:a,label:d}=t,{renderLabelFn:m}=i;return Kn("span",{class:e.e("label")},m?m({node:t,data:a}):d)}});const FC=Symbol(),oJ=Ge({name:"ElCascaderNode",components:{ElCheckbox:Ha,ElRadio:I2,NodeContent:rJ,ElIcon:Dn,Check:n_,Loading:Kl,ArrowRight:Os},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:t}){const i=kn(FC),a=Jt("cascader-node"),d=Q(()=>i.isHoverMenu),m=Q(()=>i.config.multiple),_=Q(()=>i.config.checkStrictly),x=Q(()=>{var ie;return(ie=i.checkedNodes[0])==null?void 0:ie.uid}),o=Q(()=>e.node.isDisabled),C=Q(()=>e.node.isLeaf),k=Q(()=>_.value&&!C.value||!o.value),A=Q(()=>N(i.expandingNode)),z=Q(()=>_.value&&i.checkedNodes.some(N)),N=ie=>{var de;const{level:le,uid:pe}=e.node;return((de=ie==null?void 0:ie.pathNodes[le-1])==null?void 0:de.uid)===pe},$=()=>{A.value||i.expandNode(e.node)},F=ie=>{const{node:de}=e;ie!==de.checked&&i.handleCheckChange(de,ie)},G=()=>{i.lazyLoad(e.node,()=>{C.value||$()})},U=ie=>{d.value&&(te(),!C.value&&t("expand",ie))},te=()=>{const{node:ie}=e;!k.value||ie.loading||(ie.loaded?$():G())},Z=()=>{d.value&&!C.value||(C.value&&!o.value&&!_.value&&!m.value?X(!0):te())},q=ie=>{_.value?(F(ie),e.node.loaded&&$()):X(ie)},X=ie=>{e.node.loaded?(F(ie),!_.value&&$()):G()};return{panel:i,isHoverMenu:d,multiple:m,checkStrictly:_,checkedNodeId:x,isDisabled:o,isLeaf:C,expandable:k,inExpandingPath:A,inCheckedPath:z,ns:a,handleHoverExpand:U,handleExpand:te,handleClick:Z,handleCheck:X,handleSelectCheck:q}}});function iJ(e,t,i,a,d,m){const _=Er("el-checkbox"),x=Er("el-radio"),o=Er("check"),C=Er("el-icon"),k=Er("node-content"),A=Er("loading"),z=Er("arrow-right");return se(),Ae("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?null:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:ce([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:e.handleHoverExpand,onFocus:e.handleHoverExpand,onClick:e.handleClick},[bt(" prefix "),e.multiple?(se(),It(_,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:Yn(()=>{},["stop"]),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onClick","onUpdate:modelValue"])):e.checkStrictly?(se(),It(x,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:Yn(()=>{},["stop"])},{default:st(()=>[bt(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),Ve("span")]),_:1},8,["model-value","label","disabled","onUpdate:modelValue","onClick"])):e.isLeaf&&e.node.checked?(se(),It(C,{key:2,class:ce(e.ns.e("prefix"))},{default:st(()=>[qe(o)]),_:1},8,["class"])):bt("v-if",!0),bt(" content "),qe(k),bt(" postfix "),e.isLeaf?bt("v-if",!0):(se(),Ae(Bn,{key:3},[e.node.loading?(se(),It(C,{key:0,class:ce([e.ns.is("loading"),e.ns.e("postfix")])},{default:st(()=>[qe(A)]),_:1},8,["class"])):(se(),It(C,{key:1,class:ce(["arrow-right",e.ns.e("postfix")])},{default:st(()=>[qe(z)]),_:1},8,["class"]))],64))],42,["id","aria-haspopup","aria-owns","aria-expanded","tabindex","onMouseenter","onFocus","onClick"])}var sJ=hn(oJ,[["render",iJ],["__file","node.vue"]]);const aJ=Ge({name:"ElCascaderMenu",components:{Loading:Kl,ElIcon:Dn,ElScrollbar:rc,ElCascaderNode:sJ},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const t=Cr(),i=Jt("cascader-menu"),{t:a}=Gr(),d=Wi();let m=null,_=null;const x=kn(FC),o=be(null),C=Q(()=>!e.nodes.length),k=Q(()=>!x.initialLoaded),A=Q(()=>`${d.value}-${e.index}`),z=G=>{m=G.target},N=G=>{if(!(!x.isHoverMenu||!m||!o.value))if(m.contains(G.target)){$();const U=t.vnode.el,{left:te}=U.getBoundingClientRect(),{offsetWidth:Z,offsetHeight:q}=U,X=G.clientX-te,ie=m.offsetTop,de=ie+m.offsetHeight;o.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${X} ${ie} L${Z} 0 V${ie} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${X} ${de} L${Z} ${q} V${de} Z" />
        `}else _||(_=window.setTimeout(F,x.config.hoverThreshold))},$=()=>{_&&(clearTimeout(_),_=null)},F=()=>{o.value&&(o.value.innerHTML="",$())};return{ns:i,panel:x,hoverZone:o,isEmpty:C,isLoading:k,menuId:A,t:a,handleExpand:z,handleMouseMove:N,clearHoverZone:F}}});function lJ(e,t,i,a,d,m){const _=Er("el-cascader-node"),x=Er("loading"),o=Er("el-icon"),C=Er("el-scrollbar");return se(),It(C,{key:e.menuId,tag:"ul",role:"menu",class:ce(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:st(()=>{var k;return[(se(!0),Ae(Bn,null,Fr(e.nodes,A=>(se(),It(_,{key:A.uid,node:A,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(se(),Ae("div",{key:0,class:ce(e.ns.e("empty-text"))},[qe(o,{size:"14",class:ce(e.ns.is("loading"))},{default:st(()=>[qe(x)]),_:1},8,["class"]),$r(" "+fn(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(se(),Ae("div",{key:1,class:ce(e.ns.e("empty-text"))},[_t(e.$slots,"empty",{},()=>[$r(fn(e.t("el.cascader.noData")),1)])],2)):(k=e.panel)!=null&&k.isHoverMenu?(se(),Ae("svg",{key:2,ref:"hoverZone",class:ce(e.ns.e("hover-zone"))},null,2)):bt("v-if",!0)]}),_:3},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var cJ=hn(aJ,[["render",lJ],["__file","menu.vue"]]);let uJ=0;const dJ=e=>{const t=[e];let{parent:i}=e;for(;i;)t.unshift(i),i=i.parent;return t};let OS=class zS{constructor(t,i,a,d=!1){this.data=t,this.config=i,this.parent=a,this.root=d,this.uid=uJ++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:m,label:_,children:x}=i,o=t[x],C=dJ(this);this.level=d?0:a?a.level+1:1,this.value=t[m],this.label=t[_],this.pathNodes=C,this.pathValues=C.map(k=>k.value),this.pathLabels=C.map(k=>k.label),this.childrenData=o,this.children=(o||[]).map(k=>new zS(k,i,this)),this.loaded=!i.lazy||this.isLeaf||!da(o)}get isDisabled(){const{data:t,parent:i,config:a}=this,{disabled:d,checkStrictly:m}=a;return(Fn(d)?d(t,this):!!t[d])||!m&&(i==null?void 0:i.isDisabled)}get isLeaf(){const{data:t,config:i,childrenData:a,loaded:d}=this,{lazy:m,leaf:_}=i,x=Fn(_)?_(t,this):t[_];return Bo(x)?m&&!d?!1:!(on(a)&&a.length):!!x}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(t){const{childrenData:i,children:a}=this,d=new zS(t,this.config,this);return on(i)?i.push(t):this.childrenData=[t],a.push(d),d}calcText(t,i){const a=t?this.pathLabels.join(i):this.label;return this.text=a,a}broadcast(t,...i){const a=`onParent${jl(t)}`;this.children.forEach(d=>{d&&(d.broadcast(t,...i),d[a]&&d[a](...i))})}emit(t,...i){const{parent:a}=this,d=`onChild${jl(t)}`;a&&(a[d]&&a[d](...i),a.emit(t,...i))}onParentCheck(t){this.isDisabled||this.setCheckState(t)}onChildCheck(){const{children:t}=this,i=t.filter(d=>!d.isDisabled),a=i.length?i.every(d=>d.checked):!1;this.setCheckState(a)}setCheckState(t){const i=this.children.length,a=this.children.reduce((d,m)=>{const _=m.checked?1:m.indeterminate?.5:0;return d+_},0);this.checked=this.loaded&&this.children.filter(d=>!d.isDisabled).every(d=>d.loaded&&d.checked)&&t,this.indeterminate=this.loaded&&a!==i&&a>0}doCheck(t){if(this.checked===t)return;const{checkStrictly:i,multiple:a}=this.config;i||!a?this.checked=t:(this.broadcast("check",t),this.setCheckState(t),this.emit("check"))}};const BS=(e,t)=>e.reduce((i,a)=>(a.isLeaf?i.push(a):(!t&&i.push(a),i=i.concat(BS(a.children,t))),i),[]);class bR{constructor(t,i){this.config=i;const a=(t||[]).map(d=>new OS(d,this.config));this.nodes=a,this.allNodes=BS(a,!1),this.leafNodes=BS(a,!0)}getNodes(){return this.nodes}getFlattedNodes(t){return t?this.leafNodes:this.allNodes}appendNode(t,i){const a=i?i.appendChild(t):new OS(t,this.config);i||this.nodes.push(a),this.allNodes.push(a),a.isLeaf&&this.leafNodes.push(a)}appendNodes(t,i){t.forEach(a=>this.appendNode(a,i))}getNodeByValue(t,i=!1){return!t&&t!==0?null:this.getFlattedNodes(i).find(d=>Gi(d.value,t)||Gi(d.pathValues,t))||null}getSameNode(t){return t&&this.getFlattedNodes(!1).find(({value:a,level:d})=>Gi(t.value,a)&&t.level===d)||null}}const k2=ln({modelValue:{type:at([Number,String,Array])},options:{type:at(Array),default:()=>[]},props:{type:at(Object),default:()=>({})}}),hJ={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:_o,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},fJ=e=>Q(()=>({...hJ,...e.props})),xR=e=>{if(!e)return 0;const t=e.id.split("-");return Number(t[t.length-2])},pJ=e=>{if(!e)return;const t=e.querySelector("input");t?t.click():$L(e)&&e.click()},mJ=(e,t)=>{const i=t.slice(0),a=i.map(m=>m.uid),d=e.reduce((m,_)=>{const x=a.indexOf(_.uid);return x>-1&&(m.push(_),i.splice(x,1),a.splice(x,1)),m},[]);return d.push(...i),d},gJ=Ge({name:"ElCascaderPanel",components:{ElCascaderMenu:cJ},props:{...k2,border:{type:Boolean,default:!0},renderLabel:Function},emits:[xr,No,"close","expand-change"],setup(e,{emit:t,slots:i}){let a=!1;const d=Jt("cascader"),m=fJ(e);let _=null;const x=be(!0),o=be([]),C=be(null),k=be([]),A=be(null),z=be([]),N=Q(()=>m.value.expandTrigger==="hover"),$=Q(()=>e.renderLabel||i.default),F=()=>{const{options:ue}=e,Re=m.value;a=!1,_=new bR(ue,Re),k.value=[_.getNodes()],Re.lazy&&da(e.options)?(x.value=!1,G(void 0,Ye=>{Ye&&(_=new bR(Ye,Re),k.value=[_.getNodes()]),x.value=!0,le(!1,!0)})):le(!1,!0)},G=(ue,Re)=>{const Ye=m.value;ue=ue||new OS({},Ye,void 0,!0),ue.loading=!0;const Ie=fe=>{const Me=ue,Se=Me.root?null:Me;fe&&(_==null||_.appendNodes(fe,Se)),Me.loading=!1,Me.loaded=!0,Me.childrenData=Me.childrenData||[],Re&&Re(fe)};Ye.lazyLoad(ue,Ie)},U=(ue,Re)=>{var Ye;const{level:Ie}=ue,fe=k.value.slice(0,Ie);let Me;ue.isLeaf?Me=ue.pathNodes[Ie-2]:(Me=ue,fe.push(ue.children)),((Ye=A.value)==null?void 0:Ye.uid)!==(Me==null?void 0:Me.uid)&&(A.value=ue,k.value=fe,!Re&&t("expand-change",(ue==null?void 0:ue.pathValues)||[]))},te=(ue,Re,Ye=!0)=>{const{checkStrictly:Ie,multiple:fe}=m.value,Me=z.value[0];a=!0,!fe&&(Me==null||Me.doCheck(!1)),ue.doCheck(Re),de(),Ye&&!fe&&!Ie&&t("close"),!Ye&&!fe&&!Ie&&Z(ue)},Z=ue=>{ue&&(ue=ue.parent,Z(ue),ue&&U(ue))},q=ue=>_==null?void 0:_.getFlattedNodes(ue),X=ue=>{var Re;return(Re=q(ue))==null?void 0:Re.filter(Ye=>Ye.checked!==!1)},ie=()=>{z.value.forEach(ue=>ue.doCheck(!1)),de(),k.value=k.value.slice(0,1),A.value=null,t("expand-change",[])},de=()=>{var ue;const{checkStrictly:Re,multiple:Ye}=m.value,Ie=z.value,fe=X(!Re),Me=mJ(Ie,fe),Se=Me.map(ye=>ye.valueByOption);z.value=Me,C.value=Ye?Se:(ue=Se[0])!=null?ue:null},le=(ue=!1,Re=!1)=>{const{modelValue:Ye}=e,{lazy:Ie,multiple:fe,checkStrictly:Me}=m.value,Se=!Me;if(!(!x.value||a||!Re&&Gi(Ye,C.value)))if(Ie&&!ue){const Ce=xP($H(Ds(Ye))).map(Fe=>_==null?void 0:_.getNodeByValue(Fe)).filter(Fe=>!!Fe&&!Fe.loaded&&!Fe.loading);Ce.length?Ce.forEach(Fe=>{G(Fe,()=>le(!1,Re))}):le(!0,Re)}else{const ye=fe?Ds(Ye):[Ye],Ce=xP(ye.map(Fe=>_==null?void 0:_.getNodeByValue(Fe,Se)));pe(Ce,Re),C.value=rb(Ye)}},pe=(ue,Re=!0)=>{const{checkStrictly:Ye}=m.value,Ie=z.value,fe=ue.filter(ye=>!!ye&&(Ye||ye.isLeaf)),Me=_==null?void 0:_.getSameNode(A.value),Se=Re&&Me||fe[0];Se?Se.pathNodes.forEach(ye=>U(ye,!0)):A.value=null,Ie.forEach(ye=>ye.doCheck(!1)),ao(fe).forEach(ye=>ye.doCheck(!0)),z.value=fe,Vn(ge)},ge=()=>{Hr&&o.value.forEach(ue=>{const Re=ue==null?void 0:ue.$el;if(Re){const Ye=Re.querySelector(`.${d.namespace.value}-scrollbar__wrap`),Ie=Re.querySelector(`.${d.b("node")}.${d.is("active")}`)||Re.querySelector(`.${d.b("node")}.in-active-path`);tC(Ye,Ie)}})},he=ue=>{const Re=ue.target,{code:Ye}=ue;switch(Ye){case En.up:case En.down:{ue.preventDefault();const Ie=Ye===En.up?-1:1;k0(VL(Re,Ie,`.${d.b("node")}[tabindex="-1"]`));break}case En.left:{ue.preventDefault();const Ie=o.value[xR(Re)-1],fe=Ie==null?void 0:Ie.$el.querySelector(`.${d.b("node")}[aria-expanded="true"]`);k0(fe);break}case En.right:{ue.preventDefault();const Ie=o.value[xR(Re)+1],fe=Ie==null?void 0:Ie.$el.querySelector(`.${d.b("node")}[tabindex="-1"]`);k0(fe);break}case En.enter:case En.numpadEnter:pJ(Re);break}};return Br(FC,ao({config:m,expandingNode:A,checkedNodes:z,isHoverMenu:N,initialLoaded:x,renderLabelFn:$,lazyLoad:G,expandNode:U,handleCheckChange:te})),Wt([m,()=>e.options],F,{deep:!0,immediate:!0}),Wt(()=>e.modelValue,()=>{a=!1,le()},{deep:!0}),Wt(()=>C.value,ue=>{Gi(ue,e.modelValue)||(t(xr,ue),t(No,ue))}),eL(()=>o.value=[]),vr(()=>!da(e.modelValue)&&le()),{ns:d,menuList:o,menus:k,checkedNodes:z,handleKeyDown:he,handleCheckChange:te,getFlattedNodes:q,getCheckedNodes:X,clearCheckedNodes:ie,calculateCheckedValue:de,scrollToExpandingNode:ge}}});function vJ(e,t,i,a,d,m){const _=Er("el-cascader-menu");return se(),Ae("div",{class:ce([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:e.handleKeyDown},[(se(!0),Ae(Bn,null,Fr(e.menus,(x,o)=>(se(),It(_,{key:o,ref_for:!0,ref:C=>e.menuList[o]=C,index:o,nodes:[...x]},{empty:st(()=>[_t(e.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var _J=hn(gJ,[["render",vJ],["__file","index.vue"]]);const A2=cr(_J),Ah=ln({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:tc},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),yJ={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},bJ=Ge({name:"ElTag"}),xJ=Ge({...bJ,props:Ah,emits:yJ,setup(e,{emit:t}){const i=e,a=xi(),d=Jt("tag"),m=Q(()=>{const{type:C,hit:k,effect:A,closable:z,round:N}=i;return[d.b(),d.is("closable",z),d.m(C||"primary"),d.m(a.value),d.m(A),d.is("hit",k),d.is("round",N)]}),_=C=>{t("close",C)},x=C=>{t("click",C)},o=C=>{C.component.subTree.component.bum=null};return(C,k)=>C.disableTransitions?(se(),Ae("span",{key:0,class:ce(y(m)),style:Nn({backgroundColor:C.color}),onClick:x},[Ve("span",{class:ce(y(d).e("content"))},[_t(C.$slots,"default")],2),C.closable?(se(),It(y(Dn),{key:0,class:ce(y(d).e("close")),onClick:Yn(_,["stop"])},{default:st(()=>[qe(y(vl))]),_:1},8,["class","onClick"])):bt("v-if",!0)],6)):(se(),It(Fi,{key:1,name:`${y(d).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:o},{default:st(()=>[Ve("span",{class:ce(y(m)),style:Nn({backgroundColor:C.color}),onClick:x},[Ve("span",{class:ce(y(d).e("content"))},[_t(C.$slots,"default")],2),C.closable?(se(),It(y(Dn),{key:0,class:ce(y(d).e("close")),onClick:Yn(_,["stop"])},{default:st(()=>[qe(y(vl))]),_:1},8,["class","onClick"])):bt("v-if",!0)],6)]),_:3},8,["name"]))}});var wJ=hn(xJ,[["__file","tag.vue"]]);const zv=cr(wJ),SJ=ln({...k2,size:Ei,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:at(Function),default:(e,t)=>e.text.includes(t)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:at(Function),default:()=>!0},placement:{type:at(String),values:Fc,default:"bottom-start"},fallbackPlacements:{type:at(Array),default:["bottom-start","bottom","top-start","top","right","left"]},popperClass:{type:String,default:""},teleported:Li.teleported,tagType:{...Ah.type,default:"info"},tagEffect:{...Ah.effect,default:"light"},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...em}),TJ={[xr]:e=>!0,[No]:e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,visibleChange:e=>ko(e),expandChange:e=>!!e,removeTag:e=>!!e},CJ="ElCascader",EJ=Ge({name:CJ}),MJ=Ge({...EJ,props:SJ,emits:TJ,setup(e,{expose:t,emit:i}){const a=e,d={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:dt})=>{const{modifiersData:tn,placement:Ze}=dt;["right","left","bottom","top"].includes(Ze)||(tn.arrow.x=35)},requires:["arrow"]}]},m=Dh();let _=0,x=0;const o=Jt("cascader"),C=Jt("input"),{t:k}=Gr(),{form:A,formItem:z}=bs(),{valueOnClear:N}=Xb(a),{isComposing:$,handleComposition:F}=Yb({afterComposition(dt){var tn;const Ze=(tn=dt.target)==null?void 0:tn.value;Rt(Ze)}}),G=be(null),U=be(null),te=be(null),Z=be(null),q=be(null),X=be(!1),ie=be(!1),de=be(!1),le=be(!1),pe=be(""),ge=be(""),he=be([]),ue=be([]),Re=be([]),Ye=Q(()=>m.style),Ie=Q(()=>a.disabled||(A==null?void 0:A.disabled)),fe=Q(()=>a.placeholder||k("el.cascader.placeholder")),Me=Q(()=>ge.value||he.value.length>0||$.value?"":fe.value),Se=xi(),ye=Q(()=>["small"].includes(Se.value)?"small":"default"),Ce=Q(()=>!!a.props.multiple),Fe=Q(()=>!a.filterable||Ce.value),it=Q(()=>Ce.value?ge.value:pe.value),We=Q(()=>{var dt;return((dt=Z.value)==null?void 0:dt.checkedNodes)||[]}),ut=Q(()=>!a.clearable||Ie.value||de.value||!ie.value?!1:!!We.value.length),Lt=Q(()=>{const{showAllLevels:dt,separator:tn}=a,Ze=We.value;return Ze.length?Ce.value?"":Ze[0].calcText(dt,tn):""}),Ft=Q(()=>(z==null?void 0:z.validateState)||""),mt=Q({get(){return rb(a.modelValue)},set(dt){const tn=dt??N.value;i(xr,tn),i(No,tn),a.validateEvent&&(z==null||z.validate("change").catch(Ze=>void 0))}}),jt=Q(()=>[o.b(),o.m(Se.value),o.is("disabled",Ie.value),m.class]),Ht=Q(()=>[C.e("icon"),"icon-arrow-down",o.is("reverse",X.value)]),Tn=Q(()=>o.is("focus",X.value||le.value)),Pe=Q(()=>{var dt,tn;return(tn=(dt=G.value)==null?void 0:dt.popperRef)==null?void 0:tn.contentRef}),At=dt=>{var tn,Ze,gn;Ie.value||(dt=dt??!X.value,dt!==X.value&&(X.value=dt,(Ze=(tn=U.value)==null?void 0:tn.input)==null||Ze.setAttribute("aria-expanded",`${dt}`),dt?(He(),Vn((gn=Z.value)==null?void 0:gn.scrollToExpandingNode)):a.filterable&&Zt(),i("visibleChange",dt)))},He=()=>{Vn(()=>{var dt;(dt=G.value)==null||dt.updatePopper()})},pt=()=>{de.value=!1},et=dt=>{const{showAllLevels:tn,separator:Ze}=a;return{node:dt,key:dt.uid,text:dt.calcText(tn,Ze),hitState:!1,closable:!Ie.value&&!dt.isDisabled,isCollapseTag:!1}},rn=dt=>{var tn;const Ze=dt.node;Ze.doCheck(!1),(tn=Z.value)==null||tn.calculateCheckedValue(),i("removeTag",Ze.valueByOption)},kt=()=>{if(!Ce.value)return;const dt=We.value,tn=[],Ze=[];if(dt.forEach(gn=>Ze.push(et(gn))),ue.value=Ze,dt.length){dt.slice(0,a.maxCollapseTags).forEach(Hn=>tn.push(et(Hn)));const gn=dt.slice(a.maxCollapseTags),rr=gn.length;rr&&(a.collapseTags?tn.push({key:-1,text:`+ ${rr}`,closable:!1,isCollapseTag:!0}):gn.forEach(Hn=>tn.push(et(Hn))))}he.value=tn},zt=()=>{var dt,tn;const{filterMethod:Ze,showAllLevels:gn,separator:rr}=a,Hn=(tn=(dt=Z.value)==null?void 0:dt.getFlattedNodes(!a.props.checkStrictly))==null?void 0:tn.filter(eo=>eo.isDisabled?!1:(eo.calcText(gn,rr),Ze(eo,it.value)));Ce.value&&(he.value.forEach(eo=>{eo.hitState=!1}),ue.value.forEach(eo=>{eo.hitState=!1})),de.value=!0,Re.value=Hn,He()},Mt=()=>{var dt;let tn;de.value&&q.value?tn=q.value.$el.querySelector(`.${o.e("suggestion-item")}`):tn=(dt=Z.value)==null?void 0:dt.$el.querySelector(`.${o.b("node")}[tabindex="-1"]`),tn&&(tn.focus(),!de.value&&tn.click())},en=()=>{var dt,tn;const Ze=(dt=U.value)==null?void 0:dt.input,gn=te.value,rr=(tn=q.value)==null?void 0:tn.$el;if(!(!Hr||!Ze)){if(rr){const Hn=rr.querySelector(`.${o.e("suggestion-list")}`);Hn.style.minWidth=`${Ze.offsetWidth}px`}if(gn){const{offsetHeight:Hn}=gn,eo=he.value.length>0?`${Math.max(Hn+6,_)}px`:`${_}px`;Ze.style.height=eo,He()}}},sn=dt=>{var tn;return(tn=Z.value)==null?void 0:tn.getCheckedNodes(dt)},dn=dt=>{He(),i("expandChange",dt)},Pn=dt=>{if(!$.value)switch(dt.code){case En.enter:case En.numpadEnter:At();break;case En.down:At(!0),Vn(Mt),dt.preventDefault();break;case En.esc:X.value===!0&&(dt.preventDefault(),dt.stopPropagation(),At(!1));break;case En.tab:At(!1);break}},Ot=()=>{var dt;(dt=Z.value)==null||dt.clearCheckedNodes(),!X.value&&a.filterable&&Zt(),At(!1),i("clear")},Zt=()=>{const{value:dt}=Lt;pe.value=dt,ge.value=dt},jn=dt=>{var tn,Ze;const{checked:gn}=dt;Ce.value?(tn=Z.value)==null||tn.handleCheckChange(dt,!gn,!1):(!gn&&((Ze=Z.value)==null||Ze.handleCheckChange(dt,!0,!1)),At(!1))},ir=dt=>{const tn=dt.target,{code:Ze}=dt;switch(Ze){case En.up:case En.down:{const gn=Ze===En.up?-1:1;k0(VL(tn,gn,`.${o.e("suggestion-item")}[tabindex="-1"]`));break}case En.enter:case En.numpadEnter:tn.click();break}},ur=()=>{const dt=he.value,tn=dt[dt.length-1];x=ge.value?0:x+1,!(!tn||!x||a.collapseTags&&dt.length>1)&&(tn.hitState?rn(tn):tn.hitState=!0)},ar=dt=>{const tn=dt.target,Ze=o.e("search-input");tn.className===Ze&&(le.value=!0),i("focus",dt)},wr=dt=>{le.value=!1,i("blur",dt)},Xr=Js(()=>{const{value:dt}=it;if(!dt)return;const tn=a.beforeFilter(dt);vv(tn)?tn.then(zt).catch(()=>{}):tn!==!1?zt():pt()},a.debounce),Rt=(dt,tn)=>{!X.value&&At(!0),!(tn!=null&&tn.isComposing)&&(dt?Xr():pt())},_n=dt=>Number.parseFloat(pV(C.cssVarName("input-height"),dt).value)-2;return Wt(de,He),Wt([We,Ie,()=>a.collapseTags],kt),Wt(he,()=>{Vn(()=>en())}),Wt(Se,async()=>{await Vn();const dt=U.value.input;_=_n(dt)||_,en()}),Wt(Lt,Zt,{immediate:!0}),vr(()=>{const dt=U.value.input,tn=_n(dt);_=dt.offsetHeight||tn,qo(dt,en)}),t({getCheckedNodes:sn,cascaderPanelRef:Z,togglePopperVisible:At,contentRef:Pe,presentText:Lt}),(dt,tn)=>(se(),It(y(os),{ref_key:"tooltipRef",ref:G,visible:X.value,teleported:dt.teleported,"popper-class":[y(o).e("dropdown"),dt.popperClass],"popper-options":d,"fallback-placements":dt.fallbackPlacements,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:dt.placement,transition:`${y(o).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:dt.persistent,onHide:pt},{default:st(()=>[mr((se(),Ae("div",{class:ce(y(jt)),style:Nn(y(Ye)),onClick:()=>At(y(Fe)?void 0:!0),onKeydown:Pn,onMouseenter:Ze=>ie.value=!0,onMouseleave:Ze=>ie.value=!1},[qe(y(vs),{ref_key:"input",ref:U,modelValue:pe.value,"onUpdate:modelValue":Ze=>pe.value=Ze,placeholder:y(Me),readonly:y(Fe),disabled:y(Ie),"validate-event":!1,size:y(Se),class:ce(y(Tn)),tabindex:y(Ce)&&dt.filterable&&!y(Ie)?-1:void 0,onCompositionstart:y(F),onCompositionupdate:y(F),onCompositionend:y(F),onFocus:ar,onBlur:wr,onInput:Rt},{suffix:st(()=>[y(ut)?(se(),It(y(Dn),{key:"clear",class:ce([y(C).e("icon"),"icon-circle-close"]),onClick:Yn(Ot,["stop"])},{default:st(()=>[qe(y(dd))]),_:1},8,["class","onClick"])):(se(),It(y(Dn),{key:"arrow-down",class:ce(y(Ht)),onClick:Yn(Ze=>At(),["stop"])},{default:st(()=>[qe(y(Bc))]),_:1},8,["class","onClick"]))]),_:1},8,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled","size","class","tabindex","onCompositionstart","onCompositionupdate","onCompositionend"]),y(Ce)?(se(),Ae("div",{key:0,ref_key:"tagWrapper",ref:te,class:ce([y(o).e("tags"),y(o).is("validate",!!y(Ft))])},[(se(!0),Ae(Bn,null,Fr(he.value,Ze=>(se(),It(y(zv),{key:Ze.key,type:dt.tagType,size:y(ye),effect:dt.tagEffect,hit:Ze.hitState,closable:Ze.closable,"disable-transitions":"",onClose:gn=>rn(Ze)},{default:st(()=>[Ze.isCollapseTag===!1?(se(),Ae("span",{key:0},fn(Ze.text),1)):(se(),It(y(os),{key:1,disabled:X.value||!dt.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:st(()=>[Ve("span",null,fn(Ze.text),1)]),content:st(()=>[Ve("div",{class:ce(y(o).e("collapse-tags"))},[(se(!0),Ae(Bn,null,Fr(ue.value.slice(dt.maxCollapseTags),(gn,rr)=>(se(),Ae("div",{key:rr,class:ce(y(o).e("collapse-tag"))},[(se(),It(y(zv),{key:gn.key,class:"in-tooltip",type:dt.tagType,size:y(ye),effect:dt.tagEffect,hit:gn.hitState,closable:gn.closable,"disable-transitions":"",onClose:Hn=>rn(gn)},{default:st(()=>[Ve("span",null,fn(gn.text),1)]),_:2},1032,["type","size","effect","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","effect","hit","closable","onClose"]))),128)),dt.filterable&&!y(Ie)?mr((se(),Ae("input",{key:0,"onUpdate:modelValue":Ze=>ge.value=Ze,type:"text",class:ce(y(o).e("search-input")),placeholder:y(Lt)?"":y(fe),onInput:Ze=>Rt(ge.value,Ze),onClick:Yn(Ze=>At(!0),["stop"]),onKeydown:Mo(ur,["delete"]),onCompositionstart:y(F),onCompositionupdate:y(F),onCompositionend:y(F),onFocus:ar,onBlur:wr},null,42,["onUpdate:modelValue","placeholder","onInput","onClick","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend"])),[[DT,ge.value]]):bt("v-if",!0)],2)):bt("v-if",!0)],46,["onClick","onMouseenter","onMouseleave"])),[[y(Rc),()=>At(!1),y(Pe)]])]),content:st(()=>[mr(qe(y(A2),{ref_key:"cascaderPanelRef",ref:Z,modelValue:y(mt),"onUpdate:modelValue":Ze=>Fo(mt)?mt.value=Ze:null,options:dt.options,props:a.props,border:!1,"render-label":dt.$slots.default,onExpandChange:dn,onClose:Ze=>dt.$nextTick(()=>At(!1))},{empty:st(()=>[_t(dt.$slots,"empty")]),_:3},8,["modelValue","onUpdate:modelValue","options","props","render-label","onClose"]),[[no,!de.value]]),dt.filterable?mr((se(),It(y(rc),{key:0,ref_key:"suggestionPanel",ref:q,tag:"ul",class:ce(y(o).e("suggestion-panel")),"view-class":y(o).e("suggestion-list"),onKeydown:ir},{default:st(()=>[Re.value.length?(se(!0),Ae(Bn,{key:0},Fr(Re.value,Ze=>(se(),Ae("li",{key:Ze.uid,class:ce([y(o).e("suggestion-item"),y(o).is("checked",Ze.checked)]),tabindex:-1,onClick:gn=>jn(Ze)},[Ve("span",null,fn(Ze.text),1),Ze.checked?(se(),It(y(Dn),{key:0},{default:st(()=>[qe(y(n_))]),_:1})):bt("v-if",!0)],10,["onClick"]))),128)):_t(dt.$slots,"empty",{key:1},()=>[Ve("li",{class:ce(y(o).e("empty-text"))},fn(y(k)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[no,de.value]]):bt("v-if",!0)]),_:3},8,["visible","teleported","popper-class","fallback-placements","placement","transition","persistent"]))}});var IJ=hn(MJ,[["__file","cascader.vue"]]);const kJ=cr(IJ),AJ=ln({checked:Boolean,disabled:Boolean,type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"}}),PJ={"update:checked":e=>ko(e),[No]:e=>ko(e)},RJ=Ge({name:"ElCheckTag"}),DJ=Ge({...RJ,props:AJ,emits:PJ,setup(e,{emit:t}){const i=e,a=Jt("check-tag"),d=Q(()=>i.disabled),m=Q(()=>[a.b(),a.is("checked",i.checked),a.is("disabled",d.value),a.m(i.type||"primary")]),_=()=>{if(d.value)return;const x=!i.checked;t(No,x),t("update:checked",x)};return(x,o)=>(se(),Ae("span",{class:ce(y(m)),onClick:_},[_t(x.$slots,"default")],2))}});var LJ=hn(DJ,[["__file","check-tag.vue"]]);const OJ=cr(LJ),P2=Symbol("rowContextKey"),zJ=["start","center","end","space-around","space-between","space-evenly"],BJ=["top","middle","bottom"],FJ=ln({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:zJ,default:"start"},align:{type:String,values:BJ}}),NJ=Ge({name:"ElRow"}),$J=Ge({...NJ,props:FJ,setup(e){const t=e,i=Jt("row"),a=Q(()=>t.gutter);Br(P2,{gutter:a});const d=Q(()=>{const _={};return t.gutter&&(_.marginRight=_.marginLeft=`-${t.gutter/2}px`),_}),m=Q(()=>[i.b(),i.is(`justify-${t.justify}`,t.justify!=="start"),i.is(`align-${t.align}`,!!t.align)]);return(_,x)=>(se(),It(Ir(_.tag),{class:ce(y(m)),style:Nn(y(d))},{default:st(()=>[_t(_.$slots,"default")]),_:3},8,["class","style"]))}});var VJ=hn($J,[["__file","row.vue"]]);const UJ=cr(VJ),jJ=ln({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:at([Number,Object]),default:()=>Xo({})},sm:{type:at([Number,Object]),default:()=>Xo({})},md:{type:at([Number,Object]),default:()=>Xo({})},lg:{type:at([Number,Object]),default:()=>Xo({})},xl:{type:at([Number,Object]),default:()=>Xo({})}}),HJ=Ge({name:"ElCol"}),GJ=Ge({...HJ,props:jJ,setup(e){const t=e,{gutter:i}=kn(P2,{gutter:Q(()=>0)}),a=Jt("col"),d=Q(()=>{const _={};return i.value&&(_.paddingLeft=_.paddingRight=`${i.value/2}px`),_}),m=Q(()=>{const _=[];return["span","offset","pull","push"].forEach(C=>{const k=t[C];Wn(k)&&(C==="span"?_.push(a.b(`${t[C]}`)):k>0&&_.push(a.b(`${C}-${t[C]}`)))}),["xs","sm","md","lg","xl"].forEach(C=>{Wn(t[C])?_.push(a.b(`${C}-${t[C]}`)):Tr(t[C])&&Object.entries(t[C]).forEach(([k,A])=>{_.push(k!=="span"?a.b(`${C}-${k}-${A}`):a.b(`${C}-${A}`))})}),i.value&&_.push(a.is("guttered")),[a.b(),_]});return(_,x)=>(se(),It(Ir(_.tag),{class:ce(y(m)),style:Nn(y(d))},{default:st(()=>[_t(_.$slots,"default")]),_:3},8,["class","style"]))}});var WJ=hn(GJ,[["__file","col.vue"]]);const qJ=cr(WJ),wR=e=>Wn(e)||zn(e)||on(e),KJ=ln({accordion:Boolean,modelValue:{type:at([Array,String,Number]),default:()=>Xo([])}}),ZJ={[xr]:wR,[No]:wR},R2=Symbol("collapseContextKey"),YJ=(e,t)=>{const i=be(ms(e.modelValue)),a=m=>{i.value=m;const _=e.accordion?i.value[0]:i.value;t(xr,_),t(No,_)},d=m=>{if(e.accordion)a([i.value[0]===m?"":m]);else{const _=[...i.value],x=_.indexOf(m);x>-1?_.splice(x,1):_.push(m),a(_)}};return Wt(()=>e.modelValue,()=>i.value=ms(e.modelValue),{deep:!0}),Br(R2,{activeNames:i,handleItemClick:d}),{activeNames:i,setActiveNames:a}},XJ=()=>{const e=Jt("collapse");return{rootKls:Q(()=>e.b())}},JJ=Ge({name:"ElCollapse"}),QJ=Ge({...JJ,props:KJ,emits:ZJ,setup(e,{expose:t,emit:i}){const a=e,{activeNames:d,setActiveNames:m}=YJ(a,i),{rootKls:_}=XJ();return t({activeNames:d,setActiveNames:m}),(x,o)=>(se(),Ae("div",{class:ce(y(_))},[_t(x.$slots,"default")],2))}});var eQ=hn(QJ,[["__file","collapse.vue"]]);const tQ=Ge({name:"ElCollapseTransition"}),nQ=Ge({...tQ,setup(e){const t=Jt("collapse-transition"),i=d=>{d.style.maxHeight="",d.style.overflow=d.dataset.oldOverflow,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom},a={beforeEnter(d){d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.style.height&&(d.dataset.elExistsHeight=d.style.height),d.style.maxHeight=0,d.style.paddingTop=0,d.style.paddingBottom=0},enter(d){requestAnimationFrame(()=>{d.dataset.oldOverflow=d.style.overflow,d.dataset.elExistsHeight?d.style.maxHeight=d.dataset.elExistsHeight:d.scrollHeight!==0?d.style.maxHeight=`${d.scrollHeight}px`:d.style.maxHeight=0,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom,d.style.overflow="hidden"})},afterEnter(d){d.style.maxHeight="",d.style.overflow=d.dataset.oldOverflow},enterCancelled(d){i(d)},beforeLeave(d){d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.dataset.oldOverflow=d.style.overflow,d.style.maxHeight=`${d.scrollHeight}px`,d.style.overflow="hidden"},leave(d){d.scrollHeight!==0&&(d.style.maxHeight=0,d.style.paddingTop=0,d.style.paddingBottom=0)},afterLeave(d){i(d)},leaveCancelled(d){i(d)}};return(d,m)=>(se(),It(Fi,kr({name:y(t).b()},S5(a)),{default:st(()=>[_t(d.$slots,"default")]),_:3},16,["name"]))}});var rQ=hn(nQ,[["__file","collapse-transition.vue"]]);const n1=cr(rQ),oQ=ln({title:{type:String,default:""},name:{type:at([String,Number]),default:void 0},icon:{type:wo,default:Os},disabled:Boolean}),iQ=e=>{const t=kn(R2),{namespace:i}=Jt("collapse"),a=be(!1),d=be(!1),m=bC(),_=Q(()=>m.current++),x=Q(()=>{var z;return(z=e.name)!=null?z:`${i.value}-id-${m.prefix}-${y(_)}`}),o=Q(()=>t==null?void 0:t.activeNames.value.includes(y(x)));return{focusing:a,id:_,isActive:o,handleFocus:()=>{setTimeout(()=>{d.value?d.value=!1:a.value=!0},50)},handleHeaderClick:()=>{e.disabled||(t==null||t.handleItemClick(y(x)),a.value=!1,d.value=!0)},handleEnterClick:()=>{t==null||t.handleItemClick(y(x))}}},sQ=(e,{focusing:t,isActive:i,id:a})=>{const d=Jt("collapse"),m=Q(()=>[d.b("item"),d.is("active",y(i)),d.is("disabled",e.disabled)]),_=Q(()=>[d.be("item","header"),d.is("active",y(i)),{focusing:y(t)&&!e.disabled}]),x=Q(()=>[d.be("item","arrow"),d.is("active",y(i))]),o=Q(()=>d.be("item","wrap")),C=Q(()=>d.be("item","content")),k=Q(()=>d.b(`content-${y(a)}`)),A=Q(()=>d.b(`head-${y(a)}`));return{arrowKls:x,headKls:_,rootKls:m,itemWrapperKls:o,itemContentKls:C,scopedContentId:k,scopedHeadId:A}},aQ=Ge({name:"ElCollapseItem"}),lQ=Ge({...aQ,props:oQ,setup(e,{expose:t}){const i=e,{focusing:a,id:d,isActive:m,handleFocus:_,handleHeaderClick:x,handleEnterClick:o}=iQ(i),{arrowKls:C,headKls:k,rootKls:A,itemWrapperKls:z,itemContentKls:N,scopedContentId:$,scopedHeadId:F}=sQ(i,{focusing:a,isActive:m,id:d});return t({isActive:m}),(G,U)=>(se(),Ae("div",{class:ce(y(A))},[Ve("button",{id:y(F),class:ce(y(k)),"aria-expanded":y(m),"aria-controls":y($),"aria-describedby":y($),tabindex:G.disabled?-1:0,type:"button",onClick:y(x),onKeydown:Mo(Yn(y(o),["stop","prevent"]),["space","enter"]),onFocus:y(_),onBlur:te=>a.value=!1},[_t(G.$slots,"title",{},()=>[$r(fn(G.title),1)]),_t(G.$slots,"icon",{isActive:y(m)},()=>[qe(y(Dn),{class:ce(y(C))},{default:st(()=>[(se(),It(Ir(G.icon)))]),_:1},8,["class"])])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),qe(y(n1),null,{default:st(()=>[mr(Ve("div",{id:y($),role:"region",class:ce(y(z)),"aria-hidden":!y(m),"aria-labelledby":y(F)},[Ve("div",{class:ce(y(N))},[_t(G.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[no,y(m)]])]),_:3})],2))}});var D2=hn(lQ,[["__file","collapse-item.vue"]]);const cQ=cr(eQ,{CollapseItem:D2}),uQ=Jo(D2),dQ=ln({color:{type:at(Object),required:!0},vertical:{type:Boolean,default:!1}});let Mw=!1;function Bv(e,t){if(!Hr)return;const i=function(m){var _;(_=t.drag)==null||_.call(t,m)},a=function(m){var _;document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",a),document.removeEventListener("touchmove",i),document.removeEventListener("touchend",a),document.onselectstart=null,document.ondragstart=null,Mw=!1,(_=t.end)==null||_.call(t,m)},d=function(m){var _;Mw||(m.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",i),document.addEventListener("mouseup",a),document.addEventListener("touchmove",i),document.addEventListener("touchend",a),Mw=!0,(_=t.start)==null||_.call(t,m))};e.addEventListener("mousedown",d),e.addEventListener("touchstart",d,{passive:!1})}const hQ=e=>{const t=Cr(),{t:i}=Gr(),a=Uo(),d=Uo(),m=Q(()=>e.color.get("alpha")),_=Q(()=>i("el.colorpicker.alphaLabel"));function x(A){var z;A.target!==a.value&&o(A),(z=a.value)==null||z.focus()}function o(A){if(!d.value||!a.value)return;const N=t.vnode.el.getBoundingClientRect(),{clientX:$,clientY:F}=BT(A);if(e.vertical){let G=F-N.top;G=Math.max(a.value.offsetHeight/2,G),G=Math.min(G,N.height-a.value.offsetHeight/2),e.color.set("alpha",Math.round((G-a.value.offsetHeight/2)/(N.height-a.value.offsetHeight)*100))}else{let G=$-N.left;G=Math.max(a.value.offsetWidth/2,G),G=Math.min(G,N.width-a.value.offsetWidth/2),e.color.set("alpha",Math.round((G-a.value.offsetWidth/2)/(N.width-a.value.offsetWidth)*100))}}function C(A){const{code:z,shiftKey:N}=A,$=N?10:1;switch(z){case En.left:case En.down:A.preventDefault(),A.stopPropagation(),k(-$);break;case En.right:case En.up:A.preventDefault(),A.stopPropagation(),k($);break}}function k(A){let z=m.value+A;z=z<0?0:z>100?100:z,e.color.set("alpha",z)}return{thumb:a,bar:d,alpha:m,alphaLabel:_,handleDrag:o,handleClick:x,handleKeydown:C}},fQ=(e,{bar:t,thumb:i,handleDrag:a})=>{const d=Cr(),m=Jt("color-alpha-slider"),_=be(0),x=be(0),o=be();function C(){if(!i.value||e.vertical)return 0;const te=d.vnode.el,Z=e.color.get("alpha");return te?Math.round(Z*(te.offsetWidth-i.value.offsetWidth/2)/100):0}function k(){if(!i.value)return 0;const te=d.vnode.el;if(!e.vertical)return 0;const Z=e.color.get("alpha");return te?Math.round(Z*(te.offsetHeight-i.value.offsetHeight/2)/100):0}function A(){if(e.color&&e.color.value){const{r:te,g:Z,b:q}=e.color.toRgb();return`linear-gradient(to right, rgba(${te}, ${Z}, ${q}, 0) 0%, rgba(${te}, ${Z}, ${q}, 1) 100%)`}return""}function z(){_.value=C(),x.value=k(),o.value=A()}vr(()=>{if(!t.value||!i.value)return;const te={drag:Z=>{a(Z)},end:Z=>{a(Z)}};Bv(t.value,te),Bv(i.value,te),z()}),Wt(()=>e.color.get("alpha"),()=>z()),Wt(()=>e.color.value,()=>z());const N=Q(()=>[m.b(),m.is("vertical",e.vertical)]),$=Q(()=>m.e("bar")),F=Q(()=>m.e("thumb")),G=Q(()=>({background:o.value})),U=Q(()=>({left:li(_.value),top:li(x.value)}));return{rootKls:N,barKls:$,barStyle:G,thumbKls:F,thumbStyle:U,update:z}},pQ="ElColorAlphaSlider",mQ=Ge({name:pQ}),gQ=Ge({...mQ,props:dQ,setup(e,{expose:t}){const i=e,{alpha:a,alphaLabel:d,bar:m,thumb:_,handleDrag:x,handleClick:o,handleKeydown:C}=hQ(i),{rootKls:k,barKls:A,barStyle:z,thumbKls:N,thumbStyle:$,update:F}=fQ(i,{bar:m,thumb:_,handleDrag:x});return t({update:F,bar:m,thumb:_}),(G,U)=>(se(),Ae("div",{class:ce(y(k))},[Ve("div",{ref_key:"bar",ref:m,class:ce(y(A)),style:Nn(y(z)),onClick:y(o)},null,14,["onClick"]),Ve("div",{ref_key:"thumb",ref:_,class:ce(y(N)),style:Nn(y($)),"aria-label":y(d),"aria-valuenow":y(a),"aria-orientation":G.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:y(C)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var vQ=hn(gQ,[["__file","alpha-slider.vue"]]);const _Q=Ge({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=Jt("color-hue-slider"),i=Cr(),a=be(),d=be(),m=be(0),_=be(0),x=Q(()=>e.color.get("hue"));Wt(()=>x.value,()=>{z()});function o(N){N.target!==a.value&&C(N)}function C(N){if(!d.value||!a.value)return;const F=i.vnode.el.getBoundingClientRect(),{clientX:G,clientY:U}=BT(N);let te;if(e.vertical){let Z=U-F.top;Z=Math.min(Z,F.height-a.value.offsetHeight/2),Z=Math.max(a.value.offsetHeight/2,Z),te=Math.round((Z-a.value.offsetHeight/2)/(F.height-a.value.offsetHeight)*360)}else{let Z=G-F.left;Z=Math.min(Z,F.width-a.value.offsetWidth/2),Z=Math.max(a.value.offsetWidth/2,Z),te=Math.round((Z-a.value.offsetWidth/2)/(F.width-a.value.offsetWidth)*360)}e.color.set("hue",te)}function k(){if(!a.value)return 0;const N=i.vnode.el;if(e.vertical)return 0;const $=e.color.get("hue");return N?Math.round($*(N.offsetWidth-a.value.offsetWidth/2)/360):0}function A(){if(!a.value)return 0;const N=i.vnode.el;if(!e.vertical)return 0;const $=e.color.get("hue");return N?Math.round($*(N.offsetHeight-a.value.offsetHeight/2)/360):0}function z(){m.value=k(),_.value=A()}return vr(()=>{if(!d.value||!a.value)return;const N={drag:$=>{C($)},end:$=>{C($)}};Bv(d.value,N),Bv(a.value,N),z()}),{bar:d,thumb:a,thumbLeft:m,thumbTop:_,hueValue:x,handleClick:o,update:z,ns:t}}});function yQ(e,t,i,a,d,m){return se(),Ae("div",{class:ce([e.ns.b(),e.ns.is("vertical",e.vertical)])},[Ve("div",{ref:"bar",class:ce(e.ns.e("bar")),onClick:e.handleClick},null,10,["onClick"]),Ve("div",{ref:"thumb",class:ce(e.ns.e("thumb")),style:Nn({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var bQ=hn(_Q,[["render",yQ],["__file","hue-slider.vue"]]);const xQ=ln({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:Ei,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:Li.teleported,predefine:{type:at(Array)},validateEvent:{type:Boolean,default:!0},...qi(["ariaLabel"])}),wQ={[xr]:e=>zn(e)||ki(e),[No]:e=>zn(e)||ki(e),activeChange:e=>zn(e)||ki(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},L2=Symbol("colorPickerContextKey"),SR=function(e,t,i){return[e,t*i/((e=(2-t)*i)<1?e:2-e)||0,e/2]},SQ=function(e){return zn(e)&&e.includes(".")&&Number.parseFloat(e)===1},TQ=function(e){return zn(e)&&e.includes("%")},Tp=function(e,t){SQ(e)&&(e="100%");const i=TQ(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),i&&(e=Number.parseInt(`${e*t}`,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},TR={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},z0=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),i=e%16;return`${TR[t]||t}${TR[i]||i}`},CR=function({r:e,g:t,b:i}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+i)?"":`#${z0(e)}${z0(t)}${z0(i)}`},Iw={A:10,B:11,C:12,D:13,E:14,F:15},ih=function(e){return e.length===2?(Iw[e[0].toUpperCase()]||+e[0])*16+(Iw[e[1].toUpperCase()]||+e[1]):Iw[e[1].toUpperCase()]||+e[1]},CQ=function(e,t,i){t=t/100,i=i/100;let a=t;const d=Math.max(i,.01);i*=2,t*=i<=1?i:2-i,a*=d<=1?d:2-d;const m=(i+t)/2,_=i===0?2*a/(d+a):2*t/(i+t);return{h:e,s:_*100,v:m*100}},ER=(e,t,i)=>{e=Tp(e,255),t=Tp(t,255),i=Tp(i,255);const a=Math.max(e,t,i),d=Math.min(e,t,i);let m;const _=a,x=a-d,o=a===0?0:x/a;if(a===d)m=0;else{switch(a){case e:{m=(t-i)/x+(t<i?6:0);break}case t:{m=(i-e)/x+2;break}case i:{m=(e-t)/x+4;break}}m/=6}return{h:m*360,s:o*100,v:_*100}},Yg=function(e,t,i){e=Tp(e,360)*6,t=Tp(t,100),i=Tp(i,100);const a=Math.floor(e),d=e-a,m=i*(1-t),_=i*(1-d*t),x=i*(1-(1-d)*t),o=a%6,C=[i,_,m,m,x,i][o],k=[x,i,i,_,m,m][o],A=[m,m,x,i,i,_][o];return{r:Math.round(C*255),g:Math.round(k*255),b:Math.round(A*255)}};class mv{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const i in t)Qr(t,i)&&(this[i]=t[i]);t.value?this.fromString(t.value):this.doOnChange()}set(t,i){if(arguments.length===1&&typeof t=="object"){for(const a in t)Qr(t,a)&&this.set(a,t[a]);return}this[`_${t}`]=i,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return Yg(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const i=(a,d,m)=>{this._hue=Math.max(0,Math.min(360,a)),this._saturation=Math.max(0,Math.min(100,d)),this._value=Math.max(0,Math.min(100,m)),this.doOnChange()};if(t.includes("hsl")){const a=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,m)=>m>2?Number.parseFloat(d):Number.parseInt(d,10));if(a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3){const{h:d,s:m,v:_}=CQ(a[0],a[1],a[2]);i(d,m,_)}}else if(t.includes("hsv")){const a=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,m)=>m>2?Number.parseFloat(d):Number.parseInt(d,10));a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3&&i(a[0],a[1],a[2])}else if(t.includes("rgb")){const a=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,m)=>m>2?Number.parseFloat(d):Number.parseInt(d,10));if(a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3){const{h:d,s:m,v:_}=ER(a[0],a[1],a[2]);i(d,m,_)}}else if(t.includes("#")){const a=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(a))return;let d,m,_;a.length===3?(d=ih(a[0]+a[0]),m=ih(a[1]+a[1]),_=ih(a[2]+a[2])):(a.length===6||a.length===8)&&(d=ih(a.slice(0,2)),m=ih(a.slice(2,4)),_=ih(a.slice(4,6))),a.length===8?this._alpha=ih(a.slice(6))/255*100:(a.length===3||a.length===6)&&(this._alpha=100);const{h:x,s:o,v:C}=ER(d,m,_);i(x,o,C)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:i,_value:a,_alpha:d,format:m}=this;if(this.enableAlpha)switch(m){case"hsl":{const _=SR(t,i/100,a/100);this.value=`hsla(${t}, ${Math.round(_[1]*100)}%, ${Math.round(_[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(i)}%, ${Math.round(a)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${CR(Yg(t,i,a))}${z0(d*255/100)}`;break}default:{const{r:_,g:x,b:o}=Yg(t,i,a);this.value=`rgba(${_}, ${x}, ${o}, ${this.get("alpha")/100})`}}else switch(m){case"hsl":{const _=SR(t,i/100,a/100);this.value=`hsl(${t}, ${Math.round(_[1]*100)}%, ${Math.round(_[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(i)}%, ${Math.round(a)}%)`;break}case"rgb":{const{r:_,g:x,b:o}=Yg(t,i,a);this.value=`rgb(${_}, ${x}, ${o})`;break}default:this.value=CR(Yg(t,i,a))}}}const EQ=Ge({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(e){const t=Jt("color-predefine"),{currentColor:i}=kn(L2),a=be(m(e.colors,e.color));Wt(()=>i.value,_=>{const x=new mv;x.fromString(_),a.value.forEach(o=>{o.selected=x.compare(o)})}),ns(()=>{a.value=m(e.colors,e.color)});function d(_){e.color.fromString(e.colors[_])}function m(_,x){return _.map(o=>{const C=new mv;return C.enableAlpha=e.enableAlpha,C.format="rgba",C.fromString(o),C.selected=C.value===x.value,C})}return{rgbaColors:a,handleSelect:d,ns:t}}});function MQ(e,t,i,a,d,m){return se(),Ae("div",{class:ce(e.ns.b())},[Ve("div",{class:ce(e.ns.e("colors"))},[(se(!0),Ae(Bn,null,Fr(e.rgbaColors,(_,x)=>(se(),Ae("div",{key:e.colors[x],class:ce([e.ns.e("color-selector"),e.ns.is("alpha",_._alpha<100),{selected:_.selected}]),onClick:o=>e.handleSelect(x)},[Ve("div",{style:Nn({backgroundColor:_.value})},null,4)],10,["onClick"]))),128))],2)],2)}var IQ=hn(EQ,[["render",MQ],["__file","predefine.vue"]]);const kQ=Ge({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=Jt("color-svpanel"),i=Cr(),a=be(0),d=be(0),m=be("hsl(0, 100%, 50%)"),_=Q(()=>{const C=e.color.get("hue"),k=e.color.get("value");return{hue:C,value:k}});function x(){const C=e.color.get("saturation"),k=e.color.get("value"),A=i.vnode.el,{clientWidth:z,clientHeight:N}=A;d.value=C*z/100,a.value=(100-k)*N/100,m.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function o(C){const A=i.vnode.el.getBoundingClientRect(),{clientX:z,clientY:N}=BT(C);let $=z-A.left,F=N-A.top;$=Math.max(0,$),$=Math.min($,A.width),F=Math.max(0,F),F=Math.min(F,A.height),d.value=$,a.value=F,e.color.set({saturation:$/A.width*100,value:100-F/A.height*100})}return Wt(()=>_.value,()=>{x()}),vr(()=>{Bv(i.vnode.el,{drag:C=>{o(C)},end:C=>{o(C)}}),x()}),{cursorTop:a,cursorLeft:d,background:m,colorValue:_,handleDrag:o,update:x,ns:t}}});function AQ(e,t,i,a,d,m){return se(),Ae("div",{class:ce(e.ns.b()),style:Nn({backgroundColor:e.background})},[Ve("div",{class:ce(e.ns.e("white"))},null,2),Ve("div",{class:ce(e.ns.e("black"))},null,2),Ve("div",{class:ce(e.ns.e("cursor")),style:Nn({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},[Ve("div")],6)],6)}var PQ=hn(kQ,[["render",AQ],["__file","sv-panel.vue"]]);const RQ=Ge({name:"ElColorPicker"}),DQ=Ge({...RQ,props:xQ,emits:wQ,setup(e,{expose:t,emit:i}){const a=e,{t:d}=Gr(),m=Jt("color"),{formItem:_}=bs(),x=xi(),o=ys(),{inputId:C,isLabeledByFormItem:k}=Sl(a,{formItemContext:_}),A=be(),z=be(),N=be(),$=be(),F=be(),G=be(),{isFocused:U,handleFocus:te,handleBlur:Z}=Bh(F,{beforeFocus(){return o.value},beforeBlur(Ht){var Tn;return(Tn=$.value)==null?void 0:Tn.isFocusInsideContent(Ht)},afterBlur(){Ie(!1),ye()}});let q=!0;const X=ao(new mv({enableAlpha:a.showAlpha,format:a.colorFormat||"",value:a.modelValue})),ie=be(!1),de=be(!1),le=be(""),pe=Q(()=>!a.modelValue&&!de.value?"transparent":Ye(X,a.showAlpha)),ge=Q(()=>!a.modelValue&&!de.value?"":X.value),he=Q(()=>k.value?void 0:a.ariaLabel||d("el.colorpicker.defaultLabel")),ue=Q(()=>k.value?_==null?void 0:_.labelId:void 0),Re=Q(()=>[m.b("picker"),m.is("disabled",o.value),m.bm("picker",x.value),m.is("focused",U.value)]);function Ye(Ht,Tn){if(!(Ht instanceof mv))throw new TypeError("color should be instance of _color Class");const{r:Pe,g:At,b:He}=Ht.toRgb();return Tn?`rgba(${Pe}, ${At}, ${He}, ${Ht.get("alpha")/100})`:`rgb(${Pe}, ${At}, ${He})`}function Ie(Ht){ie.value=Ht}const fe=Js(Ie,100,{leading:!0});function Me(){o.value||Ie(!0)}function Se(){fe(!1),ye()}function ye(){Vn(()=>{a.modelValue?X.fromString(a.modelValue):(X.value="",Vn(()=>{de.value=!1}))})}function Ce(){o.value||fe(!ie.value)}function Fe(){X.fromString(le.value)}function it(){const Ht=X.value;i(xr,Ht),i("change",Ht),a.validateEvent&&(_==null||_.validate("change").catch(Tn=>void 0)),fe(!1),Vn(()=>{const Tn=new mv({enableAlpha:a.showAlpha,format:a.colorFormat||"",value:a.modelValue});X.compare(Tn)||ye()})}function We(){fe(!1),i(xr,null),i("change",null),a.modelValue!==null&&a.validateEvent&&(_==null||_.validate("change").catch(Ht=>void 0)),ye()}function ut(){ie.value&&(Se(),U.value&&mt())}function Lt(Ht){Ht.preventDefault(),Ht.stopPropagation(),Ie(!1),ye()}function Ft(Ht){switch(Ht.code){case En.enter:case En.numpadEnter:case En.space:Ht.preventDefault(),Ht.stopPropagation(),Me(),G.value.focus();break;case En.esc:Lt(Ht);break}}function mt(){F.value.focus()}function jt(){F.value.blur()}return vr(()=>{a.modelValue&&(le.value=ge.value)}),Wt(()=>a.modelValue,Ht=>{Ht?Ht&&Ht!==X.value&&(q=!1,X.fromString(Ht)):de.value=!1}),Wt(()=>[a.colorFormat,a.showAlpha],()=>{X.enableAlpha=a.showAlpha,X.format=a.colorFormat||X.format,X.doOnChange(),i(xr,X.value)}),Wt(()=>ge.value,Ht=>{le.value=Ht,q&&i("activeChange",Ht),q=!0}),Wt(()=>X.value,()=>{!a.modelValue&&!de.value&&(de.value=!0)}),Wt(()=>ie.value,()=>{Vn(()=>{var Ht,Tn,Pe;(Ht=A.value)==null||Ht.update(),(Tn=z.value)==null||Tn.update(),(Pe=N.value)==null||Pe.update()})}),Br(L2,{currentColor:ge}),t({color:X,show:Me,hide:Se,focus:mt,blur:jt}),(Ht,Tn)=>(se(),It(y(os),{ref_key:"popper",ref:$,visible:ie.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[y(m).be("picker","panel"),y(m).b("dropdown"),Ht.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:Ht.teleported,transition:`${y(m).namespace.value}-zoom-in-top`,persistent:"",onHide:Pe=>Ie(!1)},{content:st(()=>[mr((se(),Ae("div",{onKeydown:Mo(Lt,["esc"])},[Ve("div",{class:ce(y(m).be("dropdown","main-wrapper"))},[qe(bQ,{ref_key:"hue",ref:A,class:"hue-slider",color:y(X),vertical:""},null,8,["color"]),qe(PQ,{ref_key:"sv",ref:z,color:y(X)},null,8,["color"])],2),Ht.showAlpha?(se(),It(vQ,{key:0,ref_key:"alpha",ref:N,color:y(X)},null,8,["color"])):bt("v-if",!0),Ht.predefine?(se(),It(IQ,{key:1,ref:"predefine","enable-alpha":Ht.showAlpha,color:y(X),colors:Ht.predefine},null,8,["enable-alpha","color","colors"])):bt("v-if",!0),Ve("div",{class:ce(y(m).be("dropdown","btns"))},[Ve("span",{class:ce(y(m).be("dropdown","value"))},[qe(y(vs),{ref_key:"inputRef",ref:G,modelValue:le.value,"onUpdate:modelValue":Pe=>le.value=Pe,"validate-event":!1,size:"small",onKeyup:Mo(Fe,["enter"]),onBlur:Fe},null,8,["modelValue","onUpdate:modelValue","onKeyup"])],2),qe(y(zi),{class:ce(y(m).be("dropdown","link-btn")),text:"",size:"small",onClick:We},{default:st(()=>[$r(fn(y(d)("el.colorpicker.clear")),1)]),_:1},8,["class"]),qe(y(zi),{plain:"",size:"small",class:ce(y(m).be("dropdown","btn")),onClick:it},{default:st(()=>[$r(fn(y(d)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,["onKeydown"])),[[y(Rc),ut]])]),default:st(()=>[Ve("div",kr({id:y(C),ref_key:"triggerRef",ref:F},Ht.$attrs,{class:y(Re),role:"button","aria-label":y(he),"aria-labelledby":y(ue),"aria-description":y(d)("el.colorpicker.description",{color:Ht.modelValue||""}),"aria-disabled":y(o),tabindex:y(o)?-1:Ht.tabindex,onKeydown:Ft,onFocus:y(te),onBlur:y(Z)}),[y(o)?(se(),Ae("div",{key:0,class:ce(y(m).be("picker","mask"))},null,2)):bt("v-if",!0),Ve("div",{class:ce(y(m).be("picker","trigger")),onClick:Ce},[Ve("span",{class:ce([y(m).be("picker","color"),y(m).is("alpha",Ht.showAlpha)])},[Ve("span",{class:ce(y(m).be("picker","color-inner")),style:Nn({backgroundColor:y(pe)})},[mr(qe(y(Dn),{class:ce([y(m).be("picker","icon"),y(m).is("icon-arrow-down")])},{default:st(()=>[qe(y(Bc))]),_:1},8,["class"]),[[no,Ht.modelValue||de.value]]),mr(qe(y(Dn),{class:ce([y(m).be("picker","empty"),y(m).is("icon-close")])},{default:st(()=>[qe(y(vl))]),_:1},8,["class"]),[[no,!Ht.modelValue&&!de.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","onHide"]))}});var LQ=hn(DQ,[["__file","color-picker.vue"]]);const OQ=cr(LQ),zQ=Ge({name:"ElContainer"}),BQ=Ge({...zQ,props:{direction:{type:String}},setup(e){const t=e,i=Ai(),a=Jt("container"),d=Q(()=>t.direction==="vertical"?!0:t.direction==="horizontal"?!1:i&&i.default?i.default().some(_=>{const x=_.type.name;return x==="ElHeader"||x==="ElFooter"}):!1);return(m,_)=>(se(),Ae("section",{class:ce([y(a).b(),y(a).is("vertical",y(d))])},[_t(m.$slots,"default")],2))}});var FQ=hn(BQ,[["__file","container.vue"]]);const NQ=Ge({name:"ElAside"}),$Q=Ge({...NQ,props:{width:{type:String,default:null}},setup(e){const t=e,i=Jt("aside"),a=Q(()=>t.width?i.cssVarBlock({width:t.width}):{});return(d,m)=>(se(),Ae("aside",{class:ce(y(i).b()),style:Nn(y(a))},[_t(d.$slots,"default")],6))}});var O2=hn($Q,[["__file","aside.vue"]]);const VQ=Ge({name:"ElFooter"}),UQ=Ge({...VQ,props:{height:{type:String,default:null}},setup(e){const t=e,i=Jt("footer"),a=Q(()=>t.height?i.cssVarBlock({height:t.height}):{});return(d,m)=>(se(),Ae("footer",{class:ce(y(i).b()),style:Nn(y(a))},[_t(d.$slots,"default")],6))}});var z2=hn(UQ,[["__file","footer.vue"]]);const jQ=Ge({name:"ElHeader"}),HQ=Ge({...jQ,props:{height:{type:String,default:null}},setup(e){const t=e,i=Jt("header"),a=Q(()=>t.height?i.cssVarBlock({height:t.height}):{});return(d,m)=>(se(),Ae("header",{class:ce(y(i).b()),style:Nn(y(a))},[_t(d.$slots,"default")],6))}});var B2=hn(HQ,[["__file","header.vue"]]);const GQ=Ge({name:"ElMain"}),WQ=Ge({...GQ,setup(e){const t=Jt("main");return(i,a)=>(se(),Ae("main",{class:ce(y(t).b())},[_t(i.$slots,"default")],2))}});var F2=hn(WQ,[["__file","main.vue"]]);const qQ=cr(FQ,{Aside:O2,Footer:z2,Header:B2,Main:F2}),KQ=Jo(O2),ZQ=Jo(z2),YQ=Jo(B2),XQ=Jo(F2);var N2={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Ql,function(){return function(i,a){var d=a.prototype,m=d.format;d.format=function(_){var x=this,o=this.$locale();if(!this.isValid())return m.bind(this)(_);var C=this.$utils(),k=(_||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(A){switch(A){case"Q":return Math.ceil((x.$M+1)/3);case"Do":return o.ordinal(x.$D);case"gggg":return x.weekYear();case"GGGG":return x.isoWeekYear();case"wo":return o.ordinal(x.week(),"W");case"w":case"ww":return C.s(x.week(),A==="w"?1:2,"0");case"W":case"WW":return C.s(x.isoWeek(),A==="W"?1:2,"0");case"k":case"kk":return C.s(String(x.$H===0?24:x.$H),A==="k"?1:2,"0");case"X":return Math.floor(x.$d.getTime()/1e3);case"x":return x.$d.getTime();case"z":return"["+x.offsetName()+"]";case"zzz":return"["+x.offsetName("long")+"]";default:return A}});return m.bind(this)(k)}}})})(N2);var JQ=N2.exports;const QQ=ec(JQ);var $2={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Ql,function(){var i="week",a="year";return function(d,m,_){var x=m.prototype;x.week=function(o){if(o===void 0&&(o=null),o!==null)return this.add(7*(o-this.week()),"day");var C=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var k=_(this).startOf(a).add(1,a).date(C),A=_(this).endOf(i);if(k.isBefore(A))return 1}var z=_(this).startOf(a).date(C).startOf(i).subtract(1,"millisecond"),N=this.diff(z,i,!0);return N<0?_(this).startOf("week").week():Math.ceil(N)},x.weeks=function(o){return o===void 0&&(o=null),this.week(o)}}})})($2);var eee=$2.exports;const tee=ec(eee);var V2={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Ql,function(){return function(i,a){a.prototype.weekYear=function(){var d=this.month(),m=this.week(),_=this.year();return m===1&&d===11?_+1:d===0&&m>=52?_-1:_}}})})(V2);var nee=V2.exports;const ree=ec(nee);var U2={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Ql,function(){return function(i,a,d){a.prototype.dayOfYear=function(m){var _=Math.round((d(this).startOf("day")-d(this).startOf("year"))/864e5)+1;return m==null?_:this.add(m-_,"day")}}})})(U2);var oee=U2.exports;const iee=ec(oee);var j2={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Ql,function(){return function(i,a){a.prototype.isSameOrAfter=function(d,m){return this.isSame(d,m)||this.isAfter(d,m)}}})})(j2);var see=j2.exports;const aee=ec(see);var H2={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Ql,function(){return function(i,a){a.prototype.isSameOrBefore=function(d,m){return this.isSame(d,m)||this.isBefore(d,m)}}})})(H2);var lee=H2.exports;const cee=ec(lee),r1=Symbol(),uee=ln({...BC,type:{type:at(String),default:"date"}}),dee=["date","dates","year","years","month","months","week","range"],NC=ln({disabledDate:{type:at(Function)},date:{type:at(Object),required:!0},minDate:{type:at(Object)},maxDate:{type:at(Object)},parsedValue:{type:at([Object,Array])},rangeState:{type:at(Object),default:()=>({endDate:null,selecting:!1})}}),G2=ln({type:{type:at(String),required:!0,values:_W},dateFormat:String,timeFormat:String,showNow:{type:Boolean,default:!0}}),$C=ln({unlinkPanels:Boolean,parsedValue:{type:at(Array)}}),VC=e=>({type:String,values:dee,default:e}),hee=ln({...G2,parsedValue:{type:at([Object,Array])},visible:{type:Boolean},format:{type:String,default:""}}),$p=e=>{if(!on(e))return!1;const[t,i]=e;return sr.isDayjs(t)&&sr.isDayjs(i)&&t.isSameOrBefore(i)},UC=(e,{lang:t,unit:i,unlinkPanels:a})=>{let d;if(on(e)){let[m,_]=e.map(x=>sr(x).locale(t));return a||(_=m.add(1,i)),[m,_]}else e?d=sr(e):d=sr();return d=d.locale(t),[d,d.add(1,i)]},fee=(e,t,{columnIndexOffset:i,startDate:a,nextEndDate:d,now:m,unit:_,relativeDateGetter:x,setCellMetadata:o,setRowMetadata:C})=>{for(let k=0;k<e.row;k++){const A=t[k];for(let z=0;z<e.column;z++){let N=A[z+i];N||(N={row:k,column:z,type:"normal",inRange:!1,start:!1,end:!1});const $=k*e.column+z,F=x($);N.dayjs=F,N.date=F.toDate(),N.timestamp=F.valueOf(),N.type="normal",N.inRange=!!(a&&F.isSameOrAfter(a,_)&&d&&F.isSameOrBefore(d,_))||!!(a&&F.isSameOrBefore(a,_)&&d&&F.isSameOrAfter(d,_)),a!=null&&a.isSameOrAfter(d)?(N.start=!!d&&F.isSame(d,_),N.end=a&&F.isSame(a,_)):(N.start=!!a&&F.isSame(a,_),N.end=!!d&&F.isSame(d,_)),F.isSame(m,_)&&(N.type="today"),o==null||o(N,{rowIndex:k,columnIndex:z}),A[z+i]=N}C==null||C(A)}},db=(e,t,i)=>{const a=sr().locale(i).startOf("month").month(t).year(e),d=a.daysInMonth();return Zu(d).map(m=>a.add(m,"day").toDate())},Fv=(e,t,i,a)=>{const d=sr().year(e).month(t).startOf("month"),m=db(e,t,i).find(_=>!(a!=null&&a(_)));return m?sr(m).locale(i):d.locale(i)},FS=(e,t,i)=>{const a=e.year();if(!(i!=null&&i(e.toDate())))return e.locale(t);const d=e.month();if(!db(a,d,t).every(i))return Fv(a,d,t,i);for(let m=0;m<12;m++)if(!db(a,m,t).every(i))return Fv(a,m,t,i);return e},pee=ln({...NC,cellClassName:{type:at(Function)},showWeekNumber:Boolean,selectionMode:VC("date")}),mee=["changerange","pick","select"],NS=(e="")=>["normal","today"].includes(e),gee=(e,t)=>{const{lang:i}=Gr(),a=be(),d=be(),m=be(),_=be(),x=be([[],[],[],[],[],[]]);let o=!1;const C=e.date.$locale().weekStart||7,k=e.date.locale("en").localeData().weekdaysShort().map(ye=>ye.toLowerCase()),A=Q(()=>C>3?7-C:-C),z=Q(()=>{const ye=e.date.startOf("month");return ye.subtract(ye.day()||7,"day")}),N=Q(()=>k.concat(k).slice(C,C+7)),$=Q(()=>sO(y(q)).some(ye=>ye.isCurrent)),F=Q(()=>{const ye=e.date.startOf("month"),Ce=ye.day()||7,Fe=ye.daysInMonth(),it=ye.subtract(1,"month").daysInMonth();return{startOfMonthDay:Ce,dateCountOfMonth:Fe,dateCountOfLastMonth:it}}),G=Q(()=>e.selectionMode==="dates"?Ds(e.parsedValue):[]),U=(ye,{count:Ce,rowIndex:Fe,columnIndex:it})=>{const{startOfMonthDay:We,dateCountOfMonth:ut,dateCountOfLastMonth:Lt}=y(F),Ft=y(A);if(Fe>=0&&Fe<=1){const mt=We+Ft<0?7+We+Ft:We+Ft;if(it+Fe*7>=mt)return ye.text=Ce,!0;ye.text=Lt-(mt-it%7)+1+Fe*7,ye.type="prev-month"}else return Ce<=ut?ye.text=Ce:(ye.text=Ce-ut,ye.type="next-month"),!0;return!1},te=(ye,{columnIndex:Ce,rowIndex:Fe},it)=>{const{disabledDate:We,cellClassName:ut}=e,Lt=y(G),Ft=U(ye,{count:it,rowIndex:Fe,columnIndex:Ce}),mt=ye.dayjs.toDate();return ye.selected=Lt.find(jt=>jt.isSame(ye.dayjs,"day")),ye.isSelected=!!ye.selected,ye.isCurrent=ie(ye),ye.disabled=We==null?void 0:We(mt),ye.customClass=ut==null?void 0:ut(mt),Ft},Z=ye=>{if(e.selectionMode==="week"){const[Ce,Fe]=e.showWeekNumber?[1,7]:[0,6],it=Se(ye[Ce+1]);ye[Ce].inRange=it,ye[Ce].start=it,ye[Fe].inRange=it,ye[Fe].end=it}},q=Q(()=>{const{minDate:ye,maxDate:Ce,rangeState:Fe,showWeekNumber:it}=e,We=y(A),ut=y(x),Lt="day";let Ft=1;if(it)for(let mt=0;mt<6;mt++)ut[mt][0]||(ut[mt][0]={type:"week",text:y(z).add(mt*7+1,Lt).week()});return fee({row:6,column:7},ut,{startDate:ye,columnIndexOffset:it?1:0,nextEndDate:Fe.endDate||Ce||Fe.selecting&&ye||null,now:sr().locale(y(i)).startOf(Lt),unit:Lt,relativeDateGetter:mt=>y(z).add(mt-We,Lt),setCellMetadata:(...mt)=>{te(...mt,Ft)&&(Ft+=1)},setRowMetadata:Z}),ut});Wt(()=>e.date,async()=>{var ye;(ye=y(a))!=null&&ye.contains(document.activeElement)&&(await Vn(),await X())});const X=async()=>{var ye;return(ye=y(d))==null?void 0:ye.focus()},ie=ye=>e.selectionMode==="date"&&NS(ye.type)&&de(ye,e.parsedValue),de=(ye,Ce)=>Ce?sr(Ce).locale(y(i)).isSame(e.date.date(Number(ye.text)),"day"):!1,le=(ye,Ce)=>{const Fe=ye*7+(Ce-(e.showWeekNumber?1:0))-y(A);return y(z).add(Fe,"day")},pe=ye=>{var Ce;if(!e.rangeState.selecting)return;let Fe=ye.target;if(Fe.tagName==="SPAN"&&(Fe=(Ce=Fe.parentNode)==null?void 0:Ce.parentNode),Fe.tagName==="DIV"&&(Fe=Fe.parentNode),Fe.tagName!=="TD")return;const it=Fe.parentNode.rowIndex-1,We=Fe.cellIndex;y(q)[it][We].disabled||(it!==y(m)||We!==y(_))&&(m.value=it,_.value=We,t("changerange",{selecting:!0,endDate:le(it,We)}))},ge=ye=>!y($)&&(ye==null?void 0:ye.text)===1&&ye.type==="normal"||ye.isCurrent,he=ye=>{o||y($)||e.selectionMode!=="date"||Me(ye,!0)},ue=ye=>{ye.target.closest("td")&&(o=!0)},Re=ye=>{ye.target.closest("td")&&(o=!1)},Ye=ye=>{!e.rangeState.selecting||!e.minDate?(t("pick",{minDate:ye,maxDate:null}),t("select",!0)):(ye>=e.minDate?t("pick",{minDate:e.minDate,maxDate:ye}):t("pick",{minDate:ye,maxDate:e.minDate}),t("select",!1))},Ie=ye=>{const Ce=ye.week(),Fe=`${ye.year()}w${Ce}`;t("pick",{year:ye.year(),week:Ce,value:Fe,date:ye.startOf("week")})},fe=(ye,Ce)=>{const Fe=Ce?Ds(e.parsedValue).filter(it=>(it==null?void 0:it.valueOf())!==ye.valueOf()):Ds(e.parsedValue).concat([ye]);t("pick",Fe)},Me=(ye,Ce=!1)=>{const Fe=ye.target.closest("td");if(!Fe)return;const it=Fe.parentNode.rowIndex-1,We=Fe.cellIndex,ut=y(q)[it][We];if(ut.disabled||ut.type==="week")return;const Lt=le(it,We);switch(e.selectionMode){case"range":{Ye(Lt);break}case"date":{t("pick",Lt,Ce);break}case"week":{Ie(Lt);break}case"dates":{fe(Lt,!!ut.selected);break}}},Se=ye=>{if(e.selectionMode!=="week")return!1;let Ce=e.date.startOf("day");if(ye.type==="prev-month"&&(Ce=Ce.subtract(1,"month")),ye.type==="next-month"&&(Ce=Ce.add(1,"month")),Ce=Ce.date(Number.parseInt(ye.text,10)),e.parsedValue&&!on(e.parsedValue)){const Fe=(e.parsedValue.day()-C+7)%7-1;return e.parsedValue.subtract(Fe,"day").isSame(Ce,"day")}return!1};return{WEEKS:N,rows:q,tbodyRef:a,currentCellRef:d,focus:X,isCurrent:ie,isWeekActive:Se,isSelectedCell:ge,handlePickDate:Me,handleMouseUp:Re,handleMouseDown:ue,handleMouseMove:pe,handleFocus:he}},vee=(e,{isCurrent:t,isWeekActive:i})=>{const a=Jt("date-table"),{t:d}=Gr(),m=Q(()=>[a.b(),{"is-week-mode":e.selectionMode==="week"}]),_=Q(()=>d("el.datepicker.dateTablePrompt")),x=Q(()=>d("el.datepicker.week"));return{tableKls:m,tableLabel:_,weekLabel:x,getCellClasses:k=>{const A=[];return NS(k.type)&&!k.disabled?(A.push("available"),k.type==="today"&&A.push("today")):A.push(k.type),t(k)&&A.push("current"),k.inRange&&(NS(k.type)||e.selectionMode==="week")&&(A.push("in-range"),k.start&&A.push("start-date"),k.end&&A.push("end-date")),k.disabled&&A.push("disabled"),k.selected&&A.push("selected"),k.customClass&&A.push(k.customClass),A.join(" ")},getRowKls:k=>[a.e("row"),{current:i(k)}],t:d}},_ee=ln({cell:{type:at(Object)}});var jC=Ge({name:"ElDatePickerCell",props:_ee,setup(e){const t=Jt("date-table-cell"),{slots:i}=kn(r1);return()=>{const{cell:a}=e;return _t(i,"default",{...a},()=>{var d;return[qe("div",{class:t.b()},[qe("span",{class:t.e("text")},[(d=a==null?void 0:a.renderText)!=null?d:a==null?void 0:a.text])])]})}}});const yee=Ge({__name:"basic-date-table",props:pee,emits:mee,setup(e,{expose:t,emit:i}){const a=e,{WEEKS:d,rows:m,tbodyRef:_,currentCellRef:x,focus:o,isCurrent:C,isWeekActive:k,isSelectedCell:A,handlePickDate:z,handleMouseUp:N,handleMouseDown:$,handleMouseMove:F,handleFocus:G}=gee(a,i),{tableLabel:U,tableKls:te,weekLabel:Z,getCellClasses:q,getRowKls:X,t:ie}=vee(a,{isCurrent:C,isWeekActive:k});return t({focus:o}),(de,le)=>(se(),Ae("table",{"aria-label":y(U),class:ce(y(te)),cellspacing:"0",cellpadding:"0",role:"grid",onClick:y(z),onMousemove:y(F),onMousedown:Yn(y($),["prevent"]),onMouseup:y(N)},[Ve("tbody",{ref_key:"tbodyRef",ref:_},[Ve("tr",null,[de.showWeekNumber?(se(),Ae("th",{key:0,scope:"col"},fn(y(Z)),1)):bt("v-if",!0),(se(!0),Ae(Bn,null,Fr(y(d),(pe,ge)=>(se(),Ae("th",{key:ge,"aria-label":y(ie)("el.datepicker.weeksFull."+pe),scope:"col"},fn(y(ie)("el.datepicker.weeks."+pe)),9,["aria-label"]))),128))]),(se(!0),Ae(Bn,null,Fr(y(m),(pe,ge)=>(se(),Ae("tr",{key:ge,class:ce(y(X)(pe[1]))},[(se(!0),Ae(Bn,null,Fr(pe,(he,ue)=>(se(),Ae("td",{key:`${ge}.${ue}`,ref_for:!0,ref:Re=>y(A)(he)&&(x.value=Re),class:ce(y(q)(he)),"aria-current":he.isCurrent?"date":void 0,"aria-selected":he.isCurrent,tabindex:y(A)(he)?0:-1,onFocus:y(G)},[qe(y(jC),{cell:he},null,8,["cell"])],42,["aria-current","aria-selected","tabindex","onFocus"]))),128))],2))),128))],512)],42,["aria-label","onClick","onMousemove","onMousedown","onMouseup"]))}});var $S=hn(yee,[["__file","basic-date-table.vue"]]);const bee=ln({...NC,selectionMode:VC("month")}),xee=Ge({__name:"basic-month-table",props:bee,emits:["changerange","pick","select"],setup(e,{expose:t,emit:i}){const a=e,d=Jt("month-table"),{t:m,lang:_}=Gr(),x=be(),o=be(),C=be(a.date.locale("en").localeData().monthsShort().map(Z=>Z.toLowerCase())),k=be([[],[],[]]),A=be(),z=be(),N=Q(()=>{var Z,q;const X=k.value,ie=sr().locale(_.value).startOf("month");for(let de=0;de<3;de++){const le=X[de];for(let pe=0;pe<4;pe++){const ge=le[pe]||(le[pe]={row:de,column:pe,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1});ge.type="normal";const he=de*4+pe,ue=a.date.startOf("year").month(he),Re=a.rangeState.endDate||a.maxDate||a.rangeState.selecting&&a.minDate||null;ge.inRange=!!(a.minDate&&ue.isSameOrAfter(a.minDate,"month")&&Re&&ue.isSameOrBefore(Re,"month"))||!!(a.minDate&&ue.isSameOrBefore(a.minDate,"month")&&Re&&ue.isSameOrAfter(Re,"month")),(Z=a.minDate)!=null&&Z.isSameOrAfter(Re)?(ge.start=!!(Re&&ue.isSame(Re,"month")),ge.end=a.minDate&&ue.isSame(a.minDate,"month")):(ge.start=!!(a.minDate&&ue.isSame(a.minDate,"month")),ge.end=!!(Re&&ue.isSame(Re,"month"))),ie.isSame(ue)&&(ge.type="today"),ge.text=he,ge.disabled=((q=a.disabledDate)==null?void 0:q.call(a,ue.toDate()))||!1}}return X}),$=()=>{var Z;(Z=o.value)==null||Z.focus()},F=Z=>{const q={},X=a.date.year(),ie=new Date,de=Z.text;return q.disabled=a.disabledDate?db(X,de,_.value).every(a.disabledDate):!1,q.current=Ds(a.parsedValue).findIndex(le=>sr.isDayjs(le)&&le.year()===X&&le.month()===de)>=0,q.today=ie.getFullYear()===X&&ie.getMonth()===de,Z.inRange&&(q["in-range"]=!0,Z.start&&(q["start-date"]=!0),Z.end&&(q["end-date"]=!0)),q},G=Z=>{const q=a.date.year(),X=Z.text;return Ds(a.date).findIndex(ie=>ie.year()===q&&ie.month()===X)>=0},U=Z=>{var q;if(!a.rangeState.selecting)return;let X=Z.target;if(X.tagName==="SPAN"&&(X=(q=X.parentNode)==null?void 0:q.parentNode),X.tagName==="DIV"&&(X=X.parentNode),X.tagName!=="TD")return;const ie=X.parentNode.rowIndex,de=X.cellIndex;N.value[ie][de].disabled||(ie!==A.value||de!==z.value)&&(A.value=ie,z.value=de,i("changerange",{selecting:!0,endDate:a.date.startOf("year").month(ie*4+de)}))},te=Z=>{var q;const X=(q=Z.target)==null?void 0:q.closest("td");if((X==null?void 0:X.tagName)!=="TD"||Ks(X,"disabled"))return;const ie=X.cellIndex,le=X.parentNode.rowIndex*4+ie,pe=a.date.startOf("year").month(le);if(a.selectionMode==="months"){if(Z.type==="keydown"){i("pick",Ds(a.parsedValue),!1);return}const ge=Fv(a.date.year(),le,_.value,a.disabledDate),he=Ks(X,"current")?Ds(a.parsedValue).filter(ue=>(ue==null?void 0:ue.month())!==ge.month()):Ds(a.parsedValue).concat([sr(ge)]);i("pick",he)}else a.selectionMode==="range"?a.rangeState.selecting?(a.minDate&&pe>=a.minDate?i("pick",{minDate:a.minDate,maxDate:pe}):i("pick",{minDate:pe,maxDate:a.minDate}),i("select",!1)):(i("pick",{minDate:pe,maxDate:null}),i("select",!0)):i("pick",le)};return Wt(()=>a.date,async()=>{var Z,q;(Z=x.value)!=null&&Z.contains(document.activeElement)&&(await Vn(),(q=o.value)==null||q.focus())}),t({focus:$}),(Z,q)=>(se(),Ae("table",{role:"grid","aria-label":y(m)("el.datepicker.monthTablePrompt"),class:ce(y(d).b()),onClick:te,onMousemove:U},[Ve("tbody",{ref_key:"tbodyRef",ref:x},[(se(!0),Ae(Bn,null,Fr(y(N),(X,ie)=>(se(),Ae("tr",{key:ie},[(se(!0),Ae(Bn,null,Fr(X,(de,le)=>(se(),Ae("td",{key:le,ref_for:!0,ref:pe=>G(de)&&(o.value=pe),class:ce(F(de)),"aria-selected":`${G(de)}`,"aria-label":y(m)(`el.datepicker.month${+de.text+1}`),tabindex:G(de)?0:-1,onKeydown:[Mo(Yn(te,["prevent","stop"]),["space"]),Mo(Yn(te,["prevent","stop"]),["enter"])]},[qe(y(jC),{cell:{...de,renderText:y(m)("el.datepicker.months."+C.value[de.text])}},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var VS=hn(xee,[["__file","basic-month-table.vue"]]);const wee=ln({...NC,selectionMode:VC("year")}),See=Ge({__name:"basic-year-table",props:wee,emits:["changerange","pick","select"],setup(e,{expose:t,emit:i}){const a=e,d=(q,X)=>{const ie=sr(String(q)).locale(X).startOf("year"),le=ie.endOf("year").dayOfYear();return Zu(le).map(pe=>ie.add(pe,"day").toDate())},m=Jt("year-table"),{t:_,lang:x}=Gr(),o=be(),C=be(),k=Q(()=>Math.floor(a.date.year()/10)*10),A=be([[],[],[]]),z=be(),N=be(),$=Q(()=>{var q;const X=A.value,ie=sr().locale(x.value).startOf("year");for(let de=0;de<3;de++){const le=X[de];for(let pe=0;pe<4&&!(de*4+pe>=10);pe++){let ge=le[pe];ge||(ge={row:de,column:pe,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1}),ge.type="normal";const he=de*4+pe+k.value,ue=sr().year(he),Re=a.rangeState.endDate||a.maxDate||a.rangeState.selecting&&a.minDate||null;ge.inRange=!!(a.minDate&&ue.isSameOrAfter(a.minDate,"year")&&Re&&ue.isSameOrBefore(Re,"year"))||!!(a.minDate&&ue.isSameOrBefore(a.minDate,"year")&&Re&&ue.isSameOrAfter(Re,"year")),(q=a.minDate)!=null&&q.isSameOrAfter(Re)?(ge.start=!!(Re&&ue.isSame(Re,"year")),ge.end=!!(a.minDate&&ue.isSame(a.minDate,"year"))):(ge.start=!!(a.minDate&&ue.isSame(a.minDate,"year")),ge.end=!!(Re&&ue.isSame(Re,"year"))),ie.isSame(ue)&&(ge.type="today"),ge.text=he;const Ie=ue.toDate();ge.disabled=a.disabledDate&&a.disabledDate(Ie)||!1,le[pe]=ge}}return X}),F=()=>{var q;(q=C.value)==null||q.focus()},G=q=>{const X={},ie=sr().locale(x.value),de=q.text;return X.disabled=a.disabledDate?d(de,x.value).every(a.disabledDate):!1,X.today=ie.year()===de,X.current=Ds(a.parsedValue).findIndex(le=>le.year()===de)>=0,q.inRange&&(X["in-range"]=!0,q.start&&(X["start-date"]=!0),q.end&&(X["end-date"]=!0)),X},U=q=>{const X=q.text;return Ds(a.date).findIndex(ie=>ie.year()===X)>=0},te=q=>{var X;const ie=(X=q.target)==null?void 0:X.closest("td");if(!ie||!ie.textContent||Ks(ie,"disabled"))return;const de=ie.cellIndex,pe=ie.parentNode.rowIndex*4+de+k.value,ge=sr().year(pe);if(a.selectionMode==="range")a.rangeState.selecting?(a.minDate&&ge>=a.minDate?i("pick",{minDate:a.minDate,maxDate:ge}):i("pick",{minDate:ge,maxDate:a.minDate}),i("select",!1)):(i("pick",{minDate:ge,maxDate:null}),i("select",!0));else if(a.selectionMode==="years"){if(q.type==="keydown"){i("pick",Ds(a.parsedValue),!1);return}const he=FS(ge.startOf("year"),x.value,a.disabledDate),ue=Ks(ie,"current")?Ds(a.parsedValue).filter(Re=>(Re==null?void 0:Re.year())!==pe):Ds(a.parsedValue).concat([he]);i("pick",ue)}else i("pick",pe)},Z=q=>{var X;if(!a.rangeState.selecting)return;const ie=(X=q.target)==null?void 0:X.closest("td");if(!ie)return;const de=ie.parentNode.rowIndex,le=ie.cellIndex;$.value[de][le].disabled||(de!==z.value||le!==N.value)&&(z.value=de,N.value=le,i("changerange",{selecting:!0,endDate:sr().year(k.value).add(de*4+le,"year")}))};return Wt(()=>a.date,async()=>{var q,X;(q=o.value)!=null&&q.contains(document.activeElement)&&(await Vn(),(X=C.value)==null||X.focus())}),t({focus:F}),(q,X)=>(se(),Ae("table",{role:"grid","aria-label":y(_)("el.datepicker.yearTablePrompt"),class:ce(y(m).b()),onClick:te,onMousemove:Z},[Ve("tbody",{ref_key:"tbodyRef",ref:o},[(se(!0),Ae(Bn,null,Fr(y($),(ie,de)=>(se(),Ae("tr",{key:de},[(se(!0),Ae(Bn,null,Fr(ie,(le,pe)=>(se(),Ae("td",{key:`${de}_${pe}`,ref_for:!0,ref:ge=>U(le)&&(C.value=ge),class:ce(["available",G(le)]),"aria-selected":U(le),"aria-label":String(le.text),tabindex:U(le)?0:-1,onKeydown:[Mo(Yn(te,["prevent","stop"]),["space"]),Mo(Yn(te,["prevent","stop"]),["enter"])]},[qe(y(jC),{cell:le},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var US=hn(See,[["__file","basic-year-table.vue"]]);const Tee=Ge({__name:"panel-date-pick",props:hee,emits:["pick","set-picker-option","panel-change"],setup(e,{emit:t}){const i=e,a=(Rt,_n,dt)=>!0,d=Jt("picker-panel"),m=Jt("date-picker"),_=Dh(),x=Ai(),{t:o,lang:C}=Gr(),k=kn("EP_PICKER_BASE"),A=kn(t1),{shortcuts:z,disabledDate:N,cellClassName:$,defaultTime:F}=k.props,G=fo(k.props,"defaultValue"),U=be(),te=be(sr().locale(C.value)),Z=be(!1);let q=!1;const X=Q(()=>sr(F).locale(C.value)),ie=Q(()=>te.value.month()),de=Q(()=>te.value.year()),le=be([]),pe=be(null),ge=be(null),he=Rt=>le.value.length>0?a(Rt,le.value,i.format||"HH:mm:ss"):!0,ue=Rt=>F&&!et.value&&!Z.value&&!q?X.value.year(Rt.year()).month(Rt.month()).date(Rt.date()):mt.value?Rt.millisecond(0):Rt.startOf("day"),Re=(Rt,..._n)=>{if(!Rt)t("pick",Rt,..._n);else if(on(Rt)){const dt=Rt.map(ue);t("pick",dt,..._n)}else t("pick",ue(Rt),..._n);pe.value=null,ge.value=null,Z.value=!1,q=!1},Ye=async(Rt,_n)=>{if(Ce.value==="date"){Rt=Rt;let dt=i.parsedValue?i.parsedValue.year(Rt.year()).month(Rt.month()).date(Rt.date()):Rt;he(dt)||(dt=le.value[0][0].year(Rt.year()).month(Rt.month()).date(Rt.date())),te.value=dt,Re(dt,mt.value||_n),i.type==="datetime"&&(await Vn(),ur())}else Ce.value==="week"?Re(Rt.date):Ce.value==="dates"&&Re(Rt,!0)},Ie=Rt=>{const _n=Rt?"add":"subtract";te.value=te.value[_n](1,"month"),Xr("month")},fe=Rt=>{const _n=te.value,dt=Rt?"add":"subtract";te.value=Me.value==="year"?_n[dt](10,"year"):_n[dt](1,"year"),Xr("year")},Me=be("date"),Se=Q(()=>{const Rt=o("el.datepicker.year");if(Me.value==="year"){const _n=Math.floor(de.value/10)*10;return Rt?`${_n} ${Rt} - ${_n+9} ${Rt}`:`${_n} - ${_n+9}`}return`${de.value} ${Rt}`}),ye=Rt=>{const _n=Fn(Rt.value)?Rt.value():Rt.value;if(_n){q=!0,Re(sr(_n).locale(C.value));return}Rt.onClick&&Rt.onClick({attrs:_,slots:x,emit:t})},Ce=Q(()=>{const{type:Rt}=i;return["week","month","months","year","years","dates"].includes(Rt)?Rt:"date"}),Fe=Q(()=>Ce.value==="dates"||Ce.value==="months"||Ce.value==="years"),it=Q(()=>Ce.value==="date"?Me.value:Ce.value),We=Q(()=>!!z.length),ut=async(Rt,_n)=>{Ce.value==="month"?(te.value=Fv(te.value.year(),Rt,C.value,N),Re(te.value,!1)):Ce.value==="months"?Re(Rt,_n??!0):(te.value=Fv(te.value.year(),Rt,C.value,N),Me.value="date",["month","year","date","week"].includes(Ce.value)&&(Re(te.value,!0),await Vn(),ur())),Xr("month")},Lt=async(Rt,_n)=>{if(Ce.value==="year"){const dt=te.value.startOf("year").year(Rt);te.value=FS(dt,C.value,N),Re(te.value,!1)}else if(Ce.value==="years")Re(Rt,_n??!0);else{const dt=te.value.year(Rt);te.value=FS(dt,C.value,N),Me.value="month",["month","year","date","week"].includes(Ce.value)&&(Re(te.value,!0),await Vn(),ur())}Xr("year")},Ft=async Rt=>{Me.value=Rt,await Vn(),ur()},mt=Q(()=>i.type==="datetime"||i.type==="datetimerange"),jt=Q(()=>{const Rt=mt.value||Ce.value==="dates",_n=Ce.value==="years",dt=Ce.value==="months",tn=Me.value==="date",Ze=Me.value==="year",gn=Me.value==="month";return Rt&&tn||_n&&Ze||dt&&gn}),Ht=Q(()=>N?i.parsedValue?on(i.parsedValue)?N(i.parsedValue[0].toDate()):N(i.parsedValue.toDate()):!0:!1),Tn=()=>{if(Fe.value)Re(i.parsedValue);else{let Rt=i.parsedValue;if(!Rt){const _n=sr(F).locale(C.value),dt=ir();Rt=_n.year(dt.year()).month(dt.month()).date(dt.date())}te.value=Rt,Re(Rt)}},Pe=Q(()=>N?N(sr().locale(C.value).toDate()):!1),At=()=>{const _n=sr().locale(C.value).toDate();Z.value=!0,(!N||!N(_n))&&he(_n)&&(te.value=sr().locale(C.value),Re(te.value))},He=Q(()=>i.timeFormat||X4(i.format)),pt=Q(()=>i.dateFormat||Y4(i.format)),et=Q(()=>{if(ge.value)return ge.value;if(!(!i.parsedValue&&!G.value))return(i.parsedValue||te.value).format(He.value)}),rn=Q(()=>{if(pe.value)return pe.value;if(!(!i.parsedValue&&!G.value))return(i.parsedValue||te.value).format(pt.value)}),kt=be(!1),zt=()=>{kt.value=!0},Mt=()=>{kt.value=!1},en=Rt=>({hour:Rt.hour(),minute:Rt.minute(),second:Rt.second(),year:Rt.year(),month:Rt.month(),date:Rt.date()}),sn=(Rt,_n,dt)=>{const{hour:tn,minute:Ze,second:gn}=en(Rt),rr=i.parsedValue?i.parsedValue.hour(tn).minute(Ze).second(gn):Rt;te.value=rr,Re(te.value,!0),dt||(kt.value=_n)},dn=Rt=>{const _n=sr(Rt,He.value).locale(C.value);if(_n.isValid()&&he(_n)){const{year:dt,month:tn,date:Ze}=en(te.value);te.value=_n.year(dt).month(tn).date(Ze),ge.value=null,kt.value=!1,Re(te.value,!0)}},Pn=Rt=>{const _n=sr(Rt,pt.value).locale(C.value);if(_n.isValid()){if(N&&N(_n.toDate()))return;const{hour:dt,minute:tn,second:Ze}=en(te.value);te.value=_n.hour(dt).minute(tn).second(Ze),pe.value=null,Re(te.value,!0)}},Ot=Rt=>sr.isDayjs(Rt)&&Rt.isValid()&&(N?!N(Rt.toDate()):!0),Zt=Rt=>on(Rt)?Rt.map(_n=>_n.format(i.format)):Rt.format(i.format),jn=Rt=>sr(Rt,i.format).locale(C.value),ir=()=>{const Rt=sr(G.value).locale(C.value);if(!G.value){const _n=X.value;return sr().hour(_n.hour()).minute(_n.minute()).second(_n.second()).locale(C.value)}return Rt},ur=async()=>{var Rt;["week","month","year","date"].includes(Ce.value)&&((Rt=U.value)==null||Rt.focus(),Ce.value==="week"&&wr(En.down))},ar=Rt=>{const{code:_n}=Rt;[En.up,En.down,En.left,En.right,En.home,En.end,En.pageUp,En.pageDown].includes(_n)&&(wr(_n),Rt.stopPropagation(),Rt.preventDefault()),[En.enter,En.space,En.numpadEnter].includes(_n)&&pe.value===null&&ge.value===null&&(Rt.preventDefault(),Re(te.value,!1))},wr=Rt=>{var _n;const{up:dt,down:tn,left:Ze,right:gn,home:rr,end:Hn,pageUp:eo,pageDown:Mi}=En,mo={year:{[dt]:-4,[tn]:4,[Ze]:-1,[gn]:1,offset:(Rr,fi)=>Rr.setFullYear(Rr.getFullYear()+fi)},month:{[dt]:-4,[tn]:4,[Ze]:-1,[gn]:1,offset:(Rr,fi)=>Rr.setMonth(Rr.getMonth()+fi)},week:{[dt]:-1,[tn]:1,[Ze]:-1,[gn]:1,offset:(Rr,fi)=>Rr.setDate(Rr.getDate()+fi*7)},date:{[dt]:-7,[tn]:7,[Ze]:-1,[gn]:1,[rr]:Rr=>-Rr.getDay(),[Hn]:Rr=>-Rr.getDay()+6,[eo]:Rr=>-new Date(Rr.getFullYear(),Rr.getMonth(),0).getDate(),[Mi]:Rr=>new Date(Rr.getFullYear(),Rr.getMonth()+1,0).getDate(),offset:(Rr,fi)=>Rr.setDate(Rr.getDate()+fi)}},bo=te.value.toDate();for(;Math.abs(te.value.diff(bo,"year",!0))<1;){const Rr=mo[it.value];if(!Rr)return;if(Rr.offset(bo,Fn(Rr[Rt])?Rr[Rt](bo):(_n=Rr[Rt])!=null?_n:0),N&&N(bo))break;const fi=sr(bo).locale(C.value);te.value=fi,t("pick",fi,!0);break}},Xr=Rt=>{t("panel-change",te.value.toDate(),Rt,Me.value)};return Wt(()=>Ce.value,Rt=>{if(["month","year"].includes(Rt)){Me.value=Rt;return}else if(Rt==="years"){Me.value="year";return}else if(Rt==="months"){Me.value="month";return}Me.value="date"},{immediate:!0}),Wt(()=>Me.value,()=>{A==null||A.updatePopper()}),Wt(()=>G.value,Rt=>{Rt&&(te.value=ir())},{immediate:!0}),Wt(()=>i.parsedValue,Rt=>{if(Rt){if(Fe.value||on(Rt))return;te.value=Rt}else te.value=ir()},{immediate:!0}),t("set-picker-option",["isValidValue",Ot]),t("set-picker-option",["formatToString",Zt]),t("set-picker-option",["parseUserInput",jn]),t("set-picker-option",["handleFocusPicker",ur]),(Rt,_n)=>(se(),Ae("div",{class:ce([y(d).b(),y(m).b(),{"has-sidebar":Rt.$slots.sidebar||y(We),"has-time":y(mt)}])},[Ve("div",{class:ce(y(d).e("body-wrapper"))},[_t(Rt.$slots,"sidebar",{class:ce(y(d).e("sidebar"))}),y(We)?(se(),Ae("div",{key:0,class:ce(y(d).e("sidebar"))},[(se(!0),Ae(Bn,null,Fr(y(z),(dt,tn)=>(se(),Ae("button",{key:tn,type:"button",class:ce(y(d).e("shortcut")),onClick:Ze=>ye(dt)},fn(dt.text),11,["onClick"]))),128))],2)):bt("v-if",!0),Ve("div",{class:ce(y(d).e("body"))},[y(mt)?(se(),Ae("div",{key:0,class:ce(y(m).e("time-header"))},[Ve("span",{class:ce(y(m).e("editor-wrap"))},[qe(y(vs),{placeholder:y(o)("el.datepicker.selectDate"),"model-value":y(rn),size:"small","validate-event":!1,onInput:dt=>pe.value=dt,onChange:Pn},null,8,["placeholder","model-value","onInput"])],2),mr((se(),Ae("span",{class:ce(y(m).e("editor-wrap"))},[qe(y(vs),{placeholder:y(o)("el.datepicker.selectTime"),"model-value":y(et),size:"small","validate-event":!1,onFocus:zt,onInput:dt=>ge.value=dt,onChange:dn},null,8,["placeholder","model-value","onInput"]),qe(y(ub),{visible:kt.value,format:y(He),"parsed-value":te.value,onPick:sn},null,8,["visible","format","parsed-value"])],2)),[[y(Rc),Mt]])],2)):bt("v-if",!0),mr(Ve("div",{class:ce([y(m).e("header"),(Me.value==="year"||Me.value==="month")&&y(m).e("header--bordered")])},[Ve("span",{class:ce(y(m).e("prev-btn"))},[Ve("button",{type:"button","aria-label":y(o)("el.datepicker.prevYear"),class:ce(["d-arrow-left",y(d).e("icon-btn")]),onClick:dt=>fe(!1)},[_t(Rt.$slots,"prev-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(rd))]),_:1})])],10,["aria-label","onClick"]),mr(Ve("button",{type:"button","aria-label":y(o)("el.datepicker.prevMonth"),class:ce([y(d).e("icon-btn"),"arrow-left"]),onClick:dt=>Ie(!1)},[_t(Rt.$slots,"prev-month",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(nd))]),_:1})])],10,["aria-label","onClick"]),[[no,Me.value==="date"]])],2),Ve("span",{role:"button",class:ce(y(m).e("header-label")),"aria-live":"polite",tabindex:"0",onKeydown:Mo(dt=>Ft("year"),["enter"]),onClick:dt=>Ft("year")},fn(y(Se)),43,["onKeydown","onClick"]),mr(Ve("span",{role:"button","aria-live":"polite",tabindex:"0",class:ce([y(m).e("header-label"),{active:Me.value==="month"}]),onKeydown:Mo(dt=>Ft("month"),["enter"]),onClick:dt=>Ft("month")},fn(y(o)(`el.datepicker.month${y(ie)+1}`)),43,["onKeydown","onClick"]),[[no,Me.value==="date"]]),Ve("span",{class:ce(y(m).e("next-btn"))},[mr(Ve("button",{type:"button","aria-label":y(o)("el.datepicker.nextMonth"),class:ce([y(d).e("icon-btn"),"arrow-right"]),onClick:dt=>Ie(!0)},[_t(Rt.$slots,"next-month",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(Os))]),_:1})])],10,["aria-label","onClick"]),[[no,Me.value==="date"]]),Ve("button",{type:"button","aria-label":y(o)("el.datepicker.nextYear"),class:ce([y(d).e("icon-btn"),"d-arrow-right"]),onClick:dt=>fe(!0)},[_t(Rt.$slots,"next-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(od))]),_:1})])],10,["aria-label","onClick"])],2)],2),[[no,Me.value!=="time"]]),Ve("div",{class:ce(y(d).e("content")),onKeydown:ar},[Me.value==="date"?(se(),It($S,{key:0,ref_key:"currentViewRef",ref:U,"selection-mode":y(Ce),date:te.value,"parsed-value":Rt.parsedValue,"disabled-date":y(N),"cell-class-name":y($),onPick:Ye},null,8,["selection-mode","date","parsed-value","disabled-date","cell-class-name"])):bt("v-if",!0),Me.value==="year"?(se(),It(US,{key:1,ref_key:"currentViewRef",ref:U,"selection-mode":y(Ce),date:te.value,"disabled-date":y(N),"parsed-value":Rt.parsedValue,onPick:Lt},null,8,["selection-mode","date","disabled-date","parsed-value"])):bt("v-if",!0),Me.value==="month"?(se(),It(VS,{key:2,ref_key:"currentViewRef",ref:U,"selection-mode":y(Ce),date:te.value,"parsed-value":Rt.parsedValue,"disabled-date":y(N),onPick:ut},null,8,["selection-mode","date","parsed-value","disabled-date"])):bt("v-if",!0)],34)],2)],2),mr(Ve("div",{class:ce(y(d).e("footer"))},[mr(qe(y(zi),{text:"",size:"small",class:ce(y(d).e("link-btn")),disabled:y(Pe),onClick:At},{default:st(()=>[$r(fn(y(o)("el.datepicker.now")),1)]),_:1},8,["class","disabled"]),[[no,!y(Fe)&&Rt.showNow]]),qe(y(zi),{plain:"",size:"small",class:ce(y(d).e("link-btn")),disabled:y(Ht),onClick:Tn},{default:st(()=>[$r(fn(y(o)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled"])],2),[[no,y(jt)]])],2))}});var Cee=hn(Tee,[["__file","panel-date-pick.vue"]]);const Eee=ln({...G2,...$C,visible:Boolean}),W2=e=>{const{emit:t}=Cr(),i=Dh(),a=Ai();return m=>{const _=Fn(m.value)?m.value():m.value;if(_){t("pick",[sr(_[0]).locale(e.value),sr(_[1]).locale(e.value)]);return}m.onClick&&m.onClick({attrs:i,slots:a,emit:t})}},q2=(e,{defaultValue:t,leftDate:i,rightDate:a,unit:d,onParsedValueChanged:m})=>{const{emit:_}=Cr(),{pickerNs:x}=kn(r1),o=Jt("date-range-picker"),{t:C,lang:k}=Gr(),A=W2(k),z=be(),N=be(),$=be({endDate:null,selecting:!1}),F=q=>{$.value=q},G=(q=!1)=>{const X=y(z),ie=y(N);$p([X,ie])&&_("pick",[X,ie],q)},U=q=>{$.value.selecting=q,q||($.value.endDate=null)},te=q=>{if(on(q)&&q.length===2){const[X,ie]=q;z.value=X,i.value=X,N.value=ie,m(y(z),y(N))}else Z()},Z=()=>{const[q,X]=UC(y(t),{lang:y(k),unit:d,unlinkPanels:e.unlinkPanels});z.value=void 0,N.value=void 0,i.value=q,a.value=X};return Wt(t,q=>{q&&Z()},{immediate:!0}),Wt(()=>e.parsedValue,te,{immediate:!0}),{minDate:z,maxDate:N,rangeState:$,lang:k,ppNs:x,drpNs:o,handleChangeRange:F,handleRangeConfirm:G,handleShortcutClick:A,onSelect:U,onReset:te,t:C}},b0="month",Mee=Ge({__name:"panel-date-range",props:Eee,emits:["pick","set-picker-option","calendar-change","panel-change"],setup(e,{emit:t}){const i=e,a=kn("EP_PICKER_BASE"),{disabledDate:d,cellClassName:m,defaultTime:_,clearable:x}=a.props,o=fo(a.props,"format"),C=fo(a.props,"shortcuts"),k=fo(a.props,"defaultValue"),{lang:A}=Gr(),z=be(sr().locale(A.value)),N=be(sr().locale(A.value).add(1,b0)),{minDate:$,maxDate:F,rangeState:G,ppNs:U,drpNs:te,handleChangeRange:Z,handleRangeConfirm:q,handleShortcutClick:X,onSelect:ie,onReset:de,t:le}=q2(i,{defaultValue:k,leftDate:z,rightDate:N,unit:b0,onParsedValueChanged:_n});Wt(()=>i.visible,dt=>{!dt&&G.value.selecting&&(de(i.parsedValue),ie(!1))});const pe=be({min:null,max:null}),ge=be({min:null,max:null}),he=Q(()=>`${z.value.year()} ${le("el.datepicker.year")} ${le(`el.datepicker.month${z.value.month()+1}`)}`),ue=Q(()=>`${N.value.year()} ${le("el.datepicker.year")} ${le(`el.datepicker.month${N.value.month()+1}`)}`),Re=Q(()=>z.value.year()),Ye=Q(()=>z.value.month()),Ie=Q(()=>N.value.year()),fe=Q(()=>N.value.month()),Me=Q(()=>!!C.value.length),Se=Q(()=>pe.value.min!==null?pe.value.min:$.value?$.value.format(We.value):""),ye=Q(()=>pe.value.max!==null?pe.value.max:F.value||$.value?(F.value||$.value).format(We.value):""),Ce=Q(()=>ge.value.min!==null?ge.value.min:$.value?$.value.format(it.value):""),Fe=Q(()=>ge.value.max!==null?ge.value.max:F.value||$.value?(F.value||$.value).format(it.value):""),it=Q(()=>i.timeFormat||X4(o.value)),We=Q(()=>i.dateFormat||Y4(o.value)),ut=dt=>$p(dt)&&(d?!d(dt[0].toDate())&&!d(dt[1].toDate()):!0),Lt=()=>{z.value=z.value.subtract(1,"year"),i.unlinkPanels||(N.value=z.value.add(1,"month")),He("year")},Ft=()=>{z.value=z.value.subtract(1,"month"),i.unlinkPanels||(N.value=z.value.add(1,"month")),He("month")},mt=()=>{i.unlinkPanels?N.value=N.value.add(1,"year"):(z.value=z.value.add(1,"year"),N.value=z.value.add(1,"month")),He("year")},jt=()=>{i.unlinkPanels?N.value=N.value.add(1,"month"):(z.value=z.value.add(1,"month"),N.value=z.value.add(1,"month")),He("month")},Ht=()=>{z.value=z.value.add(1,"year"),He("year")},Tn=()=>{z.value=z.value.add(1,"month"),He("month")},Pe=()=>{N.value=N.value.subtract(1,"year"),He("year")},At=()=>{N.value=N.value.subtract(1,"month"),He("month")},He=dt=>{t("panel-change",[z.value.toDate(),N.value.toDate()],dt)},pt=Q(()=>{const dt=(Ye.value+1)%12,tn=Ye.value+1>=12?1:0;return i.unlinkPanels&&new Date(Re.value+tn,dt)<new Date(Ie.value,fe.value)}),et=Q(()=>i.unlinkPanels&&Ie.value*12+fe.value-(Re.value*12+Ye.value+1)>=12),rn=Q(()=>!($.value&&F.value&&!G.value.selecting&&$p([$.value,F.value]))),kt=Q(()=>i.type==="datetime"||i.type==="datetimerange"),zt=(dt,tn)=>{if(dt)return _?sr(_[tn]||_).locale(A.value).year(dt.year()).month(dt.month()).date(dt.date()):dt},Mt=(dt,tn=!0)=>{const Ze=dt.minDate,gn=dt.maxDate,rr=zt(Ze,0),Hn=zt(gn,1);F.value===Hn&&$.value===rr||(t("calendar-change",[Ze.toDate(),gn&&gn.toDate()]),F.value=Hn,$.value=rr,!(!tn||kt.value)&&q())},en=be(!1),sn=be(!1),dn=()=>{en.value=!1},Pn=()=>{sn.value=!1},Ot=(dt,tn)=>{pe.value[tn]=dt;const Ze=sr(dt,We.value).locale(A.value);if(Ze.isValid()){if(d&&d(Ze.toDate()))return;tn==="min"?(z.value=Ze,$.value=($.value||z.value).year(Ze.year()).month(Ze.month()).date(Ze.date()),!i.unlinkPanels&&(!F.value||F.value.isBefore($.value))&&(N.value=Ze.add(1,"month"),F.value=$.value.add(1,"month"))):(N.value=Ze,F.value=(F.value||N.value).year(Ze.year()).month(Ze.month()).date(Ze.date()),!i.unlinkPanels&&(!$.value||$.value.isAfter(F.value))&&(z.value=Ze.subtract(1,"month"),$.value=F.value.subtract(1,"month")))}},Zt=(dt,tn)=>{pe.value[tn]=null},jn=(dt,tn)=>{ge.value[tn]=dt;const Ze=sr(dt,it.value).locale(A.value);Ze.isValid()&&(tn==="min"?(en.value=!0,$.value=($.value||z.value).hour(Ze.hour()).minute(Ze.minute()).second(Ze.second())):(sn.value=!0,F.value=(F.value||N.value).hour(Ze.hour()).minute(Ze.minute()).second(Ze.second()),N.value=F.value))},ir=(dt,tn)=>{ge.value[tn]=null,tn==="min"?(z.value=$.value,en.value=!1,(!F.value||F.value.isBefore($.value))&&(F.value=$.value)):(N.value=F.value,sn.value=!1,F.value&&F.value.isBefore($.value)&&($.value=F.value))},ur=(dt,tn,Ze)=>{ge.value.min||(dt&&(z.value=dt,$.value=($.value||z.value).hour(dt.hour()).minute(dt.minute()).second(dt.second())),Ze||(en.value=tn),(!F.value||F.value.isBefore($.value))&&(F.value=$.value,N.value=dt))},ar=(dt,tn,Ze)=>{ge.value.max||(dt&&(N.value=dt,F.value=(F.value||N.value).hour(dt.hour()).minute(dt.minute()).second(dt.second())),Ze||(sn.value=tn),F.value&&F.value.isBefore($.value)&&($.value=F.value))},wr=()=>{z.value=UC(y(k),{lang:y(A),unit:"month",unlinkPanels:i.unlinkPanels})[0],N.value=z.value.add(1,"month"),F.value=void 0,$.value=void 0,t("pick",null)},Xr=dt=>on(dt)?dt.map(tn=>tn.format(o.value)):dt.format(o.value),Rt=dt=>on(dt)?dt.map(tn=>sr(tn,o.value).locale(A.value)):sr(dt,o.value).locale(A.value);function _n(dt,tn){if(i.unlinkPanels&&tn){const Ze=(dt==null?void 0:dt.year())||0,gn=(dt==null?void 0:dt.month())||0,rr=tn.year(),Hn=tn.month();N.value=Ze===rr&&gn===Hn?tn.add(1,b0):tn}else N.value=z.value.add(1,b0),tn&&(N.value=N.value.hour(tn.hour()).minute(tn.minute()).second(tn.second()))}return t("set-picker-option",["isValidValue",ut]),t("set-picker-option",["parseUserInput",Rt]),t("set-picker-option",["formatToString",Xr]),t("set-picker-option",["handleClear",wr]),(dt,tn)=>(se(),Ae("div",{class:ce([y(U).b(),y(te).b(),{"has-sidebar":dt.$slots.sidebar||y(Me),"has-time":y(kt)}])},[Ve("div",{class:ce(y(U).e("body-wrapper"))},[_t(dt.$slots,"sidebar",{class:ce(y(U).e("sidebar"))}),y(Me)?(se(),Ae("div",{key:0,class:ce(y(U).e("sidebar"))},[(se(!0),Ae(Bn,null,Fr(y(C),(Ze,gn)=>(se(),Ae("button",{key:gn,type:"button",class:ce(y(U).e("shortcut")),onClick:rr=>y(X)(Ze)},fn(Ze.text),11,["onClick"]))),128))],2)):bt("v-if",!0),Ve("div",{class:ce(y(U).e("body"))},[y(kt)?(se(),Ae("div",{key:0,class:ce(y(te).e("time-header"))},[Ve("span",{class:ce(y(te).e("editors-wrap"))},[Ve("span",{class:ce(y(te).e("time-picker-wrap"))},[qe(y(vs),{size:"small",disabled:y(G).selecting,placeholder:y(le)("el.datepicker.startDate"),class:ce(y(te).e("editor")),"model-value":y(Se),"validate-event":!1,onInput:Ze=>Ot(Ze,"min"),onChange:Ze=>Zt(Ze,"min")},null,8,["disabled","placeholder","class","model-value","onInput","onChange"])],2),mr((se(),Ae("span",{class:ce(y(te).e("time-picker-wrap"))},[qe(y(vs),{size:"small",class:ce(y(te).e("editor")),disabled:y(G).selecting,placeholder:y(le)("el.datepicker.startTime"),"model-value":y(Ce),"validate-event":!1,onFocus:Ze=>en.value=!0,onInput:Ze=>jn(Ze,"min"),onChange:Ze=>ir(Ze,"min")},null,8,["class","disabled","placeholder","model-value","onFocus","onInput","onChange"]),qe(y(ub),{visible:en.value,format:y(it),"datetime-role":"start","parsed-value":z.value,onPick:ur},null,8,["visible","format","parsed-value"])],2)),[[y(Rc),dn]])],2),Ve("span",null,[qe(y(Dn),null,{default:st(()=>[qe(y(Os))]),_:1})]),Ve("span",{class:ce([y(te).e("editors-wrap"),"is-right"])},[Ve("span",{class:ce(y(te).e("time-picker-wrap"))},[qe(y(vs),{size:"small",class:ce(y(te).e("editor")),disabled:y(G).selecting,placeholder:y(le)("el.datepicker.endDate"),"model-value":y(ye),readonly:!y($),"validate-event":!1,onInput:Ze=>Ot(Ze,"max"),onChange:Ze=>Zt(Ze,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onInput","onChange"])],2),mr((se(),Ae("span",{class:ce(y(te).e("time-picker-wrap"))},[qe(y(vs),{size:"small",class:ce(y(te).e("editor")),disabled:y(G).selecting,placeholder:y(le)("el.datepicker.endTime"),"model-value":y(Fe),readonly:!y($),"validate-event":!1,onFocus:Ze=>y($)&&(sn.value=!0),onInput:Ze=>jn(Ze,"max"),onChange:Ze=>ir(Ze,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onFocus","onInput","onChange"]),qe(y(ub),{"datetime-role":"end",visible:sn.value,format:y(it),"parsed-value":N.value,onPick:ar},null,8,["visible","format","parsed-value"])],2)),[[y(Rc),Pn]])],2)],2)):bt("v-if",!0),Ve("div",{class:ce([[y(U).e("content"),y(te).e("content")],"is-left"])},[Ve("div",{class:ce(y(te).e("header"))},[Ve("button",{type:"button",class:ce([y(U).e("icon-btn"),"d-arrow-left"]),"aria-label":y(le)("el.datepicker.prevYear"),onClick:Lt},[_t(dt.$slots,"prev-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(rd))]),_:1})])],10,["aria-label"]),Ve("button",{type:"button",class:ce([y(U).e("icon-btn"),"arrow-left"]),"aria-label":y(le)("el.datepicker.prevMonth"),onClick:Ft},[_t(dt.$slots,"prev-month",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(nd))]),_:1})])],10,["aria-label"]),dt.unlinkPanels?(se(),Ae("button",{key:0,type:"button",disabled:!y(et),class:ce([[y(U).e("icon-btn"),{"is-disabled":!y(et)}],"d-arrow-right"]),"aria-label":y(le)("el.datepicker.nextYear"),onClick:Ht},[_t(dt.$slots,"next-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(od))]),_:1})])],10,["disabled","aria-label"])):bt("v-if",!0),dt.unlinkPanels?(se(),Ae("button",{key:1,type:"button",disabled:!y(pt),class:ce([[y(U).e("icon-btn"),{"is-disabled":!y(pt)}],"arrow-right"]),"aria-label":y(le)("el.datepicker.nextMonth"),onClick:Tn},[_t(dt.$slots,"next-month",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(Os))]),_:1})])],10,["disabled","aria-label"])):bt("v-if",!0),Ve("div",null,fn(y(he)),1)],2),qe($S,{"selection-mode":"range",date:z.value,"min-date":y($),"max-date":y(F),"range-state":y(G),"disabled-date":y(d),"cell-class-name":y(m),onChangerange:y(Z),onPick:Mt,onSelect:y(ie)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2),Ve("div",{class:ce([[y(U).e("content"),y(te).e("content")],"is-right"])},[Ve("div",{class:ce(y(te).e("header"))},[dt.unlinkPanels?(se(),Ae("button",{key:0,type:"button",disabled:!y(et),class:ce([[y(U).e("icon-btn"),{"is-disabled":!y(et)}],"d-arrow-left"]),"aria-label":y(le)("el.datepicker.prevYear"),onClick:Pe},[_t(dt.$slots,"prev-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(rd))]),_:1})])],10,["disabled","aria-label"])):bt("v-if",!0),dt.unlinkPanels?(se(),Ae("button",{key:1,type:"button",disabled:!y(pt),class:ce([[y(U).e("icon-btn"),{"is-disabled":!y(pt)}],"arrow-left"]),"aria-label":y(le)("el.datepicker.prevMonth"),onClick:At},[_t(dt.$slots,"prev-month",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(nd))]),_:1})])],10,["disabled","aria-label"])):bt("v-if",!0),Ve("button",{type:"button","aria-label":y(le)("el.datepicker.nextYear"),class:ce([y(U).e("icon-btn"),"d-arrow-right"]),onClick:mt},[_t(dt.$slots,"next-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(od))]),_:1})])],10,["aria-label"]),Ve("button",{type:"button",class:ce([y(U).e("icon-btn"),"arrow-right"]),"aria-label":y(le)("el.datepicker.nextMonth"),onClick:jt},[_t(dt.$slots,"next-month",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(Os))]),_:1})])],10,["aria-label"]),Ve("div",null,fn(y(ue)),1)],2),qe($S,{"selection-mode":"range",date:N.value,"min-date":y($),"max-date":y(F),"range-state":y(G),"disabled-date":y(d),"cell-class-name":y(m),onChangerange:y(Z),onPick:Mt,onSelect:y(ie)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2)],2)],2),y(kt)?(se(),Ae("div",{key:0,class:ce(y(U).e("footer"))},[y(x)?(se(),It(y(zi),{key:0,text:"",size:"small",class:ce(y(U).e("link-btn")),onClick:wr},{default:st(()=>[$r(fn(y(le)("el.datepicker.clear")),1)]),_:1},8,["class"])):bt("v-if",!0),qe(y(zi),{plain:"",size:"small",class:ce(y(U).e("link-btn")),disabled:y(rn),onClick:Ze=>y(q)(!1)},{default:st(()=>[$r(fn(y(le)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled","onClick"])],2)):bt("v-if",!0)],2))}});var Iee=hn(Mee,[["__file","panel-date-range.vue"]]);const kee=ln({...$C}),Aee=["pick","set-picker-option","calendar-change"],Pee=({unlinkPanels:e,leftDate:t,rightDate:i})=>{const{t:a}=Gr(),d=()=>{t.value=t.value.subtract(1,"year"),e.value||(i.value=i.value.subtract(1,"year"))},m=()=>{e.value||(t.value=t.value.add(1,"year")),i.value=i.value.add(1,"year")},_=()=>{t.value=t.value.add(1,"year")},x=()=>{i.value=i.value.subtract(1,"year")},o=Q(()=>`${t.value.year()} ${a("el.datepicker.year")}`),C=Q(()=>`${i.value.year()} ${a("el.datepicker.year")}`),k=Q(()=>t.value.year()),A=Q(()=>i.value.year()===t.value.year()?t.value.year()+1:i.value.year());return{leftPrevYear:d,rightNextYear:m,leftNextYear:_,rightPrevYear:x,leftLabel:o,rightLabel:C,leftYear:k,rightYear:A}},x0="year",Ree=Ge({name:"DatePickerMonthRange"}),Dee=Ge({...Ree,props:kee,emits:Aee,setup(e,{emit:t}){const i=e,{lang:a}=Gr(),d=kn("EP_PICKER_BASE"),{shortcuts:m,disabledDate:_}=d.props,x=fo(d.props,"format"),o=fo(d.props,"defaultValue"),C=be(sr().locale(a.value)),k=be(sr().locale(a.value).add(1,x0)),{minDate:A,maxDate:z,rangeState:N,ppNs:$,drpNs:F,handleChangeRange:G,handleRangeConfirm:U,handleShortcutClick:te,onSelect:Z}=q2(i,{defaultValue:o,leftDate:C,rightDate:k,unit:x0,onParsedValueChanged:Se}),q=Q(()=>!!m.length),{leftPrevYear:X,rightNextYear:ie,leftNextYear:de,rightPrevYear:le,leftLabel:pe,rightLabel:ge,leftYear:he,rightYear:ue}=Pee({unlinkPanels:fo(i,"unlinkPanels"),leftDate:C,rightDate:k}),Re=Q(()=>i.unlinkPanels&&ue.value>he.value+1),Ye=(ye,Ce=!0)=>{const Fe=ye.minDate,it=ye.maxDate;z.value===it&&A.value===Fe||(t("calendar-change",[Fe.toDate(),it&&it.toDate()]),z.value=it,A.value=Fe,Ce&&U())},Ie=()=>{C.value=UC(y(o),{lang:y(a),unit:"year",unlinkPanels:i.unlinkPanels})[0],k.value=C.value.add(1,"year"),t("pick",null)},fe=ye=>on(ye)?ye.map(Ce=>Ce.format(x.value)):ye.format(x.value),Me=ye=>on(ye)?ye.map(Ce=>sr(Ce,x.value).locale(a.value)):sr(ye,x.value).locale(a.value);function Se(ye,Ce){if(i.unlinkPanels&&Ce){const Fe=(ye==null?void 0:ye.year())||0,it=Ce.year();k.value=Fe===it?Ce.add(1,x0):Ce}else k.value=C.value.add(1,x0)}return t("set-picker-option",["isValidValue",$p]),t("set-picker-option",["formatToString",fe]),t("set-picker-option",["parseUserInput",Me]),t("set-picker-option",["handleClear",Ie]),(ye,Ce)=>(se(),Ae("div",{class:ce([y($).b(),y(F).b(),{"has-sidebar":!!ye.$slots.sidebar||y(q)}])},[Ve("div",{class:ce(y($).e("body-wrapper"))},[_t(ye.$slots,"sidebar",{class:ce(y($).e("sidebar"))}),y(q)?(se(),Ae("div",{key:0,class:ce(y($).e("sidebar"))},[(se(!0),Ae(Bn,null,Fr(y(m),(Fe,it)=>(se(),Ae("button",{key:it,type:"button",class:ce(y($).e("shortcut")),onClick:We=>y(te)(Fe)},fn(Fe.text),11,["onClick"]))),128))],2)):bt("v-if",!0),Ve("div",{class:ce(y($).e("body"))},[Ve("div",{class:ce([[y($).e("content"),y(F).e("content")],"is-left"])},[Ve("div",{class:ce(y(F).e("header"))},[Ve("button",{type:"button",class:ce([y($).e("icon-btn"),"d-arrow-left"]),onClick:y(X)},[_t(ye.$slots,"prev-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(rd))]),_:1})])],10,["onClick"]),ye.unlinkPanels?(se(),Ae("button",{key:0,type:"button",disabled:!y(Re),class:ce([[y($).e("icon-btn"),{[y($).is("disabled")]:!y(Re)}],"d-arrow-right"]),onClick:y(de)},[_t(ye.$slots,"next-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(od))]),_:1})])],10,["disabled","onClick"])):bt("v-if",!0),Ve("div",null,fn(y(pe)),1)],2),qe(VS,{"selection-mode":"range",date:C.value,"min-date":y(A),"max-date":y(z),"range-state":y(N),"disabled-date":y(_),onChangerange:y(G),onPick:Ye,onSelect:y(Z)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2),Ve("div",{class:ce([[y($).e("content"),y(F).e("content")],"is-right"])},[Ve("div",{class:ce(y(F).e("header"))},[ye.unlinkPanels?(se(),Ae("button",{key:0,type:"button",disabled:!y(Re),class:ce([[y($).e("icon-btn"),{"is-disabled":!y(Re)}],"d-arrow-left"]),onClick:y(le)},[_t(ye.$slots,"prev-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(rd))]),_:1})])],10,["disabled","onClick"])):bt("v-if",!0),Ve("button",{type:"button",class:ce([y($).e("icon-btn"),"d-arrow-right"]),onClick:y(ie)},[_t(ye.$slots,"next-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(od))]),_:1})])],10,["onClick"]),Ve("div",null,fn(y(ge)),1)],2),qe(VS,{"selection-mode":"range",date:k.value,"min-date":y(A),"max-date":y(z),"range-state":y(N),"disabled-date":y(_),onChangerange:y(G),onPick:Ye,onSelect:y(Z)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2)],2)],2)],2))}});var Lee=hn(Dee,[["__file","panel-month-range.vue"]]);const Oee=ln({...$C}),zee=["pick","set-picker-option","calendar-change"],Bee=({unlinkPanels:e,leftDate:t,rightDate:i})=>{const a=()=>{t.value=t.value.subtract(10,"year"),e.value||(i.value=i.value.subtract(10,"year"))},d=()=>{e.value||(t.value=t.value.add(10,"year")),i.value=i.value.add(10,"year")},m=()=>{t.value=t.value.add(10,"year")},_=()=>{i.value=i.value.subtract(10,"year")},x=Q(()=>{const A=Math.floor(t.value.year()/10)*10;return`${A}-${A+9}`}),o=Q(()=>{const A=Math.floor(i.value.year()/10)*10;return`${A}-${A+9}`}),C=Q(()=>Math.floor(t.value.year()/10)*10+9),k=Q(()=>Math.floor(i.value.year()/10)*10);return{leftPrevYear:a,rightNextYear:d,leftNextYear:m,rightPrevYear:_,leftLabel:x,rightLabel:o,leftYear:C,rightYear:k}},MR="year",Fee=Ge({name:"DatePickerYearRange"}),Nee=Ge({...Fee,props:Oee,emits:zee,setup(e,{emit:t}){const i=e,{lang:a}=Gr(),d=be(sr().locale(a.value)),m=be(d.value.add(10,"year")),{pickerNs:_}=kn(r1),x=Jt("date-range-picker"),o=Q(()=>!!Ye.length),C=Q(()=>[_.b(),x.b(),{"has-sidebar":!!Ai().sidebar||o.value}]),k=Q(()=>({content:[_.e("content"),x.e("content"),"is-left"],arrowLeftBtn:[_.e("icon-btn"),"d-arrow-left"],arrowRightBtn:[_.e("icon-btn"),{[_.is("disabled")]:!X.value},"d-arrow-right"]})),A=Q(()=>({content:[_.e("content"),x.e("content"),"is-right"],arrowLeftBtn:[_.e("icon-btn"),{"is-disabled":!X.value},"d-arrow-left"],arrowRightBtn:[_.e("icon-btn"),"d-arrow-right"]})),z=W2(a),{leftPrevYear:N,rightNextYear:$,leftNextYear:F,rightPrevYear:G,leftLabel:U,rightLabel:te,leftYear:Z,rightYear:q}=Bee({unlinkPanels:fo(i,"unlinkPanels"),leftDate:d,rightDate:m}),X=Q(()=>i.unlinkPanels&&q.value>Z.value+1),ie=be(),de=be(),le=be({endDate:null,selecting:!1}),pe=We=>{le.value=We},ge=(We,ut=!0)=>{const Lt=We.minDate,Ft=We.maxDate;de.value===Ft&&ie.value===Lt||(t("calendar-change",[Lt.toDate(),Ft&&Ft.toDate()]),de.value=Ft,ie.value=Lt,ut&&he())},he=(We=!1)=>{$p([ie.value,de.value])&&t("pick",[ie.value,de.value],We)},ue=We=>{le.value.selecting=We,We||(le.value.endDate=null)},Re=kn("EP_PICKER_BASE"),{shortcuts:Ye,disabledDate:Ie}=Re.props,fe=fo(Re.props,"format"),Me=fo(Re.props,"defaultValue"),Se=()=>{let We;if(on(Me.value)){const ut=sr(Me.value[0]);let Lt=sr(Me.value[1]);return i.unlinkPanels||(Lt=ut.add(10,MR)),[ut,Lt]}else Me.value?We=sr(Me.value):We=sr();return We=We.locale(a.value),[We,We.add(10,MR)]};Wt(()=>Me.value,We=>{if(We){const ut=Se();d.value=ut[0],m.value=ut[1]}},{immediate:!0}),Wt(()=>i.parsedValue,We=>{if(We&&We.length===2)if(ie.value=We[0],de.value=We[1],d.value=ie.value,i.unlinkPanels&&de.value){const ut=ie.value.year(),Lt=de.value.year();m.value=ut===Lt?de.value.add(10,"year"):de.value}else m.value=d.value.add(10,"year");else{const ut=Se();ie.value=void 0,de.value=void 0,d.value=ut[0],m.value=ut[1]}},{immediate:!0});const ye=We=>on(We)?We.map(ut=>sr(ut,fe.value).locale(a.value)):sr(We,fe.value).locale(a.value),Ce=We=>on(We)?We.map(ut=>ut.format(fe.value)):We.format(fe.value),Fe=We=>$p(We)&&(Ie?!Ie(We[0].toDate())&&!Ie(We[1].toDate()):!0),it=()=>{const We=Se();d.value=We[0],m.value=We[1],de.value=void 0,ie.value=void 0,t("pick",null)};return t("set-picker-option",["isValidValue",Fe]),t("set-picker-option",["parseUserInput",ye]),t("set-picker-option",["formatToString",Ce]),t("set-picker-option",["handleClear",it]),(We,ut)=>(se(),Ae("div",{class:ce(y(C))},[Ve("div",{class:ce(y(_).e("body-wrapper"))},[_t(We.$slots,"sidebar",{class:ce(y(_).e("sidebar"))}),y(o)?(se(),Ae("div",{key:0,class:ce(y(_).e("sidebar"))},[(se(!0),Ae(Bn,null,Fr(y(Ye),(Lt,Ft)=>(se(),Ae("button",{key:Ft,type:"button",class:ce(y(_).e("shortcut")),onClick:mt=>y(z)(Lt)},fn(Lt.text),11,["onClick"]))),128))],2)):bt("v-if",!0),Ve("div",{class:ce(y(_).e("body"))},[Ve("div",{class:ce(y(k).content)},[Ve("div",{class:ce(y(x).e("header"))},[Ve("button",{type:"button",class:ce(y(k).arrowLeftBtn),onClick:y(N)},[_t(We.$slots,"prev-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(rd))]),_:1})])],10,["onClick"]),We.unlinkPanels?(se(),Ae("button",{key:0,type:"button",disabled:!y(X),class:ce(y(k).arrowRightBtn),onClick:y(F)},[_t(We.$slots,"next-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(od))]),_:1})])],10,["disabled","onClick"])):bt("v-if",!0),Ve("div",null,fn(y(U)),1)],2),qe(US,{"selection-mode":"range",date:d.value,"min-date":ie.value,"max-date":de.value,"range-state":le.value,"disabled-date":y(Ie),onChangerange:pe,onPick:ge,onSelect:ue},null,8,["date","min-date","max-date","range-state","disabled-date"])],2),Ve("div",{class:ce(y(A).content)},[Ve("div",{class:ce(y(x).e("header"))},[We.unlinkPanels?(se(),Ae("button",{key:0,type:"button",disabled:!y(X),class:ce(y(A).arrowLeftBtn),onClick:y(G)},[_t(We.$slots,"prev-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(rd))]),_:1})])],10,["disabled","onClick"])):bt("v-if",!0),Ve("button",{type:"button",class:ce(y(A).arrowRightBtn),onClick:y($)},[_t(We.$slots,"next-year",{},()=>[qe(y(Dn),null,{default:st(()=>[qe(y(od))]),_:1})])],10,["onClick"]),Ve("div",null,fn(y(te)),1)],2),qe(US,{"selection-mode":"range",date:m.value,"min-date":ie.value,"max-date":de.value,"range-state":le.value,"disabled-date":y(Ie),onChangerange:pe,onPick:ge,onSelect:ue},null,8,["date","min-date","max-date","range-state","disabled-date"])],2)],2)],2)],2))}});var $ee=hn(Nee,[["__file","panel-year-range.vue"]]);const Vee=function(e){switch(e){case"daterange":case"datetimerange":return Iee;case"monthrange":return Lee;case"yearrange":return $ee;default:return Cee}};sr.extend(f2);sr.extend(QQ);sr.extend(zC);sr.extend(tee);sr.extend(ree);sr.extend(iee);sr.extend(aee);sr.extend(cee);var Uee=Ge({name:"ElDatePicker",install:null,props:uee,emits:["update:modelValue"],setup(e,{expose:t,emit:i,slots:a}){const d=Jt("picker-panel");Br("ElPopperOptions",ao(fo(e,"popperOptions"))),Br(r1,{slots:a,pickerNs:d});const m=be();t({focus:()=>{var o;(o=m.value)==null||o.focus()},blur:()=>{var o;(o=m.value)==null||o.blur()},handleOpen:()=>{var o;(o=m.value)==null||o.handleOpen()},handleClose:()=>{var o;(o=m.value)==null||o.handleClose()}});const x=o=>{i("update:modelValue",o)};return()=>{var o;const C=(o=e.format)!=null?o:bY[e.type]||cp,k=Vee(e.type);return qe(e2,kr(e,{format:C,type:e.type,ref:m,"onUpdate:modelValue":x}),{default:A=>qe(k,A,{"prev-month":a["prev-month"],"next-month":a["next-month"],"prev-year":a["prev-year"],"next-year":a["next-year"]}),"range-separator":a["range-separator"]})}}});const jee=cr(Uee),HC=Symbol("elDescriptions");var Xg=Ge({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:kn(HC,{})}},render(){var e;const t=xW(this.cell),i=(((e=this.cell)==null?void 0:e.dirs)||[]).map(U=>{const{dir:te,arg:Z,modifiers:q,value:X}=U;return[te,X,Z,q]}),{border:a,direction:d}=this.descriptions,m=d==="vertical",_=()=>{var U,te,Z;return((Z=(te=(U=this.cell)==null?void 0:U.children)==null?void 0:te.label)==null?void 0:Z.call(te))||t.label},x=()=>{var U,te,Z;return(Z=(te=(U=this.cell)==null?void 0:U.children)==null?void 0:te.default)==null?void 0:Z.call(te)},o=t.span,C=t.rowspan,k=t.align?`is-${t.align}`:"",A=t.labelAlign?`is-${t.labelAlign}`:k,z=t.className,N=t.labelClassName,$=this.type==="label"&&(t.labelWidth||this.descriptions.labelWidth)||t.width,F={width:li($),minWidth:li(t.minWidth)},G=Jt("descriptions");switch(this.type){case"label":return mr(Kn(this.tag,{style:F,class:[G.e("cell"),G.e("label"),G.is("bordered-label",a),G.is("vertical-label",m),A,N],colSpan:m?o:1,rowspan:m?1:C},_()),i);case"content":return mr(Kn(this.tag,{style:F,class:[G.e("cell"),G.e("content"),G.is("bordered-content",a),G.is("vertical-content",m),k,z],colSpan:m?o:o*2-1,rowspan:m?C*2-1:C},x()),i);default:{const U=_();return mr(Kn("td",{style:F,class:[G.e("cell"),k],colSpan:o,rowspan:C},[ki(U)?void 0:Kn("span",{class:[G.e("label"),N]},U),Kn("span",{class:[G.e("content"),z]},x())]),i)}}}});const Hee=ln({row:{type:at(Array),default:()=>[]}}),Gee=Ge({name:"ElDescriptionsRow"}),Wee=Ge({...Gee,props:Hee,setup(e){const t=kn(HC,{});return(i,a)=>y(t).direction==="vertical"?(se(),Ae(Bn,{key:0},[Ve("tr",null,[(se(!0),Ae(Bn,null,Fr(i.row,(d,m)=>(se(),It(y(Xg),{key:`tr1-${m}`,cell:d,tag:"th",type:"label"},null,8,["cell"]))),128))]),Ve("tr",null,[(se(!0),Ae(Bn,null,Fr(i.row,(d,m)=>(se(),It(y(Xg),{key:`tr2-${m}`,cell:d,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(se(),Ae("tr",{key:1},[(se(!0),Ae(Bn,null,Fr(i.row,(d,m)=>(se(),Ae(Bn,{key:`tr3-${m}`},[y(t).border?(se(),Ae(Bn,{key:0},[qe(y(Xg),{cell:d,tag:"td",type:"label"},null,8,["cell"]),qe(y(Xg),{cell:d,tag:"td",type:"content"},null,8,["cell"])],64)):(se(),It(y(Xg),{key:1,cell:d,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var qee=hn(Wee,[["__file","descriptions-row.vue"]]);const Kee=ln({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:Ei,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),Zee=Ge({name:"ElDescriptions"}),Yee=Ge({...Zee,props:Kee,setup(e){const t=e,i=Jt("descriptions"),a=xi(),d=Ai();Br(HC,t);const m=Q(()=>[i.b(),i.m(a.value)]),_=(o,C,k,A=!1)=>(o.props||(o.props={}),C>k&&(o.props.span=k),A&&(o.props.span=C),o),x=()=>{if(!d.default)return[];const o=qu(d.default()).filter($=>{var F;return((F=$==null?void 0:$.type)==null?void 0:F.name)==="ElDescriptionsItem"}),C=[];let k=[],A=t.column,z=0;const N=[];return o.forEach(($,F)=>{var G,U,te;const Z=((G=$.props)==null?void 0:G.span)||1,q=((U=$.props)==null?void 0:U.rowspan)||1,X=C.length;if(N[X]||(N[X]=0),q>1)for(let ie=1;ie<q;ie++)N[te=X+ie]||(N[te]=0),N[X+ie]++,z++;if(N[X]>0&&(A-=N[X],N[X]=0),F<o.length-1&&(z+=Z>A?A:Z),F===o.length-1){const ie=t.column-z%t.column;k.push(_($,ie,A,!0)),C.push(k);return}Z<A?(A-=Z,k.push($)):(k.push(_($,Z,A)),C.push(k),A=t.column,k=[])}),C};return(o,C)=>(se(),Ae("div",{class:ce(y(m))},[o.title||o.extra||o.$slots.title||o.$slots.extra?(se(),Ae("div",{key:0,class:ce(y(i).e("header"))},[Ve("div",{class:ce(y(i).e("title"))},[_t(o.$slots,"title",{},()=>[$r(fn(o.title),1)])],2),Ve("div",{class:ce(y(i).e("extra"))},[_t(o.$slots,"extra",{},()=>[$r(fn(o.extra),1)])],2)],2)):bt("v-if",!0),Ve("div",{class:ce(y(i).e("body"))},[Ve("table",{class:ce([y(i).e("table"),y(i).is("bordered",o.border)])},[Ve("tbody",null,[(se(!0),Ae(Bn,null,Fr(x(),(k,A)=>(se(),It(qee,{key:A,row:k},null,8,["row"]))),128))])],2)],2)],2))}});var Xee=hn(Yee,[["__file","description.vue"]]);const Jee=ln({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),K2=Ge({name:"ElDescriptionsItem",props:Jee}),Qee=cr(Xee,{DescriptionsItem:K2}),ete=Jo(K2),tte=ln({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:at([String,Array,Object])},zIndex:{type:at([String,Number])}}),nte={click:e=>e instanceof MouseEvent},rte="overlay";var ote=Ge({name:"ElOverlay",props:tte,emits:nte,setup(e,{slots:t,emit:i}){const a=Jt(rte),d=o=>{i("click",o)},{onClick:m,onMousedown:_,onMouseup:x}=yC(e.customMaskEvent?void 0:d);return()=>e.mask?qe("div",{class:[a.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:m,onMousedown:_,onMouseup:x},[_t(t,"default")],Da.STYLE|Da.CLASS|Da.PROPS,["onClick","onMouseup","onMousedown"]):Kn("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[_t(t,"default")])}});const GC=ote,Z2=Symbol("dialogInjectionKey"),Y2=ln({center:Boolean,alignCenter:Boolean,closeIcon:{type:wo},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),ite={close:()=>!0},ste=Ge({name:"ElDialogContent"}),ate=Ge({...ste,props:Y2,emits:ite,setup(e,{expose:t}){const i=e,{t:a}=Gr(),{Close:d}=sC,{dialogRef:m,headerRef:_,bodyId:x,ns:o,style:C}=kn(Z2),{focusTrapRef:k}=kn(DC),A=Q(()=>[o.b(),o.is("fullscreen",i.fullscreen),o.is("draggable",i.draggable),o.is("align-center",i.alignCenter),{[o.m("center")]:i.center}]),z=Hb(k,m),N=Q(()=>i.draggable),$=Q(()=>i.overflow),{resetPosition:F}=HO(m,_,N,$);return t({resetPosition:F}),(G,U)=>(se(),Ae("div",{ref:y(z),class:ce(y(A)),style:Nn(y(C)),tabindex:"-1"},[Ve("header",{ref_key:"headerRef",ref:_,class:ce([y(o).e("header"),{"show-close":G.showClose}])},[_t(G.$slots,"header",{},()=>[Ve("span",{role:"heading","aria-level":G.ariaLevel,class:ce(y(o).e("title"))},fn(G.title),11,["aria-level"])]),G.showClose?(se(),Ae("button",{key:0,"aria-label":y(a)("el.dialog.close"),class:ce(y(o).e("headerbtn")),type:"button",onClick:te=>G.$emit("close")},[qe(y(Dn),{class:ce(y(o).e("close"))},{default:st(()=>[(se(),It(Ir(G.closeIcon||y(d))))]),_:1},8,["class"])],10,["aria-label","onClick"])):bt("v-if",!0)],2),Ve("div",{id:y(x),class:ce(y(o).e("body"))},[_t(G.$slots,"default")],10,["id"]),G.$slots.footer?(se(),Ae("footer",{key:0,class:ce(y(o).e("footer"))},[_t(G.$slots,"footer")],2)):bt("v-if",!0)],6))}});var lte=hn(ate,[["__file","dialog-content.vue"]]);const X2=ln({...Y2,appendToBody:Boolean,appendTo:{type:at([String,Object]),default:"body"},beforeClose:{type:at(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),J2={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[xr]:e=>ko(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},Q2=(e,t)=>{var i;const d=Cr().emit,{nextZIndex:m}=Jp();let _="";const x=Wi(),o=Wi(),C=be(!1),k=be(!1),A=be(!1),z=be((i=e.zIndex)!=null?i:m());let N,$;const F=Jb("namespace",dv),G=Q(()=>{const Ie={},fe=`--${F.value}-dialog`;return e.fullscreen||(e.top&&(Ie[`${fe}-margin-top`]=e.top),e.width&&(Ie[`${fe}-width`]=li(e.width))),Ie}),U=Q(()=>e.alignCenter?{display:"flex"}:{});function te(){d("opened")}function Z(){d("closed"),d(xr,!1),e.destroyOnClose&&(A.value=!1)}function q(){d("close")}function X(){$==null||$(),N==null||N(),e.openDelay&&e.openDelay>0?{stop:N}=Th(()=>pe(),e.openDelay):pe()}function ie(){N==null||N(),$==null||$(),e.closeDelay&&e.closeDelay>0?{stop:$}=Th(()=>ge(),e.closeDelay):ge()}function de(){function Ie(fe){fe||(k.value=!0,C.value=!1)}e.beforeClose?e.beforeClose(Ie):ie()}function le(){e.closeOnClickModal&&de()}function pe(){Hr&&(C.value=!0)}function ge(){C.value=!1}function he(){d("openAutoFocus")}function ue(){d("closeAutoFocus")}function Re(Ie){var fe;((fe=Ie.detail)==null?void 0:fe.focusReason)==="pointer"&&Ie.preventDefault()}e.lockScroll&&uC(C);function Ye(){e.closeOnPressEscape&&de()}return Wt(()=>e.modelValue,Ie=>{Ie?(k.value=!1,X(),A.value=!0,z.value=PO(e.zIndex)?m():z.value++,Vn(()=>{d("open"),t.value&&(t.value.scrollTop=0)})):C.value&&ie()}),Wt(()=>e.fullscreen,Ie=>{t.value&&(Ie?(_=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=_)}),vr(()=>{e.modelValue&&(C.value=!0,A.value=!0,X())}),{afterEnter:te,afterLeave:Z,beforeLeave:q,handleClose:de,onModalClick:le,close:ie,doClose:ge,onOpenAutoFocus:he,onCloseAutoFocus:ue,onCloseRequested:Ye,onFocusoutPrevented:Re,titleId:x,bodyId:o,closed:k,style:G,overlayDialogStyle:U,rendered:A,visible:C,zIndex:z}},cte=Ge({name:"ElDialog",inheritAttrs:!1}),ute=Ge({...cte,props:X2,emits:J2,setup(e,{expose:t}){const i=e,a=Ai();Ku({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},Q(()=>!!a.title));const d=Jt("dialog"),m=be(),_=be(),x=be(),{visible:o,titleId:C,bodyId:k,style:A,overlayDialogStyle:z,rendered:N,zIndex:$,afterEnter:F,afterLeave:G,beforeLeave:U,handleClose:te,onModalClick:Z,onOpenAutoFocus:q,onCloseAutoFocus:X,onCloseRequested:ie,onFocusoutPrevented:de}=Q2(i,m);Br(Z2,{dialogRef:m,headerRef:_,bodyId:k,ns:d,rendered:N,style:A});const le=yC(Z),pe=Q(()=>i.draggable&&!i.fullscreen);return t({visible:o,dialogContentRef:x,resetPosition:()=>{var he;(he=x.value)==null||he.resetPosition()}}),(he,ue)=>(se(),It(y(tm),{to:he.appendTo,disabled:he.appendTo!=="body"?!1:!he.appendToBody},{default:st(()=>[qe(Fi,{name:"dialog-fade",onAfterEnter:y(F),onAfterLeave:y(G),onBeforeLeave:y(U),persisted:""},{default:st(()=>[mr(qe(y(GC),{"custom-mask-event":"",mask:he.modal,"overlay-class":he.modalClass,"z-index":y($)},{default:st(()=>[Ve("div",{role:"dialog","aria-modal":"true","aria-label":he.title||void 0,"aria-labelledby":he.title?void 0:y(C),"aria-describedby":y(k),class:ce(`${y(d).namespace.value}-overlay-dialog`),style:Nn(y(z)),onClick:y(le).onClick,onMousedown:y(le).onMousedown,onMouseup:y(le).onMouseup},[qe(y(c_),{loop:"",trapped:y(o),"focus-start-el":"container",onFocusAfterTrapped:y(q),onFocusAfterReleased:y(X),onFocusoutPrevented:y(de),onReleaseRequested:y(ie)},{default:st(()=>[y(N)?(se(),It(lte,kr({key:0,ref_key:"dialogContentRef",ref:x},he.$attrs,{center:he.center,"align-center":he.alignCenter,"close-icon":he.closeIcon,draggable:y(pe),overflow:he.overflow,fullscreen:he.fullscreen,"show-close":he.showClose,title:he.title,"aria-level":he.headerAriaLevel,onClose:y(te)}),$a({header:st(()=>[he.$slots.title?_t(he.$slots,"title",{key:1}):_t(he.$slots,"header",{key:0,close:y(te),titleId:y(C),titleClass:y(d).e("title")})]),default:st(()=>[_t(he.$slots,"default")]),_:2},[he.$slots.footer?{name:"footer",fn:st(()=>[_t(he.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","show-close","title","aria-level","onClose"])):bt("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[no,y(o)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var dte=hn(ute,[["__file","dialog.vue"]]);const hte=cr(dte),fte=ln({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:at(String),default:"solid"}}),pte=Ge({name:"ElDivider"}),mte=Ge({...pte,props:fte,setup(e){const t=e,i=Jt("divider"),a=Q(()=>i.cssVar({"border-style":t.borderStyle}));return(d,m)=>(se(),Ae("div",{class:ce([y(i).b(),y(i).m(d.direction)]),style:Nn(y(a)),role:"separator"},[d.$slots.default&&d.direction!=="vertical"?(se(),Ae("div",{key:0,class:ce([y(i).e("text"),y(i).is(d.contentPosition)])},[_t(d.$slots,"default")],2)):bt("v-if",!0)],6))}});var gte=hn(mte,[["__file","divider.vue"]]);const ez=cr(gte),vte=ln({...X2,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),_te=J2,yte=Ge({name:"ElDrawer",inheritAttrs:!1}),bte=Ge({...yte,props:vte,emits:_te,setup(e,{expose:t}){const i=e,a=Ai();Ku({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},Q(()=>!!a.title));const d=be(),m=be(),_=Jt("drawer"),{t:x}=Gr(),{afterEnter:o,afterLeave:C,beforeLeave:k,visible:A,rendered:z,titleId:N,bodyId:$,zIndex:F,onModalClick:G,onOpenAutoFocus:U,onCloseAutoFocus:te,onFocusoutPrevented:Z,onCloseRequested:q,handleClose:X}=Q2(i,d),ie=Q(()=>i.direction==="rtl"||i.direction==="ltr"),de=Q(()=>li(i.size));return t({handleClose:X,afterEnter:o,afterLeave:C}),(le,pe)=>(se(),It(y(tm),{to:le.appendTo,disabled:le.appendTo!=="body"?!1:!le.appendToBody},{default:st(()=>[qe(Fi,{name:y(_).b("fade"),onAfterEnter:y(o),onAfterLeave:y(C),onBeforeLeave:y(k),persisted:""},{default:st(()=>[mr(qe(y(GC),{mask:le.modal,"overlay-class":le.modalClass,"z-index":y(F),onClick:y(G)},{default:st(()=>[qe(y(c_),{loop:"",trapped:y(A),"focus-trap-el":d.value,"focus-start-el":m.value,onFocusAfterTrapped:y(U),onFocusAfterReleased:y(te),onFocusoutPrevented:y(Z),onReleaseRequested:y(q)},{default:st(()=>[Ve("div",kr({ref_key:"drawerRef",ref:d,"aria-modal":"true","aria-label":le.title||void 0,"aria-labelledby":le.title?void 0:y(N),"aria-describedby":y($)},le.$attrs,{class:[y(_).b(),le.direction,y(A)&&"open"],style:y(ie)?"width: "+y(de):"height: "+y(de),role:"dialog",onClick:Yn(()=>{},["stop"])}),[Ve("span",{ref_key:"focusStartRef",ref:m,class:ce(y(_).e("sr-focus")),tabindex:"-1"},null,2),le.withHeader?(se(),Ae("header",{key:0,class:ce(y(_).e("header"))},[le.$slots.title?_t(le.$slots,"title",{key:1},()=>[bt(" DEPRECATED SLOT ")]):_t(le.$slots,"header",{key:0,close:y(X),titleId:y(N),titleClass:y(_).e("title")},()=>[le.$slots.title?bt("v-if",!0):(se(),Ae("span",{key:0,id:y(N),role:"heading","aria-level":le.headerAriaLevel,class:ce(y(_).e("title"))},fn(le.title),11,["id","aria-level"]))]),le.showClose?(se(),Ae("button",{key:2,"aria-label":y(x)("el.drawer.close"),class:ce(y(_).e("close-btn")),type:"button",onClick:y(X)},[qe(y(Dn),{class:ce(y(_).e("close"))},{default:st(()=>[qe(y(vl))]),_:1},8,["class"])],10,["aria-label","onClick"])):bt("v-if",!0)],2)):bt("v-if",!0),y(z)?(se(),Ae("div",{key:1,id:y($),class:ce(y(_).e("body"))},[_t(le.$slots,"default")],10,["id"])):bt("v-if",!0),le.$slots.footer?(se(),Ae("div",{key:2,class:ce(y(_).e("footer"))},[_t(le.$slots,"footer")],2)):bt("v-if",!0)],16,["aria-label","aria-labelledby","aria-describedby","onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[no,y(A)]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var xte=hn(bte,[["__file","drawer.vue"]]);const wte=cr(xte),Ste=Ge({inheritAttrs:!1});function Tte(e,t,i,a,d,m){return _t(e.$slots,"default")}var Cte=hn(Ste,[["render",Tte],["__file","collection.vue"]]);const Ete=Ge({name:"ElCollectionItem",inheritAttrs:!1});function Mte(e,t,i,a,d,m){return _t(e.$slots,"default")}var Ite=hn(Ete,[["render",Mte],["__file","collection-item.vue"]]);const tz="data-el-collection-item",nz=e=>{const t=`El${e}Collection`,i=`${t}Item`,a=Symbol(t),d=Symbol(i),m={...Cte,name:t,setup(){const x=be(null),o=new Map;Br(a,{itemMap:o,getItems:()=>{const k=y(x);if(!k)return[];const A=Array.from(k.querySelectorAll(`[${tz}]`));return[...o.values()].sort((N,$)=>A.indexOf(N.ref)-A.indexOf($.ref))},collectionRef:x})}},_={...Ite,name:i,setup(x,{attrs:o}){const C=be(null),k=kn(a,void 0);Br(d,{collectionItemRef:C}),vr(()=>{const A=y(C);A&&k.itemMap.set(A,{ref:A,...o})}),Io(()=>{const A=y(C);k.itemMap.delete(A)})}};return{COLLECTION_INJECTION_KEY:a,COLLECTION_ITEM_INJECTION_KEY:d,ElCollection:m,ElCollectionItem:_}},kte=ln({style:{type:at([String,Array,Object])},currentTabId:{type:at(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:at(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:Ate,ElCollectionItem:Pte,COLLECTION_INJECTION_KEY:WC,COLLECTION_ITEM_INJECTION_KEY:Rte}=nz("RovingFocusGroup"),qC=Symbol("elRovingFocusGroup"),rz=Symbol("elRovingFocusGroupItem"),Dte={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},Lte=(e,t)=>e,Ote=(e,t,i)=>{const a=Lte(e.code);return Dte[a]},zte=(e,t)=>e.map((i,a)=>e[(a+t)%e.length]),KC=e=>{const{activeElement:t}=document;for(const i of e)if(i===t||(i.focus(),t!==document.activeElement))return},IR="currentTabIdChange",kR="rovingFocusGroup.entryFocus",Bte={bubbles:!1,cancelable:!0},Fte=Ge({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:kte,emits:[IR,"entryFocus"],setup(e,{emit:t}){var i;const a=be((i=e.currentTabId||e.defaultCurrentTabId)!=null?i:null),d=be(!1),m=be(!1),_=be(null),{getItems:x}=kn(WC,void 0),o=Q(()=>[{outline:"none"},e.style]),C=F=>{t(IR,F)},k=()=>{d.value=!0},A=ai(F=>{var G;(G=e.onMousedown)==null||G.call(e,F)},()=>{m.value=!0}),z=ai(F=>{var G;(G=e.onFocus)==null||G.call(e,F)},F=>{const G=!y(m),{target:U,currentTarget:te}=F;if(U===te&&G&&!y(d)){const Z=new Event(kR,Bte);if(te==null||te.dispatchEvent(Z),!Z.defaultPrevented){const q=x().filter(pe=>pe.focusable),X=q.find(pe=>pe.active),ie=q.find(pe=>pe.id===y(a)),le=[X,ie,...q].filter(Boolean).map(pe=>pe.ref);KC(le)}}m.value=!1}),N=ai(F=>{var G;(G=e.onBlur)==null||G.call(e,F)},()=>{d.value=!1}),$=(...F)=>{t("entryFocus",...F)};Br(qC,{currentTabbedId:Wp(a),loop:fo(e,"loop"),tabIndex:Q(()=>y(d)?-1:0),rovingFocusGroupRef:_,rovingFocusGroupRootStyle:o,orientation:fo(e,"orientation"),dir:fo(e,"dir"),onItemFocus:C,onItemShiftTab:k,onBlur:N,onFocus:z,onMousedown:A}),Wt(()=>e.currentTabId,F=>{a.value=F??null}),yo(_,kR,$)}});function Nte(e,t,i,a,d,m){return _t(e.$slots,"default")}var $te=hn(Fte,[["render",Nte],["__file","roving-focus-group-impl.vue"]]);const Vte=Ge({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:Ate,ElRovingFocusGroupImpl:$te}});function Ute(e,t,i,a,d,m){const _=Er("el-roving-focus-group-impl"),x=Er("el-focus-group-collection");return se(),It(x,null,{default:st(()=>[qe(_,ul(Xu(e.$attrs)),{default:st(()=>[_t(e.$slots,"default")]),_:3},16)]),_:3})}var jte=hn(Vte,[["render",Ute],["__file","roving-focus-group.vue"]]);const Hte=Ge({components:{ElRovingFocusCollectionItem:Pte},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(e,{emit:t}){const{currentTabbedId:i,loop:a,onItemFocus:d,onItemShiftTab:m}=kn(qC,void 0),{getItems:_}=kn(WC,void 0),x=Wi(),o=be(null),C=ai(N=>{t("mousedown",N)},N=>{e.focusable?d(y(x)):N.preventDefault()}),k=ai(N=>{t("focus",N)},()=>{d(y(x))}),A=ai(N=>{t("keydown",N)},N=>{const{code:$,shiftKey:F,target:G,currentTarget:U}=N;if($===En.tab&&F){m();return}if(G!==U)return;const te=Ote(N);if(te){N.preventDefault();let q=_().filter(X=>X.focusable).map(X=>X.ref);switch(te){case"last":{q.reverse();break}case"prev":case"next":{te==="prev"&&q.reverse();const X=q.indexOf(U);q=a.value?zte(q,X+1):q.slice(X+1);break}}Vn(()=>{KC(q)})}}),z=Q(()=>i.value===y(x));return Br(rz,{rovingFocusGroupItemRef:o,tabIndex:Q(()=>y(z)?0:-1),handleMousedown:C,handleFocus:k,handleKeydown:A}),{id:x,handleKeydown:A,handleFocus:k,handleMousedown:C}}});function Gte(e,t,i,a,d,m){const _=Er("el-roving-focus-collection-item");return se(),It(_,{id:e.id,focusable:e.focusable,active:e.active},{default:st(()=>[_t(e.$slots,"default")]),_:3},8,["id","focusable","active"])}var Wte=hn(Hte,[["render",Gte],["__file","roving-focus-item.vue"]]);const B0=ln({trigger:Ov.trigger,effect:{...Li.effect,default:"light"},type:{type:at(String)},placement:{type:at(String),default:"bottom"},popperOptions:{type:at(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:at([Number,String]),default:0},maxHeight:{type:at([Number,String]),default:""},popperClass:{type:String,default:""},disabled:Boolean,role:{type:String,default:"menu"},buttonProps:{type:at(Object)},teleported:Li.teleported}),oz=ln({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:wo}}),qte=ln({onKeydown:{type:at(Function)}}),Kte=[En.down,En.pageDown,En.home],iz=[En.up,En.pageUp,En.end],Zte=[...Kte,...iz],{ElCollection:Yte,ElCollectionItem:Xte,COLLECTION_INJECTION_KEY:Jte,COLLECTION_ITEM_INJECTION_KEY:Qte}=nz("Dropdown"),o1=Symbol("elDropdown"),{ButtonGroup:ene}=zi,tne=Ge({name:"ElDropdown",components:{ElButton:zi,ElButtonGroup:ene,ElScrollbar:rc,ElDropdownCollection:Yte,ElTooltip:os,ElRovingFocusGroup:jte,ElOnlyChild:R4,ElIcon:Dn,ArrowDown:Bc},props:B0,emits:["visible-change","click","command"],setup(e,{emit:t}){const i=Cr(),a=Jt("dropdown"),{t:d}=Gr(),m=be(),_=be(),x=be(null),o=be(null),C=be(null),k=be(null),A=be(!1),z=[En.enter,En.numpadEnter,En.space,En.down],N=Q(()=>({maxHeight:li(e.maxHeight)})),$=Q(()=>[a.m(X.value)]),F=Q(()=>ms(e.trigger)),G=Wi().value,U=Q(()=>e.id||G);Wt([m,F],([Me,Se],[ye])=>{var Ce,Fe,it;(Ce=ye==null?void 0:ye.$el)!=null&&Ce.removeEventListener&&ye.$el.removeEventListener("pointerenter",de),(Fe=Me==null?void 0:Me.$el)!=null&&Fe.removeEventListener&&Me.$el.removeEventListener("pointerenter",de),(it=Me==null?void 0:Me.$el)!=null&&it.addEventListener&&Se.includes("hover")&&Me.$el.addEventListener("pointerenter",de)},{immediate:!0}),Io(()=>{var Me,Se;(Se=(Me=m.value)==null?void 0:Me.$el)!=null&&Se.removeEventListener&&m.value.$el.removeEventListener("pointerenter",de)});function te(){Z()}function Z(){var Me;(Me=x.value)==null||Me.onClose()}function q(){var Me;(Me=x.value)==null||Me.onOpen()}const X=xi();function ie(...Me){t("command",...Me)}function de(){var Me,Se;(Se=(Me=m.value)==null?void 0:Me.$el)==null||Se.focus()}function le(){}function pe(){const Me=y(o);F.value.includes("hover")&&(Me==null||Me.focus()),k.value=null}function ge(Me){k.value=Me}function he(Me){A.value||(Me.preventDefault(),Me.stopImmediatePropagation())}function ue(){t("visible-change",!0)}function Re(Me){(Me==null?void 0:Me.type)==="keydown"&&o.value.focus()}function Ye(){t("visible-change",!1)}return Br(o1,{contentRef:o,role:Q(()=>e.role),triggerId:U,isUsingKeyboard:A,onItemEnter:le,onItemLeave:pe}),Br("elDropdown",{instance:i,dropdownSize:X,handleClick:te,commandHandler:ie,trigger:fo(e,"trigger"),hideOnClick:fo(e,"hideOnClick")}),{t:d,ns:a,scrollbar:C,wrapStyle:N,dropdownTriggerKls:$,dropdownSize:X,triggerId:U,triggerKeys:z,currentTabId:k,handleCurrentTabIdChange:ge,handlerMainButtonClick:Me=>{t("click",Me)},handleEntryFocus:he,handleClose:Z,handleOpen:q,handleBeforeShowTooltip:ue,handleShowTooltip:Re,handleBeforeHideTooltip:Ye,onFocusAfterTrapped:Me=>{var Se,ye;Me.preventDefault(),(ye=(Se=o.value)==null?void 0:Se.focus)==null||ye.call(Se,{preventScroll:!0})},popperRef:x,contentRef:o,triggeringElementRef:m,referenceElementRef:_}}});function nne(e,t,i,a,d,m){var _;const x=Er("el-dropdown-collection"),o=Er("el-roving-focus-group"),C=Er("el-scrollbar"),k=Er("el-only-child"),A=Er("el-tooltip"),z=Er("el-button"),N=Er("arrow-down"),$=Er("el-icon"),F=Er("el-button-group");return se(),Ae("div",{class:ce([e.ns.b(),e.ns.is("disabled",e.disabled)])},[qe(A,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,"hide-after":e.trigger==="hover"?e.hideTimeout:0,"manual-mode":!0,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"reference-element":(_=e.referenceElementRef)==null?void 0:_.$el,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-after":e.trigger==="hover"?e.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":e.triggeringElementRef,"virtual-triggering":e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"",persistent:"",onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},$a({content:st(()=>[qe(C,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:st(()=>[qe(o,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange,onEntryFocus:e.handleEntryFocus},{default:st(()=>[qe(x,null,{default:st(()=>[_t(e.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[e.splitButton?void 0:{name:"default",fn:st(()=>[qe(k,{id:e.triggerId,ref:"triggeringElementRef",role:"button",tabindex:e.tabindex},{default:st(()=>[_t(e.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(se(),It(F,{key:0},{default:st(()=>[qe(z,kr({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:st(()=>[_t(e.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),qe(z,kr({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:st(()=>[qe($,{class:ce(e.ns.e("icon"))},{default:st(()=>[qe(N)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):bt("v-if",!0)],2)}var rne=hn(tne,[["render",nne],["__file","dropdown.vue"]]);const one=Ge({name:"DropdownItemImpl",components:{ElIcon:Dn},props:oz,emits:["pointermove","pointerleave","click","clickimpl"],setup(e,{emit:t}){const i=Jt("dropdown"),{role:a}=kn(o1,void 0),{collectionItemRef:d}=kn(Qte,void 0),{collectionItemRef:m}=kn(Rte,void 0),{rovingFocusGroupItemRef:_,tabIndex:x,handleFocus:o,handleKeydown:C,handleMousedown:k}=kn(rz,void 0),A=Hb(d,m,_),z=Q(()=>a.value==="menu"?"menuitem":a.value==="navigation"?"link":"button"),N=ai($=>{if([En.enter,En.numpadEnter,En.space].includes($.code))return $.preventDefault(),$.stopImmediatePropagation(),t("clickimpl",$),!0},C);return{ns:i,itemRef:A,dataset:{[tz]:""},role:z,tabIndex:x,handleFocus:o,handleKeydown:N,handleMousedown:k}}});function ine(e,t,i,a,d,m){const _=Er("el-icon");return se(),Ae(Bn,null,[e.divided?(se(),Ae("li",{key:0,role:"separator",class:ce(e.ns.bem("menu","item","divided"))},null,2)):bt("v-if",!0),Ve("li",kr({ref:e.itemRef},{...e.dataset,...e.$attrs},{"aria-disabled":e.disabled,class:[e.ns.be("menu","item"),e.ns.is("disabled",e.disabled)],tabindex:e.tabIndex,role:e.role,onClick:x=>e.$emit("clickimpl",x),onFocus:e.handleFocus,onKeydown:Yn(e.handleKeydown,["self"]),onMousedown:e.handleMousedown,onPointermove:x=>e.$emit("pointermove",x),onPointerleave:x=>e.$emit("pointerleave",x)}),[e.icon?(se(),It(_,{key:0},{default:st(()=>[(se(),It(Ir(e.icon)))]),_:1})):bt("v-if",!0),_t(e.$slots,"default")],16,["aria-disabled","tabindex","role","onClick","onFocus","onKeydown","onMousedown","onPointermove","onPointerleave"])],64)}var sne=hn(one,[["render",ine],["__file","dropdown-item-impl.vue"]]);const sz=()=>{const e=kn("elDropdown",{}),t=Q(()=>e==null?void 0:e.dropdownSize);return{elDropdown:e,_elDropdownSize:t}},ane=Ge({name:"ElDropdownItem",components:{ElDropdownCollectionItem:Xte,ElRovingFocusItem:Wte,ElDropdownItemImpl:sne},inheritAttrs:!1,props:oz,emits:["pointermove","pointerleave","click"],setup(e,{emit:t,attrs:i}){const{elDropdown:a}=sz(),d=Cr(),m=be(null),_=Q(()=>{var N,$;return($=(N=y(m))==null?void 0:N.textContent)!=null?$:""}),{onItemEnter:x,onItemLeave:o}=kn(o1,void 0),C=ai(N=>(t("pointermove",N),N.defaultPrevented),EA(N=>{if(e.disabled){o(N);return}const $=N.currentTarget;$===document.activeElement||$.contains(document.activeElement)||(x(N),N.defaultPrevented||$==null||$.focus())})),k=ai(N=>(t("pointerleave",N),N.defaultPrevented),EA(o)),A=ai(N=>{if(!e.disabled)return t("click",N),N.type!=="keydown"&&N.defaultPrevented},N=>{var $,F,G;if(e.disabled){N.stopImmediatePropagation();return}($=a==null?void 0:a.hideOnClick)!=null&&$.value&&((F=a.handleClick)==null||F.call(a)),(G=a.commandHandler)==null||G.call(a,e.command,d,N)}),z=Q(()=>({...e,...i}));return{handleClick:A,handlePointerMove:C,handlePointerLeave:k,textContent:_,propsAndAttrs:z}}});function lne(e,t,i,a,d,m){var _;const x=Er("el-dropdown-item-impl"),o=Er("el-roving-focus-item"),C=Er("el-dropdown-collection-item");return se(),It(C,{disabled:e.disabled,"text-value":(_=e.textValue)!=null?_:e.textContent},{default:st(()=>[qe(o,{focusable:!e.disabled},{default:st(()=>[qe(x,kr(e.propsAndAttrs,{onPointerleave:e.handlePointerLeave,onPointermove:e.handlePointerMove,onClickimpl:e.handleClick}),{default:st(()=>[_t(e.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var az=hn(ane,[["render",lne],["__file","dropdown-item.vue"]]);const cne=Ge({name:"ElDropdownMenu",props:qte,setup(e){const t=Jt("dropdown"),{_elDropdownSize:i}=sz(),a=i.value,{focusTrapRef:d,onKeydown:m}=kn(DC,void 0),{contentRef:_,role:x,triggerId:o}=kn(o1,void 0),{collectionRef:C,getItems:k}=kn(Jte,void 0),{rovingFocusGroupRef:A,rovingFocusGroupRootStyle:z,tabIndex:N,onBlur:$,onFocus:F,onMousedown:G}=kn(qC,void 0),{collectionRef:U}=kn(WC,void 0),te=Q(()=>[t.b("menu"),t.bm("menu",a==null?void 0:a.value)]),Z=Hb(_,C,d,A,U),q=ai(ie=>{var de;(de=e.onKeydown)==null||de.call(e,ie)},ie=>{const{currentTarget:de,code:le,target:pe}=ie;if(de.contains(pe),En.tab===le&&ie.stopImmediatePropagation(),ie.preventDefault(),pe!==y(_)||!Zte.includes(le))return;const he=k().filter(ue=>!ue.disabled).map(ue=>ue.ref);iz.includes(le)&&he.reverse(),KC(he)});return{size:a,rovingFocusGroupRootStyle:z,tabIndex:N,dropdownKls:te,role:x,triggerId:o,dropdownListWrapperRef:Z,handleKeydown:ie=>{q(ie),m(ie)},onBlur:$,onFocus:F,onMousedown:G}}});function une(e,t,i,a,d,m){return se(),Ae("ul",{ref:e.dropdownListWrapperRef,class:ce(e.dropdownKls),style:Nn(e.rovingFocusGroupRootStyle),tabindex:-1,role:e.role,"aria-labelledby":e.triggerId,onBlur:e.onBlur,onFocus:e.onFocus,onKeydown:Yn(e.handleKeydown,["self"]),onMousedown:Yn(e.onMousedown,["self"])},[_t(e.$slots,"default")],46,["role","aria-labelledby","onBlur","onFocus","onKeydown","onMousedown"])}var lz=hn(cne,[["render",une],["__file","dropdown-menu.vue"]]);const dne=cr(rne,{DropdownItem:az,DropdownMenu:lz}),hne=Jo(az),fne=Jo(lz),pne=Ge({name:"ImgEmpty"}),mne=Ge({...pne,setup(e){const t=Jt("empty"),i=Wi();return(a,d)=>(se(),Ae("svg",{viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[Ve("defs",null,[Ve("linearGradient",{id:`linearGradient-1-${y(i)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[Ve("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),Ve("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),Ve("linearGradient",{id:`linearGradient-2-${y(i)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[Ve("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),Ve("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),Ve("rect",{id:`path-3-${y(i)}`,x:"0",y:"0",width:"17",height:"36"},null,8,["id"])]),Ve("g",{id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[Ve("g",{id:"B-type",transform:"translate(-1268.000000, -535.000000)"},[Ve("g",{id:"Group-2",transform:"translate(1268.000000, 535.000000)"},[Ve("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${y(t).cssVarBlockName("fill-color-3")})`},null,8,["fill"]),Ve("polygon",{id:"Rectangle-Copy-14",fill:`var(${y(t).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,["fill"]),Ve("g",{id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},[Ve("polygon",{id:"Rectangle-Copy-10",fill:`var(${y(t).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,["fill"]),Ve("polygon",{id:"Rectangle-Copy-11",fill:`var(${y(t).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,["fill"]),Ve("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${y(i)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,["fill"]),Ve("polygon",{id:"Rectangle-Copy-13",fill:`var(${y(t).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,["fill"])]),Ve("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${y(i)})`,x:"13",y:"45",width:"40",height:"36"},null,8,["fill"]),Ve("g",{id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},[Ve("use",{id:"Mask",fill:`var(${y(t).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${y(i)}`},null,8,["fill","xlink:href"]),Ve("polygon",{id:"Rectangle-Copy",fill:`var(${y(t).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${y(i)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,["fill","mask"])]),Ve("polygon",{id:"Rectangle-Copy-18",fill:`var(${y(t).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,["fill"])])])])]))}});var gne=hn(mne,[["__file","img-empty.vue"]]);const vne=ln({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),_ne=Ge({name:"ElEmpty"}),yne=Ge({..._ne,props:vne,setup(e){const t=e,{t:i}=Gr(),a=Jt("empty"),d=Q(()=>t.description||i("el.table.emptyText")),m=Q(()=>({width:li(t.imageSize)}));return(_,x)=>(se(),Ae("div",{class:ce(y(a).b())},[Ve("div",{class:ce(y(a).e("image")),style:Nn(y(m))},[_.image?(se(),Ae("img",{key:0,src:_.image,ondragstart:"return false"},null,8,["src"])):_t(_.$slots,"image",{key:1},()=>[qe(gne)])],6),Ve("div",{class:ce(y(a).e("description"))},[_.$slots.description?_t(_.$slots,"description",{key:0}):(se(),Ae("p",{key:1},fn(y(d)),1))],2),_.$slots.default?(se(),Ae("div",{key:0,class:ce(y(a).e("bottom"))},[_t(_.$slots,"default")],2)):bt("v-if",!0)],2))}});var bne=hn(yne,[["__file","empty.vue"]]);const cz=cr(bne),xne=ln({urlList:{type:at(Array),default:()=>Xo([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:at(String)}}),wne={close:()=>!0,switch:e=>Wn(e),rotate:e=>Wn(e)},Sne=Ge({name:"ElImageViewer"}),Tne=Ge({...Sne,props:xne,emits:wne,setup(e,{expose:t,emit:i}){var a;const d=e,m={CONTAIN:{name:"contain",icon:Wu(DG)},ORIGINAL:{name:"original",icon:Wu(QG)}},{t:_}=Gr(),x=Jt("image-viewer"),{nextZIndex:o}=Jp(),C=be(),k=be([]),A=R6(),z=be(!0),N=be(d.initialIndex),$=Uo(m.CONTAIN),F=be({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),G=be((a=d.zIndex)!=null?a:o()),U=Q(()=>{const{urlList:Ce}=d;return Ce.length<=1}),te=Q(()=>N.value===0),Z=Q(()=>N.value===d.urlList.length-1),q=Q(()=>d.urlList[N.value]),X=Q(()=>[x.e("btn"),x.e("prev"),x.is("disabled",!d.infinite&&te.value)]),ie=Q(()=>[x.e("btn"),x.e("next"),x.is("disabled",!d.infinite&&Z.value)]),de=Q(()=>{const{scale:Ce,deg:Fe,offsetX:it,offsetY:We,enableTransition:ut}=F.value;let Lt=it/Ce,Ft=We/Ce;const mt=Fe*Math.PI/180,jt=Math.cos(mt),Ht=Math.sin(mt);Lt=Lt*jt+Ft*Ht,Ft=Ft*jt-it/Ce*Ht;const Tn={transform:`scale(${Ce}) rotate(${Fe}deg) translate(${Lt}px, ${Ft}px)`,transition:ut?"transform .3s":""};return $.value.name===m.CONTAIN.name&&(Tn.maxWidth=Tn.maxHeight="100%"),Tn});function le(){ge(),i("close")}function pe(){const Ce=vh(it=>{switch(it.code){case En.esc:d.closeOnPressEscape&&le();break;case En.space:Ie();break;case En.left:Me();break;case En.up:ye("zoomIn");break;case En.right:Se();break;case En.down:ye("zoomOut");break}}),Fe=vh(it=>{const We=it.deltaY||it.deltaX;ye(We<0?"zoomIn":"zoomOut",{zoomRate:d.zoomRate,enableTransition:!1})});A.run(()=>{yo(document,"keydown",Ce),yo(document,"wheel",Fe)})}function ge(){A.stop()}function he(){z.value=!1}function ue(Ce){z.value=!1,Ce.target.alt=_("el.image.error")}function Re(Ce){if(z.value||Ce.button!==0||!C.value)return;F.value.enableTransition=!1;const{offsetX:Fe,offsetY:it}=F.value,We=Ce.pageX,ut=Ce.pageY,Lt=vh(mt=>{F.value={...F.value,offsetX:Fe+mt.pageX-We,offsetY:it+mt.pageY-ut}}),Ft=yo(document,"mousemove",Lt);yo(document,"mouseup",()=>{Ft()}),Ce.preventDefault()}function Ye(){F.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Ie(){if(z.value)return;const Ce=Pp(m),Fe=Object.values(m),it=$.value.name,ut=(Fe.findIndex(Lt=>Lt.name===it)+1)%Ce.length;$.value=m[Ce[ut]],Ye()}function fe(Ce){const Fe=d.urlList.length;N.value=(Ce+Fe)%Fe}function Me(){te.value&&!d.infinite||fe(N.value-1)}function Se(){Z.value&&!d.infinite||fe(N.value+1)}function ye(Ce,Fe={}){if(z.value)return;const{minScale:it,maxScale:We}=d,{zoomRate:ut,rotateDeg:Lt,enableTransition:Ft}={zoomRate:d.zoomRate,rotateDeg:90,enableTransition:!0,...Fe};switch(Ce){case"zoomOut":F.value.scale>it&&(F.value.scale=Number.parseFloat((F.value.scale/ut).toFixed(3)));break;case"zoomIn":F.value.scale<We&&(F.value.scale=Number.parseFloat((F.value.scale*ut).toFixed(3)));break;case"clockwise":F.value.deg+=Lt,i("rotate",F.value.deg);break;case"anticlockwise":F.value.deg-=Lt,i("rotate",F.value.deg);break}F.value.enableTransition=Ft}return Wt(q,()=>{Vn(()=>{const Ce=k.value[0];Ce!=null&&Ce.complete||(z.value=!0)})}),Wt(N,Ce=>{Ye(),i("switch",Ce)}),vr(()=>{var Ce,Fe;pe(),(Fe=(Ce=C.value)==null?void 0:Ce.focus)==null||Fe.call(Ce)}),t({setActiveItem:fe}),(Ce,Fe)=>(se(),It(y(tm),{to:"body",disabled:!Ce.teleported},{default:st(()=>[qe(Fi,{name:"viewer-fade",appear:""},{default:st(()=>[Ve("div",{ref_key:"wrapper",ref:C,tabindex:-1,class:ce(y(x).e("wrapper")),style:Nn({zIndex:G.value})},[Ve("div",{class:ce(y(x).e("mask")),onClick:Yn(it=>Ce.hideOnClickModal&&le(),["self"])},null,10,["onClick"]),bt(" CLOSE "),Ve("span",{class:ce([y(x).e("btn"),y(x).e("close")]),onClick:le},[qe(y(Dn),null,{default:st(()=>[qe(y(vl))]),_:1})],2),bt(" ARROW "),y(U)?bt("v-if",!0):(se(),Ae(Bn,{key:0},[Ve("span",{class:ce(y(X)),onClick:Me},[qe(y(Dn),null,{default:st(()=>[qe(y(nd))]),_:1})],2),Ve("span",{class:ce(y(ie)),onClick:Se},[qe(y(Dn),null,{default:st(()=>[qe(y(Os))]),_:1})],2)],64)),bt(" ACTIONS "),Ve("div",{class:ce([y(x).e("btn"),y(x).e("actions")])},[Ve("div",{class:ce(y(x).e("actions__inner"))},[qe(y(Dn),{onClick:it=>ye("zoomOut")},{default:st(()=>[qe(y(mW))]),_:1},8,["onClick"]),qe(y(Dn),{onClick:it=>ye("zoomIn")},{default:st(()=>[qe(y($O))]),_:1},8,["onClick"]),Ve("i",{class:ce(y(x).e("actions__divider"))},null,2),qe(y(Dn),{onClick:Ie},{default:st(()=>[(se(),It(Ir(y($).icon)))]),_:1}),Ve("i",{class:ce(y(x).e("actions__divider"))},null,2),qe(y(Dn),{onClick:it=>ye("anticlockwise")},{default:st(()=>[qe(y(ZG))]),_:1},8,["onClick"]),qe(y(Dn),{onClick:it=>ye("clockwise")},{default:st(()=>[qe(y(XG))]),_:1},8,["onClick"])],2)],2),bt(" CANVAS "),Ve("div",{class:ce(y(x).e("canvas"))},[(se(!0),Ae(Bn,null,Fr(Ce.urlList,(it,We)=>mr((se(),Ae("img",{ref_for:!0,ref:ut=>k.value[We]=ut,key:it,src:it,style:Nn(y(de)),class:ce(y(x).e("img")),crossorigin:Ce.crossorigin,onLoad:he,onError:ue,onMousedown:Re},null,46,["src","crossorigin"])),[[no,We===N.value]])),128))],2),_t(Ce.$slots,"default")],6)]),_:3})]),_:3},8,["disabled"]))}});var Cne=hn(Tne,[["__file","image-viewer.vue"]]);const uz=cr(Cne),Ene=ln({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:at([String,Object])},previewSrcList:{type:at(Array),default:()=>Xo([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:at(String)}}),Mne={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>Wn(e),close:()=>!0,show:()=>!0},Ine=Ge({name:"ElImage",inheritAttrs:!1}),kne=Ge({...Ine,props:Ene,emits:Mne,setup(e,{emit:t}){const i=e;let a="";const{t:d}=Gr(),m=Jt("image"),_=Dh(),x=Q(()=>Av(Object.entries(_).filter(([Se])=>/^(data-|on[A-Z])/i.test(Se)||["id","style"].includes(Se)))),o=Gb({excludeListeners:!0,excludeKeys:Q(()=>Object.keys(x.value))}),C=be(),k=be(!1),A=be(!0),z=be(!1),N=be(),$=be(),F=Hr&&"loading"in HTMLImageElement.prototype;let G,U;const te=Q(()=>[m.e("inner"),q.value&&m.e("preview"),A.value&&m.is("loading")]),Z=Q(()=>{const{fit:Se}=i;return Hr&&Se?{objectFit:Se}:{}}),q=Q(()=>{const{previewSrcList:Se}=i;return on(Se)&&Se.length>0}),X=Q(()=>{const{previewSrcList:Se,initialIndex:ye}=i;let Ce=ye;return ye>Se.length-1&&(Ce=0),Ce}),ie=Q(()=>i.loading==="eager"?!1:!F&&i.loading==="lazy"||i.lazy),de=()=>{Hr&&(A.value=!0,k.value=!1,C.value=i.src)};function le(Se){A.value=!1,k.value=!1,t("load",Se)}function pe(Se){A.value=!1,k.value=!0,t("error",Se)}function ge(){kV(N.value,$.value)&&(de(),Re())}const he=jL(ge,200,!0);async function ue(){var Se;if(!Hr)return;await Vn();const{scrollContainer:ye}=i;ga(ye)?$.value=ye:zn(ye)&&ye!==""?$.value=(Se=document.querySelector(ye))!=null?Se:void 0:N.value&&($.value=eC(N.value)),$.value&&(G=yo($,"scroll",he),setTimeout(()=>ge(),100))}function Re(){!Hr||!$.value||!he||(G==null||G(),$.value=void 0)}function Ye(Se){if(Se.ctrlKey){if(Se.deltaY<0)return Se.preventDefault(),!1;if(Se.deltaY>0)return Se.preventDefault(),!1}}function Ie(){q.value&&(U=yo("wheel",Ye,{passive:!1}),a=document.body.style.overflow,document.body.style.overflow="hidden",z.value=!0,t("show"))}function fe(){U==null||U(),document.body.style.overflow=a,z.value=!1,t("close")}function Me(Se){t("switch",Se)}return Wt(()=>i.src,()=>{ie.value?(A.value=!0,k.value=!1,Re(),ue()):de()}),vr(()=>{ie.value?ue():de()}),(Se,ye)=>(se(),Ae("div",kr({ref_key:"container",ref:N},y(x),{class:[y(m).b(),Se.$attrs.class]}),[k.value?_t(Se.$slots,"error",{key:0},()=>[Ve("div",{class:ce(y(m).e("error"))},fn(y(d)("el.image.error")),3)]):(se(),Ae(Bn,{key:1},[C.value!==void 0?(se(),Ae("img",kr({key:0},y(o),{src:C.value,loading:Se.loading,style:y(Z),class:y(te),crossorigin:Se.crossorigin,onClick:Ie,onLoad:le,onError:pe}),null,16,["src","loading","crossorigin"])):bt("v-if",!0),A.value?(se(),Ae("div",{key:1,class:ce(y(m).e("wrapper"))},[_t(Se.$slots,"placeholder",{},()=>[Ve("div",{class:ce(y(m).e("placeholder"))},null,2)])],2)):bt("v-if",!0)],64)),y(q)?(se(),Ae(Bn,{key:2},[z.value?(se(),It(y(uz),{key:0,"z-index":Se.zIndex,"initial-index":y(X),infinite:Se.infinite,"zoom-rate":Se.zoomRate,"min-scale":Se.minScale,"max-scale":Se.maxScale,"url-list":Se.previewSrcList,crossorigin:Se.crossorigin,"hide-on-click-modal":Se.hideOnClickModal,teleported:Se.previewTeleported,"close-on-press-escape":Se.closeOnPressEscape,onClose:fe,onSwitch:Me},{default:st(()=>[Se.$slots.viewer?(se(),Ae("div",{key:0},[_t(Se.$slots,"viewer")])):bt("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):bt("v-if",!0)],64)):bt("v-if",!0)],16))}});var Ane=hn(kne,[["__file","image.vue"]]);const Pne=cr(Ane),Rne=ln({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:Ei,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>e===null||Wn(e)||["min","max"].includes(e),default:null},name:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},...qi(["ariaLabel"])}),Dne={[No]:(e,t)=>t!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[zs]:e=>Wn(e)||ki(e),[xr]:e=>Wn(e)||ki(e)},Lne=Ge({name:"ElInputNumber"}),One=Ge({...Lne,props:Rne,emits:Dne,setup(e,{expose:t,emit:i}){const a=e,{t:d}=Gr(),m=Jt("input-number"),_=be(),x=ao({currentValue:a.modelValue,userInput:null}),{formItem:o}=bs(),C=Q(()=>Wn(a.modelValue)&&a.modelValue<=a.min),k=Q(()=>Wn(a.modelValue)&&a.modelValue>=a.max),A=Q(()=>{const Ie=U(a.step);return Bo(a.precision)?Math.max(U(a.modelValue),Ie):(Ie>a.precision,a.precision)}),z=Q(()=>a.controls&&a.controlsPosition==="right"),N=xi(),$=ys(),F=Q(()=>{if(x.userInput!==null)return x.userInput;let Ie=x.currentValue;if(ki(Ie))return"";if(Wn(Ie)){if(Number.isNaN(Ie))return"";Bo(a.precision)||(Ie=Ie.toFixed(a.precision))}return Ie}),G=(Ie,fe)=>{if(Bo(fe)&&(fe=A.value),fe===0)return Math.round(Ie);let Me=String(Ie);const Se=Me.indexOf(".");if(Se===-1||!Me.replace(".","").split("")[Se+fe])return Ie;const Fe=Me.length;return Me.charAt(Fe-1)==="5"&&(Me=`${Me.slice(0,Math.max(0,Fe-1))}6`),Number.parseFloat(Number(Me).toFixed(fe))},U=Ie=>{if(ki(Ie))return 0;const fe=Ie.toString(),Me=fe.indexOf(".");let Se=0;return Me!==-1&&(Se=fe.length-Me-1),Se},te=(Ie,fe=1)=>Wn(Ie)?G(Ie+a.step*fe):x.currentValue,Z=()=>{if(a.readonly||$.value||k.value)return;const Ie=Number(F.value)||0,fe=te(Ie);ie(fe),i(zs,x.currentValue),Re()},q=()=>{if(a.readonly||$.value||C.value)return;const Ie=Number(F.value)||0,fe=te(Ie,-1);ie(fe),i(zs,x.currentValue),Re()},X=(Ie,fe)=>{const{max:Me,min:Se,step:ye,precision:Ce,stepStrictly:Fe,valueOnClear:it}=a;Me<Se&&Ci("InputNumber","min should not be greater than max.");let We=Number(Ie);if(ki(Ie)||Number.isNaN(We))return null;if(Ie===""){if(it===null)return null;We=zn(it)?{min:Se,max:Me}[it]:it}return Fe&&(We=G(Math.round(We/ye)*ye,Ce),We!==Ie&&fe&&i(xr,We)),Bo(Ce)||(We=G(We,Ce)),(We>Me||We<Se)&&(We=We>Me?Me:Se,fe&&i(xr,We)),We},ie=(Ie,fe=!0)=>{var Me;const Se=x.currentValue,ye=X(Ie);if(!fe){i(xr,ye);return}Se===ye&&Ie||(x.userInput=null,i(xr,ye),Se!==ye&&i(No,ye,Se),a.validateEvent&&((Me=o==null?void 0:o.validate)==null||Me.call(o,"change").catch(Ce=>void 0)),x.currentValue=ye)},de=Ie=>{x.userInput=Ie;const fe=Ie===""?null:Number(Ie);i(zs,fe),ie(fe,!1)},le=Ie=>{const fe=Ie!==""?Number(Ie):"";(Wn(fe)&&!Number.isNaN(fe)||Ie==="")&&ie(fe),Re(),x.userInput=null},pe=()=>{var Ie,fe;(fe=(Ie=_.value)==null?void 0:Ie.focus)==null||fe.call(Ie)},ge=()=>{var Ie,fe;(fe=(Ie=_.value)==null?void 0:Ie.blur)==null||fe.call(Ie)},he=Ie=>{i("focus",Ie)},ue=Ie=>{var fe;x.userInput=null,i("blur",Ie),a.validateEvent&&((fe=o==null?void 0:o.validate)==null||fe.call(o,"blur").catch(Me=>void 0))},Re=()=>{x.currentValue!==a.modelValue&&(x.currentValue=a.modelValue)},Ye=Ie=>{document.activeElement===Ie.target&&Ie.preventDefault()};return Wt(()=>a.modelValue,(Ie,fe)=>{const Me=X(Ie,!0);x.userInput===null&&Me!==fe&&(x.currentValue=Me)},{immediate:!0}),vr(()=>{var Ie;const{min:fe,max:Me,modelValue:Se}=a,ye=(Ie=_.value)==null?void 0:Ie.input;if(ye.setAttribute("role","spinbutton"),Number.isFinite(Me)?ye.setAttribute("aria-valuemax",String(Me)):ye.removeAttribute("aria-valuemax"),Number.isFinite(fe)?ye.setAttribute("aria-valuemin",String(fe)):ye.removeAttribute("aria-valuemin"),ye.setAttribute("aria-valuenow",x.currentValue||x.currentValue===0?String(x.currentValue):""),ye.setAttribute("aria-disabled",String($.value)),!Wn(Se)&&Se!=null){let Ce=Number(Se);Number.isNaN(Ce)&&(Ce=null),i(xr,Ce)}ye.addEventListener("wheel",Ye,{passive:!1})}),Jl(()=>{var Ie,fe;const Me=(Ie=_.value)==null?void 0:Ie.input;Me==null||Me.setAttribute("aria-valuenow",`${(fe=x.currentValue)!=null?fe:""}`)}),t({focus:pe,blur:ge}),(Ie,fe)=>(se(),Ae("div",{class:ce([y(m).b(),y(m).m(y(N)),y(m).is("disabled",y($)),y(m).is("without-controls",!Ie.controls),y(m).is("controls-right",y(z))]),onDragstart:Yn(()=>{},["prevent"])},[Ie.controls?mr((se(),Ae("span",{key:0,role:"button","aria-label":y(d)("el.inputNumber.decrease"),class:ce([y(m).e("decrease"),y(m).is("disabled",y(C))]),onKeydown:Mo(q,["enter"])},[_t(Ie.$slots,"decrease-icon",{},()=>[qe(y(Dn),null,{default:st(()=>[y(z)?(se(),It(y(Bc),{key:0})):(se(),It(y(NG),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[y(cb),q]]):bt("v-if",!0),Ie.controls?mr((se(),Ae("span",{key:1,role:"button","aria-label":y(d)("el.inputNumber.increase"),class:ce([y(m).e("increase"),y(m).is("disabled",y(k))]),onKeydown:Mo(Z,["enter"])},[_t(Ie.$slots,"increase-icon",{},()=>[qe(y(Dn),null,{default:st(()=>[y(z)?(se(),It(y(nC),{key:0})):(se(),It(y(FO),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[y(cb),Z]]):bt("v-if",!0),qe(y(vs),{id:Ie.id,ref_key:"input",ref:_,type:"number",step:Ie.step,"model-value":y(F),placeholder:Ie.placeholder,readonly:Ie.readonly,disabled:y($),size:y(N),max:Ie.max,min:Ie.min,name:Ie.name,"aria-label":Ie.ariaLabel,"validate-event":!1,onKeydown:[Mo(Yn(Z,["prevent"]),["up"]),Mo(Yn(q,["prevent"]),["down"])],onBlur:ue,onFocus:he,onInput:de,onChange:le},$a({_:2},[Ie.$slots.prefix?{name:"prefix",fn:st(()=>[_t(Ie.$slots,"prefix")])}:void 0,Ie.$slots.suffix?{name:"suffix",fn:st(()=>[_t(Ie.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}});var zne=hn(One,[["__file","input-number.vue"]]);const dz=cr(zne),Bne=ln({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:Boolean,href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:wo}}),Fne={click:e=>e instanceof MouseEvent},Nne=Ge({name:"ElLink"}),$ne=Ge({...Nne,props:Bne,emits:Fne,setup(e,{emit:t}){const i=e,a=Jt("link"),d=Q(()=>[a.b(),a.m(i.type),a.is("disabled",i.disabled),a.is("underline",i.underline&&!i.disabled)]);function m(_){i.disabled||t("click",_)}return(_,x)=>(se(),Ae("a",{class:ce(y(d)),href:_.disabled||!_.href?void 0:_.href,target:_.disabled||!_.href?void 0:_.target,onClick:m},[_.icon?(se(),It(y(Dn),{key:0},{default:st(()=>[(se(),It(Ir(_.icon)))]),_:1})):bt("v-if",!0),_.$slots.default?(se(),Ae("span",{key:1,class:ce(y(a).e("inner"))},[_t(_.$slots,"default")],2)):bt("v-if",!0),_.$slots.icon?_t(_.$slots,"icon",{key:2}):bt("v-if",!0)],10,["href","target"]))}});var Vne=hn($ne,[["__file","link.vue"]]);const Une=cr(Vne);let jne=class{constructor(t,i){this.parent=t,this.domNode=i,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(t){t===this.subMenuItems.length?t=0:t<0&&(t=this.subMenuItems.length-1),this.subMenuItems[t].focus(),this.subIndex=t}addListeners(){const t=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,i=>{i.addEventListener("keydown",a=>{let d=!1;switch(a.code){case En.down:{this.gotoSubIndex(this.subIndex+1),d=!0;break}case En.up:{this.gotoSubIndex(this.subIndex-1),d=!0;break}case En.tab:{I0(t,"mouseleave");break}case En.enter:case En.numpadEnter:case En.space:{d=!0,a.currentTarget.click();break}}return d&&(a.preventDefault(),a.stopPropagation()),!1})})}},Hne=class{constructor(t,i){this.domNode=t,this.submenu=null,this.submenu=null,this.init(i)}init(t){this.domNode.setAttribute("tabindex","0");const i=this.domNode.querySelector(`.${t}-menu`);i&&(this.submenu=new jne(this,i)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",t=>{let i=!1;switch(t.code){case En.down:{I0(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),i=!0;break}case En.up:{I0(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),i=!0;break}case En.tab:{I0(t.currentTarget,"mouseleave");break}case En.enter:case En.numpadEnter:case En.space:{i=!0,t.currentTarget.click();break}}i&&t.preventDefault()})}},Gne=class{constructor(t,i){this.domNode=t,this.init(i)}init(t){const i=this.domNode.childNodes;Array.from(i).forEach(a=>{a.nodeType===1&&new Hne(a,t)})}};const Wne=Ge({name:"ElMenuCollapseTransition",setup(){const e=Jt("menu");return{listeners:{onBeforeEnter:i=>i.style.opacity="0.2",onEnter(i,a){Oa(i,`${e.namespace.value}-opacity-transition`),i.style.opacity="1",a()},onAfterEnter(i){_s(i,`${e.namespace.value}-opacity-transition`),i.style.opacity=""},onBeforeLeave(i){i.dataset||(i.dataset={}),Ks(i,e.m("collapse"))?(_s(i,e.m("collapse")),i.dataset.oldOverflow=i.style.overflow,i.dataset.scrollWidth=i.clientWidth.toString(),Oa(i,e.m("collapse"))):(Oa(i,e.m("collapse")),i.dataset.oldOverflow=i.style.overflow,i.dataset.scrollWidth=i.clientWidth.toString(),_s(i,e.m("collapse"))),i.style.width=`${i.scrollWidth}px`,i.style.overflow="hidden"},onLeave(i){Oa(i,"horizontal-collapse-transition"),i.style.width=`${i.dataset.scrollWidth}px`}}}}});function qne(e,t,i,a,d,m){return se(),It(Fi,kr({mode:"out-in"},e.listeners),{default:st(()=>[_t(e.$slots,"default")]),_:3},16)}var Kne=hn(Wne,[["render",qne],["__file","menu-collapse-transition.vue"]]);function hz(e,t){const i=Q(()=>{let d=e.parent;const m=[t.value];for(;d.type.name!=="ElMenu";)d.props.index&&m.unshift(d.props.index),d=d.parent;return m});return{parentMenu:Q(()=>{let d=e.parent;for(;d&&!["ElMenu","ElSubMenu"].includes(d.type.name);)d=d.parent;return d}),indexPath:i}}function Zne(e){return Q(()=>{const i=e.backgroundColor;return i?new G4(i).shade(20).toString():""})}const fz=(e,t)=>{const i=Jt("menu");return Q(()=>i.cssVarBlock({"text-color":e.textColor||"","hover-text-color":e.textColor||"","bg-color":e.backgroundColor||"","hover-bg-color":Zne(e).value||"","active-color":e.activeTextColor||"",level:`${t}`}))},Yne=ln({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:wo},expandOpenIcon:{type:wo},collapseCloseIcon:{type:wo},collapseOpenIcon:{type:wo}}),kw="ElSubMenu";var ZC=Ge({name:kw,props:Yne,setup(e,{slots:t,expose:i}){const a=Cr(),{indexPath:d,parentMenu:m}=hz(a,Q(()=>e.index)),_=Jt("menu"),x=Jt("sub-menu"),o=kn("rootMenu");o||Ci(kw,"can not inject root menu");const C=kn(`subMenu:${m.value.uid}`);C||Ci(kw,"can not inject sub menu");const k=be({}),A=be({});let z;const N=be(!1),$=be(),F=be(null),G=Q(()=>le.value==="horizontal"&&te.value?"bottom-start":"right-start"),U=Q(()=>le.value==="horizontal"&&te.value||le.value==="vertical"&&!o.props.collapse?e.expandCloseIcon&&e.expandOpenIcon?ie.value?e.expandOpenIcon:e.expandCloseIcon:Bc:e.collapseCloseIcon&&e.collapseOpenIcon?ie.value?e.collapseOpenIcon:e.collapseCloseIcon:Os),te=Q(()=>C.level===0),Z=Q(()=>{const Ce=e.teleported;return Ce===void 0?te.value:Ce}),q=Q(()=>o.props.collapse?`${_.namespace.value}-zoom-in-left`:`${_.namespace.value}-zoom-in-top`),X=Q(()=>le.value==="horizontal"&&te.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),ie=Q(()=>o.openedMenus.includes(e.index)),de=Q(()=>{let Ce=!1;return Object.values(k.value).forEach(Fe=>{Fe.active&&(Ce=!0)}),Object.values(A.value).forEach(Fe=>{Fe.active&&(Ce=!0)}),Ce}),le=Q(()=>o.props.mode),pe=ao({index:e.index,indexPath:d,active:de}),ge=fz(o.props,C.level+1),he=Q(()=>{var Ce;return(Ce=e.popperOffset)!=null?Ce:o.props.popperOffset}),ue=Q(()=>{var Ce;return(Ce=e.popperClass)!=null?Ce:o.props.popperClass}),Re=Q(()=>{var Ce;return(Ce=e.showTimeout)!=null?Ce:o.props.showTimeout}),Ye=Q(()=>{var Ce;return(Ce=e.hideTimeout)!=null?Ce:o.props.hideTimeout}),Ie=()=>{var Ce,Fe,it;return(it=(Fe=(Ce=F.value)==null?void 0:Ce.popperRef)==null?void 0:Fe.popperInstanceRef)==null?void 0:it.destroy()},fe=Ce=>{Ce||Ie()},Me=()=>{o.props.menuTrigger==="hover"&&o.props.mode==="horizontal"||o.props.collapse&&o.props.mode==="vertical"||e.disabled||o.handleSubMenuClick({index:e.index,indexPath:d.value,active:de.value})},Se=(Ce,Fe=Re.value)=>{var it;if(Ce.type!=="focus"){if(o.props.menuTrigger==="click"&&o.props.mode==="horizontal"||!o.props.collapse&&o.props.mode==="vertical"||e.disabled){C.mouseInChild.value=!0;return}C.mouseInChild.value=!0,z==null||z(),{stop:z}=Th(()=>{o.openMenu(e.index,d.value)},Fe),Z.value&&((it=m.value.vnode.el)==null||it.dispatchEvent(new MouseEvent("mouseenter")))}},ye=(Ce=!1)=>{var Fe;if(o.props.menuTrigger==="click"&&o.props.mode==="horizontal"||!o.props.collapse&&o.props.mode==="vertical"){C.mouseInChild.value=!1;return}z==null||z(),C.mouseInChild.value=!1,{stop:z}=Th(()=>!N.value&&o.closeMenu(e.index,d.value),Ye.value),Z.value&&Ce&&((Fe=C.handleMouseleave)==null||Fe.call(C,!0))};Wt(()=>o.props.collapse,Ce=>fe(!!Ce));{const Ce=it=>{A.value[it.index]=it},Fe=it=>{delete A.value[it.index]};Br(`subMenu:${a.uid}`,{addSubMenu:Ce,removeSubMenu:Fe,handleMouseleave:ye,mouseInChild:N,level:C.level+1})}return i({opened:ie}),vr(()=>{o.addSubMenu(pe),C.addSubMenu(pe)}),Io(()=>{C.removeSubMenu(pe),o.removeSubMenu(pe)}),()=>{var Ce;const Fe=[(Ce=t.title)==null?void 0:Ce.call(t),Kn(Dn,{class:x.e("icon-arrow"),style:{transform:ie.value?e.expandCloseIcon&&e.expandOpenIcon||e.collapseCloseIcon&&e.collapseOpenIcon&&o.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>zn(U.value)?Kn(a.appContext.components[U.value]):Kn(U.value)})],it=o.isMenuPopup?Kn(os,{ref:F,visible:ie.value,effect:"light",pure:!0,offset:he.value,showArrow:!1,persistent:!0,popperClass:ue.value,placement:G.value,teleported:Z.value,fallbackPlacements:X.value,transition:q.value,gpuAcceleration:!1},{content:()=>{var We;return Kn("div",{class:[_.m(le.value),_.m("popup-container"),ue.value],onMouseenter:ut=>Se(ut,100),onMouseleave:()=>ye(!0),onFocus:ut=>Se(ut,100)},[Kn("ul",{class:[_.b(),_.m("popup"),_.m(`popup-${G.value}`)],style:ge.value},[(We=t.default)==null?void 0:We.call(t)])])},default:()=>Kn("div",{class:x.e("title"),onClick:Me},Fe)}):Kn(Bn,{},[Kn("div",{class:x.e("title"),ref:$,onClick:Me},Fe),Kn(n1,{},{default:()=>{var We;return mr(Kn("ul",{role:"menu",class:[_.b(),_.m("inline")],style:ge.value},[(We=t.default)==null?void 0:We.call(t)]),[[no,ie.value]])}})]);return Kn("li",{class:[x.b(),x.is("active",de.value),x.is("opened",ie.value),x.is("disabled",e.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:ie.value,onMouseenter:Se,onMouseleave:()=>ye(),onFocus:Se},[it])}}});const Xne=ln({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:at(Array),default:()=>Xo([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:wo,default:()=>UG},popperEffect:{type:at(String),default:"dark"},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300}}),Aw=e=>on(e)&&e.every(t=>zn(t)),Jne={close:(e,t)=>zn(e)&&Aw(t),open:(e,t)=>zn(e)&&Aw(t),select:(e,t,i,a)=>zn(e)&&Aw(t)&&Tr(i)&&(a===void 0||a instanceof Promise)};var Qne=Ge({name:"ElMenu",props:Xne,emits:Jne,setup(e,{emit:t,slots:i,expose:a}){const d=Cr(),m=d.appContext.config.globalProperties.$router,_=be(),x=Jt("menu"),o=Jt("sub-menu"),C=be(-1),k=be(e.defaultOpeneds&&!e.collapse?e.defaultOpeneds.slice(0):[]),A=be(e.defaultActive),z=be({}),N=be({}),$=Q(()=>e.mode==="horizontal"||e.mode==="vertical"&&e.collapse),F=()=>{const Ie=A.value&&z.value[A.value];if(!Ie||e.mode==="horizontal"||e.collapse)return;Ie.indexPath.forEach(Me=>{const Se=N.value[Me];Se&&G(Me,Se.indexPath)})},G=(Ie,fe)=>{k.value.includes(Ie)||(e.uniqueOpened&&(k.value=k.value.filter(Me=>fe.includes(Me))),k.value.push(Ie),t("open",Ie,fe))},U=Ie=>{const fe=k.value.indexOf(Ie);fe!==-1&&k.value.splice(fe,1)},te=(Ie,fe)=>{U(Ie),t("close",Ie,fe)},Z=({index:Ie,indexPath:fe})=>{k.value.includes(Ie)?te(Ie,fe):G(Ie,fe)},q=Ie=>{(e.mode==="horizontal"||e.collapse)&&(k.value=[]);const{index:fe,indexPath:Me}=Ie;if(!(ki(fe)||ki(Me)))if(e.router&&m){const Se=Ie.route||fe,ye=m.push(Se).then(Ce=>(Ce||(A.value=fe),Ce));t("select",fe,Me,{index:fe,indexPath:Me,route:Se},ye)}else A.value=fe,t("select",fe,Me,{index:fe,indexPath:Me})},X=Ie=>{const fe=z.value,Me=fe[Ie]||A.value&&fe[A.value]||fe[e.defaultActive];Me?A.value=Me.index:A.value=Ie},ie=Ie=>{const fe=getComputedStyle(Ie),Me=Number.parseInt(fe.marginLeft,10),Se=Number.parseInt(fe.marginRight,10);return Ie.offsetWidth+Me+Se||0},de=()=>{var Ie,fe;if(!_.value)return-1;const Me=Array.from((fe=(Ie=_.value)==null?void 0:Ie.childNodes)!=null?fe:[]).filter(Lt=>Lt.nodeName!=="#comment"&&(Lt.nodeName!=="#text"||Lt.nodeValue)),Se=64,ye=getComputedStyle(_.value),Ce=Number.parseInt(ye.paddingLeft,10),Fe=Number.parseInt(ye.paddingRight,10),it=_.value.clientWidth-Ce-Fe;let We=0,ut=0;return Me.forEach((Lt,Ft)=>{We+=ie(Lt),We<=it-Se&&(ut=Ft+1)}),ut===Me.length?-1:ut},le=Ie=>N.value[Ie].indexPath,pe=(Ie,fe=33.34)=>{let Me;return()=>{Me&&clearTimeout(Me),Me=setTimeout(()=>{Ie()},fe)}};let ge=!0;const he=()=>{if(C.value===de())return;const Ie=()=>{C.value=-1,Vn(()=>{C.value=de()})};ge?Ie():pe(Ie)(),ge=!1};Wt(()=>e.defaultActive,Ie=>{z.value[Ie]||(A.value=""),X(Ie)}),Wt(()=>e.collapse,Ie=>{Ie&&(k.value=[])}),Wt(z.value,F);let ue;ns(()=>{e.mode==="horizontal"&&e.ellipsis?ue=qo(_,he).stop:ue==null||ue()});const Re=be(!1);{const Ie=ye=>{N.value[ye.index]=ye},fe=ye=>{delete N.value[ye.index]};Br("rootMenu",ao({props:e,openedMenus:k,items:z,subMenus:N,activeIndex:A,isMenuPopup:$,addMenuItem:ye=>{z.value[ye.index]=ye},removeMenuItem:ye=>{delete z.value[ye.index]},addSubMenu:Ie,removeSubMenu:fe,openMenu:G,closeMenu:te,handleMenuItemClick:q,handleSubMenuClick:Z})),Br(`subMenu:${d.uid}`,{addSubMenu:Ie,removeSubMenu:fe,mouseInChild:Re,level:0})}vr(()=>{e.mode==="horizontal"&&new Gne(d.vnode.el,x.namespace.value)}),a({open:fe=>{const{indexPath:Me}=N.value[fe];Me.forEach(Se=>G(Se,Me))},close:U,handleResize:he});const Ye=fz(e,0);return()=>{var Ie,fe;let Me=(fe=(Ie=i.default)==null?void 0:Ie.call(i))!=null?fe:[];const Se=[];if(e.mode==="horizontal"&&_.value){const Fe=qu(Me),it=C.value===-1?Fe:Fe.slice(0,C.value),We=C.value===-1?[]:Fe.slice(C.value);We!=null&&We.length&&e.ellipsis&&(Me=it,Se.push(Kn(ZC,{index:"sub-menu-more",class:o.e("hide-arrow"),popperOffset:e.popperOffset},{title:()=>Kn(Dn,{class:o.e("icon-more")},{default:()=>Kn(e.ellipsisIcon)}),default:()=>We})))}const ye=e.closeOnClickOutside?[[Rc,()=>{k.value.length&&(Re.value||(k.value.forEach(Fe=>t("close",Fe,le(Fe))),k.value=[]))}]]:[],Ce=mr(Kn("ul",{key:String(e.collapse),role:"menubar",ref:_,style:Ye.value,class:{[x.b()]:!0,[x.m(e.mode)]:!0,[x.m("collapse")]:e.collapse}},[...Me,...Se]),ye);return e.collapseTransition&&e.mode==="vertical"?Kn(Kne,()=>Ce):Ce}}});const ere=ln({index:{type:at([String,null]),default:null},route:{type:at([String,Object])},disabled:Boolean}),tre={click:e=>zn(e.index)&&on(e.indexPath)},Pw="ElMenuItem",nre=Ge({name:Pw,components:{ElTooltip:os},props:ere,emits:tre,setup(e,{emit:t}){const i=Cr(),a=kn("rootMenu"),d=Jt("menu"),m=Jt("menu-item");a||Ci(Pw,"can not inject root menu");const{parentMenu:_,indexPath:x}=hz(i,fo(e,"index")),o=kn(`subMenu:${_.value.uid}`);o||Ci(Pw,"can not inject sub menu");const C=Q(()=>e.index===a.activeIndex),k=ao({index:e.index,indexPath:x,active:C}),A=()=>{e.disabled||(a.handleMenuItemClick({index:e.index,indexPath:x.value,route:e.route}),t("click",k))};return vr(()=>{o.addSubMenu(k),a.addMenuItem(k)}),Io(()=>{o.removeSubMenu(k),a.removeMenuItem(k)}),{parentMenu:_,rootMenu:a,active:C,nsMenu:d,nsMenuItem:m,handleClick:A}}});function rre(e,t,i,a,d,m){const _=Er("el-tooltip");return se(),Ae("li",{class:ce([e.nsMenuItem.b(),e.nsMenuItem.is("active",e.active),e.nsMenuItem.is("disabled",e.disabled)]),role:"menuitem",tabindex:"-1",onClick:e.handleClick},[e.parentMenu.type.name==="ElMenu"&&e.rootMenu.props.collapse&&e.$slots.title?(se(),It(_,{key:0,effect:e.rootMenu.props.popperEffect,placement:"right","fallback-placements":["left"],persistent:""},{content:st(()=>[_t(e.$slots,"title")]),default:st(()=>[Ve("div",{class:ce(e.nsMenu.be("tooltip","trigger"))},[_t(e.$slots,"default")],2)]),_:3},8,["effect"])):(se(),Ae(Bn,{key:1},[_t(e.$slots,"default"),_t(e.$slots,"title")],64))],10,["onClick"])}var pz=hn(nre,[["render",rre],["__file","menu-item.vue"]]);const ore={title:String},ire="ElMenuItemGroup",sre=Ge({name:ire,props:ore,setup(){return{ns:Jt("menu-item-group")}}});function are(e,t,i,a,d,m){return se(),Ae("li",{class:ce(e.ns.b())},[Ve("div",{class:ce(e.ns.e("title"))},[e.$slots.title?_t(e.$slots,"title",{key:1}):(se(),Ae(Bn,{key:0},[$r(fn(e.title),1)],64))],2),Ve("ul",null,[_t(e.$slots,"default")])],2)}var mz=hn(sre,[["render",are],["__file","menu-item-group.vue"]]);const lre=cr(Qne,{MenuItem:pz,MenuItemGroup:mz,SubMenu:ZC}),cre=Jo(pz),ure=Jo(mz),dre=Jo(ZC),hre=ln({icon:{type:wo,default:()=>hG},title:String,content:{type:String,default:""}}),fre={back:()=>!0},pre=Ge({name:"ElPageHeader"}),mre=Ge({...pre,props:hre,emits:fre,setup(e,{emit:t}){const i=Ai(),{t:a}=Gr(),d=Jt("page-header"),m=Q(()=>[d.b(),{[d.m("has-breadcrumb")]:!!i.breadcrumb,[d.m("has-extra")]:!!i.extra,[d.is("contentful")]:!!i.default}]);function _(){t("back")}return(x,o)=>(se(),Ae("div",{class:ce(y(m))},[x.$slots.breadcrumb?(se(),Ae("div",{key:0,class:ce(y(d).e("breadcrumb"))},[_t(x.$slots,"breadcrumb")],2)):bt("v-if",!0),Ve("div",{class:ce(y(d).e("header"))},[Ve("div",{class:ce(y(d).e("left"))},[Ve("div",{class:ce(y(d).e("back")),role:"button",tabindex:"0",onClick:_},[x.icon||x.$slots.icon?(se(),Ae("div",{key:0,"aria-label":x.title||y(a)("el.pageHeader.title"),class:ce(y(d).e("icon"))},[_t(x.$slots,"icon",{},()=>[x.icon?(se(),It(y(Dn),{key:0},{default:st(()=>[(se(),It(Ir(x.icon)))]),_:1})):bt("v-if",!0)])],10,["aria-label"])):bt("v-if",!0),Ve("div",{class:ce(y(d).e("title"))},[_t(x.$slots,"title",{},()=>[$r(fn(x.title||y(a)("el.pageHeader.title")),1)])],2)],2),qe(y(ez),{direction:"vertical"}),Ve("div",{class:ce(y(d).e("content"))},[_t(x.$slots,"content",{},()=>[$r(fn(x.content),1)])],2)],2),x.$slots.extra?(se(),Ae("div",{key:0,class:ce(y(d).e("extra"))},[_t(x.$slots,"extra")],2)):bt("v-if",!0)],2),x.$slots.default?(se(),Ae("div",{key:1,class:ce(y(d).e("main"))},[_t(x.$slots,"default")],2)):bt("v-if",!0)],2))}});var gre=hn(mre,[["__file","page-header.vue"]]);const vre=cr(gre),gz=Symbol("elPaginationKey"),_re=ln({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:wo}}),yre={click:e=>e instanceof MouseEvent},bre=Ge({name:"ElPaginationPrev"}),xre=Ge({...bre,props:_re,emits:yre,setup(e){const t=e,{t:i}=Gr(),a=Q(()=>t.disabled||t.currentPage<=1);return(d,m)=>(se(),Ae("button",{type:"button",class:"btn-prev",disabled:y(a),"aria-label":d.prevText||y(i)("el.pagination.prev"),"aria-disabled":y(a),onClick:_=>d.$emit("click",_)},[d.prevText?(se(),Ae("span",{key:0},fn(d.prevText),1)):(se(),It(y(Dn),{key:1},{default:st(()=>[(se(),It(Ir(d.prevIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var wre=hn(xre,[["__file","prev.vue"]]);const Sre=ln({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:wo}}),Tre=Ge({name:"ElPaginationNext"}),Cre=Ge({...Tre,props:Sre,emits:["click"],setup(e){const t=e,{t:i}=Gr(),a=Q(()=>t.disabled||t.currentPage===t.pageCount||t.pageCount===0);return(d,m)=>(se(),Ae("button",{type:"button",class:"btn-next",disabled:y(a),"aria-label":d.nextText||y(i)("el.pagination.next"),"aria-disabled":y(a),onClick:_=>d.$emit("click",_)},[d.nextText?(se(),Ae("span",{key:0},fn(d.nextText),1)):(se(),It(y(Dn),{key:1},{default:st(()=>[(se(),It(Ir(d.nextIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var Ere=hn(Cre,[["__file","next.vue"]]);const vz=Symbol("ElSelectGroup"),rm=Symbol("ElSelect");function Mre(e,t){const i=kn(rm),a=kn(vz,{disabled:!1}),d=Q(()=>k(ms(i.props.modelValue),e.value)),m=Q(()=>{var N;if(i.props.multiple){const $=ms((N=i.props.modelValue)!=null?N:[]);return!d.value&&$.length>=i.props.multipleLimit&&i.props.multipleLimit>0}else return!1}),_=Q(()=>e.label||(Tr(e.value)?"":e.value)),x=Q(()=>e.value||e.label||""),o=Q(()=>e.disabled||t.groupDisabled||m.value),C=Cr(),k=(N=[],$)=>{if(Tr(e.value)){const F=i.props.valueKey;return N&&N.some(G=>Eo(mi(G,F))===mi($,F))}else return N&&N.includes($)},A=()=>{!e.disabled&&!a.disabled&&(i.states.hoveringIndex=i.optionsArray.indexOf(C.proxy))},z=N=>{const $=new RegExp(QT(N),"i");t.visible=$.test(_.value)||e.created};return Wt(()=>_.value,()=>{!e.created&&!i.props.remote&&i.setSelected()}),Wt(()=>e.value,(N,$)=>{const{remote:F,valueKey:G}=i.props;if(N!==$&&(i.onOptionDestroy($,C.proxy),i.onOptionCreate(C.proxy)),!e.created&&!F){if(G&&Tr(N)&&Tr($)&&N[G]===$[G])return;i.setSelected()}}),Wt(()=>a.disabled,()=>{t.groupDisabled=a.disabled},{immediate:!0}),{select:i,currentLabel:_,currentValue:x,itemSelected:d,isDisabled:o,hoverItem:A,updateOption:z}}const Ire=Ge({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(e){const t=Jt("select"),i=Wi(),a=Q(()=>[t.be("dropdown","item"),t.is("disabled",y(x)),t.is("selected",y(_)),t.is("hovering",y(z))]),d=ao({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:m,itemSelected:_,isDisabled:x,select:o,hoverItem:C,updateOption:k}=Mre(e,d),{visible:A,hover:z}=Bi(d),N=Cr().proxy;o.onOptionCreate(N),Io(()=>{const F=N.value,{selected:G}=o.states,te=(o.props.multiple?G:[G]).some(Z=>Z.value===N.value);Vn(()=>{o.states.cachedOptions.get(F)===N&&!te&&o.states.cachedOptions.delete(F)}),o.onOptionDestroy(F,N)});function $(){x.value||o.handleOptionSelect(N)}return{ns:t,id:i,containerKls:a,currentLabel:m,itemSelected:_,isDisabled:x,select:o,hoverItem:C,updateOption:k,visible:A,hover:z,selectOptionClick:$,states:d}}});function kre(e,t,i,a,d,m){return mr((se(),Ae("li",{id:e.id,class:ce(e.containerKls),role:"option","aria-disabled":e.isDisabled||void 0,"aria-selected":e.itemSelected,onMousemove:e.hoverItem,onClick:Yn(e.selectOptionClick,["stop"])},[_t(e.$slots,"default",{},()=>[Ve("span",null,fn(e.currentLabel),1)])],42,["id","aria-disabled","aria-selected","onMousemove","onClick"])),[[no,e.visible]])}var YC=hn(Ire,[["render",kre],["__file","option.vue"]]);const Are=Ge({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=kn(rm),t=Jt("select"),i=Q(()=>e.props.popperClass),a=Q(()=>e.props.multiple),d=Q(()=>e.props.fitInputWidth),m=be("");function _(){var x;m.value=`${(x=e.selectRef)==null?void 0:x.offsetWidth}px`}return vr(()=>{_(),qo(e.selectRef,_)}),{ns:t,minWidth:m,popperClass:i,isMultiple:a,isFitInputWidth:d}}});function Pre(e,t,i,a,d,m){return se(),Ae("div",{class:ce([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:Nn({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[e.$slots.header?(se(),Ae("div",{key:0,class:ce(e.ns.be("dropdown","header"))},[_t(e.$slots,"header")],2)):bt("v-if",!0),_t(e.$slots,"default"),e.$slots.footer?(se(),Ae("div",{key:1,class:ce(e.ns.be("dropdown","footer"))},[_t(e.$slots,"footer")],2)):bt("v-if",!0)],6)}var Rre=hn(Are,[["render",Pre],["__file","select-dropdown.vue"]]);const Dre=11,Lre=(e,t)=>{const{t:i}=Gr(),a=Wi(),d=Jt("select"),m=Jt("input"),_=ao({inputValue:"",options:new Map,cachedOptions:new Map,optionValues:[],selected:[],selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),x=be(null),o=be(null),C=be(null),k=be(null),A=be(null),z=be(null),N=be(null),$=be(null),F=be(null),G=be(null),U=be(null),te=be(null),{isComposing:Z,handleCompositionStart:q,handleCompositionUpdate:X,handleCompositionEnd:ie}=Yb({afterComposition:Je=>ar(Je)}),{wrapperRef:de,isFocused:le,handleBlur:pe}=Bh(A,{beforeFocus(){return Me.value},afterFocus(){e.automaticDropdown&&!ge.value&&(ge.value=!0,_.menuVisibleOnFocus=!0)},beforeBlur(Je){var Pt,vn;return((Pt=C.value)==null?void 0:Pt.isFocusInsideContent(Je))||((vn=k.value)==null?void 0:vn.isFocusInsideContent(Je))},afterBlur(){ge.value=!1,_.menuVisibleOnFocus=!1}}),ge=be(!1),he=be(),{form:ue,formItem:Re}=bs(),{inputId:Ye}=Sl(e,{formItemContext:Re}),{valueOnClear:Ie,isEmptyValue:fe}=Xb(e),Me=Q(()=>e.disabled||(ue==null?void 0:ue.disabled)),Se=Q(()=>on(e.modelValue)?e.modelValue.length>0:!fe(e.modelValue)),ye=Q(()=>{var Je;return(Je=ue==null?void 0:ue.statusIcon)!=null?Je:!1}),Ce=Q(()=>e.clearable&&!Me.value&&_.inputHovering&&Se.value),Fe=Q(()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon),it=Q(()=>d.is("reverse",Fe.value&&ge.value)),We=Q(()=>(Re==null?void 0:Re.validateState)||""),ut=Q(()=>lC[We.value]),Lt=Q(()=>e.remote?300:0),Ft=Q(()=>e.loading?e.loadingText||i("el.select.loading"):e.remote&&!_.inputValue&&_.options.size===0?!1:e.filterable&&_.inputValue&&_.options.size>0&&mt.value===0?e.noMatchText||i("el.select.noMatch"):_.options.size===0?e.noDataText||i("el.select.noData"):null),mt=Q(()=>jt.value.filter(Je=>Je.visible).length),jt=Q(()=>{const Je=Array.from(_.options.values()),Pt=[];return _.optionValues.forEach(vn=>{const Cn=Je.findIndex(tr=>tr.value===vn);Cn>-1&&Pt.push(Je[Cn])}),Pt.length>=Je.length?Pt:Je}),Ht=Q(()=>Array.from(_.cachedOptions.values())),Tn=Q(()=>{const Je=jt.value.filter(Pt=>!Pt.created).some(Pt=>Pt.currentLabel===_.inputValue);return e.filterable&&e.allowCreate&&_.inputValue!==""&&!Je}),Pe=()=>{e.filterable&&Fn(e.filterMethod)||e.filterable&&e.remote&&Fn(e.remoteMethod)||jt.value.forEach(Je=>{var Pt;(Pt=Je.updateOption)==null||Pt.call(Je,_.inputValue)})},At=xi(),He=Q(()=>["small"].includes(At.value)?"small":"default"),pt=Q({get(){return ge.value&&Ft.value!==!1},set(Je){ge.value=Je}}),et=Q(()=>{if(e.multiple&&!Bo(e.modelValue))return ms(e.modelValue).length===0&&!_.inputValue;const Je=on(e.modelValue)?e.modelValue[0]:e.modelValue;return e.filterable||Bo(Je)?!_.inputValue:!0}),rn=Q(()=>{var Je;const Pt=(Je=e.placeholder)!=null?Je:i("el.select.placeholder");return e.multiple||!Se.value?Pt:_.selectedLabel}),kt=Q(()=>nS?null:"mouseenter");Wt(()=>e.modelValue,(Je,Pt)=>{e.multiple&&e.filterable&&!e.reserveKeyword&&(_.inputValue="",zt("")),en(),!Gi(Je,Pt)&&e.validateEvent&&(Re==null||Re.validate("change").catch(vn=>void 0))},{flush:"post",deep:!0}),Wt(()=>ge.value,Je=>{Je?zt(_.inputValue):(_.inputValue="",_.previousQuery=null,_.isBeforeHide=!0),t("visible-change",Je)}),Wt(()=>_.options.entries(),()=>{var Je;if(!Hr)return;const Pt=((Je=x.value)==null?void 0:Je.querySelectorAll("input"))||[];(!e.filterable&&!e.defaultFirstOption&&!Bo(e.modelValue)||!Array.from(Pt).includes(document.activeElement))&&en(),e.defaultFirstOption&&(e.filterable||e.remote)&&mt.value&&Mt()},{flush:"post"}),Wt(()=>_.hoveringIndex,Je=>{Wn(Je)&&Je>-1?he.value=jt.value[Je]||{}:he.value={},jt.value.forEach(Pt=>{Pt.hover=he.value===Pt})}),ns(()=>{_.isBeforeHide||Pe()});const zt=Je=>{_.previousQuery===Je||Z.value||(_.previousQuery=Je,e.filterable&&Fn(e.filterMethod)?e.filterMethod(Je):e.filterable&&e.remote&&Fn(e.remoteMethod)&&e.remoteMethod(Je),e.defaultFirstOption&&(e.filterable||e.remote)&&mt.value?Vn(Mt):Vn(dn))},Mt=()=>{const Je=jt.value.filter(tr=>tr.visible&&!tr.disabled&&!tr.states.groupDisabled),Pt=Je.find(tr=>tr.created),vn=Je[0],Cn=jt.value.map(tr=>tr.value);_.hoveringIndex=gn(Cn,Pt||vn)},en=()=>{if(e.multiple)_.selectedLabel="";else{const Pt=on(e.modelValue)?e.modelValue[0]:e.modelValue,vn=sn(Pt);_.selectedLabel=vn.currentLabel,_.selected=[vn];return}const Je=[];Bo(e.modelValue)||ms(e.modelValue).forEach(Pt=>{Je.push(sn(Pt))}),_.selected=Je},sn=Je=>{let Pt;const vn=_v(Je);for(let hr=_.cachedOptions.size-1;hr>=0;hr--){const dr=Ht.value[hr];if(vn?mi(dr.value,e.valueKey)===mi(Je,e.valueKey):dr.value===Je){Pt={value:Je,currentLabel:dr.currentLabel,get isDisabled(){return dr.isDisabled}};break}}if(Pt)return Pt;const Cn=vn?Je.label:Je??"";return{value:Je,currentLabel:Cn}},dn=()=>{_.hoveringIndex=jt.value.findIndex(Je=>_.selected.some(Pt=>ke(Pt)===ke(Je)))},Pn=()=>{_.selectionWidth=o.value.getBoundingClientRect().width},Ot=()=>{_.calculatorWidth=z.value.getBoundingClientRect().width},Zt=()=>{_.collapseItemWidth=U.value.getBoundingClientRect().width},jn=()=>{var Je,Pt;(Pt=(Je=C.value)==null?void 0:Je.updatePopper)==null||Pt.call(Je)},ir=()=>{var Je,Pt;(Pt=(Je=k.value)==null?void 0:Je.updatePopper)==null||Pt.call(Je)},ur=()=>{_.inputValue.length>0&&!ge.value&&(ge.value=!0),zt(_.inputValue)},ar=Je=>{if(_.inputValue=Je.target.value,e.remote)wr();else return ur()},wr=Js(()=>{ur()},Lt.value),Xr=Je=>{Gi(e.modelValue,Je)||t(No,Je)},Rt=Je=>AO(Je,Pt=>{const vn=_.cachedOptions.get(Pt);return vn&&!vn.disabled&&!vn.states.groupDisabled}),_n=Je=>{if(e.multiple&&Je.code!==En.delete&&Je.target.value.length<=0){const Pt=ms(e.modelValue).slice(),vn=Rt(Pt);if(vn<0)return;const Cn=Pt[vn];Pt.splice(vn,1),t(xr,Pt),Xr(Pt),t("remove-tag",Cn)}},dt=(Je,Pt)=>{const vn=_.selected.indexOf(Pt);if(vn>-1&&!Me.value){const Cn=ms(e.modelValue).slice();Cn.splice(vn,1),t(xr,Cn),Xr(Cn),t("remove-tag",Pt.value)}Je.stopPropagation(),bo()},tn=Je=>{Je.stopPropagation();const Pt=e.multiple?[]:Ie.value;if(e.multiple)for(const vn of _.selected)vn.isDisabled&&Pt.push(vn.value);t(xr,Pt),Xr(Pt),_.hoveringIndex=-1,ge.value=!1,t("clear"),bo()},Ze=Je=>{var Pt;if(e.multiple){const vn=ms((Pt=e.modelValue)!=null?Pt:[]).slice(),Cn=gn(vn,Je);Cn>-1?vn.splice(Cn,1):(e.multipleLimit<=0||vn.length<e.multipleLimit)&&vn.push(Je.value),t(xr,vn),Xr(vn),Je.created&&zt(""),e.filterable&&!e.reserveKeyword&&(_.inputValue="")}else t(xr,Je.value),Xr(Je.value),ge.value=!1;bo(),!ge.value&&Vn(()=>{rr(Je)})},gn=(Je=[],Pt)=>Bo(Pt)?-1:Tr(Pt.value)?Je.findIndex(vn=>Gi(mi(vn,e.valueKey),ke(Pt))):Je.indexOf(Pt.value),rr=Je=>{var Pt,vn,Cn,tr,hr;const dr=on(Je)?Je[0]:Je;let fr=null;if(dr!=null&&dr.value){const Wr=jt.value.filter(ro=>ro.value===dr.value);Wr.length>0&&(fr=Wr[0].$el)}if(C.value&&fr){const Wr=(tr=(Cn=(vn=(Pt=C.value)==null?void 0:Pt.popperRef)==null?void 0:vn.contentRef)==null?void 0:Cn.querySelector)==null?void 0:tr.call(Cn,`.${d.be("dropdown","wrap")}`);Wr&&tC(Wr,fr)}(hr=te.value)==null||hr.handleScroll()},Hn=Je=>{_.options.set(Je.value,Je),_.cachedOptions.set(Je.value,Je)},eo=(Je,Pt)=>{_.options.get(Je)===Pt&&_.options.delete(Je)},Mi=Q(()=>{var Je,Pt;return(Pt=(Je=C.value)==null?void 0:Je.popperRef)==null?void 0:Pt.contentRef}),mo=()=>{_.isBeforeHide=!1,Vn(()=>rr(_.selected))},bo=()=>{var Je;(Je=A.value)==null||Je.focus()},Rr=()=>{var Je;if(ge.value){ge.value=!1,Vn(()=>{var Pt;return(Pt=A.value)==null?void 0:Pt.blur()});return}(Je=A.value)==null||Je.blur()},fi=Je=>{tn(Je)},_a=Je=>{if(ge.value=!1,le.value){const Pt=new FocusEvent("focus",Je);Vn(()=>pe(Pt))}},Ns=()=>{_.inputValue.length>0?_.inputValue="":ge.value=!1},Nt=()=>{Me.value||(nS&&(_.inputHovering=!0),_.menuVisibleOnFocus?_.menuVisibleOnFocus=!1:ge.value=!ge.value)},Te=()=>{if(!ge.value)Nt();else{const Je=jt.value[_.hoveringIndex];Je&&!Je.disabled&&!Je.states.groupDisabled&&Ze(Je)}},ke=Je=>Tr(Je.value)?mi(Je.value,e.valueKey):Je.value,Ke=Q(()=>jt.value.filter(Je=>Je.visible).every(Je=>Je.disabled)),lt=Q(()=>e.multiple?e.collapseTags?_.selected.slice(0,e.maxCollapseTags):_.selected:[]),nt=Q(()=>e.multiple?e.collapseTags?_.selected.slice(e.maxCollapseTags):[]:[]),xt=Je=>{if(!ge.value){ge.value=!0;return}if(!(_.options.size===0||_.filteredOptionsCount===0||Z.value)&&!Ke.value){Je==="next"?(_.hoveringIndex++,_.hoveringIndex===_.options.size&&(_.hoveringIndex=0)):Je==="prev"&&(_.hoveringIndex--,_.hoveringIndex<0&&(_.hoveringIndex=_.options.size-1));const Pt=jt.value[_.hoveringIndex];(Pt.disabled===!0||Pt.states.groupDisabled===!0||!Pt.visible)&&xt(Je),Vn(()=>rr(he.value))}},$t=()=>{if(!o.value)return 0;const Je=window.getComputedStyle(o.value);return Number.parseFloat(Je.gap||"6px")},Tt=Q(()=>{const Je=$t();return{maxWidth:`${U.value&&e.maxCollapseTags===1?_.selectionWidth-_.collapseItemWidth-Je:_.selectionWidth}px`}}),Vt=Q(()=>({maxWidth:`${_.selectionWidth}px`})),Yt=Q(()=>({width:`${Math.max(_.calculatorWidth,Dre)}px`}));return qo(o,Pn),qo(z,Ot),qo(F,jn),qo(de,jn),qo(G,ir),qo(U,Zt),vr(()=>{en()}),{inputId:Ye,contentId:a,nsSelect:d,nsInput:m,states:_,isFocused:le,expanded:ge,optionsArray:jt,hoverOption:he,selectSize:At,filteredOptionsCount:mt,resetCalculatorWidth:Ot,updateTooltip:jn,updateTagTooltip:ir,debouncedOnInputChange:wr,onInput:ar,deletePrevTag:_n,deleteTag:dt,deleteSelected:tn,handleOptionSelect:Ze,scrollToOption:rr,hasModelValue:Se,shouldShowPlaceholder:et,currentPlaceholder:rn,mouseEnterEventName:kt,needStatusIcon:ye,showClose:Ce,iconComponent:Fe,iconReverse:it,validateState:We,validateIcon:ut,showNewOption:Tn,updateOptions:Pe,collapseTagSize:He,setSelected:en,selectDisabled:Me,emptyText:Ft,handleCompositionStart:q,handleCompositionUpdate:X,handleCompositionEnd:ie,onOptionCreate:Hn,onOptionDestroy:eo,handleMenuEnter:mo,focus:bo,blur:Rr,handleClearClick:fi,handleClickOutside:_a,handleEsc:Ns,toggleMenu:Nt,selectOption:Te,getValueKey:ke,navigateOptions:xt,dropdownMenuVisible:pt,showTagList:lt,collapseTagList:nt,tagStyle:Tt,collapseTagStyle:Vt,inputStyle:Yt,popperRef:Mi,inputRef:A,tooltipRef:C,tagTooltipRef:k,calculatorRef:z,prefixRef:N,suffixRef:$,selectRef:x,wrapperRef:de,selectionRef:o,scrollbarRef:te,menuRef:F,tagMenuRef:G,collapseItemRef:U}};var Ore=Ge({name:"ElOptions",setup(e,{slots:t}){const i=kn(rm);let a=[];return()=>{var d,m;const _=(d=t.default)==null?void 0:d.call(t),x=[];function o(C){on(C)&&C.forEach(k=>{var A,z,N,$;const F=(A=(k==null?void 0:k.type)||{})==null?void 0:A.name;F==="ElOptionGroup"?o(!zn(k.children)&&!on(k.children)&&Fn((z=k.children)==null?void 0:z.default)?(N=k.children)==null?void 0:N.default():k.children):F==="ElOption"?x.push(($=k.props)==null?void 0:$.value):on(k.children)&&o(k.children)})}return _.length&&o((m=_[0])==null?void 0:m.children),Gi(x,a)||(a=x,i&&(i.states.optionValues=x)),_}}});const zre=ln({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:Ei,effect:{type:at(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:at(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:Li.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:wo,default:dd},fitInputWidth:Boolean,suffixIcon:{type:wo,default:Bc},tagType:{...Ah.type,default:"info"},tagEffect:{...Ah.effect,default:"light"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,showArrow:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:at(String),values:Fc,default:"bottom-start"},fallbackPlacements:{type:at(Array),default:["bottom-start","top-start","right","left"]},appendTo:String,...em,...qi(["ariaLabel"])}),AR="ElSelect",Bre=Ge({name:AR,componentName:AR,components:{ElSelectMenu:Rre,ElOption:YC,ElOptions:Ore,ElTag:zv,ElScrollbar:rc,ElTooltip:os,ElIcon:Dn},directives:{ClickOutside:Rc},props:zre,emits:[xr,No,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:t}){const i=Q(()=>{const{modelValue:_,multiple:x}=e,o=x?[]:void 0;return on(_)?x?_:o:x?o:_}),a=ao({...Bi(e),modelValue:i}),d=Lre(a,t);Br(rm,ao({props:a,states:d.states,optionsArray:d.optionsArray,handleOptionSelect:d.handleOptionSelect,onOptionCreate:d.onOptionCreate,onOptionDestroy:d.onOptionDestroy,selectRef:d.selectRef,setSelected:d.setSelected}));const m=Q(()=>e.multiple?d.states.selected.map(_=>_.currentLabel):d.states.selectedLabel);return{...d,modelValue:i,selectedLabel:m}}});function Fre(e,t,i,a,d,m){const _=Er("el-tag"),x=Er("el-tooltip"),o=Er("el-icon"),C=Er("el-option"),k=Er("el-options"),A=Er("el-scrollbar"),z=Er("el-select-menu"),N=Rb("click-outside");return mr((se(),Ae("div",{ref:"selectRef",class:ce([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),[ov(e.mouseEnterEventName)]:$=>e.states.inputHovering=!0,onMouseleave:$=>e.states.inputHovering=!1},[qe(x,{ref:"tooltipRef",visible:e.dropdownMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:$=>e.states.isBeforeHide=!1},{default:st(()=>{var $;return[Ve("div",{ref:"wrapperRef",class:ce([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:Yn(e.toggleMenu,["prevent"])},[e.$slots.prefix?(se(),Ae("div",{key:0,ref:"prefixRef",class:ce(e.nsSelect.e("prefix"))},[_t(e.$slots,"prefix")],2)):bt("v-if",!0),Ve("div",{ref:"selectionRef",class:ce([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.states.selected.length)])},[e.multiple?_t(e.$slots,"tag",{key:0},()=>[(se(!0),Ae(Bn,null,Fr(e.showTagList,F=>(se(),Ae("div",{key:e.getValueKey(F),class:ce(e.nsSelect.e("selected-item"))},[qe(_,{closable:!e.selectDisabled&&!F.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:Nn(e.tagStyle),onClose:G=>e.deleteTag(G,F)},{default:st(()=>[Ve("span",{class:ce(e.nsSelect.e("tags-text"))},[_t(e.$slots,"label",{label:F.currentLabel,value:F.value},()=>[$r(fn(F.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.states.selected.length>e.maxCollapseTags?(se(),It(x,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:st(()=>[Ve("div",{ref:"collapseItemRef",class:ce(e.nsSelect.e("selected-item"))},[qe(_,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:Nn(e.collapseTagStyle)},{default:st(()=>[Ve("span",{class:ce(e.nsSelect.e("tags-text"))}," + "+fn(e.states.selected.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:st(()=>[Ve("div",{ref:"tagMenuRef",class:ce(e.nsSelect.e("selection"))},[(se(!0),Ae(Bn,null,Fr(e.collapseTagList,F=>(se(),Ae("div",{key:e.getValueKey(F),class:ce(e.nsSelect.e("selected-item"))},[qe(_,{class:"in-tooltip",closable:!e.selectDisabled&&!F.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:G=>e.deleteTag(G,F)},{default:st(()=>[Ve("span",{class:ce(e.nsSelect.e("tags-text"))},[_t(e.$slots,"label",{label:F.currentLabel,value:F.value},()=>[$r(fn(F.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):bt("v-if",!0)]):bt("v-if",!0),e.selectDisabled?bt("v-if",!0):(se(),Ae("div",{key:1,class:ce([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[mr(Ve("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":F=>e.states.inputValue=F,type:"text",name:e.name,class:ce([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:Nn(e.inputStyle),role:"combobox",readonly:!e.filterable,spellcheck:"false","aria-activedescendant":(($=e.hoverOption)==null?void 0:$.id)||"","aria-controls":e.contentId,"aria-expanded":e.dropdownMenuVisible,"aria-label":e.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onKeydown:[Mo(Yn(F=>e.navigateOptions("next"),["stop","prevent"]),["down"]),Mo(Yn(F=>e.navigateOptions("prev"),["stop","prevent"]),["up"]),Mo(Yn(e.handleEsc,["stop","prevent"]),["esc"]),Mo(Yn(e.selectOption,["stop","prevent"]),["enter"]),Mo(Yn(e.deletePrevTag,["stop"]),["delete"])],onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onInput:e.onInput,onClick:Yn(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","name","disabled","autocomplete","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onClick"]),[[DT,e.states.inputValue]]),e.filterable?(se(),Ae("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:ce(e.nsSelect.e("input-calculator")),textContent:fn(e.states.inputValue)},null,10,["textContent"])):bt("v-if",!0)],2)),e.shouldShowPlaceholder?(se(),Ae("div",{key:2,class:ce([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?_t(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[Ve("span",null,fn(e.currentPlaceholder),1)]):(se(),Ae("span",{key:1},fn(e.currentPlaceholder),1))],2)):bt("v-if",!0)],2),Ve("div",{ref:"suffixRef",class:ce(e.nsSelect.e("suffix"))},[e.iconComponent&&!e.showClose?(se(),It(o,{key:0,class:ce([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:st(()=>[(se(),It(Ir(e.iconComponent)))]),_:1},8,["class"])):bt("v-if",!0),e.showClose&&e.clearIcon?(se(),It(o,{key:1,class:ce([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.nsSelect.e("clear")]),onClick:e.handleClearClick},{default:st(()=>[(se(),It(Ir(e.clearIcon)))]),_:1},8,["class","onClick"])):bt("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(se(),It(o,{key:2,class:ce([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:st(()=>[(se(),It(Ir(e.validateIcon)))]),_:1},8,["class"])):bt("v-if",!0)],2)],10,["onClick"])]}),content:st(()=>[qe(z,{ref:"menuRef"},{default:st(()=>[e.$slots.header?(se(),Ae("div",{key:0,class:ce(e.nsSelect.be("dropdown","header")),onClick:Yn(()=>{},["stop"])},[_t(e.$slots,"header")],10,["onClick"])):bt("v-if",!0),mr(qe(A,{id:e.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:ce([e.nsSelect.is("empty",e.filteredOptionsCount===0)]),role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical"},{default:st(()=>[e.showNewOption?(se(),It(C,{key:0,value:e.states.inputValue,created:!0},null,8,["value"])):bt("v-if",!0),qe(k,null,{default:st(()=>[_t(e.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label"]),[[no,e.states.options.size>0&&!e.loading]]),e.$slots.loading&&e.loading?(se(),Ae("div",{key:1,class:ce(e.nsSelect.be("dropdown","loading"))},[_t(e.$slots,"loading")],2)):e.loading||e.filteredOptionsCount===0?(se(),Ae("div",{key:2,class:ce(e.nsSelect.be("dropdown","empty"))},[_t(e.$slots,"empty",{},()=>[Ve("span",null,fn(e.emptyText),1)])],2)):bt("v-if",!0),e.$slots.footer?(se(),Ae("div",{key:3,class:ce(e.nsSelect.be("dropdown","footer")),onClick:Yn(()=>{},["stop"])},[_t(e.$slots,"footer")],10,["onClick"])):bt("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],16,["onMouseleave"])),[[N,e.handleClickOutside,e.popperRef]])}var Nre=hn(Bre,[["render",Fre],["__file","select.vue"]]);const $re=Ge({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(e){const t=Jt("select"),i=be(null),a=Cr(),d=be([]);Br(vz,ao({...Bi(e)}));const m=Q(()=>d.value.some(C=>C.visible===!0)),_=C=>{var k,A;return((k=C.type)==null?void 0:k.name)==="ElOption"&&!!((A=C.component)!=null&&A.proxy)},x=C=>{const k=ms(C),A=[];return k.forEach(z=>{var N,$;_(z)?A.push(z.component.proxy):(N=z.children)!=null&&N.length?A.push(...x(z.children)):($=z.component)!=null&&$.subTree&&A.push(...x(z.component.subTree))}),A},o=()=>{d.value=x(a.subTree)};return vr(()=>{o()}),GL(i,o,{attributes:!0,subtree:!0,childList:!0}),{groupRef:i,visible:m,ns:t}}});function Vre(e,t,i,a,d,m){return mr((se(),Ae("ul",{ref:"groupRef",class:ce(e.ns.be("group","wrap"))},[Ve("li",{class:ce(e.ns.be("group","title"))},fn(e.label),3),Ve("li",null,[Ve("ul",{class:ce(e.ns.b("group"))},[_t(e.$slots,"default")],2)])],2)),[[no,e.visible]])}var _z=hn($re,[["render",Vre],["__file","option-group.vue"]]);const Ph=cr(Nre,{Option:YC,OptionGroup:_z}),hb=Jo(YC),Ure=Jo(_z),XC=()=>kn(gz,{}),jre=ln({pageSize:{type:Number,required:!0},pageSizes:{type:at(Array),default:()=>Xo([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,teleported:Boolean,size:{type:String,values:tc},appendSizeTo:String}),Hre=Ge({name:"ElPaginationSizes"}),Gre=Ge({...Hre,props:jre,emits:["page-size-change"],setup(e,{emit:t}){const i=e,{t:a}=Gr(),d=Jt("pagination"),m=XC(),_=be(i.pageSize);Wt(()=>i.pageSizes,(C,k)=>{if(!Gi(C,k)&&on(C)){const A=C.includes(i.pageSize)?i.pageSize:i.pageSizes[0];t("page-size-change",A)}}),Wt(()=>i.pageSize,C=>{_.value=C});const x=Q(()=>i.pageSizes);function o(C){var k;C!==_.value&&(_.value=C,(k=m.handleSizeChange)==null||k.call(m,Number(C)))}return(C,k)=>(se(),Ae("span",{class:ce(y(d).e("sizes"))},[qe(y(Ph),{"model-value":_.value,disabled:C.disabled,"popper-class":C.popperClass,size:C.size,teleported:C.teleported,"validate-event":!1,"append-to":C.appendSizeTo,onChange:o},{default:st(()=>[(se(!0),Ae(Bn,null,Fr(y(x),A=>(se(),It(y(hb),{key:A,value:A,label:A+y(a)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","teleported","append-to"])],2))}});var Wre=hn(Gre,[["__file","sizes.vue"]]);const qre=ln({size:{type:String,values:tc}}),Kre=Ge({name:"ElPaginationJumper"}),Zre=Ge({...Kre,props:qre,setup(e){const{t}=Gr(),i=Jt("pagination"),{pageCount:a,disabled:d,currentPage:m,changeEvent:_}=XC(),x=be(),o=Q(()=>{var A;return(A=x.value)!=null?A:m==null?void 0:m.value});function C(A){x.value=A?+A:""}function k(A){A=Math.trunc(+A),_==null||_(A),x.value=void 0}return(A,z)=>(se(),Ae("span",{class:ce(y(i).e("jump")),disabled:y(d)},[Ve("span",{class:ce([y(i).e("goto")])},fn(y(t)("el.pagination.goto")),3),qe(y(vs),{size:A.size,class:ce([y(i).e("editor"),y(i).is("in-pagination")]),min:1,max:y(a),disabled:y(d),"model-value":y(o),"validate-event":!1,"aria-label":y(t)("el.pagination.page"),type:"number","onUpdate:modelValue":C,onChange:k},null,8,["size","class","max","disabled","model-value","aria-label"]),Ve("span",{class:ce([y(i).e("classifier")])},fn(y(t)("el.pagination.pageClassifier")),3)],10,["disabled"]))}});var Yre=hn(Zre,[["__file","jumper.vue"]]);const Xre=ln({total:{type:Number,default:1e3}}),Jre=Ge({name:"ElPaginationTotal"}),Qre=Ge({...Jre,props:Xre,setup(e){const{t}=Gr(),i=Jt("pagination"),{disabled:a}=XC();return(d,m)=>(se(),Ae("span",{class:ce(y(i).e("total")),disabled:y(a)},fn(y(t)("el.pagination.total",{total:d.total})),11,["disabled"]))}});var eoe=hn(Qre,[["__file","total.vue"]]);const toe=ln({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),noe=Ge({name:"ElPaginationPager"}),roe=Ge({...noe,props:toe,emits:["change"],setup(e,{emit:t}){const i=e,a=Jt("pager"),d=Jt("icon"),{t:m}=Gr(),_=be(!1),x=be(!1),o=be(!1),C=be(!1),k=be(!1),A=be(!1),z=Q(()=>{const q=i.pagerCount,X=(q-1)/2,ie=Number(i.currentPage),de=Number(i.pageCount);let le=!1,pe=!1;de>q&&(ie>q-X&&(le=!0),ie<de-X&&(pe=!0));const ge=[];if(le&&!pe){const he=de-(q-2);for(let ue=he;ue<de;ue++)ge.push(ue)}else if(!le&&pe)for(let he=2;he<q;he++)ge.push(he);else if(le&&pe){const he=Math.floor(q/2)-1;for(let ue=ie-he;ue<=ie+he;ue++)ge.push(ue)}else for(let he=2;he<de;he++)ge.push(he);return ge}),N=Q(()=>["more","btn-quickprev",d.b(),a.is("disabled",i.disabled)]),$=Q(()=>["more","btn-quicknext",d.b(),a.is("disabled",i.disabled)]),F=Q(()=>i.disabled?-1:0);ns(()=>{const q=(i.pagerCount-1)/2;_.value=!1,x.value=!1,i.pageCount>i.pagerCount&&(i.currentPage>i.pagerCount-q&&(_.value=!0),i.currentPage<i.pageCount-q&&(x.value=!0))});function G(q=!1){i.disabled||(q?o.value=!0:C.value=!0)}function U(q=!1){q?k.value=!0:A.value=!0}function te(q){const X=q.target;if(X.tagName.toLowerCase()==="li"&&Array.from(X.classList).includes("number")){const ie=Number(X.textContent);ie!==i.currentPage&&t("change",ie)}else X.tagName.toLowerCase()==="li"&&Array.from(X.classList).includes("more")&&Z(q)}function Z(q){const X=q.target;if(X.tagName.toLowerCase()==="ul"||i.disabled)return;let ie=Number(X.textContent);const de=i.pageCount,le=i.currentPage,pe=i.pagerCount-2;X.className.includes("more")&&(X.className.includes("quickprev")?ie=le-pe:X.className.includes("quicknext")&&(ie=le+pe)),Number.isNaN(+ie)||(ie<1&&(ie=1),ie>de&&(ie=de)),ie!==le&&t("change",ie)}return(q,X)=>(se(),Ae("ul",{class:ce(y(a).b()),onClick:Z,onKeyup:Mo(te,["enter"])},[q.pageCount>0?(se(),Ae("li",{key:0,class:ce([[y(a).is("active",q.currentPage===1),y(a).is("disabled",q.disabled)],"number"]),"aria-current":q.currentPage===1,"aria-label":y(m)("el.pagination.currentPage",{pager:1}),tabindex:y(F)}," 1 ",10,["aria-current","aria-label","tabindex"])):bt("v-if",!0),_.value?(se(),Ae("li",{key:1,class:ce(y(N)),tabindex:y(F),"aria-label":y(m)("el.pagination.prevPages",{pager:q.pagerCount-2}),onMouseenter:ie=>G(!0),onMouseleave:ie=>o.value=!1,onFocus:ie=>U(!0),onBlur:ie=>k.value=!1},[(o.value||k.value)&&!q.disabled?(se(),It(y(rd),{key:0})):(se(),It(y(yP),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):bt("v-if",!0),(se(!0),Ae(Bn,null,Fr(y(z),ie=>(se(),Ae("li",{key:ie,class:ce([[y(a).is("active",q.currentPage===ie),y(a).is("disabled",q.disabled)],"number"]),"aria-current":q.currentPage===ie,"aria-label":y(m)("el.pagination.currentPage",{pager:ie}),tabindex:y(F)},fn(ie),11,["aria-current","aria-label","tabindex"]))),128)),x.value?(se(),Ae("li",{key:2,class:ce(y($)),tabindex:y(F),"aria-label":y(m)("el.pagination.nextPages",{pager:q.pagerCount-2}),onMouseenter:ie=>G(),onMouseleave:ie=>C.value=!1,onFocus:ie=>U(),onBlur:ie=>A.value=!1},[(C.value||A.value)&&!q.disabled?(se(),It(y(od),{key:0})):(se(),It(y(yP),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):bt("v-if",!0),q.pageCount>1?(se(),Ae("li",{key:3,class:ce([[y(a).is("active",q.currentPage===q.pageCount),y(a).is("disabled",q.disabled)],"number"]),"aria-current":q.currentPage===q.pageCount,"aria-label":y(m)("el.pagination.currentPage",{pager:q.pageCount}),tabindex:y(F)},fn(q.pageCount),11,["aria-current","aria-label","tabindex"])):bt("v-if",!0)],42,["onKeyup"]))}});var ooe=hn(roe,[["__file","pager.vue"]]);const ks=e=>typeof e!="number",ioe=ln({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:e=>Wn(e)&&Math.trunc(e)===e&&e>4&&e<22&&e%2===1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:at(Array),default:()=>Xo([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:wo,default:()=>nd},nextText:{type:String,default:""},nextIcon:{type:wo,default:()=>Os},teleported:{type:Boolean,default:!0},small:Boolean,size:Ei,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean,appendSizeTo:String}),soe={"update:current-page":e=>Wn(e),"update:page-size":e=>Wn(e),"size-change":e=>Wn(e),change:(e,t)=>Wn(e)&&Wn(t),"current-change":e=>Wn(e),"prev-click":e=>Wn(e),"next-click":e=>Wn(e)},PR="ElPagination";var aoe=Ge({name:PR,props:ioe,emits:soe,setup(e,{emit:t,slots:i}){const{t:a}=Gr(),d=Jt("pagination"),m=Cr().vnode.props||{},_=w4(),x=Q(()=>{var X;return e.small?"small":(X=e.size)!=null?X:_.value});Ku({from:"small",replacement:"size",version:"3.0.0",scope:"el-pagination",ref:"https://element-plus.org/zh-CN/component/pagination.html"},Q(()=>!!e.small));const o="onUpdate:currentPage"in m||"onUpdate:current-page"in m||"onCurrentChange"in m,C="onUpdate:pageSize"in m||"onUpdate:page-size"in m||"onSizeChange"in m,k=Q(()=>{if(ks(e.total)&&ks(e.pageCount)||!ks(e.currentPage)&&!o)return!1;if(e.layout.includes("sizes")){if(ks(e.pageCount)){if(!ks(e.total)&&!ks(e.pageSize)&&!C)return!1}else if(!C)return!1}return!0}),A=be(ks(e.defaultPageSize)?10:e.defaultPageSize),z=be(ks(e.defaultCurrentPage)?1:e.defaultCurrentPage),N=Q({get(){return ks(e.pageSize)?A.value:e.pageSize},set(X){ks(e.pageSize)&&(A.value=X),C&&(t("update:page-size",X),t("size-change",X))}}),$=Q(()=>{let X=0;return ks(e.pageCount)?ks(e.total)||(X=Math.max(1,Math.ceil(e.total/N.value))):X=e.pageCount,X}),F=Q({get(){return ks(e.currentPage)?z.value:e.currentPage},set(X){let ie=X;X<1?ie=1:X>$.value&&(ie=$.value),ks(e.currentPage)&&(z.value=ie),o&&(t("update:current-page",ie),t("current-change",ie))}});Wt($,X=>{F.value>X&&(F.value=X)}),Wt([F,N],X=>{t("change",...X)},{flush:"post"});function G(X){F.value=X}function U(X){N.value=X;const ie=$.value;F.value>ie&&(F.value=ie)}function te(){e.disabled||(F.value-=1,t("prev-click",F.value))}function Z(){e.disabled||(F.value+=1,t("next-click",F.value))}function q(X,ie){X&&(X.props||(X.props={}),X.props.class=[X.props.class,ie].join(" "))}return Br(gz,{pageCount:$,disabled:Q(()=>e.disabled),currentPage:F,changeEvent:G,handleSizeChange:U}),()=>{var X,ie;if(!k.value)return a("el.pagination.deprecationWarning"),null;if(!e.layout||e.hideOnSinglePage&&$.value<=1)return null;const de=[],le=[],pe=Kn("div",{class:d.e("rightwrapper")},le),ge={prev:Kn(wre,{disabled:e.disabled,currentPage:F.value,prevText:e.prevText,prevIcon:e.prevIcon,onClick:te}),jumper:Kn(Yre,{size:x.value}),pager:Kn(ooe,{currentPage:F.value,pageCount:$.value,pagerCount:e.pagerCount,onChange:G,disabled:e.disabled}),next:Kn(Ere,{disabled:e.disabled,currentPage:F.value,pageCount:$.value,nextText:e.nextText,nextIcon:e.nextIcon,onClick:Z}),sizes:Kn(Wre,{pageSize:N.value,pageSizes:e.pageSizes,popperClass:e.popperClass,disabled:e.disabled,teleported:e.teleported,size:x.value,appendSizeTo:e.appendSizeTo}),slot:(ie=(X=i==null?void 0:i.default)==null?void 0:X.call(i))!=null?ie:null,total:Kn(eoe,{total:ks(e.total)?0:e.total})},he=e.layout.split(",").map(Re=>Re.trim());let ue=!1;return he.forEach(Re=>{if(Re==="->"){ue=!0;return}ue?le.push(ge[Re]):de.push(ge[Re])}),q(de[0],d.is("first")),q(de[de.length-1],d.is("last")),ue&&le.length>0&&(q(le[0],d.is("first")),q(le[le.length-1],d.is("last")),de.push(pe)),Kn("div",{class:[d.b(),d.is("background",e.background),d.m(x.value)]},de)}}});const loe=cr(aoe),coe=ln({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:bS,default:"primary"},cancelButtonType:{type:String,values:bS,default:"text"},icon:{type:wo,default:()=>qG},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:Li.teleported,persistent:Li.persistent,width:{type:[String,Number],default:150}}),uoe={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},doe=Ge({name:"ElPopconfirm"}),hoe=Ge({...doe,props:coe,emits:uoe,setup(e,{emit:t}){const i=e,{t:a}=Gr(),d=Jt("popconfirm"),m=be(),_=()=>{var z,N;(N=(z=m.value)==null?void 0:z.onClose)==null||N.call(z)},x=Q(()=>({width:li(i.width)})),o=z=>{t("confirm",z),_()},C=z=>{t("cancel",z),_()},k=Q(()=>i.confirmButtonText||a("el.popconfirm.confirmButtonText")),A=Q(()=>i.cancelButtonText||a("el.popconfirm.cancelButtonText"));return(z,N)=>(se(),It(y(os),kr({ref_key:"tooltipRef",ref:m,trigger:"click",effect:"light"},z.$attrs,{"popper-class":`${y(d).namespace.value}-popover`,"popper-style":y(x),teleported:z.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":z.hideAfter,persistent:z.persistent}),{content:st(()=>[Ve("div",{class:ce(y(d).b())},[Ve("div",{class:ce(y(d).e("main"))},[!z.hideIcon&&z.icon?(se(),It(y(Dn),{key:0,class:ce(y(d).e("icon")),style:Nn({color:z.iconColor})},{default:st(()=>[(se(),It(Ir(z.icon)))]),_:1},8,["class","style"])):bt("v-if",!0),$r(" "+fn(z.title),1)],2),Ve("div",{class:ce(y(d).e("action"))},[_t(z.$slots,"actions",{confirm:o,cancel:C},()=>[qe(y(zi),{size:"small",type:z.cancelButtonType==="text"?"":z.cancelButtonType,text:z.cancelButtonType==="text",onClick:C},{default:st(()=>[$r(fn(y(A)),1)]),_:1},8,["type","text"]),qe(y(zi),{size:"small",type:z.confirmButtonType==="text"?"":z.confirmButtonType,text:z.confirmButtonType==="text",onClick:o},{default:st(()=>[$r(fn(y(k)),1)]),_:1},8,["type","text"])])],2)],2)]),default:st(()=>[z.$slots.reference?_t(z.$slots,"reference",{key:0}):bt("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var foe=hn(hoe,[["__file","popconfirm.vue"]]);const poe=cr(foe),moe=ln({trigger:Ov.trigger,placement:B0.placement,disabled:Ov.disabled,visible:Li.visible,transition:Li.transition,popperOptions:B0.popperOptions,tabindex:B0.tabindex,content:Li.content,popperStyle:Li.popperStyle,popperClass:Li.popperClass,enterable:{...Li.enterable,default:!0},effect:{...Li.effect,default:"light"},teleported:Li.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),goe={"update:visible":e=>ko(e),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},voe="onUpdate:visible",_oe=Ge({name:"ElPopover"}),yoe=Ge({..._oe,props:moe,emits:goe,setup(e,{expose:t,emit:i}){const a=e,d=Q(()=>a[voe]),m=Jt("popover"),_=be(),x=Q(()=>{var G;return(G=y(_))==null?void 0:G.popperRef}),o=Q(()=>[{width:li(a.width)},a.popperStyle]),C=Q(()=>[m.b(),a.popperClass,{[m.m("plain")]:!!a.content}]),k=Q(()=>a.transition===`${m.namespace.value}-fade-in-linear`),A=()=>{var G;(G=_.value)==null||G.hide()},z=()=>{i("before-enter")},N=()=>{i("before-leave")},$=()=>{i("after-enter")},F=()=>{i("update:visible",!1),i("after-leave")};return t({popperRef:x,hide:A}),(G,U)=>(se(),It(y(os),kr({ref_key:"tooltipRef",ref:_},G.$attrs,{trigger:G.trigger,placement:G.placement,disabled:G.disabled,visible:G.visible,transition:G.transition,"popper-options":G.popperOptions,tabindex:G.tabindex,content:G.content,offset:G.offset,"show-after":G.showAfter,"hide-after":G.hideAfter,"auto-close":G.autoClose,"show-arrow":G.showArrow,"aria-label":G.title,effect:G.effect,enterable:G.enterable,"popper-class":y(C),"popper-style":y(o),teleported:G.teleported,persistent:G.persistent,"gpu-acceleration":y(k),"onUpdate:visible":y(d),onBeforeShow:z,onBeforeHide:N,onShow:$,onHide:F}),{content:st(()=>[G.title?(se(),Ae("div",{key:0,class:ce(y(m).e("title")),role:"title"},fn(G.title),3)):bt("v-if",!0),_t(G.$slots,"default",{},()=>[$r(fn(G.content),1)])]),default:st(()=>[G.$slots.reference?_t(G.$slots,"reference",{key:0}):bt("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var boe=hn(yoe,[["__file","popover.vue"]]);const RR=(e,t)=>{const i=t.arg||t.value,a=i==null?void 0:i.popperRef;a&&(a.triggerRef=e)};var xoe={mounted(e,t){RR(e,t)},updated(e,t){RR(e,t)}};const woe="popover",yz=vW(xoe,woe),Soe=cr(boe,{directive:yz}),Toe=ln({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:at(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:at([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:at(Function),default:e=>`${e}%`}}),Coe=Ge({name:"ElProgress"}),Eoe=Ge({...Coe,props:Toe,setup(e){const t=e,i={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},a=Jt("progress"),d=Q(()=>{const Z={width:`${t.percentage}%`,animationDuration:`${t.duration}s`},q=te(t.percentage);return q.includes("gradient")?Z.background=q:Z.backgroundColor=q,Z}),m=Q(()=>(t.strokeWidth/t.width*100).toFixed(1)),_=Q(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(m.value)/2}`,10):0),x=Q(()=>{const Z=_.value,q=t.type==="dashboard";return`
          M 50 50
          m 0 ${q?"":"-"}${Z}
          a ${Z} ${Z} 0 1 1 0 ${q?"-":""}${Z*2}
          a ${Z} ${Z} 0 1 1 0 ${q?"":"-"}${Z*2}
          `}),o=Q(()=>2*Math.PI*_.value),C=Q(()=>t.type==="dashboard"?.75:1),k=Q(()=>`${-1*o.value*(1-C.value)/2}px`),A=Q(()=>({strokeDasharray:`${o.value*C.value}px, ${o.value}px`,strokeDashoffset:k.value})),z=Q(()=>({strokeDasharray:`${o.value*C.value*(t.percentage/100)}px, ${o.value}px`,strokeDashoffset:k.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),N=Q(()=>{let Z;return t.color?Z=te(t.percentage):Z=i[t.status]||i.default,Z}),$=Q(()=>t.status==="warning"?jb:t.type==="line"?t.status==="success"?rC:dd:t.status==="success"?n_:vl),F=Q(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),G=Q(()=>t.format(t.percentage));function U(Z){const q=100/Z.length;return Z.map((ie,de)=>zn(ie)?{color:ie,percentage:(de+1)*q}:ie).sort((ie,de)=>ie.percentage-de.percentage)}const te=Z=>{var q;const{color:X}=t;if(Fn(X))return X(Z);if(zn(X))return X;{const ie=U(X);for(const de of ie)if(de.percentage>Z)return de.color;return(q=ie[ie.length-1])==null?void 0:q.color}};return(Z,q)=>(se(),Ae("div",{class:ce([y(a).b(),y(a).m(Z.type),y(a).is(Z.status),{[y(a).m("without-text")]:!Z.showText,[y(a).m("text-inside")]:Z.textInside}]),role:"progressbar","aria-valuenow":Z.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[Z.type==="line"?(se(),Ae("div",{key:0,class:ce(y(a).b("bar"))},[Ve("div",{class:ce(y(a).be("bar","outer")),style:Nn({height:`${Z.strokeWidth}px`})},[Ve("div",{class:ce([y(a).be("bar","inner"),{[y(a).bem("bar","inner","indeterminate")]:Z.indeterminate},{[y(a).bem("bar","inner","striped")]:Z.striped},{[y(a).bem("bar","inner","striped-flow")]:Z.stripedFlow}]),style:Nn(y(d))},[(Z.showText||Z.$slots.default)&&Z.textInside?(se(),Ae("div",{key:0,class:ce(y(a).be("bar","innerText"))},[_t(Z.$slots,"default",{percentage:Z.percentage},()=>[Ve("span",null,fn(y(G)),1)])],2)):bt("v-if",!0)],6)],6)],2)):(se(),Ae("div",{key:1,class:ce(y(a).b("circle")),style:Nn({height:`${Z.width}px`,width:`${Z.width}px`})},[(se(),Ae("svg",{viewBox:"0 0 100 100"},[Ve("path",{class:ce(y(a).be("circle","track")),d:y(x),stroke:`var(${y(a).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":Z.strokeLinecap,"stroke-width":y(m),fill:"none",style:Nn(y(A))},null,14,["d","stroke","stroke-linecap","stroke-width"]),Ve("path",{class:ce(y(a).be("circle","path")),d:y(x),stroke:y(N),fill:"none",opacity:Z.percentage?1:0,"stroke-linecap":Z.strokeLinecap,"stroke-width":y(m),style:Nn(y(z))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(Z.showText||Z.$slots.default)&&!Z.textInside?(se(),Ae("div",{key:2,class:ce(y(a).e("text")),style:Nn({fontSize:`${y(F)}px`})},[_t(Z.$slots,"default",{percentage:Z.percentage},()=>[Z.status?(se(),It(y(Dn),{key:1},{default:st(()=>[(se(),It(Ir(y($))))]),_:1})):(se(),Ae("span",{key:0},fn(y(G)),1))])],6)):bt("v-if",!0)],10,["aria-valuenow"]))}});var Moe=hn(Eoe,[["__file","progress.vue"]]);const bz=cr(Moe),Ioe=ln({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:at([Array,Object]),default:()=>Xo(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:at([Array,Object]),default:()=>[c0,c0,c0]},voidIcon:{type:wo,default:()=>lW},disabledVoidIcon:{type:wo,default:()=>c0},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:at(Array),default:()=>Xo(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:Ei,clearable:Boolean,...qi(["ariaLabel"])}),koe={[No]:e=>Wn(e),[xr]:e=>Wn(e)},Aoe=Ge({name:"ElRate"}),Poe=Ge({...Aoe,props:Ioe,emits:koe,setup(e,{expose:t,emit:i}){const a=e;function d(fe,Me){const Se=Fe=>Tr(Fe),ye=Object.keys(Me).map(Fe=>+Fe).filter(Fe=>{const it=Me[Fe];return(Se(it)?it.excluded:!1)?fe<Fe:fe<=Fe}).sort((Fe,it)=>Fe-it),Ce=Me[ye[0]];return Se(Ce)&&Ce.value||Ce}const m=kn(Fh,void 0),_=kn(Xl,void 0),x=xi(),o=Jt("rate"),{inputId:C,isLabeledByFormItem:k}=Sl(a,{formItemContext:_}),A=be(a.modelValue),z=be(-1),N=be(!0),$=Q(()=>[o.b(),o.m(x.value)]),F=Q(()=>a.disabled||(m==null?void 0:m.disabled)),G=Q(()=>o.cssVarBlock({"void-color":a.voidColor,"disabled-void-color":a.disabledVoidColor,"fill-color":q.value})),U=Q(()=>{let fe="";return a.showScore?fe=a.scoreTemplate.replace(/\{\s*value\s*\}/,F.value?`${a.modelValue}`:`${A.value}`):a.showText&&(fe=a.texts[Math.ceil(A.value)-1]),fe}),te=Q(()=>a.modelValue*100-Math.floor(a.modelValue)*100),Z=Q(()=>on(a.colors)?{[a.lowThreshold]:a.colors[0],[a.highThreshold]:{value:a.colors[1],excluded:!0},[a.max]:a.colors[2]}:a.colors),q=Q(()=>{const fe=d(A.value,Z.value);return Tr(fe)?"":fe}),X=Q(()=>{let fe="";return F.value?fe=`${te.value}%`:a.allowHalf&&(fe="50%"),{color:q.value,width:fe}}),ie=Q(()=>{let fe=on(a.icons)?[...a.icons]:{...a.icons};return fe=Wu(fe),on(fe)?{[a.lowThreshold]:fe[0],[a.highThreshold]:{value:fe[1],excluded:!0},[a.max]:fe[2]}:fe}),de=Q(()=>d(a.modelValue,ie.value)),le=Q(()=>F.value?zn(a.disabledVoidIcon)?a.disabledVoidIcon:Wu(a.disabledVoidIcon):zn(a.voidIcon)?a.voidIcon:Wu(a.voidIcon)),pe=Q(()=>d(A.value,ie.value));function ge(fe){const Me=F.value&&te.value>0&&fe-1<a.modelValue&&fe>a.modelValue,Se=a.allowHalf&&N.value&&fe-.5<=A.value&&fe>A.value;return Me||Se}function he(fe){a.clearable&&fe===a.modelValue&&(fe=0),i(xr,fe),a.modelValue!==fe&&i("change",fe)}function ue(fe){F.value||(a.allowHalf&&N.value?he(A.value):he(fe))}function Re(fe){if(F.value)return;let Me=A.value;const Se=fe.code;return Se===En.up||Se===En.right?(a.allowHalf?Me+=.5:Me+=1,fe.stopPropagation(),fe.preventDefault()):(Se===En.left||Se===En.down)&&(a.allowHalf?Me-=.5:Me-=1,fe.stopPropagation(),fe.preventDefault()),Me=Me<0?0:Me,Me=Me>a.max?a.max:Me,i(xr,Me),i("change",Me),Me}function Ye(fe,Me){if(!F.value){if(a.allowHalf&&Me){let Se=Me.target;Ks(Se,o.e("item"))&&(Se=Se.querySelector(`.${o.e("icon")}`)),(Se.clientWidth===0||Ks(Se,o.e("decimal")))&&(Se=Se.parentNode),N.value=Me.offsetX*2<=Se.clientWidth,A.value=N.value?fe-.5:fe}else A.value=fe;z.value=fe}}function Ie(){F.value||(a.allowHalf&&(N.value=a.modelValue!==Math.floor(a.modelValue)),A.value=a.modelValue,z.value=-1)}return Wt(()=>a.modelValue,fe=>{A.value=fe,N.value=a.modelValue!==Math.floor(a.modelValue)}),a.modelValue||i(xr,0),t({setCurrentValue:Ye,resetCurrentValue:Ie}),(fe,Me)=>{var Se;return se(),Ae("div",{id:y(C),class:ce([y($),y(o).is("disabled",y(F))]),role:"slider","aria-label":y(k)?void 0:fe.ariaLabel||"rating","aria-labelledby":y(k)?(Se=y(_))==null?void 0:Se.labelId:void 0,"aria-valuenow":A.value,"aria-valuetext":y(U)||void 0,"aria-valuemin":"0","aria-valuemax":fe.max,tabindex:"0",style:Nn(y(G)),onKeydown:Re},[(se(!0),Ae(Bn,null,Fr(fe.max,(ye,Ce)=>(se(),Ae("span",{key:Ce,class:ce(y(o).e("item")),onMousemove:Fe=>Ye(ye,Fe),onMouseleave:Ie,onClick:Fe=>ue(ye)},[qe(y(Dn),{class:ce([y(o).e("icon"),{hover:z.value===ye},y(o).is("active",ye<=A.value)])},{default:st(()=>[ge(ye)?bt("v-if",!0):(se(),Ae(Bn,{key:0},[mr((se(),It(Ir(y(pe)),null,null,512)),[[no,ye<=A.value]]),mr((se(),It(Ir(y(le)),null,null,512)),[[no,!(ye<=A.value)]])],64)),ge(ye)?(se(),Ae(Bn,{key:1},[(se(),It(Ir(y(le)),{class:ce([y(o).em("decimal","box")])},null,8,["class"])),qe(y(Dn),{style:Nn(y(X)),class:ce([y(o).e("icon"),y(o).e("decimal")])},{default:st(()=>[(se(),It(Ir(y(de))))]),_:1},8,["style","class"])],64)):bt("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),fe.showText||fe.showScore?(se(),Ae("span",{key:0,class:ce(y(o).e("text")),style:Nn({color:fe.textColor})},fn(y(U)),7)):bt("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}});var Roe=hn(Poe,[["__file","rate.vue"]]);const Doe=cr(Roe),hp={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},DR={[hp.success]:bG,[hp.warning]:jb,[hp.error]:oC,[hp.info]:iC},Loe=ln({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["success","warning","info","error"],default:"info"}}),Ooe=Ge({name:"ElResult"}),zoe=Ge({...Ooe,props:Loe,setup(e){const t=e,i=Jt("result"),a=Q(()=>{const d=t.icon,m=d&&hp[d]?hp[d]:"icon-info",_=DR[m]||DR["icon-info"];return{class:m,component:_}});return(d,m)=>(se(),Ae("div",{class:ce(y(i).b())},[Ve("div",{class:ce(y(i).e("icon"))},[_t(d.$slots,"icon",{},()=>[y(a).component?(se(),It(Ir(y(a).component),{key:0,class:ce(y(a).class)},null,8,["class"])):bt("v-if",!0)])],2),d.title||d.$slots.title?(se(),Ae("div",{key:0,class:ce(y(i).e("title"))},[_t(d.$slots,"title",{},()=>[Ve("p",null,fn(d.title),1)])],2)):bt("v-if",!0),d.subTitle||d.$slots["sub-title"]?(se(),Ae("div",{key:1,class:ce(y(i).e("subtitle"))},[_t(d.$slots,"sub-title",{},()=>[Ve("p",null,fn(d.subTitle),1)])],2)):bt("v-if",!0),d.$slots.extra?(se(),Ae("div",{key:2,class:ce(y(i).e("extra"))},[_t(d.$slots,"extra")],2)):bt("v-if",!0)],2))}});var Boe=hn(zoe,[["__file","result.vue"]]);const Foe=cr(Boe);var LR=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Noe(e,t){return!!(e===t||LR(e)&&LR(t))}function $oe(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!Noe(e[i],t[i]))return!1;return!0}function Voe(e,t){t===void 0&&(t=$oe);var i=null;function a(){for(var d=[],m=0;m<arguments.length;m++)d[m]=arguments[m];if(i&&i.lastThis===this&&t(d,i.lastArgs))return i.lastResult;var _=e.apply(this,d);return i={lastResult:_,lastArgs:d,lastThis:this},_}return a.clear=function(){i=null},a}const xz=()=>{const t=Cr().proxy.$props;return Q(()=>{const i=(a,d,m)=>({});return t.perfMode?Nb(i):Voe(i)})},jS=50,fb="itemRendered",pb="scroll",fp="forward",mb="backward",za="auto",i1="smart",Nv="start",Hl="center",$v="end",Vp="horizontal",JC="vertical",Uoe="ltr",Cp="rtl",Vv="negative",QC="positive-ascending",eE="positive-descending",joe={[Vp]:"left",[JC]:"top"},Hoe=20,Goe={[Vp]:"deltaX",[JC]:"deltaY"},Woe=({atEndEdge:e,atStartEdge:t,layout:i},a)=>{let d,m=0;const _=o=>o<0&&t.value||o>0&&e.value;return{hasReachedEdge:_,onWheel:o=>{Mh(d);const C=o[Goe[i.value]];_(m)&&_(m+C)||(m+=C,zT()||o.preventDefault(),d=td(()=>{a(m),m=0}))}}},HS=xl({type:at([Number,Function]),required:!0}),GS=xl({type:Number}),WS=xl({type:Number,default:2}),qoe=xl({type:String,values:["ltr","rtl"],default:"ltr"}),qS=xl({type:Number,default:0}),gb=xl({type:Number,required:!0}),wz=xl({type:String,values:["horizontal","vertical"],default:JC}),Sz=ln({className:{type:String,default:""},containerElement:{type:at([String,Object]),default:"div"},data:{type:at(Array),default:()=>Xo([])},direction:qoe,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:at([Object,String,Array])},useIsScrolling:{type:Boolean,default:!1},width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:{type:Boolean,default:!1}}),Tz=ln({cache:WS,estimatedItemSize:GS,layout:wz,initScrollOffset:qS,total:gb,itemSize:HS,...Sz}),KS={type:Number,default:6},Cz={type:Number,default:0},Ez={type:Number,default:2},bh=ln({columnCache:WS,columnWidth:HS,estimatedColumnWidth:GS,estimatedRowHeight:GS,initScrollLeft:qS,initScrollTop:qS,itemKey:{type:at(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:WS,rowHeight:HS,totalColumn:gb,totalRow:gb,hScrollbarSize:KS,vScrollbarSize:KS,scrollbarStartGap:Cz,scrollbarEndGap:Ez,role:String,...Sz}),Mz=ln({alwaysOn:Boolean,class:String,layout:wz,total:gb,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:KS,startGap:Cz,endGap:Ez,visible:Boolean}),fh=(e,t)=>e<t?fp:mb,Uv=e=>e===Uoe||e===Cp||e===Vp,OR=e=>e===Cp;let op=null;function vb(e=!1){if(op===null||e){const t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",i.direction="rtl";const a=document.createElement("div"),d=a.style;return d.width="100px",d.height="100px",t.appendChild(a),document.body.appendChild(t),t.scrollLeft>0?op=eE:(t.scrollLeft=1,t.scrollLeft===0?op=Vv:op=QC),document.body.removeChild(t),op}return op}function Koe({move:e,size:t,bar:i},a){const d={},m=`translate${i.axis}(${e}px)`;return d[i.size]=t,d.transform=m,d.msTransform=m,d.webkitTransform=m,a==="horizontal"?d.height="100%":d.width="100%",d}const ZS=Ge({name:"ElVirtualScrollBar",props:Mz,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const i=Q(()=>e.startGap+e.endGap),a=Jt("virtual-scrollbar"),d=Jt("scrollbar"),m=be(),_=be();let x=null,o=null;const C=ao({isDragging:!1,traveled:0}),k=Q(()=>I4[e.layout]),A=Q(()=>e.clientSize-y(i)),z=Q(()=>({position:"absolute",width:`${Vp===e.layout?A.value:e.scrollbarSize}px`,height:`${Vp===e.layout?e.scrollbarSize:A.value}px`,[joe[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),N=Q(()=>{const ie=e.ratio,de=e.clientSize;if(ie>=100)return Number.POSITIVE_INFINITY;if(ie>=50)return ie*de/100;const le=de/3;return Math.floor(Math.min(Math.max(ie*de,Hoe),le))}),$=Q(()=>{if(!Number.isFinite(N.value))return{display:"none"};const ie=`${N.value}px`;return Koe({bar:k.value,size:ie,move:C.traveled},e.layout)}),F=Q(()=>Math.floor(e.clientSize-N.value-y(i))),G=()=>{window.addEventListener("mousemove",q),window.addEventListener("mouseup",Z);const ie=y(_);ie&&(o=document.onselectstart,document.onselectstart=()=>!1,ie.addEventListener("touchmove",q,{passive:!0}),ie.addEventListener("touchend",Z))},U=()=>{window.removeEventListener("mousemove",q),window.removeEventListener("mouseup",Z),document.onselectstart=o,o=null;const ie=y(_);ie&&(ie.removeEventListener("touchmove",q),ie.removeEventListener("touchend",Z))},te=ie=>{ie.stopImmediatePropagation(),!(ie.ctrlKey||[1,2].includes(ie.button))&&(C.isDragging=!0,C[k.value.axis]=ie.currentTarget[k.value.offset]-(ie[k.value.client]-ie.currentTarget.getBoundingClientRect()[k.value.direction]),t("start-move"),G())},Z=()=>{C.isDragging=!1,C[k.value.axis]=0,t("stop-move"),U()},q=ie=>{const{isDragging:de}=C;if(!de||!_.value||!m.value)return;const le=C[k.value.axis];if(!le)return;Mh(x);const pe=(m.value.getBoundingClientRect()[k.value.direction]-ie[k.value.client])*-1,ge=_.value[k.value.offset]-le,he=pe-ge;x=td(()=>{C.traveled=Math.max(e.startGap,Math.min(he,F.value)),t("scroll",he,F.value)})},X=ie=>{const de=Math.abs(ie.target.getBoundingClientRect()[k.value.direction]-ie[k.value.client]),le=_.value[k.value.offset]/2,pe=de-le;C.traveled=Math.max(0,Math.min(pe,F.value)),t("scroll",pe,F.value)};return Wt(()=>e.scrollFrom,ie=>{C.isDragging||(C.traveled=Math.ceil(ie*F.value))}),Io(()=>{U()}),()=>Kn("div",{role:"presentation",ref:m,class:[a.b(),e.class,(e.alwaysOn||C.isDragging)&&"always-on"],style:z.value,onMousedown:Yn(X,["stop","prevent"]),onTouchstartPrevent:te},Kn("div",{ref:_,class:d.e("thumb"),style:$.value,onMousedown:te},[]))}}),Iz=({name:e,getOffset:t,getItemSize:i,getItemOffset:a,getEstimatedTotalSize:d,getStartIndexForOffset:m,getStopIndexForStartIndex:_,initCache:x,clearCache:o,validateProps:C})=>Ge({name:e??"ElVirtualList",props:Tz,emits:[fb,pb],setup(k,{emit:A,expose:z}){C(k);const N=Cr(),$=Jt("vl"),F=be(x(k,N)),G=xz(),U=be(),te=be(),Z=be(),q=be({isScrolling:!1,scrollDir:"forward",scrollOffset:Wn(k.initScrollOffset)?k.initScrollOffset:0,updateRequested:!1,isScrollbarDragging:!1,scrollbarAlwaysOn:k.scrollbarAlwaysOn}),X=Q(()=>{const{total:We,cache:ut}=k,{isScrolling:Lt,scrollDir:Ft,scrollOffset:mt}=y(q);if(We===0)return[0,0,0,0];const jt=m(k,mt,y(F)),Ht=_(k,jt,mt,y(F)),Tn=!Lt||Ft===mb?Math.max(1,ut):1,Pe=!Lt||Ft===fp?Math.max(1,ut):1;return[Math.max(0,jt-Tn),Math.max(0,Math.min(We-1,Ht+Pe)),jt,Ht]}),ie=Q(()=>d(k,y(F))),de=Q(()=>Uv(k.layout)),le=Q(()=>[{position:"relative",[`overflow-${de.value?"x":"y"}`]:"scroll",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:k.direction,height:Wn(k.height)?`${k.height}px`:k.height,width:Wn(k.width)?`${k.width}px`:k.width},k.style]),pe=Q(()=>{const We=y(ie),ut=y(de);return{height:ut?"100%":`${We}px`,pointerEvents:y(q).isScrolling?"none":void 0,width:ut?`${We}px`:"100%"}}),ge=Q(()=>de.value?k.width:k.height),{onWheel:he}=Woe({atStartEdge:Q(()=>q.value.scrollOffset<=0),atEndEdge:Q(()=>q.value.scrollOffset>=ie.value),layout:Q(()=>k.layout)},We=>{var ut,Lt;(Lt=(ut=Z.value).onMouseUp)==null||Lt.call(ut),Me(Math.min(q.value.scrollOffset+We,ie.value-ge.value))});yo(U,"wheel",he,{passive:!1});const ue=()=>{const{total:We}=k;if(We>0){const[mt,jt,Ht,Tn]=y(X);A(fb,mt,jt,Ht,Tn)}const{scrollDir:ut,scrollOffset:Lt,updateRequested:Ft}=y(q);A(pb,ut,Lt,Ft)},Re=We=>{const{clientHeight:ut,scrollHeight:Lt,scrollTop:Ft}=We.currentTarget,mt=y(q);if(mt.scrollOffset===Ft)return;const jt=Math.max(0,Math.min(Ft,Lt-ut));q.value={...mt,isScrolling:!0,scrollDir:fh(mt.scrollOffset,jt),scrollOffset:jt,updateRequested:!1},Vn(Ce)},Ye=We=>{const{clientWidth:ut,scrollLeft:Lt,scrollWidth:Ft}=We.currentTarget,mt=y(q);if(mt.scrollOffset===Lt)return;const{direction:jt}=k;let Ht=Lt;if(jt===Cp)switch(vb()){case Vv:{Ht=-Lt;break}case eE:{Ht=Ft-ut-Lt;break}}Ht=Math.max(0,Math.min(Ht,Ft-ut)),q.value={...mt,isScrolling:!0,scrollDir:fh(mt.scrollOffset,Ht),scrollOffset:Ht,updateRequested:!1},Vn(Ce)},Ie=We=>{y(de)?Ye(We):Re(We),ue()},fe=(We,ut)=>{const Lt=(ie.value-ge.value)/ut*We;Me(Math.min(ie.value-ge.value,Lt))},Me=We=>{We=Math.max(We,0),We!==y(q).scrollOffset&&(q.value={...y(q),scrollOffset:We,scrollDir:fh(y(q).scrollOffset,We),updateRequested:!0},Vn(Ce))},Se=(We,ut=za)=>{const{scrollOffset:Lt}=y(q);We=Math.max(0,Math.min(We,k.total-1)),Me(t(k,We,ut,Lt,y(F)))},ye=We=>{const{direction:ut,itemSize:Lt,layout:Ft}=k,mt=G.value(o&&Lt,o&&Ft,o&&ut);let jt;if(Qr(mt,String(We)))jt=mt[We];else{const Ht=a(k,We,y(F)),Tn=i(k,We,y(F)),Pe=y(de),At=ut===Cp,He=Pe?Ht:0;mt[We]=jt={position:"absolute",left:At?void 0:`${He}px`,right:At?`${He}px`:void 0,top:Pe?0:`${Ht}px`,height:Pe?"100%":`${Tn}px`,width:Pe?`${Tn}px`:"100%"}}return jt},Ce=()=>{q.value.isScrolling=!1,Vn(()=>{G.value(-1,null,null)})},Fe=()=>{const We=U.value;We&&(We.scrollTop=0)};vr(()=>{if(!Hr)return;const{initScrollOffset:We}=k,ut=y(U);Wn(We)&&ut&&(y(de)?ut.scrollLeft=We:ut.scrollTop=We),ue()}),Jl(()=>{const{direction:We,layout:ut}=k,{scrollOffset:Lt,updateRequested:Ft}=y(q),mt=y(U);if(Ft&&mt)if(ut===Vp)if(We===Cp)switch(vb()){case Vv:{mt.scrollLeft=-Lt;break}case QC:{mt.scrollLeft=Lt;break}default:{const{clientWidth:jt,scrollWidth:Ht}=mt;mt.scrollLeft=Ht-jt-Lt;break}}else mt.scrollLeft=Lt;else mt.scrollTop=Lt}),CT(()=>{y(U).scrollTop=y(q).scrollOffset});const it={ns:$,clientSize:ge,estimatedTotalSize:ie,windowStyle:le,windowRef:U,innerRef:te,innerStyle:pe,itemsToRender:X,scrollbarRef:Z,states:q,getItemStyle:ye,onScroll:Ie,onScrollbarScroll:fe,onWheel:he,scrollTo:Me,scrollToItem:Se,resetScrollTop:Fe};return z({windowRef:U,innerRef:te,getItemStyleCache:G,scrollTo:Me,scrollToItem:Se,resetScrollTop:Fe,states:q}),it},render(k){var A;const{$slots:z,className:N,clientSize:$,containerElement:F,data:G,getItemStyle:U,innerElement:te,itemsToRender:Z,innerStyle:q,layout:X,total:ie,onScroll:de,onScrollbarScroll:le,states:pe,useIsScrolling:ge,windowStyle:he,ns:ue}=k,[Re,Ye]=Z,Ie=Ir(F),fe=Ir(te),Me=[];if(ie>0)for(let Fe=Re;Fe<=Ye;Fe++)Me.push(Kn(Bn,{key:Fe},(A=z.default)==null?void 0:A.call(z,{data:G,index:Fe,isScrolling:ge?pe.isScrolling:void 0,style:U(Fe)})));const Se=[Kn(fe,{style:q,ref:"innerRef"},zn(fe)?Me:{default:()=>Me})],ye=Kn(ZS,{ref:"scrollbarRef",clientSize:$,layout:X,onScroll:le,ratio:$*100/this.estimatedTotalSize,scrollFrom:pe.scrollOffset/(this.estimatedTotalSize-$),total:ie}),Ce=Kn(Ie,{class:[ue.e("window"),N],style:he,onScroll:de,ref:"windowRef",key:0},zn(Ie)?[Se]:{default:()=>[Se]});return Kn("div",{key:0,class:[ue.e("wrapper"),pe.scrollbarAlwaysOn?"always-on":""]},[Ce,ye])}}),kz=Iz({name:"ElFixedSizeList",getItemOffset:({itemSize:e},t)=>t*e,getItemSize:({itemSize:e})=>e,getEstimatedTotalSize:({total:e,itemSize:t})=>t*e,getOffset:({height:e,total:t,itemSize:i,layout:a,width:d},m,_,x)=>{const o=Uv(a)?d:e,C=Math.max(0,t*i-o),k=Math.min(C,m*i),A=Math.max(0,(m+1)*i-o);switch(_===i1&&(x>=A-o&&x<=k+o?_=za:_=Hl),_){case Nv:return k;case $v:return A;case Hl:{const z=Math.round(A+(k-A)/2);return z<Math.ceil(o/2)?0:z>C+Math.floor(o/2)?C:z}case za:default:return x>=A&&x<=k?x:x<A?A:k}},getStartIndexForOffset:({total:e,itemSize:t},i)=>Math.max(0,Math.min(e-1,Math.floor(i/t))),getStopIndexForStartIndex:({height:e,total:t,itemSize:i,layout:a,width:d},m,_)=>{const x=m*i,o=Uv(a)?d:e,C=Math.ceil((o+_-x)/i);return Math.max(0,Math.min(t-1,m+C-1))},initCache(){},clearCache:!0,validateProps(){}}),pp=(e,t,i)=>{const{itemSize:a}=e,{items:d,lastVisitedIndex:m}=i;if(t>m){let _=0;if(m>=0){const x=d[m];_=x.offset+x.size}for(let x=m+1;x<=t;x++){const o=a(x);d[x]={offset:_,size:o},_+=o}i.lastVisitedIndex=t}return d[t]},Zoe=(e,t,i)=>{const{items:a,lastVisitedIndex:d}=t;return(d>0?a[d].offset:0)>=i?Az(e,t,0,d,i):Yoe(e,t,Math.max(0,d),i)},Az=(e,t,i,a,d)=>{for(;i<=a;){const m=i+Math.floor((a-i)/2),_=pp(e,m,t).offset;if(_===d)return m;_<d?i=m+1:_>d&&(a=m-1)}return Math.max(0,i-1)},Yoe=(e,t,i,a)=>{const{total:d}=e;let m=1;for(;i<d&&pp(e,i,t).offset<a;)i+=m,m*=2;return Az(e,t,Math.floor(i/2),Math.min(i,d-1),a)},zR=({total:e},{items:t,estimatedItemSize:i,lastVisitedIndex:a})=>{let d=0;if(a>=e&&(a=e-1),a>=0){const x=t[a];d=x.offset+x.size}const _=(e-a-1)*i;return d+_},Xoe=Iz({name:"ElDynamicSizeList",getItemOffset:(e,t,i)=>pp(e,t,i).offset,getItemSize:(e,t,{items:i})=>i[t].size,getEstimatedTotalSize:zR,getOffset:(e,t,i,a,d)=>{const{height:m,layout:_,width:x}=e,o=Uv(_)?x:m,C=pp(e,t,d),k=zR(e,d),A=Math.max(0,Math.min(k-o,C.offset)),z=Math.max(0,C.offset-o+C.size);switch(i===i1&&(a>=z-o&&a<=A+o?i=za:i=Hl),i){case Nv:return A;case $v:return z;case Hl:return Math.round(z+(A-z)/2);case za:default:return a>=z&&a<=A?a:a<z?z:A}},getStartIndexForOffset:(e,t,i)=>Zoe(e,i,t),getStopIndexForStartIndex:(e,t,i,a)=>{const{height:d,total:m,layout:_,width:x}=e,o=Uv(_)?x:d,C=pp(e,t,a),k=i+o;let A=C.offset+C.size,z=t;for(;z<m-1&&A<k;)z++,A+=pp(e,z,a).size;return z},initCache({estimatedItemSize:e=jS},t){const i={items:{},estimatedItemSize:e,lastVisitedIndex:-1};return i.clearCacheAfterIndex=(a,d=!0)=>{var m,_;i.lastVisitedIndex=Math.min(i.lastVisitedIndex,a-1),(m=t.exposed)==null||m.getItemStyleCache(-1),d&&((_=t.proxy)==null||_.$forceUpdate())},i},clearCache:!1,validateProps:({itemSize:e})=>{}}),Joe=({atXEndEdge:e,atXStartEdge:t,atYEndEdge:i,atYStartEdge:a},d)=>{let m=null,_=0,x=0;const o=(k,A)=>{const z=k<=0&&t.value||k>=0&&e.value,N=A<=0&&a.value||A>=0&&i.value;return z&&N};return{hasReachedEdge:o,onWheel:k=>{Mh(m);let A=k.deltaX,z=k.deltaY;Math.abs(A)>Math.abs(z)?z=0:A=0,k.shiftKey&&z!==0&&(A=z,z=0),!(o(_,x)&&o(_+A,x+z))&&(_+=A,x+=z,k.preventDefault(),m=td(()=>{d(_,x),_=0,x=0}))}}},Pz=({name:e,clearCache:t,getColumnPosition:i,getColumnStartIndexForOffset:a,getColumnStopIndexForStartIndex:d,getEstimatedTotalHeight:m,getEstimatedTotalWidth:_,getColumnOffset:x,getRowOffset:o,getRowPosition:C,getRowStartIndexForOffset:k,getRowStopIndexForStartIndex:A,initCache:z,injectToInstance:N,validateProps:$})=>Ge({name:e??"ElVirtualList",props:bh,emits:[fb,pb],setup(F,{emit:G,expose:U,slots:te}){const Z=Jt("vl");$(F);const q=Cr(),X=be(z(F,q));N==null||N(q,X);const ie=be(),de=be(),le=be(),pe=be(null),ge=be({isScrolling:!1,scrollLeft:Wn(F.initScrollLeft)?F.initScrollLeft:0,scrollTop:Wn(F.initScrollTop)?F.initScrollTop:0,updateRequested:!1,xAxisScrollDir:fp,yAxisScrollDir:fp}),he=xz(),ue=Q(()=>Number.parseInt(`${F.height}`,10)),Re=Q(()=>Number.parseInt(`${F.width}`,10)),Ye=Q(()=>{const{totalColumn:kt,totalRow:zt,columnCache:Mt}=F,{isScrolling:en,xAxisScrollDir:sn,scrollLeft:dn}=y(ge);if(kt===0||zt===0)return[0,0,0,0];const Pn=a(F,dn,y(X)),Ot=d(F,Pn,dn,y(X)),Zt=!en||sn===mb?Math.max(1,Mt):1,jn=!en||sn===fp?Math.max(1,Mt):1;return[Math.max(0,Pn-Zt),Math.max(0,Math.min(kt-1,Ot+jn)),Pn,Ot]}),Ie=Q(()=>{const{totalColumn:kt,totalRow:zt,rowCache:Mt}=F,{isScrolling:en,yAxisScrollDir:sn,scrollTop:dn}=y(ge);if(kt===0||zt===0)return[0,0,0,0];const Pn=k(F,dn,y(X)),Ot=A(F,Pn,dn,y(X)),Zt=!en||sn===mb?Math.max(1,Mt):1,jn=!en||sn===fp?Math.max(1,Mt):1;return[Math.max(0,Pn-Zt),Math.max(0,Math.min(zt-1,Ot+jn)),Pn,Ot]}),fe=Q(()=>m(F,y(X))),Me=Q(()=>_(F,y(X))),Se=Q(()=>{var kt;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:F.direction,height:Wn(F.height)?`${F.height}px`:F.height,width:Wn(F.width)?`${F.width}px`:F.width},(kt=F.style)!=null?kt:{}]}),ye=Q(()=>{const kt=`${y(Me)}px`;return{height:`${y(fe)}px`,pointerEvents:y(ge).isScrolling?"none":void 0,width:kt}}),Ce=()=>{const{totalColumn:kt,totalRow:zt}=F;if(kt>0&&zt>0){const[Ot,Zt,jn,ir]=y(Ye),[ur,ar,wr,Xr]=y(Ie);G(fb,{columnCacheStart:Ot,columnCacheEnd:Zt,rowCacheStart:ur,rowCacheEnd:ar,columnVisibleStart:jn,columnVisibleEnd:ir,rowVisibleStart:wr,rowVisibleEnd:Xr})}const{scrollLeft:Mt,scrollTop:en,updateRequested:sn,xAxisScrollDir:dn,yAxisScrollDir:Pn}=y(ge);G(pb,{xAxisScrollDir:dn,scrollLeft:Mt,yAxisScrollDir:Pn,scrollTop:en,updateRequested:sn})},Fe=kt=>{const{clientHeight:zt,clientWidth:Mt,scrollHeight:en,scrollLeft:sn,scrollTop:dn,scrollWidth:Pn}=kt.currentTarget,Ot=y(ge);if(Ot.scrollTop===dn&&Ot.scrollLeft===sn)return;let Zt=sn;if(OR(F.direction))switch(vb()){case Vv:Zt=-sn;break;case eE:Zt=Pn-Mt-sn;break}ge.value={...Ot,isScrolling:!0,scrollLeft:Zt,scrollTop:Math.max(0,Math.min(dn,en-zt)),updateRequested:!0,xAxisScrollDir:fh(Ot.scrollLeft,Zt),yAxisScrollDir:fh(Ot.scrollTop,dn)},Vn(()=>jt()),Ht(),Ce()},it=(kt,zt)=>{const Mt=y(ue),en=(fe.value-Mt)/zt*kt;Lt({scrollTop:Math.min(fe.value-Mt,en)})},We=(kt,zt)=>{const Mt=y(Re),en=(Me.value-Mt)/zt*kt;Lt({scrollLeft:Math.min(Me.value-Mt,en)})},{onWheel:ut}=Joe({atXStartEdge:Q(()=>ge.value.scrollLeft<=0),atXEndEdge:Q(()=>ge.value.scrollLeft>=Me.value-y(Re)),atYStartEdge:Q(()=>ge.value.scrollTop<=0),atYEndEdge:Q(()=>ge.value.scrollTop>=fe.value-y(ue))},(kt,zt)=>{var Mt,en,sn,dn;(en=(Mt=de.value)==null?void 0:Mt.onMouseUp)==null||en.call(Mt),(dn=(sn=le.value)==null?void 0:sn.onMouseUp)==null||dn.call(sn);const Pn=y(Re),Ot=y(ue);Lt({scrollLeft:Math.min(ge.value.scrollLeft+kt,Me.value-Pn),scrollTop:Math.min(ge.value.scrollTop+zt,fe.value-Ot)})});yo(ie,"wheel",ut,{passive:!1});const Lt=({scrollLeft:kt=ge.value.scrollLeft,scrollTop:zt=ge.value.scrollTop})=>{kt=Math.max(kt,0),zt=Math.max(zt,0);const Mt=y(ge);zt===Mt.scrollTop&&kt===Mt.scrollLeft||(ge.value={...Mt,xAxisScrollDir:fh(Mt.scrollLeft,kt),yAxisScrollDir:fh(Mt.scrollTop,zt),scrollLeft:kt,scrollTop:zt,updateRequested:!0},Vn(()=>jt()),Ht(),Ce())},Ft=(kt=0,zt=0,Mt=za)=>{const en=y(ge);zt=Math.max(0,Math.min(zt,F.totalColumn-1)),kt=Math.max(0,Math.min(kt,F.totalRow-1));const sn=OO(Z.namespace.value),dn=y(X),Pn=m(F,dn),Ot=_(F,dn);Lt({scrollLeft:x(F,zt,Mt,en.scrollLeft,dn,Ot>F.width?sn:0),scrollTop:o(F,kt,Mt,en.scrollTop,dn,Pn>F.height?sn:0)})},mt=(kt,zt)=>{const{columnWidth:Mt,direction:en,rowHeight:sn}=F,dn=he.value(t&&Mt,t&&sn,t&&en),Pn=`${kt},${zt}`;if(Qr(dn,Pn))return dn[Pn];{const[,Ot]=i(F,zt,y(X)),Zt=y(X),jn=OR(en),[ir,ur]=C(F,kt,Zt),[ar]=i(F,zt,Zt);return dn[Pn]={position:"absolute",left:jn?void 0:`${Ot}px`,right:jn?`${Ot}px`:void 0,top:`${ur}px`,height:`${ir}px`,width:`${ar}px`},dn[Pn]}},jt=()=>{ge.value.isScrolling=!1,Vn(()=>{he.value(-1,null,null)})};vr(()=>{if(!Hr)return;const{initScrollLeft:kt,initScrollTop:zt}=F,Mt=y(ie);Mt&&(Wn(kt)&&(Mt.scrollLeft=kt),Wn(zt)&&(Mt.scrollTop=zt)),Ce()});const Ht=()=>{const{direction:kt}=F,{scrollLeft:zt,scrollTop:Mt,updateRequested:en}=y(ge),sn=y(ie);if(en&&sn){if(kt===Cp)switch(vb()){case Vv:{sn.scrollLeft=-zt;break}case QC:{sn.scrollLeft=zt;break}default:{const{clientWidth:dn,scrollWidth:Pn}=sn;sn.scrollLeft=Pn-dn-zt;break}}else sn.scrollLeft=Math.max(0,zt);sn.scrollTop=Math.max(0,Mt)}},{resetAfterColumnIndex:Tn,resetAfterRowIndex:Pe,resetAfter:At}=q.proxy;U({windowRef:ie,innerRef:pe,getItemStyleCache:he,scrollTo:Lt,scrollToItem:Ft,states:ge,resetAfterColumnIndex:Tn,resetAfterRowIndex:Pe,resetAfter:At});const He=()=>{const{scrollbarAlwaysOn:kt,scrollbarStartGap:zt,scrollbarEndGap:Mt,totalColumn:en,totalRow:sn}=F,dn=y(Re),Pn=y(ue),Ot=y(Me),Zt=y(fe),{scrollLeft:jn,scrollTop:ir}=y(ge),ur=Kn(ZS,{ref:de,alwaysOn:kt,startGap:zt,endGap:Mt,class:Z.e("horizontal"),clientSize:dn,layout:"horizontal",onScroll:We,ratio:dn*100/Ot,scrollFrom:jn/(Ot-dn),total:sn,visible:!0}),ar=Kn(ZS,{ref:le,alwaysOn:kt,startGap:zt,endGap:Mt,class:Z.e("vertical"),clientSize:Pn,layout:"vertical",onScroll:it,ratio:Pn*100/Zt,scrollFrom:ir/(Zt-Pn),total:en,visible:!0});return{horizontalScrollbar:ur,verticalScrollbar:ar}},pt=()=>{var kt;const[zt,Mt]=y(Ye),[en,sn]=y(Ie),{data:dn,totalColumn:Pn,totalRow:Ot,useIsScrolling:Zt,itemKey:jn}=F,ir=[];if(Ot>0&&Pn>0)for(let ur=en;ur<=sn;ur++)for(let ar=zt;ar<=Mt;ar++){const wr=jn({columnIndex:ar,data:dn,rowIndex:ur});ir.push(Kn(Bn,{key:wr},(kt=te.default)==null?void 0:kt.call(te,{columnIndex:ar,data:dn,isScrolling:Zt?y(ge).isScrolling:void 0,style:mt(ur,ar),rowIndex:ur})))}return ir},et=()=>{const kt=Ir(F.innerElement),zt=pt();return[Kn(kt,{style:y(ye),ref:pe},zn(kt)?zt:{default:()=>zt})]};return()=>{const kt=Ir(F.containerElement),{horizontalScrollbar:zt,verticalScrollbar:Mt}=He(),en=et();return Kn("div",{key:0,class:Z.e("wrapper"),role:F.role},[Kn(kt,{class:F.className,style:y(Se),onScroll:Fe,ref:ie},zn(kt)?en:{default:()=>en}),zt,Mt])}}}),Qoe=Pz({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:i},a,d,m,_,x)=>{i=Number(i);const o=Math.max(0,e*t-i),C=Math.min(o,a*t),k=Math.max(0,a*t-i+x+t);switch(d==="smart"&&(m>=k-i&&m<=C+i?d=za:d=Hl),d){case Nv:return C;case $v:return k;case Hl:{const A=Math.round(k+(C-k)/2);return A<Math.ceil(i/2)?0:A>o+Math.floor(i/2)?o:A}case za:default:return m>=k&&m<=C?m:k>C||m<k?k:C}},getRowOffset:({rowHeight:e,height:t,totalRow:i},a,d,m,_,x)=>{t=Number(t);const o=Math.max(0,i*e-t),C=Math.min(o,a*e),k=Math.max(0,a*e-t+x+e);switch(d===i1&&(m>=k-t&&m<=C+t?d=za:d=Hl),d){case Nv:return C;case $v:return k;case Hl:{const A=Math.round(k+(C-k)/2);return A<Math.ceil(t/2)?0:A>o+Math.floor(t/2)?o:A}case za:default:return m>=k&&m<=C?m:k>C||m<k?k:C}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},i)=>Math.max(0,Math.min(t-1,Math.floor(i/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:i},a,d)=>{const m=a*e,_=Math.ceil((i+d-m)/e);return Math.max(0,Math.min(t-1,a+_-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},i)=>Math.max(0,Math.min(t-1,Math.floor(i/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:i},a,d)=>{const m=a*e,_=Math.ceil((i+d-m)/e);return Math.max(0,Math.min(t-1,a+_-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}}),{max:_b,min:Rz,floor:Dz}=Math,eie={column:"columnWidth",row:"rowHeight"},YS={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},Cc=(e,t,i,a)=>{const[d,m,_]=[i[a],e[eie[a]],i[YS[a]]];if(t>_){let x=0;if(_>=0){const o=d[_];x=o.offset+o.size}for(let o=_+1;o<=t;o++){const C=m(o);d[o]={offset:x,size:C},x+=C}i[YS[a]]=t}return d[t]},Lz=(e,t,i,a,d,m)=>{for(;i<=a;){const _=i+Dz((a-i)/2),x=Cc(e,_,t,m).offset;if(x===d)return _;x<d?i=_+1:a=_-1}return _b(0,i-1)},tie=(e,t,i,a,d)=>{const m=d==="column"?e.totalColumn:e.totalRow;let _=1;for(;i<m&&Cc(e,i,t,d).offset<a;)i+=_,_*=2;return Lz(e,t,Dz(i/2),Rz(i,m-1),a,d)},BR=(e,t,i,a)=>{const[d,m]=[t[a],t[YS[a]]];return(m>0?d[m].offset:0)>=i?Lz(e,t,0,m,i,a):tie(e,t,_b(0,m),i,a)},Oz=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:i,row:a})=>{let d=0;if(i>=e&&(i=e-1),i>=0){const x=a[i];d=x.offset+x.size}const _=(e-i-1)*t;return d+_},zz=({totalColumn:e},{column:t,estimatedColumnWidth:i,lastVisitedColumnIndex:a})=>{let d=0;if(a>e&&(a=e-1),a>=0){const x=t[a];d=x.offset+x.size}const _=(e-a-1)*i;return d+_},nie={column:zz,row:Oz},FR=(e,t,i,a,d,m,_)=>{const[x,o]=[m==="row"?e.height:e.width,nie[m]],C=Cc(e,t,d,m),k=o(e,d),A=_b(0,Rz(k-x,C.offset)),z=_b(0,C.offset-x+_+C.size);switch(i===i1&&(a>=z-x&&a<=A+x?i=za:i=Hl),i){case Nv:return A;case $v:return z;case Hl:return Math.round(z+(A-z)/2);case za:default:return a>=z&&a<=A?a:z>A||a<z?z:A}},rie=Pz({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,i)=>{const a=Cc(e,t,i,"column");return[a.size,a.offset]},getRowPosition:(e,t,i)=>{const a=Cc(e,t,i,"row");return[a.size,a.offset]},getColumnOffset:(e,t,i,a,d,m)=>FR(e,t,i,a,d,"column",m),getRowOffset:(e,t,i,a,d,m)=>FR(e,t,i,a,d,"row",m),getColumnStartIndexForOffset:(e,t,i)=>BR(e,i,t,"column"),getColumnStopIndexForStartIndex:(e,t,i,a)=>{const d=Cc(e,t,a,"column"),m=i+e.width;let _=d.offset+d.size,x=t;for(;x<e.totalColumn-1&&_<m;)x++,_+=Cc(e,t,a,"column").size;return x},getEstimatedTotalHeight:Oz,getEstimatedTotalWidth:zz,getRowStartIndexForOffset:(e,t,i)=>BR(e,i,t,"row"),getRowStopIndexForStartIndex:(e,t,i,a)=>{const{totalRow:d,height:m}=e,_=Cc(e,t,a,"row"),x=i+m;let o=_.size+_.offset,C=t;for(;C<d-1&&o<x;)C++,o+=Cc(e,C,a,"row").size;return C},injectToInstance:(e,t)=>{const i=({columnIndex:m,rowIndex:_},x)=>{var o,C;x=Bo(x)?!0:x,Wn(m)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,m-1)),Wn(_)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,_-1)),(o=e.exposed)==null||o.getItemStyleCache.value(-1,null,null),x&&((C=e.proxy)==null||C.$forceUpdate())},a=(m,_)=>{i({columnIndex:m},_)},d=(m,_)=>{i({rowIndex:m},_)};Object.assign(e.proxy,{resetAfterColumnIndex:a,resetAfterRowIndex:d,resetAfter:i})},initCache:({estimatedColumnWidth:e=jS,estimatedRowHeight:t=jS})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}}),oie=Ge({props:{item:{type:Object,required:!0},style:{type:Object},height:Number},setup(){return{ns:Jt("select")}}});function iie(e,t,i,a,d,m){return se(),Ae("div",{class:ce(e.ns.be("group","title")),style:Nn({...e.style,lineHeight:`${e.height}px`})},fn(e.item.label),7)}var sie=hn(oie,[["render",iie],["__file","group-item.vue"]]);function aie(e,{emit:t}){return{hoverItem:()=>{e.disabled||t("hover",e.index)},selectOptionClick:()=>{e.disabled||t("select",e.item,e.index)}}}const Bz={label:"label",value:"value",disabled:"disabled",options:"options"};function s1(e){const t=Q(()=>({...Bz,...e.props}));return{aliasProps:t,getLabel:_=>mi(_,t.value.label),getValue:_=>mi(_,t.value.value),getDisabled:_=>mi(_,t.value.disabled),getOptions:_=>mi(_,t.value.options)}}const lie=ln({allowCreate:Boolean,autocomplete:{type:at(String),default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:wo,default:dd},effect:{type:at(String),default:"light"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:274},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,modelValue:{type:at([Array,String,Number,Boolean,Object])},multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:at(Array),required:!0},placeholder:{type:String},teleported:Li.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:at(Object),default:()=>({})},remote:Boolean,size:Ei,props:{type:at(Object),default:()=>Bz},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:Boolean,validateEvent:{type:Boolean,default:!0},offset:{type:Number,default:12},showArrow:{type:Boolean,default:!0},placement:{type:at(String),values:Fc,default:"bottom-start"},fallbackPlacements:{type:at(Array),default:["bottom-start","top-start","right","left"]},tagType:{...Ah.type,default:"info"},tagEffect:{...Ah.effect,default:"light"},appendTo:String,...em,...qi(["ariaLabel"])}),cie=ln({data:Array,disabled:Boolean,hovering:Boolean,item:{type:at(Object),required:!0},index:Number,style:Object,selected:Boolean,created:Boolean}),uie={[xr]:e=>!0,[No]:e=>!0,"remove-tag":e=>!0,"visible-change":e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0},die={hover:e=>Wn(e),select:(e,t)=>!0},tE=Symbol("ElSelectV2Injection"),hie=Ge({props:cie,emits:die,setup(e,{emit:t}){const i=kn(tE),a=Jt("select"),{hoverItem:d,selectOptionClick:m}=aie(e,{emit:t}),{getLabel:_}=s1(i.props);return{ns:a,hoverItem:d,selectOptionClick:m,getLabel:_}}});function fie(e,t,i,a,d,m){return se(),Ae("li",{"aria-selected":e.selected,style:Nn(e.style),class:ce([e.ns.be("dropdown","item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),e.ns.is("hovering",e.hovering)]),onMousemove:e.hoverItem,onClick:Yn(e.selectOptionClick,["stop"])},[_t(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},()=>[Ve("span",null,fn(e.getLabel(e.item)),1)])],46,["aria-selected","onMousemove","onClick"])}var pie=hn(hie,[["render",fie],["__file","option-item.vue"]]);const mie={loading:Boolean,data:{type:Array,required:!0},hoveringIndex:Number,width:Number};var gie=Ge({name:"ElSelectDropdown",props:mie,setup(e,{slots:t,expose:i}){const a=kn(tE),d=Jt("select"),{getLabel:m,getValue:_,getDisabled:x}=s1(a.props),o=be([]),C=be(),k=Q(()=>e.data.length);Wt(()=>k.value,()=>{var he,ue;(ue=(he=a.tooltipRef.value).updatePopper)==null||ue.call(he)});const A=Q(()=>Bo(a.props.estimatedOptionHeight)),z=Q(()=>A.value?{itemSize:a.props.itemHeight}:{estimatedSize:a.props.estimatedOptionHeight,itemSize:he=>o.value[he]}),N=(he=[],ue)=>{const{props:{valueKey:Re}}=a;return Tr(ue)?he&&he.some(Ye=>Eo(mi(Ye,Re))===mi(ue,Re)):he.includes(ue)},$=(he,ue)=>{if(Tr(ue)){const{valueKey:Re}=a.props;return mi(he,Re)===mi(ue,Re)}else return he===ue},F=(he,ue)=>a.props.multiple?N(he,_(ue)):$(he,_(ue)),G=(he,ue)=>{const{disabled:Re,multiple:Ye,multipleLimit:Ie}=a.props;return Re||!ue&&(Ye?Ie>0&&he.length>=Ie:!1)},U=he=>e.hoveringIndex===he;i({listRef:C,isSized:A,isItemDisabled:G,isItemHovering:U,isItemSelected:F,scrollToItem:he=>{const ue=C.value;ue&&ue.scrollToItem(he)},resetScrollTop:()=>{const he=C.value;he&&he.resetScrollTop()}});const X=he=>{const{index:ue,data:Re,style:Ye}=he,Ie=y(A),{itemSize:fe,estimatedSize:Me}=y(z),{modelValue:Se}=a.props,{onSelect:ye,onHover:Ce}=a,Fe=Re[ue];if(Fe.type==="Group")return qe(sie,{item:Fe,style:Ye,height:Ie?fe:Me},null);const it=F(Se,Fe),We=G(Se,it),ut=U(ue);return qe(pie,kr(he,{selected:it,disabled:x(Fe)||We,created:!!Fe.created,hovering:ut,item:Fe,onSelect:ye,onHover:Ce}),{default:Lt=>{var Ft;return((Ft=t.default)==null?void 0:Ft.call(t,Lt))||qe("span",null,[m(Fe)])}})},{onKeyboardNavigate:ie,onKeyboardSelect:de}=a,le=()=>{ie("forward")},pe=()=>{ie("backward")},ge=he=>{const{code:ue}=he,{tab:Re,esc:Ye,down:Ie,up:fe,enter:Me,numpadEnter:Se}=En;switch(ue!==Re&&(he.preventDefault(),he.stopPropagation()),ue){case Re:case Ye:break;case Ie:le();break;case fe:pe();break;case Me:case Se:de();break}};return()=>{var he,ue,Re,Ye;const{data:Ie,width:fe}=e,{height:Me,multiple:Se,scrollbarAlwaysOn:ye}=a.props,Ce=y(A)?kz:Xoe;return qe("div",{class:[d.b("dropdown"),d.is("multiple",Se)],style:{width:`${fe}px`}},[(he=t.header)==null?void 0:he.call(t),((ue=t.loading)==null?void 0:ue.call(t))||((Re=t.empty)==null?void 0:Re.call(t))||qe(Ce,kr({ref:C},y(z),{className:d.be("dropdown","list"),scrollbarAlwaysOn:ye,data:Ie,height:Me,width:fe,total:Ie.length,onKeydown:ge}),{default:Fe=>qe(X,Fe,null)}),(Ye=t.footer)==null?void 0:Ye.call(t)])}}});function vie(e,t){const{aliasProps:i,getLabel:a,getValue:d}=s1(e),m=be(0),_=be(),x=Q(()=>e.allowCreate&&e.filterable);function o(N){const $=F=>a(F)===N;return e.options&&e.options.some($)||t.createdOptions.some($)}function C(N){x.value&&(e.multiple&&N.created?m.value++:_.value=N)}function k(N){if(x.value)if(N&&N.length>0){if(o(N))return;const $={[i.value.value]:N,[i.value.label]:N,created:!0,[i.value.disabled]:!1};t.createdOptions.length>=m.value?t.createdOptions[m.value]=$:t.createdOptions.push($)}else if(e.multiple)t.createdOptions.length=m.value;else{const $=_.value;t.createdOptions.length=0,$&&$.created&&t.createdOptions.push($)}}function A(N){if(!x.value||!N||!N.created||N.created&&e.reserveKeyword&&t.inputValue===a(N))return;const $=t.createdOptions.findIndex(F=>d(F)===d(N));~$&&(t.createdOptions.splice($,1),m.value--)}function z(){x.value&&(t.createdOptions.length=0,m.value=0)}return{createNewOption:k,removeNewOption:A,selectNewOption:C,clearAllNewOption:z}}const _ie=11,yie=(e,t)=>{const{t:i}=Gr(),a=Jt("select"),d=Jt("input"),{form:m,formItem:_}=bs(),{inputId:x}=Sl(e,{formItemContext:_}),{aliasProps:o,getLabel:C,getValue:k,getDisabled:A,getOptions:z}=s1(e),{valueOnClear:N,isEmptyValue:$}=Xb(e),F=ao({inputValue:"",cachedOptions:[],createdOptions:[],hoveringIndex:-1,inputHovering:!1,selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,previousQuery:null,previousValue:void 0,selectedLabel:"",menuVisibleOnFocus:!1,isBeforeHide:!1}),G=be(-1),U=be(),te=be(),Z=be(),q=be(),X=be(),ie=be(),de=be(),le=be(),pe=be(),ge=be(),he=be(),{isComposing:ue,handleCompositionStart:Re,handleCompositionEnd:Ye,handleCompositionUpdate:Ie}=Yb({afterComposition:Ut=>tr(Ut)}),{wrapperRef:fe,isFocused:Me,handleBlur:Se}=Bh(X,{beforeFocus(){return it.value},afterFocus(){e.automaticDropdown&&!Fe.value&&(Fe.value=!0,F.menuVisibleOnFocus=!0)},beforeBlur(Ut){var Rn,Jn;return((Rn=Z.value)==null?void 0:Rn.isFocusInsideContent(Ut))||((Jn=q.value)==null?void 0:Jn.isFocusInsideContent(Ut))},afterBlur(){Fe.value=!1,F.menuVisibleOnFocus=!1}}),ye=be([]),Ce=be([]),Fe=be(!1),it=Q(()=>e.disabled||(m==null?void 0:m.disabled)),We=Q(()=>{var Ut;return(Ut=m==null?void 0:m.statusIcon)!=null?Ut:!1}),ut=Q(()=>{const Ut=Ce.value.length*e.itemHeight;return Ut>e.height?e.height:Ut}),Lt=Q(()=>e.multiple?on(e.modelValue)&&e.modelValue.length>0:!$(e.modelValue)),Ft=Q(()=>e.clearable&&!it.value&&F.inputHovering&&Lt.value),mt=Q(()=>e.remote&&e.filterable?"":Bc),jt=Q(()=>mt.value&&a.is("reverse",Fe.value)),Ht=Q(()=>(_==null?void 0:_.validateState)||""),Tn=Q(()=>{if(Ht.value)return lC[Ht.value]}),Pe=Q(()=>e.remote?300:0),At=Q(()=>e.loading?e.loadingText||i("el.select.loading"):e.remote&&!F.inputValue&&ye.value.length===0?!1:e.filterable&&F.inputValue&&ye.value.length>0&&Ce.value.length===0?e.noMatchText||i("el.select.noMatch"):ye.value.length===0?e.noDataText||i("el.select.noData"):null),He=Ut=>{const Rn=Jn=>{if(e.filterable&&Fn(e.filterMethod)||e.filterable&&e.remote&&Fn(e.remoteMethod))return!0;const _r=new RegExp(QT(Ut),"i");return Ut?_r.test(C(Jn)||""):!0};return e.loading?[]:[...F.createdOptions,...e.options].reduce((Jn,_r)=>{const go=z(_r);if(on(go)){const jo=go.filter(Rn);jo.length>0&&Jn.push({label:C(_r),type:"Group"},...jo)}else(e.remote||Rn(_r))&&Jn.push(_r);return Jn},[])},pt=()=>{ye.value=He(""),Ce.value=He(F.inputValue)},et=Q(()=>{const Ut=new Map;return ye.value.forEach((Rn,Jn)=>{Ut.set(Rr(k(Rn)),{option:Rn,index:Jn})}),Ut}),rn=Q(()=>{const Ut=new Map;return Ce.value.forEach((Rn,Jn)=>{Ut.set(Rr(k(Rn)),{option:Rn,index:Jn})}),Ut}),kt=Q(()=>Ce.value.every(Ut=>A(Ut))),zt=xi(),Mt=Q(()=>zt.value==="small"?"small":"default"),en=()=>{var Ut;G.value=((Ut=U.value)==null?void 0:Ut.offsetWidth)||200},sn=()=>{if(!te.value)return 0;const Ut=window.getComputedStyle(te.value);return Number.parseFloat(Ut.gap||"6px")},dn=Q(()=>{const Ut=sn();return{maxWidth:`${he.value&&e.maxCollapseTags===1?F.selectionWidth-F.collapseItemWidth-Ut:F.selectionWidth}px`}}),Pn=Q(()=>({maxWidth:`${F.selectionWidth}px`})),Ot=Q(()=>({width:`${Math.max(F.calculatorWidth,_ie)}px`})),Zt=Q(()=>on(e.modelValue)?e.modelValue.length===0&&!F.inputValue:e.filterable?!F.inputValue:!0),jn=Q(()=>{var Ut;const Rn=(Ut=e.placeholder)!=null?Ut:i("el.select.placeholder");return e.multiple||!Lt.value?Rn:F.selectedLabel}),ir=Q(()=>{var Ut,Rn;return(Rn=(Ut=Z.value)==null?void 0:Ut.popperRef)==null?void 0:Rn.contentRef}),ur=Q(()=>{if(e.multiple){const Ut=e.modelValue.length;if(e.modelValue.length>0&&rn.value.has(e.modelValue[Ut-1])){const{index:Rn}=rn.value.get(e.modelValue[Ut-1]);return Rn}}else if(e.modelValue&&rn.value.has(e.modelValue)){const{index:Ut}=rn.value.get(e.modelValue);return Ut}return-1}),ar=Q({get(){return Fe.value&&At.value!==!1},set(Ut){Fe.value=Ut}}),wr=Q(()=>e.multiple?e.collapseTags?F.cachedOptions.slice(0,e.maxCollapseTags):F.cachedOptions:[]),Xr=Q(()=>e.multiple?e.collapseTags?F.cachedOptions.slice(e.maxCollapseTags):[]:[]),{createNewOption:Rt,removeNewOption:_n,selectNewOption:dt,clearAllNewOption:tn}=vie(e,F),Ze=()=>{it.value||(F.menuVisibleOnFocus?F.menuVisibleOnFocus=!1:Fe.value=!Fe.value)},gn=()=>{F.inputValue.length>0&&!Fe.value&&(Fe.value=!0),Rt(F.inputValue),Hn(F.inputValue)},rr=Js(gn,Pe.value),Hn=Ut=>{F.previousQuery===Ut||ue.value||(F.previousQuery=Ut,e.filterable&&Fn(e.filterMethod)?e.filterMethod(Ut):e.filterable&&e.remote&&Fn(e.remoteMethod)&&e.remoteMethod(Ut),e.defaultFirstOption&&(e.filterable||e.remote)&&Ce.value.length?Vn(eo):Vn(Cn))},eo=()=>{const Ut=Ce.value.filter(_r=>!_r.disabled&&_r.type!=="Group"),Rn=Ut.find(_r=>_r.created),Jn=Ut[0];F.hoveringIndex=bo(Ce.value,Rn||Jn)},Mi=Ut=>{Gi(e.modelValue,Ut)||t(No,Ut)},mo=Ut=>{t(xr,Ut),Mi(Ut),F.previousValue=e.multiple?String(Ut):Ut},bo=(Ut=[],Rn)=>{if(!Tr(Rn))return Ut.indexOf(Rn);const Jn=e.valueKey;let _r=-1;return Ut.some((go,jo)=>mi(go,Jn)===mi(Rn,Jn)?(_r=jo,!0):!1),_r},Rr=Ut=>Tr(Ut)?mi(Ut,e.valueKey):Ut,fi=()=>{en()},_a=()=>{F.selectionWidth=te.value.getBoundingClientRect().width},Ns=()=>{F.calculatorWidth=ie.value.getBoundingClientRect().width},Nt=()=>{F.collapseItemWidth=he.value.getBoundingClientRect().width},Te=()=>{var Ut,Rn;(Rn=(Ut=Z.value)==null?void 0:Ut.updatePopper)==null||Rn.call(Ut)},ke=()=>{var Ut,Rn;(Rn=(Ut=q.value)==null?void 0:Ut.updatePopper)==null||Rn.call(Ut)},Ke=Ut=>{if(e.multiple){let Rn=e.modelValue.slice();const Jn=bo(Rn,k(Ut));Jn>-1?(Rn=[...Rn.slice(0,Jn),...Rn.slice(Jn+1)],F.cachedOptions.splice(Jn,1),_n(Ut)):(e.multipleLimit<=0||Rn.length<e.multipleLimit)&&(Rn=[...Rn,k(Ut)],F.cachedOptions.push(Ut),dt(Ut)),mo(Rn),Ut.created&&Hn(""),e.filterable&&!e.reserveKeyword&&(F.inputValue="")}else F.selectedLabel=C(Ut),mo(k(Ut)),Fe.value=!1,dt(Ut),Ut.created||tn();nt()},lt=(Ut,Rn)=>{let Jn=e.modelValue.slice();const _r=bo(Jn,k(Rn));_r>-1&&!it.value&&(Jn=[...e.modelValue.slice(0,_r),...e.modelValue.slice(_r+1)],F.cachedOptions.splice(_r,1),mo(Jn),t("remove-tag",k(Rn)),_n(Rn)),Ut.stopPropagation(),nt()},nt=()=>{var Ut;(Ut=X.value)==null||Ut.focus()},xt=()=>{var Ut;if(Fe.value){Fe.value=!1,Vn(()=>{var Rn;return(Rn=X.value)==null?void 0:Rn.blur()});return}(Ut=X.value)==null||Ut.blur()},$t=()=>{F.inputValue.length>0?F.inputValue="":Fe.value=!1},Tt=Ut=>AO(Ut,Rn=>!F.cachedOptions.some(Jn=>k(Jn)===Rn&&A(Jn))),Vt=Ut=>{if(e.multiple&&Ut.code!==En.delete&&F.inputValue.length===0){Ut.preventDefault();const Rn=e.modelValue.slice(),Jn=Tt(Rn);if(Jn<0)return;const _r=Rn[Jn];Rn.splice(Jn,1);const go=F.cachedOptions[Jn];F.cachedOptions.splice(Jn,1),_n(go),mo(Rn),t("remove-tag",_r)}},Yt=()=>{let Ut;on(e.modelValue)?Ut=[]:Ut=N.value,e.multiple?F.cachedOptions=[]:F.selectedLabel="",Fe.value=!1,mo(Ut),t("clear"),tn(),nt()},Je=(Ut,Rn=void 0)=>{const Jn=Ce.value;if(!["forward","backward"].includes(Ut)||it.value||Jn.length<=0||kt.value||ue.value)return;if(!Fe.value)return Ze();Rn===void 0&&(Rn=F.hoveringIndex);let _r=-1;Ut==="forward"?(_r=Rn+1,_r>=Jn.length&&(_r=0)):Ut==="backward"&&(_r=Rn-1,(_r<0||_r>=Jn.length)&&(_r=Jn.length-1));const go=Jn[_r];if(A(go)||go.type==="Group")return Je(Ut,_r);F.hoveringIndex=_r,fr(_r)},Pt=()=>{if(Fe.value)~F.hoveringIndex&&Ce.value[F.hoveringIndex]&&Ke(Ce.value[F.hoveringIndex]);else return Ze()},vn=Ut=>{F.hoveringIndex=Ut??-1},Cn=()=>{e.multiple?F.hoveringIndex=Ce.value.findIndex(Ut=>e.modelValue.some(Rn=>Rr(Rn)===Rr(Ut))):F.hoveringIndex=Ce.value.findIndex(Ut=>Rr(Ut)===Rr(e.modelValue))},tr=Ut=>{if(F.inputValue=Ut.target.value,e.remote)rr();else return gn()},hr=Ut=>{if(Fe.value=!1,Me.value){const Rn=new FocusEvent("focus",Ut);Se(Rn)}},dr=()=>(F.isBeforeHide=!1,Vn(()=>{~ur.value&&fr(F.hoveringIndex)})),fr=Ut=>{pe.value.scrollToItem(Ut)},Wr=(Ut,Rn)=>{const Jn=Rr(Ut);if(et.value.has(Jn)){const{option:_r}=et.value.get(Jn);return _r}if(Rn&&Rn.length){const _r=Rn.find(go=>Rr(k(go))===Jn);if(_r)return _r}return{[o.value.value]:Ut,[o.value.label]:Ut}},ro=(Ut=!1)=>{if(e.multiple)if(e.modelValue.length>0){const Rn=F.cachedOptions.slice();F.cachedOptions.length=0,F.previousValue=e.modelValue.toString();for(const Jn of e.modelValue){const _r=Wr(Jn,Rn);F.cachedOptions.push(_r)}}else F.cachedOptions=[],F.previousValue=void 0;else if(Lt.value){F.previousValue=e.modelValue;const Rn=Ce.value,Jn=Rn.findIndex(_r=>Rr(k(_r))===Rr(e.modelValue));~Jn?F.selectedLabel=C(Rn[Jn]):(!F.selectedLabel||Ut)&&(F.selectedLabel=Rr(e.modelValue))}else F.selectedLabel="",F.previousValue=void 0;tn(),en()};return Wt(Fe,Ut=>{Ut?Hn(""):(F.inputValue="",F.previousQuery=null,F.isBeforeHide=!0,Rt("")),t("visible-change",Ut)}),Wt(()=>e.modelValue,(Ut,Rn)=>{var Jn;(!Ut||on(Ut)&&Ut.length===0||e.multiple&&!Gi(Ut.toString(),F.previousValue)||!e.multiple&&Rr(Ut)!==Rr(F.previousValue))&&ro(!0),!Gi(Ut,Rn)&&e.validateEvent&&((Jn=_==null?void 0:_.validate)==null||Jn.call(_,"change").catch(go=>void 0))},{deep:!0}),Wt(()=>e.options,()=>{const Ut=X.value;(!Ut||Ut&&document.activeElement!==Ut)&&ro()},{deep:!0,flush:"post"}),Wt(()=>Ce.value,()=>pe.value&&Vn(pe.value.resetScrollTop)),ns(()=>{F.isBeforeHide||pt()}),ns(()=>{const{valueKey:Ut,options:Rn}=e,Jn=new Map;for(const _r of Rn){const go=k(_r);let jo=go;if(Tr(jo)&&(jo=mi(go,Ut)),Jn.get(jo))break;Jn.set(jo,!0)}}),vr(()=>{ro()}),qo(U,fi),qo(te,_a),qo(ie,Ns),qo(pe,Te),qo(fe,Te),qo(ge,ke),qo(he,Nt),{inputId:x,collapseTagSize:Mt,currentPlaceholder:jn,expanded:Fe,emptyText:At,popupHeight:ut,debounce:Pe,allOptions:ye,filteredOptions:Ce,iconComponent:mt,iconReverse:jt,tagStyle:dn,collapseTagStyle:Pn,inputStyle:Ot,popperSize:G,dropdownMenuVisible:ar,hasModelValue:Lt,shouldShowPlaceholder:Zt,selectDisabled:it,selectSize:zt,needStatusIcon:We,showClearBtn:Ft,states:F,isFocused:Me,nsSelect:a,nsInput:d,calculatorRef:ie,inputRef:X,menuRef:pe,tagMenuRef:ge,tooltipRef:Z,tagTooltipRef:q,selectRef:U,wrapperRef:fe,selectionRef:te,prefixRef:de,suffixRef:le,collapseItemRef:he,popperRef:ir,validateState:Ht,validateIcon:Tn,showTagList:wr,collapseTagList:Xr,debouncedOnInputChange:rr,deleteTag:lt,getLabel:C,getValue:k,getDisabled:A,getValueKey:Rr,handleClear:Yt,handleClickOutside:hr,handleDel:Vt,handleEsc:$t,focus:nt,blur:xt,handleMenuEnter:dr,handleResize:fi,resetSelectionWidth:_a,resetCalculatorWidth:Ns,updateTooltip:Te,updateTagTooltip:ke,updateOptions:pt,toggleMenu:Ze,scrollTo:fr,onInput:tr,onKeyboardNavigate:Je,onKeyboardSelect:Pt,onSelect:Ke,onHover:vn,handleCompositionStart:Re,handleCompositionEnd:Ye,handleCompositionUpdate:Ie}},bie=Ge({name:"ElSelectV2",components:{ElSelectMenu:gie,ElTag:zv,ElTooltip:os,ElIcon:Dn},directives:{ClickOutside:Rc},props:lie,emits:uie,setup(e,{emit:t}){const i=Q(()=>{const{modelValue:m,multiple:_}=e,x=_?[]:void 0;return on(m)?_?m:x:_?x:m}),a=yie(ao({...Bi(e),modelValue:i}),t);Br(tE,{props:ao({...Bi(e),height:a.popupHeight,modelValue:i}),expanded:a.expanded,tooltipRef:a.tooltipRef,onSelect:a.onSelect,onHover:a.onHover,onKeyboardNavigate:a.onKeyboardNavigate,onKeyboardSelect:a.onKeyboardSelect});const d=Q(()=>e.multiple?a.states.cachedOptions.map(m=>m.label):a.states.selectedLabel);return{...a,modelValue:i,selectedLabel:d}}});function xie(e,t,i,a,d,m){const _=Er("el-tag"),x=Er("el-tooltip"),o=Er("el-icon"),C=Er("el-select-menu"),k=Rb("click-outside");return mr((se(),Ae("div",{ref:"selectRef",class:ce([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),onMouseenter:A=>e.states.inputHovering=!0,onMouseleave:A=>e.states.inputHovering=!1},[qe(x,{ref:"tooltipRef",visible:e.dropdownMenuVisible,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,placement:e.placement,pure:"",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,trigger:"click",persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:A=>e.states.isBeforeHide=!1},{default:st(()=>[Ve("div",{ref:"wrapperRef",class:ce([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:Yn(e.toggleMenu,["prevent"])},[e.$slots.prefix?(se(),Ae("div",{key:0,ref:"prefixRef",class:ce(e.nsSelect.e("prefix"))},[_t(e.$slots,"prefix")],2)):bt("v-if",!0),Ve("div",{ref:"selectionRef",class:ce([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.modelValue.length)])},[e.multiple?_t(e.$slots,"tag",{key:0},()=>[(se(!0),Ae(Bn,null,Fr(e.showTagList,A=>(se(),Ae("div",{key:e.getValueKey(e.getValue(A)),class:ce(e.nsSelect.e("selected-item"))},[qe(_,{closable:!e.selectDisabled&&!e.getDisabled(A),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:Nn(e.tagStyle),onClose:z=>e.deleteTag(z,A)},{default:st(()=>[Ve("span",{class:ce(e.nsSelect.e("tags-text"))},[_t(e.$slots,"label",{label:e.getLabel(A),value:e.getValue(A)},()=>[$r(fn(e.getLabel(A)),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.modelValue.length>e.maxCollapseTags?(se(),It(x,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:st(()=>[Ve("div",{ref:"collapseItemRef",class:ce(e.nsSelect.e("selected-item"))},[qe(_,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,style:Nn(e.collapseTagStyle),"disable-transitions":""},{default:st(()=>[Ve("span",{class:ce(e.nsSelect.e("tags-text"))}," + "+fn(e.modelValue.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:st(()=>[Ve("div",{ref:"tagMenuRef",class:ce(e.nsSelect.e("selection"))},[(se(!0),Ae(Bn,null,Fr(e.collapseTagList,A=>(se(),Ae("div",{key:e.getValueKey(e.getValue(A)),class:ce(e.nsSelect.e("selected-item"))},[qe(_,{class:"in-tooltip",closable:!e.selectDisabled&&!e.getDisabled(A),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:z=>e.deleteTag(z,A)},{default:st(()=>[Ve("span",{class:ce(e.nsSelect.e("tags-text"))},[_t(e.$slots,"label",{label:e.getLabel(A),value:e.getValue(A)},()=>[$r(fn(e.getLabel(A)),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):bt("v-if",!0)]):bt("v-if",!0),e.selectDisabled?bt("v-if",!0):(se(),Ae("div",{key:1,class:ce([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[mr(Ve("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":A=>e.states.inputValue=A,style:Nn(e.inputStyle),autocomplete:e.autocomplete,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":e.expanded,"aria-label":e.ariaLabel,class:ce([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",name:e.name,onInput:e.onInput,onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onKeydown:[Mo(Yn(A=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"]),Mo(Yn(A=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"]),Mo(Yn(e.onKeyboardSelect,["stop","prevent"]),["enter"]),Mo(Yn(e.handleEsc,["stop","prevent"]),["esc"]),Mo(Yn(e.handleDel,["stop"]),["delete"])],onClick:Yn(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","autocomplete","aria-expanded","aria-label","disabled","readonly","name","onInput","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown","onClick"]),[[DT,e.states.inputValue]]),e.filterable?(se(),Ae("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:ce(e.nsSelect.e("input-calculator")),textContent:fn(e.states.inputValue)},null,10,["textContent"])):bt("v-if",!0)],2)),e.shouldShowPlaceholder?(se(),Ae("div",{key:2,class:ce([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?_t(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[Ve("span",null,fn(e.currentPlaceholder),1)]):(se(),Ae("span",{key:1},fn(e.currentPlaceholder),1))],2)):bt("v-if",!0)],2),Ve("div",{ref:"suffixRef",class:ce(e.nsSelect.e("suffix"))},[e.iconComponent?mr((se(),It(o,{key:0,class:ce([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.iconReverse])},{default:st(()=>[(se(),It(Ir(e.iconComponent)))]),_:1},8,["class"])),[[no,!e.showClearBtn]]):bt("v-if",!0),e.showClearBtn&&e.clearIcon?(se(),It(o,{key:1,class:ce([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.nsSelect.e("clear")]),onClick:Yn(e.handleClear,["prevent","stop"])},{default:st(()=>[(se(),It(Ir(e.clearIcon)))]),_:1},8,["class","onClick"])):bt("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(se(),It(o,{key:2,class:ce([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:st(()=>[(se(),It(Ir(e.validateIcon)))]),_:1},8,["class"])):bt("v-if",!0)],2)],10,["onClick"])]),content:st(()=>[qe(C,{ref:"menuRef",data:e.filteredOptions,width:e.popperSize,"hovering-index":e.states.hoveringIndex,"scrollbar-always-on":e.scrollbarAlwaysOn},$a({default:st(A=>[_t(e.$slots,"default",ul(Xu(A)))]),_:2},[e.$slots.header?{name:"header",fn:st(()=>[Ve("div",{class:ce(e.nsSelect.be("dropdown","header"))},[_t(e.$slots,"header")],2)])}:void 0,e.$slots.loading&&e.loading?{name:"loading",fn:st(()=>[Ve("div",{class:ce(e.nsSelect.be("dropdown","loading"))},[_t(e.$slots,"loading")],2)])}:e.loading||e.filteredOptions.length===0?{name:"empty",fn:st(()=>[Ve("div",{class:ce(e.nsSelect.be("dropdown","empty"))},[_t(e.$slots,"empty",{},()=>[Ve("span",null,fn(e.emptyText),1)])],2)])}:void 0,e.$slots.footer?{name:"footer",fn:st(()=>[Ve("div",{class:ce(e.nsSelect.be("dropdown","footer"))},[_t(e.$slots,"footer")],2)])}:void 0]),1032,["data","width","hovering-index","scrollbar-always-on"])]),_:3},8,["visible","teleported","popper-class","popper-options","fallback-placements","effect","placement","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],42,["onMouseenter","onMouseleave"])),[[k,e.handleClickOutside,e.popperRef]])}var wie=hn(bie,[["render",xie],["__file","select.vue"]]);const Sie=cr(wie),Tie=ln({animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:3},loading:{type:Boolean,default:!0},throttle:{type:at([Number,Object])}}),Cie=ln({variant:{type:String,values:["circle","rect","h1","h3","text","caption","p","image","button"],default:"text"}}),Eie=Ge({name:"ElSkeletonItem"}),Mie=Ge({...Eie,props:Cie,setup(e){const t=Jt("skeleton");return(i,a)=>(se(),Ae("div",{class:ce([y(t).e("item"),y(t).e(i.variant)])},[i.variant==="image"?(se(),It(y(HG),{key:0})):bt("v-if",!0)],2))}});var yb=hn(Mie,[["__file","skeleton-item.vue"]]);const Iie=Ge({name:"ElSkeleton"}),kie=Ge({...Iie,props:Tie,setup(e,{expose:t}){const i=e,a=Jt("skeleton"),d=N9(fo(i,"loading"),i.throttle);return t({uiLoading:d}),(m,_)=>y(d)?(se(),Ae("div",kr({key:0,class:[y(a).b(),y(a).is("animated",m.animated)]},m.$attrs),[(se(!0),Ae(Bn,null,Fr(m.count,x=>(se(),Ae(Bn,{key:x},[y(d)?_t(m.$slots,"template",{key:x},()=>[qe(yb,{class:ce(y(a).is("first")),variant:"p"},null,8,["class"]),(se(!0),Ae(Bn,null,Fr(m.rows,o=>(se(),It(yb,{key:o,class:ce([y(a).e("paragraph"),y(a).is("last",o===m.rows&&m.rows>1)]),variant:"p"},null,8,["class"]))),128))]):bt("v-if",!0)],64))),128))],16)):_t(m.$slots,"default",ul(kr({key:1},m.$attrs)))}});var Aie=hn(kie,[["__file","skeleton.vue"]]);const Pie=cr(Aie,{SkeletonItem:yb}),Rie=Jo(yb),Fz=Symbol("sliderContextKey"),Die=ln({modelValue:{type:at([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:Ei,inputSize:Ei,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:at(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:at(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:Fc,default:"top"},marks:{type:at(Object)},validateEvent:{type:Boolean,default:!0},...qi(["ariaLabel"])}),Rw=e=>Wn(e)||on(e)&&e.every(Wn),Lie={[xr]:Rw,[zs]:Rw,[No]:Rw},Oie=(e,t,i)=>{const a=be();return vr(async()=>{e.range?(on(e.modelValue)?(t.firstValue=Math.max(e.min,e.modelValue[0]),t.secondValue=Math.min(e.max,e.modelValue[1])):(t.firstValue=e.min,t.secondValue=e.max),t.oldValue=[t.firstValue,t.secondValue]):(!Wn(e.modelValue)||Number.isNaN(e.modelValue)?t.firstValue=e.min:t.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),t.oldValue=t.firstValue),yo(window,"resize",i),await Vn(),i()}),{sliderWrapper:a}},zie=e=>Q(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((i,a)=>i-a).filter(i=>i<=e.max&&i>=e.min).map(i=>({point:i,position:(i-e.min)*100/(e.max-e.min),mark:e.marks[i]})):[]),Bie=(e,t,i)=>{const{form:a,formItem:d}=bs(),m=Uo(),_=be(),x=be(),o={firstButton:_,secondButton:x},C=Q(()=>e.disabled||(a==null?void 0:a.disabled)||!1),k=Q(()=>Math.min(t.firstValue,t.secondValue)),A=Q(()=>Math.max(t.firstValue,t.secondValue)),z=Q(()=>e.range?`${100*(A.value-k.value)/(e.max-e.min)}%`:`${100*(t.firstValue-e.min)/(e.max-e.min)}%`),N=Q(()=>e.range?`${100*(k.value-e.min)/(e.max-e.min)}%`:"0%"),$=Q(()=>e.vertical?{height:e.height}:{}),F=Q(()=>e.vertical?{height:z.value,bottom:N.value}:{width:z.value,left:N.value}),G=()=>{m.value&&(t.sliderSize=m.value[`client${e.vertical?"Height":"Width"}`])},U=ue=>{const Re=e.min+ue*(e.max-e.min)/100;if(!e.range)return _;let Ye;return Math.abs(k.value-Re)<Math.abs(A.value-Re)?Ye=t.firstValue<t.secondValue?"firstButton":"secondButton":Ye=t.firstValue>t.secondValue?"firstButton":"secondButton",o[Ye]},te=ue=>{const Re=U(ue);return Re.value.setPosition(ue),Re},Z=ue=>{t.firstValue=ue??e.min,X(e.range?[k.value,A.value]:ue??e.min)},q=ue=>{t.secondValue=ue,e.range&&X([k.value,A.value])},X=ue=>{i(xr,ue),i(zs,ue)},ie=async()=>{await Vn(),i(No,e.range?[k.value,A.value]:e.modelValue)},de=ue=>{var Re,Ye,Ie,fe,Me,Se;if(C.value||t.dragging)return;G();let ye=0;if(e.vertical){const Ce=(Ie=(Ye=(Re=ue.touches)==null?void 0:Re.item(0))==null?void 0:Ye.clientY)!=null?Ie:ue.clientY;ye=(m.value.getBoundingClientRect().bottom-Ce)/t.sliderSize*100}else{const Ce=(Se=(Me=(fe=ue.touches)==null?void 0:fe.item(0))==null?void 0:Me.clientX)!=null?Se:ue.clientX,Fe=m.value.getBoundingClientRect().left;ye=(Ce-Fe)/t.sliderSize*100}if(!(ye<0||ye>100))return te(ye)};return{elFormItem:d,slider:m,firstButton:_,secondButton:x,sliderDisabled:C,minValue:k,maxValue:A,runwayStyle:$,barStyle:F,resetSize:G,setPosition:te,emitChange:ie,onSliderWrapperPrevent:ue=>{var Re,Ye;((Re=o.firstButton.value)!=null&&Re.dragging||(Ye=o.secondButton.value)!=null&&Ye.dragging)&&ue.preventDefault()},onSliderClick:ue=>{de(ue)&&ie()},onSliderDown:async ue=>{const Re=de(ue);Re&&(await Vn(),Re.value.onButtonDown(ue))},onSliderMarkerDown:ue=>{C.value||t.dragging||te(ue)},setFirstValue:Z,setSecondValue:q}},Fie=(e,t,i)=>{const a=be(),d=be(!1),m=Q(()=>t.value instanceof Function),_=Q(()=>m.value&&t.value(e.modelValue)||e.modelValue),x=Js(()=>{i.value&&(d.value=!0)},50),o=Js(()=>{i.value&&(d.value=!1)},50);return{tooltip:a,tooltipVisible:d,formatValue:_,displayTooltip:x,hideTooltip:o}},Nie=(e,t,i)=>{const{disabled:a,min:d,max:m,step:_,showTooltip:x,precision:o,sliderSize:C,formatTooltip:k,emitChange:A,resetSize:z,updateDragging:N}=kn(Fz),{tooltip:$,tooltipVisible:F,formatValue:G,displayTooltip:U,hideTooltip:te}=Fie(e,k,x),Z=be(),q=Q(()=>`${(e.modelValue-d.value)/(m.value-d.value)*100}%`),X=Q(()=>e.vertical?{bottom:q.value}:{left:q.value}),ie=()=>{t.hovering=!0,U()},de=()=>{t.hovering=!1,t.dragging||te()},le=it=>{a.value||(it.preventDefault(),Se(it),window.addEventListener("mousemove",ye),window.addEventListener("touchmove",ye),window.addEventListener("mouseup",Ce),window.addEventListener("touchend",Ce),window.addEventListener("contextmenu",Ce),Z.value.focus())},pe=it=>{a.value||(t.newPosition=Number.parseFloat(q.value)+it/(m.value-d.value)*100,Fe(t.newPosition),A())},ge=()=>{pe(-_.value)},he=()=>{pe(_.value)},ue=()=>{pe(-_.value*4)},Re=()=>{pe(_.value*4)},Ye=()=>{a.value||(Fe(0),A())},Ie=()=>{a.value||(Fe(100),A())},fe=it=>{let We=!0;switch(it.code){case En.left:case En.down:ge();break;case En.right:case En.up:he();break;case En.home:Ye();break;case En.end:Ie();break;case En.pageDown:ue();break;case En.pageUp:Re();break;default:We=!1;break}We&&it.preventDefault()},Me=it=>{let We,ut;return it.type.startsWith("touch")?(ut=it.touches[0].clientY,We=it.touches[0].clientX):(ut=it.clientY,We=it.clientX),{clientX:We,clientY:ut}},Se=it=>{t.dragging=!0,t.isClick=!0;const{clientX:We,clientY:ut}=Me(it);e.vertical?t.startY=ut:t.startX=We,t.startPosition=Number.parseFloat(q.value),t.newPosition=t.startPosition},ye=it=>{if(t.dragging){t.isClick=!1,U(),z();let We;const{clientX:ut,clientY:Lt}=Me(it);e.vertical?(t.currentY=Lt,We=(t.startY-t.currentY)/C.value*100):(t.currentX=ut,We=(t.currentX-t.startX)/C.value*100),t.newPosition=t.startPosition+We,Fe(t.newPosition)}},Ce=()=>{t.dragging&&(setTimeout(()=>{t.dragging=!1,t.hovering||te(),t.isClick||Fe(t.newPosition),A()},0),window.removeEventListener("mousemove",ye),window.removeEventListener("touchmove",ye),window.removeEventListener("mouseup",Ce),window.removeEventListener("touchend",Ce),window.removeEventListener("contextmenu",Ce))},Fe=async it=>{if(it===null||Number.isNaN(+it))return;it<0?it=0:it>100&&(it=100);const We=100/((m.value-d.value)/_.value);let Lt=Math.round(it/We)*We*(m.value-d.value)*.01+d.value;Lt=Number.parseFloat(Lt.toFixed(o.value)),Lt!==e.modelValue&&i(xr,Lt),!t.dragging&&e.modelValue!==t.oldValue&&(t.oldValue=e.modelValue),await Vn(),t.dragging&&U(),$.value.updatePopper()};return Wt(()=>t.dragging,it=>{N(it)}),yo(Z,"touchstart",le,{passive:!1}),{disabled:a,button:Z,tooltip:$,tooltipVisible:F,showTooltip:x,wrapperStyle:X,formatValue:G,handleMouseEnter:ie,handleMouseLeave:de,onButtonDown:le,onKeyDown:fe,setPosition:Fe}},$ie=(e,t,i,a)=>({stops:Q(()=>{if(!e.showStops||e.min>e.max)return[];if(e.step===0)return[];const _=(e.max-e.min)/e.step,x=100*e.step/(e.max-e.min),o=Array.from({length:_-1}).map((C,k)=>(k+1)*x);return e.range?o.filter(C=>C<100*(i.value-e.min)/(e.max-e.min)||C>100*(a.value-e.min)/(e.max-e.min)):o.filter(C=>C>100*(t.firstValue-e.min)/(e.max-e.min))}),getStopStyle:_=>e.vertical?{bottom:`${_}%`}:{left:`${_}%`}}),Vie=(e,t,i,a,d,m)=>{const _=C=>{d(xr,C),d(zs,C)},x=()=>e.range?![i.value,a.value].every((C,k)=>C===t.oldValue[k]):e.modelValue!==t.oldValue,o=()=>{var C,k;e.min>e.max&&Ci("Slider","min should not be greater than max.");const A=e.modelValue;e.range&&on(A)?A[1]<e.min?_([e.min,e.min]):A[0]>e.max?_([e.max,e.max]):A[0]<e.min?_([e.min,A[1]]):A[1]>e.max?_([A[0],e.max]):(t.firstValue=A[0],t.secondValue=A[1],x()&&(e.validateEvent&&((C=m==null?void 0:m.validate)==null||C.call(m,"change").catch(z=>void 0)),t.oldValue=A.slice())):!e.range&&Wn(A)&&!Number.isNaN(A)&&(A<e.min?_(e.min):A>e.max?_(e.max):(t.firstValue=A,x()&&(e.validateEvent&&((k=m==null?void 0:m.validate)==null||k.call(m,"change").catch(z=>void 0)),t.oldValue=A)))};o(),Wt(()=>t.dragging,C=>{C||o()}),Wt(()=>e.modelValue,(C,k)=>{t.dragging||on(C)&&on(k)&&C.every((A,z)=>A===k[z])&&t.firstValue===C[0]&&t.secondValue===C[1]||o()},{deep:!0}),Wt(()=>[e.min,e.max],()=>{o()})},Uie=ln({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:Fc,default:"top"}}),jie={[xr]:e=>Wn(e)},Hie=Ge({name:"ElSliderButton"}),Gie=Ge({...Hie,props:Uie,emits:jie,setup(e,{expose:t,emit:i}){const a=e,d=Jt("slider"),m=ao({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:a.modelValue}),{disabled:_,button:x,tooltip:o,showTooltip:C,tooltipVisible:k,wrapperStyle:A,formatValue:z,handleMouseEnter:N,handleMouseLeave:$,onButtonDown:F,onKeyDown:G,setPosition:U}=Nie(a,m,i),{hovering:te,dragging:Z}=Bi(m);return t({onButtonDown:F,onKeyDown:G,setPosition:U,hovering:te,dragging:Z}),(q,X)=>(se(),Ae("div",{ref_key:"button",ref:x,class:ce([y(d).e("button-wrapper"),{hover:y(te),dragging:y(Z)}]),style:Nn(y(A)),tabindex:y(_)?-1:0,onMouseenter:y(N),onMouseleave:y($),onMousedown:y(F),onFocus:y(N),onBlur:y($),onKeydown:y(G)},[qe(y(os),{ref_key:"tooltip",ref:o,visible:y(k),placement:q.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":q.tooltipClass,disabled:!y(C),persistent:y(C)},{content:st(()=>[Ve("span",null,fn(y(z)),1)]),default:st(()=>[Ve("div",{class:ce([y(d).e("button"),{hover:y(te),dragging:y(Z)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled","persistent"])],46,["tabindex","onMouseenter","onMouseleave","onMousedown","onFocus","onBlur","onKeydown"]))}});var NR=hn(Gie,[["__file","button.vue"]]);const Wie=ln({mark:{type:at([String,Object]),default:void 0}});var qie=Ge({name:"ElSliderMarker",props:Wie,setup(e){const t=Jt("slider"),i=Q(()=>zn(e.mark)?e.mark:e.mark.label),a=Q(()=>zn(e.mark)?void 0:e.mark.style);return()=>Kn("div",{class:t.e("marks-text"),style:a.value},i.value)}});const Kie=Ge({name:"ElSlider"}),Zie=Ge({...Kie,props:Die,emits:Lie,setup(e,{expose:t,emit:i}){const a=e,d=Jt("slider"),{t:m}=Gr(),_=ao({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:x,slider:o,firstButton:C,secondButton:k,sliderDisabled:A,minValue:z,maxValue:N,runwayStyle:$,barStyle:F,resetSize:G,emitChange:U,onSliderWrapperPrevent:te,onSliderClick:Z,onSliderDown:q,onSliderMarkerDown:X,setFirstValue:ie,setSecondValue:de}=Bie(a,_,i),{stops:le,getStopStyle:pe}=$ie(a,_,z,N),{inputId:ge,isLabeledByFormItem:he}=Sl(a,{formItemContext:x}),ue=xi(),Re=Q(()=>a.inputSize||ue.value),Ye=Q(()=>a.ariaLabel||m("el.slider.defaultLabel",{min:a.min,max:a.max})),Ie=Q(()=>a.range?a.rangeStartLabel||m("el.slider.defaultRangeStartLabel"):Ye.value),fe=Q(()=>a.formatValueText?a.formatValueText(We.value):`${We.value}`),Me=Q(()=>a.rangeEndLabel||m("el.slider.defaultRangeEndLabel")),Se=Q(()=>a.formatValueText?a.formatValueText(ut.value):`${ut.value}`),ye=Q(()=>[d.b(),d.m(ue.value),d.is("vertical",a.vertical),{[d.m("with-input")]:a.showInput}]),Ce=zie(a);Vie(a,_,z,N,i,x);const Fe=Q(()=>{const mt=[a.min,a.max,a.step].map(jt=>{const Ht=`${jt}`.split(".")[1];return Ht?Ht.length:0});return Math.max.apply(null,mt)}),{sliderWrapper:it}=Oie(a,_,G),{firstValue:We,secondValue:ut,sliderSize:Lt}=Bi(_),Ft=mt=>{_.dragging=mt};return yo(it,"touchstart",te,{passive:!1}),yo(it,"touchmove",te,{passive:!1}),Br(Fz,{...Bi(a),sliderSize:Lt,disabled:A,precision:Fe,emitChange:U,resetSize:G,updateDragging:Ft}),t({onSliderClick:Z}),(mt,jt)=>{var Ht,Tn;return se(),Ae("div",{id:mt.range?y(ge):void 0,ref_key:"sliderWrapper",ref:it,class:ce(y(ye)),role:mt.range?"group":void 0,"aria-label":mt.range&&!y(he)?y(Ye):void 0,"aria-labelledby":mt.range&&y(he)?(Ht=y(x))==null?void 0:Ht.labelId:void 0},[Ve("div",{ref_key:"slider",ref:o,class:ce([y(d).e("runway"),{"show-input":mt.showInput&&!mt.range},y(d).is("disabled",y(A))]),style:Nn(y($)),onMousedown:y(q),onTouchstartPassive:y(q)},[Ve("div",{class:ce(y(d).e("bar")),style:Nn(y(F))},null,6),qe(NR,{id:mt.range?void 0:y(ge),ref_key:"firstButton",ref:C,"model-value":y(We),vertical:mt.vertical,"tooltip-class":mt.tooltipClass,placement:mt.placement,role:"slider","aria-label":mt.range||!y(he)?y(Ie):void 0,"aria-labelledby":!mt.range&&y(he)?(Tn=y(x))==null?void 0:Tn.labelId:void 0,"aria-valuemin":mt.min,"aria-valuemax":mt.range?y(ut):mt.max,"aria-valuenow":y(We),"aria-valuetext":y(fe),"aria-orientation":mt.vertical?"vertical":"horizontal","aria-disabled":y(A),"onUpdate:modelValue":y(ie)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),mt.range?(se(),It(NR,{key:0,ref_key:"secondButton",ref:k,"model-value":y(ut),vertical:mt.vertical,"tooltip-class":mt.tooltipClass,placement:mt.placement,role:"slider","aria-label":y(Me),"aria-valuemin":y(We),"aria-valuemax":mt.max,"aria-valuenow":y(ut),"aria-valuetext":y(Se),"aria-orientation":mt.vertical?"vertical":"horizontal","aria-disabled":y(A),"onUpdate:modelValue":y(de)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):bt("v-if",!0),mt.showStops?(se(),Ae("div",{key:1},[(se(!0),Ae(Bn,null,Fr(y(le),(Pe,At)=>(se(),Ae("div",{key:At,class:ce(y(d).e("stop")),style:Nn(y(pe)(Pe))},null,6))),128))])):bt("v-if",!0),y(Ce).length>0?(se(),Ae(Bn,{key:2},[Ve("div",null,[(se(!0),Ae(Bn,null,Fr(y(Ce),(Pe,At)=>(se(),Ae("div",{key:At,style:Nn(y(pe)(Pe.position)),class:ce([y(d).e("stop"),y(d).e("marks-stop")])},null,6))),128))]),Ve("div",{class:ce(y(d).e("marks"))},[(se(!0),Ae(Bn,null,Fr(y(Ce),(Pe,At)=>(se(),It(y(qie),{key:At,mark:Pe.mark,style:Nn(y(pe)(Pe.position)),onMousedown:Yn(He=>y(X)(Pe.position),["stop"])},null,8,["mark","style","onMousedown"]))),128))],2)],64)):bt("v-if",!0)],46,["onMousedown","onTouchstartPassive"]),mt.showInput&&!mt.range?(se(),It(y(dz),{key:0,ref:"input","model-value":y(We),class:ce(y(d).e("input")),step:mt.step,disabled:y(A),controls:mt.showInputControls,min:mt.min,max:mt.max,precision:y(Fe),debounce:mt.debounce,size:y(Re),"onUpdate:modelValue":y(ie),onChange:y(U)},null,8,["model-value","class","step","disabled","controls","min","max","precision","debounce","size","onUpdate:modelValue","onChange"])):bt("v-if",!0)],10,["id","role","aria-label","aria-labelledby"])}}});var Yie=hn(Zie,[["__file","slider.vue"]]);const Xie=cr(Yie),Jie=ln({prefixCls:{type:String}}),$R=Ge({name:"ElSpaceItem",props:Jie,setup(e,{slots:t}){const i=Jt("space"),a=Q(()=>`${e.prefixCls||i.b()}__item`);return()=>Kn("div",{class:a.value},_t(t,"default"))}}),VR={small:8,default:12,large:16};function Qie(e){const t=Jt("space"),i=Q(()=>[t.b(),t.m(e.direction),e.class]),a=be(0),d=be(0),m=Q(()=>{const x=e.wrap||e.fill?{flexWrap:"wrap"}:{},o={alignItems:e.alignment},C={rowGap:`${d.value}px`,columnGap:`${a.value}px`};return[x,o,C,e.style]}),_=Q(()=>e.fill?{flexGrow:1,minWidth:`${e.fillRatio}%`}:{});return ns(()=>{const{size:x="small",wrap:o,direction:C,fill:k}=e;if(on(x)){const[A=0,z=0]=x;a.value=A,d.value=z}else{let A;Wn(x)?A=x:A=VR[x||"small"]||VR.small,(o||k)&&C==="horizontal"?a.value=d.value=A:C==="horizontal"?(a.value=A,d.value=0):(d.value=A,a.value=0)}}),{classes:i,containerStyle:m,itemStyle:_}}const ese=ln({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:at([String,Object,Array]),default:""},style:{type:at([String,Array,Object]),default:""},alignment:{type:at(String),default:"center"},prefixCls:{type:String},spacer:{type:at([Object,String,Number,Array]),default:null,validator:e=>Ho(e)||Wn(e)||zn(e)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:tc,validator:e=>Wn(e)||on(e)&&e.length===2&&e.every(Wn)}}),tse=Ge({name:"ElSpace",props:ese,setup(e,{slots:t}){const{classes:i,containerStyle:a,itemStyle:d}=Qie(e);function m(_,x="",o=[]){const{prefixCls:C}=e;return _.forEach((k,A)=>{uS(k)?on(k.children)&&k.children.forEach((z,N)=>{uS(z)&&on(z.children)?m(z.children,`${x+N}-`,o):o.push(qe($R,{style:d.value,prefixCls:C,key:`nested-${x+N}`},{default:()=>[z]},Da.PROPS|Da.STYLE,["style","prefixCls"]))}):bW(k)&&o.push(qe($R,{style:d.value,prefixCls:C,key:`LoopKey${x+A}`},{default:()=>[k]},Da.PROPS|Da.STYLE,["style","prefixCls"]))}),o}return()=>{var _;const{spacer:x,direction:o}=e,C=_t(t,"default",{key:0},()=>[]);if(((_=C.children)!=null?_:[]).length===0)return null;if(on(C.children)){let k=m(C.children);if(x){const A=k.length-1;k=k.reduce((z,N,$)=>{const F=[...z,N];return $!==A&&F.push(qe("span",{style:[d.value,o==="vertical"?"width: 100%":null],key:$},[Ho(x)?x:$r(x,Da.TEXT)],Da.STYLE)),F},[])}return qe("div",{class:i.value,style:a.value},k,Da.STYLE|Da.CLASS)}return C.children}}}),nse=cr(tse),rse=ln({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:at([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:at([String,Object,Array])}}),ose=Ge({name:"ElStatistic"}),ise=Ge({...ose,props:rse,setup(e,{expose:t}){const i=e,a=Jt("statistic"),d=Q(()=>{const{value:m,formatter:_,precision:x,decimalSeparator:o,groupSeparator:C}=i;if(Fn(_))return _(m);if(!Wn(m)||Number.isNaN(m))return m;let[k,A=""]=String(m).split(".");return A=A.padEnd(x,"0").slice(0,x>0?x:0),k=k.replace(/\B(?=(\d{3})+(?!\d))/g,C),[k,A].join(A?o:"")});return t({displayValue:d}),(m,_)=>(se(),Ae("div",{class:ce(y(a).b())},[m.$slots.title||m.title?(se(),Ae("div",{key:0,class:ce(y(a).e("head"))},[_t(m.$slots,"title",{},()=>[$r(fn(m.title),1)])],2)):bt("v-if",!0),Ve("div",{class:ce(y(a).e("content"))},[m.$slots.prefix||m.prefix?(se(),Ae("div",{key:0,class:ce(y(a).e("prefix"))},[_t(m.$slots,"prefix",{},()=>[Ve("span",null,fn(m.prefix),1)])],2)):bt("v-if",!0),Ve("span",{class:ce(y(a).e("number")),style:Nn(m.valueStyle)},fn(y(d)),7),m.$slots.suffix||m.suffix?(se(),Ae("div",{key:1,class:ce(y(a).e("suffix"))},[_t(m.$slots,"suffix",{},()=>[Ve("span",null,fn(m.suffix),1)])],2)):bt("v-if",!0)],2)],2))}});var sse=hn(ise,[["__file","statistic.vue"]]);const Nz=cr(sse),ase=ln({format:{type:String,default:"HH:mm:ss"},prefix:String,suffix:String,title:String,value:{type:at([Number,Object]),default:0},valueStyle:{type:at([String,Object,Array])}}),lse={finish:()=>!0,[No]:e=>Wn(e)},cse=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]],UR=e=>Wn(e)?new Date(e).getTime():e.valueOf(),jR=(e,t)=>{let i=e;const a=/\[([^\]]*)]/g;return cse.reduce((m,[_,x])=>{const o=new RegExp(`${_}+(?![^\\[\\]]*\\])`,"g");if(o.test(m)){const C=Math.floor(i/x);return i-=C*x,m.replace(o,k=>String(C).padStart(k.length,"0"))}return m},t).replace(a,"$1")},use=Ge({name:"ElCountdown"}),dse=Ge({...use,props:ase,emits:lse,setup(e,{expose:t,emit:i}){const a=e;let d;const m=be(0),_=Q(()=>jR(m.value,a.format)),x=k=>jR(k,a.format),o=()=>{d&&(Mh(d),d=void 0)},C=()=>{const k=UR(a.value),A=()=>{let z=k-Date.now();i("change",z),z<=0?(z=0,o(),i("finish")):d=td(A),m.value=z};d=td(A)};return vr(()=>{m.value=UR(a.value)-Date.now(),Wt(()=>[a.value,a.format],()=>{o(),C()},{immediate:!0})}),Io(()=>{o()}),t({displayValue:_}),(k,A)=>(se(),It(y(Nz),{value:m.value,title:k.title,prefix:k.prefix,suffix:k.suffix,"value-style":k.valueStyle,formatter:x},$a({_:2},[Fr(k.$slots,(z,N)=>({name:N,fn:st(()=>[_t(k.$slots,N)])}))]),1032,["value","title","prefix","suffix","value-style"]))}});var hse=hn(dse,[["__file","countdown.vue"]]);const fse=cr(hse),pse=ln({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),mse={[No]:(e,t)=>[e,t].every(Wn)},gse=Ge({name:"ElSteps"}),vse=Ge({...gse,props:pse,emits:mse,setup(e,{emit:t}){const i=e,a=Jt("steps"),{children:d,addChild:m,removeChild:_}=IC(Cr(),"ElStep");return Wt(d,()=>{d.value.forEach((x,o)=>{x.setIndex(o)})}),Br("ElSteps",{props:i,steps:d,addStep:m,removeStep:_}),Wt(()=>i.active,(x,o)=>{t(No,x,o)}),(x,o)=>(se(),Ae("div",{class:ce([y(a).b(),y(a).m(x.simple?"simple":x.direction)])},[_t(x.$slots,"default")],2))}});var _se=hn(vse,[["__file","steps.vue"]]);const yse=ln({title:{type:String,default:""},icon:{type:wo},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),bse=Ge({name:"ElStep"}),xse=Ge({...bse,props:yse,setup(e){const t=e,i=Jt("step"),a=be(-1),d=be({}),m=be(""),_=kn("ElSteps"),x=Cr();vr(()=>{Wt([()=>_.props.active,()=>_.props.processStatus,()=>_.props.finishStatus],([ie])=>{q(ie)},{immediate:!0})}),Io(()=>{_.removeStep(X.uid)});const o=Q(()=>t.status||m.value),C=Q(()=>{const ie=_.steps.value[a.value-1];return ie?ie.currentStatus:"wait"}),k=Q(()=>_.props.alignCenter),A=Q(()=>_.props.direction==="vertical"),z=Q(()=>_.props.simple),N=Q(()=>_.steps.value.length),$=Q(()=>{var ie;return((ie=_.steps.value[N.value-1])==null?void 0:ie.uid)===(x==null?void 0:x.uid)}),F=Q(()=>z.value?"":_.props.space),G=Q(()=>[i.b(),i.is(z.value?"simple":_.props.direction),i.is("flex",$.value&&!F.value&&!k.value),i.is("center",k.value&&!A.value&&!z.value)]),U=Q(()=>{const ie={flexBasis:Wn(F.value)?`${F.value}px`:F.value?F.value:`${100/(N.value-(k.value?0:1))}%`};return A.value||$.value&&(ie.maxWidth=`${100/N.value}%`),ie}),te=ie=>{a.value=ie},Z=ie=>{const de=ie==="wait",le={transitionDelay:`${de?"-":""}${150*a.value}ms`},pe=ie===_.props.processStatus||de?0:100;le.borderWidth=pe&&!z.value?"1px":0,le[_.props.direction==="vertical"?"height":"width"]=`${pe}%`,d.value=le},q=ie=>{ie>a.value?m.value=_.props.finishStatus:ie===a.value&&C.value!=="error"?m.value=_.props.processStatus:m.value="wait";const de=_.steps.value[a.value-1];de&&de.calcProgress(m.value)},X=ao({uid:x.uid,currentStatus:o,setIndex:te,calcProgress:Z});return _.addStep(X),(ie,de)=>(se(),Ae("div",{style:Nn(y(U)),class:ce(y(G))},[bt(" icon & line "),Ve("div",{class:ce([y(i).e("head"),y(i).is(y(o))])},[y(z)?bt("v-if",!0):(se(),Ae("div",{key:0,class:ce(y(i).e("line"))},[Ve("i",{class:ce(y(i).e("line-inner")),style:Nn(d.value)},null,6)],2)),Ve("div",{class:ce([y(i).e("icon"),y(i).is(ie.icon||ie.$slots.icon?"icon":"text")])},[_t(ie.$slots,"icon",{},()=>[ie.icon?(se(),It(y(Dn),{key:0,class:ce(y(i).e("icon-inner"))},{default:st(()=>[(se(),It(Ir(ie.icon)))]),_:1},8,["class"])):y(o)==="success"?(se(),It(y(Dn),{key:1,class:ce([y(i).e("icon-inner"),y(i).is("status")])},{default:st(()=>[qe(y(n_))]),_:1},8,["class"])):y(o)==="error"?(se(),It(y(Dn),{key:2,class:ce([y(i).e("icon-inner"),y(i).is("status")])},{default:st(()=>[qe(y(vl))]),_:1},8,["class"])):y(z)?bt("v-if",!0):(se(),Ae("div",{key:3,class:ce(y(i).e("icon-inner"))},fn(a.value+1),3))])],2)],2),bt(" title & description "),Ve("div",{class:ce(y(i).e("main"))},[Ve("div",{class:ce([y(i).e("title"),y(i).is(y(o))])},[_t(ie.$slots,"title",{},()=>[$r(fn(ie.title),1)])],2),y(z)?(se(),Ae("div",{key:0,class:ce(y(i).e("arrow"))},null,2)):(se(),Ae("div",{key:1,class:ce([y(i).e("description"),y(i).is(y(o))])},[_t(ie.$slots,"description",{},()=>[$r(fn(ie.description),1)])],2))],2)],6))}});var $z=hn(xse,[["__file","item.vue"]]);const wse=cr(_se,{Step:$z}),Sse=Jo($z),Tse=ln({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:jO},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:wo},activeActionIcon:{type:wo},activeIcon:{type:wo},inactiveIcon:{type:wo},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:at(Function)},id:String,tabindex:{type:[String,Number]},...qi(["ariaLabel"])}),Cse={[xr]:e=>ko(e)||zn(e)||Wn(e),[No]:e=>ko(e)||zn(e)||Wn(e),[zs]:e=>ko(e)||zn(e)||Wn(e)},Vz="ElSwitch",Ese=Ge({name:Vz}),Mse=Ge({...Ese,props:Tse,emits:Cse,setup(e,{expose:t,emit:i}){const a=e,{formItem:d}=bs(),m=xi(),_=Jt("switch"),{inputId:x}=Sl(a,{formItemContext:d}),o=ys(Q(()=>a.loading)),C=be(a.modelValue!==!1),k=be(),A=be(),z=Q(()=>[_.b(),_.m(m.value),_.is("disabled",o.value),_.is("checked",U.value)]),N=Q(()=>[_.e("label"),_.em("label","left"),_.is("active",!U.value)]),$=Q(()=>[_.e("label"),_.em("label","right"),_.is("active",U.value)]),F=Q(()=>({width:li(a.width)}));Wt(()=>a.modelValue,()=>{C.value=!0});const G=Q(()=>C.value?a.modelValue:!1),U=Q(()=>G.value===a.activeValue);[a.activeValue,a.inactiveValue].includes(G.value)||(i(xr,a.inactiveValue),i(No,a.inactiveValue),i(zs,a.inactiveValue)),Wt(U,X=>{var ie;k.value.checked=X,a.validateEvent&&((ie=d==null?void 0:d.validate)==null||ie.call(d,"change").catch(de=>void 0))});const te=()=>{const X=U.value?a.inactiveValue:a.activeValue;i(xr,X),i(No,X),i(zs,X),Vn(()=>{k.value.checked=U.value})},Z=()=>{if(o.value)return;const{beforeChange:X}=a;if(!X){te();return}const ie=X();[vv(ie),ko(ie)].includes(!0)||Ci(Vz,"beforeChange must return type `Promise<boolean>` or `boolean`"),vv(ie)?ie.then(le=>{le&&te()}).catch(le=>{}):ie&&te()},q=()=>{var X,ie;(ie=(X=k.value)==null?void 0:X.focus)==null||ie.call(X)};return vr(()=>{k.value.checked=U.value}),t({focus:q,checked:U}),(X,ie)=>(se(),Ae("div",{class:ce(y(z)),onClick:Yn(Z,["prevent"])},[Ve("input",{id:y(x),ref_key:"input",ref:k,class:ce(y(_).e("input")),type:"checkbox",role:"switch","aria-checked":y(U),"aria-disabled":y(o),"aria-label":X.ariaLabel,name:X.name,"true-value":X.activeValue,"false-value":X.inactiveValue,disabled:y(o),tabindex:X.tabindex,onChange:te,onKeydown:Mo(Z,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!X.inlinePrompt&&(X.inactiveIcon||X.inactiveText)?(se(),Ae("span",{key:0,class:ce(y(N))},[X.inactiveIcon?(se(),It(y(Dn),{key:0},{default:st(()=>[(se(),It(Ir(X.inactiveIcon)))]),_:1})):bt("v-if",!0),!X.inactiveIcon&&X.inactiveText?(se(),Ae("span",{key:1,"aria-hidden":y(U)},fn(X.inactiveText),9,["aria-hidden"])):bt("v-if",!0)],2)):bt("v-if",!0),Ve("span",{ref_key:"core",ref:A,class:ce(y(_).e("core")),style:Nn(y(F))},[X.inlinePrompt?(se(),Ae("div",{key:0,class:ce(y(_).e("inner"))},[X.activeIcon||X.inactiveIcon?(se(),It(y(Dn),{key:0,class:ce(y(_).is("icon"))},{default:st(()=>[(se(),It(Ir(y(U)?X.activeIcon:X.inactiveIcon)))]),_:1},8,["class"])):X.activeText||X.inactiveText?(se(),Ae("span",{key:1,class:ce(y(_).is("text")),"aria-hidden":!y(U)},fn(y(U)?X.activeText:X.inactiveText),11,["aria-hidden"])):bt("v-if",!0)],2)):bt("v-if",!0),Ve("div",{class:ce(y(_).e("action"))},[X.loading?(se(),It(y(Dn),{key:0,class:ce(y(_).is("loading"))},{default:st(()=>[qe(y(Kl))]),_:1},8,["class"])):y(U)?_t(X.$slots,"active-action",{key:1},()=>[X.activeActionIcon?(se(),It(y(Dn),{key:0},{default:st(()=>[(se(),It(Ir(X.activeActionIcon)))]),_:1})):bt("v-if",!0)]):y(U)?bt("v-if",!0):_t(X.$slots,"inactive-action",{key:2},()=>[X.inactiveActionIcon?(se(),It(y(Dn),{key:0},{default:st(()=>[(se(),It(Ir(X.inactiveActionIcon)))]),_:1})):bt("v-if",!0)])],2)],6),!X.inlinePrompt&&(X.activeIcon||X.activeText)?(se(),Ae("span",{key:1,class:ce(y($))},[X.activeIcon?(se(),It(y(Dn),{key:0},{default:st(()=>[(se(),It(Ir(X.activeIcon)))]),_:1})):bt("v-if",!0),!X.activeIcon&&X.activeText?(se(),Ae("span",{key:1,"aria-hidden":!y(U)},fn(X.activeText),9,["aria-hidden"])):bt("v-if",!0)],2)):bt("v-if",!0)],10,["onClick"]))}});var Ise=hn(Mse,[["__file","switch.vue"]]);const kse=cr(Ise),Dw=function(e){var t;return(t=e.target)==null?void 0:t.closest("td")},Ase=function(e,t,i,a,d){if(!t&&!a&&(!d||on(d)&&!d.length))return e;zn(i)?i=i==="descending"?-1:1:i=i&&i<0?-1:1;const m=a?null:function(x,o){return d?(on(d)||(d=[d]),d.map(C=>zn(C)?mi(x,C):C(x,o,e))):(t!=="$key"&&Tr(x)&&"$value"in x&&(x=x.$value),[Tr(x)?mi(x,t):x])},_=function(x,o){if(a)return a(x.value,o.value);for(let C=0,k=x.key.length;C<k;C++){if(x.key[C]<o.key[C])return-1;if(x.key[C]>o.key[C])return 1}return 0};return e.map((x,o)=>({value:x,index:o,key:m?m(x,o):null})).sort((x,o)=>{let C=_(x,o);return C||(C=x.index-o.index),C*+i}).map(x=>x.value)},Uz=function(e,t){let i=null;return e.columns.forEach(a=>{a.id===t&&(i=a)}),i},Pse=function(e,t){let i=null;for(let a=0;a<e.columns.length;a++){const d=e.columns[a];if(d.columnKey===t){i=d;break}}return i||Ci("ElTable",`No column matching with column-key: ${t}`),i},HR=function(e,t,i){const a=(t.className||"").match(new RegExp(`${i}-table_[^\\s]+`,"gm"));return a?Uz(e,a[0]):null},gs=(e,t)=>{if(!e)throw new Error("Row is required when get row identity");if(zn(t)){if(!t.includes("."))return`${e[t]}`;const i=t.split(".");let a=e;for(const d of i)a=a[d];return`${a}`}else if(Fn(t))return t.call(null,e)},ph=function(e,t){const i={};return(e||[]).forEach((a,d)=>{i[gs(a,t)]={row:a,index:d}}),i};function Rse(e,t){const i={};let a;for(a in e)i[a]=e[a];for(a in t)if(Qr(t,a)){const d=t[a];typeof d<"u"&&(i[a]=d)}return i}function nE(e){return e===""||e!==void 0&&(e=Number.parseInt(e,10),Number.isNaN(e)&&(e="")),e}function jz(e){return e===""||e!==void 0&&(e=nE(e),Number.isNaN(e)&&(e=80)),e}function Dse(e){return Wn(e)?e:zn(e)?/^\d+(?:px)?$/.test(e)?Number.parseInt(e,10):e:null}function Lse(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,i)=>(...a)=>t(i(...a)))}function bb(e,t,i,a,d,m){let _=m??0,x=!1;const o=e.indexOf(t),C=o!==-1,k=d==null?void 0:d.call(null,t,m),A=N=>{N==="add"?e.push(t):e.splice(o,1),x=!0},z=N=>{let $=0;const F=(a==null?void 0:a.children)&&N[a.children];return F&&on(F)&&($+=F.length,F.forEach(G=>{$+=z(G)})),$};return(!d||k)&&(ko(i)?i&&!C?A("add"):!i&&C&&A("remove"):A(C?"remove":"add")),!(a!=null&&a.checkStrictly)&&(a!=null&&a.children)&&on(t[a.children])&&t[a.children].forEach(N=>{bb(e,N,i??!C,a,d,_+1),_+=z(N)+1}),x}function Ose(e,t,i="children",a="hasChildren"){const d=_=>!(on(_)&&_.length);function m(_,x,o){t(_,x,o),x.forEach(C=>{if(C[a]){t(C,null,o+1);return}const k=C[i];d(k)||m(C,k,o+1)})}e.forEach(_=>{if(_[a]){t(_,null,0);return}const x=_[i];d(x)||m(_,x,0)})}const GR=(e,t)=>({content:t,...e,popperOptions:{strategy:"fixed",...e.popperOptions}});let Ra=null;function zse(e,t,i,a){if((Ra==null?void 0:Ra.trigger)===i){RO(Ra.vm.component.props,GR(e,t));return}Ra==null||Ra();const d=a==null?void 0:a.refs.tableWrapper,m=d==null?void 0:d.dataset.prefix,_=qe(os,{virtualTriggering:!0,virtualRef:i,appendTo:d,placement:"top",transition:"none",offset:0,hideAfter:0,...GR(e,t)});_.appContext={...a.appContext,...a};const x=document.createElement("div");Qu(_,x),_.component.exposed.onOpen();const o=d==null?void 0:d.querySelector(`.${m}-scrollbar__wrap`);Ra=()=>{Qu(null,x),o==null||o.removeEventListener("scroll",Ra),Ra=null},Ra.trigger=i,Ra.vm=_,o==null||o.addEventListener("scroll",Ra)}function Hz(e){return e.children?FH(e.children,Hz):[e]}function WR(e,t){return e+t.colSpan}const Gz=(e,t,i,a)=>{let d=0,m=e;const _=i.states.columns.value;if(a){const o=Hz(a[e]);d=_.slice(0,_.indexOf(o[0])).reduce(WR,0),m=d+o.reduce(WR,0)-1}else d=e;let x;switch(t){case"left":m<i.states.fixedLeafColumnsLength.value&&(x="left");break;case"right":d>=_.length-i.states.rightFixedLeafColumnsLength.value&&(x="right");break;default:m<i.states.fixedLeafColumnsLength.value?x="left":d>=_.length-i.states.rightFixedLeafColumnsLength.value&&(x="right")}return x?{direction:x,start:d,after:m}:{}},rE=(e,t,i,a,d,m=0)=>{const _=[],{direction:x,start:o,after:C}=Gz(t,i,a,d);if(x){const k=x==="left";_.push(`${e}-fixed-column--${x}`),k&&C+m===a.states.fixedLeafColumnsLength.value-1?_.push("is-last-column"):!k&&o-m===a.states.columns.value.length-a.states.rightFixedLeafColumnsLength.value&&_.push("is-first-column")}return _};function qR(e,t){return e+(t.realWidth===null||Number.isNaN(t.realWidth)?Number(t.width):t.realWidth)}const oE=(e,t,i,a)=>{const{direction:d,start:m=0,after:_=0}=Gz(e,t,i,a);if(!d)return;const x={},o=d==="left",C=i.states.columns.value;return o?x.left=C.slice(0,m).reduce(qR,0):x.right=C.slice(_+1).reverse().reduce(qR,0),x},Up=(e,t)=>{e&&(Number.isNaN(e[t])||(e[t]=`${e[t]}px`))};function Bse(e){const t=Cr(),i=be(!1),a=be([]);return{updateExpandRows:()=>{const o=e.data.value||[],C=e.rowKey.value;if(i.value)a.value=o.slice();else if(C){const k=ph(a.value,C);a.value=o.reduce((A,z)=>{const N=gs(z,C);return k[N]&&A.push(z),A},[])}else a.value=[]},toggleRowExpansion:(o,C)=>{bb(a.value,o,C)&&t.emit("expand-change",o,a.value.slice())},setExpandRowKeys:o=>{t.store.assertRowKey();const C=e.data.value||[],k=e.rowKey.value,A=ph(C,k);a.value=o.reduce((z,N)=>{const $=A[N];return $&&z.push($.row),z},[])},isRowExpanded:o=>{const C=e.rowKey.value;return C?!!ph(a.value,C)[gs(o,C)]:a.value.includes(o)},states:{expandRows:a,defaultExpandAll:i}}}function Fse(e){const t=Cr(),i=be(null),a=be(null),d=C=>{t.store.assertRowKey(),i.value=C,_(C)},m=()=>{i.value=null},_=C=>{const{data:k,rowKey:A}=e;let z=null;A.value&&(z=(y(k)||[]).find(N=>gs(N,A.value)===C)),a.value=z,t.emit("current-change",a.value,null)};return{setCurrentRowKey:d,restoreCurrentRowKey:m,setCurrentRowByKey:_,updateCurrentRow:C=>{const k=a.value;if(C&&C!==k){a.value=C,t.emit("current-change",a.value,k);return}!C&&k&&(a.value=null,t.emit("current-change",null,k))},updateCurrentRowData:()=>{const C=e.rowKey.value,k=e.data.value||[],A=a.value;if(!k.includes(A)&&A){if(C){const z=gs(A,C);_(z)}else a.value=null;a.value===null&&t.emit("current-change",null,A)}else i.value&&(_(i.value),m())},states:{_currentRowKey:i,currentRow:a}}}function Nse(e){const t=be([]),i=be({}),a=be(16),d=be(!1),m=be({}),_=be("hasChildren"),x=be("children"),o=be(!1),C=Cr(),k=Q(()=>{if(!e.rowKey.value)return{};const Z=e.data.value||[];return z(Z)}),A=Q(()=>{const Z=e.rowKey.value,q=Object.keys(m.value),X={};return q.length&&q.forEach(ie=>{if(m.value[ie].length){const de={children:[]};m.value[ie].forEach(le=>{const pe=gs(le,Z);de.children.push(pe),le[_.value]&&!X[pe]&&(X[pe]={children:[]})}),X[ie]=de}}),X}),z=Z=>{const q=e.rowKey.value,X={};return Ose(Z,(ie,de,le)=>{const pe=gs(ie,q);on(de)?X[pe]={children:de.map(ge=>gs(ge,q)),level:le}:d.value&&(X[pe]={children:[],lazy:!0,level:le})},x.value,_.value),X},N=(Z=!1,q=(X=>(X=C.store)==null?void 0:X.states.defaultExpandAll.value)())=>{var X;const ie=k.value,de=A.value,le=Object.keys(ie),pe={};if(le.length){const ge=y(i),he=[],ue=(Ye,Ie)=>{if(Z)return t.value?q||t.value.includes(Ie):!!(q||Ye!=null&&Ye.expanded);{const fe=q||t.value&&t.value.includes(Ie);return!!(Ye!=null&&Ye.expanded||fe)}};le.forEach(Ye=>{const Ie=ge[Ye],fe={...ie[Ye]};if(fe.expanded=ue(Ie,Ye),fe.lazy){const{loaded:Me=!1,loading:Se=!1}=Ie||{};fe.loaded=!!Me,fe.loading=!!Se,he.push(Ye)}pe[Ye]=fe});const Re=Object.keys(de);d.value&&Re.length&&he.length&&Re.forEach(Ye=>{const Ie=ge[Ye],fe=de[Ye].children;if(he.includes(Ye)){if(pe[Ye].children.length!==0)throw new Error("[ElTable]children must be an empty array.");pe[Ye].children=fe}else{const{loaded:Me=!1,loading:Se=!1}=Ie||{};pe[Ye]={lazy:!0,loaded:!!Me,loading:!!Se,expanded:ue(Ie,Ye),children:fe,level:""}}})}i.value=pe,(X=C.store)==null||X.updateTableScrollY()};Wt(()=>t.value,()=>{N(!0)}),Wt(()=>k.value,()=>{N()}),Wt(()=>A.value,()=>{N()});const $=Z=>{t.value=Z,N()},F=(Z,q)=>{C.store.assertRowKey();const X=e.rowKey.value,ie=gs(Z,X),de=ie&&i.value[ie];if(ie&&de&&"expanded"in de){const le=de.expanded;q=Bo(q)?!de.expanded:q,i.value[ie].expanded=q,le!==q&&C.emit("expand-change",Z,q),C.store.updateTableScrollY()}},G=Z=>{C.store.assertRowKey();const q=e.rowKey.value,X=gs(Z,q),ie=i.value[X];d.value&&ie&&"loaded"in ie&&!ie.loaded?U(Z,X,ie):F(Z,void 0)},U=(Z,q,X)=>{const{load:ie}=C.props;ie&&!i.value[q].loaded&&(i.value[q].loading=!0,ie(Z,X,de=>{if(!on(de))throw new TypeError("[ElTable] data must be an array");i.value[q].loading=!1,i.value[q].loaded=!0,i.value[q].expanded=!0,de.length&&(m.value[q]=de),C.emit("expand-change",Z,!0)}))};return{loadData:U,loadOrToggle:G,toggleTreeExpansion:F,updateTreeExpandKeys:$,updateTreeData:N,updateKeyChildren:(Z,q)=>{const{lazy:X,rowKey:ie}=C.props;if(X){if(!ie)throw new Error("[Table] rowKey is required in updateKeyChild");m.value[Z]&&(m.value[Z]=q)}},normalize:z,states:{expandRowKeys:t,treeData:i,indent:a,lazy:d,lazyTreeNodeMap:m,lazyColumnIdentifier:_,childrenColumnName:x,checkStrictly:o}}}const $se=(e,t)=>{const i=t.sortingColumn;return!i||zn(i.sortable)?e:Ase(e,t.sortProp,t.sortOrder,i.sortMethod,i.sortBy)},F0=e=>{const t=[];return e.forEach(i=>{i.children&&i.children.length>0?t.push.apply(t,F0(i.children)):t.push(i)}),t};function Vse(){var e;const t=Cr(),{size:i}=Bi((e=t.proxy)==null?void 0:e.$props),a=be(null),d=be([]),m=be([]),_=be(!1),x=be([]),o=be([]),C=be([]),k=be([]),A=be([]),z=be([]),N=be([]),$=be([]),F=[],G=be(0),U=be(0),te=be(0),Z=be(!1),q=be([]),X=be(!1),ie=be(!1),de=be(null),le=be({}),pe=be(null),ge=be(null),he=be(null),ue=be(null),Re=be(null);Wt(d,()=>{var Rt;t.state&&(Se(!1),t.props.tableLayout==="auto"&&((Rt=t.refs.tableHeaderRef)==null||Rt.updateFixedColumnStyle()))},{deep:!0});const Ye=()=>{if(!a.value)throw new Error("[ElTable] prop row-key is required")},Ie=Rt=>{var _n;(_n=Rt.children)==null||_n.forEach(dt=>{dt.fixed=Rt.fixed,Ie(dt)})};let fe;const Me=()=>{x.value.forEach(Ze=>{Ie(Ze)}),k.value=x.value.filter(Ze=>Ze.fixed===!0||Ze.fixed==="left"),A.value=x.value.filter(Ze=>Ze.fixed==="right"),Bo(fe)&&x.value[0]&&x.value[0].type==="selection"&&(fe=!!x.value[0].fixed),k.value.length>0&&x.value[0]&&x.value[0].type==="selection"&&(x.value[0].fixed?k.value.some(gn=>gn.type!=="selection")?fe=void 0:(x.value[0].fixed=fe,fe||k.value.shift()):(x.value[0].fixed=!0,k.value.unshift(x.value[0])));const Rt=x.value.filter(Ze=>!Ze.fixed);o.value=[].concat(k.value).concat(Rt).concat(A.value);const _n=F0(Rt),dt=F0(k.value),tn=F0(A.value);G.value=_n.length,U.value=dt.length,te.value=tn.length,C.value=[].concat(dt).concat(_n).concat(tn),_.value=k.value.length>0||A.value.length>0},Se=(Rt,_n=!1)=>{Rt&&Me(),_n?t.state.doLayout():t.state.debouncedUpdateLayout()},ye=Rt=>q.value.some(_n=>Gi(_n,Rt)),Ce=()=>{Z.value=!1;const Rt=q.value;q.value=[],Rt.length&&t.emit("selection-change",[])},Fe=()=>{let Rt;if(a.value){Rt=[];const _n=ph(q.value,a.value),dt=ph(d.value,a.value);for(const tn in _n)Qr(_n,tn)&&!dt[tn]&&Rt.push(_n[tn].row)}else Rt=q.value.filter(_n=>!d.value.includes(_n));if(Rt.length){const _n=q.value.filter(dt=>!Rt.includes(dt));q.value=_n,t.emit("selection-change",_n.slice())}},it=()=>(q.value||[]).slice(),We=(Rt,_n,dt=!0,tn=!1)=>{var Ze,gn,rr,Hn;const eo={children:(gn=(Ze=t==null?void 0:t.store)==null?void 0:Ze.states)==null?void 0:gn.childrenColumnName.value,checkStrictly:(Hn=(rr=t==null?void 0:t.store)==null?void 0:rr.states)==null?void 0:Hn.checkStrictly.value};if(bb(q.value,Rt,_n,eo,tn?void 0:de.value)){const mo=(q.value||[]).slice();dt&&t.emit("select",mo,Rt),t.emit("selection-change",mo)}},ut=()=>{var Rt,_n;const dt=ie.value?!Z.value:!(Z.value||q.value.length);Z.value=dt;let tn=!1,Ze=0;const gn=(_n=(Rt=t==null?void 0:t.store)==null?void 0:Rt.states)==null?void 0:_n.rowKey.value,{childrenColumnName:rr}=t.store.states,Hn={children:rr.value,checkStrictly:!1};d.value.forEach((eo,Mi)=>{const mo=Mi+Ze;bb(q.value,eo,dt,Hn,de.value,mo)&&(tn=!0),Ze+=mt(gs(eo,gn))}),tn&&t.emit("selection-change",q.value?q.value.slice():[]),t.emit("select-all",(q.value||[]).slice())},Lt=()=>{const Rt=ph(q.value,a.value);d.value.forEach(_n=>{const dt=gs(_n,a.value),tn=Rt[dt];tn&&(q.value[tn.index]=_n)})},Ft=()=>{var Rt;if(((Rt=d.value)==null?void 0:Rt.length)===0){Z.value=!1;return}const{childrenColumnName:_n}=t.store.states,dt=a.value?ph(q.value,a.value):void 0;let tn=0,Ze=0;const gn=eo=>dt?!!dt[gs(eo,a.value)]:q.value.includes(eo),rr=eo=>{var Mi;for(const mo of eo){const bo=de.value&&de.value.call(null,mo,tn);if(gn(mo))Ze++;else if(!de.value||bo)return!1;if(tn++,(Mi=mo[_n.value])!=null&&Mi.length&&!rr(mo[_n.value]))return!1}return!0},Hn=rr(d.value||[]);Z.value=Ze===0?!1:Hn},mt=Rt=>{var _n;if(!t||!t.store)return 0;const{treeData:dt}=t.store.states;let tn=0;const Ze=(_n=dt.value[Rt])==null?void 0:_n.children;return Ze&&(tn+=Ze.length,Ze.forEach(gn=>{tn+=mt(gn)})),tn},jt=(Rt,_n)=>{on(Rt)||(Rt=[Rt]);const dt={};return Rt.forEach(tn=>{le.value[tn.id]=_n,dt[tn.columnKey||tn.id]=_n}),dt},Ht=(Rt,_n,dt)=>{ge.value&&ge.value!==Rt&&(ge.value.order=null),ge.value=Rt,he.value=_n,ue.value=dt},Tn=()=>{let Rt=y(m);Object.keys(le.value).forEach(_n=>{const dt=le.value[_n];if(!dt||dt.length===0)return;const tn=Uz({columns:C.value},_n);tn&&tn.filterMethod&&(Rt=Rt.filter(Ze=>dt.some(gn=>tn.filterMethod.call(null,gn,Ze,tn))))}),pe.value=Rt},Pe=()=>{d.value=$se(pe.value,{sortingColumn:ge.value,sortProp:he.value,sortOrder:ue.value})},At=(Rt=void 0)=>{Rt&&Rt.filter||Tn(),Pe()},He=Rt=>{const{tableHeaderRef:_n}=t.refs;if(!_n)return;const dt=Object.assign({},_n.filterPanels),tn=Object.keys(dt);if(tn.length)if(zn(Rt)&&(Rt=[Rt]),on(Rt)){const Ze=Rt.map(gn=>Pse({columns:C.value},gn));tn.forEach(gn=>{const rr=Ze.find(Hn=>Hn.id===gn);rr&&(rr.filteredValue=[])}),t.store.commit("filterChange",{column:Ze,values:[],silent:!0,multi:!0})}else tn.forEach(Ze=>{const gn=C.value.find(rr=>rr.id===Ze);gn&&(gn.filteredValue=[])}),le.value={},t.store.commit("filterChange",{column:{},values:[],silent:!0})},pt=()=>{ge.value&&(Ht(null,null,null),t.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:et,toggleRowExpansion:rn,updateExpandRows:kt,states:zt,isRowExpanded:Mt}=Bse({data:d,rowKey:a}),{updateTreeExpandKeys:en,toggleTreeExpansion:sn,updateTreeData:dn,updateKeyChildren:Pn,loadOrToggle:Ot,states:Zt}=Nse({data:d,rowKey:a}),{updateCurrentRowData:jn,updateCurrentRow:ir,setCurrentRowKey:ur,states:ar}=Fse({data:d,rowKey:a});return{assertRowKey:Ye,updateColumns:Me,scheduleLayout:Se,isSelected:ye,clearSelection:Ce,cleanSelection:Fe,getSelectionRows:it,toggleRowSelection:We,_toggleAllSelection:ut,toggleAllSelection:null,updateSelectionByRowKey:Lt,updateAllSelected:Ft,updateFilters:jt,updateCurrentRow:ir,updateSort:Ht,execFilter:Tn,execSort:Pe,execQuery:At,clearFilter:He,clearSort:pt,toggleRowExpansion:rn,setExpandRowKeysAdapter:Rt=>{et(Rt),en(Rt)},setCurrentRowKey:ur,toggleRowExpansionAdapter:(Rt,_n)=>{C.value.some(({type:tn})=>tn==="expand")?rn(Rt,_n):sn(Rt,_n)},isRowExpanded:Mt,updateExpandRows:kt,updateCurrentRowData:jn,loadOrToggle:Ot,updateTreeData:dn,updateKeyChildren:Pn,states:{tableSize:i,rowKey:a,data:d,_data:m,isComplex:_,_columns:x,originColumns:o,columns:C,fixedColumns:k,rightFixedColumns:A,leafColumns:z,fixedLeafColumns:N,rightFixedLeafColumns:$,updateOrderFns:F,leafColumnsLength:G,fixedLeafColumnsLength:U,rightFixedLeafColumnsLength:te,isAllSelected:Z,selection:q,reserveSelection:X,selectOnIndeterminate:ie,selectable:de,filters:le,filteredData:pe,sortingColumn:ge,sortProp:he,sortOrder:ue,hoverRow:Re,...zt,...Zt,...ar}}}function XS(e,t){return e.map(i=>{var a;return i.id===t.id?t:((a=i.children)!=null&&a.length&&(i.children=XS(i.children,t)),i)})}function JS(e){e.forEach(t=>{var i,a;t.no=(i=t.getColumnIndex)==null?void 0:i.call(t),(a=t.children)!=null&&a.length&&JS(t.children)}),e.sort((t,i)=>t.no-i.no)}function Use(){const e=Cr(),t=Vse();return{ns:Jt("table"),...t,mutations:{setData(_,x){const o=y(_._data)!==x;_.data.value=x,_._data.value=x,e.store.execQuery(),e.store.updateCurrentRowData(),e.store.updateExpandRows(),e.store.updateTreeData(e.store.states.defaultExpandAll.value),y(_.reserveSelection)?(e.store.assertRowKey(),e.store.updateSelectionByRowKey()):o?e.store.clearSelection():e.store.cleanSelection(),e.store.updateAllSelected(),e.$ready&&e.store.scheduleLayout()},insertColumn(_,x,o,C){const k=y(_._columns);let A=[];o?(o&&!o.children&&(o.children=[]),o.children.push(x),A=XS(k,o)):(k.push(x),A=k),JS(A),_._columns.value=A,_.updateOrderFns.push(C),x.type==="selection"&&(_.selectable.value=x.selectable,_.reserveSelection.value=x.reserveSelection),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},updateColumnOrder(_,x){var o;((o=x.getColumnIndex)==null?void 0:o.call(x))!==x.no&&(JS(_._columns.value),e.$ready&&e.store.updateColumns())},removeColumn(_,x,o,C){const k=y(_._columns)||[];if(o)o.children.splice(o.children.findIndex(z=>z.id===x.id),1),Vn(()=>{var z;((z=o.children)==null?void 0:z.length)===0&&delete o.children}),_._columns.value=XS(k,o);else{const z=k.indexOf(x);z>-1&&(k.splice(z,1),_._columns.value=k)}const A=_.updateOrderFns.indexOf(C);A>-1&&_.updateOrderFns.splice(A,1),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},sort(_,x){const{prop:o,order:C,init:k}=x;if(o){const A=y(_.columns).find(z=>z.property===o);A&&(A.order=C,e.store.updateSort(A,o,C),e.store.commit("changeSortCondition",{init:k}))}},changeSortCondition(_,x){const{sortingColumn:o,sortProp:C,sortOrder:k}=_,A=y(o),z=y(C),N=y(k);N===null&&(_.sortingColumn.value=null,_.sortProp.value=null);const $={filter:!0};e.store.execQuery($),(!x||!(x.silent||x.init))&&e.emit("sort-change",{column:A,prop:z,order:N}),e.store.updateTableScrollY()},filterChange(_,x){const{column:o,values:C,silent:k}=x,A=e.store.updateFilters(o,C);e.store.execQuery(),k||e.emit("filter-change",A),e.store.updateTableScrollY()},toggleAllSelection(){e.store.toggleAllSelection()},rowSelectedChanged(_,x){e.store.toggleRowSelection(x),e.store.updateAllSelected()},setHoverRow(_,x){_.hoverRow.value=x},setCurrentRow(_,x){e.store.updateCurrentRow(x)}},commit:function(_,...x){const o=e.store.mutations;if(o[_])o[_].apply(e,[e.store.states].concat(x));else throw new Error(`Action not found: ${_}`)},updateTableScrollY:function(){Vn(()=>e.layout.updateScrollY.apply(e.layout))}}}const gv={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"},"treeProps.checkStrictly":{key:"checkStrictly",default:!1}};function jse(e,t){if(!e)throw new Error("Table is required.");const i=Use();return i.toggleAllSelection=Js(i._toggleAllSelection,10),Object.keys(gv).forEach(a=>{Wz(qz(t,a),a,i)}),Hse(i,t),i}function Hse(e,t){Object.keys(gv).forEach(i=>{Wt(()=>qz(t,i),a=>{Wz(a,i,e)})})}function Wz(e,t,i){let a=e,d=gv[t];typeof gv[t]=="object"&&(d=d.key,a=a||gv[t].default),i.states[d].value=a}function qz(e,t){if(t.includes(".")){const i=t.split(".");let a=e;return i.forEach(d=>{a=a[d]}),a}else return e[t]}class Gse{constructor(t){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=be(null),this.scrollX=be(!1),this.scrollY=be(!1),this.bodyWidth=be(null),this.fixedWidth=be(null),this.rightFixedWidth=be(null),this.gutterWidth=0;for(const i in t)Qr(t,i)&&(Fo(this[i])?this[i].value=t[i]:this[i]=t[i]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){if(this.height.value===null)return!1;const i=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(i!=null&&i.wrapRef)){let a=!0;const d=this.scrollY.value;return a=i.wrapRef.scrollHeight>i.wrapRef.clientHeight,this.scrollY.value=a,d!==a}return!1}setHeight(t,i="height"){if(!Hr)return;const a=this.table.vnode.el;if(t=Dse(t),this.height.value=Number(t),!a&&(t||t===0))return Vn(()=>this.setHeight(t,i));Wn(t)?(a.style[i]=`${t}px`,this.updateElsHeight()):zn(t)&&(a.style[i]=t,this.updateElsHeight())}setMaxHeight(t){this.setHeight(t,"max-height")}getFlattenColumns(){const t=[];return this.table.store.states.columns.value.forEach(a=>{a.isColumnGroup?t.push.apply(t,a.columns):t.push(a)}),t}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(t){if(!t)return!0;let i=t;for(;i.tagName!=="DIV";){if(getComputedStyle(i).display==="none")return!0;i=i.parentElement}return!1}updateColumnsWidth(){if(!Hr)return;const t=this.fit,i=this.table.vnode.el.clientWidth;let a=0;const d=this.getFlattenColumns(),m=d.filter(o=>!Wn(o.width));if(d.forEach(o=>{Wn(o.width)&&o.realWidth&&(o.realWidth=null)}),m.length>0&&t){if(d.forEach(o=>{a+=Number(o.width||o.minWidth||80)}),a<=i){this.scrollX.value=!1;const o=i-a;if(m.length===1)m[0].realWidth=Number(m[0].minWidth||80)+o;else{const C=m.reduce((z,N)=>z+Number(N.minWidth||80),0),k=o/C;let A=0;m.forEach((z,N)=>{if(N===0)return;const $=Math.floor(Number(z.minWidth||80)*k);A+=$,z.realWidth=Number(z.minWidth||80)+$}),m[0].realWidth=Number(m[0].minWidth||80)+o-A}}else this.scrollX.value=!0,m.forEach(o=>{o.realWidth=Number(o.minWidth)});this.bodyWidth.value=Math.max(a,i),this.table.state.resizeState.value.width=this.bodyWidth.value}else d.forEach(o=>{!o.width&&!o.minWidth?o.realWidth=80:o.realWidth=Number(o.width||o.minWidth),a+=o.realWidth}),this.scrollX.value=a>i,this.bodyWidth.value=a;const _=this.store.states.fixedColumns.value;if(_.length>0){let o=0;_.forEach(C=>{o+=Number(C.realWidth||C.width)}),this.fixedWidth.value=o}const x=this.store.states.rightFixedColumns.value;if(x.length>0){let o=0;x.forEach(C=>{o+=Number(C.realWidth||C.width)}),this.rightFixedWidth.value=o}this.notifyObservers("columns")}addObserver(t){this.observers.push(t)}removeObserver(t){const i=this.observers.indexOf(t);i!==-1&&this.observers.splice(i,1)}notifyObservers(t){this.observers.forEach(a=>{var d,m;switch(t){case"columns":(d=a.state)==null||d.onColumnsChange(this);break;case"scrollable":(m=a.state)==null||m.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${t}.`)}})}}const{CheckboxGroup:Wse}=Ha,qse=Ge({name:"ElTableFilterPanel",components:{ElCheckbox:Ha,ElCheckboxGroup:Wse,ElScrollbar:rc,ElTooltip:os,ElIcon:Dn,ArrowDown:Bc,ArrowUp:nC},directives:{ClickOutside:Rc},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function},appendTo:{type:String}},setup(e){const t=Cr(),{t:i}=Gr(),a=Jt("table-filter"),d=t==null?void 0:t.parent;d.filterPanels.value[e.column.id]||(d.filterPanels.value[e.column.id]=t);const m=be(!1),_=be(null),x=Q(()=>e.column&&e.column.filters),o=Q(()=>e.column.filterClassName?`${a.b()} ${e.column.filterClassName}`:a.b()),C=Q({get:()=>{var X;return(((X=e.column)==null?void 0:X.filteredValue)||[])[0]},set:X=>{k.value&&(typeof X<"u"&&X!==null?k.value.splice(0,1,X):k.value.splice(0,1))}}),k=Q({get(){return e.column?e.column.filteredValue||[]:[]},set(X){e.column&&e.upDataColumn("filteredValue",X)}}),A=Q(()=>e.column?e.column.filterMultiple:!0),z=X=>X.value===C.value,N=()=>{m.value=!1},$=X=>{X.stopPropagation(),m.value=!m.value},F=()=>{m.value=!1},G=()=>{Z(k.value),N()},U=()=>{k.value=[],Z(k.value),N()},te=X=>{C.value=X,Z(typeof X<"u"&&X!==null?k.value:[]),N()},Z=X=>{e.store.commit("filterChange",{column:e.column,values:X}),e.store.updateAllSelected()};Wt(m,X=>{e.column&&e.upDataColumn("filterOpened",X)},{immediate:!0});const q=Q(()=>{var X,ie;return(ie=(X=_.value)==null?void 0:X.popperRef)==null?void 0:ie.contentRef});return{tooltipVisible:m,multiple:A,filterClassName:o,filteredValue:k,filterValue:C,filters:x,handleConfirm:G,handleReset:U,handleSelect:te,isActive:z,t:i,ns:a,showFilterPanel:$,hideFilterPanel:F,popperPaneRef:q,tooltip:_}}});function Kse(e,t,i,a,d,m){const _=Er("el-checkbox"),x=Er("el-checkbox-group"),o=Er("el-scrollbar"),C=Er("arrow-up"),k=Er("arrow-down"),A=Er("el-icon"),z=Er("el-tooltip"),N=Rb("click-outside");return se(),It(z,{ref:"tooltip",visible:e.tooltipVisible,offset:0,placement:e.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":e.filterClassName,persistent:"","append-to":e.appendTo},{content:st(()=>[e.multiple?(se(),Ae("div",{key:0},[Ve("div",{class:ce(e.ns.e("content"))},[qe(o,{"wrap-class":e.ns.e("wrap")},{default:st(()=>[qe(x,{modelValue:e.filteredValue,"onUpdate:modelValue":$=>e.filteredValue=$,class:ce(e.ns.e("checkbox-group"))},{default:st(()=>[(se(!0),Ae(Bn,null,Fr(e.filters,$=>(se(),It(_,{key:$.value,value:$.value},{default:st(()=>[$r(fn($.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"])]),_:1},8,["wrap-class"])],2),Ve("div",{class:ce(e.ns.e("bottom"))},[Ve("button",{class:ce({[e.ns.is("disabled")]:e.filteredValue.length===0}),disabled:e.filteredValue.length===0,type:"button",onClick:e.handleConfirm},fn(e.t("el.table.confirmFilter")),11,["disabled","onClick"]),Ve("button",{type:"button",onClick:e.handleReset},fn(e.t("el.table.resetFilter")),9,["onClick"])],2)])):(se(),Ae("ul",{key:1,class:ce(e.ns.e("list"))},[Ve("li",{class:ce([e.ns.e("list-item"),{[e.ns.is("active")]:e.filterValue===void 0||e.filterValue===null}]),onClick:$=>e.handleSelect(null)},fn(e.t("el.table.clearFilter")),11,["onClick"]),(se(!0),Ae(Bn,null,Fr(e.filters,$=>(se(),Ae("li",{key:$.value,class:ce([e.ns.e("list-item"),e.ns.is("active",e.isActive($))]),label:$.value,onClick:F=>e.handleSelect($.value)},fn($.text),11,["label","onClick"]))),128))],2))]),default:st(()=>[mr((se(),Ae("span",{class:ce([`${e.ns.namespace.value}-table__column-filter-trigger`,`${e.ns.namespace.value}-none-outline`]),onClick:e.showFilterPanel},[qe(A,null,{default:st(()=>[_t(e.$slots,"filter-icon",{},()=>[e.column.filterOpened?(se(),It(C,{key:0})):(se(),It(k,{key:1}))])]),_:3})],10,["onClick"])),[[N,e.hideFilterPanel,e.popperPaneRef]])]),_:3},8,["visible","placement","popper-class","append-to"])}var Zse=hn(qse,[["render",Kse],["__file","filter-panel.vue"]]);function Kz(e){const t=Cr();Pb(()=>{i.value.addObserver(t)}),vr(()=>{a(i.value),d(i.value)}),Jl(()=>{a(i.value),d(i.value)}),cd(()=>{i.value.removeObserver(t)});const i=Q(()=>{const m=e.layout;if(!m)throw new Error("Can not find table layout.");return m}),a=m=>{var _;const x=((_=e.vnode.el)==null?void 0:_.querySelectorAll("colgroup > col"))||[];if(!x.length)return;const o=m.getFlattenColumns(),C={};o.forEach(k=>{C[k.id]=k});for(let k=0,A=x.length;k<A;k++){const z=x[k],N=z.getAttribute("name"),$=C[N];$&&z.setAttribute("width",$.realWidth||$.width)}},d=m=>{var _,x;const o=((_=e.vnode.el)==null?void 0:_.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let k=0,A=o.length;k<A;k++)o[k].setAttribute("width",m.scrollY.value?m.gutterWidth:"0");const C=((x=e.vnode.el)==null?void 0:x.querySelectorAll("th.gutter"))||[];for(let k=0,A=C.length;k<A;k++){const z=C[k];z.style.width=m.scrollY.value?`${m.gutterWidth}px`:"0",z.style.display=m.scrollY.value?"":"none"}};return{tableLayout:i.value,onColumnsChange:a,onScrollableChange:d}}const oc=Symbol("ElTable");function Yse(e,t){const i=Cr(),a=kn(oc),d=F=>{F.stopPropagation()},m=(F,G)=>{!G.filters&&G.sortable?$(F,G,!1):G.filterable&&!G.sortable&&d(F),a==null||a.emit("header-click",G,F)},_=(F,G)=>{a==null||a.emit("header-contextmenu",G,F)},x=be(null),o=be(!1),C=be({}),k=(F,G)=>{if(Hr&&!(G.children&&G.children.length>0)&&x.value&&e.border){o.value=!0;const U=a;t("set-drag-visible",!0);const Z=(U==null?void 0:U.vnode.el).getBoundingClientRect().left,q=i.vnode.el.querySelector(`th.${G.id}`),X=q.getBoundingClientRect(),ie=X.left-Z+30;Oa(q,"noclick"),C.value={startMouseLeft:F.clientX,startLeft:X.right-Z,startColumnLeft:X.left-Z,tableLeft:Z};const de=U==null?void 0:U.refs.resizeProxy;de.style.left=`${C.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const le=ge=>{const he=ge.clientX-C.value.startMouseLeft,ue=C.value.startLeft+he;de.style.left=`${Math.max(ie,ue)}px`},pe=()=>{if(o.value){const{startColumnLeft:ge,startLeft:he}=C.value,Re=Number.parseInt(de.style.left,10)-ge;G.width=G.realWidth=Re,U==null||U.emit("header-dragend",G.width,he-ge,G,F),requestAnimationFrame(()=>{e.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",o.value=!1,x.value=null,C.value={},t("set-drag-visible",!1)}document.removeEventListener("mousemove",le),document.removeEventListener("mouseup",pe),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{_s(q,"noclick")},0)};document.addEventListener("mousemove",le),document.addEventListener("mouseup",pe)}},A=(F,G)=>{var U;if(G.children&&G.children.length>0)return;const te=F.target;if(!ga(te))return;const Z=te==null?void 0:te.closest("th");if(!(!G||!G.resizable||!Z)&&!o.value&&e.border){const q=Z.getBoundingClientRect(),X=document.body.style,ie=((U=Z.parentNode)==null?void 0:U.lastElementChild)===Z;q.width>12&&q.right-F.pageX<8&&!ie?(X.cursor="col-resize",Ks(Z,"is-sortable")&&(Z.style.cursor="col-resize"),x.value=G):o.value||(X.cursor="",Ks(Z,"is-sortable")&&(Z.style.cursor="pointer"),x.value=null)}},z=()=>{Hr&&(document.body.style.cursor="")},N=({order:F,sortOrders:G})=>{if(F==="")return G[0];const U=G.indexOf(F||null);return G[U>G.length-2?0:U+1]},$=(F,G,U)=>{var te;F.stopPropagation();const Z=G.order===U?null:U||N(G),q=(te=F.target)==null?void 0:te.closest("th");if(q&&Ks(q,"noclick")){_s(q,"noclick");return}if(!G.sortable)return;const X=F.currentTarget;if(["ascending","descending"].some(ge=>Ks(X,ge)&&!G.sortOrders.includes(ge)))return;const ie=e.store.states;let de=ie.sortProp.value,le;const pe=ie.sortingColumn.value;(pe!==G||pe===G&&pe.order===null)&&(pe&&(pe.order=null),ie.sortingColumn.value=G,de=G.property),Z?le=G.order=Z:le=G.order=null,ie.sortProp.value=de,ie.sortOrder.value=le,a==null||a.store.commit("changeSortCondition")};return{handleHeaderClick:m,handleHeaderContextMenu:_,handleMouseDown:k,handleMouseMove:A,handleMouseOut:z,handleSortClick:$,handleFilterClick:d}}function Xse(e){const t=kn(oc),i=Jt("table");return{getHeaderRowStyle:x=>{const o=t==null?void 0:t.props.headerRowStyle;return Fn(o)?o.call(null,{rowIndex:x}):o},getHeaderRowClass:x=>{const o=[],C=t==null?void 0:t.props.headerRowClassName;return zn(C)?o.push(C):Fn(C)&&o.push(C.call(null,{rowIndex:x})),o.join(" ")},getHeaderCellStyle:(x,o,C,k)=>{var A;let z=(A=t==null?void 0:t.props.headerCellStyle)!=null?A:{};Fn(z)&&(z=z.call(null,{rowIndex:x,columnIndex:o,row:C,column:k}));const N=oE(o,k.fixed,e.store,C);return Up(N,"left"),Up(N,"right"),Object.assign({},z,N)},getHeaderCellClass:(x,o,C,k)=>{const A=rE(i.b(),o,k.fixed,e.store,C),z=[k.id,k.order,k.headerAlign,k.className,k.labelClassName,...A];k.children||z.push("is-leaf"),k.sortable&&z.push("is-sortable");const N=t==null?void 0:t.props.headerCellClassName;return zn(N)?z.push(N):Fn(N)&&z.push(N.call(null,{rowIndex:x,columnIndex:o,row:C,column:k})),z.push(i.e("cell")),z.filter($=>!!$).join(" ")}}}const Zz=e=>{const t=[];return e.forEach(i=>{i.children?(t.push(i),t.push.apply(t,Zz(i.children))):t.push(i)}),t},Yz=e=>{let t=1;const i=(m,_)=>{if(_&&(m.level=_.level+1,t<m.level&&(t=m.level)),m.children){let x=0;m.children.forEach(o=>{i(o,m),x+=o.colSpan}),m.colSpan=x}else m.colSpan=1};e.forEach(m=>{m.level=1,i(m,void 0)});const a=[];for(let m=0;m<t;m++)a.push([]);return Zz(e).forEach(m=>{m.children?(m.rowSpan=1,m.children.forEach(_=>_.isSubColumn=!0)):m.rowSpan=t-m.level+1,a[m.level-1].push(m)}),a};function Jse(e){const t=kn(oc),i=Q(()=>Yz(e.store.states.originColumns.value));return{isGroup:Q(()=>{const m=i.value.length>1;return m&&t&&(t.state.isGroup.value=!0),m}),toggleAllSelection:m=>{m.stopPropagation(),t==null||t.store.commit("toggleAllSelection")},columnRows:i}}var Qse=Ge({name:"ElTableHeader",components:{ElCheckbox:Ha},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})},appendFilterPanelTo:{type:String}},setup(e,{emit:t}){const i=Cr(),a=kn(oc),d=Jt("table"),m=be({}),{onColumnsChange:_,onScrollableChange:x}=Kz(a),o=(a==null?void 0:a.props.tableLayout)==="auto",C=new Map,k=be(),A=()=>{setTimeout(()=>{C.size>0&&(C.forEach((ge,he)=>{const ue=k.value.querySelector(`.${he.replace(/\s/g,".")}`);if(ue){const Re=ue.getBoundingClientRect().width;ge.width=Re}}),C.clear())})};vr(async()=>{await Vn(),await Vn();const{prop:ge,order:he}=e.defaultSort;a==null||a.store.commit("sort",{prop:ge,order:he,init:!0}),A()});const{handleHeaderClick:z,handleHeaderContextMenu:N,handleMouseDown:$,handleMouseMove:F,handleMouseOut:G,handleSortClick:U,handleFilterClick:te}=Yse(e,t),{getHeaderRowStyle:Z,getHeaderRowClass:q,getHeaderCellStyle:X,getHeaderCellClass:ie}=Xse(e),{isGroup:de,toggleAllSelection:le,columnRows:pe}=Jse(e);return i.state={onColumnsChange:_,onScrollableChange:x},i.filterPanels=m,{ns:d,filterPanels:m,onColumnsChange:_,onScrollableChange:x,columnRows:pe,getHeaderRowClass:q,getHeaderRowStyle:Z,getHeaderCellClass:ie,getHeaderCellStyle:X,handleHeaderClick:z,handleHeaderContextMenu:N,handleMouseDown:$,handleMouseMove:F,handleMouseOut:G,handleSortClick:U,handleFilterClick:te,isGroup:de,toggleAllSelection:le,saveIndexSelection:C,isTableLayoutAuto:o,theadRef:k,updateFixedColumnStyle:A}},render(){const{ns:e,isGroup:t,columnRows:i,getHeaderCellStyle:a,getHeaderCellClass:d,getHeaderRowClass:m,getHeaderRowStyle:_,handleHeaderClick:x,handleHeaderContextMenu:o,handleMouseDown:C,handleMouseMove:k,handleSortClick:A,handleMouseOut:z,store:N,$parent:$,saveIndexSelection:F,isTableLayoutAuto:G}=this;let U=1;return Kn("thead",{ref:"theadRef",class:{[e.is("group")]:t}},i.map((te,Z)=>Kn("tr",{class:m(Z),key:Z,style:_(Z)},te.map((q,X)=>{q.rowSpan>U&&(U=q.rowSpan);const ie=d(Z,X,te,q);return G&&q.fixed&&F.set(ie,q),Kn("th",{class:ie,colspan:q.colSpan,key:`${q.id}-thead`,rowspan:q.rowSpan,style:a(Z,X,te,q),onClick:de=>{de.currentTarget.classList.contains("noclick")||x(de,q)},onContextmenu:de=>o(de,q),onMousedown:de=>C(de,q),onMousemove:de=>k(de,q),onMouseout:z},[Kn("div",{class:["cell",q.filteredValue&&q.filteredValue.length>0?"highlight":""]},[q.renderHeader?q.renderHeader({column:q,$index:X,store:N,_self:$}):q.label,q.sortable&&Kn("span",{onClick:de=>A(de,q),class:"caret-wrapper"},[Kn("i",{onClick:de=>A(de,q,"ascending"),class:"sort-caret ascending"}),Kn("i",{onClick:de=>A(de,q,"descending"),class:"sort-caret descending"})]),q.filterable&&Kn(Zse,{store:N,placement:q.filterPlacement||"bottom-start",appendTo:$.appendFilterPanelTo,column:q,upDataColumn:(de,le)=>{q[de]=le}},{"filter-icon":()=>q.renderFilterIcon?q.renderFilterIcon({filterOpened:q.filterOpened}):null})])])}))))}});function Lw(e,t,i=.03){return e-t>i}function eae(e){const t=kn(oc),i=be(""),a=be(Kn("div")),d=($,F,G)=>{var U;const te=t,Z=Dw($);let q;const X=(U=te==null?void 0:te.vnode.el)==null?void 0:U.dataset.prefix;Z&&(q=HR({columns:e.store.states.columns.value},Z,X),q&&(te==null||te.emit(`cell-${G}`,F,q,Z,$))),te==null||te.emit(`row-${G}`,F,q,$)},m=($,F)=>{d($,F,"dblclick")},_=($,F)=>{e.store.commit("setCurrentRow",F),d($,F,"click")},x=($,F)=>{d($,F,"contextmenu")},o=Js($=>{e.store.commit("setHoverRow",$)},30),C=Js(()=>{e.store.commit("setHoverRow",null)},30),k=$=>{const F=window.getComputedStyle($,null),G=Number.parseInt(F.paddingLeft,10)||0,U=Number.parseInt(F.paddingRight,10)||0,te=Number.parseInt(F.paddingTop,10)||0,Z=Number.parseInt(F.paddingBottom,10)||0;return{left:G,right:U,top:te,bottom:Z}},A=($,F,G)=>{let U=F.target.parentNode;for(;$>1&&(U=U==null?void 0:U.nextSibling,!(!U||U.nodeName!=="TR"));)G(U,"hover-row hover-fixed-row"),$--};return{handleDoubleClick:m,handleClick:_,handleContextMenu:x,handleMouseEnter:o,handleMouseLeave:C,handleCellMouseEnter:($,F,G)=>{var U;const te=t,Z=Dw($),q=(U=te==null?void 0:te.vnode.el)==null?void 0:U.dataset.prefix;if(Z){const Me=HR({columns:e.store.states.columns.value},Z,q);Z.rowSpan>1&&A(Z.rowSpan,$,Oa);const Se=te.hoverState={cell:Z,column:Me,row:F};te==null||te.emit("cell-mouse-enter",Se.row,Se.column,Se.cell,$)}if(!G)return;const X=$.target.querySelector(".cell");if(!(Ks(X,`${q}-tooltip`)&&X.childNodes.length))return;const ie=document.createRange();ie.setStart(X,0),ie.setEnd(X,X.childNodes.length);const{width:de,height:le}=ie.getBoundingClientRect(),{width:pe,height:ge}=X.getBoundingClientRect(),{top:he,left:ue,right:Re,bottom:Ye}=k(X),Ie=ue+Re,fe=he+Ye;(Lw(de+Ie,pe)||Lw(le+fe,ge)||Lw(X.scrollWidth,pe))&&zse(G,Z.innerText||Z.textContent,Z,te)},handleCellMouseLeave:$=>{const F=Dw($);if(!F)return;F.rowSpan>1&&A(F.rowSpan,$,_s);const G=t==null?void 0:t.hoverState;t==null||t.emit("cell-mouse-leave",G==null?void 0:G.row,G==null?void 0:G.column,G==null?void 0:G.cell,$)},tooltipContent:i,tooltipTrigger:a}}function tae(e){const t=kn(oc),i=Jt("table");return{getRowStyle:(C,k)=>{const A=t==null?void 0:t.props.rowStyle;return Fn(A)?A.call(null,{row:C,rowIndex:k}):A||null},getRowClass:(C,k)=>{const A=[i.e("row")];t!=null&&t.props.highlightCurrentRow&&C===e.store.states.currentRow.value&&A.push("current-row"),e.stripe&&k%2===1&&A.push(i.em("row","striped"));const z=t==null?void 0:t.props.rowClassName;return zn(z)?A.push(z):Fn(z)&&A.push(z.call(null,{row:C,rowIndex:k})),A},getCellStyle:(C,k,A,z)=>{const N=t==null?void 0:t.props.cellStyle;let $=N??{};Fn(N)&&($=N.call(null,{rowIndex:C,columnIndex:k,row:A,column:z}));const F=oE(k,e==null?void 0:e.fixed,e.store);return Up(F,"left"),Up(F,"right"),Object.assign({},$,F)},getCellClass:(C,k,A,z,N)=>{const $=rE(i.b(),k,e==null?void 0:e.fixed,e.store,void 0,N),F=[z.id,z.align,z.className,...$],G=t==null?void 0:t.props.cellClassName;return zn(G)?F.push(G):Fn(G)&&F.push(G.call(null,{rowIndex:C,columnIndex:k,row:A,column:z})),F.push(i.e("cell")),F.filter(U=>!!U).join(" ")},getSpan:(C,k,A,z)=>{let N=1,$=1;const F=t==null?void 0:t.props.spanMethod;if(Fn(F)){const G=F({row:C,column:k,rowIndex:A,columnIndex:z});on(G)?(N=G[0],$=G[1]):typeof G=="object"&&(N=G.rowspan,$=G.colspan)}return{rowspan:N,colspan:$}},getColspanRealWidth:(C,k,A)=>{if(k<1)return C[A].realWidth;const z=C.map(({realWidth:N,width:$})=>N||$).slice(A,A+k);return Number(z.reduce((N,$)=>Number(N)+Number($),-1))}}}const nae=Ge({name:"TableTdWrapper"}),rae=Ge({...nae,props:{colspan:{type:Number,default:1},rowspan:{type:Number,default:1}},setup(e){return(t,i)=>(se(),Ae("td",{colspan:e.colspan,rowspan:e.rowspan},[_t(t.$slots,"default")],8,["colspan","rowspan"]))}});var oae=hn(rae,[["__file","td-wrapper.vue"]]);function iae(e){const t=kn(oc),i=Jt("table"),{handleDoubleClick:a,handleClick:d,handleContextMenu:m,handleMouseEnter:_,handleMouseLeave:x,handleCellMouseEnter:o,handleCellMouseLeave:C,tooltipContent:k,tooltipTrigger:A}=eae(e),{getRowStyle:z,getRowClass:N,getCellStyle:$,getCellClass:F,getSpan:G,getColspanRealWidth:U}=tae(e),te=Q(()=>e.store.states.columns.value.findIndex(({type:de})=>de==="default")),Z=(de,le)=>{const pe=t.props.rowKey;return pe?gs(de,pe):le},q=(de,le,pe,ge=!1)=>{const{tooltipEffect:he,tooltipOptions:ue,store:Re}=e,{indent:Ye,columns:Ie}=Re.states,fe=N(de,le);let Me=!0;return pe&&(fe.push(i.em("row",`level-${pe.level}`)),Me=pe.display),Kn("tr",{style:[Me?null:{display:"none"},z(de,le)],class:fe,key:Z(de,le),onDblclick:ye=>a(ye,de),onClick:ye=>d(ye,de),onContextmenu:ye=>m(ye,de),onMouseenter:()=>_(le),onMouseleave:x},Ie.value.map((ye,Ce)=>{const{rowspan:Fe,colspan:it}=G(de,ye,le,Ce);if(!Fe||!it)return null;const We=Object.assign({},ye);We.realWidth=U(Ie.value,it,Ce);const ut={store:e.store,_self:e.context||t,column:We,row:de,$index:le,cellIndex:Ce,expanded:ge};Ce===te.value&&pe&&(ut.treeNode={indent:pe.level*Ye.value,level:pe.level},ko(pe.expanded)&&(ut.treeNode.expanded=pe.expanded,"loading"in pe&&(ut.treeNode.loading=pe.loading),"noLazyChildren"in pe&&(ut.treeNode.noLazyChildren=pe.noLazyChildren)));const Lt=`${Z(de,le)},${Ce}`,Ft=We.columnKey||We.rawColumnKey||"",mt=ye.showOverflowTooltip&&RO({effect:he},ue,ye.showOverflowTooltip);return Kn(oae,{style:$(le,Ce,de,ye),class:F(le,Ce,de,ye,it-1),key:`${Ft}${Lt}`,rowspan:Fe,colspan:it,onMouseenter:jt=>o(jt,de,mt),onMouseleave:C},{default:()=>X(Ce,ye,ut)})}))},X=(de,le,pe)=>le.renderCell(pe);return{wrappedRowRender:(de,le)=>{const pe=e.store,{isRowExpanded:ge,assertRowKey:he}=pe,{treeData:ue,lazyTreeNodeMap:Re,childrenColumnName:Ye,rowKey:Ie}=pe.states,fe=pe.states.columns.value;if(fe.some(({type:Se})=>Se==="expand")){const Se=ge(de),ye=q(de,le,void 0,Se),Ce=t.renderExpanded;return Se?Ce?[[ye,Kn("tr",{key:`expanded-row__${ye.key}`},[Kn("td",{colspan:fe.length,class:`${i.e("cell")} ${i.e("expanded-cell")}`},[Ce({row:de,$index:le,store:pe,expanded:Se})])])]]:(console.error("[Element Error]renderExpanded is required."),ye):[[ye]]}else if(Object.keys(ue.value).length){he();const Se=gs(de,Ie.value);let ye=ue.value[Se],Ce=null;ye&&(Ce={expanded:ye.expanded,level:ye.level,display:!0},ko(ye.lazy)&&(ko(ye.loaded)&&ye.loaded&&(Ce.noLazyChildren=!(ye.children&&ye.children.length)),Ce.loading=ye.loading));const Fe=[q(de,le,Ce)];if(ye){let it=0;const We=(Lt,Ft)=>{Lt&&Lt.length&&Ft&&Lt.forEach(mt=>{const jt={display:Ft.display&&Ft.expanded,level:Ft.level+1,expanded:!1,noLazyChildren:!1,loading:!1},Ht=gs(mt,Ie.value);if(Ht==null)throw new Error("For nested data item, row-key is required.");if(ye={...ue.value[Ht]},ye&&(jt.expanded=ye.expanded,ye.level=ye.level||jt.level,ye.display=!!(ye.expanded&&jt.display),ko(ye.lazy)&&(ko(ye.loaded)&&ye.loaded&&(jt.noLazyChildren=!(ye.children&&ye.children.length)),jt.loading=ye.loading)),it++,Fe.push(q(mt,le+it,jt)),ye){const Tn=Re.value[Ht]||mt[Ye.value];We(Tn,ye)}})};ye.display=!0;const ut=Re.value[Se]||de[Ye.value];We(ut,ye)}return Fe}else return q(de,le,void 0)},tooltipContent:k,tooltipTrigger:A}}const sae={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var aae=Ge({name:"ElTableBody",props:sae,setup(e){const t=Cr(),i=kn(oc),a=Jt("table"),{wrappedRowRender:d,tooltipContent:m,tooltipTrigger:_}=iae(e),{onColumnsChange:x,onScrollableChange:o}=Kz(i),C=[];return Wt(e.store.states.hoverRow,(k,A)=>{var z;const N=t==null?void 0:t.vnode.el,$=Array.from((N==null?void 0:N.children)||[]).filter(U=>U==null?void 0:U.classList.contains(`${a.e("row")}`));let F=k;const G=(z=$[F])==null?void 0:z.childNodes;if(G!=null&&G.length){let U=0;Array.from(G).reduce((Z,q,X)=>{var ie,de;return((ie=G[X])==null?void 0:ie.colSpan)>1&&(U=(de=G[X])==null?void 0:de.colSpan),q.nodeName!=="TD"&&U===0&&Z.push(X),U>0&&U--,Z},[]).forEach(Z=>{var q;for(F=k;F>0;){const X=(q=$[F-1])==null?void 0:q.childNodes;if(X[Z]&&X[Z].nodeName==="TD"&&X[Z].rowSpan>1){Oa(X[Z],"hover-cell"),C.push(X[Z]);break}F--}})}else C.forEach(U=>_s(U,"hover-cell")),C.length=0;!e.store.states.isComplex.value||!Hr||td(()=>{const U=$[A],te=$[k];U&&!U.classList.contains("hover-fixed-row")&&_s(U,"hover-row"),te&&Oa(te,"hover-row")})}),cd(()=>{var k;(k=Ra)==null||k()}),{ns:a,onColumnsChange:x,onScrollableChange:o,wrappedRowRender:d,tooltipContent:m,tooltipTrigger:_}},render(){const{wrappedRowRender:e,store:t}=this,i=t.states.data.value||[];return Kn("tbody",{tabIndex:-1},[i.reduce((a,d)=>a.concat(e(d,a.length)),[])])}});function lae(){const e=kn(oc),t=e==null?void 0:e.store,i=Q(()=>t.states.fixedLeafColumnsLength.value),a=Q(()=>t.states.rightFixedColumns.value.length),d=Q(()=>t.states.columns.value.length),m=Q(()=>t.states.fixedColumns.value.length),_=Q(()=>t.states.rightFixedColumns.value.length);return{leftFixedLeafCount:i,rightFixedLeafCount:a,columnsCount:d,leftFixedCount:m,rightFixedCount:_,columns:t.states.columns}}function cae(e){const{columns:t}=lae(),i=Jt("table");return{getCellClasses:(m,_)=>{const x=m[_],o=[i.e("cell"),x.id,x.align,x.labelClassName,...rE(i.b(),_,x.fixed,e.store)];return x.className&&o.push(x.className),x.children||o.push(i.is("leaf")),o},getCellStyles:(m,_)=>{const x=oE(_,m.fixed,e.store);return Up(x,"left"),Up(x,"right"),x},columns:t}}var uae=Ge({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(e){const{getCellClasses:t,getCellStyles:i,columns:a}=cae(e);return{ns:Jt("table"),getCellClasses:t,getCellStyles:i,columns:a}},render(){const{columns:e,getCellStyles:t,getCellClasses:i,summaryMethod:a,sumText:d}=this,m=this.store.states.data.value;let _=[];return a?_=a({columns:e,data:m}):e.forEach((x,o)=>{if(o===0){_[o]=d;return}const C=m.map(N=>Number(N[x.property])),k=[];let A=!0;C.forEach(N=>{if(!Number.isNaN(+N)){A=!1;const $=`${N}`.split(".")[1];k.push($?$.length:0)}});const z=Math.max.apply(null,k);A?_[o]="":_[o]=C.reduce((N,$)=>{const F=Number($);return Number.isNaN(+F)?N:Number.parseFloat((N+$).toFixed(Math.min(z,20)))},0)}),Kn(Kn("tfoot",[Kn("tr",{},[...e.map((x,o)=>Kn("td",{key:o,colspan:x.colSpan,rowspan:x.rowSpan,class:i(e,o),style:t(x,o)},[Kn("div",{class:["cell",x.labelClassName]},[_[o]])]))])]))}});function dae(e){return{setCurrentRow:A=>{e.commit("setCurrentRow",A)},getSelectionRows:()=>e.getSelectionRows(),toggleRowSelection:(A,z,N=!0)=>{e.toggleRowSelection(A,z,!1,N),e.updateAllSelected()},clearSelection:()=>{e.clearSelection()},clearFilter:A=>{e.clearFilter(A)},toggleAllSelection:()=>{e.commit("toggleAllSelection")},toggleRowExpansion:(A,z)=>{e.toggleRowExpansionAdapter(A,z)},clearSort:()=>{e.clearSort()},sort:(A,z)=>{e.commit("sort",{prop:A,order:z})},updateKeyChildren:(A,z)=>{e.updateKeyChildren(A,z)}}}function hae(e,t,i,a){const d=be(!1),m=be(null),_=be(!1),x=Se=>{_.value=Se},o=be({width:null,height:null,headerHeight:null}),C=be(!1),k={display:"inline-block",verticalAlign:"middle"},A=be(),z=be(0),N=be(0),$=be(0),F=be(0),G=be(0);ns(()=>{t.setHeight(e.height)}),ns(()=>{t.setMaxHeight(e.maxHeight)}),Wt(()=>[e.currentRowKey,i.states.rowKey],([Se,ye])=>{!y(ye)||!y(Se)||i.setCurrentRowKey(`${Se}`)},{immediate:!0}),Wt(()=>e.data,Se=>{a.store.commit("setData",Se)},{immediate:!0,deep:!0}),ns(()=>{e.expandRowKeys&&i.setExpandRowKeysAdapter(e.expandRowKeys)});const U=()=>{a.store.commit("setHoverRow",null),a.hoverState&&(a.hoverState=null)},te=(Se,ye)=>{const{pixelX:Ce,pixelY:Fe}=ye;Math.abs(Ce)>=Math.abs(Fe)&&(a.refs.bodyWrapper.scrollLeft+=ye.pixelX/5)},Z=Q(()=>e.height||e.maxHeight||i.states.fixedColumns.value.length>0||i.states.rightFixedColumns.value.length>0),q=Q(()=>({width:t.bodyWidth.value?`${t.bodyWidth.value}px`:""})),X=()=>{Z.value&&t.updateElsHeight(),t.updateColumnsWidth(),requestAnimationFrame(pe)};vr(async()=>{await Vn(),i.updateColumns(),ge(),requestAnimationFrame(X);const Se=a.vnode.el,ye=a.refs.headerWrapper;e.flexible&&Se&&Se.parentElement&&(Se.parentElement.style.minWidth="0"),o.value={width:A.value=Se.offsetWidth,height:Se.offsetHeight,headerHeight:e.showHeader&&ye?ye.offsetHeight:null},i.states.columns.value.forEach(Ce=>{Ce.filteredValue&&Ce.filteredValue.length&&a.store.commit("filterChange",{column:Ce,values:Ce.filteredValue,silent:!0})}),a.$ready=!0});const ie=(Se,ye)=>{if(!Se)return;const Ce=Array.from(Se.classList).filter(Fe=>!Fe.startsWith("is-scrolling-"));Ce.push(t.scrollX.value?ye:"is-scrolling-none"),Se.className=Ce.join(" ")},de=Se=>{const{tableWrapper:ye}=a.refs;ie(ye,Se)},le=Se=>{const{tableWrapper:ye}=a.refs;return!!(ye&&ye.classList.contains(Se))},pe=function(){if(!a.refs.scrollBarRef)return;if(!t.scrollX.value){const Lt="is-scrolling-none";le(Lt)||de(Lt);return}const Se=a.refs.scrollBarRef.wrapRef;if(!Se)return;const{scrollLeft:ye,offsetWidth:Ce,scrollWidth:Fe}=Se,{headerWrapper:it,footerWrapper:We}=a.refs;it&&(it.scrollLeft=ye),We&&(We.scrollLeft=ye);const ut=Fe-Ce-1;ye>=ut?de("is-scrolling-right"):de(ye===0?"is-scrolling-left":"is-scrolling-middle")},ge=()=>{a.refs.scrollBarRef&&(a.refs.scrollBarRef.wrapRef&&yo(a.refs.scrollBarRef.wrapRef,"scroll",pe,{passive:!0}),e.fit?qo(a.vnode.el,he):yo(window,"resize",he),qo(a.refs.bodyWrapper,()=>{var Se,ye;he(),(ye=(Se=a.refs)==null?void 0:Se.scrollBarRef)==null||ye.update()}))},he=()=>{var Se,ye,Ce,Fe;const it=a.vnode.el;if(!a.$ready||!it)return;let We=!1;const{width:ut,height:Lt,headerHeight:Ft}=o.value,mt=A.value=it.offsetWidth;ut!==mt&&(We=!0);const jt=it.offsetHeight;(e.height||Z.value)&&Lt!==jt&&(We=!0);const Ht=e.tableLayout==="fixed"?a.refs.headerWrapper:(Se=a.refs.tableHeaderRef)==null?void 0:Se.$el;e.showHeader&&(Ht==null?void 0:Ht.offsetHeight)!==Ft&&(We=!0),z.value=((ye=a.refs.tableWrapper)==null?void 0:ye.scrollHeight)||0,$.value=(Ht==null?void 0:Ht.scrollHeight)||0,F.value=((Ce=a.refs.footerWrapper)==null?void 0:Ce.offsetHeight)||0,G.value=((Fe=a.refs.appendWrapper)==null?void 0:Fe.offsetHeight)||0,N.value=z.value-$.value-F.value-G.value,We&&(o.value={width:mt,height:jt,headerHeight:e.showHeader&&(Ht==null?void 0:Ht.offsetHeight)||0},X())},ue=xi(),Re=Q(()=>{const{bodyWidth:Se,scrollY:ye,gutterWidth:Ce}=t;return Se.value?`${Se.value-(ye.value?Ce:0)}px`:""}),Ye=Q(()=>e.maxHeight?"fixed":e.tableLayout),Ie=Q(()=>{if(e.data&&e.data.length)return null;let Se="100%";e.height&&N.value&&(Se=`${N.value}px`);const ye=A.value;return{width:ye?`${ye}px`:"",height:Se}}),fe=Q(()=>e.height?{height:"100%"}:e.maxHeight?Number.isNaN(Number(e.maxHeight))?{maxHeight:`calc(${e.maxHeight} - ${$.value+F.value}px)`}:{maxHeight:`${e.maxHeight-$.value-F.value}px`}:{});return{isHidden:d,renderExpanded:m,setDragVisible:x,isGroup:C,handleMouseLeave:U,handleHeaderFooterMousewheel:te,tableSize:ue,emptyBlockStyle:Ie,handleFixedMousewheel:(Se,ye)=>{const Ce=a.refs.bodyWrapper;if(Math.abs(ye.spinY)>0){const Fe=Ce.scrollTop;ye.pixelY<0&&Fe!==0&&Se.preventDefault(),ye.pixelY>0&&Ce.scrollHeight-Ce.clientHeight>Fe&&Se.preventDefault(),Ce.scrollTop+=Math.ceil(ye.pixelY/5)}else Ce.scrollLeft+=Math.ceil(ye.pixelX/5)},resizeProxyVisible:_,bodyWidth:Re,resizeState:o,doLayout:X,tableBodyStyles:q,tableLayout:Ye,scrollbarViewStyle:k,scrollbarStyle:fe}}function fae(e){const t=be(),i=()=>{const d=e.vnode.el.querySelector(".hidden-columns"),m={childList:!0,subtree:!0},_=e.store.states.updateOrderFns;t.value=new MutationObserver(()=>{_.forEach(x=>x())}),t.value.observe(d,m)};vr(()=>{i()}),cd(()=>{var a;(a=t.value)==null||a.disconnect()})}var pae={data:{type:Array,default:()=>[]},size:Ei,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children",checkStrictly:!1})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:Boolean,flexible:Boolean,showOverflowTooltip:[Boolean,Object],appendFilterPanelTo:String,scrollbarTabindex:{type:[Number,String],default:void 0}};function Xz(e){const t=e.tableLayout==="auto";let i=e.columns||[];t&&i.every(d=>d.width===void 0)&&(i=[]);const a=d=>{const m={key:`${e.tableLayout}_${d.id}`,style:{},name:void 0};return t?m.style={width:`${d.width}px`}:m.name=d.id,m};return Kn("colgroup",{},i.map(d=>Kn("col",a(d))))}Xz.props=["columns","tableLayout"];const mae=()=>{const e=be(),t=(m,_)=>{const x=e.value;x&&x.scrollTo(m,_)},i=(m,_)=>{const x=e.value;x&&Wn(_)&&["Top","Left"].includes(m)&&x[`setScroll${m}`](_)};return{scrollBarRef:e,scrollTo:t,setScrollTop:m=>i("Top",m),setScrollLeft:m=>i("Left",m)}};let gae=1;const vae=Ge({name:"ElTable",directives:{Mousewheel:BY},components:{TableHeader:Qse,TableBody:aae,TableFooter:uae,ElScrollbar:rc,hColgroup:Xz},props:pae,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change"],setup(e){const{t}=Gr(),i=Jt("table"),a=Cr();Br(oc,a);const d=jse(a,e);a.store=d;const m=new Gse({store:a.store,table:a,fit:e.fit,showHeader:e.showHeader});a.layout=m;const _=Q(()=>(d.states.data.value||[]).length===0),{setCurrentRow:x,getSelectionRows:o,toggleRowSelection:C,clearSelection:k,clearFilter:A,toggleAllSelection:z,toggleRowExpansion:N,clearSort:$,sort:F,updateKeyChildren:G}=dae(d),{isHidden:U,renderExpanded:te,setDragVisible:Z,isGroup:q,handleMouseLeave:X,handleHeaderFooterMousewheel:ie,tableSize:de,emptyBlockStyle:le,handleFixedMousewheel:pe,resizeProxyVisible:ge,bodyWidth:he,resizeState:ue,doLayout:Re,tableBodyStyles:Ye,tableLayout:Ie,scrollbarViewStyle:fe,scrollbarStyle:Me}=hae(e,m,d,a),{scrollBarRef:Se,scrollTo:ye,setScrollLeft:Ce,setScrollTop:Fe}=mae(),it=Js(Re,50),We=`${i.namespace.value}-table_${gae++}`;a.tableId=We,a.state={isGroup:q,resizeState:ue,doLayout:Re,debouncedUpdateLayout:it};const ut=Q(()=>{var mt;return(mt=e.sumText)!=null?mt:t("el.table.sumText")}),Lt=Q(()=>{var mt;return(mt=e.emptyText)!=null?mt:t("el.table.emptyText")}),Ft=Q(()=>Yz(d.states.originColumns.value)[0]);return fae(a),Io(()=>{it.cancel()}),{ns:i,layout:m,store:d,columns:Ft,handleHeaderFooterMousewheel:ie,handleMouseLeave:X,tableId:We,tableSize:de,isHidden:U,isEmpty:_,renderExpanded:te,resizeProxyVisible:ge,resizeState:ue,isGroup:q,bodyWidth:he,tableBodyStyles:Ye,emptyBlockStyle:le,debouncedUpdateLayout:it,handleFixedMousewheel:pe,setCurrentRow:x,getSelectionRows:o,toggleRowSelection:C,clearSelection:k,clearFilter:A,toggleAllSelection:z,toggleRowExpansion:N,clearSort:$,doLayout:Re,sort:F,updateKeyChildren:G,t,setDragVisible:Z,context:a,computedSumText:ut,computedEmptyText:Lt,tableLayout:Ie,scrollbarViewStyle:fe,scrollbarStyle:Me,scrollBarRef:Se,scrollTo:ye,setScrollLeft:Ce,setScrollTop:Fe}}});function _ae(e,t,i,a,d,m){const _=Er("hColgroup"),x=Er("table-header"),o=Er("table-body"),C=Er("table-footer"),k=Er("el-scrollbar"),A=Rb("mousewheel");return se(),Ae("div",{ref:"tableWrapper",class:ce([{[e.ns.m("fit")]:e.fit,[e.ns.m("striped")]:e.stripe,[e.ns.m("border")]:e.border||e.isGroup,[e.ns.m("hidden")]:e.isHidden,[e.ns.m("group")]:e.isGroup,[e.ns.m("fluid-height")]:e.maxHeight,[e.ns.m("scrollable-x")]:e.layout.scrollX.value,[e.ns.m("scrollable-y")]:e.layout.scrollY.value,[e.ns.m("enable-row-hover")]:!e.store.states.isComplex.value,[e.ns.m("enable-row-transition")]:(e.store.states.data.value||[]).length!==0&&(e.store.states.data.value||[]).length<100,"has-footer":e.showSummary},e.ns.m(e.tableSize),e.className,e.ns.b(),e.ns.m(`layout-${e.tableLayout}`)]),style:Nn(e.style),"data-prefix":e.ns.namespace.value,onMouseleave:e.handleMouseLeave},[Ve("div",{class:ce(e.ns.e("inner-wrapper"))},[Ve("div",{ref:"hiddenColumns",class:"hidden-columns"},[_t(e.$slots,"default")],512),e.showHeader&&e.tableLayout==="fixed"?mr((se(),Ae("div",{key:0,ref:"headerWrapper",class:ce(e.ns.e("header-wrapper"))},[Ve("table",{ref:"tableHeader",class:ce(e.ns.e("header")),style:Nn(e.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[qe(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),qe(x,{ref:"tableHeaderRef",border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,onSetDragVisible:e.setDragVisible},null,8,["border","default-sort","store","append-filter-panel-to","onSetDragVisible"])],6)],2)),[[A,e.handleHeaderFooterMousewheel]]):bt("v-if",!0),Ve("div",{ref:"bodyWrapper",class:ce(e.ns.e("body-wrapper"))},[qe(k,{ref:"scrollBarRef","view-style":e.scrollbarViewStyle,"wrap-style":e.scrollbarStyle,always:e.scrollbarAlwaysOn,tabindex:e.scrollbarTabindex},{default:st(()=>[Ve("table",{ref:"tableBody",class:ce(e.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:Nn({width:e.bodyWidth,tableLayout:e.tableLayout})},[qe(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),e.showHeader&&e.tableLayout==="auto"?(se(),It(x,{key:0,ref:"tableHeaderRef",class:ce(e.ns.e("body-header")),border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,onSetDragVisible:e.setDragVisible},null,8,["class","border","default-sort","store","append-filter-panel-to","onSetDragVisible"])):bt("v-if",!0),qe(o,{context:e.context,highlight:e.highlightCurrentRow,"row-class-name":e.rowClassName,"tooltip-effect":e.tooltipEffect,"tooltip-options":e.tooltipOptions,"row-style":e.rowStyle,store:e.store,stripe:e.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),e.showSummary&&e.tableLayout==="auto"?(se(),It(C,{key:1,class:ce(e.ns.e("body-footer")),border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):bt("v-if",!0)],6),e.isEmpty?(se(),Ae("div",{key:0,ref:"emptyBlock",style:Nn(e.emptyBlockStyle),class:ce(e.ns.e("empty-block"))},[Ve("span",{class:ce(e.ns.e("empty-text"))},[_t(e.$slots,"empty",{},()=>[$r(fn(e.computedEmptyText),1)])],2)],6)):bt("v-if",!0),e.$slots.append?(se(),Ae("div",{key:1,ref:"appendWrapper",class:ce(e.ns.e("append-wrapper"))},[_t(e.$slots,"append")],2)):bt("v-if",!0)]),_:3},8,["view-style","wrap-style","always","tabindex"])],2),e.showSummary&&e.tableLayout==="fixed"?mr((se(),Ae("div",{key:1,ref:"footerWrapper",class:ce(e.ns.e("footer-wrapper"))},[Ve("table",{class:ce(e.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:Nn(e.tableBodyStyles)},[qe(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),qe(C,{border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[no,!e.isEmpty],[A,e.handleHeaderFooterMousewheel]]):bt("v-if",!0),e.border||e.isGroup?(se(),Ae("div",{key:2,class:ce(e.ns.e("border-left-patch"))},null,2)):bt("v-if",!0)],2),mr(Ve("div",{ref:"resizeProxy",class:ce(e.ns.e("column-resize-proxy"))},null,2),[[no,e.resizeProxyVisible]])],46,["data-prefix","onMouseleave"])}var yae=hn(vae,[["render",_ae],["__file","table.vue"]]);const bae={selection:"table-column--selection",expand:"table__expand-column"},xae={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},wae=e=>bae[e]||"",Sae={selection:{renderHeader({store:e,column:t}){function i(){return e.states.data.value&&e.states.data.value.length===0}return Kn(Ha,{disabled:i(),size:e.states.tableSize.value,indeterminate:e.states.selection.value.length>0&&!e.states.isAllSelected.value,"onUpdate:modelValue":e.toggleAllSelection,modelValue:e.states.isAllSelected.value,ariaLabel:t.label})},renderCell({row:e,column:t,store:i,$index:a}){return Kn(Ha,{disabled:t.selectable?!t.selectable.call(null,e,a):!1,size:i.states.tableSize.value,onChange:()=>{i.commit("rowSelectedChanged",e)},onClick:d=>d.stopPropagation(),modelValue:i.isSelected(e),ariaLabel:t.label})},sortable:!1,resizable:!1},index:{renderHeader({column:e}){return e.label||"#"},renderCell({column:e,$index:t}){let i=t+1;const a=e.index;return Wn(a)?i=t+a:Fn(a)&&(i=a(t)),Kn("div",{},[i])},sortable:!1},expand:{renderHeader({column:e}){return e.label||""},renderCell({row:e,store:t,expanded:i}){const{ns:a}=t,d=[a.e("expand-icon")];return i&&d.push(a.em("expand-icon","expanded")),Kn("div",{class:d,onClick:function(_){_.stopPropagation(),t.toggleRowExpansion(e)}},{default:()=>[Kn(Dn,null,{default:()=>[Kn(Os)]})]})},sortable:!1,resizable:!1}};function Tae({row:e,column:t,$index:i}){var a;const d=t.property,m=d&&A0(e,d).value;return t&&t.formatter?t.formatter(e,t,m,i):((a=m==null?void 0:m.toString)==null?void 0:a.call(m))||""}function Cae({row:e,treeNode:t,store:i},a=!1){const{ns:d}=i;if(!t)return a?[Kn("span",{class:d.e("placeholder")})]:null;const m=[],_=function(x){x.stopPropagation(),!t.loading&&i.loadOrToggle(e)};if(t.indent&&m.push(Kn("span",{class:d.e("indent"),style:{"padding-left":`${t.indent}px`}})),ko(t.expanded)&&!t.noLazyChildren){const x=[d.e("expand-icon"),t.expanded?d.em("expand-icon","expanded"):""];let o=Os;t.loading&&(o=Kl),m.push(Kn("div",{class:x,onClick:_},{default:()=>[Kn(Dn,{class:{[d.is("loading")]:t.loading}},{default:()=>[Kn(o)]})]}))}else m.push(Kn("span",{class:d.e("placeholder")}));return m}function KR(e,t){return e.reduce((i,a)=>(i[a]=a,i),t)}function Eae(e,t){const i=Cr();return{registerComplexWatchers:()=>{const m=["fixed"],_={realWidth:"width",realMinWidth:"minWidth"},x=KR(m,_);Object.keys(x).forEach(o=>{const C=_[o];Qr(t,C)&&Wt(()=>t[C],k=>{let A=k;C==="width"&&o==="realWidth"&&(A=nE(k)),C==="minWidth"&&o==="realMinWidth"&&(A=jz(k)),i.columnConfig.value[C]=A,i.columnConfig.value[o]=A;const z=C==="fixed";e.value.store.scheduleLayout(z)})})},registerNormalWatchers:()=>{const m=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","filterClassName","showOverflowTooltip"],_={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},x=KR(m,_);Object.keys(x).forEach(o=>{const C=_[o];Qr(t,C)&&Wt(()=>t[C],k=>{i.columnConfig.value[o]=k})})}}}function Mae(e,t,i){const a=Cr(),d=be(""),m=be(!1),_=be(),x=be(),o=Jt("table");ns(()=>{_.value=e.align?`is-${e.align}`:null,_.value}),ns(()=>{x.value=e.headerAlign?`is-${e.headerAlign}`:_.value,x.value});const C=Q(()=>{let q=a.vnode.vParent||a.parent;for(;q&&!q.tableId&&!q.columnId;)q=q.vnode.vParent||q.parent;return q}),k=Q(()=>{const{store:q}=a.parent;if(!q)return!1;const{treeData:X}=q.states,ie=X.value;return ie&&Object.keys(ie).length>0}),A=be(nE(e.width)),z=be(jz(e.minWidth)),N=q=>(A.value&&(q.width=A.value),z.value&&(q.minWidth=z.value),!A.value&&z.value&&(q.width=void 0),q.minWidth||(q.minWidth=80),q.realWidth=Number(q.width===void 0?q.minWidth:q.width),q),$=q=>{const X=q.type,ie=Sae[X]||{};Object.keys(ie).forEach(le=>{const pe=ie[le];le!=="className"&&pe!==void 0&&(q[le]=pe)});const de=wae(X);if(de){const le=`${y(o.namespace)}-${de}`;q.className=q.className?`${q.className} ${le}`:le}return q},F=q=>{on(q)?q.forEach(ie=>X(ie)):X(q);function X(ie){var de;((de=ie==null?void 0:ie.type)==null?void 0:de.name)==="ElTableColumn"&&(ie.vParent=a)}};return{columnId:d,realAlign:_,isSubColumn:m,realHeaderAlign:x,columnOrTableParent:C,setColumnWidth:N,setColumnForcedProps:$,setColumnRenders:q=>{e.renderHeader||q.type!=="selection"&&(q.renderHeader=ie=>(a.columnConfig.value.label,_t(t,"header",ie,()=>[q.label]))),t["filter-icon"]&&(q.renderFilterIcon=ie=>_t(t,"filter-icon",ie));let X=q.renderCell;return q.type==="expand"?(q.renderCell=ie=>Kn("div",{class:"cell"},[X(ie)]),i.value.renderExpanded=ie=>t.default?t.default(ie):t.default):(X=X||Tae,q.renderCell=ie=>{let de=null;if(t.default){const Re=t.default(ie);de=Re.some(Ye=>Ye.type!==Oi)?Re:X(ie)}else de=X(ie);const{columns:le}=i.value.store.states,pe=le.value.findIndex(Re=>Re.type==="default"),ge=k.value&&ie.cellIndex===pe,he=Cae(ie,ge),ue={class:"cell",style:{}};return q.showOverflowTooltip&&(ue.class=`${ue.class} ${y(o.namespace)}-tooltip`,ue.style={width:`${(ie.column.realWidth||Number(ie.column.width))-1}px`}),F(de),Kn("div",ue,[he,de])}),q},getPropsData:(...q)=>q.reduce((X,ie)=>(on(ie)&&ie.forEach(de=>{X[de]=e[de]}),X),{}),getColumnElIndex:(q,X)=>Array.prototype.indexOf.call(q,X),updateColumnOrder:()=>{i.value.store.commit("updateColumnOrder",a.columnConfig.value)}}}var Iae={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},filterClassName:String,index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:e=>e.every(t=>["ascending","descending",null].includes(t))}};let kae=1;var Jz=Ge({name:"ElTableColumn",components:{ElCheckbox:Ha},props:Iae,setup(e,{slots:t}){const i=Cr(),a=be({}),d=Q(()=>{let Z=i.parent;for(;Z&&!Z.tableId;)Z=Z.parent;return Z}),{registerNormalWatchers:m,registerComplexWatchers:_}=Eae(d,e),{columnId:x,isSubColumn:o,realHeaderAlign:C,columnOrTableParent:k,setColumnWidth:A,setColumnForcedProps:z,setColumnRenders:N,getPropsData:$,getColumnElIndex:F,realAlign:G,updateColumnOrder:U}=Mae(e,t,d),te=k.value;x.value=`${te.tableId||te.columnId}_column_${kae++}`,Pb(()=>{o.value=d.value!==te;const Z=e.type||"default",q=e.sortable===""?!0:e.sortable,X=Bo(e.showOverflowTooltip)?te.props.showOverflowTooltip:e.showOverflowTooltip,ie={...xae[Z],id:x.value,type:Z,property:e.prop||e.property,align:G,headerAlign:C,showOverflowTooltip:X,filterable:e.filters||e.filterMethod,filteredValue:[],filterPlacement:"",filterClassName:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:q,index:e.index,rawColumnKey:i.vnode.key};let he=$(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement","filterClassName"]);he=Rse(ie,he),he=Lse(N,A,z)(he),a.value=he,m(),_()}),vr(()=>{var Z;const q=k.value,X=o.value?q.vnode.el.children:(Z=q.refs.hiddenColumns)==null?void 0:Z.children,ie=()=>F(X||[],i.vnode.el);a.value.getColumnIndex=ie,ie()>-1&&d.value.store.commit("insertColumn",a.value,o.value?q.columnConfig.value:null,U)}),Io(()=>{const Z=a.value.getColumnIndex;(Z?Z():-1)>-1&&d.value.store.commit("removeColumn",a.value,o.value?te.columnConfig.value:null,U)}),i.columnId=x.value,i.columnConfig=a},render(){var e,t,i;try{const a=(t=(e=this.$slots).default)==null?void 0:t.call(e,{row:{},column:{},$index:-1}),d=[];if(on(a))for(const _ of a)((i=_.type)==null?void 0:i.name)==="ElTableColumn"||_.shapeFlag&2?d.push(_):_.type===Bn&&on(_.children)&&_.children.forEach(x=>{(x==null?void 0:x.patchFlag)!==1024&&!zn(x==null?void 0:x.children)&&d.push(x)});return Kn("div",d)}catch{return Kn("div",[])}}});const Aae=cr(yae,{TableColumn:Jz}),Pae=Jo(Jz);var jv=(e=>(e.ASC="asc",e.DESC="desc",e))(jv||{}),Hv=(e=>(e.CENTER="center",e.RIGHT="right",e))(Hv||{}),Qz=(e=>(e.LEFT="left",e.RIGHT="right",e))(Qz||{});const QS={asc:"desc",desc:"asc"},Gv=Symbol("placeholder"),Rae=(e,t,i)=>{var a;const d={flexGrow:0,flexShrink:0,...i?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};i||(d.flexShrink=1);const m={...(a=e.style)!=null?a:{},...d,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(m.maxWidth=e.maxWidth),e.minWidth&&(m.minWidth=e.minWidth)),m};function Dae(e,t,i){const a=Q(()=>y(t).map((G,U)=>{var te,Z;return{...G,key:(Z=(te=G.key)!=null?te:G.dataKey)!=null?Z:U}})),d=Q(()=>y(a).filter(G=>!G.hidden)),m=Q(()=>y(d).filter(G=>G.fixed==="left"||G.fixed===!0)),_=Q(()=>y(d).filter(G=>G.fixed==="right")),x=Q(()=>y(d).filter(G=>!G.fixed)),o=Q(()=>{const G=[];return y(m).forEach(U=>{G.push({...U,placeholderSign:Gv})}),y(x).forEach(U=>{G.push(U)}),y(_).forEach(U=>{G.push({...U,placeholderSign:Gv})}),G}),C=Q(()=>y(m).length||y(_).length),k=Q(()=>y(a).reduce((G,U)=>(G[U.key]=Rae(U,y(i),e.fixed),G),{})),A=Q(()=>y(d).reduce((G,U)=>G+U.width,0)),z=G=>y(a).find(U=>U.key===G),N=G=>y(k)[G],$=(G,U)=>{G.width=U};function F(G){var U;const{key:te}=G.currentTarget.dataset;if(!te)return;const{sortState:Z,sortBy:q}=e;let X=jv.ASC;Tr(Z)?X=QS[Z[te]]:X=QS[q.order],(U=e.onColumnSort)==null||U.call(e,{column:z(te),key:te,order:X})}return{columns:a,columnsStyles:k,columnsTotalWidth:A,fixedColumnsOnLeft:m,fixedColumnsOnRight:_,hasFixedColumns:C,mainColumns:o,normalColumns:x,visibleColumns:d,getColumn:z,getColumnStyle:N,updateColumnWidth:$,onColumnSorted:F}}const Lae=(e,{mainTableRef:t,leftTableRef:i,rightTableRef:a,onMaybeEndReached:d})=>{const m=be({scrollLeft:0,scrollTop:0});function _(N){var $,F,G;const{scrollTop:U}=N;($=t.value)==null||$.scrollTo(N),(F=i.value)==null||F.scrollToTop(U),(G=a.value)==null||G.scrollToTop(U)}function x(N){m.value=N,_(N)}function o(N){m.value.scrollTop=N,_(y(m))}function C(N){var $,F;m.value.scrollLeft=N,(F=($=t.value)==null?void 0:$.scrollTo)==null||F.call($,y(m))}function k(N){var $;x(N),($=e.onScroll)==null||$.call(e,N)}function A({scrollTop:N}){const{scrollTop:$}=y(m);N!==$&&o(N)}function z(N,$="auto"){var F;(F=t.value)==null||F.scrollToRow(N,$)}return Wt(()=>y(m).scrollTop,(N,$)=>{N>$&&d()}),{scrollPos:m,scrollTo:x,scrollToLeft:C,scrollToTop:o,scrollToRow:z,onScroll:k,onVerticalScroll:A}},Oae=(e,{mainTableRef:t,leftTableRef:i,rightTableRef:a,tableInstance:d,ns:m,isScrolling:_})=>{const x=Cr(),{emit:o}=x,C=Uo(!1),k=be(e.defaultExpandedRowKeys||[]),A=be(-1),z=Uo(null),N=be({}),$=be({}),F=Uo({}),G=Uo({}),U=Uo({}),te=Q(()=>Wn(e.estimatedRowHeight));function Z(ge){var he;(he=e.onRowsRendered)==null||he.call(e,ge),ge.rowCacheEnd>y(A)&&(A.value=ge.rowCacheEnd)}function q({hovered:ge,rowKey:he}){if(_.value)return;d.vnode.el.querySelectorAll(`[rowkey="${String(he)}"]`).forEach(Ye=>{ge?Ye.classList.add(m.is("hovered")):Ye.classList.remove(m.is("hovered"))})}function X({expanded:ge,rowData:he,rowIndex:ue,rowKey:Re}){var Ye,Ie;const fe=[...y(k)],Me=fe.indexOf(Re);ge?Me===-1&&fe.push(Re):Me>-1&&fe.splice(Me,1),k.value=fe,o("update:expandedRowKeys",fe),(Ye=e.onRowExpand)==null||Ye.call(e,{expanded:ge,rowData:he,rowIndex:ue,rowKey:Re}),(Ie=e.onExpandedRowsChange)==null||Ie.call(e,fe)}const ie=Js(()=>{var ge,he,ue,Re;C.value=!0,N.value={...y(N),...y($)},de(y(z),!1),$.value={},z.value=null,(ge=t.value)==null||ge.forceUpdate(),(he=i.value)==null||he.forceUpdate(),(ue=a.value)==null||ue.forceUpdate(),(Re=x.proxy)==null||Re.$forceUpdate(),C.value=!1},0);function de(ge,he=!1){y(te)&&[t,i,a].forEach(ue=>{const Re=y(ue);Re&&Re.resetAfterRowIndex(ge,he)})}function le(ge,he,ue){const Re=y(z);(Re===null||Re>ue)&&(z.value=ue),$.value[ge]=he}function pe({rowKey:ge,height:he,rowIndex:ue},Re){Re?Re===Qz.RIGHT?U.value[ge]=he:F.value[ge]=he:G.value[ge]=he;const Ye=Math.max(...[F,U,G].map(Ie=>Ie.value[ge]||0));y(N)[ge]!==Ye&&(le(ge,Ye,ue),ie())}return{expandedRowKeys:k,lastRenderedRowIndex:A,isDynamic:te,isResetting:C,rowHeights:N,resetAfterIndex:de,onRowExpanded:X,onRowHovered:q,onRowsRendered:Z,onRowHeightChange:pe}},zae=(e,{expandedRowKeys:t,lastRenderedRowIndex:i,resetAfterIndex:a})=>{const d=be({}),m=Q(()=>{const x={},{data:o,rowKey:C}=e,k=y(t);if(!k||!k.length)return o;const A=[],z=new Set;k.forEach($=>z.add($));let N=o.slice();for(N.forEach($=>x[$[C]]=0);N.length>0;){const $=N.shift();A.push($),z.has($[C])&&on($.children)&&$.children.length>0&&(N=[...$.children,...N],$.children.forEach(F=>x[F[C]]=x[$[C]]+1))}return d.value=x,A}),_=Q(()=>{const{data:x,expandColumnKey:o}=e;return o?y(m):x});return Wt(_,(x,o)=>{x!==o&&(i.value=-1,a(0,!0))}),{data:_,depthMap:d}},Bae=(e,t)=>e+t,N0=e=>on(e)?e.reduce(Bae,0):e,Rh=(e,t,i={})=>Fn(e)?e(t):e??i,Hu=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=li(e[t])}),e),eB=e=>Ho(e)?t=>Kn(e,t):e,Fae=(e,{columnsTotalWidth:t,data:i,fixedColumnsOnLeft:a,fixedColumnsOnRight:d})=>{const m=Q(()=>{const{fixed:Z,width:q,vScrollbarSize:X}=e,ie=q-X;return Z?Math.max(Math.round(y(t)),ie):ie}),_=Q(()=>y(m)+e.vScrollbarSize),x=Q(()=>{const{height:Z=0,maxHeight:q=0,footerHeight:X,hScrollbarSize:ie}=e;if(q>0){const de=y($),le=y(o),ge=y(N)+de+le+ie;return Math.min(ge,q-X)}return Z-X}),o=Q(()=>{const{rowHeight:Z,estimatedRowHeight:q}=e,X=y(i);return Wn(q)?X.length*q:X.length*Z}),C=Q(()=>{const{maxHeight:Z}=e,q=y(x);if(Wn(Z)&&Z>0)return q;const X=y(o)+y(N)+y($);return Math.min(q,X)}),k=Z=>Z.width,A=Q(()=>N0(y(a).map(k))),z=Q(()=>N0(y(d).map(k))),N=Q(()=>N0(e.headerHeight)),$=Q(()=>{var Z;return(((Z=e.fixedData)==null?void 0:Z.length)||0)*e.rowHeight}),F=Q(()=>y(x)-y(N)-y($)),G=Q(()=>{const{style:Z={},height:q,width:X}=e;return Hu({...Z,height:q,width:X})}),U=Q(()=>Hu({height:e.footerHeight})),te=Q(()=>({top:li(y(N)),bottom:li(e.footerHeight),width:li(e.width)}));return{bodyWidth:m,fixedTableHeight:C,mainTableHeight:x,leftTableWidth:A,rightTableWidth:z,headerWidth:_,rowsHeight:o,windowHeight:F,footerHeight:U,emptyStyle:te,rootStyle:G,headerHeight:N}},Nae=e=>{const t=be(),i=be(0),a=be(0);let d;return vr(()=>{d=qo(t,([m])=>{const{width:_,height:x}=m.contentRect,{paddingLeft:o,paddingRight:C,paddingTop:k,paddingBottom:A}=getComputedStyle(m.target),z=Number.parseInt(o)||0,N=Number.parseInt(C)||0,$=Number.parseInt(k)||0,F=Number.parseInt(A)||0;i.value=_-z-N,a.value=x-$-F}).stop}),Io(()=>{d==null||d()}),Wt([i,a],([m,_])=>{var x;(x=e.onResize)==null||x.call(e,{width:m,height:_})}),{sizer:t,width:i,height:a}};function $ae(e){const t=be(),i=be(),a=be(),{columns:d,columnsStyles:m,columnsTotalWidth:_,fixedColumnsOnLeft:x,fixedColumnsOnRight:o,hasFixedColumns:C,mainColumns:k,onColumnSorted:A}=Dae(e,fo(e,"columns"),fo(e,"fixed")),{scrollTo:z,scrollToLeft:N,scrollToTop:$,scrollToRow:F,onScroll:G,onVerticalScroll:U,scrollPos:te}=Lae(e,{mainTableRef:t,leftTableRef:i,rightTableRef:a,onMaybeEndReached:He}),Z=Jt("table-v2"),q=Cr(),X=Uo(!1),{expandedRowKeys:ie,lastRenderedRowIndex:de,isDynamic:le,isResetting:pe,rowHeights:ge,resetAfterIndex:he,onRowExpanded:ue,onRowHeightChange:Re,onRowHovered:Ye,onRowsRendered:Ie}=Oae(e,{mainTableRef:t,leftTableRef:i,rightTableRef:a,tableInstance:q,ns:Z,isScrolling:X}),{data:fe,depthMap:Me}=zae(e,{expandedRowKeys:ie,lastRenderedRowIndex:de,resetAfterIndex:he}),{bodyWidth:Se,fixedTableHeight:ye,mainTableHeight:Ce,leftTableWidth:Fe,rightTableWidth:it,headerWidth:We,rowsHeight:ut,windowHeight:Lt,footerHeight:Ft,emptyStyle:mt,rootStyle:jt,headerHeight:Ht}=Fae(e,{columnsTotalWidth:_,data:fe,fixedColumnsOnLeft:x,fixedColumnsOnRight:o}),Tn=be(),Pe=Q(()=>{const pt=y(fe).length===0;return on(e.fixedData)?e.fixedData.length===0&&pt:pt});function At(pt){const{estimatedRowHeight:et,rowHeight:rn,rowKey:kt}=e;return et?y(ge)[y(fe)[pt][kt]]||et:rn}function He(){const{onEndReached:pt}=e;if(!pt)return;const{scrollTop:et}=y(te),rn=y(ut),kt=y(Lt),zt=rn-(et+kt)+e.hScrollbarSize;y(de)>=0&&rn===et+y(Ce)-y(Ht)&&pt(zt)}return Wt(()=>e.expandedRowKeys,pt=>ie.value=pt,{deep:!0}),{columns:d,containerRef:Tn,mainTableRef:t,leftTableRef:i,rightTableRef:a,isDynamic:le,isResetting:pe,isScrolling:X,hasFixedColumns:C,columnsStyles:m,columnsTotalWidth:_,data:fe,expandedRowKeys:ie,depthMap:Me,fixedColumnsOnLeft:x,fixedColumnsOnRight:o,mainColumns:k,bodyWidth:Se,emptyStyle:mt,rootStyle:jt,headerWidth:We,footerHeight:Ft,mainTableHeight:Ce,fixedTableHeight:ye,leftTableWidth:Fe,rightTableWidth:it,showEmpty:Pe,getRowHeight:At,onColumnSorted:A,onRowHovered:Ye,onRowExpanded:ue,onRowsRendered:Ie,onRowHeightChange:Re,scrollTo:z,scrollToLeft:N,scrollToTop:$,scrollToRow:F,onScroll:G,onVerticalScroll:U}}const iE=Symbol("tableV2"),tB=String,u_={type:at(Array),required:!0},sE={type:at(Array)},nB={...sE,required:!0},Vae=String,ZR={type:at(Array),default:()=>Xo([])},ch={type:Number,required:!0},rB={type:at([String,Number,Symbol]),default:"id"},YR={type:at(Object)},mh=ln({class:String,columns:u_,columnsStyles:{type:at(Object),required:!0},depth:Number,expandColumnKey:Vae,estimatedRowHeight:{...bh.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:at(Function)},onRowHover:{type:at(Function)},onRowHeightChange:{type:at(Function)},rowData:{type:at(Object),required:!0},rowEventHandlers:{type:at(Object)},rowIndex:{type:Number,required:!0},rowKey:rB,style:{type:at(Object)}}),Ow={type:Number,required:!0},aE=ln({class:String,columns:u_,fixedHeaderData:{type:at(Array)},headerData:{type:at(Array),required:!0},headerHeight:{type:at([Number,Array]),default:50},rowWidth:Ow,rowHeight:{type:Number,default:50},height:Ow,width:Ow}),$0=ln({columns:u_,data:nB,fixedData:sE,estimatedRowHeight:mh.estimatedRowHeight,width:ch,height:ch,headerWidth:ch,headerHeight:aE.headerHeight,bodyWidth:ch,rowHeight:ch,cache:Tz.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:bh.scrollbarAlwaysOn,scrollbarStartGap:bh.scrollbarStartGap,scrollbarEndGap:bh.scrollbarEndGap,class:tB,style:YR,containerStyle:YR,getRowHeight:{type:at(Function),required:!0},rowKey:mh.rowKey,onRowsRendered:{type:at(Function)},onScroll:{type:at(Function)}}),Uae=ln({cache:$0.cache,estimatedRowHeight:mh.estimatedRowHeight,rowKey:rB,headerClass:{type:at([String,Function])},headerProps:{type:at([Object,Function])},headerCellProps:{type:at([Object,Function])},headerHeight:aE.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:at([String,Function])},rowProps:{type:at([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:at([Object,Function])},columns:u_,data:nB,dataGetter:{type:at(Function)},fixedData:sE,expandColumnKey:mh.expandColumnKey,expandedRowKeys:ZR,defaultExpandedRowKeys:ZR,class:tB,fixed:Boolean,style:{type:at(Object)},width:ch,height:ch,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:bh.hScrollbarSize,vScrollbarSize:bh.vScrollbarSize,scrollbarAlwaysOn:Mz.alwaysOn,sortBy:{type:at(Object),default:()=>({})},sortState:{type:at(Object),default:void 0},onColumnSort:{type:at(Function)},onExpandedRowsChange:{type:at(Function)},onEndReached:{type:at(Function)},onRowExpand:mh.onRowExpand,onScroll:$0.onScroll,onRowsRendered:$0.onRowsRendered,rowEventHandlers:mh.rowEventHandlers}),lE=(e,{slots:t})=>{var i;const{cellData:a,style:d}=e,m=((i=a==null?void 0:a.toString)==null?void 0:i.call(a))||"",_=_t(t,"default",e,()=>[m]);return qe("div",{class:e.class,title:m,style:d},[_])};lE.displayName="ElTableV2Cell";lE.inheritAttrs=!1;const cE=(e,{slots:t})=>_t(t,"default",e,()=>{var i,a;return[qe("div",{class:e.class,title:(i=e.column)==null?void 0:i.title},[(a=e.column)==null?void 0:a.title])]});cE.displayName="ElTableV2HeaderCell";cE.inheritAttrs=!1;const jae=ln({class:String,columns:u_,columnsStyles:{type:at(Object),required:!0},headerIndex:Number,style:{type:at(Object)}}),Hae=Ge({name:"ElTableV2HeaderRow",props:jae,setup(e,{slots:t}){return()=>{const{columns:i,columnsStyles:a,headerIndex:d,style:m}=e;let _=i.map((x,o)=>t.cell({columns:i,column:x,columnIndex:o,headerIndex:d,style:a[x.key]}));return t.header&&(_=t.header({cells:_.map(x=>on(x)&&x.length===1?x[0]:x),columns:i,headerIndex:d})),qe("div",{class:e.class,style:m,role:"row"},[_])}}}),Gae="ElTableV2Header",Wae=Ge({name:Gae,props:aE,setup(e,{slots:t,expose:i}){const a=Jt("table-v2"),d=kn("tableV2GridScrollLeft"),m=be(),_=Q(()=>Hu({width:e.width,height:e.height})),x=Q(()=>Hu({width:e.rowWidth,height:e.height})),o=Q(()=>ms(y(e.headerHeight))),C=z=>{const N=y(m);Vn(()=>{N!=null&&N.scroll&&N.scroll({left:z})})},k=()=>{const z=a.e("fixed-header-row"),{columns:N,fixedHeaderData:$,rowHeight:F}=e;return $==null?void 0:$.map((G,U)=>{var te;const Z=Hu({height:F,width:"100%"});return(te=t.fixed)==null?void 0:te.call(t,{class:z,columns:N,rowData:G,rowIndex:-(U+1),style:Z})})},A=()=>{const z=a.e("dynamic-header-row"),{columns:N}=e;return y(o).map(($,F)=>{var G;const U=Hu({width:"100%",height:$});return(G=t.dynamic)==null?void 0:G.call(t,{class:z,columns:N,headerIndex:F,style:U})})};return Jl(()=>{d!=null&&d.value&&C(d.value)}),i({scrollToLeft:C}),()=>{if(!(e.height<=0))return qe("div",{ref:m,class:e.class,style:y(_),role:"rowgroup"},[qe("div",{style:y(x),class:a.e("header")},[A(),k()])])}}}),qae=e=>{const{isScrolling:t}=kn(iE),i=be(!1),a=be(),d=Q(()=>Wn(e.estimatedRowHeight)&&e.rowIndex>=0),m=(o=!1)=>{const C=y(a);if(!C)return;const{columns:k,onRowHeightChange:A,rowKey:z,rowIndex:N,style:$}=e,{height:F}=C.getBoundingClientRect();i.value=!0,Vn(()=>{if(o||F!==Number.parseInt($.height)){const G=k[0],U=(G==null?void 0:G.placeholderSign)===Gv;A==null||A({rowKey:z,height:F,rowIndex:N},G&&!U&&G.fixed)}})},_=Q(()=>{const{rowData:o,rowIndex:C,rowKey:k,onRowHover:A}=e,z=e.rowEventHandlers||{},N={};return Object.entries(z).forEach(([$,F])=>{Fn(F)&&(N[$]=G=>{F({event:G,rowData:o,rowIndex:C,rowKey:k})})}),A&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:$,hovered:F})=>{const G=N[$];N[$]=U=>{A({event:U,hovered:F,rowData:o,rowIndex:C,rowKey:k}),G==null||G(U)}}),N}),x=o=>{const{onRowExpand:C,rowData:k,rowIndex:A,rowKey:z}=e;C==null||C({expanded:o,rowData:k,rowIndex:A,rowKey:z})};return vr(()=>{y(d)&&m(!0)}),{isScrolling:t,measurable:d,measured:i,rowRef:a,eventHandlers:_,onExpand:x}},Kae="ElTableV2TableRow",Zae=Ge({name:Kae,props:mh,setup(e,{expose:t,slots:i,attrs:a}){const{eventHandlers:d,isScrolling:m,measurable:_,measured:x,rowRef:o,onExpand:C}=qae(e);return t({onExpand:C}),()=>{const{columns:k,columnsStyles:A,expandColumnKey:z,depth:N,rowData:$,rowIndex:F,style:G}=e;let U=k.map((te,Z)=>{const q=on($.children)&&$.children.length>0&&te.key===z;return i.cell({column:te,columns:k,columnIndex:Z,depth:N,style:A[te.key],rowData:$,rowIndex:F,isScrolling:y(m),expandIconProps:q?{rowData:$,rowIndex:F,onExpand:C}:void 0})});if(i.row&&(U=i.row({cells:U.map(te=>on(te)&&te.length===1?te[0]:te),style:G,columns:k,depth:N,rowData:$,rowIndex:F,isScrolling:y(m)})),y(_)){const{height:te,...Z}=G||{},q=y(x);return qe("div",kr({ref:o,class:e.class,style:q?G:Z,role:"row"},a,y(d)),[U])}return qe("div",kr(a,{ref:o,class:e.class,style:G,role:"row"},y(d)),[U])}}}),Yae=e=>{const{sortOrder:t}=e;return qe(Dn,{size:14,class:e.class},{default:()=>[t===jv.ASC?qe(iW,null,null):qe(rW,null,null)]})},Xae=e=>{const{expanded:t,expandable:i,onExpand:a,style:d,size:m}=e,_={onClick:i?()=>a(!t):void 0,class:e.class};return qe(Dn,kr(_,{size:m,style:d}),{default:()=>[qe(Os,null,null)]})},Jae="ElTableV2Grid",Qae=e=>{const t=be(),i=be(),a=be(0),d=Q(()=>{const{data:G,rowHeight:U,estimatedRowHeight:te}=e;if(!te)return G.length*U}),m=Q(()=>{const{fixedData:G,rowHeight:U}=e;return((G==null?void 0:G.length)||0)*U}),_=Q(()=>N0(e.headerHeight)),x=Q(()=>{const{height:G}=e;return Math.max(0,G-y(_)-y(m))}),o=Q(()=>y(_)+y(m)>0),C=({data:G,rowIndex:U})=>G[U][e.rowKey];function k({rowCacheStart:G,rowCacheEnd:U,rowVisibleStart:te,rowVisibleEnd:Z}){var q;(q=e.onRowsRendered)==null||q.call(e,{rowCacheStart:G,rowCacheEnd:U,rowVisibleStart:te,rowVisibleEnd:Z})}function A(G,U){var te;(te=i.value)==null||te.resetAfterRowIndex(G,U)}function z(G,U){const te=y(t),Z=y(i);Tr(G)?(te==null||te.scrollToLeft(G.scrollLeft),a.value=G.scrollLeft,Z==null||Z.scrollTo(G)):(te==null||te.scrollToLeft(G),a.value=G,Z==null||Z.scrollTo({scrollLeft:G,scrollTop:U}))}function N(G){var U;(U=y(i))==null||U.scrollTo({scrollTop:G})}function $(G,U){var te;(te=y(i))==null||te.scrollToItem(G,1,U)}function F(){var G,U;(G=y(i))==null||G.$forceUpdate(),(U=y(t))==null||U.$forceUpdate()}return{bodyRef:i,forceUpdate:F,fixedRowHeight:m,gridHeight:x,hasHeader:o,headerHeight:_,headerRef:t,totalHeight:d,itemKey:C,onItemRendered:k,resetAfterRowIndex:A,scrollTo:z,scrollToTop:N,scrollToRow:$,scrollLeft:a}},uE=Ge({name:Jae,props:$0,setup(e,{slots:t,expose:i}){const{ns:a}=kn(iE),{bodyRef:d,fixedRowHeight:m,gridHeight:_,hasHeader:x,headerRef:o,headerHeight:C,totalHeight:k,forceUpdate:A,itemKey:z,onItemRendered:N,resetAfterRowIndex:$,scrollTo:F,scrollToTop:G,scrollToRow:U,scrollLeft:te}=Qae(e);Br("tableV2GridScrollLeft",te),i({forceUpdate:A,totalHeight:k,scrollTo:F,scrollToTop:G,scrollToRow:U,resetAfterRowIndex:$});const Z=()=>e.bodyWidth;return()=>{const{cache:q,columns:X,data:ie,fixedData:de,useIsScrolling:le,scrollbarAlwaysOn:pe,scrollbarEndGap:ge,scrollbarStartGap:he,style:ue,rowHeight:Re,bodyWidth:Ye,estimatedRowHeight:Ie,headerWidth:fe,height:Me,width:Se,getRowHeight:ye,onScroll:Ce}=e,Fe=Wn(Ie),it=Fe?rie:Qoe,We=y(C);return qe("div",{role:"table",class:[a.e("table"),e.class],style:ue},[qe(it,{ref:d,data:ie,useIsScrolling:le,itemKey:z,columnCache:0,columnWidth:Fe?Z:Ye,totalColumn:1,totalRow:ie.length,rowCache:q,rowHeight:Fe?ye:Re,width:Se,height:y(_),class:a.e("body"),role:"rowgroup",scrollbarStartGap:he,scrollbarEndGap:ge,scrollbarAlwaysOn:pe,onScroll:Ce,onItemRendered:N,perfMode:!1},{default:ut=>{var Lt;const Ft=ie[ut.rowIndex];return(Lt=t.row)==null?void 0:Lt.call(t,{...ut,columns:X,rowData:Ft})}}),y(x)&&qe(Wae,{ref:o,class:a.e("header-wrapper"),columns:X,headerData:ie,headerHeight:e.headerHeight,fixedHeaderData:de,rowWidth:fe,rowHeight:Re,width:Se,height:Math.min(We+y(m),Me)},{dynamic:t.header,fixed:t.row})])}}});function ele(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ho(e)}const tle=(e,{slots:t})=>{const{mainTableRef:i,...a}=e;return qe(uE,kr({ref:i},a),ele(t)?t:{default:()=>[t]})};function nle(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ho(e)}const rle=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:i,...a}=e;return qe(uE,kr({ref:i},a),nle(t)?t:{default:()=>[t]})};function ole(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ho(e)}const ile=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:i,...a}=e;return qe(uE,kr({ref:i},a),ole(t)?t:{default:()=>[t]})};function sle(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ho(e)}const ale=(e,{slots:t})=>{const{columns:i,columnsStyles:a,depthMap:d,expandColumnKey:m,expandedRowKeys:_,estimatedRowHeight:x,hasFixedColumns:o,rowData:C,rowIndex:k,style:A,isScrolling:z,rowProps:N,rowClass:$,rowKey:F,rowEventHandlers:G,ns:U,onRowHovered:te,onRowExpanded:Z}=e,q=Rh($,{columns:i,rowData:C,rowIndex:k},""),X=Rh(N,{columns:i,rowData:C,rowIndex:k}),ie=C[F],de=d[ie]||0,le=!!m,pe=k<0,ge=[U.e("row"),q,{[U.e(`row-depth-${de}`)]:le&&k>=0,[U.is("expanded")]:le&&_.includes(ie),[U.is("fixed")]:!de&&pe,[U.is("customized")]:!!t.row}],he=o?te:void 0,ue={...X,columns:i,columnsStyles:a,class:ge,depth:de,expandColumnKey:m,estimatedRowHeight:pe?void 0:x,isScrolling:z,rowIndex:k,rowData:C,rowKey:ie,rowEventHandlers:G,style:A};return qe(Zae,kr(ue,{onRowExpand:Z,onMouseenter:Ie=>{he==null||he({hovered:!0,rowKey:ie,event:Ie,rowData:C,rowIndex:k})},onMouseleave:Ie=>{he==null||he({hovered:!1,rowKey:ie,event:Ie,rowData:C,rowIndex:k})},rowkey:ie}),sle(t)?t:{default:()=>[t]})},eT=({columns:e,column:t,columnIndex:i,depth:a,expandIconProps:d,isScrolling:m,rowData:_,rowIndex:x,style:o,expandedRowKeys:C,ns:k,cellProps:A,expandColumnKey:z,indentSize:N,iconSize:$,rowKey:F},{slots:G})=>{const U=Hu(o);if(t.placeholderSign===Gv)return qe("div",{class:k.em("row-cell","placeholder"),style:U},null);const{cellRenderer:te,dataKey:Z,dataGetter:q}=t,X=Fn(q)?q({columns:e,column:t,columnIndex:i,rowData:_,rowIndex:x}):mi(_,Z??""),ie=Rh(A,{cellData:X,columns:e,column:t,columnIndex:i,rowIndex:x,rowData:_}),de={class:k.e("cell-text"),columns:e,column:t,columnIndex:i,cellData:X,isScrolling:m,rowData:_,rowIndex:x},le=eB(te),pe=le?le(de):_t(G,"default",de,()=>[qe(lE,de,null)]),ge=[k.e("row-cell"),t.class,t.align===Hv.CENTER&&k.is("align-center"),t.align===Hv.RIGHT&&k.is("align-right")],he=x>=0&&z&&t.key===z,ue=x>=0&&C.includes(_[F]);let Re;const Ye=`margin-inline-start: ${a*N}px;`;return he&&(Tr(d)?Re=qe(Xae,kr(d,{class:[k.e("expand-icon"),k.is("expanded",ue)],size:$,expanded:ue,style:Ye,expandable:!0}),null):Re=qe("div",{style:[Ye,`width: ${$}px; height: ${$}px;`].join(" ")},null)),qe("div",kr({class:ge,style:U},ie,{role:"cell"}),[Re,pe])};eT.inheritAttrs=!1;function lle(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ho(e)}const cle=({columns:e,columnsStyles:t,headerIndex:i,style:a,headerClass:d,headerProps:m,ns:_},{slots:x})=>{const o={columns:e,headerIndex:i},C=[_.e("header-row"),Rh(d,o,""),{[_.is("customized")]:!!x.header}],k={...Rh(m,o),columnsStyles:t,class:C,columns:e,headerIndex:i,style:a};return qe(Hae,k,lle(x)?x:{default:()=>[x]})},XR=(e,{slots:t})=>{const{column:i,ns:a,style:d,onColumnSorted:m}=e,_=Hu(d);if(i.placeholderSign===Gv)return qe("div",{class:a.em("header-row-cell","placeholder"),style:_},null);const{headerCellRenderer:x,headerClass:o,sortable:C}=i,k={...e,class:a.e("header-cell-text")},A=eB(x),z=A?A(k):_t(t,"default",k,()=>[qe(cE,k,null)]),{sortBy:N,sortState:$,headerCellProps:F}=e;let G,U;if($){const q=$[i.key];G=!!QS[q],U=G?q:jv.ASC}else G=i.key===N.key,U=G?N.order:jv.ASC;const te=[a.e("header-cell"),Rh(o,e,""),i.align===Hv.CENTER&&a.is("align-center"),i.align===Hv.RIGHT&&a.is("align-right"),C&&a.is("sortable")],Z={...Rh(F,e),onClick:i.sortable?m:void 0,class:te,style:_,"data-key":i.key};return qe("div",kr(Z,{role:"columnheader"}),[z,C&&qe(Yae,{class:[a.e("sort-icon"),G&&a.is("sorting")],sortOrder:U},null)])},oB=(e,{slots:t})=>{var i;return qe("div",{class:e.class,style:e.style},[(i=t.default)==null?void 0:i.call(t)])};oB.displayName="ElTableV2Footer";const iB=(e,{slots:t})=>{const i=_t(t,"default",{},()=>[qe(cz,null,null)]);return qe("div",{class:e.class,style:e.style},[i])};iB.displayName="ElTableV2Empty";const sB=(e,{slots:t})=>{var i;return qe("div",{class:e.class,style:e.style},[(i=t.default)==null?void 0:i.call(t)])};sB.displayName="ElTableV2Overlay";function Jg(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ho(e)}const ule="ElTableV2",dle=Ge({name:ule,props:Uae,setup(e,{slots:t,expose:i}){const a=Jt("table-v2"),{columnsStyles:d,fixedColumnsOnLeft:m,fixedColumnsOnRight:_,mainColumns:x,mainTableHeight:o,fixedTableHeight:C,leftTableWidth:k,rightTableWidth:A,data:z,depthMap:N,expandedRowKeys:$,hasFixedColumns:F,mainTableRef:G,leftTableRef:U,rightTableRef:te,isDynamic:Z,isResetting:q,isScrolling:X,bodyWidth:ie,emptyStyle:de,rootStyle:le,headerWidth:pe,footerHeight:ge,showEmpty:he,scrollTo:ue,scrollToLeft:Re,scrollToTop:Ye,scrollToRow:Ie,getRowHeight:fe,onColumnSorted:Me,onRowHeightChange:Se,onRowHovered:ye,onRowExpanded:Ce,onRowsRendered:Fe,onScroll:it,onVerticalScroll:We}=$ae(e);return i({scrollTo:ue,scrollToLeft:Re,scrollToTop:Ye,scrollToRow:Ie}),Br(iE,{ns:a,isResetting:q,isScrolling:X}),()=>{const{cache:ut,cellProps:Lt,estimatedRowHeight:Ft,expandColumnKey:mt,fixedData:jt,headerHeight:Ht,headerClass:Tn,headerProps:Pe,headerCellProps:At,sortBy:He,sortState:pt,rowHeight:et,rowClass:rn,rowEventHandlers:kt,rowKey:zt,rowProps:Mt,scrollbarAlwaysOn:en,indentSize:sn,iconSize:dn,useIsScrolling:Pn,vScrollbarSize:Ot,width:Zt}=e,jn=y(z),ir={cache:ut,class:a.e("main"),columns:y(x),data:jn,fixedData:jt,estimatedRowHeight:Ft,bodyWidth:y(ie)+Ot,headerHeight:Ht,headerWidth:y(pe),height:y(o),mainTableRef:G,rowKey:zt,rowHeight:et,scrollbarAlwaysOn:en,scrollbarStartGap:2,scrollbarEndGap:Ot,useIsScrolling:Pn,width:Zt,getRowHeight:fe,onRowsRendered:Fe,onScroll:it},ur=y(k),ar=y(C),wr={cache:ut,class:a.e("left"),columns:y(m),data:jn,estimatedRowHeight:Ft,leftTableRef:U,rowHeight:et,bodyWidth:ur,headerWidth:ur,headerHeight:Ht,height:ar,rowKey:zt,scrollbarAlwaysOn:en,scrollbarStartGap:2,scrollbarEndGap:Ot,useIsScrolling:Pn,width:ur,getRowHeight:fe,onScroll:We},Rt=y(A)+Ot,_n={cache:ut,class:a.e("right"),columns:y(_),data:jn,estimatedRowHeight:Ft,rightTableRef:te,rowHeight:et,bodyWidth:Rt,headerWidth:Rt,headerHeight:Ht,height:ar,rowKey:zt,scrollbarAlwaysOn:en,scrollbarStartGap:2,scrollbarEndGap:Ot,width:Rt,style:`--${y(a.namespace)}-table-scrollbar-size: ${Ot}px`,useIsScrolling:Pn,getRowHeight:fe,onScroll:We},dt=y(d),tn={ns:a,depthMap:y(N),columnsStyles:dt,expandColumnKey:mt,expandedRowKeys:y($),estimatedRowHeight:Ft,hasFixedColumns:y(F),rowProps:Mt,rowClass:rn,rowKey:zt,rowEventHandlers:kt,onRowHovered:ye,onRowExpanded:Ce,onRowHeightChange:Se},Ze={cellProps:Lt,expandColumnKey:mt,indentSize:sn,iconSize:dn,rowKey:zt,expandedRowKeys:y($),ns:a},gn={ns:a,headerClass:Tn,headerProps:Pe,columnsStyles:dt},rr={ns:a,sortBy:He,sortState:pt,headerCellProps:At,onColumnSorted:Me},Hn={row:mo=>qe(ale,kr(mo,tn),{row:t.row,cell:bo=>{let Rr;return t.cell?qe(eT,kr(bo,Ze,{style:dt[bo.column.key]}),Jg(Rr=t.cell(bo))?Rr:{default:()=>[Rr]}):qe(eT,kr(bo,Ze,{style:dt[bo.column.key]}),null)}}),header:mo=>qe(cle,kr(mo,gn),{header:t.header,cell:bo=>{let Rr;return t["header-cell"]?qe(XR,kr(bo,rr,{style:dt[bo.column.key]}),Jg(Rr=t["header-cell"](bo))?Rr:{default:()=>[Rr]}):qe(XR,kr(bo,rr,{style:dt[bo.column.key]}),null)}})},eo=[e.class,a.b(),a.e("root"),{[a.is("dynamic")]:y(Z)}],Mi={class:a.e("footer"),style:y(ge)};return qe("div",{class:eo,style:y(le)},[qe(tle,ir,Jg(Hn)?Hn:{default:()=>[Hn]}),qe(rle,wr,Jg(Hn)?Hn:{default:()=>[Hn]}),qe(ile,_n,Jg(Hn)?Hn:{default:()=>[Hn]}),t.footer&&qe(oB,Mi,{default:t.footer}),y(he)&&qe(iB,{class:a.e("empty"),style:y(de)},{default:t.empty}),t.overlay&&qe(sB,{class:a.e("overlay")},{default:t.overlay})])}}}),hle=ln({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:at(Function)}}),fle=Ge({name:"ElAutoResizer",props:hle,setup(e,{slots:t}){const i=Jt("auto-resizer"),{height:a,width:d,sizer:m}=Nae(e),_={width:"100%",height:"100%"};return()=>{var x;return qe("div",{ref:m,class:i.b(),style:_},[(x=t.default)==null?void 0:x.call(t,{height:a.value,width:d.value})])}}}),ple=cr(dle),mle=cr(fle),a1=Symbol("tabsRootContextKey"),gle=ln({tabs:{type:at(Array),default:()=>Xo([])}}),aB="ElTabBar",vle=Ge({name:aB}),_le=Ge({...vle,props:gle,setup(e,{expose:t}){const i=e,a=Cr(),d=kn(a1);d||Ci(aB,"<el-tabs><el-tab-bar /></el-tabs>");const m=Jt("tabs"),_=be(),x=be(),o=()=>{let N=0,$=0;const F=["top","bottom"].includes(d.props.tabPosition)?"width":"height",G=F==="width"?"x":"y",U=G==="x"?"left":"top";return i.tabs.every(te=>{var Z,q;const X=(q=(Z=a.parent)==null?void 0:Z.refs)==null?void 0:q[`tab-${te.uid}`];if(!X)return!1;if(!te.active)return!0;N=X[`offset${jl(U)}`],$=X[`client${jl(F)}`];const ie=window.getComputedStyle(X);return F==="width"&&($-=Number.parseFloat(ie.paddingLeft)+Number.parseFloat(ie.paddingRight),N+=Number.parseFloat(ie.paddingLeft)),!1}),{[F]:`${$}px`,transform:`translate${jl(G)}(${N}px)`}},C=()=>x.value=o(),k=[],A=()=>{var N;k.forEach(F=>F.stop()),k.length=0;const $=(N=a.parent)==null?void 0:N.refs;if($){for(const F in $)if(F.startsWith("tab-")){const G=$[F];G&&k.push(qo(G,C))}}};Wt(()=>i.tabs,async()=>{await Vn(),C(),A()},{immediate:!0});const z=qo(_,()=>C());return Io(()=>{k.forEach(N=>N.stop()),k.length=0,z.stop()}),t({ref:_,update:C}),(N,$)=>(se(),Ae("div",{ref_key:"barRef",ref:_,class:ce([y(m).e("active-bar"),y(m).is(y(d).props.tabPosition)]),style:Nn(x.value)},null,6))}});var yle=hn(_le,[["__file","tab-bar.vue"]]);const ble=ln({panes:{type:at(Array),default:()=>Xo([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),xle={tabClick:(e,t,i)=>i instanceof Event,tabRemove:(e,t)=>t instanceof Event},JR="ElTabNav",wle=Ge({name:JR,props:ble,emits:xle,setup(e,{expose:t,emit:i}){const a=kn(a1);a||Ci(JR,"<el-tabs><tab-nav /></el-tabs>");const d=Jt("tabs"),m=mV(),_=MV(),x=be(),o=be(),C=be(),k=be(),A=be(!1),z=be(0),N=be(!1),$=be(!0),F=Q(()=>["top","bottom"].includes(a.props.tabPosition)?"width":"height"),G=Q(()=>({transform:`translate${F.value==="width"?"X":"Y"}(-${z.value}px)`})),U=()=>{if(!x.value)return;const le=x.value[`offset${jl(F.value)}`],pe=z.value;if(!pe)return;const ge=pe>le?pe-le:0;z.value=ge},te=()=>{if(!x.value||!o.value)return;const le=o.value[`offset${jl(F.value)}`],pe=x.value[`offset${jl(F.value)}`],ge=z.value;if(le-ge<=pe)return;const he=le-ge>pe*2?ge+pe:le-pe;z.value=he},Z=async()=>{const le=o.value;if(!A.value||!C.value||!x.value||!le)return;await Vn();const pe=C.value.querySelector(".is-active");if(!pe)return;const ge=x.value,he=["top","bottom"].includes(a.props.tabPosition),ue=pe.getBoundingClientRect(),Re=ge.getBoundingClientRect(),Ye=he?le.offsetWidth-Re.width:le.offsetHeight-Re.height,Ie=z.value;let fe=Ie;he?(ue.left<Re.left&&(fe=Ie-(Re.left-ue.left)),ue.right>Re.right&&(fe=Ie+ue.right-Re.right)):(ue.top<Re.top&&(fe=Ie-(Re.top-ue.top)),ue.bottom>Re.bottom&&(fe=Ie+(ue.bottom-Re.bottom))),fe=Math.max(fe,0),z.value=Math.min(fe,Ye)},q=()=>{var le;if(!o.value||!x.value)return;e.stretch&&((le=k.value)==null||le.update());const pe=o.value[`offset${jl(F.value)}`],ge=x.value[`offset${jl(F.value)}`],he=z.value;ge<pe?(A.value=A.value||{},A.value.prev=he,A.value.next=he+ge<pe,pe-he<ge&&(z.value=pe-ge)):(A.value=!1,he>0&&(z.value=0))},X=le=>{let pe=0;switch(le.code){case En.left:case En.up:pe=-1;break;case En.right:case En.down:pe=1;break;default:return}const ge=Array.from(le.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)"));let ue=ge.indexOf(le.target)+pe;ue<0?ue=ge.length-1:ue>=ge.length&&(ue=0),ge[ue].focus({preventScroll:!0}),ge[ue].click(),ie()},ie=()=>{$.value&&(N.value=!0)},de=()=>N.value=!1;return Wt(m,le=>{le==="hidden"?$.value=!1:le==="visible"&&setTimeout(()=>$.value=!0,50)}),Wt(_,le=>{le?setTimeout(()=>$.value=!0,50):$.value=!1}),qo(C,q),vr(()=>setTimeout(()=>Z(),0)),Jl(()=>q()),t({scrollToActiveTab:Z,removeFocus:de}),()=>{const le=A.value?[qe("span",{class:[d.e("nav-prev"),d.is("disabled",!A.value.prev)],onClick:U},[qe(Dn,null,{default:()=>[qe(nd,null,null)]})]),qe("span",{class:[d.e("nav-next"),d.is("disabled",!A.value.next)],onClick:te},[qe(Dn,null,{default:()=>[qe(Os,null,null)]})])]:null,pe=e.panes.map((ge,he)=>{var ue,Re,Ye,Ie;const fe=ge.uid,Me=ge.props.disabled,Se=(Re=(ue=ge.props.name)!=null?ue:ge.index)!=null?Re:`${he}`,ye=!Me&&(ge.isClosable||e.editable);ge.index=`${he}`;const Ce=ye?qe(Dn,{class:"is-icon-close",onClick:We=>i("tabRemove",ge,We)},{default:()=>[qe(vl,null,null)]}):null,Fe=((Ie=(Ye=ge.slots).label)==null?void 0:Ie.call(Ye))||ge.props.label,it=!Me&&ge.active?0:-1;return qe("div",{ref:`tab-${fe}`,class:[d.e("item"),d.is(a.props.tabPosition),d.is("active",ge.active),d.is("disabled",Me),d.is("closable",ye),d.is("focus",N.value)],id:`tab-${Se}`,key:`tab-${fe}`,"aria-controls":`pane-${Se}`,role:"tab","aria-selected":ge.active,tabindex:it,onFocus:()=>ie(),onBlur:()=>de(),onClick:We=>{de(),i("tabClick",ge,Se,We)},onKeydown:We=>{ye&&(We.code===En.delete||We.code===En.backspace)&&i("tabRemove",ge,We)}},[Fe,Ce])});return qe("div",{ref:C,class:[d.e("nav-wrap"),d.is("scrollable",!!A.value),d.is(a.props.tabPosition)]},[le,qe("div",{class:d.e("nav-scroll"),ref:x},[qe("div",{class:[d.e("nav"),d.is(a.props.tabPosition),d.is("stretch",e.stretch&&["top","bottom"].includes(a.props.tabPosition))],ref:o,style:G.value,role:"tablist",onKeydown:X},[e.type?null:qe(yle,{ref:k,tabs:[...e.panes]},null),pe])])])}}}),Sle=ln({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:at(Function),default:()=>!0},stretch:Boolean}),zw=e=>zn(e)||Wn(e),Tle={[xr]:e=>zw(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>zw(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>zw(e),tabAdd:()=>!0},Cle=Ge({name:"ElTabs",props:Sle,emits:Tle,setup(e,{emit:t,slots:i,expose:a}){var d;const m=Jt("tabs"),_=Q(()=>["left","right"].includes(e.tabPosition)),{children:x,addChild:o,removeChild:C}=IC(Cr(),"ElTabPane"),k=be(),A=be((d=e.modelValue)!=null?d:"0"),z=async(U,te=!1)=>{var Z,q,X;if(!(A.value===U||Bo(U)))try{await((Z=e.beforeLeave)==null?void 0:Z.call(e,U,A.value))!==!1&&(A.value=U,te&&(t(xr,U),t("tabChange",U)),(X=(q=k.value)==null?void 0:q.removeFocus)==null||X.call(q))}catch{}},N=(U,te,Z)=>{U.props.disabled||(z(te,!0),t("tabClick",U,Z))},$=(U,te)=>{U.props.disabled||Bo(U.props.name)||(te.stopPropagation(),t("edit",U.props.name,"remove"),t("tabRemove",U.props.name))},F=()=>{t("edit",void 0,"add"),t("tabAdd")};Wt(()=>e.modelValue,U=>z(U)),Wt(A,async()=>{var U;await Vn(),(U=k.value)==null||U.scrollToActiveTab()}),Br(a1,{props:e,currentName:A,registerPane:U=>{x.value.push(U)},sortPane:o,unregisterPane:C}),a({currentName:A});const G=({render:U})=>U();return()=>{const U=i["add-icon"],te=e.editable||e.addable?qe("div",{class:[m.e("new-tab"),_.value&&m.e("new-tab-vertical")],tabindex:"0",onClick:F,onKeydown:X=>{[En.enter,En.numpadEnter].includes(X.code)&&F()}},[U?_t(i,"add-icon"):qe(Dn,{class:m.is("icon-plus")},{default:()=>[qe(FO,null,null)]})]):null,Z=qe("div",{class:[m.e("header"),_.value&&m.e("header-vertical"),m.is(e.tabPosition)]},[qe(G,{render:()=>{const X=x.value.some(ie=>ie.slots.label);return qe(wle,{ref:k,currentName:A.value,editable:e.editable,type:e.type,panes:x.value,stretch:e.stretch,onTabClick:N,onTabRemove:$},{$stable:!X})}},null),te]),q=qe("div",{class:m.e("content")},[_t(i,"default")]);return qe("div",{class:[m.b(),m.m(e.tabPosition),{[m.m("card")]:e.type==="card",[m.m("border-card")]:e.type==="border-card"}]},[q,Z])}}}),Ele=ln({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),lB="ElTabPane",Mle=Ge({name:lB}),Ile=Ge({...Mle,props:Ele,setup(e){const t=e,i=Cr(),a=Ai(),d=kn(a1);d||Ci(lB,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const m=Jt("tab-pane"),_=be(),x=Q(()=>t.closable||d.props.closable),o=eS(()=>{var N;return d.currentName.value===((N=t.name)!=null?N:_.value)}),C=be(o.value),k=Q(()=>{var N;return(N=t.name)!=null?N:_.value}),A=eS(()=>!t.lazy||C.value||o.value);Wt(o,N=>{N&&(C.value=!0)});const z=ao({uid:i.uid,slots:a,props:t,paneName:k,active:o,index:_,isClosable:x});return d.registerPane(z),vr(()=>{d.sortPane(z)}),cd(()=>{d.unregisterPane(z.uid)}),(N,$)=>y(A)?mr((se(),Ae("div",{key:0,id:`pane-${y(k)}`,class:ce(y(m).b()),role:"tabpanel","aria-hidden":!y(o),"aria-labelledby":`tab-${y(k)}`},[_t(N.$slots,"default")],10,["id","aria-hidden","aria-labelledby"])),[[no,y(o)]]):bt("v-if",!0)}});var cB=hn(Ile,[["__file","tab-pane.vue"]]);const kle=cr(Cle,{TabPane:cB}),Ale=Jo(cB),Ple=ln({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:tc,default:""},truncated:Boolean,lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),Rle=Ge({name:"ElText"}),Dle=Ge({...Rle,props:Ple,setup(e){const t=e,i=xi(),a=Jt("text"),d=Q(()=>[a.b(),a.m(t.type),a.m(i.value),a.is("truncated",t.truncated),a.is("line-clamp",!Bo(t.lineClamp))]);return(m,_)=>(se(),It(Ir(m.tag),{class:ce(y(d)),style:Nn({"-webkit-line-clamp":m.lineClamp})},{default:st(()=>[_t(m.$slots,"default")]),_:3},8,["class","style"]))}});var Lle=hn(Dle,[["__file","text.vue"]]);const Ole=cr(Lle),zle=ln({format:{type:String,default:"HH:mm"},modelValue:String,disabled:Boolean,editable:{type:Boolean,default:!0},effect:{type:at(String),default:"light"},clearable:{type:Boolean,default:!0},size:Ei,placeholder:String,start:{type:String,default:"09:00"},end:{type:String,default:"18:00"},step:{type:String,default:"00:30"},minTime:String,maxTime:String,name:String,prefixIcon:{type:at([String,Object]),default:()=>BO},clearIcon:{type:at([String,Object]),default:()=>dd},...em}),kc=e=>{const t=(e||"").split(":");if(t.length>=2){let i=Number.parseInt(t[0],10);const a=Number.parseInt(t[1],10),d=e.toUpperCase();return d.includes("AM")&&i===12?i=0:d.includes("PM")&&i!==12&&(i+=12),{hours:i,minutes:a}}return null},Bw=(e,t)=>{const i=kc(e);if(!i)return-1;const a=kc(t);if(!a)return-1;const d=i.minutes+i.hours*60,m=a.minutes+a.hours*60;return d===m?0:d>m?1:-1},QR=e=>`${e}`.padStart(2,"0"),up=e=>`${QR(e.hours)}:${QR(e.minutes)}`,Ble=(e,t)=>{const i=kc(e);if(!i)return"";const a=kc(t);if(!a)return"";const d={hours:i.hours,minutes:i.minutes};return d.minutes+=a.minutes,d.hours+=a.hours,d.hours+=Math.floor(d.minutes/60),d.minutes=d.minutes%60,up(d)},Fle=Ge({name:"ElTimeSelect"}),Nle=Ge({...Fle,props:zle,emits:["change","blur","focus","clear","update:modelValue"],setup(e,{expose:t}){const i=e;sr.extend(zC);const{Option:a}=Ph,d=Jt("input"),m=be(),_=ys(),{lang:x}=Gr(),o=Q(()=>i.modelValue),C=Q(()=>{const U=kc(i.start);return U?up(U):null}),k=Q(()=>{const U=kc(i.end);return U?up(U):null}),A=Q(()=>{const U=kc(i.step);return U?up(U):null}),z=Q(()=>{const U=kc(i.minTime||"");return U?up(U):null}),N=Q(()=>{const U=kc(i.maxTime||"");return U?up(U):null}),$=Q(()=>{const U=[];if(i.start&&i.end&&i.step){let te=C.value,Z;for(;te&&k.value&&Bw(te,k.value)<=0;)Z=sr(te,"HH:mm").locale(x.value).format(i.format),U.push({value:Z,disabled:Bw(te,z.value||"-1:-1")<=0||Bw(te,N.value||"100:100")>=0}),te=Ble(te,A.value)}return U});return t({blur:()=>{var U,te;(te=(U=m.value)==null?void 0:U.blur)==null||te.call(U)},focus:()=>{var U,te;(te=(U=m.value)==null?void 0:U.focus)==null||te.call(U)}}),(U,te)=>(se(),It(y(Ph),{ref_key:"select",ref:m,"model-value":y(o),disabled:y(_),clearable:U.clearable,"clear-icon":U.clearIcon,size:U.size,effect:U.effect,placeholder:U.placeholder,"default-first-option":"",filterable:U.editable,"empty-values":U.emptyValues,"value-on-clear":U.valueOnClear,"onUpdate:modelValue":Z=>U.$emit("update:modelValue",Z),onChange:Z=>U.$emit("change",Z),onBlur:Z=>U.$emit("blur",Z),onFocus:Z=>U.$emit("focus",Z),onClear:()=>U.$emit("clear")},{prefix:st(()=>[U.prefixIcon?(se(),It(y(Dn),{key:0,class:ce(y(d).e("prefix-icon"))},{default:st(()=>[(se(),It(Ir(U.prefixIcon)))]),_:1},8,["class"])):bt("v-if",!0)]),default:st(()=>[(se(!0),Ae(Bn,null,Fr(y($),Z=>(se(),It(y(a),{key:Z.value,label:Z.value,value:Z.value,disabled:Z.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["model-value","disabled","clearable","clear-icon","size","effect","placeholder","filterable","empty-values","value-on-clear","onUpdate:modelValue","onChange","onBlur","onFocus","onClear"]))}});var $le=hn(Nle,[["__file","time-select.vue"]]);const Vle=cr($le),Ule=Ge({name:"ElTimeline",setup(e,{slots:t}){const i=Jt("timeline");return Br("timeline",t),()=>Kn("ul",{class:[i.b()]},[_t(t,"default")])}}),jle=ln({timestamp:{type:String,default:""},hideTimestamp:Boolean,center:Boolean,placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:wo},hollow:Boolean}),Hle=Ge({name:"ElTimelineItem"}),Gle=Ge({...Hle,props:jle,setup(e){const t=e,i=Jt("timeline-item"),a=Q(()=>[i.e("node"),i.em("node",t.size||""),i.em("node",t.type||""),i.is("hollow",t.hollow)]);return(d,m)=>(se(),Ae("li",{class:ce([y(i).b(),{[y(i).e("center")]:d.center}])},[Ve("div",{class:ce(y(i).e("tail"))},null,2),d.$slots.dot?bt("v-if",!0):(se(),Ae("div",{key:0,class:ce(y(a)),style:Nn({backgroundColor:d.color})},[d.icon?(se(),It(y(Dn),{key:0,class:ce(y(i).e("icon"))},{default:st(()=>[(se(),It(Ir(d.icon)))]),_:1},8,["class"])):bt("v-if",!0)],6)),d.$slots.dot?(se(),Ae("div",{key:1,class:ce(y(i).e("dot"))},[_t(d.$slots,"dot")],2)):bt("v-if",!0),Ve("div",{class:ce(y(i).e("wrapper"))},[!d.hideTimestamp&&d.placement==="top"?(se(),Ae("div",{key:0,class:ce([y(i).e("timestamp"),y(i).is("top")])},fn(d.timestamp),3)):bt("v-if",!0),Ve("div",{class:ce(y(i).e("content"))},[_t(d.$slots,"default")],2),!d.hideTimestamp&&d.placement==="bottom"?(se(),Ae("div",{key:1,class:ce([y(i).e("timestamp"),y(i).is("bottom")])},fn(d.timestamp),3)):bt("v-if",!0)],2)],2))}});var uB=hn(Gle,[["__file","timeline-item.vue"]]);const Wle=cr(Ule,{TimelineItem:uB}),qle=Jo(uB),dB=ln({nowrap:Boolean});var hB=(e=>(e.top="top",e.bottom="bottom",e.left="left",e.right="right",e))(hB||{});const Kle=Object.values(hB),dE=ln({width:{type:Number,default:10},height:{type:Number,default:10},style:{type:at(Object),default:null}}),Zle=ln({side:{type:at(String),values:Kle,required:!0}}),Yle=["absolute","fixed"],Xle=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],hE=ln({arrowPadding:{type:at(Number),default:5},effect:{type:at(String),default:"light"},contentClass:String,placement:{type:at(String),values:Xle,default:"bottom"},reference:{type:at(Object),default:null},offset:{type:Number,default:8},strategy:{type:at(String),values:Yle,default:"absolute"},showArrow:Boolean,...qi(["ariaLabel"])}),fE=ln({delayDuration:{type:Number,default:300},defaultOpen:Boolean,open:{type:Boolean,default:void 0},onOpenChange:{type:at(Function)},"onUpdate:open":{type:at(Function)}}),ip={type:at(Function)},pE=ln({onBlur:ip,onClick:ip,onFocus:ip,onMouseDown:ip,onMouseEnter:ip,onMouseLeave:ip}),Jle=ln({...fE,...dE,...pE,...hE,alwaysOn:Boolean,fullTransition:Boolean,transitionProps:{type:at(Object),default:null},teleported:Boolean,to:{type:at(String),default:"body"}}),l1=Symbol("tooltipV2"),fB=Symbol("tooltipV2Content"),Fw="tooltip_v2.open",Qle=Ge({name:"ElTooltipV2Root"}),ece=Ge({...Qle,props:fE,setup(e,{expose:t}){const i=e,a=be(i.defaultOpen),d=be(null),m=Q({get:()=>Eh(i.open)?a.value:i.open,set:G=>{var U;a.value=G,(U=i["onUpdate:open"])==null||U.call(i,G)}}),_=Q(()=>Wn(i.delayDuration)&&i.delayDuration>0),{start:x,stop:o}=Th(()=>{m.value=!0},Q(()=>i.delayDuration),{immediate:!1}),C=Jt("tooltip-v2"),k=Wi(),A=()=>{o(),m.value=!0},z=()=>{y(_)?x():A()},N=A,$=()=>{o(),m.value=!1};return Wt(m,G=>{var U;G&&(document.dispatchEvent(new CustomEvent(Fw)),N()),(U=i.onOpenChange)==null||U.call(i,G)}),vr(()=>{document.addEventListener(Fw,$)}),Io(()=>{o(),document.removeEventListener(Fw,$)}),Br(l1,{contentId:k,triggerRef:d,ns:C,onClose:$,onDelayOpen:z,onOpen:N}),t({onOpen:N,onClose:$}),(G,U)=>_t(G.$slots,"default",{open:y(m)})}});var tce=hn(ece,[["__file","root.vue"]]);const nce=Ge({name:"ElTooltipV2Arrow"}),rce=Ge({...nce,props:{...dE,...Zle},setup(e){const t=e,{ns:i}=kn(l1),{arrowRef:a}=kn(fB),d=Q(()=>{const{style:m,width:_,height:x}=t,o=i.namespace.value;return{[`--${o}-tooltip-v2-arrow-width`]:`${_}px`,[`--${o}-tooltip-v2-arrow-height`]:`${x}px`,[`--${o}-tooltip-v2-arrow-border-width`]:`${_/2}px`,[`--${o}-tooltip-v2-arrow-cover-width`]:_/2-1,...m||{}}});return(m,_)=>(se(),Ae("span",{ref_key:"arrowRef",ref:a,style:Nn(y(d)),class:ce(y(i).e("arrow"))},null,6))}});var eD=hn(rce,[["__file","arrow.vue"]]);const oce=ln({style:{type:at([String,Object,Array]),default:()=>({})}}),ice=Ge({name:"ElVisuallyHidden"}),sce=Ge({...ice,props:oce,setup(e){const t=e,i=Q(()=>[t.style,{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}]);return(a,d)=>(se(),Ae("span",kr(a.$attrs,{style:y(i)}),[_t(a.$slots,"default")],16))}});var ace=hn(sce,[["__file","visual-hidden.vue"]]);const lce=Ge({name:"ElTooltipV2Content"}),cce=Ge({...lce,props:{...hE,...dB},setup(e){const t=e,{triggerRef:i,contentId:a}=kn(l1),d=be(t.placement),m=be(t.strategy),_=be(null),{referenceRef:x,contentRef:o,middlewareData:C,x:k,y:A,update:z}=kq({placement:d,strategy:m,middleware:Q(()=>{const Z=[_4(t.offset)];return t.showArrow&&Z.push(Aq({arrowRef:_})),Z})}),N=Jp().nextZIndex(),$=Jt("tooltip-v2"),F=Q(()=>d.value.split("-")[0]),G=Q(()=>({position:y(m),top:`${y(A)||0}px`,left:`${y(k)||0}px`,zIndex:N})),U=Q(()=>{if(!t.showArrow)return{};const{arrow:Z}=y(C);return{[`--${$.namespace.value}-tooltip-v2-arrow-x`]:`${Z==null?void 0:Z.x}px`||"",[`--${$.namespace.value}-tooltip-v2-arrow-y`]:`${Z==null?void 0:Z.y}px`||""}}),te=Q(()=>[$.e("content"),$.is("dark",t.effect==="dark"),$.is(y(m)),t.contentClass]);return Wt(_,()=>z()),Wt(()=>t.placement,Z=>d.value=Z),vr(()=>{Wt(()=>t.reference||i.value,Z=>{x.value=Z||void 0},{immediate:!0})}),Br(fB,{arrowRef:_}),(Z,q)=>(se(),Ae("div",{ref_key:"contentRef",ref:o,style:Nn(y(G)),"data-tooltip-v2-root":""},[Z.nowrap?bt("v-if",!0):(se(),Ae("div",{key:0,"data-side":y(F),class:ce(y(te))},[_t(Z.$slots,"default",{contentStyle:y(G),contentClass:y(te)}),qe(y(ace),{id:y(a),role:"tooltip"},{default:st(()=>[Z.ariaLabel?(se(),Ae(Bn,{key:0},[$r(fn(Z.ariaLabel),1)],64)):_t(Z.$slots,"default",{key:1})]),_:3},8,["id"]),_t(Z.$slots,"arrow",{style:Nn(y(U)),side:y(F)})],10,["data-side"]))],4))}});var tD=hn(cce,[["__file","content.vue"]]);const uce=ln({setRef:{type:at(Function),required:!0},onlyChild:Boolean});var dce=Ge({props:uce,setup(e,{slots:t}){const i=be(),a=Hb(i,d=>{d?e.setRef(d.nextElementSibling):e.setRef(null)});return()=>{var d;const[m]=((d=t.default)==null?void 0:d.call(t))||[],_=e.onlyChild?wW(m.children):m.children;return qe(Bn,{ref:a},[_])}}});const hce=Ge({name:"ElTooltipV2Trigger"}),fce=Ge({...hce,props:{...dB,...pE},setup(e){const t=e,{onClose:i,onOpen:a,onDelayOpen:d,triggerRef:m,contentId:_}=kn(l1);let x=!1;const o=te=>{m.value=te},C=()=>{x=!1},k=ai(t.onMouseEnter,d),A=ai(t.onMouseLeave,i),z=ai(t.onMouseDown,()=>{i(),x=!0,document.addEventListener("mouseup",C,{once:!0})}),N=ai(t.onFocus,()=>{x||a()}),$=ai(t.onBlur,i),F=ai(t.onClick,te=>{te.detail===0&&i()}),G={blur:$,click:F,focus:N,mousedown:z,mouseenter:k,mouseleave:A},U=(te,Z,q)=>{te&&Object.entries(Z).forEach(([X,ie])=>{te[q](X,ie)})};return Wt(m,(te,Z)=>{U(te,G,"addEventListener"),U(Z,G,"removeEventListener"),te&&te.setAttribute("aria-describedby",_.value)}),Io(()=>{U(m.value,G,"removeEventListener"),document.removeEventListener("mouseup",C)}),(te,Z)=>te.nowrap?(se(),It(y(dce),{key:0,"set-ref":o,"only-child":""},{default:st(()=>[_t(te.$slots,"default")]),_:3})):(se(),Ae("button",kr({key:1,ref_key:"triggerRef",ref:m},te.$attrs),[_t(te.$slots,"default")],16))}});var pce=hn(fce,[["__file","trigger.vue"]]);const mce=Ge({name:"ElTooltipV2"}),gce=Ge({...mce,props:Jle,setup(e){const i=Bi(e),a=ao(dl(i,Object.keys(dE))),d=ao(dl(i,Object.keys(hE))),m=ao(dl(i,Object.keys(fE))),_=ao(dl(i,Object.keys(pE)));return(x,o)=>(se(),It(tce,ul(Xu(m)),{default:st(({open:C})=>[qe(pce,kr(_,{nowrap:""}),{default:st(()=>[_t(x.$slots,"trigger")]),_:3},16),qe(y(tm),{to:x.to,disabled:!x.teleported},{default:st(()=>[x.fullTransition?(se(),It(Fi,ul(kr({key:0},x.transitionProps)),{default:st(()=>[x.alwaysOn||C?(se(),It(tD,ul(kr({key:0},d)),{arrow:st(({style:k,side:A})=>[x.showArrow?(se(),It(eD,kr({key:0},a,{style:k,side:A}),null,16,["style","side"])):bt("v-if",!0)]),default:st(()=>[_t(x.$slots,"default")]),_:3},16)):bt("v-if",!0)]),_:2},1040)):(se(),Ae(Bn,{key:1},[x.alwaysOn||C?(se(),It(tD,ul(kr({key:0},d)),{arrow:st(({style:k,side:A})=>[x.showArrow?(se(),It(eD,kr({key:0},a,{style:k,side:A}),null,16,["style","side"])):bt("v-if",!0)]),default:st(()=>[_t(x.$slots,"default")]),_:3},16)):bt("v-if",!0)],64))]),_:2},1032,["to","disabled"])]),_:3},16))}});var vce=hn(gce,[["__file","tooltip.vue"]]);const _ce=cr(vce),pB="left-check-change",mB="right-check-change",dp=ln({data:{type:at(Array),default:()=>[]},titles:{type:at(Array),default:()=>[]},buttonTexts:{type:at(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:at(Function)},leftDefaultChecked:{type:at(Array),default:()=>[]},rightDefaultChecked:{type:at(Array),default:()=>[]},renderContent:{type:at(Function)},modelValue:{type:at(Array),default:()=>[]},format:{type:at(Object),default:()=>({})},filterable:Boolean,props:{type:at(Object),default:()=>Xo({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),tT=(e,t)=>[e,t].every(on)||on(e)&&ki(t),yce={[No]:(e,t,i)=>[e,i].every(on)&&["left","right"].includes(t),[xr]:e=>on(e),[pB]:tT,[mB]:tT},nT="checked-change",bce=ln({data:dp.data,optionRender:{type:at(Function)},placeholder:String,title:String,filterable:Boolean,format:dp.format,filterMethod:dp.filterMethod,defaultChecked:dp.leftDefaultChecked,props:dp.props}),xce={[nT]:tT},d_=e=>{const t={label:"label",key:"key",disabled:"disabled"};return Q(()=>({...t,...e.props}))},wce=(e,t,i)=>{const a=d_(e),d=Q(()=>e.data.filter(k=>Fn(e.filterMethod)?e.filterMethod(t.query,k):String(k[a.value.label]||k[a.value.key]).toLowerCase().includes(t.query.toLowerCase()))),m=Q(()=>d.value.filter(k=>!k[a.value.disabled])),_=Q(()=>{const k=t.checked.length,A=e.data.length,{noChecked:z,hasChecked:N}=e.format;return z&&N?k>0?N.replace(/\${checked}/g,k.toString()).replace(/\${total}/g,A.toString()):z.replace(/\${total}/g,A.toString()):`${k}/${A}`}),x=Q(()=>{const k=t.checked.length;return k>0&&k<m.value.length}),o=()=>{const k=m.value.map(A=>A[a.value.key]);t.allChecked=k.length>0&&k.every(A=>t.checked.includes(A))},C=k=>{t.checked=k?m.value.map(A=>A[a.value.key]):[]};return Wt(()=>t.checked,(k,A)=>{if(o(),t.checkChangeByUser){const z=k.concat(A).filter(N=>!k.includes(N)||!A.includes(N));i(nT,k,z)}else i(nT,k),t.checkChangeByUser=!0}),Wt(m,()=>{o()}),Wt(()=>e.data,()=>{const k=[],A=d.value.map(z=>z[a.value.key]);t.checked.forEach(z=>{A.includes(z)&&k.push(z)}),t.checkChangeByUser=!1,t.checked=k}),Wt(()=>e.defaultChecked,(k,A)=>{if(A&&k.length===A.length&&k.every($=>A.includes($)))return;const z=[],N=m.value.map($=>$[a.value.key]);k.forEach($=>{N.includes($)&&z.push($)}),t.checkChangeByUser=!1,t.checked=z},{immediate:!0}),{filteredData:d,checkableData:m,checkedSummary:_,isIndeterminate:x,updateAllChecked:o,handleAllCheckedChange:C}},Sce=(e,t)=>({onSourceCheckedChange:(d,m)=>{e.leftChecked=d,m&&t(pB,d,m)},onTargetCheckedChange:(d,m)=>{e.rightChecked=d,m&&t(mB,d,m)}}),Tce=e=>{const t=d_(e),i=Q(()=>e.data.reduce((m,_)=>(m[_[t.value.key]]=_)&&m,{})),a=Q(()=>e.data.filter(m=>!e.modelValue.includes(m[t.value.key]))),d=Q(()=>e.targetOrder==="original"?e.data.filter(m=>e.modelValue.includes(m[t.value.key])):e.modelValue.reduce((m,_)=>{const x=i.value[_];return x&&m.push(x),m},[]));return{sourceData:a,targetData:d}},Cce=(e,t,i)=>{const a=d_(e),d=(x,o,C)=>{i(xr,x),i(No,x,o,C)};return{addToLeft:()=>{const x=e.modelValue.slice();t.rightChecked.forEach(o=>{const C=x.indexOf(o);C>-1&&x.splice(C,1)}),d(x,"left",t.rightChecked)},addToRight:()=>{let x=e.modelValue.slice();const o=e.data.filter(C=>{const k=C[a.value.key];return t.leftChecked.includes(k)&&!e.modelValue.includes(k)}).map(C=>C[a.value.key]);x=e.targetOrder==="unshift"?o.concat(x):x.concat(o),e.targetOrder==="original"&&(x=e.data.filter(C=>x.includes(C[a.value.key])).map(C=>C[a.value.key])),d(x,"right",t.leftChecked)}}},Ece=Ge({name:"ElTransferPanel"}),Mce=Ge({...Ece,props:bce,emits:xce,setup(e,{expose:t,emit:i}){const a=e,d=Ai(),m=({option:Z})=>Z,{t:_}=Gr(),x=Jt("transfer"),o=ao({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),C=d_(a),{filteredData:k,checkedSummary:A,isIndeterminate:z,handleAllCheckedChange:N}=wce(a,o,i),$=Q(()=>!da(o.query)&&da(k.value)),F=Q(()=>!da(d.default()[0].children)),{checked:G,allChecked:U,query:te}=Bi(o);return t({query:te}),(Z,q)=>(se(),Ae("div",{class:ce(y(x).b("panel"))},[Ve("p",{class:ce(y(x).be("panel","header"))},[qe(y(Ha),{modelValue:y(U),"onUpdate:modelValue":X=>Fo(U)?U.value=X:null,indeterminate:y(z),"validate-event":!1,onChange:y(N)},{default:st(()=>[$r(fn(Z.title)+" ",1),Ve("span",null,fn(y(A)),1)]),_:1},8,["modelValue","onUpdate:modelValue","indeterminate","onChange"])],2),Ve("div",{class:ce([y(x).be("panel","body"),y(x).is("with-footer",y(F))])},[Z.filterable?(se(),It(y(vs),{key:0,modelValue:y(te),"onUpdate:modelValue":X=>Fo(te)?te.value=X:null,class:ce(y(x).be("panel","filter")),size:"default",placeholder:Z.placeholder,"prefix-icon":y(tW),clearable:"","validate-event":!1},null,8,["modelValue","onUpdate:modelValue","class","placeholder","prefix-icon"])):bt("v-if",!0),mr(qe(y(x2),{modelValue:y(G),"onUpdate:modelValue":X=>Fo(G)?G.value=X:null,"validate-event":!1,class:ce([y(x).is("filterable",Z.filterable),y(x).be("panel","list")])},{default:st(()=>[(se(!0),Ae(Bn,null,Fr(y(k),X=>(se(),It(y(Ha),{key:X[y(C).key],class:ce(y(x).be("panel","item")),value:X[y(C).key],disabled:X[y(C).disabled],"validate-event":!1},{default:st(()=>{var ie;return[qe(m,{option:(ie=Z.optionRender)==null?void 0:ie.call(Z,X)},null,8,["option"])]}),_:2},1032,["class","value","disabled"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"]),[[no,!y($)&&!y(da)(Z.data)]]),mr(Ve("p",{class:ce(y(x).be("panel","empty"))},fn(y($)?y(_)("el.transfer.noMatch"):y(_)("el.transfer.noData")),3),[[no,y($)||y(da)(Z.data)]])],2),y(F)?(se(),Ae("p",{key:0,class:ce(y(x).be("panel","footer"))},[_t(Z.$slots,"default")],2)):bt("v-if",!0)],2))}});var nD=hn(Mce,[["__file","transfer-panel.vue"]]);const Ice=Ge({name:"ElTransfer"}),kce=Ge({...Ice,props:dp,emits:yce,setup(e,{expose:t,emit:i}){const a=e,d=Ai(),{t:m}=Gr(),_=Jt("transfer"),{formItem:x}=bs(),o=ao({leftChecked:[],rightChecked:[]}),C=d_(a),{sourceData:k,targetData:A}=Tce(a),{onSourceCheckedChange:z,onTargetCheckedChange:N}=Sce(o,i),{addToLeft:$,addToRight:F}=Cce(a,o,i),G=be(),U=be(),te=le=>{switch(le){case"left":G.value.query="";break;case"right":U.value.query="";break}},Z=Q(()=>a.buttonTexts.length===2),q=Q(()=>a.titles[0]||m("el.transfer.titles.0")),X=Q(()=>a.titles[1]||m("el.transfer.titles.1")),ie=Q(()=>a.filterPlaceholder||m("el.transfer.filterPlaceholder"));Wt(()=>a.modelValue,()=>{var le;a.validateEvent&&((le=x==null?void 0:x.validate)==null||le.call(x,"change").catch(pe=>void 0))});const de=Q(()=>le=>{var pe;if(a.renderContent)return a.renderContent(Kn,le);const ge=(((pe=d.default)==null?void 0:pe.call(d,{option:le}))||[]).filter(he=>he.type!==Oi);return ge.length?ge:Kn("span",le[C.value.label]||le[C.value.key])});return t({clearQuery:te,leftPanel:G,rightPanel:U}),(le,pe)=>(se(),Ae("div",{class:ce(y(_).b())},[qe(nD,{ref_key:"leftPanel",ref:G,data:y(k),"option-render":y(de),placeholder:y(ie),title:y(q),filterable:le.filterable,format:le.format,"filter-method":le.filterMethod,"default-checked":le.leftDefaultChecked,props:a.props,onCheckedChange:y(z)},{default:st(()=>[_t(le.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),Ve("div",{class:ce(y(_).e("buttons"))},[qe(y(zi),{type:"primary",class:ce([y(_).e("button"),y(_).is("with-texts",y(Z))]),disabled:y(da)(o.rightChecked),onClick:y($)},{default:st(()=>[qe(y(Dn),null,{default:st(()=>[qe(y(nd))]),_:1}),y(Bo)(le.buttonTexts[0])?bt("v-if",!0):(se(),Ae("span",{key:0},fn(le.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),qe(y(zi),{type:"primary",class:ce([y(_).e("button"),y(_).is("with-texts",y(Z))]),disabled:y(da)(o.leftChecked),onClick:y(F)},{default:st(()=>[y(Bo)(le.buttonTexts[1])?bt("v-if",!0):(se(),Ae("span",{key:0},fn(le.buttonTexts[1]),1)),qe(y(Dn),null,{default:st(()=>[qe(y(Os))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),qe(nD,{ref_key:"rightPanel",ref:U,data:y(A),"option-render":y(de),placeholder:y(ie),filterable:le.filterable,format:le.format,"filter-method":le.filterMethod,title:y(X),"default-checked":le.rightDefaultChecked,props:a.props,onCheckedChange:y(N)},{default:st(()=>[_t(le.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var Ace=hn(kce,[["__file","transfer.vue"]]);const Pce=cr(Ace),Ep="$treeNodeId",rD=function(e,t){!t||t[Ep]||Object.defineProperty(t,Ep,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},mE=function(e,t){return e?t[e]:t[Ep]},rT=(e,t,i)=>{const a=e.value.currentNode;i();const d=e.value.currentNode;a!==d&&t("current-change",d?d.data:null,d)},oT=e=>{let t=!0,i=!0,a=!0;for(let d=0,m=e.length;d<m;d++){const _=e[d];(_.checked!==!0||_.indeterminate)&&(t=!1,_.disabled||(a=!1)),(_.checked!==!1||_.indeterminate)&&(i=!1)}return{all:t,none:i,allWithoutDisable:a,half:!t&&!i}},tv=function(e){if(e.childNodes.length===0||e.loading)return;const{all:t,none:i,half:a}=oT(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):a?(e.checked=!1,e.indeterminate=!0):i&&(e.checked=!1,e.indeterminate=!1);const d=e.parent;!d||d.level===0||e.store.checkStrictly||tv(d)},w0=function(e,t){const i=e.store.props,a=e.data||{},d=i[t];if(Fn(d))return d(a,e);if(zn(d))return a[d];if(Bo(d)){const m=a[t];return m===void 0?"":m}};let Rce=0,iT=class V0{constructor(t){this.id=Rce++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const i in t)Qr(t,i)&&(this[i]=t[i]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const i=t.props;if(i&&typeof i.isLeaf<"u"){const m=w0(this,"isLeaf");ko(m)&&(this.isLeafByUser=m)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&!this.isLeafByUser&&this.expand(),on(this.data)||rD(this,this.data),!this.data)return;const a=t.defaultExpandedKeys,d=t.key;d&&a&&a.includes(this.key)&&this.expand(null,t.autoExpandParent),d&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){on(t)||rD(this,t),this.data=t,this.childNodes=[];let i;this.level===0&&on(this.data)?i=this.data:i=w0(this,"children")||[];for(let a=0,d=i.length;a<d;a++)this.insertChild({data:i[a]})}get label(){return w0(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return w0(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const i=t.childNodes.indexOf(this);if(i>-1)return t.childNodes[i+1]}return null}get previousSibling(){const t=this.parent;if(t){const i=t.childNodes.indexOf(this);if(i>-1)return i>0?t.childNodes[i-1]:null}return null}contains(t,i=!0){return(this.childNodes||[]).some(a=>a===t||i&&a.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,i,a){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof V0)){if(!a){const d=this.getChildren(!0);d.includes(t.data)||(Bo(i)||i<0?d.push(t.data):d.splice(i,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=ao(new V0(t)),t instanceof V0&&t.initialize()}t.level=this.level+1,Bo(i)||i<0?this.childNodes.push(t):this.childNodes.splice(i,0,t),this.updateLeafState()}insertBefore(t,i){let a;i&&(a=this.childNodes.indexOf(i)),this.insertChild(t,a)}insertAfter(t,i){let a;i&&(a=this.childNodes.indexOf(i),a!==-1&&(a+=1)),this.insertChild(t,a)}removeChild(t){const i=this.getChildren()||[],a=i.indexOf(t.data);a>-1&&i.splice(a,1);const d=this.childNodes.indexOf(t);d>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(d,1)),this.updateLeafState()}removeChildByData(t){let i=null;for(let a=0;a<this.childNodes.length;a++)if(this.childNodes[a].data===t){i=this.childNodes[a];break}i&&this.removeChild(i)}expand(t,i){const a=()=>{if(i){let d=this.parent;for(;d.level>0;)d.expanded=!0,d=d.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(d=>{d.canFocus=!0})};this.shouldLoadData()?this.loadData(d=>{on(d)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||tv(this),a())}):a()}doCreateChildren(t,i={}){t.forEach(a=>{this.insertChild(Object.assign({data:a},i),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const t=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!t||t.length===0;return}this.isLeaf=!1}setChecked(t,i,a,d){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:_,allWithoutDisable:x}=oT(this.childNodes);!this.isLeaf&&!_&&x&&(this.checked=!1,t=!1);const o=()=>{if(i){const C=this.childNodes;for(let z=0,N=C.length;z<N;z++){const $=C[z];d=d||t!==!1;const F=$.disabled?$.checked:d;$.setChecked(F,i,!0,d)}const{half:k,all:A}=oT(C);A||(this.checked=A,this.indeterminate=k)}};if(this.shouldLoadData()){this.loadData(()=>{o(),tv(this)},{checked:t!==!1});return}else o()}const m=this.parent;!m||m.level===0||a||tv(m)}getChildren(t=!1){if(this.level===0)return this.data;const i=this.data;if(!i)return null;const a=this.store.props;let d="children";return a&&(d=a.children||"children"),i[d]===void 0&&(i[d]=null),t&&!i[d]&&(i[d]=[]),i[d]}updateChildren(){const t=this.getChildren()||[],i=this.childNodes.map(m=>m.data),a={},d=[];t.forEach((m,_)=>{const x=m[Ep];!!x&&i.findIndex(C=>C[Ep]===x)>=0?a[x]={index:_,data:m}:d.push({index:_,data:m})}),this.store.lazy||i.forEach(m=>{a[m[Ep]]||this.removeChildByData(m)}),d.forEach(({index:m,data:_})=>{this.insertChild({data:_},m)}),this.updateLeafState()}loadData(t,i={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(i).length)){this.loading=!0;const a=m=>{this.childNodes=[],this.doCreateChildren(m,i),this.loaded=!0,this.loading=!1,this.updateLeafState(),t&&t.call(this,m)},d=()=>{this.loading=!1};this.store.load(this,a,d)}else t&&t.call(this)}eachNode(t){const i=[this];for(;i.length;){const a=i.shift();i.unshift(...a.childNodes),t(a)}}reInitChecked(){this.store.checkStrictly||tv(this)}};class Dce{constructor(t){this.currentNode=null,this.currentNodeKey=null;for(const i in t)Qr(t,i)&&(this[i]=t[i]);this.nodesMap={}}initialize(){if(this.root=new iT({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const t=this.load;t(this.root,i=>{this.root.doCreateChildren(i),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(t){const i=this.filterNodeMethod,a=this.lazy,d=function(m){const _=m.root?m.root.childNodes:m.childNodes;if(_.forEach(x=>{x.visible=i.call(x,t,x.data,x),d(x)}),!m.visible&&_.length){let x=!0;x=!_.some(o=>o.visible),m.root?m.root.visible=x===!1:m.visible=x===!1}t&&m.visible&&!m.isLeaf&&(!a||m.loaded)&&m.expand()};d(this)}setData(t){t!==this.root.data?(this.nodesMap={},this.root.setData(t),this._initDefaultCheckedNodes(),this.setCurrentNodeKey(this.currentNodeKey)):this.root.updateChildren()}getNode(t){if(t instanceof iT)return t;const i=Tr(t)?mE(this.key,t):t;return this.nodesMap[i]||null}insertBefore(t,i){const a=this.getNode(i);a.parent.insertBefore({data:t},a)}insertAfter(t,i){const a=this.getNode(i);a.parent.insertAfter({data:t},a)}remove(t){const i=this.getNode(t);i&&i.parent&&(i===this.currentNode&&(this.currentNode=null),i.parent.removeChild(i))}append(t,i){const a=Eh(i)?this.root:this.getNode(i);a&&a.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],i=this.nodesMap;t.forEach(a=>{const d=i[a];d&&d.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const i=this.key;!t||!t.data||(i?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(a=>{this.deregisterNode(a)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,i=!1){const a=[],d=function(m){(m.root?m.root.childNodes:m.childNodes).forEach(x=>{(x.checked||i&&x.indeterminate)&&(!t||t&&x.isLeaf)&&a.push(x.data),d(x)})};return d(this),a}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(i=>(i||{})[this.key])}getHalfCheckedNodes(){const t=[],i=function(a){(a.root?a.root.childNodes:a.childNodes).forEach(m=>{m.indeterminate&&t.push(m.data),i(m)})};return i(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],i=this.nodesMap;for(const a in i)Qr(i,a)&&t.push(i[a]);return t}updateChildren(t,i){const a=this.nodesMap[t];if(!a)return;const d=a.childNodes;for(let m=d.length-1;m>=0;m--){const _=d[m];this.remove(_.data)}for(let m=0,_=i.length;m<_;m++){const x=i[m];this.append(x,a.data)}}_setCheckedKeys(t,i=!1,a){const d=this._getAllNodes().sort((o,C)=>o.level-C.level),m=Object.create(null),_=Object.keys(a);d.forEach(o=>o.setChecked(!1,!1));const x=o=>{o.childNodes.forEach(C=>{var k;m[C.data[t]]=!0,(k=C.childNodes)!=null&&k.length&&x(C)})};for(let o=0,C=d.length;o<C;o++){const k=d[o],A=k.data[t].toString();if(!_.includes(A)){k.checked&&!m[A]&&k.setChecked(!1,!1);continue}if(k.childNodes.length&&x(k),k.isLeaf||this.checkStrictly){k.setChecked(!0,!1);continue}if(k.setChecked(!0,!0),i){k.setChecked(!1,!1);const N=function($){$.childNodes.forEach(G=>{G.isLeaf||G.setChecked(!1,!1),N(G)})};N(k)}}}setCheckedNodes(t,i=!1){const a=this.key,d={};t.forEach(m=>{d[(m||{})[a]]=!0}),this._setCheckedKeys(a,i,d)}setCheckedKeys(t,i=!1){this.defaultCheckedKeys=t;const a=this.key,d={};t.forEach(m=>{d[m]=!0}),this._setCheckedKeys(a,i,d)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(i=>{const a=this.getNode(i);a&&a.expand(null,this.autoExpandParent)})}setChecked(t,i,a){const d=this.getNode(t);d&&d.setChecked(!!i,a)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const i=this.currentNode;i&&(i.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,i=!0){const a=t[this.key],d=this.nodesMap[a];this.setCurrentNode(d),i&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,i=!0){if(this.currentNodeKey=t,t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const a=this.getNode(t);a&&(this.setCurrentNode(a),i&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const Lce=Ge({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=Jt("tree"),i=kn("NodeInstance"),a=kn("RootTree");return()=>{const d=e.node,{data:m,store:_}=d;return e.renderContent?e.renderContent(Kn,{_self:i,node:d,data:m,store:_}):_t(a.ctx.slots,"default",{node:d,data:m},()=>[Kn("span",{class:t.be("node","label")},[d.label])])}}});var Oce=hn(Lce,[["__file","tree-node-content.vue"]]);function gB(e){const t=kn("TreeNodeMap",null),i={treeNodeExpand:a=>{e.node!==a&&e.node.collapse()},children:[]};return t&&t.children.push(i),Br("TreeNodeMap",i),{broadcastExpanded:a=>{if(e.accordion)for(const d of i.children)d.treeNodeExpand(a)}}}const vB=Symbol("dragEvents");function zce({props:e,ctx:t,el$:i,dropIndicator$:a,store:d}){const m=Jt("tree"),_=be({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return Br(vB,{treeNodeDragStart:({event:k,treeNode:A})=>{if(Fn(e.allowDrag)&&!e.allowDrag(A.node))return k.preventDefault(),!1;k.dataTransfer.effectAllowed="move";try{k.dataTransfer.setData("text/plain","")}catch{}_.value.draggingNode=A,t.emit("node-drag-start",A.node,k)},treeNodeDragOver:({event:k,treeNode:A})=>{const z=A,N=_.value.dropNode;N&&N.node.id!==z.node.id&&_s(N.$el,m.is("drop-inner"));const $=_.value.draggingNode;if(!$||!z)return;let F=!0,G=!0,U=!0,te=!0;Fn(e.allowDrop)&&(F=e.allowDrop($.node,z.node,"prev"),te=G=e.allowDrop($.node,z.node,"inner"),U=e.allowDrop($.node,z.node,"next")),k.dataTransfer.dropEffect=G||F||U?"move":"none",(F||G||U)&&(N==null?void 0:N.node.id)!==z.node.id&&(N&&t.emit("node-drag-leave",$.node,N.node,k),t.emit("node-drag-enter",$.node,z.node,k)),F||G||U?_.value.dropNode=z:_.value.dropNode=null,z.node.nextSibling===$.node&&(U=!1),z.node.previousSibling===$.node&&(F=!1),z.node.contains($.node,!1)&&(G=!1),($.node===z.node||$.node.contains(z.node))&&(F=!1,G=!1,U=!1);const Z=z.$el.querySelector(`.${m.be("node","content")}`).getBoundingClientRect(),q=i.value.getBoundingClientRect();let X;const ie=F?G?.25:U?.45:1:-1,de=U?G?.75:F?.55:0:1;let le=-9999;const pe=k.clientY-Z.top;pe<Z.height*ie?X="before":pe>Z.height*de?X="after":G?X="inner":X="none";const ge=z.$el.querySelector(`.${m.be("node","expand-icon")}`).getBoundingClientRect(),he=a.value;X==="before"?le=ge.top-q.top:X==="after"&&(le=ge.bottom-q.top),he.style.top=`${le}px`,he.style.left=`${ge.right-q.left}px`,X==="inner"?Oa(z.$el,m.is("drop-inner")):_s(z.$el,m.is("drop-inner")),_.value.showDropIndicator=X==="before"||X==="after",_.value.allowDrop=_.value.showDropIndicator||te,_.value.dropType=X,t.emit("node-drag-over",$.node,z.node,k)},treeNodeDragEnd:k=>{const{draggingNode:A,dropType:z,dropNode:N}=_.value;if(k.preventDefault(),k.dataTransfer&&(k.dataTransfer.dropEffect="move"),A&&N){const $={data:A.node.data};z!=="none"&&A.node.remove(),z==="before"?N.node.parent.insertBefore($,N.node):z==="after"?N.node.parent.insertAfter($,N.node):z==="inner"&&N.node.insertChild($),z!=="none"&&(d.value.registerNode($),d.value.key&&A.node.eachNode(F=>{var G;(G=d.value.nodesMap[F.data[d.value.key]])==null||G.setChecked(F.checked,!d.value.checkStrictly)})),_s(N.$el,m.is("drop-inner")),t.emit("node-drag-end",A.node,N.node,z,k),z!=="none"&&t.emit("node-drop",A.node,N.node,z,k)}A&&!N&&t.emit("node-drag-end",A.node,null,z,k),_.value.showDropIndicator=!1,_.value.draggingNode=null,_.value.dropNode=null,_.value.allowDrop=!0}}),{dragState:_}}const Bce=Ge({name:"ElTreeNode",components:{ElCollapseTransition:n1,ElCheckbox:Ha,NodeContent:Oce,ElIcon:Dn,Loading:Kl},props:{node:{type:iT,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const i=Jt("tree"),{broadcastExpanded:a}=gB(e),d=kn("RootTree"),m=be(!1),_=be(!1),x=be(null),o=be(null),C=be(null),k=kn(vB),A=Cr();Br("NodeInstance",A),e.node.expanded&&(m.value=!0,_.value=!0);const z=d.props.props.children||"children";Wt(()=>{const pe=e.node.data[z];return pe&&[...pe]},()=>{e.node.updateChildren()}),Wt(()=>e.node.indeterminate,pe=>{F(e.node.checked,pe)}),Wt(()=>e.node.checked,pe=>{F(pe,e.node.indeterminate)}),Wt(()=>e.node.childNodes.length,()=>e.node.reInitChecked()),Wt(()=>e.node.expanded,pe=>{Vn(()=>m.value=pe),pe&&(_.value=!0)});const N=pe=>mE(d.props.nodeKey,pe.data),$=pe=>{const ge=e.props.class;if(!ge)return{};let he;if(Fn(ge)){const{data:ue}=pe;he=ge(ue,pe)}else he=ge;return zn(he)?{[he]:!0}:he},F=(pe,ge)=>{(x.value!==pe||o.value!==ge)&&d.ctx.emit("check-change",e.node.data,pe,ge),x.value=pe,o.value=ge},G=pe=>{rT(d.store,d.ctx.emit,()=>{var ge;if((ge=d==null?void 0:d.props)==null?void 0:ge.nodeKey){const ue=N(e.node);d.store.value.setCurrentNodeKey(ue)}else d.store.value.setCurrentNode(e.node)}),d.currentNode.value=e.node,d.props.expandOnClickNode&&te(),d.props.checkOnClickNode&&!e.node.disabled&&Z(null,{target:{checked:!e.node.checked}}),d.ctx.emit("node-click",e.node.data,e.node,A,pe)},U=pe=>{d.instance.vnode.props.onNodeContextmenu&&(pe.stopPropagation(),pe.preventDefault()),d.ctx.emit("node-contextmenu",pe,e.node.data,e.node,A)},te=()=>{e.node.isLeaf||(m.value?(d.ctx.emit("node-collapse",e.node.data,e.node,A),e.node.collapse()):e.node.expand(()=>{t.emit("node-expand",e.node.data,e.node,A)}))},Z=(pe,ge)=>{e.node.setChecked(ge.target.checked,!d.props.checkStrictly),Vn(()=>{const he=d.store.value;d.ctx.emit("check",e.node.data,{checkedNodes:he.getCheckedNodes(),checkedKeys:he.getCheckedKeys(),halfCheckedNodes:he.getHalfCheckedNodes(),halfCheckedKeys:he.getHalfCheckedKeys()})})};return{ns:i,node$:C,tree:d,expanded:m,childNodeRendered:_,oldChecked:x,oldIndeterminate:o,getNodeKey:N,getNodeClass:$,handleSelectChange:F,handleClick:G,handleContextMenu:U,handleExpandIconClick:te,handleCheckChange:Z,handleChildNodeExpand:(pe,ge,he)=>{a(ge),d.ctx.emit("node-expand",pe,ge,he)},handleDragStart:pe=>{d.props.draggable&&k.treeNodeDragStart({event:pe,treeNode:e})},handleDragOver:pe=>{pe.preventDefault(),d.props.draggable&&k.treeNodeDragOver({event:pe,treeNode:{$el:C.value,node:e.node}})},handleDrop:pe=>{pe.preventDefault()},handleDragEnd:pe=>{d.props.draggable&&k.treeNodeDragEnd(pe)},CaretRight:zO}}});function Fce(e,t,i,a,d,m){const _=Er("el-icon"),x=Er("el-checkbox"),o=Er("loading"),C=Er("node-content"),k=Er("el-tree-node"),A=Er("el-collapse-transition");return mr((se(),Ae("div",{ref:"node$",class:ce([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:Yn(e.handleClick,["stop"]),onContextmenu:e.handleContextMenu,onDragstart:Yn(e.handleDragStart,["stop"]),onDragover:Yn(e.handleDragOver,["stop"]),onDragend:Yn(e.handleDragEnd,["stop"]),onDrop:Yn(e.handleDrop,["stop"])},[Ve("div",{class:ce(e.ns.be("node","content")),style:Nn({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(se(),It(_,{key:0,class:ce([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:Yn(e.handleExpandIconClick,["stop"])},{default:st(()=>[(se(),It(Ir(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):bt("v-if",!0),e.showCheckbox?(se(),It(x,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:Yn(()=>{},["stop"]),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onClick","onChange"])):bt("v-if",!0),e.node.loading?(se(),It(_,{key:2,class:ce([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:st(()=>[qe(o)]),_:1},8,["class"])):bt("v-if",!0),qe(C,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),qe(A,null,{default:st(()=>[!e.renderAfterExpand||e.childNodeRendered?mr((se(),Ae("div",{key:0,class:ce(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(se(!0),Ae(Bn,null,Fr(e.node.childNodes,z=>(se(),It(k,{key:e.getNodeKey(z),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:z,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,["aria-expanded"])),[[no,e.expanded]]):bt("v-if",!0)]),_:1})],42,["aria-expanded","aria-disabled","aria-checked","draggable","data-key","onClick","onContextmenu","onDragstart","onDragover","onDragend","onDrop"])),[[no,e.node.visible]])}var Nce=hn(Bce,[["render",Fce],["__file","tree-node.vue"]]);function $ce({el$:e},t){const i=Jt("tree"),a=Uo([]),d=Uo([]);vr(()=>{_()}),Jl(()=>{a.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),d.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),Wt(d,x=>{x.forEach(o=>{o.setAttribute("tabindex","-1")})}),yo(e,"keydown",x=>{const o=x.target;if(!o.className.includes(i.b("node")))return;const C=x.code;a.value=Array.from(e.value.querySelectorAll(`.${i.is("focusable")}[role=treeitem]`));const k=a.value.indexOf(o);let A;if([En.up,En.down].includes(C)){if(x.preventDefault(),C===En.up){A=k===-1?0:k!==0?k-1:a.value.length-1;const N=A;for(;!t.value.getNode(a.value[A].dataset.key).canFocus;){if(A--,A===N){A=-1;break}A<0&&(A=a.value.length-1)}}else{A=k===-1?0:k<a.value.length-1?k+1:0;const N=A;for(;!t.value.getNode(a.value[A].dataset.key).canFocus;){if(A++,A===N){A=-1;break}A>=a.value.length&&(A=0)}}A!==-1&&a.value[A].focus()}[En.left,En.right].includes(C)&&(x.preventDefault(),o.click());const z=o.querySelector('[type="checkbox"]');[En.enter,En.numpadEnter,En.space].includes(C)&&z&&(x.preventDefault(),z.click())});const _=()=>{var x;a.value=Array.from(e.value.querySelectorAll(`.${i.is("focusable")}[role=treeitem]`)),d.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const o=e.value.querySelectorAll(`.${i.is("checked")}[role=treeitem]`);if(o.length){o[0].setAttribute("tabindex","0");return}(x=a.value[0])==null||x.setAttribute("tabindex","0")}}const Vce=Ge({name:"ElTree",components:{ElTreeNode:Nce},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:wo}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:i}=Gr(),a=Jt("tree"),d=kn(rm,null),m=be(new Dce({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));m.value.initialize();const _=be(m.value.root),x=be(null),o=be(null),C=be(null),{broadcastExpanded:k}=gB(e),{dragState:A}=zce({props:e,ctx:t,el$:o,dropIndicator$:C,store:m});$ce({el$:o},m);const z=Q(()=>{const{childNodes:Se}=_.value,ye=d?d.hasFilteredOptions!==0:!1;return(!Se||Se.length===0||Se.every(({visible:Ce})=>!Ce))&&!ye});Wt(()=>e.currentNodeKey,Se=>{m.value.setCurrentNodeKey(Se)}),Wt(()=>e.defaultCheckedKeys,Se=>{m.value.setDefaultCheckedKey(Se)}),Wt(()=>e.defaultExpandedKeys,Se=>{m.value.setDefaultExpandedKeys(Se)}),Wt(()=>e.data,Se=>{m.value.setData(Se)},{deep:!0}),Wt(()=>e.checkStrictly,Se=>{m.value.checkStrictly=Se});const N=Se=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");m.value.filter(Se)},$=Se=>mE(e.nodeKey,Se.data),F=Se=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const ye=m.value.getNode(Se);if(!ye)return[];const Ce=[ye.data];let Fe=ye.parent;for(;Fe&&Fe!==_.value;)Ce.push(Fe.data),Fe=Fe.parent;return Ce.reverse()},G=(Se,ye)=>m.value.getCheckedNodes(Se,ye),U=Se=>m.value.getCheckedKeys(Se),te=()=>{const Se=m.value.getCurrentNode();return Se?Se.data:null},Z=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const Se=te();return Se?Se[e.nodeKey]:null},q=(Se,ye)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");m.value.setCheckedNodes(Se,ye)},X=(Se,ye)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");m.value.setCheckedKeys(Se,ye)},ie=(Se,ye,Ce)=>{m.value.setChecked(Se,ye,Ce)},de=()=>m.value.getHalfCheckedNodes(),le=()=>m.value.getHalfCheckedKeys(),pe=(Se,ye=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");rT(m,t.emit,()=>{k(Se),m.value.setUserCurrentNode(Se,ye)})},ge=(Se,ye=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");rT(m,t.emit,()=>{k(),m.value.setCurrentNodeKey(Se,ye)})},he=Se=>m.value.getNode(Se),ue=Se=>{m.value.remove(Se)},Re=(Se,ye)=>{m.value.append(Se,ye)},Ye=(Se,ye)=>{m.value.insertBefore(Se,ye)},Ie=(Se,ye)=>{m.value.insertAfter(Se,ye)},fe=(Se,ye,Ce)=>{k(ye),t.emit("node-expand",Se,ye,Ce)},Me=(Se,ye)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");m.value.updateChildren(Se,ye)};return Br("RootTree",{ctx:t,props:e,store:m,root:_,currentNode:x,instance:Cr()}),Br(Xl,void 0),{ns:a,store:m,root:_,currentNode:x,dragState:A,el$:o,dropIndicator$:C,isEmpty:z,filter:N,getNodeKey:$,getNodePath:F,getCheckedNodes:G,getCheckedKeys:U,getCurrentNode:te,getCurrentKey:Z,setCheckedNodes:q,setCheckedKeys:X,setChecked:ie,getHalfCheckedNodes:de,getHalfCheckedKeys:le,setCurrentNode:pe,setCurrentKey:ge,t:i,getNode:he,remove:ue,append:Re,insertBefore:Ye,insertAfter:Ie,handleNodeExpand:fe,updateKeyChildren:Me}}});function Uce(e,t,i,a,d,m){const _=Er("el-tree-node");return se(),Ae("div",{ref:"el$",class:ce([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(se(!0),Ae(Bn,null,Fr(e.root.childNodes,x=>(se(),It(_,{key:e.getNodeKey(x),node:x,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(se(),Ae("div",{key:0,class:ce(e.ns.e("empty-block"))},[_t(e.$slots,"empty",{},()=>{var x;return[Ve("span",{class:ce(e.ns.e("empty-text"))},fn((x=e.emptyText)!=null?x:e.t("el.tree.emptyText")),3)]})],2)):bt("v-if",!0),mr(Ve("div",{ref:"dropIndicator$",class:ce(e.ns.e("drop-indicator"))},null,2),[[no,e.dragState.showDropIndicator]])],2)}var jce=hn(Vce,[["render",Uce],["__file","tree.vue"]]);const xb=cr(jce),Hce=(e,{attrs:t,emit:i},{select:a,tree:d,key:m})=>{const _=Jt("tree-select");return Wt(()=>e.data,()=>{e.filterable&&Vn(()=>{var o,C;(C=d.value)==null||C.filter((o=a.value)==null?void 0:o.states.inputValue)})},{flush:"post"}),{...dl(Bi(e),Object.keys(Ph.props)),...t,"onUpdate:modelValue":o=>i(xr,o),valueKey:m,popperClass:Q(()=>{const o=[_.e("popper")];return e.popperClass&&o.push(e.popperClass),o.join(" ")}),filterMethod:(o="")=>{var C;e.filterMethod?e.filterMethod(o):e.remoteMethod?e.remoteMethod(o):(C=d.value)==null||C.filter(o)}}},Gce=Ge({extends:hb,setup(e,t){const i=hb.setup(e,t);delete i.selectOptionClick;const a=Cr().proxy;return Vn(()=>{i.select.states.cachedOptions.get(a.value)||i.select.onOptionCreate(a)}),Wt(()=>t.attrs.visible,d=>{i.states.visible=d},{immediate:!0}),i},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function sT(e){return e||e===0}function gE(e){return on(e)&&e.length}function sp(e){return on(e)?e:sT(e)?[e]:[]}function U0(e,t,i,a,d){for(let m=0;m<e.length;m++){const _=e[m];if(t(_,m,e,d))return a?a(_,m,e,d):_;{const x=i(_);if(gE(x)){const o=U0(x,t,i,a,_);if(o)return o}}}}function j0(e,t,i,a){for(let d=0;d<e.length;d++){const m=e[d];t(m,d,e,a);const _=i(m);gE(_)&&j0(_,t,i,m)}}const Wce=(e,{attrs:t,slots:i,emit:a},{select:d,tree:m,key:_})=>{Wt(()=>e.modelValue,()=>{e.showCheckbox&&Vn(()=>{const z=m.value;z&&!Gi(z.getCheckedKeys(),sp(e.modelValue))&&z.setCheckedKeys(sp(e.modelValue))})},{immediate:!0,deep:!0});const x=Q(()=>({value:_.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),o=(z,N)=>{var $;const F=x.value[z];return Fn(F)?F(N,($=m.value)==null?void 0:$.getNode(o("value",N))):N[F]},C=sp(e.modelValue).map(z=>U0(e.data||[],N=>o("value",N)===z,N=>o("children",N),(N,$,F,G)=>G&&o("value",G))).filter(z=>sT(z)),k=Q(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const z=[];return j0(e.data.concat(e.cacheData),N=>{const $=o("value",N);z.push({value:$,currentLabel:o("label",N),isDisabled:o("disabled",N)})},N=>o("children",N)),z}),A=()=>{var z;return(z=m.value)==null?void 0:z.getCheckedKeys().filter(N=>{var $;const F=($=m.value)==null?void 0:$.getNode(N);return!ki(F)&&da(F.childNodes)})};return{...dl(Bi(e),Object.keys(xb.props)),...t,nodeKey:_,expandOnClickNode:Q(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:Q(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(C):C),renderContent:(z,{node:N,data:$,store:F})=>z(Gce,{value:o("value",$),label:o("label",$),disabled:o("disabled",$),visible:N.visible},e.renderContent?()=>e.renderContent(z,{node:N,data:$,store:F}):i.default?()=>i.default({node:N,data:$,store:F}):void 0),filterNodeMethod:(z,N,$)=>e.filterNodeMethod?e.filterNodeMethod(z,N,$):z?new RegExp(QT(z),"i").test(o("label",N)||""):!0,onNodeClick:(z,N,$)=>{var F,G,U,te;if((F=t.onNodeClick)==null||F.call(t,z,N,$),!(e.showCheckbox&&e.checkOnClickNode)){if(!e.showCheckbox&&(e.checkStrictly||N.isLeaf)){if(!o("disabled",z)){const Z=(G=d.value)==null?void 0:G.states.options.get(o("value",z));(U=d.value)==null||U.handleOptionSelect(Z)}}else e.expandOnClickNode&&$.proxy.handleExpandIconClick();(te=d.value)==null||te.focus()}},onCheck:(z,N)=>{var $;if(!e.showCheckbox)return;const F=o("value",z),G={};j0([m.value.store.root],q=>G[q.key]=q,q=>q.childNodes);const U=N.checkedKeys,te=e.multiple?sp(e.modelValue).filter(q=>!(q in G)&&!U.includes(q)):[],Z=te.concat(U);if(e.checkStrictly)a(xr,e.multiple?Z:Z.includes(F)?F:void 0);else if(e.multiple){const q=A();a(xr,te.concat(q))}else{const q=U0([z],de=>!gE(o("children",de))&&!o("disabled",de),de=>o("children",de)),X=q?o("value",q):void 0,ie=sT(e.modelValue)&&!!U0([z],de=>o("value",de)===e.modelValue,de=>o("children",de));a(xr,X===e.modelValue||ie?void 0:X)}Vn(()=>{var q;const X=sp(e.modelValue);m.value.setCheckedKeys(X),(q=t.onCheck)==null||q.call(t,z,{checkedKeys:m.value.getCheckedKeys(),checkedNodes:m.value.getCheckedNodes(),halfCheckedKeys:m.value.getHalfCheckedKeys(),halfCheckedNodes:m.value.getHalfCheckedNodes()})}),($=d.value)==null||$.focus()},onNodeExpand:(z,N,$)=>{var F;(F=t.onNodeExpand)==null||F.call(t,z,N,$),Vn(()=>{if(!e.checkStrictly&&e.lazy&&e.multiple&&N.checked){const G={},U=m.value.getCheckedKeys();j0([m.value.store.root],q=>G[q.key]=q,q=>q.childNodes);const te=sp(e.modelValue).filter(q=>!(q in G)&&!U.includes(q)),Z=A();a(xr,te.concat(Z))}})},cacheOptions:k}};var qce=Ge({props:{data:{type:Array,default:()=>[]}},setup(e){const t=kn(rm);return Wt(()=>e.data,()=>{var i;e.data.forEach(d=>{t.states.cachedOptions.has(d.value)||t.states.cachedOptions.set(d.value,d)});const a=((i=t.selectRef)==null?void 0:i.querySelectorAll("input"))||[];Hr&&!Array.from(a).includes(document.activeElement)&&t.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const Kce=Ge({name:"ElTreeSelect",inheritAttrs:!1,props:{...Ph.props,...xb.props,cacheData:{type:Array,default:()=>[]}},setup(e,t){const{slots:i,expose:a}=t,d=be(),m=be(),_=Q(()=>e.nodeKey||e.valueKey||"value"),x=Hce(e,t,{select:d,tree:m,key:_}),{cacheOptions:o,...C}=Wce(e,t,{select:d,tree:m,key:_}),k=ao({});return a(k),vr(()=>{Object.assign(k,{...dl(m.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...dl(d.value,["focus","blur"])})}),()=>Kn(Ph,ao({...x,ref:A=>d.value=A}),{...i,default:()=>[Kn(qce,{data:o.value}),Kn(xb,ao({...C,ref:A=>m.value=A}))]})}});var Zce=hn(Kce,[["__file","tree-select.vue"]]);const Yce=cr(Zce),vE=Symbol(),Xce={key:-1,level:-1,data:{}};var nv=(e=>(e.KEY="id",e.LABEL="label",e.CHILDREN="children",e.DISABLED="disabled",e))(nv||{}),aT=(e=>(e.ADD="add",e.DELETE="delete",e))(aT||{});const _B={type:Number,default:26},Jce=ln({data:{type:at(Array),default:()=>Xo([])},emptyText:{type:String},height:{type:Number,default:200},props:{type:at(Object),default:()=>Xo({children:"children",label:"label",disabled:"disabled",value:"id"})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:at(Array),default:()=>Xo([])},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:at(Array),default:()=>Xo([])},indent:{type:Number,default:16},itemSize:_B,icon:{type:wo},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},currentNodeKey:{type:at([String,Number])},accordion:{type:Boolean,default:!1},filterMethod:{type:at(Function)},perfMode:{type:Boolean,default:!0}}),Qce=ln({node:{type:at(Object),default:()=>Xo(Xce)},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1},itemSize:_B}),eue=ln({node:{type:at(Object),required:!0}}),yB="node-click",bB="node-drop",xB="node-expand",wB="node-collapse",SB="current-change",TB="check",CB="check-change",EB="node-contextmenu",tue={[yB]:(e,t,i)=>e&&t&&i,[bB]:(e,t,i)=>e&&t&&i,[xB]:(e,t)=>e&&t,[wB]:(e,t)=>e&&t,[SB]:(e,t)=>e&&t,[TB]:(e,t)=>e&&t,[CB]:(e,t)=>e&&ko(t),[EB]:(e,t,i)=>e&&t&&i},nue={click:(e,t)=>!!(e&&t),drop:(e,t)=>!!(e&&t),toggle:e=>!!e,check:(e,t)=>e&&ko(t)};function rue(e,t){const i=be(new Set),a=be(new Set),{emit:d}=Cr();Wt([()=>t.value,()=>e.defaultCheckedKeys],()=>Vn(()=>{te(e.defaultCheckedKeys)}),{immediate:!0});const m=()=>{if(!t.value||!e.showCheckbox||e.checkStrictly)return;const{levelTreeNodeMap:Z,maxLevel:q}=t.value,X=i.value,ie=new Set;for(let de=q-1;de>=1;--de){const le=Z.get(de);le&&le.forEach(pe=>{const ge=pe.children;if(ge){let he=!0,ue=!1;for(const Re of ge){const Ye=Re.key;if(X.has(Ye))ue=!0;else if(ie.has(Ye)){he=!1,ue=!0;break}else he=!1}he?X.add(pe.key):ue?(ie.add(pe.key),X.delete(pe.key)):(X.delete(pe.key),ie.delete(pe.key))}})}a.value=ie},_=Z=>i.value.has(Z.key),x=Z=>a.value.has(Z.key),o=(Z,q,X=!0)=>{const ie=i.value,de=(le,pe)=>{ie[pe?aT.ADD:aT.DELETE](le.key);const ge=le.children;!e.checkStrictly&&ge&&ge.forEach(he=>{he.disabled||de(he,pe)})};de(Z,q),m(),X&&C(Z,q)},C=(Z,q)=>{const{checkedNodes:X,checkedKeys:ie}=$(),{halfCheckedNodes:de,halfCheckedKeys:le}=F();d(TB,Z.data,{checkedKeys:ie,checkedNodes:X,halfCheckedKeys:le,halfCheckedNodes:de}),d(CB,Z.data,q)};function k(Z=!1){return $(Z).checkedKeys}function A(Z=!1){return $(Z).checkedNodes}function z(){return F().halfCheckedKeys}function N(){return F().halfCheckedNodes}function $(Z=!1){const q=[],X=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:ie}=t.value;i.value.forEach(de=>{const le=ie.get(de);le&&(!Z||Z&&le.isLeaf)&&(X.push(de),q.push(le.data))})}return{checkedKeys:X,checkedNodes:q}}function F(){const Z=[],q=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:X}=t.value;a.value.forEach(ie=>{const de=X.get(ie);de&&(q.push(ie),Z.push(de.data))})}return{halfCheckedNodes:Z,halfCheckedKeys:q}}function G(Z){i.value.clear(),a.value.clear(),Vn(()=>{te(Z)})}function U(Z,q){if(t!=null&&t.value&&e.showCheckbox){const X=t.value.treeNodeMap.get(Z);X&&o(X,q,!1)}}function te(Z){if(t!=null&&t.value){const{treeNodeMap:q}=t.value;if(e.showCheckbox&&q&&Z)for(const X of Z){const ie=q.get(X);ie&&!_(ie)&&o(ie,!0,!1)}}}return{updateCheckedKeys:m,toggleCheckbox:o,isChecked:_,isIndeterminate:x,getCheckedKeys:k,getCheckedNodes:A,getHalfCheckedKeys:z,getHalfCheckedNodes:N,setChecked:U,setCheckedKeys:G}}function oue(e,t){const i=be(new Set([])),a=be(new Set([])),d=Q(()=>Fn(e.filterMethod));function m(x){var o;if(!d.value)return;const C=new Set,k=a.value,A=i.value,z=[],N=((o=t.value)==null?void 0:o.treeNodes)||[],$=e.filterMethod;A.clear();function F(G){G.forEach(U=>{z.push(U),$!=null&&$(x,U.data)?z.forEach(Z=>{C.add(Z.key)}):U.isLeaf&&A.add(U.key);const te=U.children;if(te&&F(te),!U.isLeaf){if(!C.has(U.key))A.add(U.key);else if(te){let Z=!0;for(const q of te)if(!A.has(q.key)){Z=!1;break}Z?k.add(U.key):k.delete(U.key)}}z.pop()})}return F(N),C}function _(x){return a.value.has(x.key)}return{hiddenExpandIconKeySet:a,hiddenNodeKeySet:i,doFilter:m,isForceHiddenExpandIcon:_}}function iue(e,t){const i=be(new Set(e.defaultExpandedKeys)),a=be(),d=Uo(),m=be();Wt(()=>e.currentNodeKey,At=>{a.value=At},{immediate:!0}),Wt(()=>e.data,At=>{jt(At)},{immediate:!0});const{isIndeterminate:_,isChecked:x,toggleCheckbox:o,getCheckedKeys:C,getCheckedNodes:k,getHalfCheckedKeys:A,getHalfCheckedNodes:z,setChecked:N,setCheckedKeys:$}=rue(e,d),{doFilter:F,hiddenNodeKeySet:G,isForceHiddenExpandIcon:U}=oue(e,d),te=Q(()=>{var At;return((At=e.props)==null?void 0:At.value)||nv.KEY}),Z=Q(()=>{var At;return((At=e.props)==null?void 0:At.children)||nv.CHILDREN}),q=Q(()=>{var At;return((At=e.props)==null?void 0:At.disabled)||nv.DISABLED}),X=Q(()=>{var At;return((At=e.props)==null?void 0:At.label)||nv.LABEL}),ie=Q(()=>{var At;const He=i.value,pt=G.value,et=[],rn=((At=d.value)==null?void 0:At.treeNodes)||[],kt=[];for(let zt=rn.length-1;zt>=0;--zt)kt.push(rn[zt]);for(;kt.length;){const zt=kt.pop();if(!pt.has(zt.key)&&(et.push(zt),zt.children&&He.has(zt.key)))for(let Mt=zt.children.length-1;Mt>=0;--Mt)kt.push(zt.children[Mt])}return et}),de=Q(()=>ie.value.length>0);function le(At){const He=new Map,pt=new Map;let et=1;function rn(zt,Mt=1,en=void 0){var sn;const dn=[];for(const Pn of zt){const Ot=he(Pn),Zt={level:Mt,key:Ot,data:Pn};Zt.label=Re(Pn),Zt.parent=en;const jn=ge(Pn);Zt.disabled=ue(Pn),Zt.isLeaf=!jn||jn.length===0,jn&&jn.length&&(Zt.children=rn(jn,Mt+1,Zt)),dn.push(Zt),He.set(Ot,Zt),pt.has(Mt)||pt.set(Mt,[]),(sn=pt.get(Mt))==null||sn.push(Zt)}return Mt>et&&(et=Mt),dn}const kt=rn(At);return{treeNodeMap:He,levelTreeNodeMap:pt,maxLevel:et,treeNodes:kt}}function pe(At){const He=F(At);He&&(i.value=He)}function ge(At){return At[Z.value]}function he(At){return At?At[te.value]:""}function ue(At){return At[q.value]}function Re(At){return At[X.value]}function Ye(At){i.value.has(At.key)?Fe(At):Ce(At)}function Ie(At){const He=new Set,pt=d.value.treeNodeMap;At.forEach(et=>{let rn=pt.get(et);for(;rn&&!He.has(rn.key);)He.add(rn.key),rn=rn.parent}),i.value=He}function fe(At,He){t(yB,At.data,At,He),Se(At),e.expandOnClickNode&&Ye(At),e.showCheckbox&&e.checkOnClickNode&&!At.disabled&&o(At,!x(At),!0)}function Me(At,He){t(bB,At.data,At,He)}function Se(At){ut(At)||(a.value=At.key,t(SB,At.data,At))}function ye(At,He){o(At,He)}function Ce(At){const He=i.value;if(d.value&&e.accordion){const{treeNodeMap:pt}=d.value;He.forEach(et=>{const rn=pt.get(et);At&&At.level===(rn==null?void 0:rn.level)&&He.delete(et)})}He.add(At.key),t(xB,At.data,At)}function Fe(At){i.value.delete(At.key),t(wB,At.data,At)}function it(At){return i.value.has(At.key)}function We(At){return!!At.disabled}function ut(At){const He=a.value;return He!==void 0&&He===At.key}function Lt(){var At,He;if(a.value)return(He=(At=d.value)==null?void 0:At.treeNodeMap.get(a.value))==null?void 0:He.data}function Ft(){return a.value}function mt(At){a.value=At}function jt(At){Vn(()=>d.value=le(At))}function Ht(At){var He;const pt=Tr(At)?he(At):At;return(He=d.value)==null?void 0:He.treeNodeMap.get(pt)}function Tn(At,He="auto"){const pt=Ht(At);pt&&m.value&&m.value.scrollToItem(ie.value.indexOf(pt),He)}function Pe(At){var He;(He=m.value)==null||He.scrollTo(At)}return{tree:d,flattenTree:ie,isNotEmpty:de,listRef:m,getKey:he,getChildren:ge,toggleExpand:Ye,toggleCheckbox:o,isExpanded:it,isChecked:x,isIndeterminate:_,isDisabled:We,isCurrent:ut,isForceHiddenExpandIcon:U,handleNodeClick:fe,handleNodeDrop:Me,handleNodeCheck:ye,getCurrentNode:Lt,getCurrentKey:Ft,setCurrentKey:mt,getCheckedKeys:C,getCheckedNodes:k,getHalfCheckedKeys:A,getHalfCheckedNodes:z,setChecked:N,setCheckedKeys:$,filter:pe,setData:jt,getNode:Ht,expandNode:Ce,collapseNode:Fe,setExpandedKeys:Ie,scrollToNode:Tn,scrollTo:Pe}}var sue=Ge({name:"ElTreeNodeContent",props:eue,setup(e){const t=kn(vE),i=Jt("tree");return()=>{const a=e.node,{data:d}=a;return t!=null&&t.ctx.slots.default?t.ctx.slots.default({node:a,data:d}):Kn("span",{class:i.be("node","label")},[a==null?void 0:a.label])}}});const aue=Ge({name:"ElTreeNode"}),lue=Ge({...aue,props:Qce,emits:nue,setup(e,{emit:t}){const i=e,a=kn(vE),d=Jt("tree"),m=Q(()=>{var z;return(z=a==null?void 0:a.props.indent)!=null?z:16}),_=Q(()=>{var z;return(z=a==null?void 0:a.props.icon)!=null?z:zO}),x=z=>{t("click",i.node,z)},o=z=>{t("drop",i.node,z)},C=()=>{t("toggle",i.node)},k=z=>{t("check",i.node,z)},A=z=>{var N,$,F,G;(F=($=(N=a==null?void 0:a.instance)==null?void 0:N.vnode)==null?void 0:$.props)!=null&&F.onNodeContextmenu&&(z.stopPropagation(),z.preventDefault()),a==null||a.ctx.emit(EB,z,(G=i.node)==null?void 0:G.data,i.node)};return(z,N)=>{var $,F,G;return se(),Ae("div",{ref:"node$",class:ce([y(d).b("node"),y(d).is("expanded",z.expanded),y(d).is("current",z.current),y(d).is("focusable",!z.disabled),y(d).is("checked",!z.disabled&&z.checked)]),role:"treeitem",tabindex:"-1","aria-expanded":z.expanded,"aria-disabled":z.disabled,"aria-checked":z.checked,"data-key":($=z.node)==null?void 0:$.key,onClick:Yn(x,["stop"]),onContextmenu:A,onDragover:Yn(()=>{},["prevent"]),onDragenter:Yn(()=>{},["prevent"]),onDrop:Yn(o,["stop"])},[Ve("div",{class:ce(y(d).be("node","content")),style:Nn({paddingLeft:`${(z.node.level-1)*y(m)}px`,height:z.itemSize+"px"})},[y(_)?(se(),It(y(Dn),{key:0,class:ce([y(d).is("leaf",!!((F=z.node)!=null&&F.isLeaf)),y(d).is("hidden",z.hiddenExpandIcon),{expanded:!((G=z.node)!=null&&G.isLeaf)&&z.expanded},y(d).be("node","expand-icon")]),onClick:Yn(C,["stop"])},{default:st(()=>[(se(),It(Ir(y(_))))]),_:1},8,["class","onClick"])):bt("v-if",!0),z.showCheckbox?(se(),It(y(Ha),{key:1,"model-value":z.checked,indeterminate:z.indeterminate,disabled:z.disabled,onChange:k,onClick:Yn(()=>{},["stop"])},null,8,["model-value","indeterminate","disabled","onClick"])):bt("v-if",!0),qe(y(sue),{node:z.node},null,8,["node"])],6)],42,["aria-expanded","aria-disabled","aria-checked","data-key","onClick","onDragover","onDragenter","onDrop"])}}});var cue=hn(lue,[["__file","tree-node.vue"]]);const uue=Ge({name:"ElTreeV2"}),due=Ge({...uue,props:Jce,emits:tue,setup(e,{expose:t,emit:i}){const a=e,d=Ai(),m=Q(()=>a.itemSize);Br(vE,{ctx:{emit:i,slots:d},props:a,instance:Cr()}),Br(Xl,void 0);const{t:_}=Gr(),x=Jt("tree"),{flattenTree:o,isNotEmpty:C,listRef:k,toggleExpand:A,isExpanded:z,isIndeterminate:N,isChecked:$,isDisabled:F,isCurrent:G,isForceHiddenExpandIcon:U,handleNodeClick:te,handleNodeDrop:Z,handleNodeCheck:q,toggleCheckbox:X,getCurrentNode:ie,getCurrentKey:de,setCurrentKey:le,getCheckedKeys:pe,getCheckedNodes:ge,getHalfCheckedKeys:he,getHalfCheckedNodes:ue,setChecked:Re,setCheckedKeys:Ye,filter:Ie,setData:fe,getNode:Me,expandNode:Se,collapseNode:ye,setExpandedKeys:Ce,scrollToNode:Fe,scrollTo:it}=iue(a,i);return t({toggleCheckbox:X,getCurrentNode:ie,getCurrentKey:de,setCurrentKey:le,getCheckedKeys:pe,getCheckedNodes:ge,getHalfCheckedKeys:he,getHalfCheckedNodes:ue,setChecked:Re,setCheckedKeys:Ye,filter:Ie,setData:fe,getNode:Me,expandNode:Se,collapseNode:ye,setExpandedKeys:Ce,scrollToNode:Fe,scrollTo:it}),(We,ut)=>{var Lt;return se(),Ae("div",{class:ce([y(x).b(),{[y(x).m("highlight-current")]:We.highlightCurrent}]),role:"tree"},[y(C)?(se(),It(y(kz),{key:0,ref_key:"listRef",ref:k,"class-name":y(x).b("virtual-list"),data:y(o),total:y(o).length,height:We.height,"item-size":y(m),"perf-mode":We.perfMode},{default:st(({data:Ft,index:mt,style:jt})=>[(se(),It(cue,{key:Ft[mt].key,style:Nn(jt),node:Ft[mt],expanded:y(z)(Ft[mt]),"show-checkbox":We.showCheckbox,checked:y($)(Ft[mt]),indeterminate:y(N)(Ft[mt]),"item-size":y(m),disabled:y(F)(Ft[mt]),current:y(G)(Ft[mt]),"hidden-expand-icon":y(U)(Ft[mt]),onClick:y(te),onToggle:y(A),onCheck:y(q),onDrop:y(Z)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","item-size","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck","onDrop"]))]),_:1},8,["class-name","data","total","height","item-size","perf-mode"])):(se(),Ae("div",{key:1,class:ce(y(x).e("empty-block"))},[Ve("span",{class:ce(y(x).e("empty-text"))},fn((Lt=We.emptyText)!=null?Lt:y(_)("el.tree.emptyText")),3)],2))],2)}}});var hue=hn(due,[["__file","tree.vue"]]);const fue=cr(hue),MB=Symbol("uploadContextKey"),pue="ElUpload";class mue extends Error{constructor(t,i,a,d){super(t),this.name="UploadAjaxError",this.status=i,this.method=a,this.url=d}}function oD(e,t,i){let a;return i.response?a=`${i.response.error||i.response}`:i.responseText?a=`${i.responseText}`:a=`fail to ${t.method} ${e} ${i.status}`,new mue(a,i.status,t.method,e)}function gue(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}const vue=e=>{typeof XMLHttpRequest>"u"&&Ci(pue,"XMLHttpRequest is undefined");const t=new XMLHttpRequest,i=e.action;t.upload&&t.upload.addEventListener("progress",m=>{const _=m;_.percent=m.total>0?m.loaded/m.total*100:0,e.onProgress(_)});const a=new FormData;if(e.data)for(const[m,_]of Object.entries(e.data))on(_)&&_.length?a.append(m,..._):a.append(m,_);a.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(oD(i,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(oD(i,e,t));e.onSuccess(gue(t))}),t.open(e.method,i,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const d=e.headers||{};if(d instanceof Headers)d.forEach((m,_)=>t.setRequestHeader(_,m));else for(const[m,_]of Object.entries(d))ki(_)||t.setRequestHeader(m,String(_));return t.send(a),t},IB=["text","picture","picture-card"];let _ue=1;const lT=()=>Date.now()+_ue++,kB=ln({action:{type:String,default:"#"},headers:{type:at(Object)},method:{type:String,default:"post"},data:{type:at([Object,Function,Promise]),default:()=>Xo({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:at(Array),default:()=>Xo([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:IB,default:"text"},httpRequest:{type:at(Function),default:vue},disabled:Boolean,limit:Number}),yue=ln({...kB,beforeUpload:{type:at(Function),default:_o},beforeRemove:{type:at(Function)},onRemove:{type:at(Function),default:_o},onChange:{type:at(Function),default:_o},onPreview:{type:at(Function),default:_o},onSuccess:{type:at(Function),default:_o},onProgress:{type:at(Function),default:_o},onError:{type:at(Function),default:_o},onExceed:{type:at(Function),default:_o},crossorigin:{type:at(String)}}),bue=ln({files:{type:at(Array),default:()=>Xo([])},disabled:{type:Boolean,default:!1},handlePreview:{type:at(Function),default:_o},listType:{type:String,values:IB,default:"text"},crossorigin:{type:at(String)}}),xue={remove:e=>!!e},wue=Ge({name:"ElUploadList"}),Sue=Ge({...wue,props:bue,emits:xue,setup(e,{emit:t}){const i=e,{t:a}=Gr(),d=Jt("upload"),m=Jt("icon"),_=Jt("list"),x=ys(),o=be(!1),C=Q(()=>[d.b("list"),d.bm("list",i.listType),d.is("disabled",i.disabled)]),k=A=>{t("remove",A)};return(A,z)=>(se(),It(DL,{tag:"ul",class:ce(y(C)),name:y(_).b()},{default:st(()=>[(se(!0),Ae(Bn,null,Fr(A.files,(N,$)=>(se(),Ae("li",{key:N.uid||N.name,class:ce([y(d).be("list","item"),y(d).is(N.status),{focusing:o.value}]),tabindex:"0",onKeydown:Mo(F=>!y(x)&&k(N),["delete"]),onFocus:F=>o.value=!0,onBlur:F=>o.value=!1,onClick:F=>o.value=!1},[_t(A.$slots,"default",{file:N,index:$},()=>[A.listType==="picture"||N.status!=="uploading"&&A.listType==="picture-card"?(se(),Ae("img",{key:0,class:ce(y(d).be("list","item-thumbnail")),src:N.url,crossorigin:A.crossorigin,alt:""},null,10,["src","crossorigin"])):bt("v-if",!0),N.status==="uploading"||A.listType!=="picture-card"?(se(),Ae("div",{key:1,class:ce(y(d).be("list","item-info"))},[Ve("a",{class:ce(y(d).be("list","item-name")),onClick:Yn(F=>A.handlePreview(N),["prevent"])},[qe(y(Dn),{class:ce(y(m).m("document"))},{default:st(()=>[qe(y(PG))]),_:1},8,["class"]),Ve("span",{class:ce(y(d).be("list","item-file-name")),title:N.name},fn(N.name),11,["title"])],10,["onClick"]),N.status==="uploading"?(se(),It(y(bz),{key:0,type:A.listType==="picture-card"?"circle":"line","stroke-width":A.listType==="picture-card"?6:2,percentage:Number(N.percentage),style:Nn(A.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):bt("v-if",!0)],2)):bt("v-if",!0),Ve("label",{class:ce(y(d).be("list","item-status-label"))},[A.listType==="text"?(se(),It(y(Dn),{key:0,class:ce([y(m).m("upload-success"),y(m).m("circle-check")])},{default:st(()=>[qe(y(rC))]),_:1},8,["class"])):["picture-card","picture"].includes(A.listType)?(se(),It(y(Dn),{key:1,class:ce([y(m).m("upload-success"),y(m).m("check")])},{default:st(()=>[qe(y(n_))]),_:1},8,["class"])):bt("v-if",!0)],2),y(x)?bt("v-if",!0):(se(),It(y(Dn),{key:2,class:ce(y(m).m("close")),onClick:F=>k(N)},{default:st(()=>[qe(y(vl))]),_:2},1032,["class","onClick"])),bt(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),bt(" This is a bug which needs to be fixed "),bt(" TODO: Fix the incorrect navigation interaction "),y(x)?bt("v-if",!0):(se(),Ae("i",{key:3,class:ce(y(m).m("close-tip"))},fn(y(a)("el.upload.deleteTip")),3)),A.listType==="picture-card"?(se(),Ae("span",{key:4,class:ce(y(d).be("list","item-actions"))},[Ve("span",{class:ce(y(d).be("list","item-preview")),onClick:F=>A.handlePreview(N)},[qe(y(Dn),{class:ce(y(m).m("zoom-in"))},{default:st(()=>[qe(y($O))]),_:1},8,["class"])],10,["onClick"]),y(x)?bt("v-if",!0):(se(),Ae("span",{key:0,class:ce(y(d).be("list","item-delete")),onClick:F=>k(N)},[qe(y(Dn),{class:ce(y(m).m("delete"))},{default:st(()=>[qe(y(kG))]),_:1},8,["class"])],10,["onClick"]))],2)):bt("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),_t(A.$slots,"append")]),_:3},8,["class","name"]))}});var iD=hn(Sue,[["__file","upload-list.vue"]]);const Tue=ln({disabled:{type:Boolean,default:!1}}),Cue={file:e=>on(e)},AB="ElUploadDrag",Eue=Ge({name:AB}),Mue=Ge({...Eue,props:Tue,emits:Cue,setup(e,{emit:t}){kn(MB)||Ci(AB,"usage: <el-upload><el-upload-dragger /></el-upload>");const a=Jt("upload"),d=be(!1),m=ys(),_=o=>{if(m.value)return;d.value=!1,o.stopPropagation();const C=Array.from(o.dataTransfer.files);t("file",C)},x=()=>{m.value||(d.value=!0)};return(o,C)=>(se(),Ae("div",{class:ce([y(a).b("dragger"),y(a).is("dragover",d.value)]),onDrop:Yn(_,["prevent"]),onDragover:Yn(x,["prevent"]),onDragleave:Yn(k=>d.value=!1,["prevent"])},[_t(o.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var Iue=hn(Mue,[["__file","upload-dragger.vue"]]);const kue=ln({...kB,beforeUpload:{type:at(Function),default:_o},onRemove:{type:at(Function),default:_o},onStart:{type:at(Function),default:_o},onSuccess:{type:at(Function),default:_o},onProgress:{type:at(Function),default:_o},onError:{type:at(Function),default:_o},onExceed:{type:at(Function),default:_o}}),Aue=Ge({name:"ElUploadContent",inheritAttrs:!1}),Pue=Ge({...Aue,props:kue,setup(e,{expose:t}){const i=e,a=Jt("upload"),d=ys(),m=Uo({}),_=Uo(),x=F=>{if(F.length===0)return;const{autoUpload:G,limit:U,fileList:te,multiple:Z,onStart:q,onExceed:X}=i;if(U&&te.length+F.length>U){X(F,te);return}Z||(F=F.slice(0,1));for(const ie of F){const de=ie;de.uid=lT(),q(de),G&&o(de)}},o=async F=>{if(_.value.value="",!i.beforeUpload)return k(F);let G,U={};try{const Z=i.data,q=i.beforeUpload(F);U=_v(i.data)?rb(i.data):i.data,G=await q,_v(i.data)&&Gi(Z,U)&&(U=rb(i.data))}catch{G=!1}if(G===!1){i.onRemove(F);return}let te=F;G instanceof Blob&&(G instanceof File?te=G:te=new File([G],F.name,{type:F.type})),k(Object.assign(te,{uid:F.uid}),U)},C=async(F,G)=>Fn(F)?F(G):F,k=async(F,G)=>{const{headers:U,data:te,method:Z,withCredentials:q,name:X,action:ie,onProgress:de,onSuccess:le,onError:pe,httpRequest:ge}=i;try{G=await C(G??te,F)}catch{i.onRemove(F);return}const{uid:he}=F,ue={headers:U||{},withCredentials:q,file:F,data:G,method:Z,filename:X,action:ie,onProgress:Ye=>{de(Ye,F)},onSuccess:Ye=>{le(Ye,F),delete m.value[he]},onError:Ye=>{pe(Ye,F),delete m.value[he]}},Re=ge(ue);m.value[he]=Re,Re instanceof Promise&&Re.then(ue.onSuccess,ue.onError)},A=F=>{const G=F.target.files;G&&x(Array.from(G))},z=()=>{d.value||(_.value.value="",_.value.click())},N=()=>{z()};return t({abort:F=>{rG(m.value).filter(F?([U])=>String(F.uid)===U:()=>!0).forEach(([U,te])=>{te instanceof XMLHttpRequest&&te.abort(),delete m.value[U]})},upload:o}),(F,G)=>(se(),Ae("div",{class:ce([y(a).b(),y(a).m(F.listType),y(a).is("drag",F.drag),y(a).is("disabled",y(d))]),tabindex:y(d)?"-1":"0",onClick:z,onKeydown:Mo(Yn(N,["self"]),["enter","space"])},[F.drag?(se(),It(Iue,{key:0,disabled:y(d),onFile:x},{default:st(()=>[_t(F.$slots,"default")]),_:3},8,["disabled"])):_t(F.$slots,"default",{key:1}),Ve("input",{ref_key:"inputRef",ref:_,class:ce(y(a).e("input")),name:F.name,disabled:y(d),multiple:F.multiple,accept:F.accept,type:"file",onChange:A,onClick:Yn(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var sD=hn(Pue,[["__file","upload-content.vue"]]);const aD="ElUpload",lD=e=>{var t;(t=e.url)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(e.url)},Rue=(e,t)=>{const i=WL(e,"fileList",void 0,{passive:!0}),a=N=>i.value.find($=>$.uid===N.uid);function d(N){var $;($=t.value)==null||$.abort(N)}function m(N=["ready","uploading","success","fail"]){i.value=i.value.filter($=>!N.includes($.status))}function _(N){i.value=i.value.filter($=>$!==N)}const x=(N,$)=>{const F=a($);F&&(console.error(N),F.status="fail",_(F),e.onError(N,F,i.value),e.onChange(F,i.value))},o=(N,$)=>{const F=a($);F&&(e.onProgress(N,F,i.value),F.status="uploading",F.percentage=Math.round(N.percent))},C=(N,$)=>{const F=a($);F&&(F.status="success",F.response=N,e.onSuccess(N,F,i.value),e.onChange(F,i.value))},k=N=>{ki(N.uid)&&(N.uid=lT());const $={name:N.name,percentage:0,status:"ready",size:N.size,raw:N,uid:N.uid};if(e.listType==="picture-card"||e.listType==="picture")try{$.url=URL.createObjectURL(N)}catch(F){F.message,e.onError(F,$,i.value)}i.value=[...i.value,$],e.onChange($,i.value)},A=async N=>{const $=N instanceof File?a(N):N;$||Ci(aD,"file to be removed not found");const F=G=>{d(G),_(G),e.onRemove(G,i.value),lD(G)};e.beforeRemove?await e.beforeRemove($,i.value)!==!1&&F($):F($)};function z(){i.value.filter(({status:N})=>N==="ready").forEach(({raw:N})=>{var $;return N&&(($=t.value)==null?void 0:$.upload(N))})}return Wt(()=>e.listType,N=>{N!=="picture-card"&&N!=="picture"||(i.value=i.value.map($=>{const{raw:F,url:G}=$;if(!G&&F)try{$.url=URL.createObjectURL(F)}catch(U){e.onError(U,$,i.value)}return $}))}),Wt(i,N=>{for(const $ of N)$.uid||($.uid=lT()),$.status||($.status="success")},{immediate:!0,deep:!0}),{uploadFiles:i,abort:d,clearFiles:m,handleError:x,handleProgress:o,handleStart:k,handleSuccess:C,handleRemove:A,submit:z,revokeFileObjectURL:lD}},Due=Ge({name:"ElUpload"}),Lue=Ge({...Due,props:yue,setup(e,{expose:t}){const i=e,a=ys(),d=Uo(),{abort:m,submit:_,clearFiles:x,uploadFiles:o,handleStart:C,handleError:k,handleRemove:A,handleSuccess:z,handleProgress:N,revokeFileObjectURL:$}=Rue(i,d),F=Q(()=>i.listType==="picture-card"),G=Q(()=>({...i,fileList:o.value,onStart:C,onProgress:N,onSuccess:z,onError:k,onRemove:A}));return Io(()=>{o.value.forEach($)}),Br(MB,{accept:fo(i,"accept")}),t({abort:m,submit:_,clearFiles:x,handleStart:C,handleRemove:A}),(U,te)=>(se(),Ae("div",null,[y(F)&&U.showFileList?(se(),It(iD,{key:0,disabled:y(a),"list-type":U.listType,files:y(o),crossorigin:U.crossorigin,"handle-preview":U.onPreview,onRemove:y(A)},$a({append:st(()=>[qe(sD,kr({ref_key:"uploadRef",ref:d},y(G)),{default:st(()=>[U.$slots.trigger?_t(U.$slots,"trigger",{key:0}):bt("v-if",!0),!U.$slots.trigger&&U.$slots.default?_t(U.$slots,"default",{key:1}):bt("v-if",!0)]),_:3},16)]),_:2},[U.$slots.file?{name:"default",fn:st(({file:Z,index:q})=>[_t(U.$slots,"file",{file:Z,index:q})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):bt("v-if",!0),!y(F)||y(F)&&!U.showFileList?(se(),It(sD,kr({key:1,ref_key:"uploadRef",ref:d},y(G)),{default:st(()=>[U.$slots.trigger?_t(U.$slots,"trigger",{key:0}):bt("v-if",!0),!U.$slots.trigger&&U.$slots.default?_t(U.$slots,"default",{key:1}):bt("v-if",!0)]),_:3},16)):bt("v-if",!0),U.$slots.trigger?_t(U.$slots,"default",{key:2}):bt("v-if",!0),_t(U.$slots,"tip"),!y(F)&&U.showFileList?(se(),It(iD,{key:3,disabled:y(a),"list-type":U.listType,files:y(o),crossorigin:U.crossorigin,"handle-preview":U.onPreview,onRemove:y(A)},$a({_:2},[U.$slots.file?{name:"default",fn:st(({file:Z,index:q})=>[_t(U.$slots,"file",{file:Z,index:q})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):bt("v-if",!0)]))}});var Oue=hn(Lue,[["__file","upload.vue"]]);const zue=cr(Oue),Bue=ln({zIndex:{type:Number,default:9},rotate:{type:Number,default:-22},width:Number,height:Number,image:String,content:{type:at([String,Array]),default:"Element Plus"},font:{type:at(Object)},gap:{type:at(Array),default:()=>[100,100]},offset:{type:at(Array)}});function Fue(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function Nue(e){return Object.keys(e).map(t=>`${Fue(t)}: ${e[t]};`).join(" ")}function $ue(){return window.devicePixelRatio||1}const Vue=(e,t)=>{let i=!1;return e.removedNodes.length&&t&&(i=Array.from(e.removedNodes).includes(t)),e.type==="attributes"&&e.target===t&&(i=!0),i},PB=3;function Nw(e,t,i=1){const a=document.createElement("canvas"),d=a.getContext("2d"),m=e*i,_=t*i;return a.setAttribute("width",`${m}px`),a.setAttribute("height",`${_}px`),d.save(),[d,a,m,_]}function Uue(){function e(t,i,a,d,m,_,x,o){const[C,k,A,z]=Nw(d,m,a);if(t instanceof HTMLImageElement)C.drawImage(t,0,0,A,z);else{const{color:Fe,fontSize:it,fontStyle:We,fontWeight:ut,fontFamily:Lt,textAlign:Ft,textBaseline:mt}=_,jt=Number(it)*a;C.font=`${We} normal ${ut} ${jt}px/${m}px ${Lt}`,C.fillStyle=Fe,C.textAlign=Ft,C.textBaseline=mt;const Ht=on(t)?t:[t];Ht==null||Ht.forEach((Tn,Pe)=>{C.fillText(Tn??"",A/2,Pe*(jt+PB*a))})}const N=Math.PI/180*Number(i),$=Math.max(d,m),[F,G,U]=Nw($,$,a);F.translate(U/2,U/2),F.rotate(N),A>0&&z>0&&F.drawImage(k,-A/2,-z/2);function te(Fe,it){const We=Fe*Math.cos(N)-it*Math.sin(N),ut=Fe*Math.sin(N)+it*Math.cos(N);return[We,ut]}let Z=0,q=0,X=0,ie=0;const de=A/2,le=z/2;[[0-de,0-le],[0+de,0-le],[0+de,0+le],[0-de,0+le]].forEach(([Fe,it])=>{const[We,ut]=te(Fe,it);Z=Math.min(Z,We),q=Math.max(q,We),X=Math.min(X,ut),ie=Math.max(ie,ut)});const ge=Z+U/2,he=X+U/2,ue=q-Z,Re=ie-X,Ye=x*a,Ie=o*a,fe=(ue+Ye)*2,Me=Re+Ie,[Se,ye]=Nw(fe,Me);function Ce(Fe=0,it=0){Se.drawImage(G,ge,he,ue,Re,Fe,it,ue,Re)}return Ce(),Ce(ue+Ye,-Re/2-Ie/2),Ce(ue+Ye,+Re/2+Ie/2),[ye.toDataURL(),fe/a,Me/a]}return e}const jue=Ge({name:"ElWatermark"}),Hue=Ge({...jue,props:Bue,setup(e){const t=e,i={position:"relative"},a=Q(()=>{var ge,he;return(he=(ge=t.font)==null?void 0:ge.color)!=null?he:"rgba(0,0,0,.15)"}),d=Q(()=>{var ge,he;return(he=(ge=t.font)==null?void 0:ge.fontSize)!=null?he:16}),m=Q(()=>{var ge,he;return(he=(ge=t.font)==null?void 0:ge.fontWeight)!=null?he:"normal"}),_=Q(()=>{var ge,he;return(he=(ge=t.font)==null?void 0:ge.fontStyle)!=null?he:"normal"}),x=Q(()=>{var ge,he;return(he=(ge=t.font)==null?void 0:ge.fontFamily)!=null?he:"sans-serif"}),o=Q(()=>{var ge,he;return(he=(ge=t.font)==null?void 0:ge.textAlign)!=null?he:"center"}),C=Q(()=>{var ge,he;return(he=(ge=t.font)==null?void 0:ge.textBaseline)!=null?he:"hanging"}),k=Q(()=>t.gap[0]),A=Q(()=>t.gap[1]),z=Q(()=>k.value/2),N=Q(()=>A.value/2),$=Q(()=>{var ge,he;return(he=(ge=t.offset)==null?void 0:ge[0])!=null?he:z.value}),F=Q(()=>{var ge,he;return(he=(ge=t.offset)==null?void 0:ge[1])!=null?he:N.value}),G=()=>{const ge={zIndex:t.zIndex,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",backgroundRepeat:"repeat"};let he=$.value-z.value,ue=F.value-N.value;return he>0&&(ge.left=`${he}px`,ge.width=`calc(100% - ${he}px)`,he=0),ue>0&&(ge.top=`${ue}px`,ge.height=`calc(100% - ${ue}px)`,ue=0),ge.backgroundPosition=`${he}px ${ue}px`,ge},U=Uo(null),te=Uo(),Z=be(!1),q=()=>{te.value&&(te.value.remove(),te.value=void 0)},X=(ge,he)=>{var ue;U.value&&te.value&&(Z.value=!0,te.value.setAttribute("style",Nue({...G(),backgroundImage:`url('${ge}')`,backgroundSize:`${Math.floor(he)}px`})),(ue=U.value)==null||ue.append(te.value),setTimeout(()=>{Z.value=!1}))},ie=ge=>{let he=120,ue=64;const Re=t.image,Ye=t.content,Ie=t.width,fe=t.height;if(!Re&&ge.measureText){ge.font=`${Number(d.value)}px ${x.value}`;const Me=on(Ye)?Ye:[Ye],Se=Me.map(ye=>{const Ce=ge.measureText(ye);return[Ce.width,Ce.fontBoundingBoxAscent!==void 0?Ce.fontBoundingBoxAscent+Ce.fontBoundingBoxDescent:Ce.actualBoundingBoxAscent+Ce.actualBoundingBoxDescent]});he=Math.ceil(Math.max(...Se.map(ye=>ye[0]))),ue=Math.ceil(Math.max(...Se.map(ye=>ye[1])))*Me.length+(Me.length-1)*PB}return[Ie??he,fe??ue]},de=Uue(),le=()=>{const he=document.createElement("canvas").getContext("2d"),ue=t.image,Re=t.content,Ye=t.rotate;if(he){te.value||(te.value=document.createElement("div"));const Ie=$ue(),[fe,Me]=ie(he),Se=ye=>{const[Ce,Fe]=de(ye||"",Ye,Ie,fe,Me,{color:a.value,fontSize:d.value,fontStyle:_.value,fontWeight:m.value,fontFamily:x.value,textAlign:o.value,textBaseline:C.value},k.value,A.value);X(Ce,Fe)};if(ue){const ye=new Image;ye.onload=()=>{Se(ye)},ye.onerror=()=>{Se(Re)},ye.crossOrigin="anonymous",ye.referrerPolicy="no-referrer",ye.src=ue}else Se(Re)}};return vr(()=>{le()}),Wt(()=>t,()=>{le()},{deep:!0,flush:"post"}),Io(()=>{q()}),GL(U,ge=>{Z.value||ge.forEach(he=>{Vue(he,te.value)&&(q(),le())})},{attributes:!0,subtree:!0,childList:!0}),(ge,he)=>(se(),Ae("div",{ref_key:"containerRef",ref:U,style:Nn([i])},[_t(ge.$slots,"default")],4))}});var Gue=hn(Hue,[["__file","watermark.vue"]]);const Wue=cr(Gue),que=ln({zIndex:{type:Number,default:1001},visible:Boolean,fill:{type:String,default:"rgba(0,0,0,0.5)"},pos:{type:at(Object)},targetAreaClickable:{type:Boolean,default:!0}}),Kue=(e,t,i,a,d)=>{const m=be(null),_=()=>{let A;return zn(e.value)?A=document.querySelector(e.value):Fn(e.value)?A=e.value():A=e.value,A},x=()=>{const A=_();if(!A||!t.value){m.value=null;return}Zue(A)||A.scrollIntoView(d.value);const{left:z,top:N,width:$,height:F}=A.getBoundingClientRect();m.value={left:z,top:N,width:$,height:F,radius:0}};vr(()=>{Wt([t,e],()=>{x()},{immediate:!0}),window.addEventListener("resize",x)}),Io(()=>{window.removeEventListener("resize",x)});const o=A=>{var z;return(z=on(i.value.offset)?i.value.offset[A]:i.value.offset)!=null?z:6},C=Q(()=>{var A;if(!m.value)return m.value;const z=o(0),N=o(1),$=((A=i.value)==null?void 0:A.radius)||2;return{left:m.value.left-z,top:m.value.top-N,width:m.value.width+z*2,height:m.value.height+N*2,radius:$}}),k=Q(()=>{const A=_();return!a.value||!A||!window.DOMRect?A||void 0:{getBoundingClientRect(){var z,N,$,F;return window.DOMRect.fromRect({width:((z=C.value)==null?void 0:z.width)||0,height:((N=C.value)==null?void 0:N.height)||0,x:(($=C.value)==null?void 0:$.left)||0,y:((F=C.value)==null?void 0:F.top)||0})}}});return{mergedPosInfo:C,triggerTarget:k}},c1=Symbol("ElTour");function Zue(e){const t=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight,{top:a,right:d,bottom:m,left:_}=e.getBoundingClientRect();return a>=0&&_>=0&&d<=t&&m<=i}const Yue=(e,t,i,a,d,m,_,x)=>{const o=be(),C=be(),k=be({}),A={x:o,y:C,placement:a,strategy:d,middlewareData:k},z=Q(()=>{const U=[_4(y(m)),Mq(),Eq(),Xue()];return y(x)&&y(i)&&U.push(y4({element:y(i)})),U}),N=async()=>{if(!Hr)return;const U=y(e),te=y(t);if(!U||!te)return;const Z=await b4(U,te,{placement:y(a),strategy:y(d),middleware:y(z)});Pp(A).forEach(q=>{A[q].value=Z[q]})},$=Q(()=>{if(!y(e))return{position:"fixed",top:"50%",left:"50%",transform:"translate3d(-50%, -50%, 0)",maxWidth:"100vw",zIndex:y(_)};const{overflow:U}=y(k);return{position:y(d),zIndex:y(_),top:y(C)!=null?`${y(C)}px`:"",left:y(o)!=null?`${y(o)}px`:"",maxWidth:U!=null&&U.maxWidth?`${U==null?void 0:U.maxWidth}px`:""}}),F=Q(()=>{if(!y(x))return{};const{arrow:U}=y(k);return{left:(U==null?void 0:U.x)!=null?`${U==null?void 0:U.x}px`:"",top:(U==null?void 0:U.y)!=null?`${U==null?void 0:U.y}px`:""}});let G;return vr(()=>{const U=y(e),te=y(t);U&&te&&(G=Tq(U,te,N)),ns(()=>{N()})}),Io(()=>{G&&G()}),{update:N,contentStyle:$,arrowStyle:F}},Xue=()=>({name:"overflow",async fn(e){const t=await Cq(e);let i=0;return t.left>0&&(i=t.left),t.right>0&&(i=t.right),{data:{maxWidth:e.rects.floating.width-i}}}}),Jue=Ge({name:"ElTourMask",inheritAttrs:!1}),Que=Ge({...Jue,props:que,setup(e){const t=e,{ns:i}=kn(c1),a=Q(()=>{var x,o;return(o=(x=t.pos)==null?void 0:x.radius)!=null?o:2}),d=Q(()=>{const x=a.value,o=`a${x},${x} 0 0 1`;return{topRight:`${o} ${x},${x}`,bottomRight:`${o} ${-x},${x}`,bottomLeft:`${o} ${-x},${-x}`,topLeft:`${o} ${x},${-x}`}}),m=Q(()=>{const x=window.innerWidth,o=window.innerHeight,C=d.value,k=`M${x},0 L0,0 L0,${o} L${x},${o} L${x},0 Z`,A=a.value;return t.pos?`${k} M${t.pos.left+A},${t.pos.top} h${t.pos.width-A*2} ${C.topRight} v${t.pos.height-A*2} ${C.bottomRight} h${-t.pos.width+A*2} ${C.bottomLeft} v${-t.pos.height+A*2} ${C.topLeft} z`:k}),_=Q(()=>({fill:t.fill,pointerEvents:"auto",cursor:"auto"}));return uC(fo(t,"visible"),{ns:i}),(x,o)=>x.visible?(se(),Ae("div",kr({key:0,class:y(i).e("mask"),style:{position:"fixed",left:0,right:0,top:0,bottom:0,zIndex:x.zIndex,pointerEvents:x.pos&&x.targetAreaClickable?"none":"auto"}},x.$attrs),[(se(),Ae("svg",{style:{width:"100%",height:"100%"}},[Ve("path",{class:ce(y(i).e("hollow")),style:Nn(y(_)),d:y(m)},null,14,["d"])]))],16)):bt("v-if",!0)}});var ede=hn(Que,[["__file","mask.vue"]]);const tde=["absolute","fixed"],nde=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],_E=ln({placement:{type:at(String),values:nde,default:"bottom"},reference:{type:at(Object),default:null},strategy:{type:at(String),values:tde,default:"absolute"},offset:{type:Number,default:10},showArrow:Boolean,zIndex:{type:Number,default:2001}}),rde={close:()=>!0},ode=Ge({name:"ElTourContent"}),ide=Ge({...ode,props:_E,emits:rde,setup(e,{emit:t}){const i=e,a=be(i.placement),d=be(i.strategy),m=be(null),_=be(null);Wt(()=>i.placement,()=>{a.value=i.placement});const{contentStyle:x,arrowStyle:o}=Yue(fo(i,"reference"),m,_,a,d,fo(i,"offset"),fo(i,"zIndex"),fo(i,"showArrow")),C=Q(()=>a.value.split("-")[0]),{ns:k}=kn(c1),A=()=>{t("close")},z=N=>{N.detail.focusReason==="pointer"&&N.preventDefault()};return(N,$)=>(se(),Ae("div",{ref_key:"contentRef",ref:m,style:Nn(y(x)),class:ce(y(k).e("content")),"data-side":y(C),tabindex:"-1"},[qe(y(c_),{loop:"",trapped:"","focus-start-el":"container","focus-trap-el":m.value||void 0,onReleaseRequested:A,onFocusoutPrevented:z},{default:st(()=>[_t(N.$slots,"default")]),_:3},8,["focus-trap-el"]),N.showArrow?(se(),Ae("span",{key:0,ref_key:"arrowRef",ref:_,style:Nn(y(o)),class:ce(y(k).e("arrow"))},null,6)):bt("v-if",!0)],14,["data-side"]))}});var sde=hn(ide,[["__file","content.vue"]]),ade=Ge({name:"ElTourSteps",props:{current:{type:Number,default:0}},emits:["update-total"],setup(e,{slots:t,emit:i}){let a=0;return()=>{var d,m;const _=(d=t.default)==null?void 0:d.call(t),x=[];let o=0;function C(k){on(k)&&k.forEach(A=>{var z;((z=(A==null?void 0:A.type)||{})==null?void 0:z.name)==="ElTourStep"&&(x.push(A),o+=1)})}return _.length&&C(qu((m=_[0])==null?void 0:m.children)),a!==o&&(a=o,i("update-total",o)),x.length?x[e.current]:null}}});const lde=ln({modelValue:Boolean,current:{type:Number,default:0},showArrow:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeIcon:{type:wo},placement:_E.placement,contentStyle:{type:at([Object])},mask:{type:at([Boolean,Object]),default:!0},gap:{type:at(Object),default:()=>({offset:6,radius:2})},zIndex:{type:Number},scrollIntoViewOptions:{type:at([Boolean,Object]),default:()=>({block:"center"})},type:{type:at(String)},appendTo:{type:at([String,Object]),default:"body"},closeOnPressEscape:{type:Boolean,default:!0},targetAreaClickable:{type:Boolean,default:!0}}),cde={[xr]:e=>ko(e),"update:current":e=>Wn(e),close:e=>Wn(e),finish:()=>!0,change:e=>Wn(e)},ude=Ge({name:"ElTour"}),dde=Ge({...ude,props:lde,emits:cde,setup(e,{emit:t}){const i=e,a=Jt("tour"),d=be(0),m=be(),_=WL(i,"current",t,{passive:!0}),x=Q(()=>{var pe;return(pe=m.value)==null?void 0:pe.target}),o=Q(()=>[a.b(),G.value==="primary"?a.m("primary"):""]),C=Q(()=>{var pe;return((pe=m.value)==null?void 0:pe.placement)||i.placement}),k=Q(()=>{var pe,ge;return(ge=(pe=m.value)==null?void 0:pe.contentStyle)!=null?ge:i.contentStyle}),A=Q(()=>{var pe,ge;return(ge=(pe=m.value)==null?void 0:pe.mask)!=null?ge:i.mask}),z=Q(()=>!!A.value&&i.modelValue),N=Q(()=>ko(A.value)?void 0:A.value),$=Q(()=>{var pe,ge;return!!x.value&&((ge=(pe=m.value)==null?void 0:pe.showArrow)!=null?ge:i.showArrow)}),F=Q(()=>{var pe,ge;return(ge=(pe=m.value)==null?void 0:pe.scrollIntoViewOptions)!=null?ge:i.scrollIntoViewOptions}),G=Q(()=>{var pe,ge;return(ge=(pe=m.value)==null?void 0:pe.type)!=null?ge:i.type}),{nextZIndex:U}=Jp(),te=U(),Z=Q(()=>{var pe;return(pe=i.zIndex)!=null?pe:te}),{mergedPosInfo:q,triggerTarget:X}=Kue(x,fo(i,"modelValue"),fo(i,"gap"),A,F);Wt(()=>i.modelValue,pe=>{pe||(_.value=0)});const ie=()=>{i.closeOnPressEscape&&(t("update:modelValue",!1),t("close",_.value))},de=pe=>{d.value=pe},le=Ai();return Br(c1,{currentStep:m,current:_,total:d,showClose:fo(i,"showClose"),closeIcon:fo(i,"closeIcon"),mergedType:G,ns:a,slots:le,updateModelValue(pe){t("update:modelValue",pe)},onClose(){t("close",_.value)},onFinish(){t("finish")},onChange(){t("change",_.value)}}),(pe,ge)=>(se(),Ae(Bn,null,[qe(y(tm),{to:pe.appendTo},{default:st(()=>{var he,ue;return[Ve("div",kr({class:y(o)},pe.$attrs),[qe(ede,{visible:y(z),fill:(he=y(N))==null?void 0:he.color,style:Nn((ue=y(N))==null?void 0:ue.style),pos:y(q),"z-index":y(Z),"target-area-clickable":pe.targetAreaClickable},null,8,["visible","fill","style","pos","z-index","target-area-clickable"]),pe.modelValue?(se(),It(sde,{key:y(_),reference:y(X),placement:y(C),"show-arrow":y($),"z-index":y(Z),style:Nn(y(k)),onClose:ie},{default:st(()=>[qe(y(ade),{current:y(_),onUpdateTotal:de},{default:st(()=>[_t(pe.$slots,"default")]),_:3},8,["current"])]),_:3},8,["reference","placement","show-arrow","z-index","style"])):bt("v-if",!0)],16)]}),_:3},8,["to"]),bt(" just for IDE "),bt("v-if",!0)],64))}});var hde=hn(dde,[["__file","tour.vue"]]);const fde=ln({target:{type:at([String,Object,Function])},title:String,description:String,showClose:{type:Boolean,default:void 0},closeIcon:{type:wo},showArrow:{type:Boolean,default:void 0},placement:_E.placement,mask:{type:at([Boolean,Object]),default:void 0},contentStyle:{type:at([Object])},prevButtonProps:{type:at(Object)},nextButtonProps:{type:at(Object)},scrollIntoViewOptions:{type:at([Boolean,Object]),default:void 0},type:{type:at(String)}}),pde={close:()=>!0},mde=Ge({name:"ElTourStep"}),gde=Ge({...mde,props:fde,emits:pde,setup(e,{emit:t}){const i=e,{Close:a}=sC,{t:d}=Gr(),{currentStep:m,current:_,total:x,showClose:o,closeIcon:C,mergedType:k,ns:A,slots:z,updateModelValue:N,onClose:$,onFinish:F,onChange:G}=kn(c1);Wt(i,le=>{m.value=le},{immediate:!0});const U=Q(()=>{var le;return(le=i.showClose)!=null?le:o.value}),te=Q(()=>{var le,pe;return(pe=(le=i.closeIcon)!=null?le:C.value)!=null?pe:a}),Z=le=>{if(le)return qH(le,["children","onClick"])},q=()=>{var le,pe;_.value-=1,(le=i.prevButtonProps)!=null&&le.onClick&&((pe=i.prevButtonProps)==null||pe.onClick()),G()},X=()=>{var le;_.value>=x.value-1?ie():_.value+=1,(le=i.nextButtonProps)!=null&&le.onClick&&i.nextButtonProps.onClick(),G()},ie=()=>{de(),F()},de=()=>{N(!1),$(),t("close")};return(le,pe)=>(se(),Ae(Bn,null,[y(U)?(se(),Ae("button",{key:0,"aria-label":"Close",class:ce(y(A).e("closebtn")),type:"button",onClick:de},[qe(y(Dn),{class:ce(y(A).e("close"))},{default:st(()=>[(se(),It(Ir(y(te))))]),_:1},8,["class"])],2)):bt("v-if",!0),Ve("header",{class:ce([y(A).e("header"),{"show-close":y(o)}])},[_t(le.$slots,"header",{},()=>[Ve("span",{role:"heading",class:ce(y(A).e("title"))},fn(le.title),3)])],2),Ve("div",{class:ce(y(A).e("body"))},[_t(le.$slots,"default",{},()=>[Ve("span",null,fn(le.description),1)])],2),Ve("footer",{class:ce(y(A).e("footer"))},[Ve("div",{class:ce(y(A).b("indicators"))},[y(z).indicators?(se(),It(Ir(y(z).indicators),{key:0,current:y(_),total:y(x)},null,8,["current","total"])):(se(!0),Ae(Bn,{key:1},Fr(y(x),(ge,he)=>(se(),Ae("span",{key:ge,class:ce([y(A).b("indicator"),he===y(_)?"is-active":""])},null,2))),128))],2),Ve("div",{class:ce(y(A).b("buttons"))},[y(_)>0?(se(),It(y(zi),kr({key:0,size:"small",type:y(k)},Z(le.prevButtonProps),{onClick:q}),{default:st(()=>{var ge,he;return[$r(fn((he=(ge=le.prevButtonProps)==null?void 0:ge.children)!=null?he:y(d)("el.tour.previous")),1)]}),_:1},16,["type"])):bt("v-if",!0),y(_)<=y(x)-1?(se(),It(y(zi),kr({key:1,size:"small",type:y(k)==="primary"?"default":"primary"},Z(le.nextButtonProps),{onClick:X}),{default:st(()=>{var ge,he;return[$r(fn((he=(ge=le.nextButtonProps)==null?void 0:ge.children)!=null?he:y(_)===y(x)-1?y(d)("el.tour.finish"):y(d)("el.tour.next")),1)]}),_:1},16,["type"])):bt("v-if",!0)],2)],2)],64))}});var RB=hn(gde,[["__file","step.vue"]]);const vde=cr(hde,{TourStep:RB}),_de=Jo(RB),yde=ln({container:{type:at([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:at(String),default:"default"},direction:{type:at(String),default:"vertical"}}),bde={change:e=>zn(e),click:(e,t)=>e instanceof MouseEvent&&(zn(t)||Bo(t))},DB=Symbol("anchor"),xde=Ge({name:"ElAnchor"}),wde=Ge({...xde,props:yde,emits:bde,setup(e,{expose:t,emit:i}){const a=e,d=be(""),m=be(null),_=be(null),x=be(),o={};let C=!1,k=0;const A=Jt("anchor"),z=Q(()=>[A.b(),a.type==="underline"?A.m("underline"):"",A.m(a.direction)]),N=le=>{o[le.href]=le.el},$=le=>{delete o[le]},F=le=>{d.value!==le&&(d.value=le,i("change",le))};let G=null;const U=le=>{if(!x.value)return;const pe=l0(le);if(!pe)return;G&&G(),C=!0;const ge=vP(pe,x.value),he=rS(pe,ge),ue=ge.scrollHeight-ge.clientHeight,Re=Math.min(he-a.offset,ue);G=sG(x.value,k,Re,a.duration,()=>{setTimeout(()=>{C=!1},20)})},te=le=>{le&&(F(le),U(le))},Z=(le,pe)=>{i("click",le,pe),te(pe)},q=TW(()=>{x.value&&(k=_P(x.value));const le=X();C||Bo(le)||F(le)}),X=()=>{if(!x.value)return;const le=_P(x.value),pe=[];for(const ge of Object.keys(o)){const he=l0(ge);if(!he)continue;const ue=vP(he,x.value),Re=rS(he,ue);pe.push({top:Re-a.offset-a.bound,href:ge})}pe.sort((ge,he)=>ge.top-he.top);for(let ge=0;ge<pe.length;ge++){const he=pe[ge],ue=pe[ge+1];if(ge===0&&le===0)return"";if(he.top<=le&&(!ue||ue.top>le))return he.href}},ie=()=>{const le=l0(a.container);!le||Ub(le)?x.value=window:x.value=le};yo(x,"scroll",q);const de=Q(()=>{if(!m.value||!_.value||!d.value)return{};const le=o[d.value];if(!le)return{};const pe=m.value.getBoundingClientRect(),ge=_.value.getBoundingClientRect(),he=le.getBoundingClientRect();return a.direction==="horizontal"?{left:`${he.left-pe.left}px`,width:`${he.width}px`,opacity:1}:{top:`${he.top-pe.top+(he.height-ge.height)/2}px`,opacity:1}});return vr(()=>{ie();const le=decodeURIComponent(window.location.hash);l0(le)?te(le):q()}),Wt(()=>a.container,()=>{ie()}),Br(DB,{ns:A,direction:a.direction,currentAnchor:d,addLink:N,removeLink:$,handleClick:Z}),t({scrollTo:te}),(le,pe)=>(se(),Ae("div",{ref_key:"anchorRef",ref:m,class:ce(y(z))},[le.marker?(se(),Ae("div",{key:0,ref_key:"markerRef",ref:_,class:ce(y(A).e("marker")),style:Nn(y(de))},null,6)):bt("v-if",!0),Ve("div",{class:ce(y(A).e("list"))},[_t(le.$slots,"default")],2)],2))}});var Sde=hn(wde,[["__file","anchor.vue"]]);const Tde=ln({title:String,href:String}),Cde=Ge({name:"ElAnchorLink"}),Ede=Ge({...Cde,props:Tde,setup(e){const t=e,i=be(null),{ns:a,direction:d,currentAnchor:m,addLink:_,removeLink:x,handleClick:o}=kn(DB),C=Q(()=>[a.e("link"),a.is("active",m.value===t.href)]),k=A=>{o(A,t.href)};return Wt(()=>t.href,(A,z)=>{Vn(()=>{z&&x(z),A&&_({href:A,el:i.value})})}),vr(()=>{const{href:A}=t;A&&_({href:A,el:i.value})}),Io(()=>{const{href:A}=t;A&&x(A)}),(A,z)=>(se(),Ae("div",{class:ce(y(a).e("item"))},[Ve("a",{ref_key:"linkRef",ref:i,class:ce(y(C)),href:A.href,onClick:k},[_t(A.$slots,"default",{},()=>[$r(fn(A.title),1)])],10,["href"]),A.$slots["sub-link"]&&y(d)==="vertical"?(se(),Ae("div",{key:0,class:ce(y(a).e("list"))},[_t(A.$slots,"sub-link")],2)):bt("v-if",!0)],2))}});var LB=hn(Ede,[["__file","anchor-link.vue"]]);const Mde=cr(Sde,{AnchorLink:LB}),Ide=Jo(LB),kde=ln({direction:{type:at(String),default:"horizontal"},options:{type:at(Array),default:()=>[]},modelValue:{type:[String,Number,Boolean],default:void 0},block:Boolean,size:Ei,disabled:Boolean,validateEvent:{type:Boolean,default:!0},id:String,name:String,...qi(["ariaLabel"])}),Ade={[xr]:e=>zn(e)||Wn(e)||ko(e),[No]:e=>zn(e)||Wn(e)||ko(e)},Pde=Ge({name:"ElSegmented"}),Rde=Ge({...Pde,props:kde,emits:Ade,setup(e,{emit:t}){const i=e,a=Jt("segmented"),d=Wi(),m=xi(),_=ys(),{formItem:x}=bs(),{inputId:o,isLabeledByFormItem:C}=Sl(i,{formItemContext:x}),k=be(null),A=hV(),z=ao({isInit:!1,width:0,height:0,translateX:0,translateY:0,focusVisible:!1}),N=pe=>{const ge=$(pe);t(xr,ge),t(No,ge)},$=pe=>Tr(pe)?pe.value:pe,F=pe=>Tr(pe)?pe.label:pe,G=pe=>!!(_.value||Tr(pe)&&pe.disabled),U=pe=>i.modelValue===$(pe),te=pe=>i.options.find(ge=>$(ge)===pe),Z=pe=>[a.e("item"),a.is("selected",U(pe)),a.is("disabled",G(pe))],q=()=>{if(!k.value)return;const pe=k.value.querySelector(".is-selected"),ge=k.value.querySelector(".is-selected input");if(!pe||!ge){z.width=0,z.height=0,z.translateX=0,z.translateY=0,z.focusVisible=!1;return}const he=pe.getBoundingClientRect();z.isInit=!0,i.direction==="vertical"?(z.height=he.height,z.translateY=pe.offsetTop):(z.width=he.width,z.translateX=pe.offsetLeft);try{z.focusVisible=ge.matches(":focus-visible")}catch{}},X=Q(()=>[a.b(),a.m(m.value),a.is("block",i.block)]),ie=Q(()=>({width:i.direction==="vertical"?"100%":`${z.width}px`,height:i.direction==="vertical"?`${z.height}px`:"100%",transform:i.direction==="vertical"?`translateY(${z.translateY}px)`:`translateX(${z.translateX}px)`,display:z.isInit?"block":"none"})),de=Q(()=>[a.e("item-selected"),a.is("disabled",G(te(i.modelValue))),a.is("focus-visible",z.focusVisible)]),le=Q(()=>i.name||d.value);return qo(k,q),Wt(A,q),Wt(()=>i.modelValue,()=>{var pe;q(),i.validateEvent&&((pe=x==null?void 0:x.validate)==null||pe.call(x,"change").catch(ge=>void 0))},{flush:"post"}),(pe,ge)=>pe.options.length?(se(),Ae("div",{key:0,id:y(o),ref_key:"segmentedRef",ref:k,class:ce(y(X)),role:"radiogroup","aria-label":y(C)?void 0:pe.ariaLabel||"segmented","aria-labelledby":y(C)?y(x).labelId:void 0},[Ve("div",{class:ce([y(a).e("group"),y(a).m(i.direction)])},[Ve("div",{style:Nn(y(ie)),class:ce(y(de))},null,6),(se(!0),Ae(Bn,null,Fr(pe.options,(he,ue)=>(se(),Ae("label",{key:ue,class:ce(Z(he))},[Ve("input",{class:ce(y(a).e("item-input")),type:"radio",name:y(le),disabled:G(he),checked:U(he),onChange:Re=>N(he)},null,42,["name","disabled","checked","onChange"]),Ve("div",{class:ce(y(a).e("item-label"))},[_t(pe.$slots,"default",{item:he},()=>[$r(fn(F(he)),1)])],2)],2))),128))],2)],10,["id","aria-label","aria-labelledby"])):bt("v-if",!0)}});var Dde=hn(Rde,[["__file","segmented.vue"]]);const Lde=cr(Dde),Ode=(e,t)=>{const i=e.toLowerCase();return(t.label||t.value).toLowerCase().includes(i)},zde=(e,t,i)=>{const{selectionEnd:a}=e;if(a===null)return;const d=e.value,m=ms(t);let _=-1,x;for(let o=a-1;o>=0;--o){const C=d[o];if(C===i||C===`
`||C==="\r"){_=o;continue}if(m.includes(C)){const k=_===-1?a:_;x={pattern:d.slice(o+1,k),start:o+1,end:k,prefix:C,prefixIndex:o,splitIndex:_,selectionEnd:a};break}}return x},Bde=(e,t={debug:!1,useSelectionEnd:!1})=>{const i=e.selectionStart!==null?e.selectionStart:0,a=e.selectionEnd!==null?e.selectionEnd:0,d=t.useSelectionEnd?a:i,m=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"];if(t.debug){const z=document.querySelector("#input-textarea-caret-position-mirror-div");z!=null&&z.parentNode&&z.parentNode.removeChild(z)}const _=document.createElement("div");_.id="input-textarea-caret-position-mirror-div",document.body.appendChild(_);const x=_.style,o=window.getComputedStyle(e),C=e.nodeName==="INPUT";x.whiteSpace=C?"nowrap":"pre-wrap",C||(x.wordWrap="break-word"),x.position="absolute",t.debug||(x.visibility="hidden"),m.forEach(z=>{if(C&&z==="lineHeight")if(o.boxSizing==="border-box"){const N=Number.parseInt(o.height),$=Number.parseInt(o.paddingTop)+Number.parseInt(o.paddingBottom)+Number.parseInt(o.borderTopWidth)+Number.parseInt(o.borderBottomWidth),F=$+Number.parseInt(o.lineHeight);N>F?x.lineHeight=`${N-$}px`:N===F?x.lineHeight=o.lineHeight:x.lineHeight="0"}else x.lineHeight=o.height;else x[z]=o[z]}),zT()?e.scrollHeight>Number.parseInt(o.height)&&(x.overflowY="scroll"):x.overflow="hidden",_.textContent=e.value.slice(0,Math.max(0,d)),C&&_.textContent&&(_.textContent=_.textContent.replace(/\s/g," "));const k=document.createElement("span");k.textContent=e.value.slice(Math.max(0,d))||".",k.style.position="relative",k.style.left=`${-e.scrollLeft}px`,k.style.top=`${-e.scrollTop}px`,_.appendChild(k);const A={top:k.offsetTop+Number.parseInt(o.borderTopWidth),left:k.offsetLeft+Number.parseInt(o.borderLeftWidth),height:Number.parseInt(o.fontSize)*1.5};return t.debug?k.style.backgroundColor="#aaa":document.body.removeChild(_),A.left>=e.clientWidth&&(A.left=e.clientWidth),A},Fde=ln({...AC,options:{type:at(Array),default:()=>[]},prefix:{type:at([String,Array]),default:"@",validator:e=>zn(e)?e.length===1:e.every(t=>zn(t)&&t.length===1)},split:{type:String,default:" ",validator:e=>e.length===1},filterOption:{type:at([Boolean,Function]),default:()=>Ode,validator:e=>e===!1?!0:Fn(e)},placement:{type:at(String),default:"bottom"},showArrow:Boolean,offset:{type:Number,default:0},whole:Boolean,checkIsWhole:{type:at(Function)},modelValue:String,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:at(Object),default:()=>({})}}),Nde={[xr]:e=>zn(e),search:(e,t)=>zn(e)&&zn(t),select:(e,t)=>zn(e.value)&&zn(t),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},$de=ln({options:{type:at(Array),default:()=>[]},loading:Boolean,disabled:Boolean,contentId:String,ariaLabel:String}),Vde={select:e=>zn(e.value)},Ude=Ge({name:"ElMentionDropdown"}),jde=Ge({...Ude,props:$de,emits:Vde,setup(e,{expose:t,emit:i}){const a=e,d=Jt("mention"),{t:m}=Gr(),_=be(-1),x=be(),o=be(),C=be(),k=(Z,q)=>[d.be("dropdown","item"),d.is("hovering",_.value===q),d.is("disabled",Z.disabled||a.disabled)],A=Z=>{Z.disabled||a.disabled||i("select",Z)},z=Z=>{_.value=Z},N=Q(()=>a.disabled||a.options.every(Z=>Z.disabled)),$=Q(()=>a.options[_.value]),F=()=>{$.value&&i("select",$.value)},G=Z=>{const{options:q}=a;if(q.length===0||N.value)return;Z==="next"?(_.value++,_.value===q.length&&(_.value=0)):Z==="prev"&&(_.value--,_.value<0&&(_.value=q.length-1));const X=q[_.value];if(X.disabled){G(Z);return}Vn(()=>U(X))},U=Z=>{var q,X,ie,de;const{options:le}=a,pe=le.findIndex(he=>he.value===Z.value),ge=(q=o.value)==null?void 0:q[pe];if(ge){const he=(ie=(X=C.value)==null?void 0:X.querySelector)==null?void 0:ie.call(X,`.${d.be("dropdown","wrap")}`);he&&tC(he,ge)}(de=x.value)==null||de.handleScroll()};return Wt(()=>a.options,()=>{N.value||a.options.length===0?_.value=-1:_.value=0},{immediate:!0}),t({hoveringIndex:_,navigateOptions:G,selectHoverOption:F,hoverOption:$}),(Z,q)=>(se(),Ae("div",{ref_key:"dropdownRef",ref:C,class:ce(y(d).b("dropdown"))},[Z.$slots.header?(se(),Ae("div",{key:0,class:ce(y(d).be("dropdown","header"))},[_t(Z.$slots,"header")],2)):bt("v-if",!0),mr(qe(y(rc),{id:Z.contentId,ref_key:"scrollbarRef",ref:x,tag:"ul","wrap-class":y(d).be("dropdown","wrap"),"view-class":y(d).be("dropdown","list"),role:"listbox","aria-label":Z.ariaLabel,"aria-orientation":"vertical"},{default:st(()=>[(se(!0),Ae(Bn,null,Fr(Z.options,(X,ie)=>(se(),Ae("li",{id:`${Z.contentId}-${ie}`,ref_for:!0,ref_key:"optionRefs",ref:o,key:ie,class:ce(k(X,ie)),role:"option","aria-disabled":X.disabled||Z.disabled||void 0,"aria-selected":_.value===ie,onMousemove:de=>z(ie),onClick:Yn(de=>A(X),["stop"])},[_t(Z.$slots,"label",{item:X,index:ie},()=>{var de;return[Ve("span",null,fn((de=X.label)!=null?de:X.value),1)]})],42,["id","aria-disabled","aria-selected","onMousemove","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class","aria-label"]),[[no,Z.options.length>0&&!Z.loading]]),Z.loading?(se(),Ae("div",{key:1,class:ce(y(d).be("dropdown","loading"))},[_t(Z.$slots,"loading",{},()=>[$r(fn(y(m)("el.mention.loading")),1)])],2)):bt("v-if",!0),Z.$slots.footer?(se(),Ae("div",{key:2,class:ce(y(d).be("dropdown","footer"))},[_t(Z.$slots,"footer")],2)):bt("v-if",!0)],2))}});var Hde=hn(jde,[["__file","mention-dropdown.vue"]]);const Gde=Ge({name:"ElMention",inheritAttrs:!1}),Wde=Ge({...Gde,props:Fde,emits:Nde,setup(e,{expose:t,emit:i}){const a=e,d=Q(()=>dl(a,Object.keys(AC))),m=Jt("mention"),_=ys(),x=Wi(),o=be(),C=be(),k=be(),A=be(!1),z=be(),N=be(),$=Q(()=>a.showArrow?a.placement:`${a.placement}-start`),F=Q(()=>a.showArrow?["bottom","top"]:["bottom-start","top-start"]),G=Q(()=>{const{filterOption:ue,options:Re}=a;return!N.value||!ue?Re:Re.filter(Ye=>ue(N.value.pattern,Ye))}),U=Q(()=>A.value&&(!!G.value.length||a.loading)),te=Q(()=>{var ue;return`${x.value}-${(ue=k.value)==null?void 0:ue.hoveringIndex}`}),Z=ue=>{i("update:modelValue",ue),pe()},q=ue=>{var Re,Ye,Ie,fe;if(!(!("code"in ue)||(Re=o.value)!=null&&Re.isComposing))switch(ue.code){case En.left:case En.right:pe();break;case En.up:case En.down:if(!A.value)return;ue.preventDefault(),(Ye=k.value)==null||Ye.navigateOptions(ue.code===En.up?"prev":"next");break;case En.enter:case En.numpadEnter:if(!A.value)return;ue.preventDefault(),(Ie=k.value)!=null&&Ie.hoverOption?(fe=k.value)==null||fe.selectHoverOption():A.value=!1;break;case En.esc:if(!A.value)return;ue.preventDefault(),A.value=!1;break;case En.backspace:if(a.whole&&N.value){const{splitIndex:Me,selectionEnd:Se,pattern:ye,prefixIndex:Ce,prefix:Fe}=N.value,it=le();if(!it)return;const We=it.value,ut=a.options.find(Ft=>Ft.value===ye);if((Fn(a.checkIsWhole)?a.checkIsWhole(ye,Fe):ut)&&Me!==-1&&Me+1===Se){ue.preventDefault();const Ft=We.slice(0,Ce)+We.slice(Me+1);i(xr,Ft);const mt=Ce;Vn(()=>{it.selectionStart=mt,it.selectionEnd=mt,he()})}}}},{wrapperRef:X}=Bh(o,{beforeFocus(){return _.value},afterFocus(){pe()},beforeBlur(ue){var Re;return(Re=C.value)==null?void 0:Re.isFocusInsideContent(ue)},afterBlur(){A.value=!1}}),ie=()=>{pe()},de=ue=>{if(!N.value)return;const Re=le();if(!Re)return;const Ye=Re.value,{split:Ie}=a,fe=Ye.slice(N.value.end),Me=fe.startsWith(Ie),Se=`${ue.value}${Me?"":Ie}`,ye=Ye.slice(0,N.value.start)+Se+fe;i(xr,ye),i("select",ue,N.value.prefix);const Ce=N.value.start+Se.length+(Me?1:0);Vn(()=>{Re.selectionStart=Ce,Re.selectionEnd=Ce,Re.focus(),he()})},le=()=>{var ue,Re;return a.type==="textarea"?(ue=o.value)==null?void 0:ue.textarea:(Re=o.value)==null?void 0:Re.input},pe=()=>{setTimeout(()=>{ge(),he(),Vn(()=>{var ue;return(ue=C.value)==null?void 0:ue.updatePopper()})},0)},ge=()=>{const ue=le();if(!ue)return;const Re=Bde(ue),Ye=ue.getBoundingClientRect(),Ie=o.value.$el.getBoundingClientRect();z.value={position:"absolute",width:0,height:`${Re.height}px`,left:`${Re.left+Ye.left-Ie.left}px`,top:`${Re.top+Ye.top-Ie.top}px`}},he=()=>{const ue=le();if(document.activeElement!==ue){A.value=!1;return}const{prefix:Re,split:Ye}=a;if(N.value=zde(ue,Re,Ye),N.value&&N.value.splitIndex===-1){A.value=!0,i("search",N.value.pattern,N.value.prefix);return}A.value=!1};return t({input:o,tooltip:C,dropdownVisible:U}),(ue,Re)=>(se(),Ae("div",{ref_key:"wrapperRef",ref:X,class:ce(y(m).b())},[qe(y(vs),kr(kr(y(d),ue.$attrs),{ref_key:"elInputRef",ref:o,"model-value":ue.modelValue,disabled:y(_),role:y(U)?"combobox":void 0,"aria-activedescendant":y(U)?y(te)||"":void 0,"aria-controls":y(U)?y(x):void 0,"aria-expanded":y(U)||void 0,"aria-label":ue.ariaLabel,"aria-autocomplete":y(U)?"none":void 0,"aria-haspopup":y(U)?"listbox":void 0,onInput:Z,onKeydown:q,onMousedown:ie}),$a({_:2},[Fr(ue.$slots,(Ye,Ie)=>({name:Ie,fn:st(fe=>[_t(ue.$slots,Ie,ul(Xu(fe)))])}))]),1040,["model-value","disabled","role","aria-activedescendant","aria-controls","aria-expanded","aria-label","aria-autocomplete","aria-haspopup"]),qe(y(os),{ref_key:"tooltipRef",ref:C,visible:y(U),"popper-class":[y(m).e("popper"),ue.popperClass],"popper-options":ue.popperOptions,placement:y($),"fallback-placements":y(F),effect:"light",pure:"",offset:ue.offset,"show-arrow":ue.showArrow},{default:st(()=>[Ve("div",{style:Nn(z.value)},null,4)]),content:st(()=>{var Ye;return[qe(Hde,{ref_key:"dropdownRef",ref:k,options:y(G),disabled:y(_),loading:ue.loading,"content-id":y(x),"aria-label":ue.ariaLabel,onSelect:de,onClick:Yn((Ye=o.value)==null?void 0:Ye.focus,["stop"])},$a({_:2},[Fr(ue.$slots,(Ie,fe)=>({name:fe,fn:st(Me=>[_t(ue.$slots,fe,ul(Xu(Me)))])}))]),1032,["options","disabled","loading","content-id","aria-label","onClick"])]}),_:3},8,["visible","popper-class","popper-options","placement","fallback-placements","offset","show-arrow"])],2))}});var qde=hn(Wde,[["__file","mention.vue"]]);const Kde=cr(qde);var Zde=[qq,o7,SZ,mle,kZ,zZ,$4,KZ,ZZ,zi,q4,dX,gX,IX,kX,kJ,A2,OJ,Ha,jX,x2,qJ,cQ,uQ,n1,OQ,Nq,qQ,KQ,ZQ,YQ,XQ,jee,Qee,ete,hte,ez,wte,dne,hne,fne,cz,Y7,X7,Dn,Pne,uz,vs,dz,Une,lre,cre,ure,dre,vre,loe,poe,Soe,B4,bz,I2,nJ,tJ,Doe,Foe,UJ,rc,Ph,hb,Ure,Sie,Pie,Rie,Xie,nse,Nz,fse,wse,Sse,kse,Aae,Pae,ple,kle,Ale,zv,Ole,GY,Vle,Wle,qle,os,_ce,Pce,xb,Yce,fue,zue,Wue,vde,_de,Mde,Ide,Lde,Kde];const La="ElInfiniteScroll",Yde=50,Xde=200,Jde=0,Qde={delay:{type:Number,default:Xde},distance:{type:Number,default:Jde},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},yE=(e,t)=>Object.entries(Qde).reduce((i,[a,d])=>{var m,_;const{type:x,default:o}=d,C=e.getAttribute(`infinite-scroll-${a}`);let k=(_=(m=t[C])!=null?m:C)!=null?_:o;return k=k==="false"?!1:k,k=x(k),i[a]=Number.isNaN(k)?o:k,i},{}),OB=e=>{const{observer:t}=e[La];t&&(t.disconnect(),delete e[La].observer)},ehe=(e,t)=>{const{container:i,containerEl:a,instance:d,observer:m,lastScrollTop:_}=e[La],{disabled:x,distance:o}=yE(e,d),{clientHeight:C,scrollHeight:k,scrollTop:A}=a,z=A-_;if(e[La].lastScrollTop=A,m||x||z<0)return;let N=!1;if(i===e)N=k-(C+A)<=o;else{const{clientTop:$,scrollHeight:F}=e,G=rS(e,a);N=A+C>=G+$+F-o}N&&t.call(d)};function $w(e,t){const{containerEl:i,instance:a}=e[La],{disabled:d}=yE(e,a);d||i.clientHeight===0||(i.scrollHeight<=i.clientHeight?t.call(a):OB(e))}const the={async mounted(e,t){const{instance:i,value:a}=t;Fn(a)||Ci(La,"'v-infinite-scroll' binding value must be a function"),await Vn();const{delay:d,immediate:m}=yE(e,i),_=eC(e,!0),x=_===window?document.documentElement:_,o=vh(ehe.bind(null,e,a),d);if(_){if(e[La]={instance:i,container:_,containerEl:x,delay:d,cb:a,onScroll:o,lastScrollTop:x.scrollTop},m){const C=new MutationObserver(vh($w.bind(null,e,a),Yde));e[La].observer=C,C.observe(e,{childList:!0,subtree:!0}),$w(e,a)}_.addEventListener("scroll",o)}},unmounted(e){if(!e[La])return;const{container:t,onScroll:i}=e[La];t==null||t.removeEventListener("scroll",i),OB(e)},async updated(e){if(!e[La])await Vn();else{const{containerEl:t,cb:i,observer:a}=e[La];t.clientHeight&&a&&$w(e,i)}}},cT=the;cT.install=e=>{e.directive("InfiniteScroll",cT)};const nhe=cT;function rhe(e){let t;const i=be(!1),a=ao({...e,originalPosition:"",originalOverflow:"",visible:!1});function d(z){a.text=z}function m(){const z=a.parent,N=A.ns;if(!z.vLoadingAddClassList){let $=z.getAttribute("loading-number");$=Number.parseInt($)-1,$?z.setAttribute("loading-number",$.toString()):(_s(z,N.bm("parent","relative")),z.removeAttribute("loading-number")),_s(z,N.bm("parent","hidden"))}_(),k.unmount()}function _(){var z,N;(N=(z=A.$el)==null?void 0:z.parentNode)==null||N.removeChild(A.$el)}function x(){var z;e.beforeClose&&!e.beforeClose()||(i.value=!0,clearTimeout(t),t=setTimeout(o,400),a.visible=!1,(z=e.closed)==null||z.call(e))}function o(){if(!i.value)return;const z=a.parent;i.value=!1,z.vLoadingAddClassList=void 0,m()}const k=BL(Ge({name:"ElLoading",setup(z,{expose:N}){const{ns:$,zIndex:F}=Qb("loading");return N({ns:$,zIndex:F}),()=>{const G=a.spinner||a.svg,U=Kn("svg",{class:"circular",viewBox:a.svgViewBox?a.svgViewBox:"0 0 50 50",...G?{innerHTML:G}:{}},[Kn("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),te=a.text?Kn("p",{class:$.b("text")},[a.text]):void 0;return Kn(Fi,{name:$.b("fade"),onAfterLeave:o},{default:st(()=>[mr(qe("div",{style:{backgroundColor:a.background||""},class:[$.b("mask"),a.customClass,a.fullscreen?"is-fullscreen":""]},[Kn("div",{class:$.b("spinner")},[U,te])]),[[no,a.visible]])])})}}})),A=k.mount(document.createElement("div"));return{...Bi(a),setText:d,removeElLoadingChild:_,close:x,handleAfterLeave:o,vm:A,get $el(){return A.$el}}}let S0;const uT=function(e={}){if(!Hr)return;const t=ohe(e);if(t.fullscreen&&S0)return S0;const i=rhe({...t,closed:()=>{var d;(d=t.closed)==null||d.call(t),t.fullscreen&&(S0=void 0)}});ihe(t,t.parent,i),cD(t,t.parent,i),t.parent.vLoadingAddClassList=()=>cD(t,t.parent,i);let a=t.parent.getAttribute("loading-number");return a?a=`${Number.parseInt(a)+1}`:a="1",t.parent.setAttribute("loading-number",a),t.parent.appendChild(i.$el),Vn(()=>i.visible.value=t.visible),t.fullscreen&&(S0=i),i},ohe=e=>{var t,i,a,d;let m;return zn(e.target)?m=(t=document.querySelector(e.target))!=null?t:document.body:m=e.target||document.body,{parent:m===document.body||e.body?document.body:m,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:m===document.body&&((i=e.fullscreen)!=null?i:!0),lock:(a=e.lock)!=null?a:!1,customClass:e.customClass||"",visible:(d=e.visible)!=null?d:!0,beforeClose:e.beforeClose,closed:e.closed,target:m}},ihe=async(e,t,i)=>{const{nextZIndex:a}=i.vm.zIndex||i.vm._.exposed.zIndex,d={};if(e.fullscreen)i.originalPosition.value=Uu(document.body,"position"),i.originalOverflow.value=Uu(document.body,"overflow"),d.zIndex=a();else if(e.parent===document.body){i.originalPosition.value=Uu(document.body,"position"),await Vn();for(const m of["top","left"]){const _=m==="top"?"scrollTop":"scrollLeft";d[m]=`${e.target.getBoundingClientRect()[m]+document.body[_]+document.documentElement[_]-Number.parseInt(Uu(document.body,`margin-${m}`),10)}px`}for(const m of["height","width"])d[m]=`${e.target.getBoundingClientRect()[m]}px`}else i.originalPosition.value=Uu(t,"position");for(const[m,_]of Object.entries(d))i.$el.style[m]=_},cD=(e,t,i)=>{const a=i.vm.ns||i.vm._.exposed.ns;["absolute","fixed","sticky"].includes(i.originalPosition.value)?_s(t,a.bm("parent","relative")):Oa(t,a.bm("parent","relative")),e.fullscreen&&e.lock?Oa(t,a.bm("parent","hidden")):_s(t,a.bm("parent","hidden"))},H0=Symbol("ElLoading"),uD=(e,t)=>{var i,a,d,m;const _=t.instance,x=z=>Tr(t.value)?t.value[z]:void 0,o=z=>{const N=zn(z)&&(_==null?void 0:_[z])||z;return N&&be(N)},C=z=>o(x(z)||e.getAttribute(`element-loading-${Dc(z)}`)),k=(i=x("fullscreen"))!=null?i:t.modifiers.fullscreen,A={text:C("text"),svg:C("svg"),svgViewBox:C("svgViewBox"),spinner:C("spinner"),background:C("background"),customClass:C("customClass"),fullscreen:k,target:(a=x("target"))!=null?a:k?void 0:e,body:(d=x("body"))!=null?d:t.modifiers.body,lock:(m=x("lock"))!=null?m:t.modifiers.lock};e[H0]={options:A,instance:uT(A)}},she=(e,t)=>{for(const i of Object.keys(t))Fo(t[i])&&(t[i].value=e[i])},dD={mounted(e,t){t.value&&uD(e,t)},updated(e,t){const i=e[H0];t.oldValue!==t.value&&(t.value&&!t.oldValue?uD(e,t):t.value&&t.oldValue?Tr(t.value)&&she(t.value,i.options):i==null||i.instance.close())},unmounted(e){var t;(t=e[H0])==null||t.instance.close(),e[H0]=null}},ahe={install(e){e.directive("loading",dD),e.config.globalProperties.$loading=uT},directive:dD,service:uT},zB=["success","info","warning","error"],hs=Xo({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",plain:!1,offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:Hr?document.body:void 0}),lhe=ln({customClass:{type:String,default:hs.customClass},center:{type:Boolean,default:hs.center},dangerouslyUseHTMLString:{type:Boolean,default:hs.dangerouslyUseHTMLString},duration:{type:Number,default:hs.duration},icon:{type:wo,default:hs.icon},id:{type:String,default:hs.id},message:{type:at([String,Object,Function]),default:hs.message},onClose:{type:at(Function),default:hs.onClose},showClose:{type:Boolean,default:hs.showClose},type:{type:String,values:zB,default:hs.type},plain:{type:Boolean,default:hs.plain},offset:{type:Number,default:hs.offset},zIndex:{type:Number,default:hs.zIndex},grouping:{type:Boolean,default:hs.grouping},repeatNum:{type:Number,default:hs.repeatNum}}),che={destroy:()=>!0},hl=LD([]),uhe=e=>{const t=hl.findIndex(d=>d.id===e),i=hl[t];let a;return t>0&&(a=hl[t-1]),{current:i,prev:a}},dhe=e=>{const{prev:t}=uhe(e);return t?t.vm.exposed.bottom.value:0},hhe=(e,t)=>hl.findIndex(a=>a.id===e)>0?16:t,fhe=Ge({name:"ElMessage"}),phe=Ge({...fhe,props:lhe,emits:che,setup(e,{expose:t}){const i=e,{Close:a}=aC,{ns:d,zIndex:m}=Qb("message"),{currentZIndex:_,nextZIndex:x}=m,o=be(),C=be(!1),k=be(0);let A;const z=Q(()=>i.type?i.type==="error"?"danger":i.type:"info"),N=Q(()=>{const de=i.type;return{[d.bm("icon",de)]:de&&id[de]}}),$=Q(()=>i.icon||id[i.type]||""),F=Q(()=>dhe(i.id)),G=Q(()=>hhe(i.id,i.offset)+F.value),U=Q(()=>k.value+G.value),te=Q(()=>({top:`${G.value}px`,zIndex:_.value}));function Z(){i.duration!==0&&({stop:A}=Th(()=>{X()},i.duration))}function q(){A==null||A()}function X(){C.value=!1}function ie({code:de}){de===En.esc&&X()}return vr(()=>{Z(),x(),C.value=!0}),Wt(()=>i.repeatNum,()=>{q(),Z()}),yo(document,"keydown",ie),qo(o,()=>{k.value=o.value.getBoundingClientRect().height}),t({visible:C,bottom:U,close:X}),(de,le)=>(se(),It(Fi,{name:y(d).b("fade"),onBeforeLeave:de.onClose,onAfterLeave:pe=>de.$emit("destroy"),persisted:""},{default:st(()=>[mr(Ve("div",{id:de.id,ref_key:"messageRef",ref:o,class:ce([y(d).b(),{[y(d).m(de.type)]:de.type},y(d).is("center",de.center),y(d).is("closable",de.showClose),y(d).is("plain",de.plain),de.customClass]),style:Nn(y(te)),role:"alert",onMouseenter:q,onMouseleave:Z},[de.repeatNum>1?(se(),It(y($4),{key:0,value:de.repeatNum,type:y(z),class:ce(y(d).e("badge"))},null,8,["value","type","class"])):bt("v-if",!0),y($)?(se(),It(y(Dn),{key:1,class:ce([y(d).e("icon"),y(N)])},{default:st(()=>[(se(),It(Ir(y($))))]),_:1},8,["class"])):bt("v-if",!0),_t(de.$slots,"default",{},()=>[de.dangerouslyUseHTMLString?(se(),Ae(Bn,{key:1},[bt(" Caution here, message could've been compromised, never use user's input as message "),Ve("p",{class:ce(y(d).e("content")),innerHTML:de.message},null,10,["innerHTML"])],2112)):(se(),Ae("p",{key:0,class:ce(y(d).e("content"))},fn(de.message),3))]),de.showClose?(se(),It(y(Dn),{key:2,class:ce(y(d).e("closeBtn")),onClick:Yn(X,["stop"])},{default:st(()=>[qe(y(a))]),_:1},8,["class","onClick"])):bt("v-if",!0)],46,["id"]),[[no,C.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var mhe=hn(phe,[["__file","message.vue"]]);let ghe=1;const BB=e=>{const t=!e||zn(e)||Ho(e)||Fn(e)?{message:e}:e,i={...hs,...t};if(!i.appendTo)i.appendTo=document.body;else if(zn(i.appendTo)){let a=document.querySelector(i.appendTo);ga(a)||(a=document.body),i.appendTo=a}return ko(ll.grouping)&&!i.grouping&&(i.grouping=ll.grouping),Wn(ll.duration)&&i.duration===3e3&&(i.duration=ll.duration),Wn(ll.offset)&&i.offset===16&&(i.offset=ll.offset),ko(ll.showClose)&&!i.showClose&&(i.showClose=ll.showClose),i},vhe=e=>{const t=hl.indexOf(e);if(t===-1)return;hl.splice(t,1);const{handler:i}=e;i.close()},_he=({appendTo:e,...t},i)=>{const a=`message_${ghe++}`,d=t.onClose,m=document.createElement("div"),_={...t,id:a,onClose:()=>{d==null||d(),vhe(k)},onDestroy:()=>{Qu(null,m)}},x=qe(mhe,_,Fn(_.message)||Ho(_.message)?{default:Fn(_.message)?_.message:()=>_.message}:null);x.appContext=i||jp._context,Qu(x,m),e.appendChild(m.firstElementChild);const o=x.component,k={id:a,vnode:x,vm:o,handler:{close:()=>{o.exposed.visible.value=!1}},props:x.component.props};return k},jp=(e={},t)=>{if(!Hr)return{close:()=>{}};const i=BB(e);if(i.grouping&&hl.length){const d=hl.find(({vnode:m})=>{var _;return((_=m.props)==null?void 0:_.message)===i.message});if(d)return d.props.repeatNum+=1,d.props.type=i.type,d.handler}if(Wn(ll.max)&&hl.length>=ll.max)return{close:()=>{}};const a=_he(i,t);return hl.push(a),a.handler};zB.forEach(e=>{jp[e]=(t={},i)=>{const a=BB(t);return jp({...a,type:e},i)}});function yhe(e){for(const t of hl)(!e||e===t.props.type)&&t.handler.close()}jp.closeAll=yhe;jp._context=null;const bhe=UO(jp,"$message"),xhe=Ge({name:"ElMessageBox",directives:{TrapFocus:AY},components:{ElButton:zi,ElFocusTrap:c_,ElInput:vs,ElOverlay:GC,ElIcon:Dn,...aC},inheritAttrs:!1,props:{buttonSize:{type:String,validator:jO},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:i,zIndex:a,ns:d,size:m}=Qb("message-box",Q(()=>e.buttonSize)),{t:_}=i,{nextZIndex:x}=a,o=be(!1),C=ao({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:Wu(Kl),cancelButtonLoadingIcon:Wu(Kl),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:x()}),k=Q(()=>{const fe=C.type;return{[d.bm("icon",fe)]:fe&&id[fe]}}),A=Wi(),z=Wi(),N=Q(()=>C.icon||id[C.type]||""),$=Q(()=>!!C.message),F=be(),G=be(),U=be(),te=be(),Z=be(),q=Q(()=>C.confirmButtonClass);Wt(()=>C.inputValue,async fe=>{await Vn(),e.boxType==="prompt"&&fe!==null&&ue()},{immediate:!0}),Wt(()=>o.value,fe=>{var Me,Se;fe&&(e.boxType!=="prompt"&&(C.autofocus?U.value=(Se=(Me=Z.value)==null?void 0:Me.$el)!=null?Se:F.value:U.value=F.value),C.zIndex=x()),e.boxType==="prompt"&&(fe?Vn().then(()=>{var ye;te.value&&te.value.$el&&(C.autofocus?U.value=(ye=Re())!=null?ye:F.value:U.value=F.value)}):(C.editorErrorMessage="",C.validateError=!1))});const X=Q(()=>e.draggable),ie=Q(()=>e.overflow);HO(F,G,X,ie),vr(async()=>{await Vn(),e.closeOnHashChange&&window.addEventListener("hashchange",de)}),Io(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",de)});function de(){o.value&&(o.value=!1,Vn(()=>{C.action&&t("action",C.action)}))}const le=()=>{e.closeOnClickModal&&he(C.distinguishCancelAndClose?"close":"cancel")},pe=yC(le),ge=fe=>{if(C.inputType!=="textarea")return fe.preventDefault(),he("confirm")},he=fe=>{var Me;e.boxType==="prompt"&&fe==="confirm"&&!ue()||(C.action=fe,C.beforeClose?(Me=C.beforeClose)==null||Me.call(C,fe,C,de):de())},ue=()=>{if(e.boxType==="prompt"){const fe=C.inputPattern;if(fe&&!fe.test(C.inputValue||""))return C.editorErrorMessage=C.inputErrorMessage||_("el.messagebox.error"),C.validateError=!0,!1;const Me=C.inputValidator;if(Fn(Me)){const Se=Me(C.inputValue);if(Se===!1)return C.editorErrorMessage=C.inputErrorMessage||_("el.messagebox.error"),C.validateError=!0,!1;if(zn(Se))return C.editorErrorMessage=Se,C.validateError=!0,!1}}return C.editorErrorMessage="",C.validateError=!1,!0},Re=()=>{const fe=te.value.$refs;return fe.input||fe.textarea},Ye=()=>{he("close")},Ie=()=>{e.closeOnPressEscape&&Ye()};return e.lockScroll&&uC(o),{...Bi(C),ns:d,overlayEvent:pe,visible:o,hasMessage:$,typeClass:k,contentId:A,inputId:z,btnSize:m,iconComponent:N,confirmButtonClasses:q,rootRef:F,focusStartRef:U,headerRef:G,inputRef:te,confirmRef:Z,doClose:de,handleClose:Ye,onCloseRequested:Ie,handleWrapperClick:le,handleInputEnter:ge,handleAction:he,t:_}}});function whe(e,t,i,a,d,m){const _=Er("el-icon"),x=Er("close"),o=Er("el-input"),C=Er("el-button"),k=Er("el-focus-trap"),A=Er("el-overlay");return se(),It(Fi,{name:"fade-in-linear",onAfterLeave:z=>e.$emit("vanish"),persisted:""},{default:st(()=>[mr(qe(A,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:st(()=>[Ve("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:ce(`${e.ns.namespace.value}-overlay-message-box`),onClick:e.overlayEvent.onClick,onMousedown:e.overlayEvent.onMousedown,onMouseup:e.overlayEvent.onMouseup},[qe(k,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:st(()=>[Ve("div",{ref:"rootRef",class:ce([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:Nn(e.customStyle),tabindex:"-1",onClick:Yn(()=>{},["stop"])},[e.title!==null&&e.title!==void 0?(se(),Ae("div",{key:0,ref:"headerRef",class:ce([e.ns.e("header"),{"show-close":e.showClose}])},[Ve("div",{class:ce(e.ns.e("title"))},[e.iconComponent&&e.center?(se(),It(_,{key:0,class:ce([e.ns.e("status"),e.typeClass])},{default:st(()=>[(se(),It(Ir(e.iconComponent)))]),_:1},8,["class"])):bt("v-if",!0),Ve("span",null,fn(e.title),1)],2),e.showClose?(se(),Ae("button",{key:0,type:"button",class:ce(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:z=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),onKeydown:Mo(Yn(z=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[qe(_,{class:ce(e.ns.e("close"))},{default:st(()=>[qe(x)]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):bt("v-if",!0)],2)):bt("v-if",!0),Ve("div",{id:e.contentId,class:ce(e.ns.e("content"))},[Ve("div",{class:ce(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(se(),It(_,{key:0,class:ce([e.ns.e("status"),e.typeClass])},{default:st(()=>[(se(),It(Ir(e.iconComponent)))]),_:1},8,["class"])):bt("v-if",!0),e.hasMessage?(se(),Ae("div",{key:1,class:ce(e.ns.e("message"))},[_t(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(se(),It(Ir(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(se(),It(Ir(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:st(()=>[$r(fn(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):bt("v-if",!0)],2),mr(Ve("div",{class:ce(e.ns.e("input"))},[qe(o,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":z=>e.inputValue=z,type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:ce({invalid:e.validateError}),onKeydown:Mo(e.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),Ve("div",{class:ce(e.ns.e("errormsg")),style:Nn({visibility:e.editorErrorMessage?"visible":"hidden"})},fn(e.editorErrorMessage),7)],2),[[no,e.showInput]])],10,["id"]),Ve("div",{class:ce(e.ns.e("btns"))},[e.showCancelButton?(se(),It(C,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:ce([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:z=>e.handleAction("cancel"),onKeydown:Mo(Yn(z=>e.handleAction("cancel"),["prevent"]),["enter"])},{default:st(()=>[$r(fn(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):bt("v-if",!0),mr(qe(C,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:ce([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:z=>e.handleAction("confirm"),onKeydown:Mo(Yn(z=>e.handleAction("confirm"),["prevent"]),["enter"])},{default:st(()=>[$r(fn(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[no,e.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[no,e.visible]])]),_:3},8,["onAfterLeave"])}var She=hn(xhe,[["render",whe],["__file","index.vue"]]);const Wv=new Map,The=e=>{let t=document.body;return e.appendTo&&(zn(e.appendTo)&&(t=document.querySelector(e.appendTo)),ga(e.appendTo)&&(t=e.appendTo),ga(t)||(t=document.body)),t},Che=(e,t,i=null)=>{const a=qe(She,e,Fn(e.message)||Ho(e.message)?{default:Fn(e.message)?e.message:()=>e.message}:null);return a.appContext=i,Qu(a,t),The(e).appendChild(t.firstElementChild),a.component},Ehe=()=>document.createElement("div"),Mhe=(e,t)=>{const i=Ehe();e.onVanish=()=>{Qu(null,i),Wv.delete(d)},e.onAction=m=>{const _=Wv.get(d);let x;e.showInput?x={value:d.inputValue,action:m}:x=m,e.callback?e.callback(x,a.proxy):m==="cancel"||m==="close"?e.distinguishCancelAndClose&&m!=="cancel"?_.reject("close"):_.reject("cancel"):_.resolve(x)};const a=Che(e,i,t),d=a.proxy;for(const m in e)Qr(e,m)&&!Qr(d.$props,m)&&(d[m]=e[m]);return d.visible=!0,d};function om(e,t=null){if(!Hr)return Promise.reject();let i;return zn(e)||Ho(e)?e={message:e}:i=e.callback,new Promise((a,d)=>{const m=Mhe(e,t??om._context);Wv.set(m,{options:e,callback:i,resolve:a,reject:d})})}const Ihe=["alert","confirm","prompt"],khe={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};Ihe.forEach(e=>{om[e]=Ahe(e)});function Ahe(e){return(t,i,a,d)=>{let m="";return Tr(i)?(a=i,m=""):Bo(i)?m="":m=i,om(Object.assign({title:m,message:t,type:"",...khe[e]},a,{boxType:e}),d)}}om.close=()=>{Wv.forEach((e,t)=>{t.doClose()}),Wv.clear()};om._context=null;const Fu=om;Fu.install=e=>{Fu._context=e._context,e.config.globalProperties.$msgbox=Fu,e.config.globalProperties.$messageBox=Fu,e.config.globalProperties.$alert=Fu.alert,e.config.globalProperties.$confirm=Fu.confirm,e.config.globalProperties.$prompt=Fu.prompt};const Phe=Fu,FB=["success","info","warning","error"],Rhe=ln({customClass:{type:String,default:""},dangerouslyUseHTMLString:Boolean,duration:{type:Number,default:4500},icon:{type:wo},id:{type:String,default:""},message:{type:at([String,Object]),default:""},offset:{type:Number,default:0},onClick:{type:at(Function),default:()=>{}},onClose:{type:at(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...FB,""],default:""},zIndex:Number}),Dhe={destroy:()=>!0},Lhe=Ge({name:"ElNotification"}),Ohe=Ge({...Lhe,props:Rhe,emits:Dhe,setup(e,{expose:t}){const i=e,{ns:a,zIndex:d}=Qb("notification"),{nextZIndex:m,currentZIndex:_}=d,{Close:x}=sC,o=be(!1);let C;const k=Q(()=>{const Z=i.type;return Z&&id[i.type]?a.m(Z):""}),A=Q(()=>i.type&&id[i.type]||i.icon),z=Q(()=>i.position.endsWith("right")?"right":"left"),N=Q(()=>i.position.startsWith("top")?"top":"bottom"),$=Q(()=>{var Z;return{[N.value]:`${i.offset}px`,zIndex:(Z=i.zIndex)!=null?Z:_.value}});function F(){i.duration>0&&({stop:C}=Th(()=>{o.value&&U()},i.duration))}function G(){C==null||C()}function U(){o.value=!1}function te({code:Z}){Z===En.delete||Z===En.backspace?G():Z===En.esc?o.value&&U():F()}return vr(()=>{F(),m(),o.value=!0}),yo(document,"keydown",te),t({visible:o,close:U}),(Z,q)=>(se(),It(Fi,{name:y(a).b("fade"),onBeforeLeave:Z.onClose,onAfterLeave:X=>Z.$emit("destroy"),persisted:""},{default:st(()=>[mr(Ve("div",{id:Z.id,class:ce([y(a).b(),Z.customClass,y(z)]),style:Nn(y($)),role:"alert",onMouseenter:G,onMouseleave:F,onClick:Z.onClick},[y(A)?(se(),It(y(Dn),{key:0,class:ce([y(a).e("icon"),y(k)])},{default:st(()=>[(se(),It(Ir(y(A))))]),_:1},8,["class"])):bt("v-if",!0),Ve("div",{class:ce(y(a).e("group"))},[Ve("h2",{class:ce(y(a).e("title")),textContent:fn(Z.title)},null,10,["textContent"]),mr(Ve("div",{class:ce(y(a).e("content")),style:Nn(Z.title?void 0:{margin:0})},[_t(Z.$slots,"default",{},()=>[Z.dangerouslyUseHTMLString?(se(),Ae(Bn,{key:1},[bt(" Caution here, message could've been compromised, never use user's input as message "),Ve("p",{innerHTML:Z.message},null,8,["innerHTML"])],2112)):(se(),Ae("p",{key:0},fn(Z.message),1))])],6),[[no,Z.message]]),Z.showClose?(se(),It(y(Dn),{key:0,class:ce(y(a).e("closeBtn")),onClick:Yn(U,["stop"])},{default:st(()=>[qe(y(x))]),_:1},8,["class","onClick"])):bt("v-if",!0)],2)],46,["id","onClick"]),[[no,o.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var zhe=hn(Ohe,[["__file","notification.vue"]]);const wb={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},dT=16;let Bhe=1;const Hp=function(e={},t=null){if(!Hr)return{close:()=>{}};(zn(e)||Ho(e))&&(e={message:e});const i=e.position||"top-right";let a=e.offset||0;wb[i].forEach(({vm:k})=>{var A;a+=(((A=k.el)==null?void 0:A.offsetHeight)||0)+dT}),a+=dT;const d=`notification_${Bhe++}`,m=e.onClose,_={...e,offset:a,id:d,onClose:()=>{Fhe(d,i,m)}};let x=document.body;ga(e.appendTo)?x=e.appendTo:zn(e.appendTo)&&(x=document.querySelector(e.appendTo)),ga(x)||(x=document.body);const o=document.createElement("div"),C=qe(zhe,_,Ho(_.message)?{default:()=>_.message}:null);return C.appContext=t??Hp._context,C.props.onDestroy=()=>{Qu(null,o)},Qu(C,o),wb[i].push({vm:C}),x.appendChild(o.firstElementChild),{close:()=>{C.component.exposed.visible.value=!1}}};FB.forEach(e=>{Hp[e]=(t={})=>((zn(t)||Ho(t))&&(t={message:t}),Hp({...t,type:e}))});function Fhe(e,t,i){const a=wb[t],d=a.findIndex(({vm:C})=>{var k;return((k=C.component)==null?void 0:k.props.id)===e});if(d===-1)return;const{vm:m}=a[d];if(!m)return;i==null||i(m);const _=m.el.offsetHeight,x=t.split("-")[0];a.splice(d,1);const o=a.length;if(!(o<1))for(let C=d;C<o;C++){const{el:k,component:A}=a[C].vm,z=Number.parseInt(k.style[x],10)-_-dT;A.props.offset=z}}function Nhe(){for(const e of Object.values(wb))e.forEach(({vm:t})=>{t.component.exposed.visible.value=!1})}Hp.closeAll=Nhe;Hp._context=null;const $he=UO(Hp,"$notify");var Vhe=[nhe,ahe,bhe,Phe,$he,yz],Uhe=Vq([...Zde,...Vhe]);BL(q$).use(Uhe).mount("#app")});export default jhe();
